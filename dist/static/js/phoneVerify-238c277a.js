import{_ as e,d as a,i as l,h as t,j as o,O as s,l as r,o as d,m as i,w as c,a as n,e as m,u,bY as p,b as f,V as b,W as v,ch as y,ci as g,a8 as h,cj as N,ck as j,cl as C,ag as _,aC as T,aD as I}from"./index-cdaa140a.js";import{g as V}from"./trial-2eb9b511.js";import{c as q}from"./format-b5e9d8b9.js";import{u as U}from"./useOrder-aedde4eb.js";import{a as k,f as x}from"./verify-bdac398e.js";import{P as w}from"./constants-4b08cf92.js";const P=e=>(T("data-v-543f0ab6"),e=e(),I(),e),z={class:"page-phone-verify"},$={class:"title"},E=P((()=>n("div",{class:"title face-title"},"人脸识别",-1))),L={class:"face-verify-img"},O=["src"],S=P((()=>n("div",{class:"face-verify-tip"},[n("div",{class:"title"},"操作时请您配合"),n("ol",null,[n("li",null,"请调亮手机屏幕亮度，确保光线充足"),n("li",null,"请保持正脸对准屏幕，确保人脸完整清晰"),n("li",null,"请确保真实本人操作")])],-1))),W={class:"tips"},A=["src"];var D=e(a({__name:"phoneVerify",setup(e){const a=U(),T=l(),I=t(),{agentCode:P,tenantId:D,nextPageCode:M,biz_id:R,orderNo:Y,objectType:B,orderCode:F}=T.query,G=o({mobile:"",verifyCode:""}),H=o(),J=o(),K=()=>{V({orderNo:F||Y,tenantId:D}).then((({code:e,data:l})=>{if("10000"===e){Object.assign(a.value,l);const{holder:e,insuredList:t}=l;if("holder"===B){const{name:a,certNo:l,certType:t,id:o,mobile:s}=e;G.value.mobile=s,J.value={userName:a,certiNo:l,certType:t,objectId:o}}else{const{name:e,certNo:a,certType:l,id:o,mobile:s}=(null==t?void 0:t[0])||{};G.value.mobile=s,J.value={userName:e,certiNo:a,certType:l,objectId:o}}R&&(()=>{const{objectId:e,certType:a}=J.value,l={bizId:R,certType:a,objectId:e,objectType:`${B}`.toLocaleUpperCase(),orderNo:Y,tenantId:D};k(l).then((({code:e,data:a})=>{"10000"===e&&"SUCCESS"===a.status&&(delete T.query.biz_id,delete T.query.nextPageCode,I.push({path:w[`${M}`],query:T.query}))}))})()}}))},Q=()=>{var e,a;null==(a=null==(e=H.value)?void 0:e.validate)||a.call(e).then((()=>{(()=>{const{userName:e,certiNo:a,certType:l}=J.value,t={tenantId:D,faceAuthMode:"TENCENT",callbackUrl:window.location.href,bizNo:Y,userName:e,certiNo:a,certType:l};x(t).then((({code:e,data:a})=>{"10000"===e&&(window.location.href=a.originalUrl)}))})()}))};return s((()=>{K()})),(e,a)=>{const l=N,t=j,o=C,s=_,T=r("ProPageWrap");return d(),i(T,null,{default:c((()=>[n("div",z,[n("div",$,m(`${u(p)[u(B).toLocaleUpperCase()]}手机号验证 ${u(q)(u(G).mobile||"")}`),1),f(o,{ref_key:"formRef",ref:H,"validate-method":"toast",model:u(G)},{default:c((()=>[b(f(l,{modelValue:u(G).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>u(G).mobile=e),label:"被保人手机号",name:"mobile",maxlength:"11",required:""},null,8,["modelValue"]),[[v,!1]]),f(t,{modelValue:u(G).verifyCode,"onUpdate:modelValue":a[1]||(a[1]=e=>u(G).verifyCode=e),"related-name":"mobile",label:" ",maxlength:"6","input-align":"left",placeholder:"请输入验证码",name:"verifyCode",rules:[{required:!0,message:"请输入验证码"}],"send-s-m-s-code":u(y),"check-s-m-s-code":u(g)},null,8,["modelValue","send-s-m-s-code","check-s-m-s-code"])])),_:1},8,["model"]),E,n("div",L,[n("img",{src:u("/static/png/face_img-4ac5b4e1.png"),alt:""},null,8,O)]),S,f(s,{type:"primary",class:"submit-btn",onClick:Q},{default:c((()=>[h("开始验证")])),_:1}),n("div",W,[n("img",{src:u("/static/png/face_tip-d70e081d.png"),alt:""},null,8,A)])])])),_:1})}}}),[["__scopeId","data-v-543f0ab6"]]);export{D as default};
