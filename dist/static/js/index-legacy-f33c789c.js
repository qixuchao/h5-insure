!function(){var e=document.createElement("style");e.innerHTML='.com-risk-list-wrapper .risk-list[data-v-7d3c3028]{height:13.84rem;padding-bottom:2rem}.com-risk-list-wrapper[data-v-7d3c3028] .van-cell-group--inset{border-bottom:0;border-radius:0;margin:0}.com-risk-list-wrapper[data-v-7d3c3028] .van-cell-group--inset .van-cell{padding:.42667rem .53333rem;align-items:center}.com-risk-list-wrapper[data-v-7d3c3028] .van-cell-group--inset .van-cell:after{width:9.6rem}.com-risk-list-wrapper[data-v-7d3c3028] .van-cell-group--inset .van-cell .van-checkbox__icon .van-icon{height:.42667rem;width:.42667rem;border-radius:.05333rem;line-height:.42667rem;font-size:.32rem}.com-risk-list-wrapper .cell-title[data-v-7d3c3028]{display:flex;flex-direction:column}.com-risk-list-wrapper .cell-title .title-desc[data-v-7d3c3028]{font-size:.32rem;font-weight:400;color:#99a9c0}.com-risk-list-wrapper .footer-bar[data-v-7d3c3028]{padding:0 .53333rem;position:absolute;width:100%;height:2rem;bottom:0;display:flex;align-items:center;justify-content:center}.com-personal-info-wrapper .placeholder[data-v-b6a7c104]{color:#99a9c0}.com-risk-card-wrapper.part-card[data-v-3b9c2786]{background-color:#fff;border-bottom:.26667rem solid var(--zaui-global-bg, #f2f5fc)}.com-risk-card-wrapper .delete-risk[data-v-3b9c2786]{display:flex;align-items:center;justify-content:center;margin-top:.06667rem}.com-risk-card-wrapper .delete-risk .svg-icon[data-v-3b9c2786]{font-size:.42667rem}.com-risk-card-wrapper .custom-field[data-v-3b9c2786]{display:flex;flex-direction:column}.com-risk-card-wrapper .custom-field .field-tip[data-v-3b9c2786]{font-size:.32rem;font-weight:400;color:#99a9c0;line-height:1;margin:0 0 .10667rem}.risk-list-wrapper[data-v-4e393d2a]{margin-bottom:3.13333rem}.risk-list-wrapper .add-rider-risk[data-v-4e393d2a]{background-color:#fff;margin-top:-.26667rem;height:1.41333rem;display:flex;align-items:center;justify-content:space-between;padding:var(--van-cell-vertical-padding) var(--van-cell-horizontal-padding)}.risk-list-wrapper .add-rider-risk .left-part[data-v-4e393d2a]{font-weight:400;color:#99a9c0;font-size:.4rem}.risk-list-wrapper .add-rider-risk .btn-rider-risk[data-v-4e393d2a]{border:none;display:flex;align-items:center}.risk-list-wrapper .add-rider-risk .btn-rider-risk .btn-plus[data-v-4e393d2a]{font-size:.58667rem;margin:0 .10667rem .13333rem}.com-product-risk-wrapper .popup-container[data-v-65cbf84c]{background-color:var(--zaui-global-bg, #f2f5fc)}.com-product-risk-wrapper .popup-container .popup-title[data-v-65cbf84c]{height:1.38667rem;display:flex;align-items:center;justify-content:center;padding:0 .85333rem;font-size:.45333rem;font-weight:600;background-color:#fff}.com-product-risk-wrapper .part-card[data-v-65cbf84c]{background-color:#fff}.com-product-risk-wrapper .part-card[data-v-65cbf84c] .body{padding:0}.com-product-risk-wrapper .risk-content[data-v-65cbf84c] .van-collapse-item__title--expanded{padding:0 .4rem 0 0;display:flex;align-items:center}.com-product-risk-wrapper .risk-content[data-v-65cbf84c] .van-collapse-item__content{padding:0}.com-product-risk-wrapper .plan-risk[data-v-65cbf84c] .van-tabs__line{display:none}.com-product-risk-wrapper .footer-bar[data-v-65cbf84c]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4}.com-product-risk-wrapper .footer-bar .trial-result[data-v-65cbf84c]{width:5.86667rem;color:var(--zaui-price, #ff5840);font-size:.32rem;font-weight:600}.com-product-risk-wrapper .footer-bar .trial-result .result-num[data-v-65cbf84c]{font-size:.61333rem;font-weight:500;margin-left:.17333rem}.com-product-risk-wrapper .footer-bar .trial-operate button[data-v-65cbf84c]{width:3.73333rem}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip[data-v-65cbf84c]{position:absolute;z-index:122;height:.56rem;border-radius:1.33333rem;background-color:var(--zaui-price, #ff5840);font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC,sans-serif;font-weight:400;color:#fff;line-height:.49333rem;padding:.04rem .28rem .02667rem .26667rem;right:.4rem;top:-.56rem;display:flex;align-items:center}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip .close-icon[data-v-65cbf84c]{margin-left:.17333rem}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip[data-v-65cbf84c]:after{content:" ";position:absolute;z-index:11;width:0;height:0;border:.13333rem solid transparent;border-top:.13333rem solid #ff5840;border-right:.13333rem solid #ff5840;right:.49333rem;bottom:-.26667rem}\n',document.head.appendChild(e),System.register(["./index-legacy-679c124a.js","./trial-legacy-060aec30.js","./useDicData-legacy-13318281.js","./index-legacy-a2d993eb.js","./index-legacy-2c799a72.js","./trial-legacy-9ce0c2a7.js"],(function(e){"use strict";var i,a,o,t,r,l,n,d,s,u,c,m,p,f,v,k,g,y,b,V,h,I,L,D,O,C,R,w,P,x,A,_,T,F,M,U,N,q,E,j,S,Y,$,z,B,G,K,H,J,W,X,Q,Z,ee,ie,ae,oe,te,re,le,ne,de;return{setters:[function(e){i=e.b7,a=e._,o=e.d,t=e.r,r=e.J,l=e.o,n=e.an,d=e.c,s=e.h,u=e.f,c=e.w,m=e.j,p=e.g,f=e.a7,v=e.F,k=e.i,g=e.e,y=e.l,b=e.t,V=e.n,h=e.v,I=e.C,L=e.q,D=e.x,O=e.B,C=e.b3,R=e.X,w=e.Y,P=e.S,x=e.b8,A=e.E,_=e.ad,T=e.k,F=e.aM,M=e.aF,U=e.y,N=e.m,q=e.aW,E=e.b9,j=e.aE,S=e.V,Y=e.aV,$=e.ap,z=e.aj,B=e.aG,G=e.ba,K=e.aD,H=e.ae,J=e.P},function(e){W=e.S,X=e.d,Q=e.e,Z=e.f,ee=e.A,ie=e.g,ae=e.L,oe=e.h},function(e){te=e.u},function(e){re=e.S},function(e){le=e.P},function(e){ne=e.i,de=e.p}],execute:function(){e("u",i({id:"createProposal",state:()=>({proposalInfo:{},trialData:[],excludeProduct:[],proposalId:0}),actions:{setProposalInfo(e){this.$state.proposalInfo=e},setTrialData(e){this.$state.trialData=e},setExcludeProduct(e){this.$state.excludeProduct=e}}}));const se={class:"com-risk-list-wrapper"},ue=(e=>(R("data-v-7d3c3028"),e=e(),w(),e))((()=>m("div",{class:"popup-title"},"选择附加险",-1))),ce={class:"risk-list"},me={class:"cell-title"},pe={class:"title"},fe={class:"footer-button"},ve=o({__name:"index",props:{riskList:{default:()=>[]},show:{type:Boolean,default:!1},collocationList:{default:()=>[]},disabled:{default:()=>[]},modelValue:{default:()=>[]}},emits:["finished","close","update:modelValue"],setup(e,{emit:i}){const a=e,o=t([]),R=t([]),w=t([...a.disabled]),P=r({show:a.show,currentChecked:[...a.modelValue]}),x=e=>{var i,t,r;if(w.value.includes(e))return;((e,i)=>{if(!a.collocationList.length)return i?void(P.currentChecked=[]):void P.currentChecked.push(e);let o=P.currentChecked,t=w.value;i?(a.collocationList.forEach((i=>{e===i.riskId&&(2===i.collocationType?o=o.filter((a=>a!==i.collocationRiskId||a!==e)):3===i.collocationType?(o=o.filter((i=>i!==e)),t=t.filter((e=>e!==i.collocationRiskId))):o=o.filter((i=>i!==e)))})),P.currentChecked=o,w.value=t):(a.collocationList.forEach((a=>{e===a.riskId&&(i||(2===a.collocationType?o.push(a.collocationRiskId):3===a.collocationType&&t.push(a.collocationRiskId),o.push(e)))})),P.currentChecked.push(...o),w.value=t)})(e,P.currentChecked.includes(e)),null==o||null===(i=o.value)||void 0===i||null===(t=i[e])||void 0===t||null===(r=t.toggle)||void 0===r||r.call(t)},A=()=>{i("close")},_=()=>{const e=a.riskList.filter((e=>P.currentChecked.includes(e.id)));i("update:modelValue",[...new Set(R.value)]),i("finished",e,w.value),i("close")};return l((()=>{o.value=[]})),n((()=>P.currentChecked),(e=>{R.value=e}),{deep:!0,immediate:!0}),n((()=>a.modelValue),(e=>{R.value=e||[],w.value.push(...e||[])}),{deep:!0,immediate:!0}),(i,a)=>{const t=h,r=I,l=L,n=D,T=O,F=C;return d(),s("div",se,[u(F,{show:p(P).show,"onUpdate:show":a[1]||(a[1]=e=>p(P).show=e),title:"选择附加险","show-footer":"",round:"",position:"bottom",closeable:"",onClose:A},{default:c((()=>[ue,m("div",ce,[u(n,{modelValue:p(R),"onUpdate:modelValue":a[0]||(a[0]=e=>f(R)?R.value=e:null)},{default:c((()=>[u(l,{inset:""},{default:c((()=>[(d(!0),s(v,null,k(e.riskList,(e=>(d(),g(r,{key:e.id,title:e.riskName,disabled:p(w).includes(e.id),onClick:i=>x(e.id)},{"right-icon":c((()=>[u(t,{ref_for:!0,ref:i=>p(o)[e.id]=i,shape:"square",disabled:p(w).includes(e.id),name:e.id,onClick:y((i=>x(e.id)),["stop"])},null,8,["disabled","name","onClick"])])),title:c((()=>[m("div",me,[m("div",pe,b(e.riskName),1)])])),_:2},1032,["title","disabled","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])]),m("div",fe,[u(T,{type:"primary",disabled:!p(P).currentChecked.length,block:"",onClick:_},{default:c((()=>[V("确认")])),_:1},8,["disabled"])])])),_:1},8,["show"])])}}});var ke=e("R",a(ve,[["__scopeId","data-v-7d3c3028"]]));const ge={class:"com-personal-info-wrapper"},ye={class:"pro-radio-wrap"},be={class:"pro-radio-wrap"};var Ve=a(o({__name:"index",props:{formInfo:{default:()=>({})},insuredCode:{default:""},factorList:{default:()=>[]},ageRange:{default:()=>[]}},setup(e,{expose:i}){var a,o;const l=e,n=te(`${null===(a=l.insuredCode)||void 0===a||null===(o=a.toLocaleUpperCase)||void 0===o?void 0:o.call(a)}_OCCUPATION`),[v,k]=P(),y=t(),b=x("source")||{},V=r({formInfo:l.formInfo,occupationalText:"",occupationCodeList:[]}),h=A((()=>{const e=(e=>{const i=e||[];for(let a=0,o=i.length;a<o;a++)for(let e=a+1;e<o;e++){const o=i[a].split("_"),t=i[e].split("_"),r=i[a];o[0]===t[0]?o>t&&(i[a]=i[e],i[e]=r):"age"===o[0]&&(i[a]=i[e],i[e]=r)}return i})(null==l?void 0:l.ageRange),i=(e="")=>[+e.split("_")[1],e.split("_")[0]],a=i(e[0]),o=i(e[e.length-1]),t=_().subtract(a[0],"age"===a[1]?"year":"day").format("YYYY-MM-DD");let r=_().subtract(o[0],"age"===o[1]?"year":"day").format("YYYY-MM-DD");return _(r).subtract(1,"year").isBefore(t)&&(r=_(r).subtract(1,"year").add(1,"day").format("YYYY-MM-DD")),{minAge:new Date(r),maxAge:new Date(t)}}));return i({validateForm:()=>new Promise(((e,i)=>{var a;null===(a=y.value)||void 0===a||a.validate().then((()=>{e("")}),(e=>{var a;null===(a=y.value)||void 0===a||a.scrollToField(null==e?void 0:e[0].name),i()}))})),ageRangeObj:h.value}),(i,a)=>{const o=U,t=N,r=q,l=E,I=C;return d(),s("div",ge,[u(r,{ref_key:"formRef",ref:y,"input-align":"right","error-message-align":"right"},{default:c((()=>["proposal"===p(b).type&&("add"===p(b).type||"repeatAdd"===p(b).type)||"proposal"!==p(b).type&&(e.factorList.includes("APPLICANT.AGE")||e.factorList.includes("AGE")||e.factorList.includes("DAY")||e.factorList.includes("APPLICANT.DAY"))?(d(),g(o,{key:0,modelValue:p(V).formInfo.birthday,"onUpdate:modelValue":a[0]||(a[0]=e=>p(V).formInfo.birthday=e),rules:[{required:!0,message:"请选择出生日期"}],name:"birth",label:"出生日期",class:"isLink",readonly:"","is-link":"",formatter:e=>e?p(_)(e).format("YYYY-MM-DD"):e,placeholder:"请选择",onClick:a[1]||(a[1]=e=>p(k)(!0))},null,8,["modelValue","formatter"])):T("",!0),"proposal"===p(b).type&&("add"===p(b).type||"repeatAdd"===p(b).type)||"proposal"!==p(b).type&&(e.factorList.includes("APPLICANT.GENDER")||e.factorList.includes("GENDER"))?(d(),g(o,{key:1,modelValue:p(V).formInfo.gender,"onUpdate:modelValue":a[3]||(a[3]=e=>p(V).formInfo.gender=e),name:"gender",label:"性别",rules:[{required:!0,message:"请选择性别"}]},{input:c((()=>[m("div",ye,[u(t,{modelValue:p(V).formInfo.gender,"onUpdate:modelValue":a[2]||(a[2]=e=>p(V).formInfo.gender=e),options:p(F)},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):T("",!0),e.factorList.includes("SOCIAL_INS")||e.factorList.includes("APPLICANT.SOCIAL_INS")?(d(),g(o,{key:2,modelValue:p(V).formInfo.socialFlag,"onUpdate:modelValue":a[5]||(a[5]=e=>p(V).formInfo.socialFlag=e),name:"socialFlag",label:"社保",rules:[{required:!0,message:"请选择社保"}]},{input:c((()=>[m("div",be,[u(t,{modelValue:p(V).formInfo.socialFlag,"onUpdate:modelValue":a[4]||(a[4]=e=>p(V).formInfo.socialFlag=e),options:p(W)},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):T("",!0),e.factorList.includes("OCCUPATION_CATEGORY")||e.factorList.includes("APPLICANT.OCCUPATION_CATEGORY")?(d(),g(M,{key:3,modelValue:p(V).formInfo.occupationCodeList[0],"onUpdate:modelValue":a[6]||(a[6]=e=>p(V).formInfo.occupationCodeList[0]=e),field0:p(V).formInfo.occupationCodeList[0],"onUpdate:field0":a[7]||(a[7]=e=>p(V).formInfo.occupationCodeList[0]=e),field1:p(V).formInfo.occupationCodeList[1],"onUpdate:field1":a[8]||(a[8]=e=>p(V).formInfo.occupationCodeList[1]=e),field2:p(V).formInfo.occupationCodeList[2],"onUpdate:field2":a[9]||(a[9]=e=>p(V).formInfo.occupationCodeList[2]=e),required:"",name:"occupationCodeList",label:"职业类型","data-source":p(n),mapping:{label:"value",value:"code",children:"children"},"show-full-value":"","need-key":"name"},null,8,["modelValue","field0","field1","field2","data-source"])):T("",!0)])),_:1},512),u(I,{show:p(v),"onUpdate:show":a[12]||(a[12]=e=>f(v)?v.value=e:null),position:"bottom"},{default:c((()=>[u(l,{type:"date","min-date":p(h).minAge,"max-date":p(h).maxAge,onConfirm:a[10]||(a[10]=e=>{p(V).formInfo.birthday=p(_)(e).format("YYYY-MM-DD"),p(k)(!1)}),onCancel:a[11]||(a[11]=e=>p(k)(!1))},null,8,["min-date","max-date"])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-b6a7c104"]]);const he={class:"com-risk-card-wrapper part-card"},Ie={class:"custom-field"},Le={class:"field-tip"},De={class:"custom-field"},Oe={class:"field-tip"},Ce={class:"custom-field"},Re={class:"field-tip"},we={class:"pro-radio-wrap"},Pe={class:"pro-radio-wrap"},xe={class:"pro-radio-wrap"},Ae={class:"pro-radio-wrap"},_e={class:"pro-radio-wrap"},Te={key:0},Fe={key:1,class:"pro-radio-wrap"},Me={key:9,class:"liab-desc"};var Ue=a(o({__name:"index",props:{originData:{default:()=>({})},formInfo:{default:()=>({})},mainRiskData:{default:()=>({})},mainRiskInfo:{default:()=>({})},index:{default:0},removeRisk:{type:Function,default:()=>{}},removeRiskList:{default:()=>[]},enums:{default:()=>({})}},setup(e){const i=e,a=t({}),o=x("premium")||{};a.value=x("enumList")||{};const l=t({chargePeriod:{disabled:!1,prevent:!1},coveragePeriod:{disabled:!1,prevent:!1},paymentFrequency:{disabled:!1,prevent:!1}}),f=r({formInfo:i.formInfo}),y=e=>"boolean"!=typeof e&&!e||(!(!Array.isArray(e)||e.length)||"[object Object]"==={}.toString.call(e)&&Object.keys(e).length),V=(e,i,a={})=>{let o=i;return Array.isArray(i)||(o=[`${o}`]),(e||[]).filter((e=>o.includes(`${e.value}`)||o.includes(e.value)))},h=A((()=>{var e,a,o,t,r,l,n,d;return 1===(null===(e=i.originData)||void 0===e?void 0:e.riskType)?V(i.enums.RISK_INSURANCE_PERIOD,(null===(l=i.originData.riskInsureLimitVO)||void 0===l?void 0:l.insurancePeriodValueList)||[]):2===(null===(a=i.originData)||void 0===a?void 0:a.periodType)?V([{value:"year_1",name:"1年"}],["year_1"]):1===(null===(o=i.originData)||void 0===o?void 0:o.exemptFlag)?V(X,[`${null==i||null===(n=i.originData)||void 0===n||null===(d=n.riskInsureLimitVO)||void 0===d?void 0:d.insurancePeriodRule}`]):V(null===(t=i.enums)||void 0===t?void 0:t.RISK_INSURANCE_PERIOD,(null===(r=i.mainRiskData.riskInsureLimitVO)||void 0===r?void 0:r.insurancePeriodValueList)||[])})),I=A((()=>{var e,a,o,t,r,l,n,d;return 1===(null===(e=i.originData)||void 0===e?void 0:e.riskType)?V(null==i||null===(r=i.enums)||void 0===r?void 0:r.RISK_PAYMENT_PERIOD,(null===(l=i.originData.riskInsureLimitVO)||void 0===l?void 0:l.paymentPeriodValueList)||[]):1===(null===(a=i.originData)||void 0===a?void 0:a.exemptFlag)?V(Q,[`${null==i||null===(n=i.originData)||void 0===n||null===(d=n.riskInsureLimitVO)||void 0===d?void 0:d.paymentPeriodRule}`]):2===(null===(o=i.originData)||void 0===o?void 0:o.periodType)?V([{value:"year_1",name:"1年交"}],["year_1"]):V(i.enums.RISK_PAYMENT_PERIOD,(null===(t=i.mainRiskData.riskInsureLimitVO)||void 0===t?void 0:t.paymentPeriodValueList)||[])})),L=A((()=>{var e,a,o,t,r;return 1===(null===(e=i.originData)||void 0===e?void 0:e.riskType)?V(Z,(null===(t=i.originData.riskInsureLimitVO)||void 0===t?void 0:t.paymentFrequencyList)||[]):1===(null===(a=i.originData.riskInsureLimitVO)||void 0===a?void 0:a.paymentTypeRule)?V(Z,(null===(r=i.mainRiskData.riskInsureLimitVO)||void 0===r?void 0:r.paymentFrequencyList)||[]):V(Z,(null===(o=i.mainRiskData.riskInsureLimitVO)||void 0===o?void 0:o.paymentFrequencyList)||[])})),D=A((()=>{var e,a;let o=0,t=0;return((null===(e=i.originData)||void 0===e||null===(a=e.riskCalcMethodInfoVO)||void 0===a?void 0:a.paymentMethodLimitList)||[]).forEach(((e,i)=>{0===i&&(o=e.minAmount,t=e.maxAmount),o>e.minAmount&&(o=e.minAmount),t<e.maxAmount&&(t=e.maxAmount)})),f.formInfo.amount=f.formInfo.amount||o,{min:o,max:t||1/0}})),O=A((()=>{var e,a;let o=0,t=0;return((null===(e=i.originData)||void 0===e||null===(a=e.riskCalcMethodInfoVO)||void 0===a?void 0:a.paymentMethodLimitList)||[]).forEach(((e,i)=>{0===i&&(o=e.minPremium,t=e.maxPremium),o>e.minPremium&&(o=e.minPremium),t<e.maxPremium&&(t=e.maxPremium)})),f.formInfo.premium=f.formInfo.premium||o,{min:o,max:t||1/0}})),C=A((()=>{var e,a,o,t;const r=(null===(e=i.originData)||void 0===e||null===(a=e.riskCalcMethodInfoVO)||void 0===a?void 0:a.minCopy)||1,l=null===(o=i.originData)||void 0===o||null===(t=o.riskCalcMethodInfoVO)||void 0===t?void 0:t.maxCopy;return f.formInfo.copy=`${f.formInfo.copy||r||1}`,{min:r,max:l}})),R=(e,a,o)=>{var t,r;const l=(null===(t=i.originData)||void 0===t||null===(r=t.riskCalcMethodInfoVO)||void 0===r?void 0:r.increaseDecreaseNum)||1;if("sumInsured"===o){if(D.value.max&&+e>D.value.max)return`金额最大${D.value.max}元`;if(+e<D.value.min)return`金额最小${D.value.min}元`}else{if(O.value.max&&+e>O.value.max)return`金额最大${O.value.max}元`;if(+e<O.value.min)return`金额最小${O.value.min}元`}return+e%l==0?"":`金额必须是${l}的倍数`},w=e=>{var i;const a=((null===(i=f.formInfo)||void 0===i?void 0:i.liabilityVOList)||[]).find((i=>i.liabilityCode===e.liabilityCode));return a?a.liabilityAttributeValue?a.liabilityAttributeValue:1!==e.optionalFlag?"0":"-1":""};return j((()=>{var e,a,o,t;const r={riskType:i.originData.riskType,riskId:i.originData.id,riskName:i.originData.riskName,riskCode:i.originData.riskCode,amount:f.formInfo.amount,mainRiskCode:1!==i.originData.riskType?null===(e=i.mainRiskData)||void 0===e?void 0:e.riskCode:void 0,mainRiskId:1!==i.originData.riskType?null===(a=i.mainRiskData)||void 0===a?void 0:a.id:void 0,exemptFlag:i.originData.exemptFlag,exemptType:i.originData.exemptType,riskCategory:i.originData.riskCategory,liabilityVOList:(i.originData.riskLiabilityInfoVOList||[]).map((e=>({...e,liabilityAttributeCode:e.liabilityAttributeType,liabilityCode:e.liabilityCode,liabilityRateType:e.liabilityRateType,liabilityAttributeValue:w(e)})))};[1].includes((null===(o=i.originData.riskCalcMethodInfoVO)||void 0===o?void 0:o.saleMethod)||0)&&1!==(null===(t=i.originData)||void 0===t?void 0:t.exemptFlag)||!i.originData.riskCalcMethodInfoVO.fixedAmount||(r.amount=i.originData.riskCalcMethodInfoVO.fixedAmount),Object.assign(f.formInfo,r)})),n((()=>{var e;return null===(e=f.formInfo)||void 0===e?void 0:e.paymentFrequency}),((e=0)=>{var a,o,t;[3].includes((null===(a=i.originData.riskCalcMethodInfoVO)||void 0===a?void 0:a.saleMethod)||0)&&((null===(o=i.originData)||void 0===o||null===(t=o.riskCalcMethodInfoVO)||void 0===t?void 0:t.paymentMethodLimitList)||[]).forEach((i=>{+i.paymentFrequency==+e&&Object.assign(f.formInfo,{amount:i.perCopyAmount,premium:i.perCopyPremium})}));1==+e&&"single"!==f.formInfo.chargePeriod&&(f.formInfo.chargePeriod="single")})),n((()=>{var e;return null===(e=f.formInfo)||void 0===e?void 0:e.copy}),(e=>{var a,o;4===(null===(a=i.originData.riskCalcMethodInfoVO)||void 0===a?void 0:a.saleMethod)&&(f.formInfo.amount=null===(o=i.originData.riskCalcMethodInfoVO)||void 0===o?void 0:o.fixedAmount)})),n((()=>{var e;return null===(e=f.formInfo)||void 0===e?void 0:e.chargePeriod}),(e=>{"single"===e&&1!=+(f.formInfo.paymentFrequency||0)&&(f.formInfo.paymentFrequency=1)})),n((()=>null==i?void 0:i.mainRiskInfo),(e=>{var a,o,t,r,n,d;e&&2===i.originData.riskType&&(1===(null===(a=i.originData)||void 0===a||null===(o=a.riskInsureLimitVO)||void 0===o?void 0:o.insurancePeriodRule)&&(e.coveragePeriod?l.value.coveragePeriod.disabled=!0:l.value.coveragePeriod.prevent=!0,f.formInfo.coveragePeriod=e.coveragePeriod||""),1===(null===(t=i.originData)||void 0===t||null===(r=t.riskInsureLimitVO)||void 0===r?void 0:r.paymentPeriodRule)&&(e.chargePeriod?l.value.chargePeriod.disabled=!0:l.value.chargePeriod.prevent=!0,f.formInfo.chargePeriod=e.chargePeriod||""),1===(null===(n=i.originData)||void 0===n||null===(d=n.riskInsureLimitVO)||void 0===d?void 0:d.paymentTypeRule)&&(e.paymentFrequency?l.value.paymentFrequency.disabled=!0:l.value.paymentFrequency.prevent=!0,f.formInfo.paymentFrequency=e.paymentFrequency||0))}),{immediate:!0,deep:!0}),(i,a)=>{var t,r,n,w,P,x,A,_,F,M,q,E,j,z,B,G,K,H,J,W,X,Q,Z,te,ne,de,se,ue,ce,me;const pe=S,fe=Y,ve=re,ke=U,ge=N,ye=$;return d(),s("div",he,[u(fe,{"risk-type":e.originData.riskType,title:e.originData.riskName},{default:c((()=>[e.removeRiskList.includes(e.originData.id)?(d(),s("div",{key:0,class:"delete-risk",onClick:a[0]||(a[0]=i=>e.removeRisk(e.originData.id))},[u(pe,{name:"img-lajitong",color:"#0d6efe"})])):T("",!0)])),_:1},8,["risk-type","title"]),1===(null===(t=e.originData.riskCalcMethodInfoVO)||void 0===t?void 0:t.saleMethod)&&2===e.originData.exemptFlag?(d(),g(ke,{key:0,modelValue:p(f).formInfo.amount,"onUpdate:modelValue":a[2]||(a[2]=e=>p(f).formInfo.amount=e),label:"保额",name:"amount",rules:[{required:!0,message:"请填写"},{trigger:"onChange",validator:(...e)=>R(...e,"sumInsured")}]},{input:c((()=>{var i,o;return[m("div",Ie,[u(ve,{modelValue:p(f).formInfo.amount,"onUpdate:modelValue":a[1]||(a[1]=e=>p(f).formInfo.amount=e),"input-width":"64px",min:p(D).min,step:(null===(i=e.originData.riskCalcMethodInfoVO)||void 0===i?void 0:i.increaseDecreaseNum)||1,max:p(D).max},null,8,["modelValue","min","step","max"]),m("span",Le,b(`金额最低${p(D).min}元，为${(null===(o=e.originData.riskCalcMethodInfoVO)||void 0===o?void 0:o.increaseDecreaseNum)||1}的倍数`),1)])]})),_:1},8,["modelValue","rules"])):T("",!0),2===(null===(r=e.originData)||void 0===r||null===(n=r.riskCalcMethodInfoVO)||void 0===n?void 0:n.saleMethod)?(d(),g(ke,{key:1,modelValue:p(f).formInfo.premium,"onUpdate:modelValue":a[4]||(a[4]=e=>p(f).formInfo.premium=e),label:"保费",name:"premium",rules:[{required:!0,message:"请填写"},{trigger:"onChange",validator:(...e)=>R(...e,"premium")}]},{input:c((()=>{var i,o,t,r;return[m("div",De,[u(ve,{modelValue:p(f).formInfo.premium,"onUpdate:modelValue":a[3]||(a[3]=e=>p(f).formInfo.premium=e),step:(null===(i=e.originData)||void 0===i||null===(o=i.riskCalcMethodInfoVO)||void 0===o?void 0:o.increaseDecreaseNum)||1,min:p(O).min,"input-width":"64px",max:p(O).max},null,8,["modelValue","step","min","max"]),m("span",Oe,b(`金额最低${p(O).min}元，为${(null===(t=e.originData)||void 0===t||null===(r=t.riskCalcMethodInfoVO)||void 0===r?void 0:r.increaseDecreaseNum)||1}的倍数`),1)])]})),_:1},8,["modelValue","rules"])):T("",!0),3===(null===(w=e.originData)||void 0===w||null===(P=w.riskCalcMethodInfoVO)||void 0===P?void 0:P.saleMethod)||4===(null===(x=e.originData)||void 0===x||null===(A=x.riskCalcMethodInfoVO)||void 0===A?void 0:A.saleMethod)&&(null!==(_=e.originData)&&void 0!==_&&null!==(F=_.riskCalcMethodInfoVO)&&void 0!==F&&F.minCopy||null!==(M=e.originData)&&void 0!==M&&null!==(q=M.riskCalcMethodInfoVO)&&void 0!==q&&q.maxCopy)?(d(),g(ke,{key:2,modelValue:p(f).formInfo.copy,"onUpdate:modelValue":a[6]||(a[6]=e=>p(f).formInfo.copy=e),label:"投保份数",name:"copy",rules:[{required:!0,message:"请填写"}]},{input:c((()=>[m("div",Ce,[u(ve,{modelValue:p(f).formInfo.copy,"onUpdate:modelValue":a[5]||(a[5]=e=>p(f).formInfo.copy=e),step:1,min:p(C).min,max:p(C).max},null,8,["modelValue","min","max"]),m("span",Re,b(`${p(C).min}份起购，最多购买${p(C).max}份`),1)])])),_:1},8,["modelValue"])):T("",!0),[1].includes((null===(E=e.originData.riskCalcMethodInfoVO)||void 0===E?void 0:E.saleMethod)||0)&&1!==(null===(j=e.originData)||void 0===j?void 0:j.exemptFlag)||!(e.originData.riskCalcMethodInfoVO.fixedAmount||null!==(z=p(o))&&void 0!==z&&z[null===(B=e.originData)||void 0===B?void 0:B.riskCode])?T("",!0):(d(),g(ke,{key:3,label:"保额"},{input:c((()=>{var i,a,t,r;return[m("div",null,b((null===(i=e.originData.riskCalcMethodInfoVO)||void 0===i?void 0:i.fixedAmount)||(null===(a=p(o))||void 0===a||null===(t=a[null===(r=e.originData)||void 0===r?void 0:r.riskCode])||void 0===t?void 0:t.amount)),1)]})),_:1})),y(null===(G=e.originData)||void 0===G||null===(K=G.riskInsureLimitVO)||void 0===K?void 0:K.insurancePeriodValueList)&&y(null===(H=e.originData)||void 0===H||null===(J=H.riskInsureLimitVO)||void 0===J?void 0:J.insurancePeriodRule)?T("",!0):(d(),g(ye,{key:4,modelValue:p(f).formInfo.coveragePeriod,"onUpdate:modelValue":a[8]||(a[8]=e=>p(f).formInfo.coveragePeriod=e),label:"保障期间",name:"coveragePeriod",rules:[{required:!0,message:"请选择保障期间"}]},{input:c((()=>[m("div",we,[u(ge,{modelValue:p(f).formInfo.coveragePeriod,"onUpdate:modelValue":a[7]||(a[7]=e=>p(f).formInfo.coveragePeriod=e),disabled:p(l).coveragePeriod.disabled,prevent:p(l).coveragePeriod.prevent?"请先选择主险保障期间":"",options:p(h),prop:{label:"name",value:"value"}},null,8,["modelValue","disabled","prevent","options"])])])),_:1},8,["modelValue"])),y(null===(W=e.originData)||void 0===W||null===(X=W.riskInsureLimitVO)||void 0===X?void 0:X.paymentPeriodValueList)&&y(null===(Q=e.originData)||void 0===Q||null===(Z=Q.riskInsureLimitVO)||void 0===Z?void 0:Z.paymentPeriodRule)?T("",!0):(d(),g(ye,{key:5,modelValue:p(f).formInfo.chargePeriod,"onUpdate:modelValue":a[10]||(a[10]=e=>p(f).formInfo.chargePeriod=e),label:"交费期间",name:"chargePeriod",rules:[{required:!0,message:"请选择交费期间"}]},{input:c((()=>[m("div",Pe,[u(ge,{modelValue:p(f).formInfo.chargePeriod,"onUpdate:modelValue":a[9]||(a[9]=e=>p(f).formInfo.chargePeriod=e),disabled:p(l).chargePeriod.disabled,prevent:p(l).chargePeriod.prevent?"请先选择主险交费期间":"",options:p(I),prop:{label:"name",value:"value"}},null,8,["modelValue","disabled","prevent","options"])])])),_:1},8,["modelValue"])),y(null===(te=e.originData.riskInsureLimitVO)||void 0===te?void 0:te.paymentFrequencyList)&&y(null===(ne=e.originData.riskInsureLimitVO)||void 0===ne?void 0:ne.paymentPeriodRule)?T("",!0):(d(),g(ye,{key:6,modelValue:p(f).formInfo.paymentFrequency,"onUpdate:modelValue":a[12]||(a[12]=e=>p(f).formInfo.paymentFrequency=e),label:"交费方式",name:"paymentFrequency",rules:[{required:!0,message:"请选择交费方式"}]},{input:c((()=>[m("div",xe,[u(ge,{modelValue:p(f).formInfo.paymentFrequency,"onUpdate:modelValue":a[11]||(a[11]=e=>p(f).formInfo.paymentFrequency=e),disabled:p(l).paymentFrequency.disabled,prevent:p(l).paymentFrequency.prevent?"请先选择主险交费方式":"",options:p(L)},null,8,["modelValue","disabled","prevent","options"])])])),_:1},8,["modelValue"])),y(null===(de=e.originData)||void 0===de||null===(se=de.riskInsureLimitVO)||void 0===se?void 0:se.annuityDrawValueList)?T("",!0):(d(),g(ye,{key:7,modelValue:p(f).formInfo.annuityDrawDate,"onUpdate:modelValue":a[14]||(a[14]=e=>p(f).formInfo.annuityDrawDate=e),label:"领取时间",name:"annuityDrawDate"},{input:c((()=>{var i;return[m("div",Ae,[u(ge,{modelValue:p(f).formInfo.annuityDrawDate,"onUpdate:modelValue":a[13]||(a[13]=e=>p(f).formInfo.annuityDrawDate=e),options:V(p(ee),(null===(i=e.originData.riskInsureLimitVO)||void 0===i?void 0:i.annuityDrawValueList)||[])},null,8,["modelValue","options"])])]})),_:1},8,["modelValue"])),y(null===(ue=e.originData)||void 0===ue||null===(ce=ue.riskInsureLimitVO)||void 0===ce?void 0:ce.annuityDrawFrequencyList)?T("",!0):(d(),g(ye,{key:8,modelValue:p(f).formInfo.annuityDrawType,"onUpdate:modelValue":a[16]||(a[16]=e=>p(f).formInfo.annuityDrawType=e),label:"领取方式",name:"annuityDrawType"},{input:c((()=>{var i;return[m("div",_e,[u(ge,{modelValue:p(f).formInfo.annuityDrawType,"onUpdate:modelValue":a[15]||(a[15]=e=>p(f).formInfo.annuityDrawType=e),options:V(p(ie),(null===(i=e.originData.riskInsureLimitVO)||void 0===i?void 0:i.annuityDrawFrequencyList)||[])},null,8,["modelValue","options"])])]})),_:1},8,["modelValue"])),(d(!0),s(v,null,k(e.originData.riskLiabilityInfoVOList||[],((i,a)=>(d(),s(v,{key:a},[1!==i.optionalFlag||y(i.liabilityAttributeValueList)?T("",!0):(d(),g(ke,{key:0,modelValue:p(f).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>p(f).formInfo.liabilityVOList[a].liabilityAttributeValue=e,label:i.liabilityName,name:"liabilityAttributeValue",rules:[{required:i.liabilityAttributeValue,message:`请选择${i.liabilityName}`}]},{input:c((()=>{var o,t;return[m("div",null,[y(i.liabilityAttributeValueList)?(d(),s("span",Te,"50万")):(d(),s("div",Fe,[u(ge,{modelValue:p(f).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>p(f).formInfo.liabilityVOList[a].liabilityAttributeValue=e,options:V(p(ae),null===(o=e.originData.riskLiabilityInfoVOList)||void 0===o||null===(t=o[a])||void 0===t?void 0:t.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"])]))])]})),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])),1!==i.optionalFlag?(d(),g(ke,{key:1,modelValue:p(f).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>p(f).formInfo.liabilityVOList[a].liabilityAttributeValue=e,label:i.liabilityName,name:"liabilityAttributeValue"},{input:c((()=>{var o,t;return[m("div",null,[y(i.liabilityAttributeValueList)?(d(),g(ge,{key:0,modelValue:p(f).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>p(f).formInfo.liabilityVOList[a].liabilityAttributeValue=e,options:p(oe)},null,8,["modelValue","onUpdate:modelValue","options"])):(d(),g(ge,{key:1,modelValue:p(f).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>p(f).formInfo.liabilityVOList[a].liabilityAttributeValue=e,options:V(p(ae),null===(o=e.originData.riskLiabilityInfoVOList)||void 0===o||null===(t=o[a])||void 0===t?void 0:t.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]})),_:2},1032,["modelValue","onUpdate:modelValue","label"])):T("",!0)],64)))),128)),null!==(me=e.originData)&&void 0!==me&&me.relationDesc?(d(),s("div",Me,[u(le,{title:"责任投保说明"},{default:c((()=>[m("div",null,b(e.originData.relationDesc),1)])),_:1})])):T("",!0)])}}}),[["__scopeId","data-v-3b9c2786"]]);const Ne={class:"risk-list-wrapper"},qe={key:0,class:"add-rider-risk"},Ee={class:"left-part"},je=(e=>(R("data-v-4e393d2a"),e=e(),w(),e))((()=>m("span",{class:"btn-plus"},"+",-1)));var Se=a(o({__name:"index",props:{riskInfo:{default:()=>({})},originData:{default:()=>[]},pickFactor:{type:Function,default:()=>{}},enums:{default:()=>{}}},setup(e){const i=e,a=x("source")||{},[o,l]=P(!1);t(null),t(null);const f=r({mainRiskInfo:i.riskInfo,riskInfo:i.riskInfo,requiredRiderRiskData:[],mainRiskData:{},riderRiskList:[],checkedList:[],relationListNum:0,disabledList:[],currentRiskList:[]}),y=(e,i)=>{f.currentRiskList=f.currentRiskList.concat(e),f.disabledList=i},h=e=>{z.confirm({message:"确定要删除附加险么？",confirmButtonText:"删除"}).then((()=>{var i;const a=[e];((null===(i=f.mainRiskData)||void 0===i?void 0:i.collocationVOList)||[]).forEach((i=>{e!==i.riskId||2!==i.collocationType&&3!==i.collocationType||a.push(i.collocationRiskId)})),f.checkedList=f.checkedList.filter((e=>!a.includes(e))),f.currentRiskList=f.currentRiskList.filter((e=>!a.includes(e.id)||(Object.assign(f.riskInfo,{[e.id]:void 0}),!1))),f.disabledList=f.disabledList.filter((e=>!a.includes(e)))})).catch((()=>{}))},I=(e,i)=>{var a,o;const t=((null===(a=f.riskInfo)||void 0===a||null===(o=a[i])||void 0===o?void 0:o.liabilityVOList)||[]).find((i=>i.liabilityCode===e.liabilityCode));return t?t.liabilityAttributeValue?t.liabilityAttributeValue:1!==e.optionalFlag?"0":"-1":""};return n((()=>f.currentRiskList),(e=>{const a=[f.mainRiskData,...e];let o=[],t=[];const r=[];a.forEach(((e,i)=>{var a,l,n;const d=(null==e||null===(a=e.riskCalcMethodInfoVO)||void 0===a?void 0:a.riskFactorRelationList)||[];o=o.concat(d.filter((e=>"insured"===e.factorObject)).map((e=>e.factorCode))),t=t.concat(d.filter((e=>"holder"===e.factorObject)).map((e=>e.factorCode))),r.push(null==e||null===(l=e.riskInsureLimitVO)||void 0===l?void 0:l.minHolderAge,null==e||null===(n=e.riskInsureLimitVO)||void 0===n?void 0:n.maxHolderAge)})),(e||[]).forEach((e=>{var a,o;const t={riskType:e.riskType,riskId:e.id,riskCode:e.riskCode,riskName:e.riskName,mainRiskCode:1!==e.riskType?null===(a=f.mainRiskData)||void 0===a?void 0:a.riskCode:void 0,mainRiskId:1!==e.riskType?null===(o=f.mainRiskData)||void 0===o?void 0:o.id:void 0,riskCategory:e.riskCategory,exemptFlag:i.originData.exemptFlag,exemptType:i.originData.exemptType,liabilityVOList:(e.riskLiabilityInfoVOList||[]).map((i=>({...i,liabilityAttributeCode:i.liabilityAttributeType,liabilityCode:i.liabilityCode,liabilityRateType:i.liabilityRateType,liabilityAttributeValue:I(i,e.id)})))};f.riskInfo[e.id]||Object.assign(f.riskInfo,{[e.id]:t})})),i.pickFactor({insuredFactorList:[...new Set(o)],holderFactorList:[...new Set(t)],ageRange:r})}),{deep:!0,immediate:!0}),n((()=>i.riskInfo),(e=>{f.mainRiskInfo=Object.values(e||{}).find((e=>1===(null==e?void 0:e.riskType)))||{}}),{deep:!0,immediate:!0}),n((()=>i.originData),(e=>{let i=[];const o=[];"proposal"===a.origin&&"add"!==a.type&&"repeatAdd"!==a.type?((e||[]).forEach((e=>{1===e.riskType&&(f.mainRiskData=e),i.push(e)})),i=i.filter((e=>a.showRiskList.includes(e.id)))):(e||[]).forEach((e=>{1===e.riskType?(f.mainRiskData=e,i.push(e)):2===e.collocationType?i.push(e):o.push(e)})),f.riderRiskList=o,f.currentRiskList=i}),{deep:!0,immediate:!0}),(i,t)=>{var r,n,I;const L=B;return d(),s("div",Ne,[(d(!0),s(v,null,k(p(f).currentRiskList,((i,a)=>(d(),g(Ue,{key:i.id,"form-info":p(f).riskInfo[i.id],index:a,enums:e.enums,"main-risk-data":p(f).mainRiskData,"main-risk-info":p(f).mainRiskInfo,"origin-data":i,"remove-risk":h,"remove-risk-list":p(f).checkedList},null,8,["form-info","index","enums","main-risk-data","main-risk-info","origin-data","remove-risk-list"])))),128)),(null===(r=p(f).riderRiskList)||void 0===r?void 0:r.length)-(null===(n=p(f).checkedList)||void 0===n?void 0:n.length)&&"proposal"!==p(a).origin?(d(),s("div",qe,[m("span",Ee,b(`共有${p(f).riderRiskList.length-p(f).checkedList.length}款附加险可以添加`),1),u(L,{activated:"",class:"btn-rider-risk",onClick:t[0]||(t[0]=e=>p(l)(!0))},{default:c((()=>[je,V(" 附加险")])),_:1})])):T("",!0),p(o)?(d(),g(ke,{key:1,modelValue:p(f).checkedList,"onUpdate:modelValue":t[1]||(t[1]=e=>p(f).checkedList=e),show:p(o),disabled:p(f).disabledList,"risk-list":p(f).riderRiskList,"collocation-list":(null===(I=p(f).mainRiskData)||void 0===I?void 0:I.collocationVOList)||[],onFinished:y,onClose:t[2]||(t[2]=e=>p(l)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):T("",!0)])}}}),[["__scopeId","data-v-4e393d2a"]]);const Ye={class:"com-product-risk-wrapper"},$e={class:"popup-container"},ze=(e=>(R("data-v-65cbf84c"),e=e(),w(),e))((()=>m("div",{class:"popup-title"},"请选择保障方案",-1))),Be={class:"risk-trial-wrapper"},Ge={class:"risk-content"},Ke={key:0,class:"risk"},He={class:"footer-bar"},Je=o({__name:"index",props:{isShow:{type:Boolean,default:!1},type:{default:"add"},productId:{default:0},riskType:{default:1},formInfo:{default:{}},productData:{default:()=>({})},holder:{default:()=>({})},insured:{default:()=>({})},riderRisk:{default:()=>[]},currentRisk:{default:()=>[]}},emits:["close","finished"],setup(e,{emit:i}){var a,o;const l=e,f=t({personVO:{occupationCodeList:[],...l.holder}}),v=t({insuredCode:"",personVO:{occupationCodeList:(null===(a=((null===(o=l.insured)||void 0===o?void 0:o.proposalInsuredProductList)||[]).find((e=>e.productId===l.productData.productBasicInfoVO.id)))||void 0===a?void 0:a.occupationCodeList)||[],...l.insured}}),k=t({}),y=t({}),b=t({}),h=t({}),I=t({}),L=r({currentPlan:"0",isShow:l.isShow,riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,enumList:{},ageRange:[],collapseName:["1"],type:l.type});G("premium",I.value),G("source",{type:L.type,origin:"proposal",showRiskList:l.currentRisk});const D=A((()=>{var e;let i="";if(null!==(e=L.riskData)&&void 0!==e&&e[0]){const e=L.riskData[0],a=((null==e?void 0:e.requiredRiderRiskVOList)||[]).map((e=>e.riskName));a.length&&(i=`特殊提示: ${e.riskName}和${a.join("、")}必须同时投保`)}return i})),R=()=>{var e;const a=JSON.parse(JSON.stringify(k.value[L.currentPlan])),o=Object.values(a).find((e=>1===e.riskType)),t=Object.values(a).map((e=>{const i=e;return((e,i)=>{const a=e;if("3"===a.chargePeriod){const e=(i.chargePeriod||"").split("_");if(e[1]-=1,1===a.exemptFlag){if("to"===e[0]){let i=0;var o,t;if(1===a.exemptType)null!==(o=f.value.personVO)&&void 0!==o&&o.birthday&&(i=parseInt(""+(+new Date-new Date(null===(t=f.value.personVO)||void 0===t?void 0:t.birthday))/31536e6,10));else if(2===a.exemptType){var r,l;null!==(r=v.value.personVO)&&void 0!==r&&r.birthday&&(i=parseInt(""+(+new Date-new Date(null===(l=v.value.personVO)||void 0===l?void 0:l.birthday))/31536e6,10))}e[1]=e[1]-i}e[0]="year",a.coveragePeriod=e.join("_")}a.chargePeriod=e.join("_")}})(i,o),i.liabilityVOList=(i.liabilityVOList||[]).filter((e=>1===e.optionalFlag||e.liabilityAttributeValue&&"-1"!==e.liabilityAttributeValue)).map((e=>{const i=e;return"0"===i.liabilityAttributeValue&&(i.liabilityAttributeValue=""),i})),i})),r={holder:f.value,productCode:L.riskBaseInfo.productCode,insuredVOList:[{...v.value,productPlanVOList:[{planCode:L.currentPlan||"",insurerCode:null===(e=L.riskBaseInfo)||void 0===e?void 0:e.insurerCode,riskVOList:t}]}]};de({...r}).then((({code:e,data:a})=>{if("10000"===e){L.retrialTip=!1,L.trialResult=a,L.canTrial=!1;const e={},o=(i=[])=>{(i||[]).forEach((i=>{var a;e[i.riskCode]=i,null!==(a=i.riskPremiumDetailVOList)&&void 0!==a&&a.length&&o(i.riskPremiumDetailVOList)}))};o(a.riskPremiumDetailVOList),Object.assign(I.value,e),i("finished",((e,i)=>{var a,o,t,r,l,n,d,s,u;const c=(e.insuredVOList[0].productPlanVOList[0].riskVOList||[]).map((e=>({...e,premium:i[e.riskCode].premium,amount:i[e.riskCode].amount})));return{proposalHolder:{...null===(a=e.holder)||void 0===a?void 0:a.personVO},proposalInsuredList:[{...e.insuredVOList[0].personVO,dateRange:{min:null===(o=b.value)||void 0===o||null===(t=o.ageRangeObj)||void 0===t?void 0:t.minAge,max:null===(r=b.value)||void 0===r||null===(l=r.ageRangeObj)||void 0===l?void 0:l.maxAge},proposalInsuredProductList:[{productId:L.riskBaseInfo.id,productName:L.riskBaseInfo.productName,dateRange:{min:null===(n=b.value)||void 0===n||null===(d=n.ageRangeObj)||void 0===d?void 0:d.minAge,max:null===(s=b.value)||void 0===s||null===(u=s.ageRangeObj)||void 0===u?void 0:u.maxAge},occupationCodeList:e.insuredVOList[0].personVO.occupationCodeList,proposalProductRiskList:c}]}]}})(r,e))}else L.retrialTip=!0}))},w=()=>{var e,i,a,o,t;Promise.all([null===(e=y.value)||void 0===e||null===(i=e.validateForm)||void 0===i?void 0:i.call(e),null===(a=b.value)||void 0===a||null===(o=a.validateForm)||void 0===o?void 0:o.call(a),null===(t=h.value)||void 0===t?void 0:t.validate()]).then((()=>{R()}))},P=()=>{i("close")},x=e=>{L.holderFactor=e.holderFactorList,L.insuredFactor=e.insuredFactorList,L.ageRange=e.ageRange};return n([()=>k.value,()=>f.value,()=>v.value],(e=>{e&&!L.canTrial&&(L.canTrial=!0,L.retrialTip=!0)}),{deep:!0}),n((()=>l.isShow),(e=>{L.isShow=e}),{immediate:!0}),n((()=>l.productId),(e=>{e&&ne({productId:l.productId,source:2}).then((({code:e,data:i})=>{"10000"===e&&(L.riskBaseInfo=i.productBasicInfoVO,(i.productRiskVoList[0].riskDetailVOList||[]).forEach(((e,i)=>{0===i&&(L.currentPlan=e.planCode||"0"),Object.assign(k.value,{[e.planCode||i]:{}})})),L.riskData=i.productRiskVoList[0].riskDetailVOList||[],L.riskPlanData=i.productRelationPlanVOList||[])})).finally((()=>{}))}),{immediate:!0}),n((()=>l.formInfo),((e={})=>{if("add"!==l.type&&"repeatAdd"!==l.type){const i={};e.proposalProductRiskList.forEach((e=>{i[e.riskId]=e})),Object.assign(k.value,{0:i})}}),{deep:!0,immediate:!0}),n((()=>l.productData),(e=>{var i;"add"!==l.type&&"repeatAdd"!==l.type&&(L.riskBaseInfo=e.productBasicInfoVO,L.riskData=(null===(i=e.productRiskVoList)||void 0===i?void 0:i[0].riskDetailVOList)||[])}),{deep:!0,immediate:!0}),n((()=>l.type),(e=>{L.type=e})),j((()=>{K({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then((({code:e,data:i})=>{if("10000"===e){const e={};i.forEach((i=>{e[i.dictCode]=i.dictItemList})),L.enumList=e}}))})),(e,i)=>{const a=H,o=J,t=q,r=O,l=C;return d(),s("div",Ye,[u(l,{show:p(L).isShow,"onUpdate:show":i[0]||(i[0]=e=>p(L).isShow=e),round:"",position:"bottom",closeable:"",style:{height:"80%"},onClose:P},{default:c((()=>[m("div",$e,[ze,p(D)?(d(),g(a,{key:0,content:p(D)},null,8,["content"])):T("",!0),m("div",Be,[p(L).holderFactor.length?(d(),g(o,{key:0,title:"投保人",class:"part-card"},{default:c((()=>{var e;return[u(Ve,{ref_key:"holderRef",ref:y,"insured-code":null===(e=p(L).riskBaseInfo)||void 0===e?void 0:e.insurerCode,"form-info":p(f).personVO,"factor-list":p(L).holderFactor,"age-range":p(L).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])]})),_:1})):T("",!0),p(L).insuredFactor.length?(d(),g(o,{key:1,title:"被保人",class:"part-card"},{default:c((()=>{var e;return[u(Ve,{ref_key:"insuredRef",ref:b,"insured-code":null===(e=p(L).riskBaseInfo)||void 0===e?void 0:e.insurerCode,"form-info":p(v).personVO,"factor-list":p(L).insuredFactor,"age-range":p(L).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])]})),_:1})):T("",!0),m("div",Ge,[u(o,{title:"投保方案",class:"part-card"},{default:c((()=>[p(L).riskData.length?(d(),s("div",Ke,[u(t,{ref_key:"riskFormRef",ref:h,"input-align":"right","error-message-align":"right"},{default:c((()=>[u(Se,{"risk-info":p(k)[0],enums:p(L).enumList,"origin-data":p(L).riskData,"pick-factor":x},null,8,["risk-info","enums","origin-data"])])),_:1},512)])):T("",!0)])),_:1})])]),m("div",He,[u(r,{block:"",type:"primary",onClick:w},{default:c((()=>[V("确定")])),_:1})])])])),_:1},8,["show"])])}}});e("P",a(Je,[["__scopeId","data-v-65cbf84c"]]))}}}))}();
