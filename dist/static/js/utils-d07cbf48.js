import"./vendor-87894311.js";import{l as w}from"./useStorage-7cf89dc9.js";import{R as x,g as R}from"./infoCollection-9b1626aa.js";import{R as T,i as k,b,a as D}from"./trial-2c2f0d38.js";import{a6 as h}from"./index-dd334c46.js";const z=e=>{const{tenantId:t,riskList:n,riskPremium:o,productId:s}=e;return n.map(r=>{var i,a;return{tenantId:t,amountUnit:1,annuityDrawFrequency:r.annuityDrawDate,annuityDrawType:r.annuityDrawType,paymentFrequency:r.paymentFrequency,paymentPeriod:r.chargePeriod.split("_")[1],paymentPeriodType:b[r.chargePeriod.split("_")[0]],insurancePeriodType:D[r.coveragePeriod==="to_life"?"to_life":r.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+r.coveragePeriod.split("_")[1])?0:r.coveragePeriod.split("_")[1],riskCode:r.riskCode,riskType:r.riskType,riskName:r.riskName,extInfo:{riskId:r.riskId,copy:r.copy},initialPremium:(i=o[r.riskCode])==null?void 0:i.premium,liabilityDetails:((a=r.liabilityVOList)==null?void 0:a.map(u=>({liabilityCode:u.liabilityCode,liabilityName:u.liabilityName,refundMethod:u.liabilityAttributeValue})))||[],productId:s,currentAmount:r.amount,initialAmount:r.amount}})},J=e=>h(e).map(t=>(t.riskDetailVOList.find(o=>o.riskType===T.MAIN_RISK),(o=>o.map(s=>{const{riskCategory:r,riskCode:d,riskType:i,id:a,riskInsureLimitVO:u,riskCalcMethodInfoVO:p}=s,{annuityDrawFrequencyList:c,annuityDrawValueList:l,insurancePeriodValueList:m,paymentFrequencyList:y,paymentPeriodValueList:I}=u,{minCopy:O,maxCopy:g,fixedAmount:f,singeAmount:P}=p;return{amount:f||P,annuityDrawDate:l==null?void 0:l[0],annuityDrawFrequency:c==null?void 0:c[0],chargePeriod:I==null?void 0:I[0],copy:O||g||0,coveragePeriod:m==null?void 0:m[0],liabilityVOList:s.riskLiabilityInfoVOList,paymentFrequency:y==null?void 0:y[0],riderRisk:!0,riderRiskVOList:[],riskCategory:r,riskCode:d,riskId:a,riskType:i}}))(t.riskDetailVOList||[]))).flat(),F=(e,t,n=[],o=R.YEAR,s=!1)=>{const r=e.filter(i=>{try{return i.extraInfo?JSON.parse(i.extraInfo).packageCode?!!n.includes(i.id):!0:!1}catch{return!1}});console.log("lastRiskList",r);const d=r.find(i=>i.riskType===T.MAIN_RISK);return r.map(i=>{const{riskInsureLimitVO:a,riskCategory:u,id:p,riskType:c,riskName:l,riskCode:m,extraInfo:y,riskLiabilityInfoVOList:I,riskCalcMethodInfoVO:O}=i,{insurancePeriodType:g,insurancePeriodValueList:f,paymentFrequencyList:P,paymentPeriodValueList:C,paymentPeriodType:q,annuityDrawFrequencyList:_,annuityDrawValueList:E,insurancePeriodRule:A,paymentPeriodRule:L}=a,{fixedAmount:V,minCopy:M}=O,N={amount:V,riskCode:m,riskId:p,riskName:l,paymentFrequency:(P==null?void 0:P[0])||R.YEAR,extraInfo:y,chargePeriod:C==null?void 0:C[0],annuityDrawDate:E==null?void 0:E[0],riskType:c,annuityDrawFrequency:_==null?void 0:_[0],copy:M,coveragePeriod:f==null?void 0:f[0],insuredCode:t==null?void 0:t.insurerCode,liabilityVOList:I,riskCategory:u};return c===T.MAIN_RISK?N:(A===k.ONE_YEAR&&(N.coveragePeriod="year_1"),L===k.ONE_YEAR&&(N.chargePeriod="year_1"),{...N,mainRiskId:d==null?void 0:d.id,mainRiskCode:d==null?void 0:d.riskCode})})},U=e=>!e||Number.isNaN(+e.split("_")[1])?0:e==null?void 0:e.split("_")[1],S=e=>{const{tenantId:t,riskList:n,riskPremium:o,productId:s}=e;return n.map(r=>{var i,a,u,p,c;return{tenantId:t,amountUnit:1,annuityDrawFrequency:r.annuityDrawDate,annuityDrawType:r.annuityDrawType,paymentFrequency:r.paymentFrequency,paymentPeriod:0,paymentPeriodType:(i=b)==null?void 0:i[r.chargePeriod],insurancePeriodType:D[r.coveragePeriod==="to_life"?"to_life":(u=(a=r.coveragePeriod)==null?void 0:a.split("_"))==null?void 0:u[0]],insurancePeriodValue:U(r.coveragePeriod),riskCode:r.riskCode,riskType:r.riskType,riskName:r.riskName,extInfo:{riskId:r.riskId,copy:r.copy},initialPremium:(p=o[r.riskCode])==null?void 0:p.premium,liabilityDetails:(c=r.liabilityVOList)==null?void 0:c.map(l=>({liabilityCode:l.liabilityCode,liabilityName:l.liabilityName,refundMethod:l.liabilityAttributeValue})),productId:s,currentAmount:r.amount,initialAmount:r.amount}})},W=e=>{var n,o,s,r;return console.log(e,"freeTransform"),{orderAmount:0,tenantId:e.tenantId,venderCode:e.insureDetail.productBasicInfoVO.insurerCode,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:"1",tenantOrderHolder:{tenantId:e.tenantId,certType:e.order.tenantOrderHolder.certEndType,...e.order.tenantOrderHolder},extInfo:{...e.extInfo,templateId:2,buttonCode:e.buttonCode,pageCode:e.pageCode,iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{...e.order.tenantOrderInsuredList[0],tenantId:e.tenantId,certType:e.order.tenantOrderInsuredList[0].certEndType,mobile:e.order.tenantOrderInsuredList[0].relationToHolder===x.SELF?e.order.tenantOrderHolder.mobile:"",tenantOrderProductList:[{tenantId:e.tenantId,productCode:(n=e.insureDetail)==null?void 0:n.productBasicInfoVO.productCode,productName:(o=e.insureDetail)==null?void 0:o.productBasicInfoVO.productName,premium:0,tenantOrderRiskList:S({tenantId:e.tenantId,riskList:F(e.insureDetail.productRiskVoList[0].riskDetailVOList,e.detail),riskPremium:{},productId:(s=e.detail)==null?void 0:s.id})}]}],operateOption:(r=e.order)==null?void 0:r.operateOption}},Q=(e,t)=>t.indexOf("$")!==-1?t.replace("$",`${e}`):`${e||""}${t}`,Y="PREVIEW_FILE_INFO",j=e=>{const{origin:t}=window.location;w.set(Y,JSON.stringify(e));const n=`${t}/template/filePreview`;console.log("url",n),window.open(n)};export{Y as P,Q as c,W as f,j as o,J as r,z as t};
