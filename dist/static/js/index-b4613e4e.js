import{g as b,a0 as z,C as m,r as $,k as n,m as p,y as t,I as y,s as w,z as r,n as P,F as A,M as G,h as f,j as I,E as N,J as M,B as x,a2 as O,a3 as j,T}from"./vendor-e9263418.js";import{u as q,a as k}from"./index-b8742a0a.js";import{_ as U}from"./plugin-vue_export-helper-46f75680.js";import{_ as W}from"./index-e4c11be9.js";import{q as Z}from"./businessOpportunity-65064208.js";import{_ as J}from"./index-654379f5.js";const R={class:"com-customer-item"},H={class:"avatar"},K=["src"],Q={class:"left-container"},X={class:"name"},Y={key:0,class:"tag"},tt={class:"tag1"},ut={class:"right"},et={class:"icon"},st=["src"],at=b({props:{name:{type:String,default:""},tag:{type:String,default:""},data:{type:Object,default:()=>{}},avatarUrl:{type:String,default:""}},emits:["on-call"],setup(a,{emit:l}){const d=a,{getIconUrl:D}=q(),v=z(),c=m(!1),h=()=>{v.push({path:"./customerDetail",query:{agentCustomerId:d.data.agentCustomerId,customerType:d.data.customerType,customerName:d.data.customerName},hash:"#1"})},C=[{name:"\u62E8\u6253\u7535\u8BDD",color:"$primary-color",type:"1"},{name:"\u53D1\u9001\u77ED\u4FE1",type:"2"}],F=B=>{c.value=!1,l("on-call",d.data,B.type)};return(B,_)=>{var s;const u=$("van-action-sheet");return n(),p(A,null,[t("div",R,[t("div",{class:"left",onClick:h},[t("div",H,[t("img",{src:a.avatarUrl},null,8,K)]),t("div",null,[t("div",Q,[t("div",X,y(a.name),1),((s=a.tag)==null?void 0:s.toString())!=="0"?(n(),p("div",Y,"\u5DF2\u8054\u7CFB")):w("",!0)]),t("div",tt,y(a.data.assignedDateStr),1)])]),t("div",ut,[t("div",et,[t("img",{src:r(D)("openCustomer.phone"),onClick:_[0]||(_[0]=e=>c.value=!0)},null,8,st)])])]),P(u,{show:c.value,"onUpdate:show":_[1]||(_[1]=e=>c.value=e),actions:C,"cancel-text":"\u53D6\u6D88","close-on-click-action":"",onSelect:F},null,8,["show"])],64)}}});var ot=U(at,[["__scopeId","data-v-5ad23a4f"]]),nt="/static/assets/empty.78b99b91.png";const S="/activity",lt=()=>k({url:`${S}/v1/assignedCustomer/checkPermission`,method:"GET"}),ct=(a={})=>k({url:`${S}/v1/assignedCustomer/queryClients`,method:"POST",data:a}),it=()=>k({url:`${S}/v1/assignedCustomer/applyForClients`,method:"GET"});const E=a=>(O("data-v-5b5d302a"),a=a(),j(),a),rt={class:"analysis"},dt=["src"],_t={class:"list"},mt={class:"count"},pt={class:"title"},vt={class:"title"},ht={class:"icon"},Ct=["src"],Ft={class:"text"},gt=x(" \u672C\u673A\u6784\u53EF\u5206\u914D"),yt={class:"key"},Dt=x("\u4EBA "),Bt=E(()=>t("div",{class:"rule-desc"}," \u5BA2\u6237\u5206\u914D\u89C4\u5219\uFF1A\u7B26\u5408\u76F8\u5173\u6761\u4EF6\u53EF\u7533\u8BF7\u5BA2\u6237\u8D44\u6E90\uFF0C\u6211\u4EEC\u4F1A\u6839\u636E\u60A8\u6240\u5728\u673A\u6784\u53CA\u5BA2\u6237\u8D44\u6E90\u60C5\u51B5\uFF0C\u968F\u673A\u5206\u914D\u4E00\u5B9A\u6570\u91CF\u7684\u5BA2\u6237\u4FE1\u606F\uFF0C\u8BF7\u53CA\u65F6\u8DDF\u8FDB\uFF0C\u5F00\u53D1\u4E2D\u8BF7\u79C9\u6301\u804C\u4E1A\u89C4\u8303\uFF0C\u5408\u7406\u4F7F\u7528\u3002\u5206\u914D\u540E\u5982\u957F\u671F\u672A\u5F00\u53D1\u6216\u8FDD\u53CD\u76F8\u5173\u89C4\u5B9A\uFF0C\u516C\u53F8\u6709\u6743\u6536\u56DE\u540D\u5355\u91CD\u65B0\u5206\u914D\u3002 ",-1)),ft=x("\u7533\u8BF7\u5BA2\u6237"),At=E(()=>t("div",{class:"divider"},null,-1)),Et={class:"title title-2"},$t={class:"icon"},xt=["src"],kt=E(()=>t("div",{class:"text"},"\u5206\u914D\u4E2D\u5BA2\u6237\u5217\u8868",-1)),St=E(()=>t("div",{class:"line"},null,-1)),It={class:"list"},Nt=b({setup(a){const{getIconUrl:l}=q(),d=m([{title:"\u5DF2\u5206\u914D\u5BA2\u6237",count:0},{title:"\u56DE\u6536\u5BA2\u6237",count:0},{title:"\u5206\u914D\u4E2D\u5BA2\u6237",count:0}]),D=m(0),v=m(!0),c=m(!1),h=m([]),C=()=>{lt().then(u=>{var s,e;if(((s=u.data)==null?void 0:s.status)===200){const{assignedClientNum:i=0,retrievedClientNum:o=0,assigningClientNum:g=0,permission:L=0,curBranchAssignableClientNum:V=0}=((e=u.data)==null?void 0:e.data)||{};v.value=L===0,D.value=V,d.value=[{title:"\u5DF2\u5206\u914D\u5BA2\u6237",count:i},{title:"\u56DE\u6536\u5BA2\u6237",count:o},{title:"\u5206\u914D\u4E2D\u5BA2\u6237",count:g}]}})},F=()=>{c.value=!0,ct({pageNum:"1",pageSize:"999"}).then(u=>{var s,e;if(((s=u.data)==null?void 0:s.status)===200){const{list:i=[]}=((e=u.data)==null?void 0:e.data)||{};h.value=i}}).finally(()=>{c.value=!1})},B=(u,s)=>{Z({agentCustomerId:u.agentCustomerId,customerType:u.customerType,businessType:"23",applyNo:u.applyNo,useType:s==="1"?"TEL":"SMS"}).then(e=>{s==="1"?window.location.href=`tel:${e.data.data}`:window.location.href=`sms:${e.data.data}`,C(),F()})},_=()=>{v.value||it().then(u=>{var s,e,i;((s=u.data)==null?void 0:s.status)===200?(T(`\u672C\u6B21\u5DF2\u6210\u529F\u7533\u8BF7${u.data.data}\u4F4D\u5BA2\u6237`),C(),F()):T((i=(e=u.data)==null?void 0:e.data)!=null?i:"\u672C\u6B21\u7533\u8BF7\u63D0\u4EA4\u5931\u8D25")})};return G(()=>{C(),F()}),(u,s)=>{const e=$("van-button"),i=$("ZaPageWrap");return n(),f(i,{"main-class":"page-open-customer"},{default:I(()=>[t("div",rt,[t("img",{src:r(l)("openCustomer.bg"),class:"bg"},null,8,dt),t("div",_t,[(n(!0),p(A,null,N(d.value,(o,g)=>(n(),p("div",{key:g,class:"analysis-item"},[t("div",mt,y(o.count),1),t("div",pt,y(o.title),1)]))),128))])]),t("div",vt,[t("div",ht,[t("img",{src:r(l)("openCustomer.title1")},null,8,Ct)]),t("div",Ft,[gt,t("span",yt,y(D.value),1),Dt])]),Bt,P(e,{class:M(["apply-btn",{disabled:v.value}]),onClick:_},{default:I(()=>[ft]),_:1},8,["class"]),At,t("div",Et,[t("div",$t,[t("img",{src:r(l)("openCustomer.title2")},null,8,xt)]),kt]),St,c.value?(n(),f(J,{key:0})):(n(),p(A,{key:1},[h.value.length===0?(n(),f(W,{key:0,"empty-img":r(nt),title:"\u76EE\u524D\u6CA1\u6709\u5BA2\u6237\uFF0C\u53BB\u7533\u8BF7\u5BA2\u6237\u5427~",class:"empty"},null,8,["empty-img"])):w("",!0),t("div",It,[(n(!0),p(A,null,N(h.value,(o,g)=>(n(),f(ot,{key:g,name:o.customerName,tag:o.call,"avatar-url":o.customerSex?o.customerSex==="F"?r(l)("customer.female"):r(l)("customer.male"):r(l)("customer.defaultGender"),data:o,onOnCall:B},null,8,["name","tag","avatar-url","data"]))),128))])],64))]),_:1})}}});var Lt=U(Nt,[["__scopeId","data-v-5b5d302a"]]);export{Lt as default};
