var me=Object.defineProperty,ve=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var re=(f,s,u)=>s in f?me(f,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):f[s]=u,w=(f,s)=>{for(var u in s||(s={}))Ie.call(s,u)&&re(f,u,s[u]);if(oe)for(var u of oe(s))Oe.call(s,u)&&re(f,u,s[u]);return f},Q=(f,s)=>ve(f,_e(s));import{g as ae,C as I,X as Y,r as p,h as m,j as A,k as d,y as i,n as l,m as q,E as se,I as C,F as ue,B as D,aj as Ee,Q as ye,a5 as Le,L as Be,x as Ae,o as Ce,z as c,s as M}from"./vendor-8e0cf49f.js";import{_ as ge,v as De,H as F,G as B,P as Te}from"./index-f0b1ab5b.js";import{c as Re,n as he,a as Fe}from"./index-d09edbe4.js";import{u as xe}from"./useDicData-280fd209.js";import{_ as X,R as Pe,B as Ne}from"./index-e29d631c.js";const be={class:"com-select-container"},He={class:"radio-item-wrapper"},ke={class:"name"},Ve={class:"hone"},Se={class:"address"},Ue={class:"footer-button"},je=D("\u53D6\u6D88"),$e=D("\u786E\u8BA4"),we=ae({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(f,{emit:s}){const u=f,y=I(u.modelValue),x=I(u.show),G=()=>{s("submit",y.value),x.value=!1},H=()=>{s("close")};return Y(()=>u.modelValue,O=>{console.log("newVal",O),y.value=O}),Y(()=>y.value,O=>{s("update:modelValue",O)}),(O,g)=>{const W=p("van-radio"),T=p("van-radio-group"),t=p("VanButton");return m(),A(De,{show:x.value,"onUpdate:show":g[1]||(g[1]=_=>x.value=_),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:H},{default:d(()=>[i("div",be,[l(T,{modelValue:y.value,"onUpdate:modelValue":g[0]||(g[0]=_=>y.value=_)},{default:d(()=>[(m(!0),q(ue,null,se(f.dataSource,(_,E)=>(m(),A(W,{key:E,name:E+1,class:"radio-item"},{default:d(()=>[i("div",He,[i("p",null,[i("span",ke,C(_.contactName),1),i("span",Ve,C(_.contactPhoneNo),1)]),i("p",Se,C(_.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),i("div",Ue,[l(t,{plain:"",type:"primary"},{default:d(()=>[je]),_:1}),l(t,{type:"primary",onClick:G},{default:d(()=>[$e]),_:1})])]),_:1},8,["show"])}}});var Me=ge(we,[["__scopeId","data-v-9c6de82e"]]);const qe={key:0,class:"beneficiary-part"},Ye={class:"part-title"},Ge={class:"title"},We=D("\u5220\u9664"),ze=D("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),Je=D("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Qe={class:"radio-item-wrapper"},Xe={class:"name"},Ke={class:"hone"},Ze={class:"address"},et={class:"footer-button"},tt={class:"trial-result"},nt=D("\u9996\u671F"),ot={class:"result-num"},rt={class:"operate-btn"},at=D("\u4E0B\u4E00\u6B65"),ft=ae({setup(f){const s=Ee(),u=ye(),{templateId:y=1,orderNo:x="2022072710380711215",tenantId:G="9991000007"}=u.query,[H,O]=Le(),g=u.path==="/infoPreview"?"infoPreview":"infoCollection",W=xe("NATIONAL_REGION_CODE"),T=I({}),t=I({extInfo:{pageCode:g},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),_=I(null),E=I([]),R=I([]),P=I([]),z=I([]),K=I([]),v=Be({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),N=Ae(()=>{var n,e;return v.currentAddress?v.addressList[v.currentAddress]:((e=(n=t.value.extInfo)==null?void 0:n.contactInfo)==null?void 0:e[0])||{}}),de=()=>{const n=w({},t.value);n.extInfo=Q(w({},n.extInfo),{contactInfo:[N.value]}),n.tenantOrderAttachmentList=[{category:F.OBVERSE_CERT,objectType:B.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:E.value[0],id:P.value[0]},{category:F.REVERSE_CERT,objectType:B.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:E.value[1],id:P.value[1]},{category:F.OBVERSE_CERT,objectType:B.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:R.value[0],id:z.value[1]},{category:F.REVERSE_CERT,objectType:B.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:R.value[1],id:z.value[1]}],_.value.validate().then(e=>{he(n).then(({code:a,data:o})=>{a==="10000"&&o.pageAction.pageAction==="jumpToPage"&&s.push({path:Te[o.pageAction.data.nextPageCode],query:u.query})})})},ie=n=>{console.log("value",n)},le=()=>{v.beneficiaryId+=1,t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:v.beneficiaryId,extInfo:{}})},ce=n=>{t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(e=>e.beneficiaryId!==n.beneficiaryId||n.id!==e.id)},fe=()=>{Fe({orderNo:x,tenantId:G}).then(({code:n,data:e})=>{if(n==="10000"){const a=e;a.extInfo=Q(w({},a.extInfo),{pageCode:g,templateId:y}),a.tenantOrderHolder=a.tenantOrderHolder||{},a.tenantOrderHolder.extInfo=a.tenantOrderHolder.extInfo||{},a.tenantOrderInsuredList[0].extInfo=a.tenantOrderInsuredList[0].extInfo||{},a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{const L=o;return L.extInfo={},L}),a.tenantOrderAttachmentList.forEach(o=>{o.category===F.OBVERSE_CERT?o.objectType===B.HOLDER?(E.value[0]=o.uri,P.value[0]=o.id):o.objectType===B.INSURED&&(R.value[0]=o.uri,z.value[0]=o.id):o.category===F.REVERSE_CERT&&(o.objectType===B.HOLDER?(E.value[1]=o.uri,P.value[1]=o.id):o.objectType===B.INSURED&&(R.value[1]=o.uri,P.value[1]=o.id))}),Object.assign(t.value,a)}}).finally(()=>{v.isLoading=!1})};return Ce(()=>{fe(),Re({pageCode:"infoCollection",templateId:y}).then(({code:n,data:e})=>{if(n==="10000"){const a={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(o=>{(a[o.moduleType]=a[o.moduleType]||[]).push(o)}),T.value=a}})}),Y(()=>t.value,n=>{var e,a,o,L,k,V,b,S,U,j;if(n){const J=[{contactAddress:(a=(e=n.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:a.familyAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(L=(o=n.tenantOrderHolder)==null?void 0:o.extInfo)==null?void 0:L.workAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(V=(k=n.tenantOrderInsuredList[0])==null?void 0:k.extInfo)==null?void 0:V.familyAddress,contactName:(b=n.tenantOrderInsuredList[0])==null?void 0:b.name,contactPhoneNo:(S=n.tenantOrderInsuredList[0])==null?void 0:S.mobile},{contactAddress:(j=(U=n.tenantOrderInsuredList[0])==null?void 0:U.extInfo)==null?void 0:j.workAddress,contactName:n.tenantOrderInsuredList[0].name,contactPhoneNo:n.tenantOrderInsuredList[0].mobile}];v.addressList=J.filter(h=>h.contactAddress&&h.contactName&&h.contactPhoneNo)}},{deep:!0,immediate:!0}),Y(()=>t.value.tenantOrderInsuredList[0].relationToHolder,n=>{+n==1&&Object.assign(t.value.tenantOrderInsuredList[0],t.value.tenantOrderHolder,{id:t.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(n,e)=>{const a=p("ProCard"),o=p("ProRadioButton"),L=p("ProField"),k=p("ProCascader"),V=p("ProSvg"),b=p("VanButton"),S=p("ProCheckButton"),U=p("van-cell"),j=p("ProForm"),J=p("ProPageWrap");return m(),A(J,{class:"page-info-wrapper"},{default:d(()=>{var h,Z,ee,$,te;return[c(v).isLoading?M("",!0):(m(),A(j,{key:0,ref_key:"formRef",ref:_},{default:d(()=>[l(a,{title:"\u6295\u4FDD\u4EBA"},{default:d(()=>[l(X,{images:E.value,"onUpdate:images":e[0]||(e[0]=r=>E.value=r),"form-info":t.value.tenantOrderHolder,"factor-list":T.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),l(a,{title:"\u88AB\u4FDD\u4EBA"},{default:d(()=>[l(L,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.tenantOrderInsuredList[0].relationToHolder=r),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:d(()=>[l(o,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.tenantOrderInsuredList[0].relationToHolder=r),options:c(Pe)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+t.value.tenantOrderInsuredList[0].relationToHolder!=1?(m(),A(X,{key:0,images:R.value,"onUpdate:images":e[3]||(e[3]=r=>R.value=r),"form-info":t.value.tenantOrderInsuredList[0],"factor-list":T.value.INSURER||[]},null,8,["images","form-info","factor-list"])):M("",!0),l(k,{modelValue:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:modelValue":e[4]||(e[4]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=r),field1:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":e[5]||(e[5]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=r),field2:t.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":e[6]||(e[6]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureCityCode=r),field3:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":e[7]||(e[7]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=r),label:"\u6295\u4FDD\u5730\u533A",name:"insureProvinceCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:"","data-source":c(W),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])]),_:1}),l(a,{title:"\u53D7\u76CA\u4EBA"},{default:d(()=>[l(L,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[9]||(e[9]=r=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=r),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:d(()=>[l(o,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[8]||(e[8]=r=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=r),options:c(Ne)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),t.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(m(),q("div",qe,[(m(!0),q(ue,null,se(t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(r,pe)=>(m(),q("div",{key:r.beneficiaryId||r.id,class:"beneficiary-item"},[i("div",Ye,[i("span",Ge,C(`\u53D7\u76CA\u4EBA${pe+1}`),1),l(V,{name:"delete",onClick:ne=>ce(r)},{default:d(()=>[We]),_:2},1032,["onClick"])]),l(X,{images:K.value,"onUpdate:images":e[10]||(e[10]=ne=>K.value=ne),"form-info":r,"factor-list":T.value.BENEFICIARY||[]},null,8,["images","form-info","factor-list"])]))),128)),l(b,{onClick:le},{default:d(()=>[ze]),_:1})])):M("",!0)]),_:1}),l(a,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:d(()=>[Object.keys(c(N)).length?(m(),A(U,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:e[12]||(e[12]=r=>c(O)(!0))},{title:d(()=>[i("div",Qe,[i("p",null,[i("span",Xe,C(c(N).contactName),1),i("span",Ke,C(c(N).contactPhoneNo),1)]),i("p",Ze,C(c(N).contactAddress),1)])]),_:1})):(m(),A(S,{key:0,activated:"",onClick:e[11]||(e[11]=r=>c(O)(!0))},{default:d(()=>[Je]),_:1}))]),_:1})]),_:1},512)),i("div",et,[i("span",tt,[nt,i("span",ot,"\uFFE5"+C((te=($=(ee=(Z=(h=t.value.tenantOrderInsuredList)==null?void 0:h[0])==null?void 0:Z.tenantOrderProductList)==null?void 0:ee[0].premium)==null?void 0:$.toLocaleString)==null?void 0:te.call($)),1)]),i("div",rt,[l(b,{block:"",type:"primary",onClick:de},{default:d(()=>[at]),_:1})])]),c(H)?(m(),A(Me,{key:1,modelValue:c(v).currentAddress,"onUpdate:modelValue":e[13]||(e[13]=r=>c(v).currentAddress=r),show:c(H),"data-source":c(v).addressList,onSubmit:ie,onClose:e[14]||(e[14]=r=>c(O)(!1))},null,8,["modelValue","show","data-source"])):M("",!0)]}),_:1})}}});export{ft as default};
