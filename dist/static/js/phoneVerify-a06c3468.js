import{_ as a,d as e,k as s,i as r,O as t,m as o,o as l,n,w as d,a as i,e as u,u as c,V as p,p as v,bK as I,q as m,b,a8 as f,bI as C,T as N,bL as _,az as h,aR as T,ap as j,aq as y}from"./index-dc5ec44c.js";import{s as O,c as S}from"./phoneVerify-5b4fc776.js";import{c as E}from"./format-b5e9d8b9.js";import{u as g}from"./useOrder-055f3aa3.js";import"./merge-e7788e50.js";import"./keysIn-131bbce9.js";import"./isObjectLike-a9798079.js";const k={class:"page-phone-verify"},q=(a=>(j("data-v-69a530b5"),a=a(),y(),a))((()=>i("div",{class:"title"},"通过投保人手机号验证后，可进行投保信息填写",-1))),P={class:"phone"},A={class:"input-wrapper"};var D=a(e({__name:"phoneVerify",setup(a){const e=g(),j=s(""),y=s(""),D=s(0);let R;const U=r(),{agentCode:V,tenantId:w,templateId:F,productCode:L,insurerCode:W,orderNo:x,orderCode:G}=U.query,z=()=>{O(j.value).then((({code:a})=>{"10000"===a&&(D.value=60,R=setInterval((()=>{D.value-=1,D.value<=0&&clearInterval(R)}),1e3))}))},K=()=>{S(j.value,y.value).then((({code:a,data:s})=>{"10000"===a&&s?(N.success("验证成功"),e.value.orderStatus===_.PROCESSING?h("infoCollection",{...U.query,isShare:1}):[_.WAIT_IDENTIFICATION,_.IDENTIFICATION_COMPLETE,_.IN_IDENTIFICATION,_.UNDER_WRITING_SUCCESS].includes(e.value.orderStatus)&&h("infoPreview",{...U.query,isShare:1})):N.fail("验证失败")}))};return t((()=>{C({orderNo:G||x,saleUserId:V,tenantId:w}).then((({code:a,data:s})=>{var r;"10000"===a&&(Object.assign(e.value,s),j.value=null==(r=null==s?void 0:s.holder)?void 0:r.mobile)}))})),(a,e)=>{const s=T,r=o("ProPageWrap");return l(),n(r,null,{default:d((()=>[i("div",k,[q,i("div",P,u(c(E)(c(j)||"")),1),i("div",A,[p(i("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>v(y)?y.value=a:null),placeholder:"请输入验证码",class:"input"},null,512),[[I,c(y)]]),i("div",{class:m(["btn",{second:c(D)}]),onClick:z},u(c(D)?`${c(D)}s`:"发送验证码"),3)]),b(s,{type:"primary",class:"submit-btn",onClick:K},{default:d((()=>[f("下一步")])),_:1})])])),_:1})}}}),[["__scopeId","data-v-69a530b5"]]);export{D as default};
