var De=Object.defineProperty,ge=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable;var de=(m,d,l)=>d in m?De(m,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[d]=l,E=(m,d)=>{for(var l in d||(d={}))Pe.call(d,l)&&de(m,l,d[l]);if(ie)for(var l of ie(d))Re.call(d,l)&&de(m,l,d[l]);return m},A=(m,d)=>ge(m,he(d));import{g as me,E as B,_ as ae,r as O,j as L,k as V,m as c,z as i,p as f,n as Z,G as Ie,J as k,F as ve,C as $,a9 as Te,O as be,Q as xe,M as Fe,y as le,o as Ne,A as p,t as X,d as ce,T as Ve}from"./vendor-9d7eb2ed.js";import{_ as ke,l as He,f as Se,g as Ue,A as Y,q as N,n as we,b as $e}from"./index-3f0a1a62.js";import{p as je}from"./trial-00701885.js";import{P as fe,I as pe,R as Me}from"./trial-01b5d5de.js";import{u as Ye}from"./useDicData-8f1bc6bd.js";import{R as qe,a as Ge,B as Je,b as Ke}from"./infoCollection-b0426750.js";import{_ as oe}from"./index-073868a4.js";const We={class:"com-select-container"},ze={class:"radio-item-wrapper"},Qe={class:"name"},Xe={class:"hone"},Ze={class:"address"},et={class:"footer-button"},tt=$("\u53D6\u6D88"),nt=$("\u786E\u8BA4"),rt=me({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(m,{emit:d}){const l=m,T=B(l.modelValue),q=B(l.show),ee=()=>{d("submit",T.value),q.value=!1},te=()=>{d("close")};return ae(()=>l.modelValue,G=>{T.value=G}),ae(()=>T.value,G=>{d("update:modelValue",G)}),(G,H)=>{const Q=O("van-radio"),J=O("van-radio-group"),K=O("VanButton");return L(),V(He,{show:q.value,"onUpdate:show":H[1]||(H[1]=D=>q.value=D),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:te},{default:c(()=>[i("div",We,[f(J,{modelValue:T.value,"onUpdate:modelValue":H[0]||(H[0]=D=>T.value=D)},{default:c(()=>[(L(!0),Z(ve,null,Ie(m.dataSource,(D,S)=>(L(),V(Q,{key:S,name:S+1,class:"radio-item"},{default:c(()=>[i("div",ze,[i("p",null,[i("span",Qe,k(D.contactName),1),i("span",Xe,k(D.contactPhoneNo),1)]),i("p",Ze,k(D.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),i("div",et,[f(K,{plain:"",type:"primary"},{default:c(()=>[tt]),_:1}),f(K,{type:"primary",onClick:ee},{default:c(()=>[nt]),_:1})])]),_:1},8,["show"])}}});var ot=ke(rt,[["__scopeId","data-v-a821acd4"]]);const at={key:0,class:"beneficiary-part"},st={class:"part-title"},ut={class:"title"},it=$("\u5220\u9664"),dt=$("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),lt=$("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),ct={class:"radio-item-wrapper"},ft={class:"name"},pt={class:"hone"},mt={class:"address"},It={class:"footer-button","safe-area-inset-bottom":""},vt={class:"left"},Ot={class:"trial-result"},_t=$(" \u9996\u671F"),Et={class:"result-num"},Lt=i("div",{class:"result-desc"},"\u5B9E\u9645\u4FDD\u8D39\u4EE5\u540E\u7EED\u4E3A\u51C6",-1),yt={class:"operate-btn"},Ct=$("\u4E0B\u4E00\u6B65"),bt=me({setup(m){const d=Te(),l=be(),{templateId:T=1,orderNo:q="2022072710380711215",productCode:ee,tenantId:te="9991000007",proposalId:G,insurerCode:H="kunlunhealth"}=l.query,[Q,J]=xe(),K=l.path==="/infoPreview"?"infoPreview":"infoCollection",D=Ye("NATIONAL_REGION_CODE"),S=B({}),e=B({extInfo:{pageCode:K},tenantOrderHolder:{extInfo:{occupationCodeList:[]},holderType:1},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),ne=B(null),b=B([]),j=B([]),W=B([]),re=B([]),se=B([]),x=Fe({beneficiaryId:0,nextPage:"",currentAddress:null,isLoading:!0}),ue=le(()=>{var t,u,s,r,a,I,v,g,h,P;return[{contactAddress:(u=(t=e.value.tenantOrderHolder)==null?void 0:t.extInfo)==null?void 0:u.familyAddress,contactName:e.value.tenantOrderHolder.name,contactPhoneNo:e.value.tenantOrderHolder.mobile},{contactAddress:(r=(s=e.value.tenantOrderHolder)==null?void 0:s.extInfo)==null?void 0:r.workAddress,contactName:e.value.tenantOrderHolder.name,contactPhoneNo:e.value.tenantOrderHolder.mobile},{contactAddress:(I=(a=e.value.tenantOrderInsuredList[0])==null?void 0:a.extInfo)==null?void 0:I.familyAddress,contactName:(v=e.value.tenantOrderInsuredList[0])==null?void 0:v.name,contactPhoneNo:(g=e.value.tenantOrderInsuredList[0])==null?void 0:g.mobile},{contactAddress:(P=(h=e.value.tenantOrderInsuredList[0])==null?void 0:h.extInfo)==null?void 0:P.workAddress,contactName:e.value.tenantOrderInsuredList[0].name,contactPhoneNo:e.value.tenantOrderInsuredList[0].mobile}].filter(y=>y.contactAddress&&y.contactName&&y.contactPhoneNo)||[]}),z=le(()=>{var o,t;return x.currentAddress?ue.value[x.currentAddress-1]||{}:((t=(o=e.value.extInfo)==null?void 0:o.contactInfo)==null?void 0:t[0])||{}}),Oe=o=>{const t={};return o.map(u=>{const{initialAmount:s,annuityDrawFrequency:r,annuityDrawType:a,paymentFrequency:I,paymentPeriod:v,paymentPeriodType:g,insurancePeriodType:h,insurancePeriodValue:P,riskCode:y,riskType:U,initialPremium:M,liabilityDetails:w,extInfo:C}=u,{riskId:F,copy:n}=C,_={amount:s,annuityDrawDate:r,annuityDrawType:a,paymentFrequency:I,riskId:F,copy:n,chargePeriod:v?`${fe[g]}_${v}`:fe[g],coveragePeriod:P?`${pe[h]}_${P}`:pe[h],riskCode:y,riskType:U,premium:M,liabilityVOList:w.map(R=>A(E({},R),{liabilityAttributeValue:R.refundMethod,liabilityAttributeCode:R.refundMethod&&1}))};return U===Me.MAIN_RISK?(t.mainRiskCode=y,t.mainRiskId=F):Object.assign(_,t),_})},_e=()=>{var t;const o=E({},e.value);o.extInfo=A(E({},o.extInfo),{contactInfo:[z.value]}),o.tenantOrderAttachmentList=[{category:Y.OBVERSE_CERT,objectType:N.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:b.value[0],id:W.value[0]},{category:Y.REVERSE_CERT,objectType:N.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:b.value[1],id:W.value[1]},{category:Y.OBVERSE_CERT,objectType:N.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:j.value[0]||b.value[0],id:re.value[1]},{category:Y.REVERSE_CERT,objectType:N.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:j.value[1]||b.value[1],id:re.value[1]}].filter(u=>u.uri),(t=ne.value)==null||t.validate().then(u=>{if(o.tenantOrderInsuredList[0].insuredBeneficiaryType===Ke.SPECIFY){const s={};if(o.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.forEach(r=>{s[r.benefitOrder]?s[r.benefitOrder].sum+=Number(r.benefitRate):s[r.benefitOrder]={sum:Number(r.benefitRate)}}),Object.values(s).some(r=>r.sum!==100)){Ve.fail("\u540C\u4E00\u987A\u4F4D\u7684\u53D7\u76CA\u4EBA\u6BD4\u4F8B\u4E4B\u548C\u5FC5\u987B\u4E3A100");return}}we(o).then(({code:s,data:r})=>{s==="10000"&&r.pageAction.pageAction==="jumpToPage"&&d.push({path:$e[r.pageAction.data.nextPageCode],query:l.query})})})},Ee=()=>{var o;(o=ne.value)==null||o.validate().then(()=>{const{birthday:t,gender:u,extInfo:s}=e.value.tenantOrderHolder,{hasSocialInsurance:r,occupationCodeList:a}=s,{birthday:I,gender:v,extInfo:g,tenantOrderProductList:h}=e.value.tenantOrderInsuredList[0],{hasSocialInsurance:P,occupationCodeList:y}=g,U={holder:{personVO:{birthday:ce(t).format("YYYY-MM-DD"),gender:u,socialFlag:r,occupationCodeList:a}},productCode:ee,insuredVOList:[{insurerCode:H,personVO:{birthday:ce(I).format("YYYY-MM-DD"),gender:v,socialFlag:P,occupationCodeList:y},productPlanVOList:[{insurerCode:H,planCode:"",riskVOList:Oe(h[0].tenantOrderRiskList)}]}]};je(E({},U)).then(({code:M,data:w})=>{if(M==="10000"){const C={},F=(n=[])=>{(n||[]).forEach(_=>{var R;C[_.riskCode]=_,((R=_.riskPremiumDetailVOList)==null?void 0:R.length)&&F(_.riskPremiumDetailVOList)})};F(w.riskPremiumDetailVOList),e.value.tenantOrderInsuredList[0].tenantOrderProductList[0]=A(E({},e.value.tenantOrderInsuredList[0].tenantOrderProductList[0]),{premium:w.premium,tenantOrderRiskList:e.value.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantOrderRiskList.map(n=>A(E({},n),{initialAmount:C[n.riskCode].amount,initialPremium:C[n.riskCode].premium}))}),_e()}})})},Le=o=>{console.log("value",o)},ye=()=>{x.beneficiaryId+=1,e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:x.beneficiaryId,extInfo:{}})},Ce=o=>{e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(t=>t.beneficiaryId!==o.beneficiaryId||o.id!==t.id)},Ae=()=>{Ue({orderNo:q,tenantId:te}).then(({code:o,data:t})=>{var u,s;if(o==="10000"){const r=t;r.extInfo=A(E({},r.extInfo),{pageCode:K,templateId:T}),r.tenantOrderHolder=r.tenantOrderHolder||{holderType:1},r.tenantOrderHolder.extInfo=A(E({},r.tenantOrderHolder.extInfo),{occupationCodeList:((u=r.tenantOrderHolder.extInfo)==null?void 0:u.occupationCodeList)||[]}),r.tenantOrderInsuredList[0].extInfo=A(E({},r.tenantOrderInsuredList[0].extInfo),{occupationCodeList:((s=r.tenantOrderInsuredList[0].extInfo)==null?void 0:s.occupationCodeList)||[]}),r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(a=>{var v;const I=a;return I.extInfo=A(E({},I.extInfo),{occupationCodeList:((v=I.extInfo)==null?void 0:v.occupationCodeList)||[]}),I}),r.tenantOrderAttachmentList.forEach(a=>{a.category===Y.OBVERSE_CERT?a.objectType===N.HOLDER?(b.value[0]=a.uri,W.value[0]=a.id):a.objectType===N.INSURED&&(j.value[0]=a.uri,re.value[0]=a.id):a.category===Y.REVERSE_CERT&&(a.objectType===N.HOLDER?(b.value[1]=a.uri,W.value[1]=a.id):a.objectType===N.INSURED&&(j.value[1]=a.uri,W.value[1]=a.id))}),Object.assign(e.value,r)}}).finally(()=>{x.isLoading=!1})},Be=()=>{Object.assign(e.value.tenantOrderInsuredList[0],e.value.tenantOrderHolder,{id:e.value.tenantOrderInsuredList[0].id,extInfo:A(E({},e.value.tenantOrderHolder.extInfo),{insureProvinceCode:e.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,insureCityCode:e.value.tenantOrderInsuredList[0].extInfo.insureCityCode,insureAreaCode:e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode})})};return Ne(()=>{Ae(),Se({pageCode:"infoCollection",templateId:T}).then(({code:o,data:t})=>{if(console.log("code",o),o==="10000"){const u={BENEFICIARY:[],INSURER:[],HOLDER:[]};t.productInsureFactorList.forEach(s=>{(u[s.moduleType]=u[s.moduleType]||[]).push(s)}),S.value=u}})}),ae([()=>e.value.tenantOrderInsuredList[0].relationToHolder,()=>e.value.tenantOrderHolder],()=>{`${e.value.tenantOrderInsuredList[0].relationToHolder}`===qe.SELF&&Be()},{deep:!0,immediate:!0}),(o,t)=>{const u=O("ProCard"),s=O("ProRadioButton"),r=O("ProField"),a=O("ProCascader"),I=O("ProSvg"),v=O("VanButton"),g=O("ProCheckButton"),h=O("van-cell"),P=O("ProForm"),y=O("ProPageWrap");return L(),V(y,{class:"page-info-wrapper"},{default:c(()=>{var U,M,w,C,F;return[p(x).isLoading?X("",!0):(L(),V(P,{key:0,ref_key:"formRef",ref:ne},{default:c(()=>[f(u,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[f(oe,{images:b.value,"onUpdate:images":t[0]||(t[0]=n=>b.value=n),"form-info":e.value.tenantOrderHolder,"factor-list":S.value.HOLDER,prefix:"holder"},null,8,["images","form-info","factor-list"])]),_:1}),f(u,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[f(r,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":t[2]||(t[2]=n=>e.value.tenantOrderInsuredList[0].relationToHolder=n),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[f(s,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":t[1]||(t[1]=n=>e.value.tenantOrderInsuredList[0].relationToHolder=n),options:p(Ge)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+e.value.tenantOrderInsuredList[0].relationToHolder!=1?(L(),V(oe,{key:0,images:j.value,"onUpdate:images":t[3]||(t[3]=n=>j.value=n),"form-info":e.value.tenantOrderInsuredList[0],"factor-list":S.value.INSURER||[],prefix:"insure"},null,8,["images","form-info","factor-list"])):X("",!0),f(a,{modelValue:e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:modelValue":t[4]||(t[4]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=n),field1:e.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":t[5]||(t[5]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=n),field2:e.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":t[6]||(t[6]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureCityCode=n),field3:e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":t[7]||(t[7]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=n),label:"\u6295\u4FDD\u5730\u533A",name:"insureAreaCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:"","data-source":p(D),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])]),_:1}),f(u,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[f(r,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":t[9]||(t[9]=n=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=n),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[f(s,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":t[8]||(t[8]=n=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=n),options:p(Je)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),e.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(L(),Z("div",at,[(L(!0),Z(ve,null,Ie(e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(n,_)=>(L(),Z("div",{key:n.beneficiaryId||n.id,class:"beneficiary-item"},[i("div",st,[i("span",ut,k(`\u53D7\u76CA\u4EBA${_+1}`),1),f(I,{name:"delete",onClick:R=>Ce(n)},{default:c(()=>[it]),_:2},1032,["onClick"])]),f(oe,{images:se.value,"onUpdate:images":t[10]||(t[10]=R=>se.value=R),"form-info":n,"factor-list":S.value.BENEFICIARY||[],prefix:`beneficiary-${_}`,"beneficiary-list":e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","beneficiary-list"])]))),128)),f(v,{onClick:ye},{default:c(()=>[dt]),_:1})])):X("",!0)]),_:1}),f(u,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>{var n;return[((n=Object.keys(p(z)))==null?void 0:n.length)?(L(),V(h,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:t[12]||(t[12]=_=>p(J)(!0))},{title:c(()=>[i("div",ct,[i("p",null,[i("span",ft,k(p(z).contactName),1),i("span",pt,k(p(z).contactPhoneNo),1)]),i("p",mt,k(p(z).contactAddress),1)])]),_:1})):(L(),V(g,{key:0,activated:"",onClick:t[11]||(t[11]=_=>p(J)(!0))},{default:c(()=>[lt]),_:1}))]}),_:1})]),_:1},512)),i("div",It,[i("div",vt,[i("div",Ot,[_t,i("span",Et,"\uFFE5"+k((F=(C=(w=(M=(U=e.value.tenantOrderInsuredList)==null?void 0:U[0])==null?void 0:M.tenantOrderProductList)==null?void 0:w[0].premium)==null?void 0:C.toLocaleString)==null?void 0:F.call(C)),1)]),Lt]),i("div",yt,[f(v,{block:"",type:"primary",onClick:Ee},{default:c(()=>[Ct]),_:1})])]),p(Q)?(L(),V(ot,{key:1,modelValue:p(x).currentAddress,"onUpdate:modelValue":t[13]||(t[13]=n=>p(x).currentAddress=n),show:p(Q),"data-source":p(ue),onSubmit:Le,onClose:t[14]||(t[14]=n=>p(J)(!1))},null,8,["modelValue","show","data-source"])):X("",!0)]}),_:1})}}});export{bt as default};
