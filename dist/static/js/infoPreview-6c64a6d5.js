import{d as e,af as a,ag as t,i as o,h as s,c9 as n,r as i,j as l,aG as r,l as d,o as c,c as u,b as f,u as m,p,q as y,f as I,w as h,F as v,s as b,a as w,g as j,v as g,e as k,dG as C,T as V,ah as x,bH as q,ak as L,bK as P,aS as T,dM as _,aQ as O,c6 as N}from"./index-5e7cc819.js";import{P as R,a as E}from"./PolicyInfo-eb4cccf5.js";import{g as S,m as U}from"./trial-16e00b4f.js";import{n as D}from"./nextStep-c243373b.js";import{b as Q,l as F}from"./product-bc823a76.js";import{u as M}from"./useOrder-59973bd6.js";import{P as $}from"./index-70d97811.js";import{P as A}from"./index-1b0cdd9a.js";import{_ as B}from"./InsureInfo-c671c7dc.js";import{p as G,d as z}from"./utils-0f8fa8a7.js";import{Q as J}from"./notice-33e6eedd.js";import{g as W}from"./utils-abb1e928.js";import{Q as H}from"./questionnaire-42dcb602.js";import{P as K}from"./constants-b39aa53b.js";import{T as X}from"./infoCollection-5d0c9dcd.js";import"./core-6372d3f7.js";import"./cloneDeep-f0cd0da5.js";import"./util-f4ae2add.js";import"./trial-78365229.js";const Y={class:"long-info-preview"},Z={class:"footer-button"},ee=e({__name:"infoPreview",setup(e){const ee=a((()=>t((()=>import("./index-db1546be.js")),["static/js/index-db1546be.js","static/css/index-fa4edf2a.css","static/js/index-5e7cc819.js","static/css/index-3dd092cb.css","static/js/theme-94cf7d00.js","static/js/index-1b0cdd9a.js","static/css/index-bbfdd7ec.css","static/js/utils-abb1e928.js","static/js/infoCollection-5d0c9dcd.js","static/js/trial-78365229.js"]))),ae=o(),te=s(),oe=M(),{productCode:se="",tenantId:ne,agentCode:ie="",agencyCode:le,saleChannelId:re,isShare:de,orderNo:ce,extraInfo:ue,insurerCode:fe,objectType:me="1",templateId:pe,preview:ye,origin:Ie}=ae.query;let he={};try{he=JSON.parse(decodeURIComponent(ue))}catch(Se){}const[ve,be]=n(!1),we=i({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),je=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`;l({imgUrl:"",desc:"",title:"",link:je});const ge=l(),ke=l(),Ce=l(!1),Ve=l(0),xe=l(!1),qe=()=>{Ce.value=!1},Le=()=>{oe.value.extInfo.buttonCode=C.short.underWrite,oe.value.extInfo.pageCode="infoPreview",D(oe.value,((e,a)=>{}))},Pe=()=>{pe===X.FREE?(oe.value.extInfo.buttonCode=C.free.underWriteAndIssue,oe.value.extInfo.pageCode="productInfo",D(oe.value,((e,a)=>{a===O.JUMP_PAGE&&te.push({path:K[e.nextPageCode],query:ae.query})}))):be(!0)},Te=async()=>{pe===X.FREE?V("被保人已完成认证"):be(!0)},_e=l(),Oe=l(),Ne=l([]),Re=async()=>{let e={};const{code:a,data:t}=await S({orderNo:ce,tenantId:ne});"10000"===a&&(Object.assign(oe.value,t),e=G(t.insuredList[0].productList),_e.value=t,xe.value=!0),(async e=>{let a=[];const{code:t,data:o}=await N({orderNo:ce,tenantId:ne});"10000"===t&&(a=o.productQuestionnaireVOList);const{code:s,data:n}=await F(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},t=e.filter((e=>e.businessType!==J.VISIT));we.customerQuestions=t.map((e=>{const{questionnaireDetailResponseVO:t,questionnaireId:o,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=t||{},{objectType:l,questionnaireType:r}=i||{};if(r===H.TEXT){const{content:e,textType:a}=(null==n?void 0:n[0])||{};return{content:e,contentType:W(`${a}`,e),questionnaireId:o,questionnaireName:s}}const d=(a||[]).find((e=>e.questionnaireId===o));return{...t,contentType:"question",...null==d?void 0:d.questionnaireDetailResponseVO,questionnaireId:o,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),Q(e).then((({code:e,data:a})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:t}=z(a);we.fileList=e.map((e=>({tabName:e.attachmentName,isExpand:!0,files:e.attachmentList.map((e=>({name:e.materialName,file:e.materialContent,type:e.materialSource,mustRead:e.mustReadFlag===x.YES})))}))),Ne.value=e.concat(t)}})),U(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:t}=e;Oe.value=t;const{payInfo:o,other:s}=q(t);we.payInfo={...we.payInfo,...o},we.policyInfo={...we.policyInfo,...s}}}))};r((()=>{Re()}));const Ee=l();return d((()=>{setTimeout((async()=>{Ee.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{var t,o,s;const n=L,i=P,l=T,r=_;return c(),u("div",Y,[f(n),f(B,{"product-data":null==(o=null==(t=m(oe).insuredList)?void 0:t[0])?void 0:o.productList},null,8,["product-data"]),(null==(s=Object.keys(m(Oe)||{}))?void 0:s.length)?(c(),p($,{key:0,ref_key:"personalInfoRef",ref:ke,modelValue:m(_e),"onUpdate:modelValue":a[0]||(a[0]=e=>y(_e)?_e.value=e:null),"product-factor":m(Oe),"is-view":"","input-align":"left"},null,8,["modelValue","product-factor"])):I("",!0),m(we).payInfo.schema.length?(c(),p(m(R),{key:1,ref_key:"payInfoRef",ref:ge,modelValue:m(oe).tenantOrderPayInfoList,"onUpdate:modelValue":a[1]||(a[1]=e=>m(oe).tenantOrderPayInfoList=e),schema:m(we).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):I("",!0),m(we).policyInfo.schema.length?(c(),p(m(E),{key:2,modelValue:m(oe).extInfo,"onUpdate:modelValue":a[2]||(a[2]=e=>m(oe).extInfo=e),schema:m(we).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):I("",!0),f(l,{title:"产品资料","show-line":!1,"show-icon":!1},{default:h((()=>[(c(!0),u(v,null,b(m(Ne),((e,a)=>(c(),p(i,{key:a,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{Ve.value=e,Ce.value=!0})(a)},null,8,["title","onClick"])))),128))])),_:1}),w("div",Z,["share"===m(Ie)?(c(),p(A,{key:0,shadow:!1,onClick:Te},{default:h((()=>[j(e.$slots,"default",{},(()=>[g("确认")]))])),_:3})):(c(),p(A,{key:1,shadow:!1,onClick:Pe},{default:h((()=>[j(e.$slots,"default",{},(()=>[g(k(m(pe)===m(X).free?"领取保障并激活":"确认支付"),1)]))])),_:3}))]),m(Ce)?(c(),p(m(ee),{key:3,show:m(Ce),"onUpdate:show":a[3]||(a[3]=e=>y(Ce)?Ce.value=e:null),"content-list":[m(Ne)[m(Ve)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:qe},null,8,["show","content-list"])):I("",!0),m(ve)?(c(),p(r,{key:4,modelValue:m(ve),"onUpdate:modelValue":a[4]||(a[4]=e=>y(ve)?ve.value=e:null),closeable:!1,"data-source":m(we).fileList,onSubmit:Le},null,8,["modelValue","data-source"])):I("",!0)])}}});export{ee as default};
