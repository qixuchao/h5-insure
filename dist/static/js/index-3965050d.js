import{d as e,u as n,r as t,A as a,a6 as i,L as o,Z as s,cg as r,b as l,c as d,e as u,w as c,f as p,i as f,h as g,b2 as v,j as m,E as h,a0 as C,$ as k,G as w,W as y,ch as b,T as N,B as P,aH as R,_ as j}from"./index-b864a2d5.js";import{b as x}from"./product-37aa6fe9.js";import{u as _}from"./useThread-637a02aa.js";const G={key:0,class:"header"},S=["src"],A={key:1,class:"statement up"},I={key:3,class:"statement"},T={class:"footer"},D={key:0},E={class:"review-pdf"},O=e({name:"preNotice"});var J=w(e({...O,props:{productDetail:{default:()=>({})}},setup(e){const w=e,O=n(),{tenantId:J="",productCode:L,preview:U}=O.query,q=t(),B=a({insureConfig:{logoLocation:void 0,logoUrl:"",readingReminder:"",acceptReminder:"",readingSeconds:0,buttonTitle:"我知道了"}}),F=t(!1),H=t(!1),V=new i({source:"sessionStorage"});let W;const Z=t({title:"",link:""}),$=t(),z=o((()=>{if(Z.value.link){const e=(Z.value.link||"").split("?"),n=e[0].lastIndexOf("."),t=(e[0]||"").substring(n+1);if("pdf"===t)return"pdf";if([".jpg",".JPG",".jpeg",".JPEG",".png",".PNG",".gif",".tif"].includes(t))return"picture"}return"link"})),K=e=>{H.value=!H.value,Z.value.link=e.href,Z.value.title=e.innerText},M=()=>{F.value=!1};return s((()=>{!U&&(async()=>{const{code:e,data:n}=await x({insureCode:w.productDetail.insurerCode,productCode:L,tenantId:J});"10000"===e&&(B.insureConfig=n,$.value=B.insureConfig.readingSeconds||0,W=_({start:()=>{console.log("开始轮询"),$.value-=1},stop:()=>{console.log("结束轮询"),$.value=0,V.set("PRENOTICE-isShow","1")},time:1e3,number:B.insureConfig.readingSeconds||0}),y((()=>{W.run()}))),F.value=!0,b(q,"click",(e=>{const n=e||window.event;n.preventDefault?n.preventDefault():n.returnValue=!1;const{target:t}=n;let a=t;("SPAN"===t.tagName&&"A"===(null==t?void 0:t.parentNode.tagName)||"A"===t.tagName)&&("SPAN"===t.tagName&&"A"===(null==t?void 0:t.parentNode.tagName)&&(a=null==t?void 0:t.parentNode),console.dir(a),(e=>{if(!e)return!1;const[n]=(e||"").split("?"),t=n.lastIndexOf(".");if(-1===t)return!1;const a=n.substring(t);return[".jpg",".JPG",".jpeg",".JPEG",".png",".PNG",".gif",".tif",".pdf",".PDF"].includes(a)})(a.href)?K(a):"_blank"===a.target?0===a.href.indexOf("http://")||0===a.href.indexOf("https://")?window.open(a.href):N("配置网页链接需要带协议http://或https://"):K(a))}))})()})),(e,n)=>{var t;const a=P,i=R,o=j,s=r("dompurify-html");return l(),d(k,null,[u(i,{class:"pre-notice-wrap",show:p(F),"close-on-click-overlay":!1,closeable:!1,height:"auto",style:{"padding-bottom":"30px"}},{default:c((()=>[p(B).insureConfig.logoUrl?(l(),d("div",G,[f("img",{src:p(B).insureConfig.logoUrl},null,8,S)])):g("",!0),1===p(B).insureConfig.logoLocation&&p(B).insureConfig.acceptReminder?v((l(),d("div",A,null,512)),[[s,p(B).insureConfig.acceptReminder]]):g("",!0),p(B).insureConfig.readingReminder?(l(),d("div",{key:2,ref_key:"noticeRef",ref:q,class:"content"},[v(f("div",null,null,512),[[s,p(B).insureConfig.readingReminder]])],512)):g("",!0),2===p(B).insureConfig.logoLocation&&p(B).insureConfig.acceptReminder?v((l(),d("div",I,null,512)),[[s,p(B).insureConfig.acceptReminder]]):g("",!0),f("div",T,[u(a,{type:"primary",disabled:0!==p($),block:"",round:"",onClick:M},{default:c((()=>[m(h(p(B).insureConfig.buttonTitle)+" ",1),p($)?(l(),d("span",D,h(p($))+"s",1)):g("",!0)])),_:1},8,["disabled"])])])),_:1},8,["show"]),u(i,{show:p(H),"onUpdate:show":n[0]||(n[0]=e=>C(H)?H.value=e:null),class:"pre-notice-wrap",title:null==(t=p(Z))?void 0:t.title,position:"bottom","close-on-click-overlay":!1,style:{overflow:"hidden"}},{default:c((()=>{var e;return[f("div",E,[u(o,{"is-iframe":!1,content:null==(e=p(Z))?void 0:e.link,type:p(z)},null,8,["content","type"])])]})),_:1},8,["show","title"])],64)}}}),[["__scopeId","data-v-16aded00"]]);export{J as default};
