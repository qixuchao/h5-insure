!function(){var e=document.createElement("style");e.innerHTML='.page-trial-wrapper[data-v-c183ad30]{background-color:#f2f5fc}.page-trial-wrapper .part-card[data-v-c183ad30]{background-color:#fff;margin-bottom:.26667rem}.page-trial-wrapper .risk-content[data-v-c183ad30] .van-collapse-item__title--expanded{padding:0 .4rem 0 0;display:flex;align-items:center}.page-trial-wrapper .risk-content[data-v-c183ad30] .van-collapse-item__content{padding:0}.page-trial-wrapper .plan-risk[data-v-c183ad30] .van-tabs__line{display:none}.page-trial-wrapper .footer-bar[data-v-c183ad30]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4}.page-trial-wrapper .footer-bar .trial-result[data-v-c183ad30]{width:5.86667rem;color:#ff5840;font-size:.32rem;font-weight:600}.page-trial-wrapper .footer-bar .trial-result .result-num[data-v-c183ad30]{font-size:.61333rem;font-weight:500;margin-left:.17333rem}.page-trial-wrapper .footer-bar .trial-operate button[data-v-c183ad30]{width:3.73333rem}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip[data-v-c183ad30]{position:absolute;z-index:122;height:.56rem;border-radius:1.33333rem;background-color:#ff5840;font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC,sans-serif;font-weight:400;color:#fff;line-height:.49333rem;padding:.04rem .28rem .02667rem .26667rem;right:.4rem;top:-.46667rem;display:flex;align-items:center}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip .close-icon[data-v-c183ad30]{margin-left:.17333rem}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip[data-v-c183ad30]:after{content:" ";position:absolute;z-index:11;width:0;height:0;border:.13333rem solid transparent;border-top:.13333rem solid #ff5840;border-right:.13333rem solid #ff5840;right:.49333rem;bottom:-.16rem}\n',document.head.appendChild(e),System.register(["./vendor-legacy-a96446a8.js","./index-legacy-c3c344ef.js","./trial-legacy-efb79854.js","./createProposal-legacy-05db6bf0.js","./index-legacy-8adc8990.js","./useStorage-legacy-a11ebe39.js","./trial-legacy-d33c8c23.js","./useDicData-legacy-ec8b22f6.js"],(function(e){"use strict";var a,t,i,r,o,n,l,s,d,c,u,p,f,g,m,v,k,y,b,h,C,P,L,O,I,V,_,R,w,T,D,F,N;return{setters:[function(e){a=e.g,t=e.ak,i=e.O,r=e.E,o=e.M,n=e.a6,l=e._,s=e.o,d=e.r,c=e.j,u=e.k,p=e.m,f=e.A,g=e.n,m=e.p,v=e.t,k=e.z,y=e.F,b=e.G,h=e.J,C=e.C},function(e){P=e.P,L=e.R},function(e){O=e.i,I=e.p},function(e){V=e.q},function(e){_=e._,R=e.n,w=e.P,T=e.g},function(e){D=e.u},function(e){F=e.P,N=e.I},function(){}],execute:function(){const j={key:0,class:"part-card"},B={key:1,class:"part-card"},x={class:"risk-content"},A={key:0,class:"risk"},S={key:1,class:"plan-risk"},E={class:"footer-bar"},q={class:"trial-result"},z={class:"result-num"},M=C(" 元起 "),U={class:"trial-operate"},J={key:0,class:"retrial-tip"},H=C(" 条件更改后，需要重新试算 "),K=C("去试算"),G=C("立即投保"),W=a({setup(e){const a=t(),C=i(),{templateId:_=1,agentCode:W="test",agencyCode:X="",tenantId:Y=9991000007,insurerCode:Q="99",proposalId:Z}=C.query;let{productCode:$="MMBBSF"}=C.query;const ee=r({personVO:{occupationCodeList:[]}}),ae=r({insuredCode:"",personVO:{occupationCodeList:[]}}),te=r({}),ie=r({}),re=r({}),oe=r({}),ne=r({}),le=o({currentPlan:"",riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,enumList:{},ageRange:[],collapseName:["1"],insuredRiskList:[],currentRiskList:[]});if(Z)try{var se,de;$=null===(se=JSON.parse((null===(de=C.query)||void 0===de?void 0:de.extInfo)||"{}"))||void 0===se?void 0:se.productCenterCode}catch(ve){}n("premium",ne.value),D().get("userInfo");const ce=()=>{le.retrialTip=!1},ue=()=>{R({agencyId:X,saleUserId:W,tenantId:Y,venderCode:le.riskBaseInfo.insurerCode,orderDataSource:1,proposalId:Z,extInfo:{templateId:+(_||1),pageCode:"premiumTrial",iseeBizNo:window.iseeBiz},tenantOrderHolder:{extInfo:{occupationCodeList:ae.value.personVO.occupationCodeList}},tenantOrderInsuredList:[{extInfo:{occupationCodeList:ee.value.personVO.occupationCodeList},tenantOrderProductList:[{productCode:le.riskBaseInfo.productCode||"",productName:le.riskBaseInfo.productName||"",premium:le.trialResult.premium||0,tenantOrderRiskList:le.insuredRiskList}]}]}).then((({code:e,data:t})=>{"10000"===e&&"jumpToPage"===t.pageAction.pageAction&&a.push({path:w[t.pageAction.data.nextPageCode],query:{insurerCode:le.riskBaseInfo.insurerCode,...C.query,orderNo:t.pageAction.data.orderNo}})}))},pe=()=>{const e=JSON.parse(JSON.stringify(te.value[le.currentPlan])),a=Object.values(e).find((e=>1===e.riskType)),t=Object.values(e).map((e=>{const t=e;if("3"===t.chargePeriod){const e=(a.chargePeriod||"").split("_");e[1]&&(e[1]-=1),t.chargePeriod=e.join("_")}return t.liabilityVOList=(t.liabilityVOList||[]).filter((e=>1===e.optionalFlag||e.liabilityAttributeValue&&"-1"!==e.liabilityAttributeValue)).map((e=>{const a=e;return"0"===a.liabilityAttributeValue&&(a.liabilityAttributeValue=""),a})),t})),i={holder:ee.value,productCode:le.riskBaseInfo.productCode,insuredVOList:[{...ae.value,productPlanVOList:[{planCode:le.currentPlan||"",insurerCode:le.riskBaseInfo.insurerCode,riskVOList:t}]}]};I({...i}).then((({code:e,data:a})=>{if("10000"===e){le.retrialTip=!1,le.trialResult=a,le.canTrial=!1;const e={},t=(a=[])=>{(a||[]).forEach((a=>{var i;e[a.riskCode]=a,null!==(i=a.riskPremiumDetailVOList)&&void 0!==i&&i.length&&t(a.riskPremiumDetailVOList)}))};t(a.riskPremiumDetailVOList),((e,a)=>{le.insuredRiskList=e.map((e=>{var t,i;return{initialAmount:null===(t=a[e.riskCode])||void 0===t?void 0:t.amount,amountUnit:1,annuityDrawFrequency:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,paymentFrequency:e.paymentFrequency,paymentPeriod:e.chargePeriod.split("_")[1],paymentPeriodType:F[e.chargePeriod.split("_")[0]],insurancePeriodType:N["to_life"===e.coveragePeriod?"to_life":e.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+e.coveragePeriod.split("_")[1])?0:e.coveragePeriod.split("_")[1],riskCode:e.riskCode,riskType:e.riskType,extInfo:{riskId:e.riskId,copy:e.copy},initialPremium:null===(i=a[e.riskCode])||void 0===i?void 0:i.premium,liabilityDetails:e.liabilityVOList.map((e=>({liabilityCode:e.liabilityCode,liabilityName:e.liabilityName,refundMethod:e.liabilityAttributeValue}))),productId:le.riskBaseInfo.id}}))})(i.insuredVOList[0].productPlanVOList[0].riskVOList,e),Object.assign(ne.value,e)}}))},fe=()=>{var e,a,t,i,r;Promise.all([null===(e=ie.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e),null===(t=re.value)||void 0===t||null===(i=t.validateForm)||void 0===i?void 0:i.call(t),null===(r=oe.value)||void 0===r?void 0:r.validate()]).then((()=>{pe()}))},ge=()=>{O({productCode:$,source:1}).then((({code:e,data:a})=>{var t,i;"10000"===e&&(le.riskBaseInfo=a.productBasicInfoVO,(a.productRelationPlanVOList.length?a.productRelationPlanVOList:a.productRiskVoList[0].riskDetailVOList||[]).forEach(((e,a)=>{0===a&&(le.currentPlan=e.planCode||"0"),Z||Object.assign(te.value,{[e.planCode||a]:{}})})),le.riskData=(null===(t=a.productRiskVoList[0])||void 0===t?void 0:t.riskDetailVOList)||[],le.riskPlanData=a.productRelationPlanVOList||[],Z&&(i=a.productBasicInfoVO.id,V({id:Z,tenantId:Y}).then((({code:e,data:a})=>{if("10000"===e){var t;const{proposalInsuredProductList:e=[],...r}=(null===(t=a.proposalInsuredList)||void 0===t?void 0:t[0])||{};Object.assign(ee.value.personVO,a.proposalHolder);const o=e.find((e=>e.productId===i));Object.assign(ae.value.personVO,r,{occupationCodeList:(null==o?void 0:o.occupationCodeList)||[]});const n={};((null==o?void 0:o.proposalProductRiskList)||[]).forEach((e=>{n[e.riskId]=e})),Object.assign(te.value,{0:n})}}))))})).finally((()=>{}))},me=e=>{le.holderFactor=e.holderFactorList,le.insuredFactor=e.insuredFactorList,le.ageRange=e.ageRange};return l([()=>te.value,()=>ee.value,()=>ae.value],(e=>{e&&!le.canTrial&&(le.canTrial=!0,le.retrialTip=!0)}),{deep:!0}),s((()=>{ge(),T({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then((({code:e,data:a})=>{if("10000"===e){const e={};a.forEach((a=>{e[a.dictCode]=a.dictItemList})),le.enumList=e}}))})),(e,a)=>{const t=d("ProTitle"),i=d("VanForm"),r=d("ProTabButton"),o=d("VanTab"),n=d("VanTabs"),l=d("van-collapse-item"),s=d("van-collapse"),C=d("VanButton"),O=d("ProPageWrap");return c(),u(O,{class:"page-trial-wrapper"},{default:p((()=>{var e,d,O;return[f(le).holderFactor.length?(c(),g("div",j,[m(t,{title:"投保人"}),m(P,{ref_key:"holderRef",ref:ie,"insured-code":null===(e=f(le).riskBaseInfo)||void 0===e?void 0:e.insurerCode,"form-info":ee.value.personVO,"factor-list":f(le).holderFactor,"age-range":f(le).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):v("",!0),f(le).insuredFactor.length?(c(),g("div",B,[m(t,{title:"被保人"}),m(P,{ref_key:"insuredRef",ref:re,"insured-code":null===(d=f(le).riskBaseInfo)||void 0===d?void 0:d.insurerCode,"form-info":ae.value.personVO,"factor-list":f(le).insuredFactor,"age-range":f(le).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):v("",!0),k("div",x,[m(s,{modelValue:f(le).collapseName,"onUpdate:modelValue":a[1]||(a[1]=e=>f(le).collapseName=e)},{default:p((()=>[m(l,{name:"1"},{title:p((()=>[m(t,{title:"投保方案"})])),default:p((()=>[f(le).riskData.length&&te.value[0]?(c(),g("div",A,[m(i,{ref_key:"riskFormRef",ref:oe,"input-align":"right","error-message-align":"right"},{default:p((()=>[m(L,{"risk-info":te.value[0],enums:f(le).enumList,"origin-data":f(le).riskData,"pick-factor":me},null,8,["risk-info","enums","origin-data"])])),_:1},512)])):v("",!0),f(le).riskPlanData.length?(c(),g("div",S,[m(i,{ref_key:"riskFormRef",ref:oe,"input-align":"right","error-message-align":"right"},{default:p((()=>[m(n,{active:f(le).currentPlan,"onUpdate:active":a[0]||(a[0]=e=>f(le).currentPlan=e)},{default:p((()=>[(c(!0),g(y,null,b(f(le).riskPlanData,(e=>(c(),u(o,{key:e.planCode,name:e.planCode,title:e.planName},{title:p((()=>[m(r,{title:e.planName,active:f(le).currentPlan===e.planCode},null,8,["title","active"])])),default:p((()=>{var a;return[e.planCode===f(le).currentPlan?(c(),u(L,{key:0,"risk-info":te.value[e.planCode],enums:f(le).enumList,"origin-data":null===(a=e.productRiskVoList)||void 0===a?void 0:a[0].riskDetailVOList,"pick-factor":me},null,8,["risk-info","enums","origin-data"])):v("",!0)]})),_:2},1032,["name","title"])))),128))])),_:1},8,["active"])])),_:1},512)])):v("",!0)])),_:1})])),_:1},8,["modelValue"])]),k("div",E,[k("span",q,[k("span",z,h((f(le).retrialTip?"0":(null===(O=f(le).trialResult)||void 0===O?void 0:O.premium)||"0").toLocaleString()),1),M]),k("div",U,[f(le).retrialTip?(c(),g("div",J,[H,k("span",{class:"close-icon",onClick:ce},"X")])):v("",!0),f(le).canTrial?(c(),u(C,{key:1,type:"primary",onClick:fe},{default:p((()=>[K])),_:1})):(c(),u(C,{key:2,type:"primary",onClick:ue},{default:p((()=>[G])),_:1}))])])]})),_:1})}}});e("default",_(W,[["__scopeId","data-v-c183ad30"]]))}}}))}();
