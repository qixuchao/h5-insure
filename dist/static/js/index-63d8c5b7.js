import{a2 as a,d as e,dX as t,j as r,k as l,bp as s,dP as o,o as n,c as i,a as c,e as m,u as d,a8 as u,b as w,w as p,F as y,q as k,_ as v,aq as h,f as _,ae as f,ca as g,cb as b,bu as C,m as S,p as x,n as N,aD as T,aE as D,aF as I,aH as $,i as V,r as j,O,af as M,ea as P,dq as A,L,bQ as q}from"./index-8120d8cf.js";import{_ as E}from"./index-a321812c.js";import{S as z}from"./index-de476922.js";import{d as F,e as U}from"./trial-656dc3ab.js";import{C as R}from"./index-730c4f15.js";import{g as H}from"./utils-b0183f21.js";import"./empty-ae586b6c.js";import"./infoCollection-d8c37848.js";const J={class:"com-type-filter"},W={class:"wrapper"},B=["onClick"],Q=e({name:"TypeFilter"});var X=v(e({...Q,props:{type:{type:Number,default:1},modelValue:{type:Number,default:0},items:{type:Array,default:()=>[]}},emits:["change","update:modelValue"],setup(a,{emit:e}){const v=a,h=[{label:"全部",value:""},{label:"长期",value:1},{label:"短期",value:3}],_=t(v,"modelValue",e),f=r(!1),g=l((()=>{switch(+v.type){case 1:return[{label:"全部",value:""},...U];case 2:return[{label:"全部",value:""},...F];default:return h}})),b=l((()=>{const a=g.value.find((a=>+a.value==+_.value));return console.log("types",g.value,"当前type：",a),a?a.label:"全部"}));return(a,t)=>{const r=s,l=o;return n(),i(y,null,[c("div",J,[c("div",{onClick:t[0]||(t[0]=a=>f.value=!0)},[c("span",null,m(d(b)),1),u(),w(r,{name:"arrow-down"})])]),w(l,{show:f.value,style:{"background-color":"transparent"},onClick:t[1]||(t[1]=a=>f.value=!1)},{default:p((()=>[c("div",W,[(n(!0),i(y,null,k(d(g).filter((a=>+a.value!=+d(_))),(a=>(n(),i("div",{key:a.label,class:"block",onClick:t=>{return r=a,_.value=r.value,void e("change",r);var r}},m(a.label),9,B)))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-129d7a22"]]);const Y={class:"com-card-data"},G={class:"title"},K={class:"item-list"},Z={class:"label"},aa={class:"files"},ea=["onClick"],ta=e({name:"Row"}),ra=e({...ta,props:{list:{type:Array,default:()=>[]}},emits:["preview"],setup(a,{emit:e}){const t=h(U),r=h(F),l=["产品说明书","产品条款","费率表","风险告知书","其他","投保规则","责任条款"],o=[{key:"riskType",label:"主 附 险",value:"主险",format:a=>t[a]},{key:"insurancePeriodValues",label:"保障期间",value:"180天"},{key:"paymentPeriodValues",label:"交费期间",value:"终生"},{key:"riskCategory",label:"险种类别",value:"寿险",format:a=>r[a]}],d=a=>o.filter((e=>a[e.key])).map((e=>{const t=a[e.key];return{...e,value:e.format?e.format(t):t}}));return(e,t)=>{const r=s,o=f;return n(),i("div",Y,[(n(!0),i(y,null,k(a.list,(a=>(n(),i("div",{key:a.riskId,class:"card"},[c("div",G,[u(m(a.riskName),1),w(r,{name:"arrow",color:"#c2c2c2"})]),c("div",K,[(n(!0),i(y,null,k(d(a),(({label:a,value:e})=>(n(),i(y,null,[e?(n(),i("div",{key:a,class:"item"},[c("span",Z,m(a)+":",1),u(),c("span",null,m(e),1)])):_("",!0)],64)))),256))]),c("div",aa,[(n(!0),i(y,null,k(null==a?void 0:a.attachmentDetailVOS,(a=>(n(),i("div",{key:a.riskId,class:"file",onClick:t=>e.$emit("preview",a)},[w(o,{name:l.includes(a.categoryName)?a.categoryName:"自定义"},null,8,["name"]),c("div",null,m(a.categoryName),1)],8,ea)))),128))])])))),128))])}}});const la={class:"com-row-tabs"},sa={class:"row-data"},oa={class:"file-name"},na=(a=>(D("data-v-a74781f4"),a=a(),I(),a))((()=>c("span",{class:"dot"},null,-1))),ia=["onClick"],ca=e({name:"Tabs"});var ma=v(e({...ca,props:{tabs:{type:Array,default:()=>[]},list:{type:Array,default:()=>[]},active:{type:String,default:""}},emits:["@update:active","preview"],setup(a,{emit:e}){const l=t(a,"active",e),s=r(!1);return(t,r)=>{const o=g,u=b,v=f,h=C,D=R,I=T;return n(),i(y,null,[c("div",la,[a.tabs.length?(n(),S(u,{key:0,active:d(l),"onUpdate:active":r[0]||(r[0]=a=>x(l)?l.value=a:null),class:N(["tabs",a.tabs.length>3?"w80":""])},{default:p((()=>[(n(!0),i(y,null,k(a.tabs,(a=>(n(),S(o,{key:a,name:a,title:a},null,8,["name","title"])))),128))])),_:1},8,["active","class"])):_("",!0),a.tabs.length>3?(n(),i("div",{key:1,class:"more-arrow",onClick:r[1]||(r[1]=a=>s.value=!0)},[w(v,{name:"down-fill",color:"red"})])):_("",!0)]),c("div",sa,[w(D,null,{default:p((()=>[(n(!0),i(y,null,k(a.list,(a=>(n(),S(h,{key:a.id,"is-link":"",onClick:e=>t.$emit("preview",a)},{title:p((()=>[c("div",oa,[na,c("span",null,m(a.displayName),1)])])),_:2},1032,["onClick"])))),128))])),_:1})]),w(I,{show:s.value,title:"已选类别",onClose:r[2]||(r[2]=a=>s.value=!1)},{default:p((()=>[(n(!0),i(y,null,k(a.tabs,((a,t)=>(n(),i("div",{key:t,class:N(["tab-item",a==d(l)?"active":""]),onClick:t=>(a=>{l.value=a,s.value=!1,e("@update:active",a)})(a)},[c("div",null,m(a),1)],10,ia)))),128))])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-a74781f4"]]);function da(a){function e(){const e={watermark_txt:"text",watermark_x:20,watermark_y:20,watermark_rows:20,watermark_cols:20,watermark_x_space:100,watermark_y_space:50,watermark_color:"#f5ecec",watermark_alpha:.4,watermark_fontsize:"13px",watermark_font:"微软雅黑",watermark_width:210,watermark_height:80,watermark_angle:15};Object.assign(e,a);const t=document.createDocumentFragment(),r=Math.max(document.body.scrollWidth,document.body.clientWidth),l=r-.015*r,s=Math.max(document.body.scrollHeight,document.body.clientHeight)-30;let o,n;(0===e.watermark_cols||parseInt(e.watermark_x+e.watermark_width*e.watermark_cols+e.watermark_x_space*(e.watermark_cols-1))>l)&&(e.watermark_cols=parseInt((l-e.watermark_x+e.watermark_x_space)/(e.watermark_width+e.watermark_x_space)),e.watermark_x_space=parseInt((l-e.watermark_x-e.watermark_width*e.watermark_cols)/(e.watermark_cols-1))),(0===e.watermark_rows||parseInt(e.watermark_y+e.watermark_height*e.watermark_rows+e.watermark_y_space*(e.watermark_rows-1))>s)&&(e.watermark_rows=parseInt((e.watermark_y_space+s-e.watermark_y)/(e.watermark_height+e.watermark_y_space)),e.watermark_y_space=parseInt((s-e.watermark_y-e.watermark_height*e.watermark_rows)/(e.watermark_rows-1)));for(let a=0;a<e.watermark_rows;a+=1){n=e.watermark_y+(e.watermark_y_space+e.watermark_height)*a;for(let r=0;r<e.watermark_cols;r+=1){o=e.watermark_x+(e.watermark_width+e.watermark_x_space)*r;const l=document.createElement("div");l.id=`maskDiv${a}${r}`,l.className="maskDiv",l.appendChild(document.createTextNode(e.watermark_txt)),l.style.webkitTransform=`rotate(-${e.watermark_angle}deg)`,l.style.MozTransform=`rotate(-${e.watermark_angle}deg)`,l.style.msTransform=`rotate(-${e.watermark_angle}deg)`,l.style.OTransform=`rotate(-${e.watermark_angle}deg)`,l.style.transform=`rotate(-${e.watermark_angle}deg)`,l.style.visibility="",l.style.position="absolute",l.style.left=`${o}px`,l.style.top=`${n}px`,l.style.overflow="hidden",l.style.zIndex="9999",l.style.pointerEvents="none",l.style.opacity=e.watermark_alpha,l.style.fontSize=e.watermark_fontsize,l.style.fontFamily=e.watermark_font,l.style.color=e.watermark_color,l.style.textAlign="center",l.style.width=`${e.watermark_width}px`,l.style.height=`${e.watermark_height}px`,l.style.display="block",t.appendChild(l)}}document.body.appendChild(t)}const t=$((function(){document.querySelectorAll(".maskDiv").forEach((a=>{a.parentNode.removeChild(a)})),e()}),500);window.addEventListener("resize",t),e()}const ua={class:"page page-product-lib"},wa={key:1,class:"tac",style:{"margin-top":"50px"}},pa={class:"review-pdf"},ya=e({name:"ProductLib"});var ka=v(e({...ya,setup(e){const t=V(),{preview:s=!1,insurerCode:o="lianlife"}=t.query,m=j({rowDataMap:{},cardDatas:[],tabs:[],currentTab:""}),u=l((()=>(console.log("rowDatas",m.rowDataMap,m.tabs,m.currentTab),m.rowDataMap[m.currentTab]))),y=r({id:"",insurerCode:"lianlife",showStyle:1,materialCategoryShowStyle:1,riskName:"",showStyleDetails:[],isShowStopSellingLabel:"Y",showCategoryIds:[],showCategoryName:[],showStyleDetailName:[]}),k=r(!0),v=(e=(()=>{}))=>{((e={})=>a({url:"/api/app/insure/product/category/queryProductBoxConfig",method:"POST",data:e}))({insurerCode:o}).then((a=>{var t;console.log("获取配置成功",a),y.value=a.data,y.value.riskName="",m.currentTab=null==(t=m.tabs)?void 0:t[0],e&&(null==e||e())}))},h=()=>{k.value=!0,((e={})=>a({url:"/api/app/insure/product/category/riskAttachmentList",method:"POST",data:e}))({insurerCode:o,materialCategoryShowStyle:y.value.materialCategoryShowStyle,showStyle:y.value.showStyle,riskName:y.value.riskName,riskType:y.value.riskType,categoryId:y.value.showCategoryIds,showStyleDetails:y.value.showStyleDetails}).then((a=>{var e;const{attachmentListResMap:t,attachmentDetailVOS:r}=a.data||{attachmentListResMap:{},attachmentDetailVOS:[]};m.rowDataMap={...t};const l=Object.keys(t);m.tabs=null==(e=y.value.showCategoryName)?void 0:e.filter((a=>l.includes(a))),m.cardDatas=r,console.log("state.rowDatas",u)})).finally((()=>{k.value=!1}))},f=()=>{y.value.id?h():v((()=>{h()}))},g=r({attachmentName:"",attachmentContent:"",attachmentSource:1,show:!1}),b=j({name:"测试水印",agentCode:"1234"}),x=a=>{console.log("文件预览",b),g.value={...a,show:!0},da({watermark_txt:`${b.name}\r\n${b.agentCode}`,watermark_color:"#333",watermark_angle:30,watermark_width:100,watermark_height:60})},N=a=>{console.log("关闭文件预览"),document.querySelectorAll(".maskDiv").forEach((a=>{a.parentNode.removeChild(a)})),g.value={attachmentName:"",attachmentContent:"",attachmentSource:1,show:!1}};return O((()=>{s?window.addEventListener("message",(a=>{var e;console.log("子应用收到的数据",a.data);"object"==typeof JSON.parse(a.data)&&(y.value={...y.value,...JSON.parse(a.data)},m.currentTab=null==(e=m.tabs)?void 0:e[0],h()),console.log("合并后的config:",y.value)}),!1):v();const a=M.get(P);a&&(b.name=a.name,b.agentCode=a.agentCode),setTimeout((()=>{f()}),1e3)})),(a,e)=>{const t=z,r=C,l=A,s=L,o=E,v=q,h=T;return n(),i("div",ua,[w(l,null,{default:p((()=>[w(r,{class:"top-bar"},{default:p((()=>[c("div",null,[w(X,{modelValue:d(y).riskType,"onUpdate:modelValue":[e[0]||(e[0]=a=>d(y).riskType=a),e[1]||(e[1]=a=>d(y).riskType=a)],type:d(y).materialCategoryShowStyle,onChange:f},null,8,["modelValue","type"])]),w(t,{modelValue:d(y).riskName,"onUpdate:modelValue":e[2]||(e[2]=a=>d(y).riskName=a),"left-icon":"none",placeholder:"请搜索险种名称",shape:"round","clear-trigger":"always","show-action":"",onSearch:f},{action:p((()=>[c("div",{onClick:f},"搜索")])),_:1},8,["modelValue"])])),_:1})])),_:1}),c("div",null,[d(k)||1!=+d(y).showStyle?_("",!0):(n(),S(ma,{key:0,active:d(m).currentTab,tabs:d(m).tabs,list:d(u),"onUpdate:active":e[3]||(e[3]=a=>d(m).currentTab=a),onPreview:x},null,8,["active","tabs","list"])),d(k)?(n(),i("div",wa,[w(s,{type:"spinner"})])):_("",!0),d(k)||2!=+d(y).showStyle?_("",!0):(n(),S(ra,{key:2,list:d(m).cardDatas,onPreview:x},null,8,["list"])),d(k)||d(m).cardDatas.length?_("",!0):(n(),S(o,{key:3,title:"没有找到产品资料",style:{"margin-top":"40px"}}))]),w(h,{show:d(g).show,"onUpdate:show":e[4]||(e[4]=a=>d(g).show=a),class:"pre-file-wrap",title:d(g).attachmentName,position:"bottom","close-on-click-overlay":!1,style:{overflow:"hidden"},"header-style":{paddingRight:"40px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",paddingTop:"4px"},onClose:N},{default:p((()=>[c("div",pa,[w(v,{"is-iframe":!1,content:d(g).attachmentContent,type:d(H)(d(g).attachmentSource,d(g).attachmentContent)},null,8,["content","type"])])])),_:1},8,["show","title"])])}}}),[["__scopeId","data-v-0ddf6b9b"]]);export{ka as default};
