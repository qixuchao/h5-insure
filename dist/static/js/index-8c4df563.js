import{reactive as e,ref as a,toRefs as t,computed as o}from"vue";import{_ as r,aI as u,a as l,R as n,D as i,T as d}from"./index-d66a20d8.js";/* empty css              */import{P as s}from"./index-218bd70e.js";import{_ as v}from"./empty-ae586b6c.js";import{P as c}from"./index-cd2dae22.js";import{d as p,h as m}from"./proposalList-40dc08b4.js";import{a as h,b as f,t as V}from"./format-b5e9d8b9.js";import"./pdfh5-e588f83d.js";const x={class:"proposal-content"},y={class:"title"},g={class:"premium"},N={class:"operate-btn"};var C=r(vue.defineComponent({__name:"index",setup(r){const C=u(),k=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:e=>h(null==e?void 0:e.coveragePeriod)},{title:"交费期间",dataIndex:"chargePeriod",width:110,render:e=>f(null==e?void 0:e.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:e=>V(null==e?void 0:e.initialPremium)}],P=e({historyList:[],searchValue:""}),b=a(!1),_=a(!1),w=a(1),{historyList:j,searchValue:B}=t(P),E=l(),I=()=>{m({name:B.value,pageNum:w.value,pageSize:20,relationUserType:2}).then((e=>{const{code:a,data:t}=e;"10000"===a&&(1===w.value?j.value=t.datas||[]:j.value=j.value.concat(t.datas),b.value=!1,w.value+=1,_.value=j.value.length>=t.total)}))},L=()=>{I()},T=o((()=>j.value.length>0)),R=e=>{B.value=e,w.value=1,I()};return(e,a)=>{const t=vue.resolveComponent("van-search"),o=vue.resolveComponent("van-button"),r=vue.resolveComponent("van-list"),u=vue.resolveComponent("ProPageWrap"),l=vue.resolveComponent("van-config-provider");return vue.openBlock(),vue.createBlock(l,{"theme-vars":vue.unref(C)},{default:vue.withCtx((()=>[vue.createVNode(u,{class:"page-history-proposal"},{default:vue.withCtx((()=>[vue.createVNode(t,{modelValue:vue.unref(B),"onUpdate:modelValue":a[0]||(a[0]=e=>vue.isRef(B)?B.value=e:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:R},null,8,["modelValue"]),vue.createElementVNode("div",x,[vue.createVNode(r,{loading:vue.unref(b),"onUpdate:loading":a[1]||(a[1]=e=>vue.isRef(b)?b.value=e:null),finished:vue.unref(_),"finished-text":vue.unref(T)?"- 没有更多了 -":"",onLoad:L},{default:vue.withCtx((()=>[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(vue.unref(j),(e=>(vue.openBlock(),vue.createElementBlock("div",{key:e.id,class:"proposal-item"},[vue.createElementVNode("div",y,vue.toDisplayString(e.proposalName),1),vue.createElementVNode("p",g,[vue.createTextVNode(" 保费："),vue.createElementVNode("span",null,"¥"+vue.toDisplayString(vue.unref(n)(e.totalPremium)),1)]),vue.createVNode(c,{columns:k,class:"table","data-source":e.proposalProductRiskVOList},null,8,["data-source"]),vue.createElementVNode("div",N,[vue.createVNode(o,{plain:"",round:"",type:"primary",class:"del-btn",onClick:a=>{return t=e.id,void i.confirm({message:"是否确定删除计划书？"}).then((()=>{p(t).then((e=>{const{code:a}=e;"10000"===a&&(d.success("删除成功"),w.value=1,I())}))})).catch((()=>{}));var t}},{default:vue.withCtx((()=>[vue.createTextVNode("删除")])),_:2},1032,["onClick"]),vue.createVNode(o,{plain:"",round:"",type:"primary",onClick:a=>{return t=e.id,void E.push({path:"/proposal/createProposal",query:{id:t}});var t}},{default:vue.withCtx((()=>[vue.createTextVNode("编辑")])),_:2},1032,["onClick"]),vue.createVNode(o,{plain:"",round:"",type:"primary",onClick:a=>{return t=e.id,void E.push({path:"compositionProposal",query:{id:t}});var t}},{default:vue.withCtx((()=>[vue.createTextVNode("预览")])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),vue.unref(T)||vue.unref(b)?vue.createCommentVNode("",!0):(vue.openBlock(),vue.createBlock(s,{key:0,"empty-img":vue.unref(v),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-3ad77c53"]]);export{C as default};
