import{d as e,af as o,ag as a,i as t,h as s,r as n,j as i,aG as r,l,o as c,c as d,b as u,u as f,p,q as m,f as y,w as I,F as h,s as v,a as w,g as b,v as j,dG as g,T as k,bH as q,ak as C,bK as V,aS as x,aQ as L,c6 as T}from"./index-7925b1ec.js";import{P as _,a as P}from"./PolicyInfo-73428bfc.js";import{g as O,m as R}from"./trial-ab219489.js";import{n as E}from"./nextStep-7598bd2a.js";import{b as N,l as D}from"./product-01e8d33f.js";import{u as Q}from"./useOrder-d0fbb7ae.js";import{P as U}from"./index-a59363f8.js";import{P as F}from"./index-ce10e841.js";import{_ as S}from"./InsureInfo-f153f438.js";import{p as $,d as M}from"./utils-ea0bc875.js";import{Q as A}from"./notice-33e6eedd.js";import{g as B}from"./utils-aebcfadc.js";import{Q as G}from"./questionnaire-42dcb602.js";import{P as z}from"./constants-b39aa53b.js";import{T as J}from"./infoCollection-f7119ec1.js";import"./core-f3a9e2c5.js";import"./cloneDeep-6dfde5b8.js";import"./util-6c52abf9.js";import"./trial-13626411.js";const H={class:"long-info-preview"},K={class:"footer-button"},W=e({__name:"infoPreview",setup(e){const W=o((()=>a((()=>import("./index-5b5c214f.js")),["static/js/index-5b5c214f.js","static/css/index-fa4edf2a.css","static/js/index-7925b1ec.js","static/css/index-839a5189.css","static/js/theme-94cf7d00.js","static/js/index-ce10e841.js","static/css/index-bbfdd7ec.css","static/js/utils-aebcfadc.js","static/js/infoCollection-f7119ec1.js","static/js/trial-13626411.js"]))),X=t(),Y=s(),Z=Q(),{productCode:ee="",tenantId:oe,agentCode:ae="",agencyCode:te,saleChannelId:se,isShare:ne,orderNo:ie,extraInfo:re,insurerCode:le,objectType:ce="1",templateId:de,preview:ue,origin:fe}=X.query;let pe={};try{pe=JSON.parse(decodeURIComponent(re))}catch(Te){}const me=n({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),ye=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`;i({imgUrl:"",desc:"",title:"",link:ye});const Ie=i(),he=i(),ve=i(!1),we=i(0),be=i(!1),je=()=>{ve.value=!1};i();const ge=()=>{de===J.FREE&&(Z.value.extInfo.buttonCode=g.free.underWriteAndIssue,Z.value.extInfo.pageCode="productInfo",E(Z.value,((e,o)=>{o===L.JUMP_PAGE&&Y.push({path:z[e.nextPageCode],query:X.query})})))},ke=async()=>{de===J.FREE&&k("被保人已完成认证")},qe=i(),Ce=i(),Ve=i([]),xe=async()=>{let e={};const{code:o,data:a}=await O({orderNo:ie,tenantId:oe});"10000"===o&&(Object.assign(Z.value,a),e=$(a.insuredList[0].productList),qe.value=a,be.value=!0),(async e=>{let o=[];const{code:a,data:t}=await T({orderNo:ie,tenantId:oe});"10000"===a&&(o=t.productQuestionnaireVOList);const{code:s,data:n}=await D(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},a=e.filter((e=>e.businessType!==A.VISIT));me.customerQuestions=a.map((e=>{const{questionnaireDetailResponseVO:a,questionnaireId:t,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=a||{},{objectType:r,questionnaireType:l}=i||{};if(l===G.TEXT){const{content:e,textType:o}=(null==n?void 0:n[0])||{};return{content:e,contentType:B(`${o}`,e),questionnaireId:t,questionnaireName:s}}const c=(o||[]).find((e=>e.questionnaireId===t));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:t,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),N(e).then((({code:e,data:o})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:a}=M(o);Ve.value=e.concat(a)}})),R(e).then((({data:e,code:o})=>{if("10000"===o){const{productDetailResList:o,productFactor:a}=e;Ce.value=a;const{payInfo:t,other:s}=q(a);me.payInfo={...me.payInfo,...t},me.policyInfo={...me.policyInfo,...s}}}))};r((()=>{xe()}));const Le=i();return l((()=>{setTimeout((async()=>{Le.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,o)=>{var a,t,s;const n=C,i=V,r=x;return c(),d("div",H,[u(n),u(S,{"product-data":null==(t=null==(a=f(Z).insuredList)?void 0:a[0])?void 0:t.productList},null,8,["product-data"]),(null==(s=Object.keys(f(Ce)||{}))?void 0:s.length)?(c(),p(U,{key:0,ref_key:"personalInfoRef",ref:he,modelValue:f(qe),"onUpdate:modelValue":o[0]||(o[0]=e=>m(qe)?qe.value=e:null),"product-factor":f(Ce),"is-view":"","input-align":"left"},null,8,["modelValue","product-factor"])):y("",!0),f(me).payInfo.schema.length?(c(),p(f(_),{key:1,ref_key:"payInfoRef",ref:Ie,modelValue:f(Z).tenantOrderPayInfoList,"onUpdate:modelValue":o[1]||(o[1]=e=>f(Z).tenantOrderPayInfoList=e),schema:f(me).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),f(me).policyInfo.schema.length?(c(),p(f(P),{key:2,modelValue:f(Z).extInfo,"onUpdate:modelValue":o[2]||(o[2]=e=>f(Z).extInfo=e),schema:f(me).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),u(r,{title:"产品资料","show-line":!1,"show-icon":!1},{default:I((()=>[(c(!0),d(h,null,v(f(Ve),((e,o)=>(c(),p(i,{key:o,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{we.value=e,ve.value=!0})(o)},null,8,["title","onClick"])))),128))])),_:1}),w("div",K,["confirm"!==f(fe)?(c(),p(F,{key:0,shadow:!1,onClick:ke},{default:I((()=>[b(e.$slots,"default",{},(()=>[j("确认")]))])),_:3})):(c(),p(F,{key:1,shadow:!1,onClick:ge},{default:I((()=>[b(e.$slots,"default",{},(()=>[j("领取保障并激活")]))])),_:3}))]),f(ve)?(c(),p(f(W),{key:3,show:f(ve),"onUpdate:show":o[3]||(o[3]=e=>m(ve)?ve.value=e:null),"content-list":[f(Ve)[f(we)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:je},null,8,["show","content-list"])):y("",!0)])}}});export{W as default};
