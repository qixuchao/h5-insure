var ne=Object.defineProperty,ae=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var V=(d,a,o)=>a in d?ne(d,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[a]=o,E=(d,a)=>{for(var o in a||(a={}))de.call(a,o)&&V(d,o,a[o]);if(x)for(var o of x(a))ie.call(a,o)&&V(d,o,a[o]);return d},w=(d,a)=>ae(d,oe(a));import{g as U,j as Y,n as $,z as I,J as S,a9 as se,O as ce,E as y,h as ue,r as le,p,m as q,A as pe,C as K,T as me}from"./vendor-667a94d7.js";import{_ as ye,l as Ie,G as Oe}from"./index-d15b54a1.js";import{i as _e,a as fe,s as ve,e as Le,E as Ne}from"./trial-6131197b.js";import{p as De}from"./product-c436ec1d.js";import{e as B,i as M,P as he,I as Pe}from"./trial-de752cfb.js";const Te={class:"com-field-info"},Ce={class:"title"},ge={class:"desc"},be=U({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup(d){return(a,o)=>(Y(),$("div",Te,[I("div",Ce,S(d.title),1),I("div",ge,S(d.desc),1)]))}});var D=ye(be,[["__scopeId","data-v-35c1ec17"]]);const Ee={class:"page-product-detail"},Se={class:"footer-button"},He={class:"price"},Re=K(" \u603B\u4FDD\u8D39"),ke=K("\u5347\u7EA7\u4FDD\u969C"),Ue=U({setup(d){se();const a=ce(),{productCode:o,orderId:j,tenantId:O}=a.query;y();const u=y(),h=y(),l=y(),m=y(),H=t=>{const r=t.find(e=>e.riskType===B.MAIN_RISK);return t.map(e=>{var A;const{riskInsureLimitVO:n,riskCategory:i,id:s,riskType:c,riskName:_,riskCode:f,riskLiabilityInfoVOList:v,riskCalcMethodInfoVO:L}=e,{insurancePeriodType:Fe,insurancePeriodValueList:P,paymentFrequencyList:T,paymentPeriodValueList:C,paymentPeriodType:Ae,annuityDrawFrequencyList:g,annuityDrawValueList:b,insurancePeriodRule:X,paymentPeriodRule:Z}=n,{fixedAmount:ee,minCopy:te}=L,N={amount:ee,riskCode:f,riskId:s,riskName:_,chargePeriod:C==null?void 0:C[0],annuityDrawDate:b==null?void 0:b[0],riskType:c,annuityDrawFrequency:g==null?void 0:g[0],copy:te,coveragePeriod:P==null?void 0:P[0],insuredCode:(A=u.value)==null?void 0:A.insurerCode,liabilityVOList:v.filter(re=>re.optionalFlag===1),paymentFrequency:T==null?void 0:T[0],riskCategory:i};return c===B.MAIN_RISK?N:(X===M.ONE_YEAR&&(N.coveragePeriod="year_1"),Z===M.ONE_YEAR&&(N.chargePeriod="year_1"),w(E({},N),{mainRiskId:r==null?void 0:r.id,mainRiskCode:r==null?void 0:r.riskCode}))})},R=(t,r)=>t.map(e=>{var i,s;return{tenantId:O,amountUnit:1,annuityDrawFrequency:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,paymentFrequency:e.paymentFrequency,paymentPeriod:e.chargePeriod.split("_")[1],paymentPeriodType:he[e.chargePeriod.split("_")[0]],insurancePeriodType:Pe[e.coveragePeriod==="to_life"?"to_life":e.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+e.coveragePeriod.split("_")[1])?0:e.coveragePeriod.split("_")[1],riskCode:e.riskCode,riskType:e.riskType,extInfo:{riskId:e.riskId,copy:e.copy},initialPremium:(i=r[e.riskCode])==null?void 0:i.premium,liabilityDetails:e.liabilityVOList.map(c=>({liabilityCode:c.liabilityCode,liabilityName:c.liabilityName,refundMethod:c.liabilityAttributeValue})),productId:(s=u.value)==null?void 0:s.id}}),z=()=>{const t=H(h.value.productRiskVoList[0].riskDetailVOList),r=R(t,{}),e=l.value;return{tenantId:O,venderCode:e.venderCode,orderDataSource:e.orderDataSource,tenantOrderHolder:{tenantId:e.tenantOrderHolder.tenantId,name:e.tenantOrderHolder.name,certType:e.tenantOrderHolder.certType,certNo:e.tenantOrderHolder.certNo,mobile:e.tenantOrderHolder.mobile,birthday:e.tenantOrderHolder.birthday,gender:e.tenantOrderHolder.gender},extInfo:e.extInfo.extraInfo,tenantOrderInsuredList:[{tenantId:e.tenantOrderInsuredList[0].tenantId,relationToHolder:e.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:e.tenantOrderInsuredList[0].insuredBeneficiaryType,name:e.tenantOrderInsuredList[0].name,hasSocialInsurance:e.tenantOrderInsuredList[0].hasSocialInsurance,certType:e.tenantOrderInsuredList[0].certType,certNo:e.tenantOrderInsuredList[0].certNo,mobile:e.tenantOrderInsuredList[0].mobile,birthday:e.tenantOrderInsuredList[0].birthday,gender:e.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:e.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:u.value.productCode,productName:u.value.productName,premium:m.value,tenantOrderRiskList:r}]}]}},G=async()=>{const t=z(),r=await ve(t),{code:e,data:n}=r;return e==="10000"?n.data:""},k=()=>{const t=l.value;return{agencyId:t.agencyId,venderCode:t.venderCode,applicationNo:t.applicationNo,orderDataSource:t.orderDataSource,orderNo:t.orderNo,orderStatus:t.orderStatus,policyNo:t.policyNo,tenantId:O,orderAmount:m.value,tenantOrderHolder:{tenantId:t.tenantOrderHolder.tenantId,name:t.tenantOrderHolder.name,certType:t.tenantOrderHolder.certType,certNo:t.tenantOrderHolder.certNo,mobile:t.tenantOrderHolder.mobile,birthday:t.tenantOrderHolder.birthday,gender:t.tenantOrderHolder.gender},tenantOrderInsuredList:[{premium:m.value,tenantId:t.tenantOrderInsuredList[0].tenantId,relationToHolder:t.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:t.tenantOrderInsuredList[0].insuredBeneficiaryType,name:t.tenantOrderInsuredList[0].name,hasSocialInsurance:t.tenantOrderInsuredList[0].hasSocialInsurance||1,certType:t.tenantOrderInsuredList[0].certType,certNo:t.tenantOrderInsuredList[0].certNo,mobile:t.tenantOrderInsuredList[0].mobile||"13061958179",birthday:t.tenantOrderInsuredList[0].birthday,gender:t.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:t.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:u.value.productCode,productName:u.value.productName,tenantOrderRiskList:R(H(h.value.productRiskVoList[0].riskDetailVOList),{})}]}]}},F=async()=>{const t=k(),r=await Le(t),{code:e,data:n}=r;e==="10000"&&(m.value=n.installmentPremium)},J=async t=>{const r=k(),e=await Ne(E({id:t},r)),{code:n,data:i}=e;n==="10000"&&me("\u4FDD\u969C\u5347\u7EA7\u6210\u529F")},Q=async t=>{await F();const r=await G();J(r)},W=()=>{const t=De({productCode:o,withInsureInfo:!0}),r=_e({productCode:o}),e=fe({id:j,tenantId:O});Promise.all([t,r,e]).then(([n,i,s])=>{console.log(n,i,s),n.code==="10000"&&(u.value=n.data),i.code==="10000"&&(h.value=i.data),s.code==="10000"&&(l.value=s.data),F()})};return ue(()=>{W()}),(t,r)=>{const e=le("van-button");return Y(),$("div",Ee,[p(Ie,null,{default:q(()=>{var n,i,s,c,_,f,v,L;return[p(D,{title:"\u59D3\u540D",desc:(i=(n=l.value)==null?void 0:n.tenantOrderInsuredList)==null?void 0:i[0].name},null,8,["desc"]),p(D,{title:"\u8BC1\u4EF6\u53F7\u7801",desc:(c=(s=l.value)==null?void 0:s.tenantOrderInsuredList)==null?void 0:c[0].certNo},null,8,["desc"]),p(D,{title:"\u624B\u673A\u53F7\u7801",desc:(f=(_=l.value)==null?void 0:_.tenantOrderInsuredList)==null?void 0:f[0].mobile},null,8,["desc"]),p(D,{title:"\u6709\u65E0\u793E\u4FDD",desc:(L=(v=l.value)==null?void 0:v.tenantOrderInsuredList)==null?void 0:L[0].hasSocialInsurance},null,8,["desc"])]}),_:1}),I("div",Se,[I("div",He,[Re,I("span",null,"\uFFE5"+S(pe(Oe)(m.value))+"/\u6708",1)]),p(e,{type:"primary",class:"right",onClick:Q},{default:q(()=>[ke]),_:1})])])}}});export{Ue as default};
