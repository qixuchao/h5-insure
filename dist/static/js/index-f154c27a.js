import{d as a,dI as e,j as l,k as t,z as n,a6 as s,bX as i,cl as o,dn as u,o as d,c as r,a as c,u as v,F as p,q as m,n as f,e as g,f as h,m as y,a8 as k,b as C,ae as w,aO as b,w as L,p as E,V as S,_ as U,dJ as N,dK as j,E as A,cT as B,dL as $,aD as _,aE as x,aF as F}from"./index-6027c89f.js";import{o as P}from"./utils-dad0fa14.js";import"./infoCollection-c7c3a2b1.js";import"./trial-7ba34a46.js";const T={class:"guarantee-list"},V=(a=>(x("data-v-72bcb63c"),a=a(),F(),a))((()=>c("span",null,"保障计划",-1))),q={key:0,class:"plan-list"},z=["onClick"],D={key:2,class:"feerate-view"},I={key:0},O={class:"extinfo-info-list"},G={class:"guarantee-detail"},J={class:"content"},K=a({name:"guarantee"});var M=U(a({...K,props:{dataSource:{default:()=>({})},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{default:5},planList:{default:()=>[]}},emits:["updateActivePlan"],setup(a,{emit:U}){var x,F;const K=a;e((a=>({"47c8f96c":v(M)})));const M=l(""),R=l((null==(F=null==(x=K.planList)?void 0:x[0])?void 0:F.planCode)||void 0),X=l(),Y=l([]),H=l([]),Q=l(),W=t((()=>!!K.planList.length));n([()=>K.dataSource,()=>R.value],(()=>{var a,e;Y.value=((null==(e=((null==(a=K.dataSource)?void 0:a.GUARANTEE)||[]).find((a=>a.planCode===R.value)))?void 0:e.data)||[]).filter((a=>a.isShowOn===`${s.YES}`))}),{immediate:!0,deep:!0});const Z=t((()=>{var a;return(null==(a=K.dataSource)?void 0:a.rateUri)||""})),aa=t((()=>!!(Q.value&&Q.value.paymentFrequencyValue&&Q.value.premiumUnit&&Z))),[ea,la]=i(!1),ta=t((()=>{var a;return!(!Y.value||!(null==(a=Y.value)?void 0:a.length))&&(Y.value.length>K.count&&(!!K.isShowClose||!ea.value))})),na=()=>{la()},sa=t((()=>{var a;return Y.value&&(null==(a=Y.value)?void 0:a.length)?Y.value.length<=K.count||ea.value?Y.value:Y.value.slice(0,K.count):[]})),ia=l(!1),oa=a=>{const e=a||window.event;e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,"A"===e.target.tagName&&e.target.href&&(N()?j("",e.target.href):window.open(e.target.href))},ua=()=>{ia.value=!0,A((()=>{var a,e;null==(e=null==(a=document.getElementsByClassName("guarantee-detail"))?void 0:a[0])||e.addEventListener("click",oa,!1)}))};o((()=>{var a,e;null==(e=null==(a=document.getElementsByClassName("guarantee-detail"))?void 0:a[0])||e.removeEventListener("click",oa,!1)}));const da=()=>{P({fileType:"pdf",fileUri:Z.value})},ra=a=>{R.value=K.planList[a.name].planCode};return(e,l)=>{var t,n;const s=B,i=$,o=_,N=u("dompurify-html");return d(),r(p,null,[c("div",T,[c("div",{class:"header"},[V,c("span",{onClick:ua},"查看详情")]),v(W)?(d(),r("div",q,[(d(!0),r(p,null,m(a.planList,((a,e)=>(d(),r("div",{key:`${a.planCode}_${e}`,class:f("plan-list-item "+(a.planCode===v(R)?"plan-list-item-active":"")),onClick:e=>{return l=a.planCode,R.value=l,X.value=K.planList.findIndex((a=>a.planCode===l)),void U("updateActivePlan",l);var l}},[c("span",null,g(a.planName),1)],10,z)))),128))])):h("",!0),(d(!0),r(p,null,m(v(sa),((a,e)=>(d(),y(s,{key:e,class:"guarantee-item",title:a.title,content:a.desc,border:!1},null,8,["title","content"])))),128)),v(ta)?(d(),r("div",{key:1,class:"show-more",onClick:na},[k(g(v(ea)?"收起":"查看更多")+" ",1),C(w,{name:"arrow-down-dobule",class:f(["icon",{showMore:v(ea)}])},null,8,["class"])])):h("",!0),v(aa)?(d(),r("div",D,[c("span",null,g(`${(null==(t=v(Q))?void 0:t.paymentFrequencyValue)||""}${(null==(n=v(Q))?void 0:n.premiumUnit)||""}`),1),v(Z)?(d(),r("span",{key:0,onClick:da},"查看保费")):h("",!0)])):h("",!0)]),C(b),C(o,{show:v(ia),"onUpdate:show":l[1]||(l[1]=a=>E(ia)?ia.value=a:null),title:"保障详情",class:"guarantee-popup"},{default:L((()=>[v(H)&&v(H).length>0?(d(),r("div",I,[c("div",O,[(d(!0),r(p,null,m(v(H),((a,e)=>(d(),y(s,{key:e,title:a.name,content:a.description,border:!1,size:"small"},null,8,["title","content"])))),128))]),C(b)])):h("",!0),v(W)?(d(),y(i,{key:1,active:v(X),"onUpdate:active":l[0]||(l[0]=a=>E(X)?X.value=a:null),list:a.planList.map(((a,e)=>({title:a.planName}))),class:"custom-plan-tab",onClickTab:ra},null,8,["active","list"])):h("",!0),c("div",G,[(d(!0),r(p,null,m(v(Y),((a,e)=>(d(),r("div",{key:e,class:"guarantee-item"},[C(s,{title:a.title,content:a.desc,border:!1,size:"small"},null,8,["title","content"]),S(c("div",J,null,512),[[N,a.tips]])])))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-72bcb63c"]]);export{M as default};
