var ie=Object.defineProperty,ce=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var G=(_,e,B)=>e in _?ie(_,e,{enumerable:!0,configurable:!0,writable:!0,value:B}):_[e]=B,W=(_,e)=>{for(var B in e||(e={}))de.call(e,B)&&G(_,B,e[B]);if(z)for(var B of z(e))_e.call(e,B)&&G(_,B,e[B]);return _},J=(_,e)=>ce(_,le(e));import{g as ue,a5 as Be,r as H,j as f,n as D,z as t,A as h,p as v,a6 as Ee,Q as fe,aj as ve,E as L,d as De,h as Ce,k as Fe,m as C,J as F,L as K,t as R,G as P,F as $,a1 as pe,a2 as he,C as m,T as O,D as Ae}from"./vendor-d0978379.js";import{_ as te,S as ge,D as me,p as X,l as T,E as Z,N as k,P as ye}from"./index-bc5549a9.js";import{g as Ie,f as Ne,s as ee,a as Re}from"./verify-3f0caf4d.js";import{n as Oe,a as Te}from"./index-b6d09695.js";var ke="/static/assets/sidenav.5031dada.png";const Se={class:"com-navigator"},be=["src"],xe=ue({setup(_){const[e,B]=Be(!1),S=()=>{B(!0)};return(b,p)=>{const x=H("van-popup");return f(),D("div",Se,[t("img",{class:"btn",src:h(ke),onClick:S},null,8,be),v(x,{show:h(e),"onUpdate:show":p[0]||(p[0]=w=>Ee(e)?e.value=w:null),position:"right",style:{width:"50%",height:"100%"},"safe-area-inset-top":""},null,8,["show"])])}}});var we=te(xe,[["__scopeId","data-v-48192b24"]]);const se=_=>(pe("data-v-2a32352c"),_=_(),he(),_),Ue={class:"page-verify"},Le={class:"people"},Pe={class:"name"},$e={class:"verify-item"},He=se(()=>t("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),je={class:"no"},Me=m(" \u53BB\u8BA4\u8BC1 "),Ve={class:"sign-body"},Ye={class:"date"},qe={class:"file"},Qe=m(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A"),ze={key:0,class:"dun-hao"},Ge={class:"people"},We={class:"name"},Je={class:"verify-item"},Ke=se(()=>t("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),Xe={class:"no"},Ze=["onClick"],eu=m(" \u53BB\u8BA4\u8BC1 "),uu=["onClick"],tu={class:"sign-body"},su={class:"date"},au={class:"file"},ou=m(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A"),nu={key:0,class:"dun-hao"},ru={class:"footer-button footer"},iu=m("\u63D0\u4EA4"),cu=ue({setup(_){const e={CERT:1,NO_CERT:2},B=fe(),S=ve(),{saleUserId:b="D1234567-1",tenantId:p="9991000007",templateId:x=1,productCode:w="CQ75CQ76",insurerCode:lu="ancheng"}=B.query;let{orderNo:A}=B.query;typeof A=="object"&&(A=(A||[])[0]);const U=new ge({source:"localStorage"}),N=L([]),c=L(),y=L(),g=[],j=De().format("YYYY-MM-DD"),ae=()=>{var s;(s=y.value)==null||s.clear()},oe=s=>{g[s].clear()},M=(s,n)=>{Re({callbackUrl:window.location.href,certiNo:s,faceAuthMode:"TENCENT",userName:n,tenantId:9991000007}).then(l=>{const{code:i,data:r}=l;if(i==="10000"){const{originalUrl:u,serialNo:a}=r;window.location.href=u,U.set("verifyData",{serialNo:a,certNo:s,name:n})}})},V=s=>{var n,l,i,r;s===-1?M((n=c.value.tenantOrderHolder)==null?void 0:n.certNo,(l=c.value.tenantOrderHolder)==null?void 0:l.name):M((i=c.value.tenantOrderInsuredList[s])==null?void 0:i.certNo,(r=c.value.tenantOrderInsuredList[s])==null?void 0:r.name)},ne=s=>{s&&g.every(n=>n!==s)&&g.push(s)},re=()=>{var n,l,i,r;if((n=y.value)==null?void 0:n.isEmpty()){O.fail("\u8BF7\u6295\u4FDD\u4EBA\u7B7E\u540D");return}if(g.some(u=>u.isEmpty())){O.fail("\u8BF7\u88AB\u4FDD\u4EBA\u7B7E\u540D");return}if(((i=(l=c.value.tenantOrderHolder)==null?void 0:l.extInfo)==null?void 0:i.isCert)!==e.CERT){O.fail("\u8BF7\u6295\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}if((r=c.value.tenantOrderInsuredList)==null?void 0:r.some(u=>{var a;return((a=u.extInfo)==null?void 0:a.isCert)!==e.CERT})){O.fail("\u8BF7\u88AB\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}Ae.confirm({title:"\u63D0\u793A",message:"\u8BF7\u786E\u8BA4\u4FE1\u606F\u586B\u5199\u65E0\u8BEF\u540E\uFF0C\u518D\u8FDB\u884C\u652F\u4ED8"}).then(()=>{var a,o;const u=(a=y.value)==null?void 0:a.save();Promise.all([ee("HOLDER",u,(o=c.value)==null?void 0:o.id,`${p}`),...g.map(d=>{var E;return ee("INSURED",d.save(),(E=c.value)==null?void 0:E.id,`${p}`)})]).then(()=>{Oe(J(W({},c.value),{pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:{pageCode:"sign",templateId:x},venderCode:"ancheng"})).then(d=>{const{code:E,data:I}=d;E==="10000"&&I.success&&S.push({path:ye[I.pageAction.data.nextPageCode],query:{orderNo:A,saleUserId:b,tenantId:p}})})})})},Y=()=>{Te({orderNo:A,saleUserId:b,tenantId:p}).then(s=>{const{code:n,data:l}=s;n==="10000"&&(c.value=l,setTimeout(()=>{let i=0;l.tenantOrderAttachmentList.forEach(r=>{r.category===21&&(r.objectType===2?(y.value.clear(),y.value.setDataURL(r.fileBase64)):r.objectType===1&&(g[i].clear(),g[i].setDataURL(r.fileBase64),i+=1))})}))})};return Ce(()=>{Y(),Ie({orderNo:A,productCode:w,tenantId:p}).then(n=>{const{code:l,data:i}=n;l==="10000"&&(N.value=i||[])});const s=U.get("verifyData");if(s){const{serialNo:n,certNo:l,name:i}=s;Ne({certiNo:l,orderNo:A,serialNo:n,tenantId:p,userName:i}).then(r=>{const{code:u,data:a}=r;u==="10000"&&(U.remove("verifyData"),Y())})}}),(s,n)=>{const l=H("van-button"),i=H("ProPageWrap");return f(),Fe(i,null,{default:C(()=>{var r;return[t("div",Ue,[v(me,{type:"warning",title:"\u5C0A\u656C\u7684\u5BA2\u6237\uFF0C\u672C\u6B21\u6295\u4FDD\u9700\u8981\u8FDB\u884C\u8EAB\u4EFD\u8BA4\u8BC1",content:"\u672C\u4EA7\u54C1\u6295\u4FDD\u9700\u8981\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\uFF0C\u60A8\u8D2D\u4E70\u672C\u4EA7\u54C1\u7684\u7D2F\u8BA1\u603B\u4FDD\u8D39\u5DF2\u8D85\u8FC720\u4E07\uFF0C\u6309\u76D1\u7BA1\u8981\u6C42\uFF0C\u9700\u8981\u63D0\u4F9B\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u3001\u6307\u5B9A\u53D7\u76CA\u4EBA\u8BC1\u4EF6\u5F71\u50CF\uFF0C\u672C\u4EA7\u54C1\u975E\u672C\u4EBA\u6295\u4FDD\u4E14\u5E26\u8EAB\u6545\u8D23\u4EFB\u3001\u9700\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\uFF08\u6210\u4EBA\uFF09\u7684\u6295\u4FDD\u610F\u613F\u8FDB\u884C\u7B7E\u5B57\u786E\u8BA4\u3002"}),v(T,{title:"\u6295\u4FDD\u4EBA",class:"card"},{extra:C(()=>{var u,a,o,d,E,I,q,Q;return[t("div",Le,[t("div",Pe,F((a=(u=c.value)==null?void 0:u.tenantOrderHolder)==null?void 0:a.name),1),t("div",{class:K(["status",{verified:((E=(d=(o=c.value)==null?void 0:o.tenantOrderHolder)==null?void 0:d.extInfo)==null?void 0:E.isCert)===e.CERT}])},F(((Q=(q=(I=c.value)==null?void 0:I.tenantOrderHolder)==null?void 0:q.extInfo)==null?void 0:Q.isCert)===e.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:C(()=>{var u,a,o,d,E;return[t("div",$e,[He,t("div",je,F((a=(u=c.value)==null?void 0:u.tenantOrderHolder)==null?void 0:a.certNo),1),((E=(d=(o=c.value)==null?void 0:o.tenantOrderHolder)==null?void 0:d.extInfo)==null?void 0:E.isCert)!==e.CERT?(f(),D("div",{key:0,class:"action",onClick:n[0]||(n[0]=I=>V(-1))},[Me,v(X,{name:"right_arrow",class:"icon"})])):R("",!0)])]}),_:1}),v(T,{title:"\u6295\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:C(()=>[t("div",{class:"resign",onClick:ae},"\u91CD\u7B7E")]),default:C(()=>[v(Z,{ref_key:"holderSign",ref:y,class:"sign"},null,512),t("div",Ve,[t("div",Ye,"\u7B7E\u540D\u65E5\u671F\uFF1A "+F(h(j)),1),t("div",qe,[Qe,(f(!0),D($,null,P(N.value.filter(u=>u.noticeObject===h(k).HOLDER),(u,a)=>(f(),D("span",{key:a,class:"file-name"},[m(F(`\u300A${u.materialName}\u300B`),1),a!==N.value.filter(o=>o.noticeObject===h(k).HOLDER).length-1?(f(),D("span",ze,"\u3001")):R("",!0)]))),128))])])]),_:1}),(f(!0),D($,null,P((r=c.value)==null?void 0:r.tenantOrderInsuredList,(u,a)=>(f(),D("div",{key:a},[v(T,{title:"\u88AB\u4FDD\u4EBA",class:"card"},{extra:C(()=>{var o,d;return[t("div",Ge,[t("div",We,F(u.name),1),t("div",{class:K(["status",{verified:((o=u.extInfo)==null?void 0:o.isCert)===e.CERT}])},F(((d=u.extInfo)==null?void 0:d.isCert)===e.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:C(()=>{var o;return[t("div",Je,[Ke,t("div",Xe,F(u.certNo),1),((o=u.extInfo)==null?void 0:o.isCert)!==e.CERT?(f(),D("div",{key:0,class:"action",onClick:d=>V(a)},[eu,v(X,{name:"right_arrow",class:"icon"})],8,Ze)):R("",!0)])]}),_:2},1024),v(T,{title:"\u88AB\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:C(()=>[t("div",{class:"resign",onClick:o=>oe(a)},"\u91CD\u7B7E",8,uu)]),default:C(()=>[v(Z,{ref_for:!0,ref:ne,class:"sign"}),t("div",tu,[t("div",su,"\u7B7E\u540D\u65E5\u671F\uFF1A "+F(h(j)),1),t("div",au,[ou,(f(!0),D($,null,P(N.value.filter(o=>o.noticeObject===h(k).INSURED),(o,d)=>(f(),D("span",{key:d,class:"file-name"},[m(F(`\u300A${o.materialName}\u300B`),1),d!==N.value.filter(E=>E.noticeObject===h(k).INSURED).length-1?(f(),D("span",nu,"\u3001")):R("",!0)]))),128))])])]),_:2},1024)]))),128)),t("div",ru,[v(l,{type:"primary",class:"submit-btn",onClick:re},{default:C(()=>[iu]),_:1})])]),v(we)]}),_:1})}}});var vu=te(cu,[["__scopeId","data-v-2a32352c"]]);export{vu as default};
