var Q=Object.defineProperty,z=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var L=(u,t,s)=>t in u?Q(u,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[t]=s,_=(u,t)=>{for(var s in t||(t={}))W.call(t,s)&&L(u,s,t[s]);if(b)for(var s of b(t))X.call(t,s)&&L(u,s,t[s]);return u},N=(u,t)=>z(u,J(t));import{h as K,aa as Z,P as ee,G as m,d as te,N as se,j as oe,r as E,k as f,m as k,n as d,s as v,p as U,H as q,M as ne,B as x,F as I,A as C,L as ue,E as P,T as F}from"./vendor-b1b61443.js";import{_ as ie,a as O,E as ae,g as le,A as ce,t as re,n as pe,N as _e,b as Ee}from"./index-92f7e5a0.js";import{l as fe,g as de}from"./inform-23ec91fd.js";import{s as ve}from"./useStorage-dafe4167.js";import{s as Ce}from"./verify-64b1dbb0.js";import{d as Te,A as ge,e as Be}from"./notice-8f6df5db.js";const me={class:"date"},ye={class:"inform-file"},he={class:"tips"},De=P(" \u60A8\u7684\u7B7E\u540D\u5C06\u88AB\u7528\u4E8E"),Ae=P("\u6587\u4EF6 "),Ne={class:"footer-button"},ke=P("\u4E0B\u4E00\u6B65"),xe=K({setup(u){const t=Z(),s=ee(),{productCode:Fe="MMBBSF",agentCode:R="65434444",tenantId:T="9991000007",agencyCode:Pe="3311222",insurerCode:y="zhongan",productCategory:S=1,templateId:Y=1,orderNo:h="2022080217103534947"}=s.query,p=m(null),D=m(!1),G=te().format("YYYY-MM-DD"),g=m(""),A=m(),j=()=>{var o;(o=p.value)==null||o.clear()},i=se({noticeType:"",materialSource:"",noticeList:[],pageData:{}}),V=()=>{le({orderNo:h,saleUserId:R,tenantId:T}).then(({code:o,data:n})=>{o==="10000"&&(Object.assign(i.pageData,n),n.tenantOrderAttachmentList.forEach(a=>{a.category===ce.ELECTRIC_SIGN&&a.objectType===re.AGENT&&p.value.setDataURL(a.fileBase64)}))})},w=o=>{const{id:n,objectType:a}=o,r={1:"pdf",2:"richText",3:"link"};de({insurerCode:y,id:n,objectType:a,productCategory:S,orderNo:h,tenantId:T}).then(({code:c,data:e})=>{c==="10000"&&((e==null?void 0:e[0].questionType)===Te?(g.value="question",A.value=e):((e==null?void 0:e[0].textType)===1&&(e==null?void 0:e[0].content.includes("png"))?g.value="picture":g.value=r[e==null?void 0:e[0].textType],A.value=e==null?void 0:e[0].content))})};oe(()=>{V(),fe({insurerCode:y,orderNo:h,productCategory:S,tenantId:T,noticeType:ge,objectType:Be}).then(({code:o,data:n})=>{o==="10000"&&(i.noticeList=[...i.noticeList,...n])})});const $=o=>{ve.set("questionData",o),t.push({path:"/healthNotice",query:_({questionnaireType:o.questionnaireType},s.query)})},H=()=>{var a,r;if(!(i.noticeList&&i.noticeList.every(c=>c.isDone===1))){F("\u8BF7\u5B8C\u6210\u6240\u6709\u544A\u77E5\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if((a=p.value)==null?void 0:a.isEmpty()){F("\u8BF7\u5B8C\u6210\u4EE3\u7406\u4EBA\u7B7E\u5B57\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if(!D.value){F("\u8BF7\u52FE\u9009\u540C\u610F\u7B7E\u540D");return}const n=(r=p.value)==null?void 0:r.save();Ce("AGENT",n,i.pageData.id,T).then(c=>{c&&pe(N(_({},i.pageData),{extInfo:N(_({},i.pageData.extInfo),{templateId:Y,pageCode:"salesNotice",buttonCode:_e.salesNotice}),venderCode:y})).then(({code:e,data:B})=>{e==="10000"&&B.pageAction.pageAction==="jumpToPage"&&t.push({path:Ee[B.pageAction.data.nextPageCode],query:_({},s.query)})})})};return(o,n)=>{const a=E("van-cell"),r=E("ProSign"),c=E("van-checkbox"),e=E("van-button"),B=E("ProPageWrap");return f(),k(B,{class:"page-salesman-inform"},{default:d(()=>[v(O,{title:"\u8425\u9500\u5458\u544A\u77E5\u4E66"},{default:d(()=>[(f(!0),U(I,null,q(x(i).noticeList,l=>(f(),k(a,{key:l.id,class:ne({"is-active":l.isDone===2}),title:`\u300A${l.title}\u300B`,"is-link":"",value:`${l.isDone===1?"\u5DF2\u5B8C\u6210":"\u53BB\u5B8C\u6210"}`,onClick:M=>$(l)},null,8,["class","title","value","onClick"]))),128))]),_:1}),v(O,{title:"\u8425\u9500\u5458\u7B7E\u5B57","show-divider":!1,"show-line":!1},{extra:d(()=>[C("div",{class:"resign",onClick:j},"\u91CD\u7B7E")]),default:d(()=>[v(r,{ref_key:"agentSignRef",ref:p,selector:"sign2"},null,512),C("div",me,"\u7B7E\u540D\u65E5\u671F\uFF1A "+ue(x(G)),1)]),_:1}),C("div",ye,[v(c,{modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=l=>D.value=l),shape:"square"},null,8,["modelValue"]),C("p",he,[De,(f(!0),U(I,null,q(x(i).noticeList,(l,M)=>(f(),k(ae,{key:M,class:"file",title:`\u300A${l.title}\u300B`,content:A.value,type:g.value,onClick:Se=>w(l)},null,8,["title","content","type","onClick"]))),128)),Ae])]),C("div",Ne,[v(e,{type:"primary",block:"",onClick:H},{default:d(()=>[ke]),_:1})])]),_:1})}}});var Re=ie(xe,[["__scopeId","data-v-1d1c7e90"]]);export{Re as default};
