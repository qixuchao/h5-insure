import{d as e,S as a,E as t,c as n,h as l,f as o,w as r,F as s,i,g as d,e as c,n as u,t as p,V as v,L as m,k as f,j as h,m as g,ap as y,au as A,a as I,r as b,bY as O,bZ as x,b_ as k,u as C,J as L,an as T,b6 as _,a9 as w,aE as E,H as P,ah as R,G as S,bR as j,a7 as D,T as N,aj as H,c0 as V,c7 as B,bT as F,c1 as U}from"./index-b8ef7d55.js";import{i as q,b as M,p as G,g as z}from"./trial-d5b83a74.js";import{b as Q,c as J}from"./product-bdbda2d2.js";import{n as W}from"./nextStep-ccd52280.js";import{g as Y,I as Z,O as $,l as K,S as X}from"./infoCollection-762a20da.js";import{u as ee}from"./useAddressList-0f36f9b8.js";import{r as ae,v as te,g as ne,t as le}from"./utils-7c528e3d.js";import{_ as oe}from"./index-22e2ec49.js";import{u as re,G as se,_ as ie}from"./useAttachment-3557026a.js";import{P as de}from"./index-595fbdda.js";import{s as ce,c as ue}from"./phoneVerify-4ebddd09.js";import{_ as pe}from"./TrialButton-f9612124.js";import{c as ve,t as me,_ as fe}from"./index-58321d46.js";import"./trial-8213e5ec.js";import"./pdfh5-008ca364.js";import"./core-b5348c72.js";import"./constant-c3f28a3b.js";import"./index-2500e426.js";import"./isObjectLike-f858f31d.js";import"./_nodeUtil-ef4cea77.js";const he={class:"refueling-package-com"},ge=h("div",{class:"title"},"åŠ æ²¹åŒ…",-1),ye=e({__name:"index",props:{packageProductList:{type:Array,default:()=>[]},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:3}},setup(e){const h=e,[I,b]=a(!1),O=t((()=>h.packageProductList.length>h.count&&(!!h.isShowClose||!I.value))),x=()=>{b()},k=t((()=>h.packageProductList.length<=h.count||I.value?h.packageProductList:h.packageProductList.slice(0,h.count)));return(e,a)=>{const t=g,h=y,b=A;return n(),l("div",he,[ge,o(b,{ref:"formRef"},{default:r((()=>[(n(!0),l(s,null,i(d(k),((e,a)=>(n(),c(h,{key:`${e.value}_${a}`,modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,label:e.packageName,required:"",placeholder:"è¯·é€‰æ‹©"},{input:r((()=>[o(t,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:d(Y),disabled:e.disabled},null,8,["modelValue","onUpdate:modelValue","options","disabled"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"])))),128)),d(O)?(n(),l("div",{key:0,class:"show-more",onClick:x},[u(p(d(I)?"æ”¶èµ·":"æŸ¥çœ‹æ›´å¤š")+" ",1),o(v,{name:"down",class:m(["icon",{showMore:d(I)}])},null,8,["class"])])):f("",!0)])),_:1},512)])}}});const Ae={key:0},Ie=[h("div",{class:"__skeleton_short_content__"},[h("div",{class:"van-config-provider sk",style:{"--van-primary-color":"#0d6efe","--van-primary-color-light8":"#0d6efe80","--van-primary-color-light1":"#0d6efe10","--van-primary-color-light2":"#0d6efe20","--van-danger-color":"#FF3C10","--van-primary-background-color":"#0d6efe20","--van-button-primary-background-color":"#0d6efe","--van-button-primary-border-color":"#0d6efe","--van-checkbox-checked-bg-color":"#0d6efe10","--van-switch-on-background-color":"#0d6efe","--van-toast-default-padding":"14px","--van-linear-bg":"linear-gradient(to right, #0d6efe, rgba(13,150,254,1))","--van-popup-close-icon-margin":"20px","--van-popup-round-border-radius":"20px","--van-card-title":"#0d6efe","--van-card-cell-color":"#0d6efe80","--van-radio-checked-icon-color":"#0d6efe","--van-pro-check-radius":"40px"}},[h("div",{class:"page-internet-product-detail"},[h("div",{class:"info"},[h("div",{class:"van-image banner",style:{width:"100%",height:"223px"},src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},[h("img",{class:"van-image__img","data-src":"https://zatech-aquarius-v2-private-test.oss-cn-hangzhou.aliyuncs.com/common/20221222/e3719801cf6546449e18e06f3bbe8416/%E5%B0%8A%E4%BA%ABe%E7%94%9F.png?Expires=1676527379&OSSAccessKeyId=LTAI5t9uBW78vZ4sm5i3oQ5C&Signature=tkscLe6oOZYjnRIA%2B7AiMS3bOs0%3D",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",lazy:"loaded",style:{background:"rgb(238, 238, 238)"}})]),h("div")]),h("div",{class:"guarantee-list"},[h("div",{class:"header"},[h("span",null,[h("span",{class:"sk-text",style:{"--fp":"14.86%","--sp":"85.14%","--lh":"18.4999px"}},"ä¿éšœè®¡åˆ’")]),h("span",null,[h("span",{class:"sk-text",style:{"--fp":"14.86%","--sp":"85.14%","--lh":"18.4999px"}},"æŸ¥çœ‹è¯¦æƒ…")])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"ä¸€èˆ¬åŒ»ç–—ä¿é™©é‡‘")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜300ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"é‡å¤§ç–¾ç—…åŒ»ç–—ä¿é™©é‡‘")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜600ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æ¶æ€§è‚¿ç˜¤è´¨å­é‡ç¦»å­åŒ»ç–—")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜600ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æ¶æ€§è‚¿ç˜¤é™¢å¤–ç‰¹å®šè¯å“è´¹ç”¨åŒ»ç–—")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜600ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æ¶æ€§è‚¿ç˜¤ç‰¹å®šå™¨æ¢°è€—æè´¹ç”¨åŒ»ç–—è´£ä»» ï¼ˆé€‚ç”¨äºå¥³æ€§è¢«ä¿é™©äººï¼‰")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜100ä¸‡")])])]),h("div",{class:"show-more"},[h("span",{class:"sk-text",style:{"--fp":"14.29%","--sp":"85.71%","--lh":"16.799999999999997px"}},"æŸ¥çœ‹æ›´å¤š "),h("svg",{class:"svg-icon icon-arrow-down-dobule icon icon"},[h("use",{"xlink:href":"#icon-arrow-down-dobule"})])]),h("div",{class:"feerate-view sk-border"},[h("span",null,[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"142.00å…ƒ/å¹´èµ·")])])]),h("div",{class:"com-divider"}),h("div",{class:"tabs",sticky:"",scrollspy:""},[h("div",null,[h("div",{class:"van-sticky"},[h("div",{class:"van-tabs"},[h("div",{id:"tab-list",class:"tab-list"},[h("a",{class:"tab-title active",title:"äº§å“äº®ç‚¹"},[h("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"äº§å“äº®ç‚¹")]),h("a",{class:"tab-title",title:"ç†èµ”è¯´æ˜"},[h("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"ç†èµ”è¯´æ˜")]),h("a",{class:"tab-title",title:"æˆ‘è¦æŠ•ä¿"},[h("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"æˆ‘è¦æŠ•ä¿")])])])])]),h("div",{class:"tab-content"},[h("div",{id:"tab1"},[h("div",{class:"spec"},[h("div",{class:"van-image detail-img",style:{width:"100%"}},[h("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",class:"van-image__img",style:{background:"rgb(238, 238, 238)"}})])])])])])])])],-1)],be={class:"page-internet-product-detail"},Oe={class:"info"},xe={class:"custom-page-form"},ke=h("div",{class:"form-title"},"è¯·å¡«å†™æŠ•ä¿ä¿¡æ¯",-1),Ce=h("div",{id:"xinaoDialog"},null,-1),Le=e({__name:"short",setup(e){const a=O((()=>x((()=>import("./index-324dd9b8.js")),["static/js/index-324dd9b8.js","static/css/index-ea588f10.css","static/js/index-b8ef7d55.js","static/css/index-01a5659c.css","static/js/pdfh5-008ca364.js","static/js/theme-65292714.js","static/js/index-2500e426.js","static/css/index-19d9cc6b.css","static/js/utils-7c528e3d.js","static/js/infoCollection-762a20da.js","static/js/trial-8213e5ec.js"]))),p=O((()=>x((()=>import("./index-90885e5d.js")),["static/js/index-90885e5d.js","static/css/index-c743ae40.css","static/js/index-b8ef7d55.js","static/css/index-01a5659c.css","static/js/pdfh5-008ca364.js","static/js/theme-65292714.js"]))),v=O((()=>x((()=>import("./index-763fdc53.js")),["static/js/index-763fdc53.js","static/css/index-4a892f9c.css","static/js/index-b8ef7d55.js","static/css/index-01a5659c.css","static/js/pdfh5-008ca364.js","static/js/infoCollection-762a20da.js","static/js/trial-8213e5ec.js"]))),m=O((()=>x((()=>import("./index-1f39eb73.js")),["static/js/index-1f39eb73.js","static/css/index-b1275e60.css","static/js/index-b8ef7d55.js","static/css/index-01a5659c.css","static/js/pdfh5-008ca364.js"]))),g=O((()=>x((()=>import("./index-409528c0.js")),["static/js/index-409528c0.js","static/css/index-b9ba3011.css","static/js/index-b8ef7d55.js","static/css/index-01a5659c.css","static/js/pdfh5-008ca364.js"]))),y=k();C();const A=I(),{productCode:Y="",tenantId:he,agentCode:ge="",agencyCode:Le,saleChannelId:Te,extraInfo:_e,insurerCode:we,preview:Ee}=A.query;let Pe={};try{console.log("extInfo",decodeURIComponent(_e)),Pe=JSON.parse(decodeURIComponent(_e))}catch(_a){}const{openId:Re}=Pe;b();const Se=b(),je=b(),De=b(!1),Ne=b({}),He=b({}),Ve=b(!1),Be=b(!1),Fe=b(0),Ue=b(!1),qe=b({}),Me=b({}),Ge=b(!0),ze=b(!0),Qe=b(!0),Je=b(""),We=b([]);b({});const Ye=b({}),Ze=b({}),$e=b([]),Ke=b(),Xe=b(),ea=L({holder:{formData:{},schema:[],trialFactorCodes:[],config:{name:{},verificationCode:{sendSMSCode:async({mobile:e},a)=>{const t=await ce(e),{code:n}=t;"10000"===n&&"function"==typeof a&&a()}},certType:{},certNo:{},occupation:{dictCode:ve(we)}}},insuredList:[{formData:{},schema:[],trialFactorCodes:[],config:{relationToHolder:{label:""},certNo:{}}}]});Re&&ee({openId:Re},(e=>{Me.value=e}));const aa=b({imgUrl:"",desc:"",title:"",link:window.location.href}),ta=(e=>{const{tenantId:a,agentCode:t="",agencyCode:n,saleChannelId:l,extraInfo:o,insurerCode:r}=I().query;let s={};try{s=JSON.parse(decodeURIComponent(o))}catch(_a){}const i=b({agencyId:n,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"",pageCode:"",iseeBizNo:"",extraInfo:{}},orderCategory:1,saleUserId:t,saleChannelId:l,tenantId:a,venderCode:r,tenantOrderHolder:{extInfo:{occupationCodeList:[]}},tenantOrderInsuredList:[{relationToHolder:"1",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{extInfo:{}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",subjectNo:"",tenantId:a}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}});return"[object Object]"==={}.toString.call(e)&&Object.assign(i.value,e),i})({extInfo:{buttonCode:"EVENT_SHORT_saveOrder",pageCode:"productInfo",extraInfo:Pe,templateId:(null==Pe?void 0:Pe.templateId)||"1",iseeBizNo:""}}),na=b({}),la=t((()=>!!Ee)),oa=b([]),ra=b(),sa=async()=>{Q({productCode:Y,tenantId:he,isTenant:!Ee}).then((({data:e,code:a})=>{if("10000"===a){Ne.value=e,document.title=e.BASIC_INFO.title||"";const{title:a,desc:n,image:l}=(null==e?void 0:e.PRODUCT_LIST.wxShareConfig)||{};t={title:a,desc:n,image:l},aa.value={desc:t.desc||"ä½ å¥½ï¼Œè¿™é‡Œæ˜¯æè¿°",imgUrl:t.image,title:t.title,link:window.location.href}}var t})),await q({productCode:Y,isTenant:!Ee}).then((({data:e,code:a})=>{var t;"10000"===a&&(Ue.value=!0,He.value=e,Ye.value=null==(t=e.productPlanInsureVOList)?void 0:t[0],$e.value=(e.productPlanInsureVOList||[]).filter((e=>e.planCode)).map((e=>({planName:e.planName,planCode:e.planCode}))))})),Qe.value=!1,J({productCode:Y}).then((({code:e,data:a})=>{var t,n,l,o;if("10000"===e){const{productMaterialPlanVOList:e,productQuestionnaireVOList:r}=a;ra.value=e||[];const{basicInfo:{questionnaireType:s},questions:i,questionnaireName:d}=(null==(t=null==r?void 0:r[0])?void 0:t.questionnaireDetailResponseVO)||{basicInfo:{}};2===s&&(oa.value=[{attachmentName:d,attachmentUri:i,attachmentType:"question"}]),oa.value=[{attachmentName:d,attachmentUri:null==(n=null==i?void 0:i[0])?void 0:n.content,attachmentType:ne(String(null==(l=null==i?void 0:i[0])?void 0:l.textType),null==(o=null==i?void 0:i[0])?void 0:o.content)}]}}))},ia=t((()=>{if(Me.value){const e=[];return Object.keys(Me.value).forEach((a=>{e.push(...Me.value[a])})),e}return[]})),da=t((()=>ia.value.length>0)),ca=b([]),ua=e=>{console.log("currentPlanObj.value",e,Ye.value)};T((()=>na.value.planCode),(e=>{Ye.value=(He.value.productPlanInsureVOList||[]).find((a=>a.planCode===e))}));const pa=()=>{Se.value.handleClickTab()("tab3")},va=b(""),ma=b(0),fa=async()=>{try{await W(((e={},a={},t={})=>{var n;const l={...t},o={tenantId:he,riskList:(null==(n=l.tenantOrderInsuredList[0])?void 0:n.tenantOrderProductList[0].riskVOList)||[],riskPremium:a,productId:e.id};return l.extInfo.iseeBizNo=Je.value,l.productCode=e.productCode,l.commencementTime=l.insuranceStartDate,l.expiryDate=l.insuranceEndDate,l.tenantOrderHolder={...l.tenantOrderHolder,certType:l.tenantOrderHolder.certType||R.CERT,certNo:(l.tenantOrderHolder.certNo||"").toLocaleUpperCase(),extInfo:{...l.tenantOrderHolder.extInfo}},l.tenantOrderInsuredList=l.tenantOrderInsuredList.map((e=>({...e,certType:e.certType||R.CERT,certNo:(e.certNo||"").toLocaleUpperCase(),planCode:Ye.value.planCode,extInfo:{...e.extInfo}}))),l.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:ma.value,productCode:e.productCode,productName:e.productName,planCode:Ye.value.planCode,tenantOrderRiskList:le(o)},l})(He.value,qe.value,ta.value),(async(e,a)=>{a===U.JUMP_PAGE&&(null==e?void 0:e.orderNo)&&await(async e=>{try{const{code:a,data:t}=await z({orderNo:e,tenantId:he});"10000"===a&&(t.extInfo={...t.extInfo,buttonCode:"EVENT_SHORT_underWrite"},await W(t))}catch(_a){}})(null==e?void 0:e.orderNo)}))}catch(_a){}},{fileList:ha,mustReadFileCount:ga,popupFileList:ya}=re(Ye,ra),Aa=e=>{Fe.value=e,Be.value=!0},Ia=async(e,a,t=!0)=>{var n;const{chargePeriod:l,coveragePeriod:o,paymentFrequency:r,insuranceEndDate:s,insuranceStartDate:i}=na.value;va.value="ä¿è´¹è¯•ç®—ä¸­...";const d=ae(a).map((e=>({...e,paymentFrequency:r,chargePeriod:l,coveragePeriod:o}))),{tenantOrderHolder:c,tenantOrderInsuredList:u}=ta.value,p={tenantId:he,productCode:e.productCode,insuranceStartDate:i,insuranceEndDate:s,holder:{personVO:{...c,socialFlag:null==(n=c.extInfo)?void 0:n.hasSocialInsurance,certType:c.certType||R.CERT}},insuredVOList:u.map((e=>({insuredCode:"",relationToHolder:e.relationToHolder,personVO:{...e,socialFlag:e.extInfo.hasSocialInsurance,certType:e.certType||R.CERT},productPlanVOList:[{insurerCode:we,planCode:Ye.value.planCode,riskVOList:d}]})))},{code:v,message:m}=await M(p);if("10000"===v){const{code:e,data:a}=await G(p);if("10000"===e){if(va.value="",ta.value.tenantOrderInsuredList[0].tenantOrderProductList=p.insuredVOList[0].productPlanVOList,ma.value=null==a?void 0:a.premium,ta.value.premium=a.premium,ta.value.orderAmount=a.premium,ta.value.orderRealAmount=a.premium,!t){const e={};a.riskPremiumDetailVOList&&a.riskPremiumDetailVOList.length&&a.riskPremiumDetailVOList.forEach((a=>{e[a.riskCode]={premium:a.premium,amount:a.amount}})),qe.value=e,ya.value.length>0?(Ge.value=!1,Aa(0)):oa.value.length>0?Ve.value=!0:await fa()}}else va.value=""}else va.value="",N(m)},ba=()=>{const e=[];return We.value.filter((e=>e.value===Z.INSURE)).forEach((a=>{e.push(...a.productRiskVoList)})),e},Oa=async()=>{var e,a;try{Ve.value=!1,Be.value=!1,Ke.value&&Xe.value&&Promise.all([null==(e=Ke.value)?void 0:e.validate(),null==(a=Xe.value)?void 0:a[0].validate()]).then((async()=>{var e;if(da.value)await Ia(He.value,[...ca.value,...ba()],!1);else{const a=null==(e=ta.value.tenantOrderHolder)?void 0:e.verificationCode;if(!te(a))return void N({message:"è¯·è¾“å…¥æ­£ç¡®çš„éªŒè¯ç "});const{code:t,data:n}=await ue(ta.value.tenantOrderHolder.mobile,a);"10000"===t&&await Ia(He.value,[...ca.value,...ba()],!1)}})).catch((()=>{const e=document.querySelector(".form-title");e&&e.scrollIntoView()}))}catch(t){}},xa=e=>{"allFalse"===e?(Ve.value=!1,fa()):H.confirm({className:"xinao-custom-dialog",title:"æç¤º",teleport:"#xinaoDialog",message:"è¢«ä¿äººä¸ç¬¦åˆå¥åº·è¦æ±‚ï¼Œå¾ˆæŠ±æ­‰æš‚æ—¶æ— æ³•æŠ•ä¿è¯¥äº§å“",confirmButtonText:"é€‰é”™äº†",cancelButtonText:"ä¸ºå…¶ä»–äººæŠ•ä¿"}).then((()=>{})).catch((()=>{Ve.value=!1}))},ka=()=>{Be.value=!1,Ge.value=!0,oa.value.length<1?fa():Ve.value=!0},Ca=()=>{Ve.value=!1,Be.value=!1,Ge.value=!0};T((()=>ta.value.tenantOrderInsuredList[0].relationToHolder),((e,a)=>{e!==a&&We.value&&We.value.forEach((e=>{e.value=Z.UN_INSURE})),ze.value=!1,_((()=>{const{certType:e,extInfo:a}=ta.value.tenantOrderInsuredList[0];a&&!a.hasSocialInsurance&&(ta.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance=X.HAS),ze.value=!0}))}),{deep:!0,immediate:!0}),T([()=>ea.holder.formData,()=>ea.insuredList],(([e,a])=>{Object.assign(ta.value,(({holder:e,insuredList:a=[]})=>{const t=["birthday","certEndDate","certEndType","certNo","certStartDate","verificationCode","certType","email","gender","mobile","name","id","insuredBeneficiaryType","relationToHolder","relationToMainInsured"],n=e=>{const a={extInfo:{}};return"[object Object]"==={}.toString.call(e)&&Object.keys(e).forEach((n=>{t.includes(n)?a[n]=e[n]:a.extInfo[n]=e[n]})),a};return{tenantOrderHolder:n(e),tenantOrderInsuredList:(a||[]).map((e=>n(e)))}})({holder:e,insuredList:a.map((e=>e.formData))}))}),{deep:!0});const La=(e,a)=>e.find((e=>!a[e])),Ta=async()=>{const{trialFactorCodes:e,formData:a}=ea.holder,{trialFactorCodes:t,formData:n}=ea.insuredList[0];return new Promise(((l,o)=>{!La(e,a)&&!La(t,n)&&Ke.value&&Xe.value?Promise.all([Ke.value.validate(e),Xe.value[0].validate(t)]).then((()=>{l(!0)})).catch((()=>{o()})):o()}))};return T((()=>[...ea.holder.trialFactorCodes.map((e=>ea.holder.formData[e])),...ea.insuredList.reduce(((e,a,t)=>(e.push(...a.trialFactorCodes.map((e=>ea.insuredList[t].formData[e]))),e)),[]),na.value.paymentFrequency,We.value]),((...e)=>{la.value||Ta().then((()=>{Ia(He.value,[...ca.value,...ba()])})).catch((()=>{Ta().then((()=>{va.value="ä¿è´¹è¯•ç®—ä¸­..."}))}))}),{deep:!0}),T((()=>ea.holder.formData),((...e)=>{ea.insuredList.forEach(((e,a)=>{const{formData:t,schema:n}=e||{};"1"===t.relationToHolder&&Object.assign(e.formData,ea.holder.formData)}))}),{deep:!0,immediate:!0}),T((()=>Ye.value),(()=>{let{productFactor:e}=Ye.value;const{oilPackageProductVOList:a,planCode:t,insureProductRiskVOList:n}=Ye.value;da.value&&e[1]&&(e=e[1].filter((e=>"verificationCode"!==e.code))),na.value.planCode=t,ca.value=n,Ze.value=(n||[]).find((e=>e.mainRiskFlag===w.YES)),console.log("mainRiskInfo.value",Ze.value),We.value=(a||[]).map((e=>({...e,value:Z.UN_INSURE})));const[l,o,r]=me(e);ea.holder={...ea.holder,...l},ea.insuredList[0]={...ea.insuredList[0],...o}}),{deep:!0,immediate:!0}),T((()=>ea.insuredList.map(((e,a)=>ea.insuredList[a].formData.relationToHolder))),((e,a)=>{console.log("%cğŸ”¥ ä¸æŠ•ä¿äººå…³ç³»å˜åŠ¨äº†","color:#1989fa;background:#5e4;padding:3px 5px;"),ea.insuredList.forEach(((e,a)=>{const{formData:t,schema:n,config:l}=e||{},o="1"===t.relationToHolder,r="3"===t.relationToHolder;l.certNo.label="èº«ä»½è¯å·"+(r?"(æˆ·å£ç°¿)":""),e.schema.forEach((e=>{e.relationToHolder=t.relationToHolder,e.hidden=!e.isSelfInsuredNeed&&o})),o?Object.assign(e.formData,{...ea.insuredList[a].formData,...ea.holder.formData}):Object.assign(e.formData,{...Object.keys(e.formData).reduce(((e,a)=>(e[a]="",e)),{}),relationToHolder:t.relationToHolder})}))}),{immediate:!0,deep:!0}),_((()=>{V(je,(([{isIntersecting:e}],a)=>{De.value=!e}))})),E((()=>{var e;const a=P.get($);if(a){const{tenantOrderHolder:t,tenantOrderInsuredList:n}=a;if(t&&(ta.value.tenantOrderHolder={...t,certType:t.certType||R.CERT}),Array(n)&&n[0]){const a=n[0]||{};if(ta.value.activePlanCode=a.planCode,a.tenantOrderProductListtenantOrderProductList&&a.tenantOrderProductList[0]&&a.tenantOrderProductList[0].tenantOrderRiskList){const t=null==(e=a.tenantOrderProductList[0].tenantOrderRiskList)?void 0:e.find((e=>"1"===String(e.riskType)));t&&(ta.value.paymentFrequency=(null==t?void 0:t.paymentFrequency)?String(null==t?void 0:t.paymentFrequency):K.SINGLE)}}}})),S((()=>{Qe.value=!0,sa(),setTimeout((async()=>{Je.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),j((()=>{P.remove($)})),(e,t)=>{const A=B,I=F;return n(),l(s,null,[d(Qe)?(n(),l("div",Ae,Ie)):(n(),c(I,{key:1,"data-skeleton-root":"SHORT","theme-vars":d(y)},{default:r((()=>{var e,a,p,y,I,b,O,x,k,C;return[h("div",be,[h("div",Oe,[(null==(a=null==(e=d(Ne))?void 0:e.BASIC_INFO)?void 0:a.banner.length)?(n(),c(oe,{key:0,"data-skeleton-type":"img",url:null==(p=d(Ne))?void 0:p.BASIC_INFO.banner[0]},null,8,["url"])):f("",!0),(null==(b=null==(I=null==(y=d(Ne))?void 0:y.BASIC_INFO)?void 0:I.bannerMove)?void 0:b.length)?(n(),c(oe,{key:1,url:null==(k=null==(x=null==(O=d(Ne))?void 0:O.BASIC_INFO)?void 0:x.bannerMove)?void 0:k[0],onClick:pa},null,8,["url"])):f("",!0),h("div",{ref_key:"observeRef",ref:je},null,512)]),(null==(C=d(Ne))?void 0:C.GUARANTEE)?(n(),c(se,{key:0,"show-service-config":"","data-source":d(Ne),"plan-list":d($e)},null,8,["data-source","plan-list"])):f("",!0),o(ie,{ref_key:"detailScrollRef",ref:Se,"order-detail":d(ta),"data-source":d(Ne)},{form:r((()=>[h("div",xe,[ke,o(d(fe),{ref_key:"holderFormRef",ref:Ke,title:"æœ¬äººä¿¡æ¯ï¼ˆæŠ•ä¿äººï¼‰",model:d(ea).holder.formData,schema:d(ea).holder.schema,config:d(ea).holder.config},null,8,["model","schema","config"]),(n(!0),l(s,null,i(d(ea).insuredList,((e,a)=>(n(),c(d(fe),{ref_for:!0,ref_key:"insuredFormRef",ref:Xe,key:a,title:"ä¸ºè°æŠ•ä¿ï¼ˆè¢«ä¿äººï¼‰",model:d(ea).insuredList[a].formData,schema:e.schema,config:e.config},null,8,["model","schema","config"])))),128))]),o(d(v),{"form-info":d(na),"risk-info":d(Ze),"tenant-product-detail":d(Ne).PREMIUM,"plan-list":d($e),"premium-info":{premium:d(ma),premiumLoadingText:d(va)},onUpdateActivePlan:ua},null,8,["form-info","risk-info","tenant-product-detail","plan-list","premium-info"]),d(We).length>0?(n(),c(ye,{key:0,"package-product-list":d(We)},null,8,["package-product-list"])):f("",!0)])),_:1},8,["order-detail","data-source"]),o(A,null,{default:r((()=>{var e,a,t;return[(null==(e=d(Ne).SIGNATURE)?void 0:e.inscribedContent)?(n(),c(d(m),{key:0,"inscribed-content":null==(t=null==(a=d(Ne))?void 0:a.SIGNATURE)?void 0:t.inscribedContent},null,8,["inscribed-content"])):f("",!0)]})),_:1}),o(A,null,{default:r((()=>{var e;return[(null==(e=d(ha))?void 0:e.length)?(n(),c(d(g),{key:0,"attachement-list":d(ha),"pre-text":"è¯·é˜…è¯»",onPreviewFile:t[0]||(t[0]=e=>Aa(e))},null,8,["attachement-list"])):f("",!0)]})),_:1}),d(De)?(n(),c(pe,{key:1,"is-share":d(Ne).PRODUCT_LIST.showWXShare,premium:d(ma),"share-info":d(aa),"loading-text":d(va),"plan-code":d(na).planCode,"payment-frequency":d(na).paymentFrequency,"tenant-product-detail":d(Ne),onClick:Oa},{default:r((()=>[u("ç«‹å³æŠ•ä¿")])),_:1},8,["is-share","premium","share-info","loading-text","plan-code","payment-frequency","tenant-product-detail"])):f("",!0)]),d(Ue)?(n(),c(de,{key:0,"product-detail":d(Ne)},null,8,["product-detail"])):f("",!0),Ce]})),_:1},8,["theme-vars"])),o(d(p),{show:d(Ve),"onUpdate:show":t[1]||(t[1]=e=>D(Ve)?Ve.value=e:null),"content-list":d(oa),"active-index":0,onOnConfirmHealth:xa,onOnCloseHealthByMask:Ca},null,8,["show","content-list"]),d(Be)?(n(),c(d(a),{key:2,show:d(Be),"onUpdate:show":t[2]||(t[2]=e=>D(Be)?Be.value=e:null),"content-list":d(Ge)?d(ha):d(ya),"is-only-view":d(Ge),"active-index":d(Fe),text:d(Ge)?"å…³é—­":"æˆ‘å·²é€é¡µé˜…è¯»å¹¶ç¡®è®¤å‘ŠçŸ¥å†…å®¹","force-read-cound":d(Ge)?0:d(ga),onSubmit:ka,onOnCloseFilePreviewByMask:Ca},null,8,["show","content-list","is-only-view","active-index","text","force-read-cound"])):f("",!0)],64)}}});export{Le as default};
