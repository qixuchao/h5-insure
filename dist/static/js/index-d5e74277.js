import{a as e,aS as t,h as a,b7 as o,_ as d,D as r,T as n,p as u,b8 as s,aI as l,u as i,b9 as c}from"./index-deb4ddfb.js";import{ref as V,computed as p,watch as m,onMounted as v}from"vue";/* empty css              */import{d as f,g as C}from"./order-d7f1976d.js";import"./pdfh5-e588f83d.js";const N=e=>(Vue.pushScopeId("data-v-7faf90ea"),e=e(),Vue.popScopeId(),e),g={class:"com-order-item"},I={class:"header"},y={class:"product-name"},h={class:"status"},b={class:"info"},k={class:"info-item"},E=N((()=>Vue.createElementVNode("div",{class:"label"},"投保人",-1))),S={class:"desc"},B={class:"info-item"},D=N((()=>Vue.createElementVNode("div",{class:"label"},"创建时间",-1))),x={class:"desc"},_={class:"footer"},T={class:"fee"},Y={class:"money"},w={key:0,class:"buttons"},U={key:1,class:"buttons"},M={key:2,class:"buttons"};var L=d(Vue.defineComponent({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(d,{emit:l}){const i=d,c=e(),V=()=>{r.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{f(i.detail.id,i.detail.orderStatus).then((e=>{const{code:t,data:a}=e;"10000"===t&&(n.success("删除成功"),l("afterDelete"))}))}))},p=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:d,templateId:r,tenantId:n,insurerCode:u,productCategory:l,agencyId:V,saleChannelId:p,orderTopStatus:m}=i.detail;if((o.PENDING===m||o.PAYING===m)&&[s.ZXYS,s.BWYL,s.BWYLUP].includes(e)){const a={[s.ZXYS]:"/internet/productDetail/package",[s.BWYL]:"/internet/productDetail",[s.BWYLUP]:"/internet/guaranteeUpgrade"};return c.push({path:a[e],query:{productCode:e,saleChannelId:p,agentCode:d,tenantId:n,agencyCode:V,orderNo:t}}),!0}return!1},m=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:d,tenantId:r,insurerCode:n,productCategory:u,agencyId:s}=i.detail;p()||c.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:o,templateId:d,tenantId:r,insurerCode:n,productCategory:u,agencyCode:s}})};return(e,r)=>{const n=Vue.resolveComponent("van-button");return Vue.openBlock(),Vue.createElementBlock("div",g,[Vue.createElementVNode("div",I,[Vue.createElementVNode("div",y,Vue.toDisplayString(d.detail.goodsName),1),Vue.createElementVNode("div",h,Vue.toDisplayString(Vue.unref(t)[d.detail.orderStatus]),1)]),Vue.createElementVNode("div",b,[Vue.createElementVNode("div",k,[E,Vue.createElementVNode("div",S,Vue.toDisplayString(d.detail.policyHolder),1)]),Vue.createElementVNode("div",B,[D,Vue.createElementVNode("div",x,Vue.toDisplayString(Vue.unref(a)(d.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss")),1)])]),Vue.createElementVNode("div",_,[Vue.createElementVNode("div",T,[Vue.createTextVNode(" 保费："),Vue.createElementVNode("span",Y,"￥"+Vue.toDisplayString(d.detail.prem),1)]),d.detail.orderTopStatus===Vue.unref(o).PENDING?(Vue.openBlock(),Vue.createElementBlock("div",w,[Vue.createVNode(n,{class:"button",onClick:Vue.withModifiers(V,["stop"])},{default:Vue.withCtx((()=>[Vue.createTextVNode("删除")])),_:1},8,["onClick"]),Vue.createVNode(n,{class:"button primary",onClick:r[0]||(r[0]=Vue.withModifiers((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:d,tenantId:r,insurerCode:n,productCategory:s,agencyId:l,saleChannelId:c,orderStatus:V,abbreviation:m}=i.detail;p()||u("orderDetail",{orderNo:t,agentCode:o,tenantId:r,abbreviation:m,productCategory:s})})()),["stop"]))},{default:Vue.withCtx((()=>[Vue.createTextVNode("去处理")])),_:1})])):Vue.createCommentVNode("",!0),d.detail.orderTopStatus===Vue.unref(o).PAYING?(Vue.openBlock(),Vue.createElementBlock("div",U,[Vue.createVNode(n,{class:"button primary",onClick:Vue.withModifiers(m,["stop"])},{default:Vue.withCtx((()=>[Vue.createTextVNode("去支付")])),_:1},8,["onClick"])])):Vue.createCommentVNode("",!0),d.detail.orderTopStatus===Vue.unref(o).TIMEOUT?(Vue.openBlock(),Vue.createElementBlock("div",M,[Vue.createVNode(n,{class:"button",onClick:Vue.withModifiers(V,["stop"])},{default:Vue.withCtx((()=>[Vue.createTextVNode("删除")])),_:1},8,["onClick"])])):Vue.createCommentVNode("",!0)])])}}}),[["__scopeId","data-v-7faf90ea"]]);const P={class:"page-order"};var j=d(Vue.defineComponent({__name:"index",setup(t){const a=l();e();const o=i().query,d=V({"-1":1,0:2,1:3,2:4}[o.type]||0),r=V(1),s=V(!1),f=V(!1),N=V([]),g=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],I=p((()=>(N.value=[],g[d.value].status))),y=()=>{n.loading({message:"加载中...",forbidClick:!0}),s.value=!0,C({condition:{orderTopStatus:I.value},pageSize:10,pageNum:r.value}).then((e=>{s.value=!1;const{code:t,data:a}=e;"10000"===t&&a&&(1===r.value?N.value=a.datas||[]:N.value=[...N.value,...a.datas||[]]),f.value=!a||N.value.length>=(null==a?void 0:a.total)})).then((()=>{n.clear()}))},h=()=>{r.value+=1,y()},b=()=>{r.value=1,y()};return m(I,(()=>{r.value=1,y()})),v((()=>{y()})),(e,t)=>{const o=Vue.resolveComponent("van-list"),r=Vue.resolveComponent("van-config-provider");return Vue.openBlock(),Vue.createBlock(r,{"theme-vars":Vue.unref(a)},{default:Vue.withCtx((()=>[Vue.createElementVNode("div",P,[Vue.createVNode(c,{active:Vue.unref(d),"onUpdate:active":t[0]||(t[0]=e=>Vue.isRef(d)?d.value=e:null),list:g,class:"tab"},null,8,["active"]),Vue.createVNode(o,{class:"body",loading:Vue.unref(s),finished:Vue.unref(f),onLoad:h},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(N),((e,t)=>(Vue.openBlock(),Vue.createBlock(L,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,tenantId:o,abbreviation:d,productCategory:r}=e;u("orderDetail",{orderNo:t,agentCode:a,tenantId:o,abbreviation:d,productCategory:r})})(e),onAfterDelete:b},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-42effda0"]]);export{j as default};
