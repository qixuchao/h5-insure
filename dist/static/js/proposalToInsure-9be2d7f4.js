import{d as a,ay as e,az as s,i as t,h as o,j as r,l as i,o as d,c as n,b as l,w as u,u as c,y as p,aA as m}from"./index-b49e6838.js";import{q as I,s as f}from"./trial-e270b96a.js";import{u as v}from"./useOrder-44e5852d.js";import{q as j}from"./createProposal-111a9323.js";import"./utils-76320647.js";import"./trial-316e3310.js";import"./PolicyInfo-3a76c20d.js";const y=a({name:"proposalToInsure"}),w=a({...y,setup(a){const y=e((()=>s((()=>import("./index-eaeaa2d0.js")),["static/js/index-eaeaa2d0.js","static/css/index-3515e551.css","static/js/index-b49e6838.js","static/css/index-efad381f.css","static/js/product-bc5145be.js","static/js/useThread-637a02aa.js"]))),w=t(),L=o(),h=v(),q=r(),{proposalId:_,productCode:b,tenantId:g,proposalInsuredId:x}=w.query,C=r(),z=async()=>{_&&j({id:_,tenantId:g}).then((({code:a,data:e})=>{if("10000"===a){const{holder:a,insuredList:s}=e,t=(b||"").split(",");Object.assign(h.value,{renewFlag:"",holder:a,tenantId:g,proposalId:_,insuredList:(s||[]).filter((a=>a.id===+x)).map((a=>({...a,relationToHolder:null,productList:a.productList.filter((a=>t.includes(a.productCode)))})))}),(async()=>{h.value.extInfo&&(h.value.extInfo.iseeBizNo=C.value);const{code:a,data:e}=await f(h.value);"10000"===a&&(q.value=e)})()}}))},O=()=>{q.value&&L.push({path:p.questionNotice,query:{...w.query,orderNo:q.value}})};return i((()=>{_||(async()=>{var a;const{code:e,data:s}=await I({calcProductFactorList:[{productCode:b}]});"10000"===e&&Object.assign(h.value,s,{insuredList:[{...null==(a=s.insuredList)?void 0:a[0]}]})})(),z(),setTimeout((async()=>{C.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(a,e)=>{const s=m;return d(),n("div",null,[l(s,null,{default:u((()=>[l(c(y),{"product-detail":{insurerCode:"lianlife"},onClose:O})])),_:1})])}}});export{w as default};
