!function(){var e=document.createElement("style");e.innerHTML=".page-activity-invite{background:linear-gradient(180deg,#fea64a 0%,#fc7429 88%,#fc6d24 100%)}.page-activity-invite .logo{width:50%;margin:.4rem}.page-activity-invite .container{position:absolute;width:100%;bottom:.8rem;padding:.26667rem}.page-activity-invite .container .title{margin:auto;margin-top:-1.6rem;width:calc(100% - .8rem)}.page-activity-invite .container .title img{width:100%}.page-activity-invite .container .main-form{background:url(/static/assets/bg.c7f48ab0.png) no-repeat;background-size:100% 100%;position:relative;padding:1.33333rem 0 .6rem}.page-activity-invite .container .main-form .sms-code{width:2rem;text-align:center;font-size:.4rem;font-weight:500;color:#ff6d23;padding:0}.page-activity-invite .container .main-form .submit{height:1.33333rem;margin-top:.53333rem;margin-bottom:.46667rem;background:url(/static/assets/button.4c281a6e.png) no-repeat;background-size:contain;background-position:center;border:none}.page-activity-invite .container .main-form .agree{padding:0 .33333rem;font-size:.37333rem;font-weight:400;color:#666;display:flex;align-items:flex-start}.page-activity-invite .container .main-form .van-cell .van-field__value{align-items:flex-start}.page-activity-invite .container .main-form .van-checkbox{width:1.33333rem}.page-activity-invite .container .main-form .pdf-viewer .title{color:#ff6d23}.page-activity-invite .container .main-form .van-checkbox__icon--checked .van-icon{background-color:#ff6d23;border-color:#ff6d23}\n",document.head.appendChild(e),System.register(["./vendor-legacy-1e86c4b9.js","./trial-legacy-b63d60fd.js","./product-legacy-52a1b2ad.js","./infoCollection-legacy-f3c4910f.js","./phoneVerify-legacy-4195d5db.js","./index-legacy-0a293a95.js","./utils-legacy-0b4a8dbf.js","./trial-legacy-97673b19.js"],(function(e){"use strict";var t,a,n,o,i,l,r,c,s,u,d,m,f,v,p,g,b,y,h,k,I,V,N,w,C,x,_,j,L,O,U,F;return{setters:[function(e){t=e.g,a=e.E,n=e.M,o=e._,i=e.r,l=e.j,r=e.k,c=e.m,s=e.p,u=e.A,d=e.z,m=e.J,f=e.L,v=e.n,p=e.G,g=e.F,b=e.C,y=e.T,h=e.O,k=e.a9,I=e.h},function(e){V=e.g,N=e.m,w=e.i},function(e){C=e.p},function(e){x=e.a},function(e){_=e.s,j=e.c},function(e){L=e.a3},function(e){O=e.g,U=e.l,F=e.a},function(){}],execute:function(){const P={class:"agree"},q=b(" 我已阅读并同意 "),z=t({props:{info:{type:Object,default:()=>{}}},emits:["on-verify"],setup(e,{emit:t}){var b,y;const h=e,k=a({}),I=a(0),V=a("获取验证码"),N=/\d{9}/,w=/^\d{6}$/,C=n({mobile:null===(b=h.info)||void 0===b||null===(y=b.userInfo)||void 0===y?void 0:y.mobile,smsCode:"",agree:""}),x=async()=>{I.value>0||null==k||k.value.validate("mobile").then((async()=>{await _(C.mobile),(()=>{if(I.value>0)return;I.value=30;const e=()=>{V.value=`${I.value}s`,I.value-=1};e();const t=setInterval((()=>{0===I.value?(V.value="获取验证码",I.value=0,clearInterval(t)):e()}),1e3)})()}))},L=async()=>{const e=await j(C.mobile,C.smsCode),{data:a}=e;a&&t("on-verify",C)},O=async()=>{null==k||k.value.validate().then((async()=>{L()}))};return o((()=>C),(()=>{N.test(C.mobile)&&w.test(C.smsCode)&&L()}),{deep:!0,immediate:!0}),(e,t)=>{const a=i("van-field"),n=i("van-cell-group"),o=i("van-checkbox"),b=i("ProPDFviewer"),y=i("VanForm");return l(),r(y,{ref_key:"formRef",ref:k},{default:c((()=>{var e;return[s(n,null,{default:c((()=>[s(a,{modelValue:u(C).mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>u(C).mobile=e),name:"mobile",label:"手机号",clearable:"",placeholder:"请输入手机号",rules:[{pattern:N,message:"请输入正确的手机号"}]},null,8,["modelValue","rules"]),s(a,{modelValue:u(C).smsCode,"onUpdate:modelValue":t[1]||(t[1]=e=>u(C).smsCode=e),name:"smsCode",label:"验证码",clearable:"",placeholder:"请输入验证码",rules:[{pattern:w,message:"请输入正确的验证码"}]},{button:c((()=>[d("div",{class:f(["sms-code",{"count-down":I.value>0}]),onClick:x},m(V.value),3)])),_:1},8,["modelValue","rules"])])),_:1}),d("div",{class:"submit",onClick:O}),d("div",P,[s(o,{modelValue:u(C).agree,"onUpdate:modelValue":t[2]||(t[2]=e=>u(C).agree=e),name:"agree",shape:"square"},null,8,["modelValue"]),d("div",null,[q,(l(!0),v(g,null,p((null===(e=h.info)||void 0===e?void 0:e.attachmentList)||[],((e,t)=>(l(),r(b,{key:t,class:"file-name",title:`《${e.attachmentName}》`,content:e.attachmentUrl,type:"pdf"},null,8,["title","content"])))),128))])])]})),_:1},512)}}}),E={class:"agree"},D=b(" 我已阅读并同意 "),H=t({props:{info:{type:Object,default:()=>{}}},emits:["on-submit"],setup(e,{emit:t}){const o=e,m=a({}),f=/\W/,b=n({name:o.info.userInfo.name,certNo:o.info.userInfo.certNo,agree:""}),h=e=>!!L(b.certNo)||"请填写正确的证件号",k=()=>{null==m||m.value.validate().then((async e=>{b.agree?t("on-submit",b):y("请勾选协议")}))};return(e,t)=>{const a=i("van-field"),n=i("van-cell-group"),y=i("van-checkbox"),I=i("ProPDFviewer"),V=i("VanForm");return l(),r(V,{ref_key:"formRef",ref:m},{default:c((()=>{var e;return[s(n,null,{default:c((()=>[s(a,{modelValue:u(b).name,"onUpdate:modelValue":t[0]||(t[0]=e=>u(b).name=e),name:"name",label:"姓名",clearable:"",placeholder:"请输入姓名",rules:[{pattern:f,message:"请输入正确的姓名"}]},null,8,["modelValue","rules"]),s(a,{modelValue:u(b).certNo,"onUpdate:modelValue":t[1]||(t[1]=e=>u(b).certNo=e),name:"certNo",label:"身份证",clearable:"",placeholder:"请输入身份证号",rules:[{validator:h}]},null,8,["modelValue","rules"])])),_:1}),d("div",{class:"submit",onClick:k}),d("div",E,[s(y,{modelValue:u(b).agree,"onUpdate:modelValue":t[2]||(t[2]=e=>u(b).agree=e),name:"agree",shape:"square"},null,8,["modelValue"]),d("div",null,[D,(l(!0),v(g,null,p((null===(e=o.info)||void 0===e?void 0:e.attachmentList)||[],((e,t)=>(l(),r(I,{key:t,class:"file-name",title:`《${e.attachmentName}》`,content:e.attachmentUrl,type:"pdf"},null,8,["title","content"])))),128))])])]})),_:1},512)}}});const S={class:"page-activity-invite"},$=["src"],R={class:"container"},T={class:"main-form"},A={class:"title"},J=["src"];e("default",t({setup(e){const t=h(),o=k(),{productCode:i="7X9",tenantId:c="",extInfo:s}=t.query,m=O(s),f=a(!0),p=n({title:"/static/assets/title-step1.97cb9efa.png",attachmentList:[{}],userInfo:{mobile:m.phoneNo,certNo:"",name:""}}),g=a(),b=a(),y=async e=>{p.userInfo.mobile=e.mobile;const t=await V({holderPhone:p.userInfo.mobile,productCode:i,tenantId:c}),{code:a,data:n}=t;var o,l;"10000"===a&&(p.userInfo.name=null===(o=n.tenantOrderHolder)||void 0===o?void 0:o.name,p.userInfo.certNo=null===(l=n.tenantOrderHolder)||void 0===l?void 0:l.certNo);p.title="/static/assets/title-step2.258af5e9.png",f.value=!1},_=async e=>{p.userInfo.certNo=e.certNo,p.userInfo.name=e.name;const a=F({tenantId:c,detail:g.value,...m,holder:p.userInfo,insured:{...p.userInfo,relationToHolder:x.SELF}}),n=await N(a),{code:i}=n;"10000"===i&&o.push({path:"/activity/productDetail",query:{...t.query,tenantId:c,productCode:"BWYL2021",extInfo:JSON.stringify({...m,phoneNo:p.userInfo.mobile,certNo:p.userInfo.certNo,name:p.userInfo.name})}})},j=async()=>{const e=C({productCode:i,withInsureInfo:!0}),t=w({productCode:i});Promise.all([e,t]).then((([e,t])=>{"10000"===e.code&&(g.value=e.data),"10000"===t.code&&(b.value=t.data,p.attachmentList=(()=>{let e=[];return b.value.productRiskVoList.forEach((t=>{t.riskDetailVOList.forEach((t=>{e=e.concat(t.riskAttachmentVOList)}))})),e})())}))};return I((()=>{j()})),(e,t)=>(l(),v("div",S,[d("img",{class:"logo",src:u(U)},null,8,$),d("div",R,[d("div",T,[d("div",A,[d("img",{src:u(p).title},null,8,J)]),f.value?(l(),r(z,{key:0,info:u(p),onOnVerify:y},null,8,["info"])):(l(),r(H,{key:1,info:u(p),onOnSubmit:_},null,8,["info"]))])])]))}}))}}}))}();
