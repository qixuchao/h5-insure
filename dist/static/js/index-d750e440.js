import{_ as e,d as t,g as a,o as s,c as o,a as l,e as d,u as n,cI as r,b as i,al as c,a8 as u,cY as p,w as m,aw as v,bM as g,l as y,q as I,az as b,T as f,a9 as C,am as h,at as N,au as k,cZ as _,c3 as D,h as S,i as Y,j as U,z as x,O as T,aJ as L,m as j,cH as P,n as w,F as B}from"./index-b7b909b3.js";import{_ as E}from"./index-96b4c3d4.js";import{L as G}from"./index-adb961d2.js";import{d as W,g as q}from"./order-3337b986.js";import{I as A}from"./infoItem-c8068153.js";import"./empty-ae586b6c.js";const H={class:"com-order-item"},M={class:"header"},R={class:"product-name"},z={class:"status"},O={class:"info"},Z={class:"info-bottom"},F=(e=>(N("data-v-1c14f236"),e=e(),k(),e))((()=>l("div",{style:{width:"25%"}},[l("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),X={class:"footer"},J={class:"fee"},K={class:"money"},Q={key:0,class:"buttons"},V={key:1,class:"buttons"},$={key:2,class:"buttons"};var ee=e(t({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:t}){const N=e,k=a(),D=()=>{b.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{W(N.detail.id,N.detail.orderStatus).then((e=>{const{code:a,data:s}=e;"10000"===a&&(f.success("删除成功"),t("afterDelete"))}))}))},S=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderTopStatus:c}=N.detail;if((p.PENDING===c||p.PAYING===c)&&[_.ZXYS,_.BWYL,_.BWYLUP].includes(e)){const a={[_.ZXYS]:"/internet/productDetail/package",[_.BWYL]:"/internet/productDetail",[_.BWYLUP]:"/internet/guaranteeUpgrade"};return k.push({path:a[e],query:{productCode:e,saleChannelId:i,agentCode:s,tenantId:l,agencyCode:r,orderNo:t}}),!0}return!1},Y=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r}=N.detail;S()||k.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyCode:r}})};return(t,a)=>{const b=h;return s(),o("div",H,[l("div",M,[l("div",R,d(e.detail.productName),1),l("div",z,d(n(r)[e.detail.orderStatus]),1)]),l("div",O,[i(A,{label:"订单号",content:e.detail.policyHolder,line:"","is-copy":""},null,8,["content"]),i(A,{label:"投保单号",content:e.detail.applicationNo,line:"","is-copy":""},null,8,["content"]),i(A,{label:"保单号",content:e.detail.policyNo,line:"","is-copy":""},null,8,["content"]),l("div",Z,[l("div",null,[i(A,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),i(A,{label:"被保人",content:e.detail.insuredName,line:""},null,8,["content"]),i(A,{label:"创建时间",content:n(c)(e.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss"),line:""},null,8,["content"])]),F])]),l("div",X,[l("div",J,[u(" 保费："),l("span",K,"￥"+d(e.detail.premium),1)]),e.detail.orderTopStatus===n(p).PENDING?(s(),o("div",Q,[i(b,{class:"button",onClick:v(D,["stop"])},{default:m((()=>[u("删除")])),_:1},8,["onClick"]),n(g).UNDERWRITING_FAILED!==e.detail.orderStatus?(s(),y(b,{key:0,class:"button primary",onClick:a[0]||(a[0]=v((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderStatus:c,abbreviation:u}=N.detail;S()||C("orderDetail",{orderNo:t,agentCode:s,tenantId:l,abbreviation:u,productCategory:n})})()),["stop"]))},{default:m((()=>[u("去处理")])),_:1})):I("",!0)])):I("",!0),e.detail.orderTopStatus===n(p).PAYING?(s(),o("div",V,[i(b,{class:"button primary",onClick:v(Y,["stop"])},{default:m((()=>[u("去支付")])),_:1},8,["onClick"])])):I("",!0),e.detail.orderTopStatus===n(p).TIMEOUT?(s(),o("div",$,[i(b,{class:"button",onClick:v(D,["stop"])},{default:m((()=>[u("删除")])),_:1},8,["onClick"])])):I("",!0)])])}}}),[["__scopeId","data-v-1c14f236"]]);const te={class:"page-order"},ae={key:0,class:"order-head"},se={class:"order-head-num"},oe={style:{"margin-left":"27px"},class:"order-head-num"},le={style:{"margin-left":"36px"},class:"order-head-num"},de={key:2,class:"empty-box"},ne=(e=>(N("data-v-7ae44c57"),e=e(),k(),e))((()=>l("div",{class:"footer"},[l("img",{src:"/static/png/logo-b728275d.png",alt:"",style:{width:"100%",height:"128px"}})],-1)));var re=e(t({__name:"index",setup(e){const t=D();a();const r=S().query,c=Y({"-1":1,0:2,1:3,2:4}[r.type]||0),p=Y(1),v=Y(!1),g=Y(!1),b=Y([]),h=Y(0),N=Y(0),k=Y(0),_=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],W=U((()=>(b.value=[],_[c.value].status))),A=()=>{f.loading({message:"加载中...",forbidClick:!0}),v.value=!0,q({condition:{orderTopStatus:W.value},pageSize:10,pageNum:p.value}).then((e=>{var t;v.value=!1;const{code:a,data:s}=e;"10000"===a&&s&&(1===p.value?(b.value=s.datas[0].applicationResList||[],h.value=s.datas[0].invalidNum,N.value=s.datas[0].totalNum,k.value=s.datas[0].validNum):b.value=[...b.value,...(null==(t=s.datas[0])?void 0:t.applicationResList)||[]]),g.value=!s||b.value.length>=(null==s?void 0:s.total)})).then((()=>{f.clear()}))},H=()=>{p.value+=1,A()},M=()=>{p.value=1,A()};return x(W,(()=>{p.value=1,A()})),T((()=>{A()})),(e,a)=>{const r=G,p=E,f=L;return s(),y(f,{"theme-vars":n(t)},{default:m((()=>[l("div",te,[i(P,{active:n(c),"onUpdate:active":a[0]||(a[0]=e=>j(c)?c.value=e:null),list:_,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),n(b).length?(s(),o("div",ae,[u(" 共 "),l("span",se,d(n(N)),1),u(" 张保单 "),l("span",oe,d(n(k)),1),u(" 张有效 "),l("span",le,d(n(h)),1),u(" 张失效 ")])):I("",!0),n(b).length?(s(),y(r,{key:1,class:"body",loading:n(v),finished:n(g),onLoad:H},{default:m((()=>[(s(!0),o(B,null,w(n(b),((e,t)=>(s(),y(ee,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n}=e;C("orderDetail",{orderNo:t,agentCode:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n})})(e),onAfterDelete:M},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])):(s(),o("div",de,[i(p,{title:"暂无投保单","empty-class":"empty-select"})])),ne])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-7ae44c57"]]);export{re as default};
