!function(){var e=document.createElement("style");e.innerHTML='.page-trial-wrapper[data-v-10e6e0ab]{background-color:var(--zaui-global-bg, #f2f5fc)}.page-trial-wrapper .part-card[data-v-10e6e0ab]{background-color:#fff;margin-bottom:.26667rem}.page-trial-wrapper .risk-content[data-v-10e6e0ab] .van-collapse-item__title--expanded{padding:0 .4rem 0 0;display:flex;align-items:center}.page-trial-wrapper .risk-content[data-v-10e6e0ab] .van-collapse-item__content{padding:0}.page-trial-wrapper .plan-risk[data-v-10e6e0ab] .van-tabs__line{display:none}.page-trial-wrapper .plan-risk[data-v-10e6e0ab] .van-tabs .van-tabs__wrap{height:auto}.page-trial-wrapper .plan-risk[data-v-10e6e0ab] .van-tabs .van-tabs__wrap .van-tabs__nav--line{padding:.30667rem 0}.page-trial-wrapper .footer-bar[data-v-10e6e0ab]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4;z-index:2}.page-trial-wrapper .footer-bar .trial-result[data-v-10e6e0ab]{width:5.86667rem;font-size:.45333rem;font-weight:400;color:var(--zaui-text, #393d46)}.page-trial-wrapper .footer-bar .trial-result .result-num[data-v-10e6e0ab]{color:var(--zaui-price, #ff5840);font-size:.45333rem;font-weight:500;margin-left:.21333rem}.page-trial-wrapper .footer-bar .trial-operate button[data-v-10e6e0ab]{width:3.73333rem}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip[data-v-10e6e0ab]{position:absolute;z-index:122;height:.56rem;border-radius:1.33333rem;background-color:var(--zaui-price, #ff5840);font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC,sans-serif;font-weight:400;color:#fff;line-height:.49333rem;padding:.04rem .28rem .02667rem .26667rem;right:.4rem;top:-.46667rem;display:flex;align-items:center}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip .close-icon[data-v-10e6e0ab]{margin-left:.17333rem;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAFVBMVEUAAAD///////////////////////9Iz20EAAAABnRSTlMAqvDQjzGyGyePAAAAZElEQVQY01WQsRHAMAgDSeL0rlLnLgvkMoFHyAo02n8Eny0VFoUBPweIMDu/xqA8fxxIJhfe2IE64g24owBJgDbfOkGGnL7oBYgIhAiEBIQEPPEyNfDWNtTXsUVNgokz2X6Q1TpVESf7Ckv8GQAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-size:contain;width:.24rem;height:.24rem}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip[data-v-10e6e0ab]:after{content:" ";position:absolute;z-index:11;width:0;height:0;border:.13333rem solid transparent;border-top:.13333rem solid #ff5840;border-right:.13333rem solid #ff5840;right:.49333rem;bottom:-.16rem}\n',document.head.appendChild(e),System.register(["./vendor-legacy-817753c8.js","./index-legacy-fe23a49a.js","./trial-legacy-997e6809.js","./createProposal-legacy-37063176.js","./index-legacy-5b251d69.js","./useStorage-legacy-65280ea9.js","./trial-legacy-6bcee1e1.js","./useDicData-legacy-fdc68678.js"],(function(e){"use strict";var a,r,i,t,n,o,l,s,d,u,c,p,g,f,m,v,k,b,y,h,P,A,C,I,L,V,O,_,w,R,D,B,T;return{setters:[function(e){a=e.h,r=e.aa,i=e.P,t=e.G,n=e.N,o=e.a7,l=e.$,s=e.o,d=e.r,u=e.k,c=e.m,p=e.n,g=e.B,f=e.p,m=e.s,v=e.v,k=e.A,b=e.F,y=e.H,h=e.L,P=e.E},function(e){A=e.P,C=e.a},function(e){I=e.i,L=e.p},function(e){V=e.c},function(e){O=e._,_=e.n,w=e.b,R=e.E},function(e){D=e.u},function(e){B=e.b,T=e.a},function(){}],execute:function(){const N={key:0,class:"part-card"},F={key:1,class:"part-card"},E={class:"risk-content"},x={key:0,class:"risk"},j={key:1,class:"plan-risk"},S={class:"footer-bar van-safe-area-bottom"},z={class:"trial-result"},M=P("总保费"),U={class:"result-num"},q={class:"trial-operate"},G={key:0,class:"retrial-tip"},J=P(" 条件更改后，需要重新试算 "),Q=P("去试算"),H=P("立即投保"),Y=a({setup(e){const a=r(),P=i(),{templateId:O=1,agentCode:Y="test",agencyCode:W="",tenantId:K=9991000007,insurerCode:X="99",proposalId:Z,saleChannelId:$}=P.query;let{productCode:ee="MMBBSF"}=P.query;const ae=t({personVO:{occupationCodeList:[]}}),re=t({insuredCode:"",personVO:{occupationCodeList:[]}}),ie=t({}),te=t({}),ne=t({}),oe=t(null),le=t({}),se=n({currentPlan:"",riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,enumList:{},ageRange:[],collapseName:["1"],insuredRiskList:[],currentRiskList:[]});if(Z)try{var de,ue;ee=null===(de=JSON.parse((null===(ue=P.query)||void 0===ue?void 0:ue.extInfo)||"{}"))||void 0===de?void 0:de.productCenterCode}catch(ke){}o("premium",le.value),D().get("userInfo");const ce=()=>{se.retrialTip=!1},pe=()=>{_({agencyId:W,saleUserId:Y,saleChannelId:$,tenantId:K,venderCode:se.riskBaseInfo.insurerCode,orderDataSource:1,proposalId:Z,extInfo:{templateId:+(O||1),pageCode:"premiumTrial",iseeBizNo:window.iseeBiz},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{extInfo:{},tenantOrderProductList:[{productCode:se.riskBaseInfo.productCode||"",productName:se.riskBaseInfo.productName||"",premium:se.trialResult.premium||0,tenantOrderRiskList:se.insuredRiskList}]}]}).then((({code:e,data:r})=>{"10000"===e&&"jumpToPage"===r.pageAction.pageAction&&a.push({path:w[r.pageAction.data.nextPageCode],query:{insurerCode:se.riskBaseInfo.insurerCode,...P.query,orderNo:r.pageAction.data.orderNo}})}))},ge=()=>{const e=JSON.parse(JSON.stringify(ie.value[se.currentPlan])),a=Object.values(e).find((e=>1===e.riskType)),r=Object.values(e).map((e=>{const r=e;if("3"===r.chargePeriod){const e=(a.chargePeriod||"").split("_");e[1]&&(e[1]-=1),r.chargePeriod=e.join("_")}return r.liabilityVOList=(r.liabilityVOList||[]).filter((e=>1===e.optionalFlag||e.liabilityAttributeValue&&"-1"!==e.liabilityAttributeValue)).map((e=>{const a=e;return"0"===a.liabilityAttributeValue&&(a.liabilityAttributeValue=""),a})),r})),i={holder:ae.value,productCode:se.riskBaseInfo.productCode,insuredVOList:[{...re.value,productPlanVOList:[{planCode:se.currentPlan||"",insurerCode:se.riskBaseInfo.insurerCode,riskVOList:r}]}]};L({...i}).then((({code:e,data:a})=>{if("10000"===e){se.retrialTip=!1,se.trialResult=a,se.canTrial=!1;const e={},r=(a=[])=>{(a||[]).forEach((a=>{var i;e[a.riskCode]=a,null!==(i=a.riskPremiumDetailVOList)&&void 0!==i&&i.length&&r(a.riskPremiumDetailVOList)}))};r(a.riskPremiumDetailVOList),((e,a)=>{se.insuredRiskList=e.map((e=>{var r,i;return{initialAmount:null===(r=a[e.riskCode])||void 0===r?void 0:r.amount,amountUnit:1,annuityDrawFrequency:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,paymentFrequency:e.paymentFrequency,paymentPeriod:e.chargePeriod.split("_")[1],paymentPeriodType:B[e.chargePeriod.split("_")[0]],insurancePeriodType:T["to_life"===e.coveragePeriod?"to_life":e.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+e.coveragePeriod.split("_")[1])?0:e.coveragePeriod.split("_")[1],riskCode:e.riskCode,riskType:e.riskType,riskName:e.riskName,extInfo:{riskId:e.riskId,copy:e.copy},initialPremium:null===(i=a[e.riskCode])||void 0===i?void 0:i.premium,liabilityDetails:e.liabilityVOList.map((e=>({liabilityCode:e.liabilityCode,liabilityName:e.liabilityName,refundMethod:e.liabilityAttributeValue}))),productId:se.riskBaseInfo.id}}))})(i.insuredVOList[0].productPlanVOList[0].riskVOList,e),Object.assign(le.value,e)}}))},fe=()=>{var e,a,r,i,t;Promise.all([null===(e=te.value)||void 0===e||null===(a=e.validateForm)||void 0===a?void 0:a.call(e),null===(r=ne.value)||void 0===r||null===(i=r.validateForm)||void 0===i?void 0:i.call(r),null===(t=oe.value)||void 0===t?void 0:t.validate()]).then((()=>{ge()}),(e=>{var a;null!=e&&e.length&&(null==oe||null===(a=oe.value)||void 0===a||a.scrollToField(e[0].name))}))},me=()=>{I({productCode:ee,source:Z?2:1}).then((({code:e,data:a})=>{var r,i;"10000"===e&&(se.riskBaseInfo=a.productBasicInfoVO,(a.productRelationPlanVOList.length?a.productRelationPlanVOList:a.productRiskVoList[0].riskDetailVOList||[]).forEach(((e,a)=>{0===a&&(se.currentPlan=e.planCode||"0"),Z||Object.assign(ie.value,{[e.planCode||a]:{}})})),se.riskData=(null===(r=a.productRiskVoList[0])||void 0===r?void 0:r.riskDetailVOList)||[],se.riskPlanData=a.productRelationPlanVOList||[],Z&&(i=a.productBasicInfoVO.id,V({id:Z,tenantId:K}).then((({code:e,data:a})=>{if("10000"===e){var r;const{proposalInsuredProductList:e=[],...t}=(null===(r=a.proposalInsuredList)||void 0===r?void 0:r[0])||{};Object.assign(ae.value.personVO,a.proposalHolder);const n=e.find((e=>e.productId===i));Object.assign(re.value.personVO,t,{occupationCodeList:(null==n?void 0:n.occupationCodeList)||[]});const o={};((null==n?void 0:n.proposalProductRiskList)||[]).forEach((e=>{o[e.riskId]=e})),Object.assign(ie.value,{0:o})}}))))})).finally((()=>{}))},ve=e=>{se.holderFactor=e.holderFactorList,se.insuredFactor=e.insuredFactorList,se.ageRange=e.ageRange};return l([()=>ie.value,()=>ae.value,()=>re.value],(e=>{e&&!se.canTrial&&(se.canTrial=!0,se.retrialTip=!0)}),{deep:!0}),s((()=>{me(),R({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then((({code:e,data:a})=>{if("10000"===e){const e={};a.forEach((a=>{e[a.dictCode]=a.dictItemList})),se.enumList=e}}))})),(e,a)=>{const r=d("ProTitle"),i=d("VanForm"),t=d("ProTabButton"),n=d("VanTab"),o=d("VanTabs"),l=d("van-collapse-item"),s=d("van-collapse"),P=d("VanButton"),I=d("ProPageWrap");return u(),c(I,{class:"page-trial-wrapper"},{default:p((()=>{var e,d,I;return[g(se).holderFactor.length?(u(),f("div",N,[m(r,{title:"投保人"}),m(A,{ref_key:"holderRef",ref:te,"insured-code":null===(e=g(se).riskBaseInfo)||void 0===e?void 0:e.insurerCode,"form-info":ae.value.personVO,"factor-list":g(se).holderFactor,"age-range":g(se).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):v("",!0),g(se).insuredFactor.length?(u(),f("div",F,[m(r,{title:"被保人"}),m(A,{ref_key:"insuredRef",ref:ne,"insured-code":null===(d=g(se).riskBaseInfo)||void 0===d?void 0:d.insurerCode,"form-info":re.value.personVO,"factor-list":g(se).insuredFactor,"age-range":g(se).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):v("",!0),k("div",E,[m(s,{modelValue:g(se).collapseName,"onUpdate:modelValue":a[1]||(a[1]=e=>g(se).collapseName=e)},{default:p((()=>[m(l,{name:"1"},{title:p((()=>[m(r,{title:"投保方案"})])),default:p((()=>[g(se).riskData.length&&ie.value[0]?(u(),f("div",x,[m(i,{ref_key:"riskFormRef",ref:oe,"input-align":"right","error-message-align":"right"},{default:p((()=>[m(C,{"risk-info":ie.value[0],enums:g(se).enumList,"origin-data":g(se).riskData,"pick-factor":ve},null,8,["risk-info","enums","origin-data"])])),_:1},512)])):v("",!0),g(se).riskPlanData.length?(u(),f("div",j,[m(i,{ref_key:"riskFormRef",ref:oe,"input-align":"right","error-message-align":"right"},{default:p((()=>[m(o,{active:g(se).currentPlan,"onUpdate:active":a[0]||(a[0]=e=>g(se).currentPlan=e)},{default:p((()=>[(u(!0),f(b,null,y(g(se).riskPlanData,(e=>(u(),c(n,{key:e.planCode,name:e.planCode,title:e.planName},{title:p((()=>[m(t,{title:e.planName,active:g(se).currentPlan===e.planCode},null,8,["title","active"])])),default:p((()=>{var a;return[e.planCode===g(se).currentPlan?(u(),c(C,{key:0,"risk-info":ie.value[e.planCode],enums:g(se).enumList,"origin-data":null===(a=e.productRiskVoList)||void 0===a?void 0:a[0].riskDetailVOList,"pick-factor":ve},null,8,["risk-info","enums","origin-data"])):v("",!0)]})),_:2},1032,["name","title"])))),128))])),_:1},8,["active"])])),_:1},512)])):v("",!0)])),_:1})])),_:1},8,["modelValue"])]),k("div",S,[k("span",z,[M,k("span",U,h((g(se).retrialTip?0:(null===(I=g(se).trialResult)||void 0===I?void 0:I.premium)||0).toLocaleString("hanidec",{style:"currency",currency:"CNY"})),1)]),k("div",q,[g(se).retrialTip?(u(),f("div",G,[J,k("span",{class:"close-icon",onClick:ce})])):v("",!0),g(se).canTrial?(u(),c(P,{key:1,type:"primary",onClick:fe},{default:p((()=>[Q])),_:1})):(u(),c(P,{key:2,type:"primary",onClick:pe},{default:p((()=>[H])),_:1}))])])]})),_:1})}}});e("default",O(Y,[["__scopeId","data-v-10e6e0ab"]]))}}}))}();
