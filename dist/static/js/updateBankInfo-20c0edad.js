import{_ as e,d as a,j as s,i as t,h as o,bY as n,aR as i,l,o as r,c as d,u as c,p as u,q as f,f as m,a as p,b as v,w as y,v as g,e as I,bO as h,cQ as b,aP as P,aZ as j,cR as w,aB as _,aQ as N,bv as C,aI as O,b1 as k,b2 as x,co as T,cr as $,cq as B,bP as L}from"./index-1a2f17f4.js";import{P as V}from"./PolicyInfo-7d2c755c.js";import{u as q}from"./useOrder-9526bf57.js";import{p as A}from"./utils-ccc5aff2.js";import{g as E,m as U}from"./trial-a735adfa.js";import{n as D}from"./nextStep-70df975c.js";import{_ as G}from"./MessagePopup-df0b6c3d.js";import{q as R}from"./qianming-ece13dd4.js";import{i as S}from"./core-8ca2268c.js";import"./utils-ca427327.js";import"./createProposal-ecb41f85.js";import"./trial-c4fdc91e.js";import"./utils-e3c95d7d.js";import"./infoCollection-2a99cd25.js";const M=e=>(k("data-v-54e0d05e"),e=e(),x(),e),z={class:"bank-info-wrap"},F={class:"footer-button"},J={class:"content-inner"},K=["src"],Q=M((()=>p("h4",null,"提交成功",-1))),H=M((()=>p("p",null,"您的变更已成功提交，详情结果请在我的订单中查看",-1))),W=a({name:"updateBankInfo"});var Y=e(a({...W,setup(e){const a=s(!1),k=t(),x=o(),{orderNo:M,isShare:W,tenantId:Y,nextPageCode:Z}=k.query,X=q(),ee=s({schema:[],config:[],formData:[]}),ae=s(!!W),se=s(),te=s(),[oe,ne]=n(),ie=()=>{x.back()},le=()=>{S?h.closeWindow():window.close(),b()},re=()=>{se.value&&se.value.validate(!1).then((e=>{e&&(a.value=!0,X.value.tenantOrderPayInfoList=te,W?(X.value.extInfo.buttonCode=P.UPDATE_BANK_INFO_HOLDER,D(X.value,((e,a)=>{a===j.JUMP_PAGE&&(ne(!0),setTimeout((()=>{le()}),1500))}),k).finally((()=>{a.value=!1}))):(X.value.extInfo.buttonCode=P.UPDATE_BANK_INFO_AGENT,D(X.value,((e,a)=>{a===j.JUMP_PAGE&&(ne(!0),((e,a)=>{var s;const{holder:t,insuredList:o}=X.value;let n={name:t.name,gender:`${T[t.gender]}士`};"insured"===e&&(n={name:null==o?void 0:o[0].name,gender:`${T[null==o?void 0:o[0].gender]}士`});const i={...k.query,objectType:e,isShare:1,nextPageCode:"updateBankInfo"};$({shareType:0,title:`${B[a].title}`,desc:B[a].desc.replace("{name}",`${n.name}${n.gender}`),url:`${null==(s=window.location.href.split("?"))?void 0:s[0]}?${L.stringify(i)}`.replace("/updateBankInfo","/phoneVerify"),imageUrl:"https://aquarius-v100-test.oss-cn-hangzhou.aliyuncs.com/MyPicture/asdad.png"})})("holder","pay"))}),k).finally((()=>{a.value=!1}))))}))};i((()=>{(async()=>{let e={};w({orderNo:M,tenantId:Y}).then((({code:e,data:a})=>{if("10000"===e){te.value=a.tenantOrderPayInfoList;const e=[];a.tenantOrderPayInfoList.forEach(((a,s)=>{`${a.paymentType}`==`${_.NO}`&&(e[s]={paymentType:{isView:!0}})})),ee.value.config=e}}));const{code:a,data:s}=await E({orderNo:M,tenantId:Y});"10000"===a&&(Object.assign(X.value,s,{extInfo:{...s.extInfo,buttonCode:P.SIGN,pageCode:N.SIGN}}),e=A(s.insuredList[0].productList)),U(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:s}=e,{payInfo:t}=C(s);ee.value={...ee.value,...t}}}))})()}));const de=s();return l((()=>{setTimeout((async()=>{de.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,s)=>{const t=O;return r(),d("div",z,[c(ee).schema.length&&c(te)?(r(),u(V,{key:0,ref_key:"payInfoRef",ref:se,modelValue:c(te),"onUpdate:modelValue":s[0]||(s[0]=e=>f(te)?te.value=e:null),schema:c(ee).schema,config:c(ee).config,"is-view":c(ae),"user-data":c(X)},null,8,["modelValue","schema","config","is-view","user-data"])):m("",!0),p("div",F,[v(t,{type:"primary",plain:"",onClick:ie},{default:y((()=>[g("取消")])),_:1}),v(t,{disabled:c(a),type:"primary",onClick:re},{default:y((()=>[g(I(c(W)?"确认":"分享给客户确认"),1)])),_:1},8,["disabled"])]),v(G,{modelValue:c(oe),"onUpdate:modelValue":s[1]||(s[1]=e=>f(oe)?oe.value=e:null),onClose:le},{default:y((()=>[p("div",J,[p("img",{src:c(R),alt:"",class:"header-img"},null,8,K),Q,H])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-54e0d05e"]]);export{Y as default};
