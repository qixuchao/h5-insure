import{h as e,r as t,x as a,k as n,l,y as o,z as r,A as s,s as i,Q as d,n as u,F as c,C as v,N as p,a8 as f,j as m,m as I,I as y,E as b,T as j,a3 as C,a4 as w}from"./vendor-8ce3e007.js";import{u as h}from"./theme-1f207c56.js";import{g as _,a as g,i as x}from"./trial-7f378009.js";import{_ as E,n as L}from"./nextStep-36d13a9d.js";import{s as O}from"./verify-895bcdf6.js";import{p as N}from"./product-d2cfa7f2.js";import{a as k}from"./order-dd1aaa16.js";import{u as T,s as R}from"./core-a5163fe5.js";import{P as S}from"./index-553bb2c3.js";import{_ as P}from"./index-b395e119.js";import"./infoCollection-405ffb6b.js";import"./relativeTime-b91118b7.js";import"./useDicData-45cd01f4.js";import"./index-5e16c767.js";const V={class:"sign-wrap"},A=["src"],D=v("点击签字"),H={class:"popup-body"},B={class:"sign-container-wrap"},U={class:"operate-bar"},F=r("span",null,"请投保人正楷签署您的签名:",-1),z=v("返回"),G=v("重写"),Y=v("确定签字"),q=e({props:{option:{default:{}},modelValue:{default:""}},emits:["update:modelValue"],setup(e,{emit:v}){const p=t(!1),f=t(),m=a((()=>{let e="";return f.value&&(e=f.value.save()),e})),I=()=>{p.value=!0},y=()=>{p.value=!1},b=()=>{var e,t;null==(t=null==(e=f.value)?void 0:e.clear)||t.call(e)},j=()=>{v("update:modelValue",m.value),p.value=!1};return(e,t)=>{const a=n("van-button"),v=n("ProSign"),C=n("van-popup");return l(),o(c,null,[r("div",V,[s(m)?(l(),o("img",{key:0,class:"previewSign",src:s(m),alt:""},null,8,A)):i("",!0),d(a,{type:"primary",size:"small",onClick:I},{default:u((()=>[D])),_:1})]),d(C,{show:p.value,"onUpdate:show":t[0]||(t[0]=e=>p.value=e),position:"bottom",style:{height:"100%"}},{default:u((()=>[r("div",H,[r("div",B,[d(v,{ref_key:"signRef",ref:f},null,512),r("div",U,[F,d(a,{type:"default",onClick:y},{default:u((()=>[z])),_:1}),d(a,{type:"default",onClick:b},{default:u((()=>[G])),_:1}),d(a,{type:"default",disabled:!s(m),onClick:j},{default:u((()=>[Y])),_:1},8,["disabled"])])])])])),_:1},8,["show"])],64)}}});const J={class:"net-sale-wrap"},Q={class:"part"},W={class:"product-name"},X={class:"part"},$={class:"part"},K={class:"part"},M={class:"sign-cell"},Z=(e=>(C("data-v-595c8d72"),e=e(),w(),e))((()=>r("div",{class:"sign-label"},"签名",-1))),ee={class:"footer-button"};var te=P(e({setup(e){const a=h(),v=p();f();const{orderNo:C="2022113021181894998",tenantId:w="9991000001",productCode:P="HTEJBX"}=v.query;t();const V=t({}),A=t({commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_airSignature",pageCode:"infoCollection",templateId:3,iseeBizNo:""},orderCategory:1,tenantId:w,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:w}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),D=t(),H=t(),B=t(""),U=t(""),F=t({}),z=async()=>{B.value?(await O("HOLDER",B.value,A.value.id,`${w}`),L(A.value)):j("请先签字")};return T(),m((()=>{(async()=>{const{code:e,data:t}=await x({productCode:P,tenantId:w});"10000"===e&&(D.value=t,V.value=t.productFactor)})(),(async()=>{var e,t;const{data:a,code:n}=await N({productCode:P,tenantId:w,withInsureInfo:!0});"10000"===n&&(H.value=a,F.value=(null==(t=((null==(e=a.tenantProductDetail)?void 0:e.planList)||[]).find((e=>e.plaCode===U.value)))?void 0:t.attachmentVOList)||[])})(),(async()=>{var e;const{code:t,data:a}=await _({orderNo:C,tenantId:w});if("10000"===t&&(a.extInfo.buttonCode="EVENT_NETSALE_airSignature",A.value=a,U.value=null==(e=a.tenantOrderInsuredList[0])?void 0:e.planCode,a.orderStatus===k.PAYING)){A.value.extInfo.redirectUrl="";const{code:e,data:t}=await g(A.value);"10000"===e&&R(t.paymentUrl)}})()})),(e,t)=>{const v=n("ProCell"),p=n("ProCard"),f=n("van-cell"),m=n("ProPageWrap"),j=n("van-config-provider");return l(),I(j,{"theme-vars":s(a)},{default:u((()=>[d(m,null,{default:u((()=>[r("div",J,[A.value.id?(l(),I(p,{key:0,"show-line":!1,title:"投保信息"},{default:u((()=>{var e,t,a,n,l,o;return[r("div",Q,[r("div",W,y(null==(e=D.value)?void 0:e.productBasicInfoVO.productFullName),1)]),r("div",X,[d(v,{title:"保费",content:A.value.orderAmount},null,8,["content"]),d(v,{title:"保险期限",content:null==(t=A.value.tenantOrderInsuredList[0])?void 0:t.planName},null,8,["content"]),d(v,{title:"起保日期",content:A.value.commencementTime},null,8,["content"]),d(v,{title:"终保日期",content:A.value.expiryDate},null,8,["content"]),d(v,{title:"保单状态",content:A.value.orderStatus},null,8,["content"])]),r("div",$,[d(v,{title:"订单编号",content:A.value.orderNo},null,8,["content"]),d(v,{title:"销售人名称",content:""}),d(v,{title:"房屋地址",content:null==(n=null==(a=A.value.tenantOrderHolder)?void 0:a.extInfo)?void 0:n.familyAddress},null,8,["content"]),d(v,{title:"燃气编号",content:null==(o=null==(l=A.value.tenantOrderInsuredList)?void 0:l[0])?void 0:o.extInfo.subjectRelatedUserId},null,8,["content"])])]})),_:1})):i("",!0),d(E,{ref:"formRef","title-collection":{HOLDER:"投保人信息",INSURER:"被保人信息",BENEFICIARY:"受益人"},"is-view":!0,"form-info":A.value,"factor-object":V.value,"input-align":"right"},null,8,["form-info","factor-object"]),d(p,{title:"阅读条款合同"},{default:u((()=>[r("div",K,[(l(!0),o(c,null,b(Object.keys(F.value),((e,t)=>(l(),I(f,{key:t,title:e,"is-link":"",onClick:t=>{F.value[e]}},null,8,["title","onClick"])))),128))])])),_:1}),d(p,{title:"客户签名"},{default:u((()=>[r("div",M,[Z,d(q,{modelValue:B.value,"onUpdate:modelValue":t[0]||(t[0]=e=>B.value=e)},null,8,["modelValue"])])])),_:1}),r("div",ee,[d(S,{text:"提交",onClick:z})])])])),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-595c8d72"]]);export{te as default};
