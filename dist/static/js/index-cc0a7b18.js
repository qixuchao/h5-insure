var se=Object.defineProperty,le=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var W=(s,n,u)=>n in s?se(s,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[n]=u,M=(s,n)=>{for(var u in n||(n={}))ie.call(n,u)&&W(s,u,n[u]);if(K)for(var u of K(n))ce.call(n,u)&&W(s,u,n[u]);return s},U=(s,n)=>le(s,re(n));import{g as $,E as d,M as R,_ as de,r as D,j as B,k as V,m as A,p as v,A as o,z as a,J as me,L as H,T as O,n as q,t as Q,a4 as pe,a5 as fe,O as ve,a9 as _e,y as X,h as he,G as Fe,F as Ce,C as z}from"./vendor-06835924.js";import{R as Be}from"./infoCollection-b0426750.js";import{s as De,c as be}from"./phoneVerify-9aaed11f.js";import{v as Y,a as ge,b as Ee}from"./validator-ebd71d12.js";import{F as T,g as ye}from"./utils-7810daca.js";import{G as Ie,_ as we}from"./index-62aa4d39.js";import{g as ke,m as Ve,i as Ae}from"./trial-c46d060f.js";import{p as Ne}from"./product-0bdd89fe.js";import{t as xe}from"./theme-eeb93d73.js";import{c as Se}from"./close-df102554.js";import{_ as Oe,a as Le}from"./index-fb742288.js";import"./trial-cc5535ea.js";const Pe=$({props:{isCheck:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>{}}},emits:["on-verify"],setup(s,{emit:n}){var k;const u=s,r=d({}),c=d(!1),w=30,m=d(0),b=d("\u83B7\u53D6\u9A8C\u8BC1\u7801"),i=R({mobile:(k=u.userInfo)==null?void 0:k.mobile,smsCode:""}),g=f=>Y(f)?!0:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7",y=()=>{if(m.value>0)return;m.value=w;const f=()=>{b.value=`${m.value}s`,m.value-=1};f();const e=setInterval(()=>{m.value===0?(b.value="\u83B7\u53D6\u9A8C\u8BC1\u7801",m.value=0,clearInterval(e)):f()},1e3)},_=async()=>{m.value>0||r==null||r.value.validate("mobile").then(async()=>{const f=await De(i.mobile),{code:e,data:F}=f;e==="10000"&&(c.value=!0,O({message:"\u77ED\u4FE1\u53D1\u9001\u6210\u529F\uFF0C\u8BF7\u67E5\u6536"}),y())})},I=async()=>{const f=await be(i.mobile,i.smsCode),{data:e}=f;e&&n("on-verify",i)},h=async()=>{r==null||r.value.validate().then(async()=>{I()})};return de(()=>i,()=>{Y(i.mobile)&&ge(i.smsCode)&&c.value&&I()},{deep:!0,immediate:!0}),(f,e)=>{const F=D("van-field"),L=D("van-cell-group"),N=D("VanForm");return B(),V(N,{ref_key:"formRef",ref:r,"label-width":"80"},{default:A(()=>[v(L,null,{default:A(()=>[v(F,{modelValue:o(i).mobile,"onUpdate:modelValue":e[0]||(e[0]=x=>o(i).mobile=x),name:"mobile",label:"\u624B\u673A\u53F7",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",maxlength:o(T).MOBILE,rules:[{validator:g}]},null,8,["modelValue","maxlength","rules"]),v(F,{modelValue:o(i).smsCode,"onUpdate:modelValue":e[1]||(e[1]=x=>o(i).smsCode=x),type:"digit",name:"smsCode",label:"\u9A8C\u8BC1\u7801",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",maxlength:o(T).SMS_CODE},{button:A(()=>[a("div",{class:H(["sms-code",{"count-down":m.value>0}]),onClick:_},me(b.value),3)]),_:1},8,["modelValue","maxlength"])]),_:1}),a("div",{class:H([{"check-submit":u.isCheck},{submit:!u.isCheck}]),onClick:h},null,2)]),_:1},512)}}}),Te=$({props:{isCheck:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>{}}},emits:["on-submit"],setup(s,{emit:n}){const u=s,r=d({}),c=R({name:u.userInfo.name,certNo:u.userInfo.certNo}),w=i=>Ie(c.certNo)?!0:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u8BC1\u4EF6\u53F7",m=i=>Ee(i)?!0:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u59D3\u540D",b=()=>{r==null||r.value.validate().then(async i=>{n("on-submit",c)})};return(i,g)=>{const y=D("van-field"),_=D("van-cell-group"),I=D("VanForm");return B(),V(I,{ref_key:"formRef",ref:r,"label-width":"80"},{default:A(()=>[v(_,null,{default:A(()=>[v(y,{modelValue:o(c).name,"onUpdate:modelValue":g[0]||(g[0]=h=>o(c).name=h),name:"name",label:"\u59D3\u540D",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",maxlength:o(T).NAME,rules:[{validator:m}]},null,8,["modelValue","maxlength","rules"]),v(y,{modelValue:o(c).certNo,"onUpdate:modelValue":g[1]||(g[1]=h=>o(c).certNo=h),name:"certNo",label:"\u8EAB\u4EFD\u8BC1",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",maxlength:o(T).ID_CARD,rules:[{validator:w}]},null,8,["modelValue","maxlength","rules"])]),_:1}),a("div",{class:H([{"check-submit":u.isCheck},{submit:!u.isCheck}]),onClick:b},null,2)]),_:1},512)}}});var $e="/static/assets/title-step1.97cb9efa.png",Me="/static/assets/title-step2.258af5e9.png";const Z=s=>(pe("data-v-a6bc1804"),s=s(),fe(),s),Ue={key:0,class:"pro-modal"},He=Z(()=>a("div",{class:"pro-overlay"},null,-1)),qe={class:"pro-modal-wrapper"},Re=Z(()=>a("div",{class:"pro-modal-content"},[a("p",null,"\u606D\u559C\u60A8"),a("p",null,"\u9886\u53D6\u6210\u529F")],-1)),ze=["src"],je=$({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(s,{emit:n}){const u=s,r=()=>{n("on-close")};return(c,w)=>u.isShow?(B(),q("div",Ue,[He,a("div",qe,[a("div",{class:"pro-modal-body"},[Re,a("div",{class:"pro-modal-btn",onClick:r},"\u6211\u77E5\u9053\u4E86")]),a("div",{class:"pro-modal-close",onClick:r},[a("img",{src:o(Se)},null,8,ze)])])])):Q("",!0)}});var Ge=we(je,[["__scopeId","data-v-a6bc1804"]]);const Je={class:"page-activity-invite"},Ke=["src"],We={class:"container"},Xe={class:"main-form"},Ye={class:"title"},Qe=["src"],Ze={class:"agree"},et={class:"check-wrap"},tt=z(" \u6211\u5DF2\u9605\u8BFB\u5E76\u540C\u610F "),ut={key:2,class:"tips"},ot=z(" \u4EA7\u54C1\u4ECB\u7ECD\u9875\u9762\u4EC5\u4F9B\u53C2\u8003\uFF0C\u5177\u4F53\u8D23\u4EFB\u63CF\u8FF0\u4EE5\u4FDD\u9669\u5408\u540C\u4E3A\u51C6\uFF0C\u4F17\u5B89\u4FDD\u9669\u6700\u8FD1\u5B63\u5EA6\u507F\u4ED8\u80FD\u529B\u7B26\u5408\u76D1\u7BA1\u8981\u6C42\uFF0C\u8BE6\u60C5\u8BF7\u53C2\u89C1\u4F17\u5B89\u4FDD\u9669\u5B98\u7F51 ("),at=a("a",{href:"https://www.zhongan.com"},"www.zhongan.com",-1),nt=z("\uFF09\u507F\u4ED8\u80FD\u529B\u4FE1\u606F\u62AB\u9732\uFF0C\u8BE5\u4FDD\u9669\u4EA7\u54C1\u7531\u4F17\u5B89\u5728\u7EBF\u8D22\u4EA7\u4FDD\u9669\u80A1\u4EFD\u6709\u9650\u516C\u53F8\u627F\u4FDD\u5E76\u8D1F\u8D23\u7406\u8D54\u3002 "),st=[ot,at,nt],Bt=$({setup(s){const n=ve(),u=_e(),{productCode:r="7X9",tenantId:c="",phoneNo:w,saleChannelId:m,agentCode:b="",paymentMethod:i,from:g}=n.query,y=d(!0),_=g==="check",I=d(!1),h=d(!1),k=d(!1),f=d(0),e=R({title:$e,attachmentList:[],userInfo:{mobile:w,certNo:"",name:""},agree:!1}),F=d(),L=d(),N=d(!1),x=X(()=>{var t,l;return((l=(t=F.value)==null?void 0:t.tenantProductInsureVO)==null?void 0:l.attachmentVOList.filter(p=>p.attachmentName==="\u5065\u5EB7\u544A\u77E5"))||[]}),j=X(()=>{var t,l;return((l=(t=F.value)==null?void 0:t.tenantProductInsureVO)==null?void 0:l.attachmentVOList.filter(p=>p.attachmentName!=="\u5065\u5EB7\u544A\u77E5"))||[]}),ee=async t=>{var P,S;e.userInfo.mobile=t.mobile;const l=await ke({holderPhone:e.userInfo.mobile,productCode:r,tenantId:c}),{code:p,data:C}=l;p==="10000"&&(e.userInfo.name=(P=C.tenantOrderHolder)==null?void 0:P.name,e.userInfo.certNo=(S=C.tenantOrderHolder)==null?void 0:S.certNo),e.title=Me,y.value=!1},G=async t=>{if((t==null?void 0:t.certNo)&&(e.userInfo.certNo=t==null?void 0:t.certNo),(t==null?void 0:t.name)&&(e.userInfo.name=t==null?void 0:t.name),_&&!I.value){k.value=!0;return}if(!e.agree){O("\u8BF7\u52FE\u9009\u534F\u8BAE");return}try{O({message:"\u9886\u53D6\u4E2D...",forbidClick:!0,loadingType:"spinner"});const l=ye({tenantId:c,detail:F.value,insureDetail:L.value,saleChannelId:m,saleUserId:b,holder:e.userInfo,insured:U(M({},e.userInfo),{relationToHolder:Be.SELF}),paymentMethod:i,renewalDK:"",successJumpUrl:"",premium:0,orderStatus:"",orderTopStatus:"",tenantOrderRiskList:[]}),p=await Ve(l),{code:C}=p;if(C==="10000"){if(_){O.clear(),N.value=!0;return}u.push({path:"/chuangxin/baigebao/productDetail",query:U(M({},n.query),{tenantId:c,phoneNo:e.userInfo.mobile,certNo:e.userInfo.certNo,name:e.userInfo.name,productCode:"BWYL2021",agentCode:b})})}}catch(l){console.log(l),O.clear()}},te=()=>{I.value=!0,G()},ue=t=>{t==="allFalse"&&(h.value=!0)},oe=()=>{N.value=!1},ae=async()=>{const t=Ne({productCode:r,withInsureInfo:!0,tenantId:c}),l=Ae({productCode:r});Promise.all([t,l]).then(([p,C])=>{p.code==="10000"&&(F.value=p.data),C.code==="10000"&&(L.value=C.data)})};return he(()=>{ae()}),(t,l)=>{const p=D("van-checkbox"),C=D("ProPDFviewer"),P=D("van-config-provider");return B(),V(P,{"theme-vars":o(xe)},{default:A(()=>{var S,J;return[a("div",Je,[a("img",{src:(J=(S=F.value)==null?void 0:S.tenantProductInsureVO)==null?void 0:J.banner[0],class:"banner"},null,8,Ke),a("div",We,[a("div",Xe,[a("div",Ye,[a("img",{src:o(e).title},null,8,Qe)]),y.value?(B(),V(Pe,{key:0,"is-check":_,"user-info":o(e).userInfo,onOnVerify:ee},null,8,["user-info"])):(B(),V(Te,{key:1,"is-check":_,"user-info":o(e).userInfo,onOnSubmit:G},null,8,["user-info"])),a("div",Ze,[a("div",et,[v(p,{modelValue:o(e).agree,"onUpdate:modelValue":l[0]||(l[0]=E=>o(e).agree=E),name:"agree",shape:"square"},null,8,["modelValue"])]),a("div",null,[tt,(B(!0),q(Ce,null,Fe(o(j)||[],(E,ne)=>(B(),V(C,{key:ne,class:"file-name",title:`\u300A${E.attachmentName}\u300B`,content:E.attachmentUri,type:"pdf"},null,8,["title","content"]))),128))])]),_?(B(),q("div",ut,st)):Q("",!0)])])]),v(Ge,{"is-show":N.value,onOnClose:oe},null,8,["is-show"]),v(Oe,{show:h.value,"onUpdate:show":l[1]||(l[1]=E=>h.value=E),"content-list":o(j),"active-index":f.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9",onSubmit:te},null,8,["show","content-list","active-index"]),v(Le,{show:k.value,"onUpdate:show":l[2]||(l[2]=E=>k.value=E),"content-list":o(x),"active-index":0,onOnConfirmHealth:ue},null,8,["show","content-list"])]}),_:1},8,["theme-vars"])}}});export{Bt as default};
