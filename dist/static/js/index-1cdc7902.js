import{G as a,d as e,bQ as s,A as t,r as l,an as o,a as r,L as i,bA as d,b as n,g as p,w as u,e as c,f as m,a2 as v,i as h,c as f,U as y,V as g,E as b,j as x,b0 as P,h as _,D as j,T as k,B as L,aX as V}from"./index-ef733660.js";import{L as C}from"./index-3f26b958.js";import{S as I}from"./index-b9ba98eb.js";import{P as w}from"./index-d3e97e14.js";import{_ as U}from"./empty-ae586b6c.js";import{P as N}from"./index-d2192a23.js";import{d as S,h as q}from"./proposalList-1b51aef0.js";import{a as A,b as T,t as z}from"./format-b5e9d8b9.js";import"./pdfh5-947e5c06.js";const B={class:"proposal-content"},D={class:"title"},E={class:"premium"},G={class:"operate-btn"};var O=a(e({__name:"index",setup(a){const e=s(),O=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:a=>A(null==a?void 0:a.coveragePeriod)},{title:"交费期间",dataIndex:"chargePeriod",width:110,render:a=>T(null==a?void 0:a.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:a=>z(null==a?void 0:a.initialPremium)}],Q=t({historyList:[],searchValue:""}),R=l(!1),W=l(!1),X=l(1),{historyList:F,searchValue:H}=o(Q),J=r(),K=()=>{q({name:H.value,pageNum:X.value,pageSize:20,relationUserType:2}).then((a=>{const{code:e,data:s}=a;"10000"===e&&(1===X.value?F.value=s.datas||[]:F.value=F.value.concat(s.datas),R.value=!1,X.value+=1,W.value=F.value.length>=s.total)}))},M=()=>{K()},Y=i((()=>F.value.length>0)),Z=a=>{H.value=a,X.value=1,K()};return(a,s)=>{const t=I,l=L,o=C,r=d("ProPageWrap"),i=V;return n(),p(i,{"theme-vars":m(e)},{default:u((()=>[c(r,{class:"page-history-proposal"},{default:u((()=>[c(t,{modelValue:m(H),"onUpdate:modelValue":s[0]||(s[0]=a=>v(H)?H.value=a:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:Z},null,8,["modelValue"]),h("div",B,[c(o,{loading:m(R),"onUpdate:loading":s[1]||(s[1]=a=>v(R)?R.value=a:null),finished:m(W),"finished-text":m(Y)?"- 没有更多了 -":"",onLoad:M},{default:u((()=>[(n(!0),f(y,null,g(m(F),(a=>(n(),f("div",{key:a.id,class:"proposal-item"},[h("div",D,b(a.proposalName),1),h("p",E,[x(" 保费："),h("span",null,"¥"+b(m(P)(a.totalPremium)),1)]),c(N,{columns:O,class:"table","data-source":a.proposalProductRiskVOList},null,8,["data-source"]),h("div",G,[c(l,{plain:"",round:"",type:"primary",class:"del-btn",onClick:e=>{return s=a.id,void j.confirm({message:"是否确定删除计划书？"}).then((()=>{S(s).then((a=>{const{code:e}=a;"10000"===e&&(k.success("删除成功"),X.value=1,K())}))})).catch((()=>{}));var s}},{default:u((()=>[x("删除")])),_:2},1032,["onClick"]),c(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void J.push({path:"/proposal/createProposal",query:{id:s}});var s}},{default:u((()=>[x("编辑")])),_:2},1032,["onClick"]),c(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void J.push({path:"compositionProposal",query:{id:s}});var s}},{default:u((()=>[x("预览")])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),m(Y)||m(R)?_("",!0):(n(),p(w,{key:0,"empty-img":m(U),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-3ad77c53"]]);export{O as default};
