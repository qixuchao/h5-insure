var me=Object.defineProperty,_e=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var ae=(p,d,i)=>d in p?me(p,d,{enumerable:!0,configurable:!0,writable:!0,value:i}):p[d]=i,M=(p,d)=>{for(var i in d||(d={}))ve.call(d,i)&&ae(p,i,d[i]);if(oe)for(var i of oe(d))Ee.call(d,i)&&ae(p,i,d[i]);return p},X=(p,d)=>_e(p,Ie(d));import{g as se,E as O,_ as G,r as m,j as _,k as L,m as l,z as u,p as c,n as q,G as ue,J as C,F as de,C as D,ak as Oe,O as ye,Q as Be,M as Ae,y as Le,o as Ce,A as f,t as Y,T as ge}from"./vendor-96e68f0e.js";import{_ as De,z as Te,w as be,W as h,X as A,n as Fe,P as he,r as Re}from"./index-d081bc8c.js";import{u as xe}from"./useDicData-9ccaa997.js";import{_ as K,R as Ne,B as Pe,a as He}from"./index-80f2dfb1.js";const ke={class:"com-select-container"},Se={class:"radio-item-wrapper"},Ve={class:"name"},Ue={class:"hone"},je={class:"address"},$e={class:"footer-button"},we=D("\u53D6\u6D88"),Me=D("\u786E\u8BA4"),Ye=se({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(p,{emit:d}){const i=p,B=O(i.modelValue),R=O(i.show),W=()=>{d("submit",B.value),R.value=!1},H=()=>{d("close")};return G(()=>i.modelValue,y=>{console.log("newVal",y),B.value=y}),G(()=>B.value,y=>{d("update:modelValue",y)}),(y,g)=>{const z=m("van-radio"),T=m("van-radio-group"),t=m("VanButton");return _(),L(Te,{show:R.value,"onUpdate:show":g[1]||(g[1]=E=>R.value=E),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:H},{default:l(()=>[u("div",ke,[c(T,{modelValue:B.value,"onUpdate:modelValue":g[0]||(g[0]=E=>B.value=E)},{default:l(()=>[(_(!0),q(de,null,ue(p.dataSource,(E,I)=>(_(),L(z,{key:I,name:I+1,class:"radio-item"},{default:l(()=>[u("div",Se,[u("p",null,[u("span",Ve,C(E.contactName),1),u("span",Ue,C(E.contactPhoneNo),1)]),u("p",je,C(E.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),u("div",$e,[c(t,{plain:"",type:"primary"},{default:l(()=>[we]),_:1}),c(t,{type:"primary",onClick:W},{default:l(()=>[Me]),_:1})])]),_:1},8,["show"])}}});var qe=De(Ye,[["__scopeId","data-v-9c6de82e"]]);const Ge={key:0,class:"beneficiary-part"},We={class:"part-title"},ze={class:"title"},Je=D("\u5220\u9664"),Qe=D("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),Xe=D("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ke={class:"radio-item-wrapper"},Ze={class:"name"},et={class:"hone"},tt={class:"address"},nt={class:"footer-button"},rt={class:"left"},ot={class:"trial-result"},at=D(" \u9996\u671F"),st={class:"result-num"},ut=u("div",{class:"result-desc"},"\u5B9E\u9645\u4FDD\u8D39\u4EE5\u540E\u7EED\u4E3A\u51C6",-1),dt={class:"operate-btn"},it=D("\u4E0B\u4E00\u6B65"),_t=se({setup(p){const d=Oe(),i=ye(),{templateId:B=1,orderNo:R="2022072710380711215",tenantId:W="9991000007"}=i.query,[H,y]=Be(),g=i.path==="/infoPreview"?"infoPreview":"infoCollection",z=xe("NATIONAL_REGION_CODE"),T=O({}),t=O({extInfo:{pageCode:g},tenantOrderHolder:{extInfo:{},holderType:1},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),E=O(null),I=O([]),b=O([]),x=O([]),J=O([]),Z=O([]),v=Ae({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),N=Le(()=>{var n,e;return v.currentAddress?v.addressList[v.currentAddress]:((e=(n=t.value.extInfo)==null?void 0:n.contactInfo)==null?void 0:e[0])||{}}),ie=()=>{var e;const n=M({},t.value);n.extInfo=X(M({},n.extInfo),{contactInfo:[N.value]}),n.tenantOrderAttachmentList=[{category:h.OBVERSE_CERT,objectType:A.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:I.value[0],id:x.value[0]},{category:h.REVERSE_CERT,objectType:A.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:I.value[1],id:x.value[1]},{category:h.OBVERSE_CERT,objectType:A.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:b.value[0]||I.value[0],id:J.value[1]},{category:h.REVERSE_CERT,objectType:A.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:b.value[1]||I.value[1],id:J.value[1]}],(e=E.value)==null||e.validate().then(a=>{if(n.tenantOrderInsuredList[0].insuredBeneficiaryType===He.SPECIFY){const r={};if(n.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.forEach(s=>{r[s.benefitOrder]?r[s.benefitOrder].sum+=Number(s.benefitRate):r[s.benefitOrder]={sum:Number(s.benefitRate)}}),Object.values(r).some(s=>s.sum!==100)){ge.fail("\u540C\u4E00\u987A\u4F4D\u7684\u53D7\u76CA\u4EBA\u6BD4\u4F8B\u4E4B\u548C\u5FC5\u987B\u4E3A100");return}}Fe(n).then(({code:r,data:s})=>{r==="10000"&&s.pageAction.pageAction==="jumpToPage"&&d.push({path:he[s.pageAction.data.nextPageCode],query:i.query})})})},le=n=>{console.log("value",n)},ce=()=>{v.beneficiaryId+=1,t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:v.beneficiaryId,extInfo:{}})},fe=n=>{t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(e=>e.beneficiaryId!==n.beneficiaryId||n.id!==e.id)},pe=()=>{Re({orderNo:R,tenantId:W}).then(({code:n,data:e})=>{if(n==="10000"){const a=e;a.extInfo=X(M({},a.extInfo),{pageCode:g,templateId:B}),a.tenantOrderHolder=a.tenantOrderHolder||{holderType:1},a.tenantOrderHolder.extInfo=a.tenantOrderHolder.extInfo||{},a.tenantOrderInsuredList[0].extInfo=a.tenantOrderInsuredList[0].extInfo||{},a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(r=>{const s=r;return s.extInfo=s.extInfo||{},s}),a.tenantOrderAttachmentList.forEach(r=>{r.category===h.OBVERSE_CERT?r.objectType===A.HOLDER?(I.value[0]=r.uri,x.value[0]=r.id):r.objectType===A.INSURED&&(b.value[0]=r.uri,J.value[0]=r.id):r.category===h.REVERSE_CERT&&(r.objectType===A.HOLDER?(I.value[1]=r.uri,x.value[1]=r.id):r.objectType===A.INSURED&&(b.value[1]=r.uri,x.value[1]=r.id))}),Object.assign(t.value,a)}}).finally(()=>{v.isLoading=!1})};return Ce(()=>{pe(),be({pageCode:"infoCollection",templateId:B}).then(({code:n,data:e})=>{if(n==="10000"){const a={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(r=>{(a[r.moduleType]=a[r.moduleType]||[]).push(r)}),T.value=a}})}),G(()=>t.value,n=>{var e,a,r,s,k,S,P,V,U,j;if(n){const Q=[{contactAddress:(a=(e=n.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:a.familyAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(s=(r=n.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:s.workAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(S=(k=n.tenantOrderInsuredList[0])==null?void 0:k.extInfo)==null?void 0:S.familyAddress,contactName:(P=n.tenantOrderInsuredList[0])==null?void 0:P.name,contactPhoneNo:(V=n.tenantOrderInsuredList[0])==null?void 0:V.mobile},{contactAddress:(j=(U=n.tenantOrderInsuredList[0])==null?void 0:U.extInfo)==null?void 0:j.workAddress,contactName:n.tenantOrderInsuredList[0].name,contactPhoneNo:n.tenantOrderInsuredList[0].mobile}];v.addressList=Q.filter(F=>F.contactAddress&&F.contactName&&F.contactPhoneNo)}},{deep:!0,immediate:!0}),G(()=>t.value.tenantOrderInsuredList[0].relationToHolder,n=>{+n==1&&Object.assign(t.value.tenantOrderInsuredList[0],t.value.tenantOrderHolder,{id:t.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(n,e)=>{const a=m("ProCard"),r=m("ProRadioButton"),s=m("ProField"),k=m("ProCascader"),S=m("ProSvg"),P=m("VanButton"),V=m("ProCheckButton"),U=m("van-cell"),j=m("ProForm"),Q=m("ProPageWrap");return _(),L(Q,{class:"page-info-wrapper"},{default:l(()=>{var F,ee,te,$,ne;return[f(v).isLoading?Y("",!0):(_(),L(j,{key:0,ref_key:"formRef",ref:E},{default:l(()=>[c(a,{title:"\u6295\u4FDD\u4EBA"},{default:l(()=>[c(K,{images:I.value,"onUpdate:images":e[0]||(e[0]=o=>I.value=o),"form-info":t.value.tenantOrderHolder,"factor-list":T.value.HOLDER,prefix:"holder"},null,8,["images","form-info","factor-list"])]),_:1}),c(a,{title:"\u88AB\u4FDD\u4EBA"},{default:l(()=>[c(s,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.tenantOrderInsuredList[0].relationToHolder=o),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:l(()=>[c(r,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.tenantOrderInsuredList[0].relationToHolder=o),options:f(Ne)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+t.value.tenantOrderInsuredList[0].relationToHolder!=1?(_(),L(K,{key:0,images:b.value,"onUpdate:images":e[3]||(e[3]=o=>b.value=o),"form-info":t.value.tenantOrderInsuredList[0],"factor-list":T.value.INSURER||[],prefix:"insure"},null,8,["images","form-info","factor-list"])):Y("",!0),c(k,{modelValue:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:modelValue":e[4]||(e[4]=o=>t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=o),field1:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":e[5]||(e[5]=o=>t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=o),field2:t.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":e[6]||(e[6]=o=>t.value.tenantOrderInsuredList[0].extInfo.insureCityCode=o),field3:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":e[7]||(e[7]=o=>t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=o),label:"\u6295\u4FDD\u5730\u533A",name:"insureAreaCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:"","data-source":f(z),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])]),_:1}),c(a,{title:"\u53D7\u76CA\u4EBA"},{default:l(()=>[c(s,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[9]||(e[9]=o=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=o),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:l(()=>[c(r,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[8]||(e[8]=o=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=o),options:f(Pe)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),t.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(_(),q("div",Ge,[(_(!0),q(de,null,ue(t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(o,w)=>(_(),q("div",{key:o.beneficiaryId||o.id,class:"beneficiary-item"},[u("div",We,[u("span",ze,C(`\u53D7\u76CA\u4EBA${w+1}`),1),c(S,{name:"delete",onClick:re=>fe(o)},{default:l(()=>[Je]),_:2},1032,["onClick"])]),c(K,{images:Z.value,"onUpdate:images":e[10]||(e[10]=re=>Z.value=re),"form-info":o,"factor-list":T.value.BENEFICIARY||[],prefix:`beneficiary-${w}`,"beneficiary-list":t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","beneficiary-list"])]))),128)),c(P,{onClick:ce},{default:l(()=>[Qe]),_:1})])):Y("",!0)]),_:1}),c(a,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:l(()=>{var o;return[((o=Object.keys(f(N)))==null?void 0:o.length)?(_(),L(U,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:e[12]||(e[12]=w=>f(y)(!0))},{title:l(()=>[u("div",Ke,[u("p",null,[u("span",Ze,C(f(N).contactName),1),u("span",et,C(f(N).contactPhoneNo),1)]),u("p",tt,C(f(N).contactAddress),1)])]),_:1})):(_(),L(V,{key:0,activated:"",onClick:e[11]||(e[11]=w=>f(y)(!0))},{default:l(()=>[Xe]),_:1}))]}),_:1})]),_:1},512)),u("div",nt,[u("div",rt,[u("div",ot,[at,u("span",st,"\uFFE5"+C((ne=($=(te=(ee=(F=t.value.tenantOrderInsuredList)==null?void 0:F[0])==null?void 0:ee.tenantOrderProductList)==null?void 0:te[0].premium)==null?void 0:$.toLocaleString)==null?void 0:ne.call($)),1)]),ut]),u("div",dt,[c(P,{block:"",type:"primary",onClick:ie},{default:l(()=>[it]),_:1})])]),f(H)?(_(),L(qe,{key:1,modelValue:f(v).currentAddress,"onUpdate:modelValue":e[13]||(e[13]=o=>f(v).currentAddress=o),show:f(H),"data-source":f(v).addressList,onSubmit:le,onClose:e[14]||(e[14]=o=>f(y)(!1))},null,8,["modelValue","show","data-source"])):Y("",!0)]}),_:1})}}});export{_t as default};
