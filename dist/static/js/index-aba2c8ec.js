import{i as e,aa as a,P as t,r as o,k as s,l as i,m as l,n,p as r,t as u,s as c,H as d,M as p,C as v,F as y,B as m,G as C,T as g}from"./vendor-86ac9d42.js";import{l as f}from"./inform-279e43d0.js";import{_ as k,g as b,n as j,N as q,b as h}from"./index-0db00022.js";import{Q as N,a as T,H as I,b as D,I as P,c as _}from"./notice-a4a1c218.js";import{s as x}from"./useStorage-0f596e31.js";import{g as S}from"./verify-ec7b813b.js";const $={class:"footer-button"},A=C("下一步");var B=k(e({setup(e){const C=a(),k=t(),{productCode:B="MMBBSF",agentCode:M="65434444",tenantId:O=9991000007,agencyCode:F="3311222",insurerCode:H="zhongan",productCategory:z=1,templateId:G=1,orderNo:L="2022080217103534947"}=k.query,Q=o([]),U=o({});o(!1);const W=o([]),w=o([]),E=e=>Q.value.filter((a=>a.objectType===e)),J=e=>{var a;x.set("questionData",e),C.push({path:"/healthNotice",query:{materialType:(null==e?void 0:e.materialSource)?"product":"question",questionnaireType:(null==e?void 0:e.materialSource)?1:e.questionnaireType,orderId:null==(a=U.value)?void 0:a.id,...k.query}})},K=()=>{[...W.value,...w.value,...Q.value].every((e=>1===e.isDone))?(Object.assign(U.value,{pageCode:"questionNotice",tenantOrderNoticeList:Q.value}),j({...U.value,extInfo:{...U.value.extInfo,pageCode:"questionNotice",buttonCode:q.questionNotice},venderCode:H}).then((({code:e,data:a})=>{"10000"===e&&"jumpToPage"===a.pageAction.pageAction&&C.push({path:h[a.pageAction.data.nextPageCode],query:k.query})}))):g("请完成所有告知进行下一步")};return s((()=>{(()=>{const e={insurerCode:H,orderNo:L,productCategory:z,tenantId:O};Promise.all([f({...e,noticeType:I,objectType:D}),f({...e,noticeType:P,objectType:_})]).then((([{code:e,data:a},{code:t,data:o}])=>{"10000"===e&&"10000"===t&&(Q.value=[...a,...o])}))})(),(()=>{const e={orderNo:L,productCode:B,tenantId:O,objectType:D};S({...e}).then((({code:e,data:a})=>{"10000"===e&&(w.value=a||[])})),S({...e,objectType:_}).then((({code:e,data:a})=>{"10000"===e&&(W.value=a||[])}))})(),b({orderNo:L,saleUserId:M,tenantId:O}).then((({code:e,data:a})=>{"10000"===e&&Object.assign(U.value,a)}))})),(e,a)=>{const t=i("van-cell"),o=i("ProCard"),s=i("van-button"),C=i("ProPageWrap");return l(),n(C,{class:"page-question-notice"},{default:r((()=>[u(o,{title:"投保人"},{default:r((()=>[(l(!0),c(y,null,d(E(v(T)),(e=>(l(),n(t,{key:e.id,class:p({"is-active":e.isDone===v(N)}),title:`《${e.title}》`,"is-link":"",value:""+(e.isDone===v(T)?"已完成":"去完成"),onClick:a=>J(e)},null,8,["class","title","value","onClick"])))),128)),(l(!0),c(y,null,d(w.value,(e=>(l(),n(t,{key:e.id,class:p({"is-active":e.isDone===v(N)}),title:`《${e.materialName}》`,"is-link":"",value:""+(e.isDone===v(T)?"已完成":"去完成"),onClick:a=>J(e)},null,8,["class","title","value","onClick"])))),128))])),_:1}),u(o,{title:"被保人"},{default:r((()=>[(l(!0),c(y,null,d(E(v(N)),(e=>(l(),n(t,{key:e.id,class:p({"is-active":e.isDone===v(N)}),title:`《${e.title}》`,"is-link":"",value:""+(e.isDone===v(T)?"已完成":"去完成"),onClick:a=>J(e)},null,8,["class","title","value","onClick"])))),128)),(l(!0),c(y,null,d(W.value,(e=>(l(),n(t,{key:e.id,class:p({"is-active":e.isDone===v(N)}),title:`《${e.materialName}》`,"is-link":"",value:""+(e.isDone===v(T)?"已完成":"去完成"),onClick:a=>J(e)},null,8,["class","title","value","onClick"])))),128))])),_:1}),m("div",$,[u(s,{type:"primary",onClick:K},{default:r((()=>[A])),_:1})])])),_:1})}}}),[["__scopeId","data-v-946bddbc"]]);export{B as default};
