var Le=Object.defineProperty,Ce=Object.defineProperties;var Ae=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,ge=Object.prototype.propertyIsEnumerable;var ue=(m,i,d)=>i in m?Le(m,i,{enumerable:!0,configurable:!0,writable:!0,value:d}):m[i]=d,x=(m,i)=>{for(var d in i||(i={}))Be.call(i,d)&&ue(m,d,i[d]);if(se)for(var d of se(i))ge.call(i,d)&&ue(m,d,i[d]);return m},Y=(m,i)=>Ce(m,Ae(i));import{g as ce,E as C,_ as Z,r as p,j as _,k as N,m as l,z as u,p as c,n as X,G as fe,J as k,F as me,C as S,ak as De,O as he,Q as Pe,M as Re,y as Te,o as be,A as f,t as K,d as ie,T as xe}from"./vendor-e057bbeb.js";import{_ as Fe,z as Ne,w as ke,r as Ve,Q as M,R as F,n as He,P as Se}from"./index-b27b8fa7.js";import{p as Ue}from"./trial-1c56f2c3.js";import{f as de,g as le,h as je}from"./trial-151e503c.js";import{u as $e}from"./useDicData-a9c72496.js";import{_ as oe,R as Ye,B as Me,a as we}from"./index-630dd00a.js";const qe={class:"com-select-container"},Ge={class:"radio-item-wrapper"},ze={class:"name"},Je={class:"hone"},Qe={class:"address"},We={class:"footer-button"},Ke=S("\u53D6\u6D88"),Xe=S("\u786E\u8BA4"),Ze=ce({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(m,{emit:i}){const d=m,D=C(d.modelValue),w=C(d.show),ee=()=>{i("submit",D.value),w.value=!1},te=()=>{i("close")};return Z(()=>d.modelValue,U=>{console.log("newVal",U),D.value=U}),Z(()=>D.value,U=>{i("update:modelValue",U)}),(U,V)=>{const q=p("van-radio"),Q=p("van-radio-group"),W=p("VanButton");return _(),N(Ne,{show:w.value,"onUpdate:show":V[1]||(V[1]=I=>w.value=I),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:te},{default:l(()=>[u("div",qe,[c(Q,{modelValue:D.value,"onUpdate:modelValue":V[0]||(V[0]=I=>D.value=I)},{default:l(()=>[(_(!0),X(me,null,fe(m.dataSource,(I,t)=>(_(),N(q,{key:t,name:t+1,class:"radio-item"},{default:l(()=>[u("div",Ge,[u("p",null,[u("span",ze,k(I.contactName),1),u("span",Je,k(I.contactPhoneNo),1)]),u("p",Qe,k(I.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),u("div",We,[c(W,{plain:"",type:"primary"},{default:l(()=>[Ke]),_:1}),c(W,{type:"primary",onClick:ee},{default:l(()=>[Xe]),_:1})])]),_:1},8,["show"])}}});var et=Fe(Ze,[["__scopeId","data-v-9c6de82e"]]);const tt={key:0,class:"beneficiary-part"},nt={class:"part-title"},rt={class:"title"},ot=S("\u5220\u9664"),at=S("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),st=S("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),ut={class:"radio-item-wrapper"},it={class:"name"},dt={class:"hone"},lt={class:"address"},ct={class:"footer-button"},ft={class:"left"},mt={class:"trial-result"},pt=S(" \u9996\u671F"),It={class:"result-num"},vt=u("div",{class:"result-desc"},"\u5B9E\u9645\u4FDD\u8D39\u4EE5\u540E\u7EED\u4E3A\u51C6",-1),_t={class:"operate-btn"},Ot=S("\u4E0B\u4E00\u6B65"),Dt=ce({setup(m){const i=De(),d=he(),{templateId:D=1,orderNo:w="2022072710380711215",productCode:ee,tenantId:te="9991000007",proposalId:U}=d.query,[V,q]=Pe(),Q=d.path==="/infoPreview"?"infoPreview":"infoCollection",W=$e("NATIONAL_REGION_CODE"),I=C({}),t=C({extInfo:{pageCode:Q},tenantOrderHolder:{extInfo:{occupationCodeList:[]},holderType:1},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),ne=C(null),h=C([]),j=C([]),G=C([]),re=C([]),ae=C([]),O=Re({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),z=Te(()=>{var n,e;return O.currentAddress?O.addressList[O.currentAddress-1]||{}:((e=(n=t.value.extInfo)==null?void 0:n.contactInfo)==null?void 0:e[0])||{}}),pe=n=>{const e={};return n.map(a=>{const{initialAmount:o,annuityDrawFrequency:s,annuityDrawType:P,paymentFrequency:R,paymentPeriod:E,paymentPeriodType:A,insurancePeriodType:B,insurancePeriodValue:g,riskCode:T,riskType:y,initialPremium:$,liabilityDetails:H,extInfo:L}=a,{riskId:b,copy:r}=L,v={amount:o,annuityDrawDate:s,annuityDrawType:P,paymentFrequency:R,riskId:b,copy:r,chargePeriod:E?`${de[A]}_${E}`:de[A],coveragePeriod:g?`${le[B]}_${g}`:le[B],riskCode:T,riskType:y,premium:$,liabilityVOList:H};return y===je.mainRisk?(e.mainRiskCode=T,e.mainRiskId=b):Object.assign(v,e),v})},Ie=()=>{var e;const n=x({},t.value);n.extInfo=Y(x({},n.extInfo),{contactInfo:[z.value]}),n.tenantOrderAttachmentList=[{category:M.OBVERSE_CERT,objectType:F.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:h.value[0],id:G.value[0]},{category:M.REVERSE_CERT,objectType:F.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:h.value[1],id:G.value[1]},{category:M.OBVERSE_CERT,objectType:F.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:j.value[0]||h.value[0],id:re.value[1]},{category:M.REVERSE_CERT,objectType:F.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:j.value[1]||h.value[1],id:re.value[1]}],(e=ne.value)==null||e.validate().then(a=>{if(n.tenantOrderInsuredList[0].insuredBeneficiaryType===we.SPECIFY){const o={};if(n.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.forEach(s=>{o[s.benefitOrder]?o[s.benefitOrder].sum+=Number(s.benefitRate):o[s.benefitOrder]={sum:Number(s.benefitRate)}}),Object.values(o).some(s=>s.sum!==100)){xe.fail("\u540C\u4E00\u987A\u4F4D\u7684\u53D7\u76CA\u4EBA\u6BD4\u4F8B\u4E4B\u548C\u5FC5\u987B\u4E3A100");return}}He(n).then(({code:o,data:s})=>{o==="10000"&&s.pageAction.pageAction==="jumpToPage"&&i.push({path:Se[s.pageAction.data.nextPageCode],query:d.query})})})},ve=()=>{var n;(n=ne.value)==null||n.validate().then(()=>{const{birthday:e,gender:a,extInfo:o}=t.value.tenantOrderHolder,{hasSocialInsurance:s,occupationCodeList:P}=o,{birthday:R,gender:E,extInfo:A,tenantOrderProductList:B}=t.value.tenantOrderInsuredList[0],{hasSocialInsurance:g,occupationCodeList:T}=A,y={holder:{personVO:{birthday:ie(e).format("YYYY-MM-DD"),gender:a,socialFlag:s,occupationCodeList:P}},productCode:ee,insuredVOList:[{insuredCode:"",personVO:{birthday:ie(R).format("YYYY-MM-DD"),gender:E,socialFlag:g,occupationCodeList:T},productPlanVOList:[{insurerCode:"",planCode:"",riskVOList:pe(B[0].tenantOrderRiskList)}]}]};Ue(x({},y)).then(({code:$,data:H})=>{if($==="10000"){const L={},b=(r=[])=>{(r||[]).forEach(v=>{var J;L[v.riskCode]=v,((J=v.riskPremiumDetailVOList)==null?void 0:J.length)&&b(v.riskPremiumDetailVOList)})};b(H.riskPremiumDetailVOList),t.value.tenantOrderInsuredList[0].tenantOrderProductList[0]=Y(x({},t.value.tenantOrderInsuredList[0].tenantOrderProductList[0]),{premium:H.premium,tenantOrderRiskList:t.value.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantOrderRiskList.map(r=>Y(x({},r),{initialAmount:L[r.riskCode].amount,initialPremium:L[r.riskCode].premium}))}),Ie()}})})},_e=n=>{console.log("value",n)},Oe=()=>{O.beneficiaryId+=1,t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:O.beneficiaryId,extInfo:{}})},ye=n=>{t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(e=>e.beneficiaryId!==n.beneficiaryId||n.id!==e.id)},Ee=()=>{Ve({orderNo:w,tenantId:te}).then(({code:n,data:e})=>{if(n==="10000"){const a=e;a.extInfo=Y(x({},a.extInfo),{pageCode:Q,templateId:D}),a.tenantOrderHolder=a.tenantOrderHolder||{holderType:1},a.tenantOrderHolder.extInfo=a.tenantOrderHolder.extInfo||{occupationCodeList:[]},a.tenantOrderInsuredList[0].extInfo=a.tenantOrderInsuredList[0].extInfo||{occupationCodeList:[]},a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{const s=o;return s.extInfo=s.extInfo||{occupationCodeList:[]},s}),a.tenantOrderAttachmentList.forEach(o=>{o.category===M.OBVERSE_CERT?o.objectType===F.HOLDER?(h.value[0]=o.uri,G.value[0]=o.id):o.objectType===F.INSURED&&(j.value[0]=o.uri,re.value[0]=o.id):o.category===M.REVERSE_CERT&&(o.objectType===F.HOLDER?(h.value[1]=o.uri,G.value[1]=o.id):o.objectType===F.INSURED&&(j.value[1]=o.uri,G.value[1]=o.id))}),Object.assign(t.value,a)}}).finally(()=>{O.isLoading=!1})};return be(()=>{Ee(),ke({pageCode:"infoCollection",templateId:D}).then(({code:n,data:e})=>{if(n==="10000"){const a={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(o=>{(a[o.moduleType]=a[o.moduleType]||[]).push(o)}),I.value=a}})}),Z(()=>t.value,n=>{var e,a,o,s,P,R,E,A,B,g;if(n){const T=[{contactAddress:(a=(e=n.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:a.familyAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(s=(o=n.tenantOrderHolder)==null?void 0:o.extInfo)==null?void 0:s.workAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(R=(P=n.tenantOrderInsuredList[0])==null?void 0:P.extInfo)==null?void 0:R.familyAddress,contactName:(E=n.tenantOrderInsuredList[0])==null?void 0:E.name,contactPhoneNo:(A=n.tenantOrderInsuredList[0])==null?void 0:A.mobile},{contactAddress:(g=(B=n.tenantOrderInsuredList[0])==null?void 0:B.extInfo)==null?void 0:g.workAddress,contactName:n.tenantOrderInsuredList[0].name,contactPhoneNo:n.tenantOrderInsuredList[0].mobile}];O.addressList=T.filter(y=>y.contactAddress&&y.contactName&&y.contactPhoneNo)}},{deep:!0,immediate:!0}),Z(()=>t.value.tenantOrderInsuredList[0].relationToHolder,n=>{+n==1&&Object.assign(t.value.tenantOrderInsuredList[0],t.value.tenantOrderHolder,{id:t.value.tenantOrderInsuredList[0].id,extInfo:Y(x({},t.value.tenantOrderHolder.extInfo),{insureProvinceCode:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,insureCityCode:t.value.tenantOrderInsuredList[0].extInfo.insureCityCode,insureAreaCode:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode})})},{deep:!0,immediate:!0}),(n,e)=>{const a=p("ProCard"),o=p("ProRadioButton"),s=p("ProField"),P=p("ProCascader"),R=p("ProSvg"),E=p("VanButton"),A=p("ProCheckButton"),B=p("van-cell"),g=p("ProForm"),T=p("ProPageWrap");return _(),N(T,{class:"page-info-wrapper"},{default:l(()=>{var y,$,H,L,b;return[f(O).isLoading?K("",!0):(_(),N(g,{key:0,ref_key:"formRef",ref:ne},{default:l(()=>[c(a,{title:"\u6295\u4FDD\u4EBA"},{default:l(()=>[c(oe,{images:h.value,"onUpdate:images":e[0]||(e[0]=r=>h.value=r),"form-info":t.value.tenantOrderHolder,"factor-list":I.value.HOLDER,prefix:"holder"},null,8,["images","form-info","factor-list"])]),_:1}),c(a,{title:"\u88AB\u4FDD\u4EBA"},{default:l(()=>[c(s,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.tenantOrderInsuredList[0].relationToHolder=r),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:l(()=>[c(o,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.tenantOrderInsuredList[0].relationToHolder=r),options:f(Ye)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+t.value.tenantOrderInsuredList[0].relationToHolder!=1?(_(),N(oe,{key:0,images:j.value,"onUpdate:images":e[3]||(e[3]=r=>j.value=r),"form-info":t.value.tenantOrderInsuredList[0],"factor-list":I.value.INSURER||[],prefix:"insure"},null,8,["images","form-info","factor-list"])):K("",!0),c(P,{modelValue:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:modelValue":e[4]||(e[4]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=r),field1:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":e[5]||(e[5]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=r),field2:t.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":e[6]||(e[6]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureCityCode=r),field3:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":e[7]||(e[7]=r=>t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=r),label:"\u6295\u4FDD\u5730\u533A",name:"insureAreaCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:"","data-source":f(W),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])]),_:1}),c(a,{title:"\u53D7\u76CA\u4EBA"},{default:l(()=>[c(s,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[9]||(e[9]=r=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=r),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:l(()=>[c(o,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[8]||(e[8]=r=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=r),options:f(Me)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),t.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(_(),X("div",tt,[(_(!0),X(me,null,fe(t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(r,v)=>(_(),X("div",{key:r.beneficiaryId||r.id,class:"beneficiary-item"},[u("div",nt,[u("span",rt,k(`\u53D7\u76CA\u4EBA${v+1}`),1),c(R,{name:"delete",onClick:J=>ye(r)},{default:l(()=>[ot]),_:2},1032,["onClick"])]),c(oe,{images:ae.value,"onUpdate:images":e[10]||(e[10]=J=>ae.value=J),"form-info":r,"factor-list":I.value.BENEFICIARY||[],prefix:`beneficiary-${v}`,"beneficiary-list":t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","beneficiary-list"])]))),128)),c(E,{onClick:Oe},{default:l(()=>[at]),_:1})])):K("",!0)]),_:1}),c(a,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:l(()=>{var r;return[((r=Object.keys(f(z)))==null?void 0:r.length)?(_(),N(B,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:e[12]||(e[12]=v=>f(q)(!0))},{title:l(()=>[u("div",ut,[u("p",null,[u("span",it,k(f(z).contactName),1),u("span",dt,k(f(z).contactPhoneNo),1)]),u("p",lt,k(f(z).contactAddress),1)])]),_:1})):(_(),N(A,{key:0,activated:"",onClick:e[11]||(e[11]=v=>f(q)(!0))},{default:l(()=>[st]),_:1}))]}),_:1})]),_:1},512)),u("div",ct,[u("div",ft,[u("div",mt,[pt,u("span",It,"\uFFE5"+k((b=(L=(H=($=(y=t.value.tenantOrderInsuredList)==null?void 0:y[0])==null?void 0:$.tenantOrderProductList)==null?void 0:H[0].premium)==null?void 0:L.toLocaleString)==null?void 0:b.call(L)),1)]),vt]),u("div",_t,[c(E,{block:"",type:"primary",onClick:ve},{default:l(()=>[Ot]),_:1})])]),f(V)?(_(),N(et,{key:1,modelValue:f(O).currentAddress,"onUpdate:modelValue":e[13]||(e[13]=r=>f(O).currentAddress=r),show:f(V),"data-source":f(O).addressList,onSubmit:_e,onClose:e[14]||(e[14]=r=>f(q)(!1))},null,8,["modelValue","show","data-source"])):K("",!0)]}),_:1})}}});export{Dt as default};
