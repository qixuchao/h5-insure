import{d as e,ay as a,az as s,i as t,h as o,j as r,l as i,o as d,c as n,b as l,w as u,u as c,y as p,aA as f}from"./index-e61895f6.js";import{q as m,s as I}from"./trial-b5a25ec6.js";import{u as v}from"./useOrder-e8857066.js";import{q as j}from"./createProposal-24f3c648.js";import"./utils-3dc73a93.js";import"./trial-4ffe2fc7.js";import"./PolicyInfo-5604d578.js";const y=e({name:"proposalToInsure"}),w=e({...y,setup(e){const y=a((()=>s((()=>import("./index-93f79581.js")),["static/js/index-93f79581.js","static/css/index-3515e551.css","static/js/index-e61895f6.js","static/css/index-c97e360a.css","static/js/product-5447249a.js","static/js/useThread-637a02aa.js"]))),w=t(),L=o(),h=v(),q=r(),{proposalId:_,productCode:g,tenantId:x,proposalInsuredId:C}=w.query,b=r(),z=async()=>{_&&j({id:_,tenantId:x}).then((({code:e,data:a})=>{if("10000"===e){const{holder:e,insuredList:s}=a,t=(g||"").split(",");Object.assign(h.value,{renewFlag:"",holder:e,tenantId:x,proposalId:_,insuredList:(s||[]).filter((e=>e.id===+C)).map((e=>({...e,relationToHolder:null,productList:e.productList.filter((e=>t.includes(e.productCode)))})))}),(async()=>{h.value.extInfo&&(h.value.extInfo.iseeBizNo=b.value);const{code:e,data:a}=await I(h.value);"10000"===e&&(q.value=a)})()}}))},O=()=>{q.value&&L.push({path:p.questionNotice,query:{...w.query,orderNo:q.value}})};return i((()=>{_||(async()=>{var e;const{code:a,data:s}=await m({calcProductFactorList:[{productCode:g}]});"10000"===a&&Object.assign(h.value,s,{insuredList:[{...null==(e=s.insuredList)?void 0:e[0]}]})})(),z(),setTimeout((async()=>{b.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const s=f;return d(),n("div",null,[l(s,null,{default:u((()=>[l(c(y),{"product-detail":{insurerCode:"lianlife"},onClose:O})])),_:1})])}}});export{w as default};
