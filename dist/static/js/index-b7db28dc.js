import{_ as e,d as a,A as t,a8 as r,b as o,c as l,e as n,w as s,i as d,a9 as i,l as u,r as c,H as I,y as A,g as v,F as p,h as m,n as f,t as g,C,j as D,L as h,M as S,$ as E,u as O,a as w,b8 as T,z as P,f as x,a0 as G,aZ as b}from"./index-98540450.js";import{p as y}from"./product-8c231aa5.js";import{q as k,a as L,g as U,i as V}from"./trial-ae2ac84a.js";import{P as Q}from"./index-329859a3.js";import{a as Y}from"./trial-ddddb1ca.js";import{c as M}from"./utils-8c47d456.js";import{u as N,s as R}from"./core-3b008d60.js";import{a as B}from"./order-a06f54cc.js";import{u as W}from"./theme-40e4e415.js";import{s as j}from"./useStorage-d17b34cb.js";import{O as z}from"./infoCollection-fd6576eb.js";import"./pdfdist-c1c6a344.js";import"./index-a2996b75.js";const H={class:"pro-curtain"},K=["src"];var q=e(a({props:{show:{type:Boolean,default:!0}},emits:["close"],setup(e,{emit:a}){const c=e,I=t({show:c.show});return r((()=>c.show),(()=>{I.show=c.show}),{immediate:!0}),(e,t)=>{const r=o("van-overlay");return l(),n(r,{show:u(I).show},{default:s((()=>[d("div",H,[i(e.$slots,"default",{},void 0,!0),d("img",{class:"close",src:u("data:image/png;base64,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"),onClick:t[0]||(t[0]=e=>a("close"))},null,8,K)])])),_:3},8,["show"])}}}),[["__scopeId","data-v-4c1ecdfa"]]);const F={class:"guarantee-list"},J=(e=>(h("data-v-cb90a938"),e=e(),S(),e))((()=>d("div",{class:"title"},"保障内容",-1))),Z=["src"];var X=e(a({props:{dataSource:{type:Array,default:()=>[]},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:10}},setup(e){const a=e,t=c(a.dataSource||[]),[s,i]=I(!1),h=A((()=>{var e;return!(!t.value||!(null==(e=t.value)?void 0:e.length))&&(t.value.length>a.count&&(!!a.isShowClose||!s.value))})),S=()=>{i()},E=A((()=>{var e;return t.value&&(null==(e=t.value)?void 0:e.length)?t.value.length<=a.count||s.value?t.value:t.value.slice(0,a.count):[]}));return r((()=>a.dataSource),(()=>{t.value=a.dataSource})),(e,a)=>{const t=o("ProCell");return l(),v("div",F,[J,(l(!0),v(p,null,m(u(E),((e,a)=>(l(),n(t,{key:a,title:e.title,content:e.desc,border:!1},null,8,["title","content"])))),128)),u(h)?(l(),v("div",{key:0,class:"show-more",onClick:S},[f(g(u(s)?"收起":"查看更多")+" ",1),d("img",{src:u("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAjNJREFUOE+1VEtPE1EUPufM9GXKCnWlqAQZuhEff8CNxpYdSReVatIWJMYI7FkYF+wtxsSCBWNLY4JhZxHd+AdMqhs6PmJJWMkPsO303mPmQs10GJuawOxu5tzvfK9chCP+8Ijx4HgAVyZGskgQEgIXJkvbO//D+sXtyDlN43mW8Du9Vp1VDPNJ4xkiRoC5DhKz6VJ1qxfQ/MTITUSeA8QgM29niuYDBbh6/XyQzwZmAPCWfUbmLdAb2dTLWt0LeDE6FOjr12YYMfp3freRTX2s1Ts8VBuJZwEwxBJ2SMDj1OtqzQn66u7gQIt9jwDwgq1IAixOFs137ZlDobgvMPPTzNrXTaUkcfEG6zTXbaFnyrakcL/+EBBi+5vlB2Cy2meW8j35mk+8LOlaG8VII9v0kA3LzA1gXmwz9vJXAS4njRQC+qnR2kivf99zDubigwO+gH8egbUWwsJUwfzp/L8SHzolA/o4Azeniubqfm3uGBlgPMMITSnE5r3St0ovtXmeHB7VkWLI4Afk3UzBzCvA3DXwkWHEiPCyqgFxxQqGy9NLnywvYHtejxhRALyiHJZckWGzPL0EVoeHzo3Mcs8i8eZ+4cevDgsSwydJwzgBngYAS0hRdio6FErOdYGkKKcOLFhOGJdQxzFbor2QmnLd7blnym5JguUXImohw1WVNsjP4kTfWy9LutZGMSIcQwT/gWzLyfiftemWqG2BT6NxZqYmtTbcnrrvHs972Evnep35AykjACSCRaPlAAAAAElFTkSuQmCC"),class:C(["icon",{showMore:u(s)}])},null,10,Z)])):D("",!0)])}}}),[["__scopeId","data-v-cb90a938"]]);const _=E([{value:B.PENDING,label:"待处理"},{value:B.PAYING,label:"订单未完成，逾期将失效"},{value:B.PAYMENT_SUCCESS,label:"支付成功"},{value:B.PAYMENT_FAILED,label:"支付失败"},{value:B.CANCELED,label:"已失效"},{value:B.ACCEPT_POLICY,label:"投保成功"},{value:B.INSURER_REJECT,label:"保司拒保"},{value:B.TIMEOUT,label:"订单已经关闭"},{value:B.UNDER_WRITING_SUCCESS,label:"核保通过"},{value:B.NOTE,label:"照会"},{value:B.INSURANCE_PROCESSING,label:"保司处理中"}]),$={[B.ACCEPT_POLICY]:"恭喜 您已成功购买保障",[B.CANCELED]:"赠险保单已失效",[B.PAYING]:"剩余支付时间：23:59:59",[B.TIMEOUT]:"请您重新提交订单"};const ee=e=>(h("data-v-9403972c"),e=e(),S(),e),ae={class:"page-pay-result"},te={class:"header"},re={class:"product-status"},oe=["innerHTML"],le={class:"prodouct-container"},ne={class:"product-card"},se={class:"product-name"},de={class:"label"},ie={class:"value"},ue={key:1,class:"desc"},ce=[f("已有"),ee((()=>d("span",null,"29,182",-1))),f("位用户已投保")],Ie=["src"],Ae=ee((()=>d("div",{class:"footer-desc"},[d("div",null,"客服电话"),d("div",null,"400 605 8000")],-1))),ve=["src"];var pe=e(a({setup(e){const a=W();O();const r=w(),{tenantId:i,from:I="other",orderNo:f,productCode:C,code:h,channelCode:S=""}=r.query,E=t({insureDetail:{},detail:{},orderDetail:{},showOrderDetail:!1,guaranteeItemVOS:[],pageInfo:{title:"",desc:"",insureList:[],productImage:"",notificationImage:""},timeDown:{},templateId:"2"}),H=c(!1),K=A((()=>[B.ACCEPT_POLICY,B.CANCELED,B.PAYMENT_SUCCESS].includes(E.orderDetail.orderStatus)?"下载保单":B.PAYING===E.orderDetail.orderStatus?"立即支付":B.TIMEOUT===E.orderDetail.orderStatus?"重下一单":"")),F=A((()=>S||E.orderDetail.extInfo.extraInfo.channelCode)),J=async(e=!1,a="")=>{var t,r,o,l;try{const{insurerCode:n}=E.insureDetail.productBasicInfoVO;delete E.orderDetail.extInfo.extraInfo.templateId;const s={insurerCode:n,productCode:e?null==(r=null==(t=E.insureDetail)?void 0:t.productBasicInfoVO)?void 0:r.upgradeGuaranteeConfigVO.productCode:C,tenantId:i,agencyCode:E.orderDetail.agencyId,agentCode:E.orderDetail.agentCode,saleChannelId:null==(l=null==(o=E.orderDetail.extInfo)?void 0:o.extraInfo)?void 0:l.saleChannelId,extraMap:{...E.orderDetail.extInfo.extraInfo,channelCode:F.value}};e&&(s.extraMap.promotion=a),delete s.extraMap.templateId;const d=await k(s);if("10000"===d.code){if(!e){const{tenantOrderHolder:e,tenantOrderInsuredList:a}=E.orderDetail;j.set(z,{tenantOrderHolder:e,tenantOrderInsuredList:a})}window.location.href=d.data||""}}catch(n){}},Z=async()=>{if("下载保单"===K.value){const e=`${E.orderDetail.extInfo.extraInfo.xinaoMyUrl}?code=${h}&state=STATE`;window.location.href=e}else"立即支付"===K.value?L({...E.orderDetail,extInfo:{...E.orderDetail.extInfo,redirectUrl:window.location.href}}).then((e=>{"10000"===e.code&&R(e.data.paymentUrl)})):"重下一单"===K.value&&J(!1)},ee=async()=>{const e=y({productCode:C,withInsureInfo:!0,tenantId:i}),a=U({orderNo:f,tenantId:i}),t=V({productCode:C});Promise.all([e,a,t]).then((([e,a,t])=>{"10000"===e.code&&(E.detail=e.data),"10000"===t.code&&(E.insureDetail=t.data),"10000"===a.code&&(E.orderDetail=a.data),(()=>{var e,a,t,r,o,l,n,s,d,i,u,c,A,v,p,m,f,g,C,D,h,S,O,w,T,P,x;[B.PAYMENT_SUCCESS,B.ACCEPT_POLICY].includes(E.orderDetail.orderStatus)&&(E.orderDetail.orderStatus=B.ACCEPT_POLICY),E.pageInfo.title=_[E.orderDetail.orderStatus],E.pageInfo.desc=$[E.orderDetail.orderStatus],document.title=(null==(a=null==(e=E.detail)?void 0:e.tenantProductInsureVO)?void 0:a.productName)||"";let y="";if("free"===I?E.orderDetail.tenantOrderInsuredList[0].tenantOrderProductList.forEach((e=>y?null:(e.tenantOrderRiskList.forEach((e=>{1!==e.riskType||y||(y=M(e.insurancePeriodValue,Y[e.insurancePeriodType]))})),!1))):(E.pageInfo.insureList=[{label:"本期缴费金额",value:`${E.orderDetail.orderAmount}元`}],y=`${G(E.orderDetail.commencementTime).format("YYYY.MM.DD")}到${G(E.orderDetail.expiryDate).format("YYYY.MM.DD")}`),E.pageInfo.insureList=[...E.pageInfo.insureList,{label:"被保人",value:null==(o=null==(r=null==(t=E.orderDetail)?void 0:t.tenantOrderInsuredList)?void 0:r[0])?void 0:o.name},{label:"保障期间",value:y||""}],E.templateId=E.orderDetail.extInfo.templateId,"free"!==I&&[B.PAYING,B.TIMEOUT].includes(E.orderDetail.orderStatus)?E.showOrderDetail=!0:(null==(n=null==(l=E.insureDetail)?void 0:l.productBasicInfoVO)?void 0:n.upgradeGuaranteeConfigVO.productCode)&&(E.pageInfo.notificationImage=(null==(u=null==(i=null==(d=null==(s=E.insureDetail)?void 0:s.productBasicInfoVO)?void 0:d.upgradeGuaranteeConfigVO)?void 0:i.notificationImage)?void 0:u[0])||"",E.pageInfo.productImage=(null==(p=null==(v=null==(A=null==(c=E.insureDetail)?void 0:c.productBasicInfoVO)?void 0:A.upgradeGuaranteeConfigVO)?void 0:v.productImage)?void 0:p[0])||"",H.value=!0),B.PAYING===E.orderDetail.orderStatus){const e=(null==(f=null==(m=E.orderDetail.tenantOrderPaymentInfoList)?void 0:m[0])?void 0:f.paymentExpiryDate)||G().add(8.5,"hour");E.timeDown=b({time:G(e).diff(new Date,"millisecond")}),E.timeDown.start()}try{const e=null==(g=E.orderDetail.tenantOrderInsuredList)?void 0:g[0].planCode;(null==(D=null==(C=E.detail)?void 0:C.tenantProductInsureVO)?void 0:D.planInsureVO)?E.guaranteeItemVOS=(null==(x=null==(P=null==(T=E.detail)?void 0:T.tenantProductInsureVO)?void 0:P.planInsureVO)?void 0:x.guaranteeItemVOS)||[]:E.guaranteeItemVOS=(null==(w=null==(O=null==(S=null==(h=E.detail)?void 0:h.tenantProductInsureVO)?void 0:S.planList.filter((a=>a.planCode===e)))?void 0:O[0])?void 0:w.guaranteeItemVOS)||[]}catch(k){}})()}))},pe=e=>{const a=`${e}`.length;let t="";for(let r=0;r<2-a;r++)t+="0";return t+e};T(window,"popstate",(e=>{window.history.pushState(null,"",document.URL),J(!0,"FHGGW")}));const me=A((()=>{var e;return B.PAYING===(null==(e=E.orderDetail)?void 0:e.orderStatus)?E.timeDown.current.total<=0?(E.orderDetail.orderStatus=B.TIMEOUT,E.pageInfo.title=_[E.orderDetail.orderStatus],E.pageInfo.desc=$[E.orderDetail.orderStatus],E.timeDown.pause(),E.pageInfo.desc):`剩余支付时间：${pe(E.timeDown.current.hours)}:${pe(E.timeDown.current.minutes)}:${pe(E.timeDown.current.seconds)}`:E.pageInfo.desc}));return N(),P((()=>{ee()})),(e,t)=>{const r=o("van-config-provider");return l(),n(r,{"theme-vars":u(a)},{default:s((()=>{var e,r;return[d("div",ae,[d("div",te,[d("div",re,g(u(E).pageInfo.title),1),"重下一单"!==u(K)||"3"!==u(E).templateId.toString()?(l(),v("div",{key:0,class:"desc",innerHTML:u(me)},null,8,oe)):D("",!0)]),d("div",le,[d("div",ne,[d("div",se,g((null==(r=null==(e=u(E).insureDetail)?void 0:e.productBasicInfoVO)?void 0:r.productName)||""),1),(l(!0),v(p,null,m(u(E).pageInfo.insureList,((e,a)=>(l(),v("div",{key:a,class:"list"},[d("span",de,g(e.label),1),d("span",ie,g(e.value),1)])))),128)),"重下一单"!==u(K)||"3"!==u(E).templateId.toString()?(l(),n(Q,{key:0,"theme-vars":u(a),class:"btn",text:u(K),onClick:Z},null,8,["theme-vars","text"])):D("",!0),u(E).showOrderDetail?(l(),v("div",ue,ce)):D("",!0)]),u(E).pageInfo.productImage?(l(),v("img",{key:0,class:"product-img",src:u(E).pageInfo.productImage,onClick:t[0]||(t[0]=e=>J(!0,"GDGGW"))},null,8,Ie)):D("",!0),u(E).showOrderDetail?(l(),n(X,{key:1,"is-show-close":"",count:5,"data-source":u(E).guaranteeItemVOS},null,8,["data-source"])):D("",!0),Ae])]),x(q,{show:H.value,"onUpdate:show":t[2]||(t[2]=e=>H.value=e),onClose:t[3]||(t[3]=e=>H.value=!1)},{default:s((()=>[d("img",{class:"jump-img",src:u(E).pageInfo.notificationImage,style:{display:"block"},onClick:t[1]||(t[1]=e=>J(!0,"TCGGW"))},null,8,ve)])),_:1},8,["show"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-9403972c"]]);export{pe as default};
