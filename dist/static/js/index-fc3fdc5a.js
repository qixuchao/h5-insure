import{B as t,d as e,j as s,D as o,C as a,Y as i,k as n,bZ as l,G as r,l as c,E as d,V as f,b as u,cs as p,R as h,J as g,ct as v,X as m,N as x,W as y,M as k,cu as C,cv as w,K as b,r as T,a6 as $,a2 as I,$ as O,cw as S,O as W,cx as z,H as P,ck as R,a1 as A}from"./index-17a4a20a.js";const[B,L]=t("index-bar"),j={sticky:h,zIndex:g,teleport:[String,Object],highlightColor:String,stickyOffsetTop:v(0),indexList:{type:Array,default:function(){const t="A".charCodeAt(0);return Array(26).fill("").map(((e,s)=>String.fromCharCode(t+s)))}}},E=Symbol(B);var H=e({name:B,props:j,emits:["select","change"],setup(t,{emit:e,slots:h}){const g=s(),v=s(),T=s(""),$=o(),I=a(g),{children:O,linkChildren:S}=i(E);let W;S({props:t});const z=n((()=>{if(l(t.zIndex))return{zIndex:+t.zIndex+1}})),P=n((()=>{if(t.highlightColor)return{color:t.highlightColor}})),R=(e,s)=>{for(let o=O.length-1;o>=0;o--){const a=o>0?s[o-1].height:0;if(e+(t.sticky?a+t.stickyOffsetTop:0)>=s[o].top)return o}return-1},A=t=>O.find((e=>String(e.index)===t)),B=()=>{if(m(g))return;const{sticky:e,indexList:s}=t,o=x(I.value),a=y(I),i=O.map((t=>t.getRect(I.value,a)));let n=-1;if(W){const t=A(W);if(t){const e=t.getRect(I.value,a);n=R(e.top,i)}}else n=R(o,i);T.value=s[n],e&&O.forEach(((e,s)=>{const{state:l,$el:r}=e;if(s===n||s===n-1){const t=r.getBoundingClientRect();l.left=t.left,l.width=t.width}else l.left=null,l.width=null;if(s===n)l.active=!0,l.top=Math.max(t.stickyOffsetTop,i[s].top-o)+a.top;else if(s===n-1&&""===W){const t=i[n].top-o;l.active=t>0,l.top=t+a.top-i[s].height}else l.active=!1})),W=""},j=()=>{k(B)};r("scroll",B,{target:I,passive:!0}),c(j),d((()=>t.indexList),j),d(T,(t=>{t&&e("change",t)}));const H=s=>{W=String(s);const o=A(W);if(o){const s=x(I.value),a=y(I),{offsetHeight:i}=document.documentElement;if(o.$el.scrollIntoView(),s===i-a.height)return void B();t.sticky&&t.stickyOffsetTop&&C(w()-t.stickyOffsetTop),e("select",o.index)}},M=t=>{const{index:e}=t.dataset;e&&H(e)},V=t=>{M(t.target)};let X;const D=()=>u("div",{ref:v,class:L("sidebar"),style:z.value,onClick:V,onTouchstartPassive:$.start},[t.indexList.map((t=>{const e=t===T.value;return u("span",{class:L("index",{active:e}),style:e?P.value:void 0,"data-index":t},[t])}))]);return f({scrollTo:H}),r("touchmove",(t=>{if($.move(t),$.isVertical()){b(t);const{clientX:e,clientY:s}=t.touches[0],o=document.elementFromPoint(e,s);if(o){const{index:t}=o.dataset;t&&X!==t&&(X=t,M(o))}}}),{target:v}),()=>{var e;return u("div",{ref:g,class:L()},[t.teleport?u(p,{to:t.teleport},{default:()=>[D()]}):D(),null==(e=h.default)?void 0:e.call(h)])}}});const[M,V]=t("index-anchor");const X=W(e({name:M,props:{index:g},setup(t,{slots:e}){const o=T({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),a=s(),{parent:i}=$(E);if(!i)return;const l=()=>o.active&&i.props.sticky,r=n((()=>{const{zIndex:t,highlightColor:e}=i.props;if(l())return I(O(t),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:e})}));return f({state:o,getRect:(t,e)=>{const s=y(a);return o.rect.height=s.height,t===window||t===document.body?o.rect.top=s.top+w():o.rect.top=s.top+x(t)-e.top,o.rect}}),()=>{const s=l();return u("div",{ref:a,style:{height:s?`${o.rect.height}px`:void 0}},[u("div",{style:r.value,class:[V({sticky:s}),{[S]:s}]},[e.default?e.default():t.index])])}}})),D=W(H),[F,N]=t("swipe-cell");const Y=W(e({name:F,props:{name:P(""),disabled:Boolean,leftWidth:g,rightWidth:g,beforeClose:Function,stopPropagation:Boolean},emits:["open","close","click"],setup(t,{emit:e,slots:a}){let i,c,d;const p=s(),h=s(),g=s(),v=T({offset:0,dragging:!1}),m=o(),x=t=>t.value?y(t).width:0,k=n((()=>l(t.leftWidth)?+t.leftWidth:x(h))),C=n((()=>l(t.rightWidth)?+t.rightWidth:x(g))),w=s=>{v.offset="left"===s?k.value:-C.value,i||(i=!0,e("open",{name:t.name,position:s}))},$=s=>{v.offset=0,i&&(i=!1,e("close",{name:t.name,position:s}))},I=e=>{t.disabled||(d=v.offset,m.start(e))},O=()=>{v.dragging&&(v.dragging=!1,(t=>{const e=Math.abs(v.offset),s=i?.85:.15,o="left"===t?k.value:C.value;o&&e>o*s?w(t):$(t)})(v.offset>0?"left":"right"),setTimeout((()=>{c=!1}),0))},S=(s="outside")=>{e("click",s),i&&!c&&A(t.beforeClose,{args:[{name:t.name,position:s}],done:()=>$(s)})},W=(t,e)=>s=>{e&&s.stopPropagation(),S(t)},P=(t,e)=>{const s=a[t];if(s)return u("div",{ref:e,class:N(t),onClick:W(t,!0)},[s()])};return f({open:w,close:$}),z(p,(()=>S("outside")),{eventName:"touchstart"}),r("touchmove",(e=>{if(t.disabled)return;const{deltaX:s}=m;if(m.move(e),m.isHorizontal()){c=!0,v.dragging=!0;(!i||s.value*d<0)&&b(e,t.stopPropagation),v.offset=R(s.value+d,-C.value,k.value)}}),{target:p}),()=>{var t;const e={transform:`translate3d(${v.offset}px, 0, 0)`,transitionDuration:v.dragging?"0s":".6s"};return u("div",{ref:p,class:N(),onClick:W("cell",c),onTouchstartPassive:I,onTouchend:O,onTouchcancel:O},[u("div",{class:N("wrapper"),style:e},[P("left",h),null==(t=a.default)?void 0:t.call(a),P("right",g)])])}}}));export{X as I,Y as S,D as a};
