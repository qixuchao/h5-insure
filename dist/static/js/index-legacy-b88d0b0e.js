!function(){var e=document.createElement("style");e.innerHTML='.page-trial-wrapper[data-v-67d6b9f9]{background-color:var(--zaui-global-bg, #f2f5fc)}.page-trial-wrapper .part-card[data-v-67d6b9f9]{background-color:#fff;margin-bottom:.26667rem}.page-trial-wrapper .risk-content[data-v-67d6b9f9] .van-collapse-item__title--expanded{padding:0 .4rem 0 0;display:flex;align-items:center}.page-trial-wrapper .risk-content[data-v-67d6b9f9] .van-collapse-item__content{padding:0}.page-trial-wrapper .plan-risk[data-v-67d6b9f9] .van-tabs__line{display:none}.page-trial-wrapper .plan-risk[data-v-67d6b9f9] .van-tabs .van-tabs__wrap{height:auto}.page-trial-wrapper .plan-risk[data-v-67d6b9f9] .van-tabs .van-tabs__wrap .van-tabs__nav--line{padding:.30667rem 0}.page-trial-wrapper .footer-bar[data-v-67d6b9f9]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4;z-index:2}.page-trial-wrapper .footer-bar .trial-result[data-v-67d6b9f9]{width:5.86667rem;font-size:.45333rem;font-weight:400;color:var(--zaui-text, #393d46)}.page-trial-wrapper .footer-bar .trial-result .result-num[data-v-67d6b9f9]{color:var(--zaui-price, #ff5840);font-size:.45333rem;font-weight:500;margin-left:.21333rem}.page-trial-wrapper .footer-bar .trial-operate button[data-v-67d6b9f9]{width:3.73333rem}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip[data-v-67d6b9f9]{position:absolute;z-index:122;height:.56rem;border-radius:1.33333rem;background-color:var(--zaui-price, #ff5840);font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC,sans-serif;font-weight:400;color:#fff;line-height:.49333rem;padding:.04rem .28rem .02667rem .26667rem;right:.4rem;top:-.46667rem;display:flex;align-items:center}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip .close-icon[data-v-67d6b9f9]{margin-left:.17333rem;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYBAMAAAASWSDLAAAAFVBMVEUAAAD///////////////////////9Iz20EAAAABnRSTlMAqvDQjzGyGyePAAAAZElEQVQY01WQsRHAMAgDSeL0rlLnLgvkMoFHyAo02n8Eny0VFoUBPweIMDu/xqA8fxxIJhfe2IE64g24owBJgDbfOkGGnL7oBYgIhAiEBIQEPPEyNfDWNtTXsUVNgokz2X6Q1TpVESf7Ckv8GQAAAABJRU5ErkJggg==);background-repeat:no-repeat;background-size:contain;width:.24rem;height:.24rem}.page-trial-wrapper .footer-bar .trial-operate .retrial-tip[data-v-67d6b9f9]:after{content:" ";position:absolute;z-index:11;width:0;height:0;border:.13333rem solid transparent;border-top:.13333rem solid #ff5840;border-right:.13333rem solid #ff5840;right:.49333rem;bottom:-.16rem}\n',document.head.appendChild(e),System.register(["./index-legacy-c3cd4036.js","./index-legacy-0cfe96b9.js","./trial-legacy-38734377.js","./createProposal-legacy-174e6679.js","./useStorage-legacy-7901d0c5.js","./trial-legacy-1104cc07.js","./pdfh5-legacy-9f98dc45.js","./useDicData-legacy-8a523723.js"],(function(e){"use strict";var a,r,t,i,n,o,s,l,d,c,p,u,f,g,m,k,y,b,v,h,C,I,P,A,V,L,O,_,w,D,R,T,B,F,N;return{setters:[function(e){a=e._,r=e.d,t=e.u,i=e.a,n=e.r,o=e.z,s=e.az,l=e.ac,d=e.an,c=e.b,p=e.c,u=e.e,f=e.w,g=e.g,m=e.h,k=e.f,y=e.k,b=e.j,v=e.F,h=e.i,C=e.n,I=e.t,P=e.C,A=e.N,V=e.D,L=e.am,O=e.M},function(e){_=e.P,w=e.a},function(e){D=e.i,R=e.p},function(e){T=e.c},function(e){B=e.u},function(e){F=e.b,N=e.a},function(){},function(){}],execute:function(){const x={key:0,class:"part-card"},j={key:1,class:"part-card"},E={class:"risk-content"},z={key:0,class:"risk"},S={key:1,class:"plan-risk"},M={class:"footer-bar van-safe-area-bottom"},U={class:"trial-result"},q={class:"result-num"},Q={class:"trial-operate"},G={key:0,class:"retrial-tip"},J=r({__name:"index",setup(e){const a=t(),r=i(),{agentCode:J="test",agencyCode:H="",tenantId:Y=9991000007,insurerCode:W="99",proposalId:K,saleChannelId:X}=r.query;let{productCode:Z="MMBBSF",templateId:$=1}=r.query;const ee=n({personVO:{occupationCodeList:[]}}),ae=n({insuredCode:"",personVO:{occupationCodeList:[]}}),re=n({}),te=n({}),ie=n({}),ne=n(null),oe=n({}),se=o({currentPlan:"",riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,enumList:{},ageRange:[],collapseName:["1"],insuredRiskList:[],currentRiskList:[]});K&&(Z=(r.query||{})?.productCenterCode),s("premium",oe.value),B().get("userInfo");const le=()=>{se.retrialTip=!1},de=()=>{P({agencyId:H,saleUserId:J,saleChannelId:X,tenantId:Y,venderCode:se.riskBaseInfo.insurerCode,orderDataSource:1,proposalId:K,extInfo:{templateId:+($||1),pageCode:"premiumTrial",iseeBizNo:window.iseeBiz,buttonCode:A.premiumTrial},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{extInfo:{},tenantOrderProductList:[{productCode:se.riskBaseInfo.productCode||"",productName:se.riskBaseInfo.productName||"",premium:se.trialResult.premium||0,tenantOrderRiskList:se.insuredRiskList}]}]}).then((({code:e,data:t})=>{"10000"===e&&"jumpToPage"===t.pageAction.pageAction&&a.push({path:V[t.pageAction.data.nextPageCode],query:{insurerCode:se.riskBaseInfo.insurerCode,templateId:$,...r.query,productCategory:se.riskBaseInfo.productCategory,orderNo:t.pageAction.data.orderNo}})}))},ce=()=>{const e=JSON.parse(JSON.stringify(re.value[se.currentPlan])),a=Object.values(e).find((e=>1===e.riskType)),r=Object.values(e).map((e=>{const r=e;return((e,a)=>{const r=e;if("3"===r.chargePeriod){const e=(a.chargePeriod||"").split("_");if(e[1]-=1,1===r.exemptFlag){if("to"===e[0]){let a=0;1===r.exemptType?ee.value.personVO?.birthday&&(a=parseInt(""+(+new Date-new Date(ee.value.personVO?.birthday))/31536e6,10)):2===r.exemptType&&ae.value.personVO?.birthday&&(a=parseInt(""+(+new Date-new Date(ae.value.personVO?.birthday))/31536e6,10)),e[1]=e[1]-a}e[0]="year",r.coveragePeriod=e.join("_")}r.chargePeriod=e.join("_")}})(r,a),r.liabilityVOList=(r.liabilityVOList||[]).filter((e=>1===e.optionalFlag||e.liabilityAttributeValue&&"-1"!==e.liabilityAttributeValue)).map((e=>{const a=e;return"0"===a.liabilityAttributeValue&&(a.liabilityAttributeValue=""),a})),r})),t={holder:ee.value,productCode:se.riskBaseInfo.productCode,insuredVOList:[{...ae.value,productPlanVOList:[{planCode:se.currentPlan||"",insurerCode:se.riskBaseInfo.insurerCode,riskVOList:r}]}]};R({...t}).then((({code:e,data:a})=>{if("10000"===e){se.retrialTip=!1,se.trialResult=a,se.canTrial=!1;const e={},r=(a=[])=>{(a||[]).forEach((a=>{e[a.riskCode]=a,a.riskPremiumDetailVOList?.length&&r(a.riskPremiumDetailVOList)}))};r(a.riskPremiumDetailVOList),((e,a)=>{se.insuredRiskList=e.map((e=>({initialAmount:a[e.riskCode]?.amount,amountUnit:1,annuityDrawFrequency:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,paymentFrequency:e.paymentFrequency,paymentPeriod:e.chargePeriod.split("_")[1],paymentPeriodType:F[e.chargePeriod.split("_")[0]],insurancePeriodType:N["to_life"===e.coveragePeriod?"to_life":e.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+e.coveragePeriod.split("_")[1])?0:e.coveragePeriod.split("_")[1],riskCode:e.riskCode,riskType:e.riskType,riskName:e.riskName,extInfo:{riskId:e.riskId,copy:e.copy},initialPremium:a[e.riskCode]?.premium,liabilityDetails:e.liabilityVOList.map((e=>({liabilityCode:e.liabilityCode,liabilityName:e.liabilityName,refundMethod:e.liabilityAttributeValue}))),productId:se.riskBaseInfo.id})))})(t.insuredVOList[0].productPlanVOList[0].riskVOList,e),Object.assign(oe.value,e)}}))},pe=()=>{Promise.all([te.value?.validateForm?.(),ie.value?.validateForm?.(),ne.value?.validate()]).then((()=>{ce()}),(e=>{e?.length&&ne?.value?.scrollToField(e[0].name)}))},ue=()=>{D({productCode:Z,source:K?2:1}).then((({code:e,data:a})=>{var r,t,i;"10000"===e&&(se.riskBaseInfo=a.productBasicInfoVO,(a.productRelationPlanVOList.length?a.productRelationPlanVOList:a.productRiskVoList[0].riskDetailVOList||[]).forEach(((e,a)=>{0===a&&(se.currentPlan=e.planCode||"0"),K||Object.assign(re.value,{[e.planCode||a]:{}})})),K&&(t=se.riskBaseInfo.productCategory,i=se.riskBaseInfo.insurerCode,O({productCategory:t,venderCode:i}).then((e=>{"10000"===e.code&&($=e.data?.id)}))),se.riskData=a.productRiskVoList[0]?.riskDetailVOList||[],se.riskPlanData=a.productRelationPlanVOList||[],K&&(r=a.productBasicInfoVO.id,T({id:K,tenantId:Y}).then((({code:e,data:a})=>{if("10000"===e){const{proposalInsuredProductList:e=[],...t}=a.proposalInsuredList?.[0]||{};Object.assign(ee.value.personVO,a.proposalHolder);const i=e.find((e=>e.productId===r));Object.assign(ae.value.personVO,t,{occupationCodeList:i?.occupationCodeList||[]});const n={};(i?.proposalProductRiskList||[]).forEach((e=>{n[e.riskId]=e})),Object.assign(re.value,{0:n})}}))))})).finally((()=>{}))},fe=e=>{se.holderFactor=e.holderFactorList,se.insuredFactor=e.insuredFactorList,se.ageRange=e.ageRange};return l([()=>re.value,()=>ee.value,()=>ae.value],(e=>{e&&!se.canTrial&&(se.canTrial=!0,se.retrialTip=!0)}),{deep:!0}),d((()=>{ue(),L({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then((({code:e,data:a})=>{if("10000"===e){const e={};a.forEach((a=>{e[a.dictCode]=a.dictItemList})),se.enumList=e}}))})),(e,a)=>{const r=c("ProTitle"),t=c("VanForm"),i=c("ProTabButton"),n=c("VanTab"),o=c("VanTabs"),s=c("van-collapse-item"),l=c("van-collapse"),d=c("VanButton"),P=c("ProPageWrap");return p(),u(P,{class:"page-trial-wrapper"},{default:f((()=>[g(se).holderFactor.length?(p(),m("div",x,[k(r,{title:"投保人"}),k(_,{ref_key:"holderRef",ref:te,"insured-code":g(se).riskBaseInfo?.insurerCode,"form-info":g(ee).personVO,"factor-list":g(se).holderFactor,"age-range":g(se).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):y("",!0),g(se).insuredFactor.length?(p(),m("div",j,[k(r,{title:"被保人"}),k(_,{ref_key:"insuredRef",ref:ie,"insured-code":g(se).riskBaseInfo?.insurerCode,"form-info":g(ae).personVO,"factor-list":g(se).insuredFactor,"age-range":g(se).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):y("",!0),b("div",E,[k(l,{modelValue:g(se).collapseName,"onUpdate:modelValue":a[1]||(a[1]=e=>g(se).collapseName=e)},{default:f((()=>[k(s,{name:"1"},{title:f((()=>[k(r,{title:"投保方案"})])),default:f((()=>[g(se).riskData.length&&g(re)[0]?(p(),m("div",z,[k(t,{ref_key:"riskFormRef",ref:ne,"input-align":"right","error-message-align":"right"},{default:f((()=>[k(w,{"risk-info":g(re)[0],enums:g(se).enumList,"origin-data":g(se).riskData,"pick-factor":fe},null,8,["risk-info","enums","origin-data"])])),_:1},512)])):y("",!0),g(se).riskPlanData.length?(p(),m("div",S,[k(t,{ref_key:"riskFormRef",ref:ne,"input-align":"right","error-message-align":"right"},{default:f((()=>[k(o,{active:g(se).currentPlan,"onUpdate:active":a[0]||(a[0]=e=>g(se).currentPlan=e)},{default:f((()=>[(p(!0),m(v,null,h(g(se).riskPlanData,(e=>(p(),u(n,{key:e.planCode,name:e.planCode,title:e.planName},{title:f((()=>[k(i,{title:e.planName,active:g(se).currentPlan===e.planCode},null,8,["title","active"])])),default:f((()=>[e.planCode===g(se).currentPlan?(p(),u(w,{key:0,"risk-info":g(re)[e.planCode],enums:g(se).enumList,"origin-data":e.productRiskVoList?.[0].riskDetailVOList,"pick-factor":fe},null,8,["risk-info","enums","origin-data"])):y("",!0)])),_:2},1032,["name","title"])))),128))])),_:1},8,["active"])])),_:1},512)])):y("",!0)])),_:1})])),_:1},8,["modelValue"])]),b("div",M,[b("span",U,[C("总保费"),b("span",q,I((g(se).retrialTip?0:g(se).trialResult?.premium||0).toLocaleString("hanidec",{style:"currency",currency:"CNY"})),1)]),b("div",Q,[g(se).retrialTip?(p(),m("div",G,[C(" 条件更改后，需要重新试算 "),b("span",{class:"close-icon",onClick:le})])):y("",!0),g(se).canTrial?(p(),u(d,{key:1,type:"primary",onClick:pe},{default:f((()=>[C("去试算")])),_:1})):(p(),u(d,{key:2,type:"primary",onClick:de},{default:f((()=>[C("立即投保")])),_:1}))])])])),_:1})}}});e("default",a(J,[["__scopeId","data-v-67d6b9f9"]]))}}}))}();
