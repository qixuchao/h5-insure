import{d as e,S as a,E as t,c as l,g as n,f as r,w as o,F as s,h as i,e as d,m as c,n as u,t as p,V as v,L as m,j as f,i as h,l as g,ao as y,at as A,a as I,r as b,bY as O,bZ as x,u as k,J as C,am as L,b6 as _,a8 as T,b$ as w,aD as E,H as P,ag as D,G as S,bR as R,c0 as j,T as N,ai as H,c7 as V,c1 as B}from"./index-dae3ff12.js";import{i as F,b as U,p as q,g as M}from"./trial-b645c7f1.js";import{b as G,c as z}from"./product-9a4e8498.js";import{n as Q}from"./nextStep-5228da78.js";import{g as J,I as W,S as Y,O as Z,l as $}from"./infoCollection-89fc213f.js";import{u as K}from"./useAddressList-5ab6f95e.js";import{r as X,v as ee,g as ae,t as te}from"./utils-97e71bd2.js";import{_ as le}from"./index-335629ec.js";import{u as ne,G as re,_ as oe,a as se}from"./useAttachment-7d97d239.js";import{P as ie}from"./index-5fb5ba6d.js";import{s as de,c as ce}from"./phoneVerify-67c19407.js";import"./ProAddress.vue_vue_type_style_index_0_scoped_true_lang-13173ab9.js";import{c as ue,t as pe,_ as ve}from"./index-79a47d57.js";import"./trial-75f9914d.js";import"./pdfh5-008ca364.js";import"./core-c1dea51b.js";import"./constant-c3f28a3b.js";import"./index-6f81a24b.js";import"./keysIn-b3061da8.js";import"./isObjectLike-d00d103b.js";const me={class:"refueling-package-com"},fe=h("div",{class:"title"},"åŠ æ²¹åŒ…",-1),he=e({props:{packageProductList:{type:Array,default:()=>[]},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:3}},setup(e){const h=e,[I,b]=a(!1),O=t((()=>h.packageProductList.length>h.count&&(!!h.isShowClose||!I.value))),x=()=>{b()},k=t((()=>h.packageProductList.length<=h.count||I.value?h.packageProductList:h.packageProductList.slice(0,h.count)));return(e,a)=>{const t=g,h=y,b=A;return l(),n("div",me,[fe,r(b,{ref:"formRef"},{default:o((()=>[(l(!0),n(s,null,i(c(k),((e,a)=>(l(),d(h,{key:`${e.value}_${a}`,modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,label:e.packageName,required:"",placeholder:"è¯·é€‰æ‹©"},{input:o((()=>[r(t,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:c(J),disabled:e.disabled},null,8,["modelValue","onUpdate:modelValue","options","disabled"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"])))),128)),c(O)?(l(),n("div",{key:0,class:"show-more",onClick:x},[u(p(c(I)?"æ”¶èµ·":"æŸ¥çœ‹æ›´å¤š")+" ",1),r(v,{name:"down",class:m(["icon",{showMore:c(I)}])},null,8,["class"])])):f("",!0)])),_:1},512)])}}});const ge={key:0},ye=[h("div",{class:"__skeleton_short_content__"},[h("div",{class:"van-config-provider sk",style:{"--van-primary-color":"#0d6efe","--van-primary-color-light8":"#0d6efe80","--van-primary-color-light1":"#0d6efe10","--van-primary-color-light2":"#0d6efe20","--van-danger-color":"#FF3C10","--van-primary-background-color":"#0d6efe20","--van-button-primary-background-color":"#0d6efe","--van-button-primary-border-color":"#0d6efe","--van-checkbox-checked-bg-color":"#0d6efe10","--van-switch-on-background-color":"#0d6efe","--van-toast-default-padding":"14px","--van-linear-bg":"linear-gradient(to right, #0d6efe, rgba(13,150,254,1))","--van-popup-close-icon-margin":"20px","--van-popup-round-border-radius":"20px","--van-card-title":"#0d6efe","--van-card-cell-color":"#0d6efe80","--van-radio-checked-icon-color":"#0d6efe","--van-pro-check-radius":"40px"}},[h("div",{class:"page-internet-product-detail"},[h("div",{class:"info"},[h("div",{class:"van-image banner",style:{width:"100%",height:"223px"},src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},[h("img",{class:"van-image__img","data-src":"https://zatech-aquarius-v2-private-test.oss-cn-hangzhou.aliyuncs.com/common/20221222/e3719801cf6546449e18e06f3bbe8416/%E5%B0%8A%E4%BA%ABe%E7%94%9F.png?Expires=1676527379&OSSAccessKeyId=LTAI5t9uBW78vZ4sm5i3oQ5C&Signature=tkscLe6oOZYjnRIA%2B7AiMS3bOs0%3D",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",lazy:"loaded",style:{background:"rgb(238, 238, 238)"}})]),h("div")]),h("div",{class:"guarantee-list"},[h("div",{class:"header"},[h("span",null,[h("span",{class:"sk-text",style:{"--fp":"14.86%","--sp":"85.14%","--lh":"18.4999px"}},"ä¿éšœè®¡åˆ’")]),h("span",null,[h("span",{class:"sk-text",style:{"--fp":"14.86%","--sp":"85.14%","--lh":"18.4999px"}},"æŸ¥çœ‹è¯¦æƒ…")])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"ä¸€èˆ¬åŒ»ç–—ä¿é™©é‡‘")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜300ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"é‡å¤§ç–¾ç—…åŒ»ç–—ä¿é™©é‡‘")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜600ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æ¶æ€§è‚¿ç˜¤è´¨å­é‡ç¦»å­åŒ»ç–—")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜600ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æ¶æ€§è‚¿ç˜¤é™¢å¤–ç‰¹å®šè¯å“è´¹ç”¨åŒ»ç–—")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜600ä¸‡")])])]),h("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[h("div",{class:"cell-container"},[h("div",{class:"left-part large"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æ¶æ€§è‚¿ç˜¤ç‰¹å®šå™¨æ¢°è€—æè´¹ç”¨åŒ»ç–—è´£ä»» ï¼ˆé€‚ç”¨äºå¥³æ€§è¢«ä¿é™©äººï¼‰")]),h("div",{class:"divider"}),h("div",{class:"right-part"},[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"æœ€é«˜100ä¸‡")])])]),h("div",{class:"show-more"},[h("span",{class:"sk-text",style:{"--fp":"14.29%","--sp":"85.71%","--lh":"16.799999999999997px"}},"æŸ¥çœ‹æ›´å¤š "),h("svg",{class:"svg-icon icon-arrow-down-dobule icon icon"},[h("use",{"xlink:href":"#icon-arrow-down-dobule"})])]),h("div",{class:"feerate-view sk-border"},[h("span",null,[h("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"142.00å…ƒ/å¹´èµ·")])])]),h("div",{class:"com-divider"}),h("div",{class:"tabs",sticky:"",scrollspy:""},[h("div",null,[h("div",{class:"van-sticky"},[h("div",{class:"van-tabs"},[h("div",{id:"tab-list",class:"tab-list"},[h("a",{class:"tab-title active",title:"äº§å“äº®ç‚¹"},[h("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"äº§å“äº®ç‚¹")]),h("a",{class:"tab-title",title:"ç†èµ”è¯´æ˜"},[h("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"ç†èµ”è¯´æ˜")]),h("a",{class:"tab-title",title:"æˆ‘è¦æŠ•ä¿"},[h("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"æˆ‘è¦æŠ•ä¿")])])])])]),h("div",{class:"tab-content"},[h("div",{id:"tab1"},[h("div",{class:"spec"},[h("div",{class:"van-image detail-img",style:{width:"100%"}},[h("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",class:"van-image__img",style:{background:"rgb(238, 238, 238)"}})])])])])])])])],-1)],Ae=["theme-vars"],Ie={class:"info"},be={class:"custom-page-form"},Oe=h("div",{class:"form-title"},"è¯·å¡«å†™æŠ•ä¿ä¿¡æ¯",-1),xe=u("ç«‹å³æŠ•ä¿"),ke=h("div",{id:"xinaoDialog"},null,-1),Ce=e({setup(e){const a=O((()=>j((()=>import("./index-8a2782e3.js")),["static/js/index-8a2782e3.js","static/css/index-ea588f10.css","static/js/index-dae3ff12.js","static/css/index-f8c43e72.css","static/js/pdfh5-008ca364.js","static/js/theme-65292714.js","static/js/index-6f81a24b.js","static/css/index-85f26bb0.css","static/js/utils-97e71bd2.js","static/js/infoCollection-89fc213f.js","static/js/trial-75f9914d.js"]))),u=O((()=>j((()=>import("./index-d79f9b67.js")),["static/js/index-d79f9b67.js","static/css/index-c743ae40.css","static/js/index-dae3ff12.js","static/css/index-f8c43e72.css","static/js/pdfh5-008ca364.js","static/js/theme-65292714.js"]))),p=O((()=>j((()=>import("./index-e2065963.js")),["static/js/index-e2065963.js","static/css/index-713c61ca.css","static/js/index-dae3ff12.js","static/css/index-f8c43e72.css","static/js/pdfh5-008ca364.js","static/js/infoCollection-89fc213f.js","static/js/trial-75f9914d.js"]))),v=O((()=>j((()=>import("./index-c3d44ed2.js")),["static/js/index-c3d44ed2.js","static/css/index-fcfc6922.css","static/js/index-dae3ff12.js","static/css/index-f8c43e72.css","static/js/pdfh5-008ca364.js"]))),m=O((()=>j((()=>import("./index-29cfee5c.js")),["static/js/index-29cfee5c.js","static/css/index-b9ba3011.css","static/js/index-dae3ff12.js","static/css/index-f8c43e72.css","static/js/pdfh5-008ca364.js"]))),g=x();k();const y=I(),{productCode:A="",tenantId:J,agentCode:me="",agencyCode:fe,saleChannelId:Ce,extraInfo:Le,insurerCode:_e,preview:Te}=y.query;let we={};try{console.log("extInfo",decodeURIComponent(Le)),we=JSON.parse(decodeURIComponent(Le))}catch(La){}const{openId:Ee}=we;b();const Pe=b(),De=b(),Se=b(!1),Re=b({}),je=b({}),Ne=b(!1),He=b(!1),Ve=b(0),Be=b(!1),Fe=b({}),Ue=b({}),qe=b(!0),Me=b(!0),Ge=b(!0),ze=b(""),Qe=b([]);b({});const Je=b({}),We=b({}),Ye=b([]),Ze=b(),$e=b(),Ke=C({holder:{formData:{},schema:[],trialFactorCodes:[],config:{name:{},verificationCode:{sendSMSCode:async({mobile:e},a)=>{const t=await de(e),{code:l}=t;"10000"===l&&"function"==typeof a&&a()}},certType:{},certNo:{},occupation:{dictCode:ue(_e)}}},insuredList:[{formData:{},schema:[],trialFactorCodes:[],config:{relationToHolder:{label:""},certNo:{}}}]});Ee&&K({openId:Ee},(e=>{Ue.value=e}));const Xe=b({imgUrl:"",desc:"",title:"",link:window.location.href}),ea=(e=>{const{tenantId:a,agentCode:t="",agencyCode:l,saleChannelId:n,extraInfo:r,insurerCode:o}=I().query;let s={};try{s=JSON.parse(decodeURIComponent(r))}catch(La){}const i=b({agencyId:l,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"",pageCode:"",iseeBizNo:"",extraInfo:{}},orderCategory:1,saleUserId:t,saleChannelId:n,tenantId:a,venderCode:o,tenantOrderHolder:{extInfo:{occupationCodeList:[]}},tenantOrderInsuredList:[{relationToHolder:"1",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{extInfo:{}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",subjectNo:"",tenantId:a}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}});return"[object Object]"==={}.toString.call(e)&&Object.assign(i.value,e),i})({extInfo:{buttonCode:"EVENT_SHORT_saveOrder",pageCode:"productInfo",extraInfo:we,templateId:(null==we?void 0:we.templateId)||"1",iseeBizNo:""}}),aa=b({}),ta=t((()=>!!Te)),la=b([]),na=b(),ra=async()=>{G({productCode:A,tenantId:J,isTenant:!Te}).then((({data:e,code:a})=>{if("10000"===a){Re.value=e,document.title=e.BASIC_INFO.title||"";const{title:a,desc:l,image:n}=(null==e?void 0:e.PRODUCT_LIST.wxShareConfig)||{};t={title:a,desc:l,image:n},Xe.value={desc:t.desc||"ä½ å¥½ï¼Œè¿™é‡Œæ˜¯æè¿°",imgUrl:t.image,title:t.title,link:window.location.href}}var t})),await F({productCode:A,isTenant:!Te}).then((({data:e,code:a})=>{var t;"10000"===a&&(Be.value=!0,je.value=e,Je.value=null==(t=e.productPlanInsureVOList)?void 0:t[0],Ye.value=(e.productPlanInsureVOList||[]).filter((e=>e.planCode)).map((e=>({planName:e.planName,planCode:e.planCode}))))})),Ge.value=!1,z({productCode:A}).then((({code:e,data:a})=>{var t,l,n,r;if("10000"===e){const{productMaterialPlanVOList:e,productQuestionnaireVOList:o}=a;na.value=e||[];const{basicInfo:{questionnaireType:s},questions:i,questionnaireName:d}=(null==(t=null==o?void 0:o[0])?void 0:t.questionnaireDetailResponseVO)||{basicInfo:{}};2===s&&(la.value=[{attachmentName:d,attachmentUri:i,attachmentType:"question"}]),la.value=[{attachmentName:d,attachmentUri:null==(l=null==i?void 0:i[0])?void 0:l.content,attachmentType:ae(String(null==(n=null==i?void 0:i[0])?void 0:n.textType),null==(r=null==i?void 0:i[0])?void 0:r.content)}]}}))},oa=t((()=>{if(Ue.value){const e=[];return Object.keys(Ue.value).forEach((a=>{e.push(...Ue.value[a])})),e}return[]})),sa=t((()=>oa.value.length>0)),ia=b([]),da=e=>{console.log("currentPlanObj.value",e,Je.value)};L((()=>aa.value.planCode),(e=>{Je.value=(je.value.productPlanInsureVOList||[]).find((a=>a.planCode===e))}));const ca=()=>{Pe.value.handleClickTab()("tab3")},ua=b(""),pa=b(0),va=async()=>{try{await Q(((e={},a={},t={})=>{var l;const n={...t},r={tenantId:J,riskList:(null==(l=n.tenantOrderInsuredList[0])?void 0:l.tenantOrderProductList[0].riskVOList)||[],riskPremium:a,productId:e.id};return n.extInfo.iseeBizNo=ze.value,n.productCode=e.productCode,n.commencementTime=n.insuranceStartDate,n.expiryDate=n.insuranceEndDate,n.tenantOrderHolder={...n.tenantOrderHolder,certType:n.tenantOrderHolder.certType||D.CERT,certNo:(n.tenantOrderHolder.certNo||"").toLocaleUpperCase(),extInfo:{...n.tenantOrderHolder.extInfo}},n.tenantOrderInsuredList=n.tenantOrderInsuredList.map((e=>({...e,certType:e.certType||D.CERT,certNo:(e.certNo||"").toLocaleUpperCase(),planCode:Je.value.planCode,extInfo:{...e.extInfo}}))),n.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:pa.value,productCode:e.productCode,productName:e.productName,planCode:Je.value.planCode,tenantOrderRiskList:te(r)},n})(je.value,Fe.value,ea.value),(async(e,a)=>{a===B.JUMP_PAGE&&(null==e?void 0:e.orderNo)&&await(async e=>{try{const{code:a,data:t}=await M({orderNo:e,tenantId:J});"10000"===a&&(t.extInfo={...t.extInfo,buttonCode:"EVENT_SHORT_underWrite"},await Q(t))}catch(La){}})(null==e?void 0:e.orderNo)}))}catch(La){}},{fileList:ma,mustReadFileCount:fa,popupFileList:ha}=ne(Je,na),ga=e=>{Ve.value=e,He.value=!0},ya=async(e,a,t=!0)=>{var l;const{chargePeriod:n,coveragePeriod:r,paymentFrequency:o,insuranceEndDate:s,insuranceStartDate:i}=aa.value;ua.value="ä¿è´¹è¯•ç®—ä¸­...";const d=X(a).map((e=>({...e,paymentFrequency:o,chargePeriod:n,coveragePeriod:r}))),{tenantOrderHolder:c,tenantOrderInsuredList:u}=ea.value,p={tenantId:J,productCode:e.productCode,insuranceStartDate:i,insuranceEndDate:s,holder:{personVO:{...c,socialFlag:null==(l=c.extInfo)?void 0:l.hasSocialInsurance,certType:c.certType||D.CERT}},insuredVOList:u.map((e=>({insuredCode:"",relationToHolder:e.relationToHolder,personVO:{...e,socialFlag:e.extInfo.hasSocialInsurance,certType:e.certType||D.CERT},productPlanVOList:[{insurerCode:_e,planCode:Je.value.planCode,riskVOList:d}]})))},{code:v,message:m}=await U(p);if("10000"===v){const{code:e,data:a}=await q(p);if("10000"===e){if(ua.value="",ea.value.tenantOrderInsuredList[0].tenantOrderProductList=p.insuredVOList[0].productPlanVOList,pa.value=null==a?void 0:a.premium,ea.value.premium=a.premium,ea.value.orderAmount=a.premium,ea.value.orderRealAmount=a.premium,ea.value.insuranceStartDate=p.insuranceStartDate,ea.value.insuranceEndDate=p.insuranceEndDate,!t){const e={};a.riskPremiumDetailVOList&&a.riskPremiumDetailVOList.length&&a.riskPremiumDetailVOList.forEach((a=>{e[a.riskCode]={premium:a.premium,amount:a.amount}})),Fe.value=e,ha.value.length>0?(qe.value=!1,ga(0)):la.value.length>0?Ne.value=!0:await va()}}else ua.value=""}else ua.value="",N(m)},Aa=()=>{const e=[];return Qe.value.filter((e=>e.value===W.INSURE)).forEach((a=>{e.push(...a.productRiskVoList)})),e},Ia=async()=>{var e,a;try{Ne.value=!1,He.value=!1,Ze.value&&$e.value&&Promise.all([null==(e=Ze.value)?void 0:e.validate(),null==(a=$e.value)?void 0:a[0].validate()]).then((async()=>{var e;if(sa.value)await ya(je.value,[...ia.value,...Aa()],!1);else{const a=null==(e=ea.value.tenantOrderHolder)?void 0:e.verificationCode;if(!ee(a))return void N({message:"è¯·è¾“å…¥æ­£ç¡®çš„éªŒè¯ç "});const{code:t,data:l}=await ce(ea.value.tenantOrderHolder.mobile,a);"10000"===t&&await ya(je.value,[...ia.value,...Aa()],!1)}})).catch((()=>{const e=document.querySelector(".form-title");e&&e.scrollIntoView()}))}catch(t){}},ba=e=>{"allFalse"===e?(Ne.value=!1,va()):H.confirm({className:"xinao-custom-dialog",title:"æç¤º",teleport:"#xinaoDialog",message:"è¢«ä¿äººä¸ç¬¦åˆå¥åº·è¦æ±‚ï¼Œå¾ˆæŠ±æ­‰æš‚æ—¶æ— æ³•æŠ•ä¿è¯¥äº§å“",confirmButtonText:"é€‰é”™äº†",cancelButtonText:"ä¸ºå…¶ä»–äººæŠ•ä¿"}).then((()=>{})).catch((()=>{Ne.value=!1}))},Oa=()=>{He.value=!1,qe.value=!0,la.value.length<1?va():Ne.value=!0},xa=()=>{Ne.value=!1,He.value=!1,qe.value=!0};L((()=>ea.value.tenantOrderInsuredList[0].relationToHolder),((e,a)=>{e!==a&&Qe.value&&Qe.value.forEach((e=>{e.value=W.UN_INSURE})),Me.value=!1,_((()=>{const{certType:e,extInfo:a}=ea.value.tenantOrderInsuredList[0];a&&!a.hasSocialInsurance&&(ea.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance=Y.HAS),Me.value=!0}))}),{deep:!0,immediate:!0}),L([()=>Ke.holder.formData,()=>Ke.insuredList],(([e,a])=>{Object.assign(ea.value,(({holder:e,insuredList:a=[]})=>{const t=["birthday","certEndDate","certEndType","certNo","certStartDate","verificationCode","certType","email","gender","mobile","name","id","insuredBeneficiaryType","relationToHolder","relationToMainInsured"],l=e=>{const a={extInfo:{}};return"[object Object]"==={}.toString.call(e)&&Object.keys(e).forEach((l=>{t.includes(l)?a[l]=e[l]:a.extInfo[l]=e[l]})),a};return{tenantOrderHolder:l(e),tenantOrderInsuredList:(a||[]).map((e=>l(e)))}})({holder:e,insuredList:a.map((e=>e.formData))}))}),{deep:!0});const ka=(e,a)=>e.find((e=>!a[e])),Ca=async()=>{const{trialFactorCodes:e,formData:a}=Ke.holder,{trialFactorCodes:t,formData:l}=Ke.insuredList[0];return new Promise(((n,r)=>{!ka(e,a)&&!ka(t,l)&&Ze.value&&$e.value?Promise.all([Ze.value.validate(e),$e.value[0].validate(t)]).then((()=>{n(!0)})).catch((()=>{r()})):r()}))};return L((()=>[...Ke.holder.trialFactorCodes.map((e=>Ke.holder.formData[e])),...Ke.insuredList.reduce(((e,a,t)=>(e.push(...a.trialFactorCodes.map((e=>Ke.insuredList[t].formData[e]))),e)),[]),aa.value.paymentFrequency,Qe.value]),((...e)=>{ta.value||Ca().then((()=>{ya(je.value,[...ia.value,...Aa()])})).catch((()=>{Ca().then((()=>{ua.value="ä¿è´¹è¯•ç®—ä¸­..."}))}))}),{deep:!0}),L((()=>Ke.holder.formData),((...e)=>{Ke.insuredList.forEach(((e,a)=>{const{formData:t,schema:l}=e||{};"1"===t.relationToHolder&&Object.assign(e.formData,Ke.holder.formData)}))}),{deep:!0,immediate:!0}),L((()=>Je.value),(()=>{let{productFactor:e}=Je.value;const{oilPackageProductVOList:a,planCode:t,insureProductRiskVOList:l}=Je.value;sa.value&&e[1]&&(e=e[1].filter((e=>"verificationCode"!==e.code))),aa.value.planCode=t,ia.value=l,We.value=(l||[]).find((e=>e.mainRiskFlag===T.YES)),console.log("mainRiskInfo.value",We.value),Qe.value=(a||[]).map((e=>({...e,value:W.UN_INSURE})));const[n,r,o]=pe(e);Ke.holder={...Ke.holder,...n},Ke.insuredList[0]={...Ke.insuredList[0],...r}}),{deep:!0,immediate:!0}),L((()=>Ke.insuredList.map(((e,a)=>Ke.insuredList[a].formData.relationToHolder))),((e,a)=>{console.log("%cğŸ”¥ ä¸æŠ•ä¿äººå…³ç³»å˜åŠ¨äº†","color:#1989fa;background:#5e4;padding:3px 5px;"),Ke.insuredList.forEach(((e,a)=>{const{formData:t,schema:l,config:n}=e||{},r="1"===t.relationToHolder,o="3"===t.relationToHolder;n.certNo.label="èº«ä»½è¯å·"+(o?"(æˆ·å£ç°¿)":""),e.schema.forEach((e=>{e.relationToHolder=t.relationToHolder,e.hidden=!e.isSelfInsuredNeed&&r})),r?Object.assign(e.formData,{...Ke.insuredList[a].formData,...Ke.holder.formData}):Object.assign(e.formData,{...Object.keys(e.formData).reduce(((e,a)=>(e[a]="",e)),{}),relationToHolder:t.relationToHolder})}))}),{immediate:!0,deep:!0}),_((()=>{w(De,(([{isIntersecting:e}],a)=>{Se.value=!e}))})),E((()=>{var e;const a=P.get(Z);if(a){const{tenantOrderHolder:t,tenantOrderInsuredList:l}=a;if(t&&(ea.value.tenantOrderHolder={...t,certType:t.certType||D.CERT}),Array(l)&&l[0]){const a=l[0]||{};if(ea.value.activePlanCode=a.planCode,a.tenantOrderProductListtenantOrderProductList&&a.tenantOrderProductList[0]&&a.tenantOrderProductList[0].tenantOrderRiskList){const t=null==(e=a.tenantOrderProductList[0].tenantOrderRiskList)?void 0:e.find((e=>"1"===String(e.riskType)));t&&(ea.value.paymentFrequency=(null==t?void 0:t.paymentFrequency)?String(null==t?void 0:t.paymentFrequency):$.SINGLE)}}}})),S((()=>{Ge.value=!0,ra(),setTimeout((async()=>{ze.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),R((()=>{P.remove(Z)})),(e,t)=>{var y,A,I,b,O,x,k,C,L,_;const T=V;return l(),n(s,null,[Ge.value?(l(),n("div",ge,ye)):(l(),n("div",{key:1,"data-skeleton-root":"SHORT","theme-vars":c(g),class:"page-internet-product-detail"},[h("div",Ie,[(null==(A=null==(y=Re.value)?void 0:y.BASIC_INFO)?void 0:A.banner.length)?(l(),d(le,{key:0,"data-skeleton-type":"img",url:null==(I=Re.value)?void 0:I.BASIC_INFO.banner[0]},null,8,["url"])):f("",!0),(null==(x=null==(O=null==(b=Re.value)?void 0:b.BASIC_INFO)?void 0:O.bannerMove)?void 0:x.length)?(l(),d(le,{key:1,url:null==(L=null==(C=null==(k=Re.value)?void 0:k.BASIC_INFO)?void 0:C.bannerMove)?void 0:L[0],onClick:ca},null,8,["url"])):f("",!0),h("div",{ref_key:"observeRef",ref:De},null,512)]),(null==(_=Re.value)?void 0:_.GUARANTEE)?(l(),d(re,{key:0,"show-service-config":"","data-source":Re.value,"plan-list":Ye.value},null,8,["data-source","plan-list"])):f("",!0),r(oe,{ref_key:"detailScrollRef",ref:Pe,"order-detail":c(ea),"data-source":Re.value},{form:o((()=>[h("div",be,[Oe,r(c(ve),{ref_key:"holderFormRef",ref:Ze,title:"æœ¬äººä¿¡æ¯ï¼ˆæŠ•ä¿äººï¼‰",model:c(Ke).holder.formData,schema:c(Ke).holder.schema,config:c(Ke).holder.config},null,8,["model","schema","config"]),(l(!0),n(s,null,i(c(Ke).insuredList,((e,a)=>(l(),d(c(ve),{ref_for:!0,ref_key:"insuredFormRef",ref:$e,key:a,title:"ä¸ºè°æŠ•ä¿ï¼ˆè¢«ä¿äººï¼‰",model:c(Ke).insuredList[a].formData,schema:e.schema,config:e.config},null,8,["model","schema","config"])))),128))]),r(c(p),{"form-info":aa.value,"risk-info":We.value,"tenant-product-detail":Re.value.PREMIUM,"plan-list":Ye.value,"premium-info":{premium:pa.value,premiumLoadingText:ua.value},onUpdateActivePlan:da},null,8,["form-info","risk-info","tenant-product-detail","plan-list","premium-info"]),Qe.value.length>0?(l(),d(he,{key:0,"package-product-list":Qe.value},null,8,["package-product-list"])):f("",!0)])),_:1},8,["order-detail","data-source"]),r(T,null,{default:o((()=>{var e,a,t;return[(null==(e=Re.value.SIGNATURE)?void 0:e.inscribedContent)?(l(),d(c(v),{key:0,"inscribed-content":null==(t=null==(a=Re.value)?void 0:a.SIGNATURE)?void 0:t.inscribedContent},null,8,["inscribed-content"])):f("",!0)]})),_:1}),r(T,null,{default:o((()=>{var e;return[(null==(e=c(ma))?void 0:e.length)?(l(),d(c(m),{key:0,"attachement-list":c(ma),"pre-text":"è¯·é˜…è¯»",onPreviewFile:t[0]||(t[0]=e=>ga(e))},null,8,["attachement-list"])):f("",!0)]})),_:1}),Se.value?(l(),d(se,{key:1,"is-share":Re.value.PRODUCT_LIST.showWXShare,premium:pa.value,"share-info":Xe.value,"loading-text":ua.value,"plan-code":aa.value.planCode,"payment-frequency":aa.value.paymentFrequency,"tenant-product-detail":Re.value,onClick:Ia},{default:o((()=>[xe])),_:1},8,["is-share","premium","share-info","loading-text","plan-code","payment-frequency","tenant-product-detail"])):f("",!0)],8,Ae)),Be.value?(l(),d(ie,{key:2,"product-detail":Re.value},null,8,["product-detail"])):f("",!0),ke,r(c(u),{show:Ne.value,"onUpdate:show":t[1]||(t[1]=e=>Ne.value=e),"content-list":la.value,"active-index":0,onOnConfirmHealth:ba,onOnCloseHealthByMask:xa},null,8,["show","content-list"]),He.value?(l(),d(c(a),{key:3,show:He.value,"onUpdate:show":t[2]||(t[2]=e=>He.value=e),"content-list":qe.value?c(ma):c(ha),"is-only-view":qe.value,"active-index":Ve.value,text:qe.value?"å…³é—­":"æˆ‘å·²é€é¡µé˜…è¯»å¹¶ç¡®è®¤å‘ŠçŸ¥å†…å®¹","force-read-cound":qe.value?0:c(fa),onSubmit:Oa,onOnCloseFilePreviewByMask:xa},null,8,["show","content-list","is-only-view","active-index","text","force-read-cound"])):f("",!0)],64)}}});export{Ce as default};
