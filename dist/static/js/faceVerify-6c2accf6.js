import{_ as e,d as a,i as t,h as o,j as s,k as r,l as i,m as l,o as c,p as d,w as n,a as u,u as p,b as f,v as m,ar as b,aC as v,aD as y,cM as j,dG as C,aQ as N,cL as g}from"./index-aaa8bb0a.js";import{g as I}from"./trial-f688ef19.js";import{u as T}from"./useOrder-3b64102a.js";import{f as h}from"./face_img-b678980a.js";import{P as _}from"./constants-b39aa53b.js";import{n as w}from"./nextStep-db1051c0.js";import{T as x}from"./infoCollection-88d162d3.js";import"./core-182586d6.js";const P=e=>(v("data-v-2358aba4"),e=e(),y(),e),z={class:"page-phone-verify"},E=P((()=>u("div",{class:"title face-title"},"人脸识别",-1))),U={class:"face-verify-img"},q=["src"],A=P((()=>u("div",{class:"face-verify-tip"},[u("div",{class:"title"},"操作时请您配合"),u("ol",null,[u("li",null,"请调亮手机屏幕亮度，确保光线充足"),u("li",null,"请保持正脸对准屏幕，确保人脸完整清晰"),u("li",null,"请确保真实本人操作")])],-1))),L={class:"footer-button"};var S=e(a({__name:"faceVerify",setup(e){const a=T(),v=t(),y=o(),{agentCode:P,tenantId:S,nextPageCode:k,templateId:M,biz_id:B,orderNo:G,objectType:O,orderCode:V}=v.query,$=s({mobile:"",verifyCode:""});s();const D=s(),F=r((()=>Array.isArray(O)?`${null==O?void 0:O[0]}`.toLocaleUpperCase():`${O}`.toLocaleUpperCase())),J=()=>{I({orderNo:V||G,tenantId:S}).then((({code:e,data:t})=>{if("10000"===e){Object.assign(a.value,t);const{holder:e,insuredList:o}=t;if("holder"===O){const{name:a,certNo:t,certType:o,id:s,mobile:r}=e;$.value.mobile=r,D.value={userName:a,certiNo:t,certType:o,objectId:s}}else{const{name:e,certNo:a,certType:t,id:s,mobile:r}=(null==o?void 0:o[0])||{};$.value.mobile=r,D.value={userName:e,certiNo:a,certType:t,objectId:s}}B&&(()=>{const{objectId:e,certType:t}=D.value,o={bizId:B,certType:t,objectId:e,objectType:F.value,orderNo:G,tenantId:S};j(o).then((({code:e,data:t})=>{"10000"===e&&"SUCCESS"===t.status&&(delete v.query.biz_id,delete v.query.nextPageCode,M===x.FREE&&(a.value.extInfo.buttonCode=C.free.faceVerify,a.value.extInfo.pageCode="faceAuth",w(a.value,((e,a)=>{a===N.JUMP_PAGE&&y.push({path:_[e.nextPageCode],query:v.query})}))))}))})()}}))},Q=()=>{(()=>{const{userName:e,certiNo:a,certType:t}=D.value,o={tenantId:S,faceAuthMode:"TENCENT",callbackUrl:window.location.href,bizNo:G,userName:e,certiNo:a,certType:t};g(o).then((({code:e,data:a})=>{"10000"===e&&(window.location.href=a.originalUrl)}))})()};i((()=>{J()}));const R=s();return i((()=>{setTimeout((async()=>{R.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const t=b,o=l("ProPageWrap");return c(),d(o,null,{default:n((()=>[u("div",z,[E,u("div",U,[u("img",{src:p(h),alt:""},null,8,q)]),A,u("div",L,[f(t,{type:"primary",class:"submit-btn",onClick:Q},{default:n((()=>[m("开始验证")])),_:1})])])])),_:1})}}}),[["__scopeId","data-v-2358aba4"]]);export{S as default};
