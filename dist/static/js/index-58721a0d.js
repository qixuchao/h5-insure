import{i as q,aa as z,P as G,r as l,A as C,$ as J,k as M,l as p,m as g,n as w,p as m,t as v,B as _,L as X,C as L,x as Y,G as K,D as Q,a5 as Z,a6 as ee}from"./vendor-87894311.js";import{d as te}from"./debounce-11332b2b.js";import{r as oe,t as ae}from"./utils-d07cbf48.js";import{p as ne}from"./product-35f93839.js";import{i as re,b as se,p as ue}from"./trial-121f55b1.js";import{_ as ie}from"./index-f11bd0ed.js";import{_ as de}from"./index-dd334c46.js";import{u as le}from"./theme-fdbb0f53.js";import{n as ce}from"./nextStep-a74bc2d0.js";import"./useStorage-7cf89dc9.js";import"./infoCollection-9b1626aa.js";import"./trial-2c2f0d38.js";import"./relativeTime-89dc646e.js";import"./useDicData-80d301b9.js";const F=O=>(Z("data-v-50954d44"),O=O(),ee(),O),pe={class:"net-sale-wrap"},me={class:"product-name"},fe=F(()=>_("span",null,null,-1)),ve=F(()=>_("span",null,null,-1)),_e={class:"footer-button"},Oe=K("\u5206\u4EAB\u7528\u6237\u786E\u8BA4\u6295\u4FDD"),Ie=q({setup(O){const P=le();z();const x=G(),{productCode:h="HTEJBX",tenantId:I="9991000001",orderNo:Ce,agentCode:N="",saleChannelId:A,from:Le}=x.query,k=l(),i=l(),s=l(),B=l(),c=l(),V=l({}),r=l({agencyId:N,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_underWrite",pageCode:"infoCollection",templateId:3,iseeBizNo:""},orderCategory:1,saleUserId:A,tenantId:I,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"xinao",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:I}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),E=C(()=>{var e,o;return!!((o=(e=s.value)==null?void 0:e.productRelationPlanVOList)!=null&&o.length)}),j=C(()=>{var o,a;let{premium:e}=c.value||{};if(!e){const{tenantProductInsureVO:t}=B.value||{};let n={};(o=t==null?void 0:t.planList)!=null&&o.length?n=t==null?void 0:t.planList.find(f=>f.plaCode===i.value):n=t==null?void 0:t.planInsureVO;const{paymentFrequencyValue:u,premiumUnit:d}=((a=n==null?void 0:n.productPremiumVOList)==null?void 0:a[0])||{};e=u+d}return e||""}),R=C(()=>{var o,a,t;let e=[];return E.value?e=((a=(o=s.value)==null?void 0:o.productRelationPlanVOList.find(n=>n.planCode===i.value))==null?void 0:a.productRiskVoList)||[]:e=((t=s.value)==null?void 0:t.productRiskVoList)||[],e});C(()=>{var e,o,a;(a=(o=(e=R.value)==null?void 0:e[0])==null?void 0:o.riskDetailVOList)==null||a[0]});const S=async(e,o,a)=>{var u;const t={holder:{personVO:e.tenantOrderHolder},insuredVOList:e.tenantOrderInsuredList.map(d=>({insuredCode:"",personVO:d,productPlanVOList:[{insurerCode:o.productBasicInfoVO.insurerCode,planCode:i.value||0,riskVOList:oe(a)}]}))},{code:n}=await se(t);if(n==="10000"){const{code:d,data:f}=await ue(t);d==="10000"?c.value=f:c.value=null}r.value.tenantOrderInsuredList[0].tenantOrderProductList=(u=t.insuredVOList[0])==null?void 0:u.productPlanVOList},T=(e={},o={},a={})=>{var u;const t={...a},n={tenantId:I,riskList:((u=t.tenantOrderInsuredList[0])==null?void 0:u.tenantOrderProductList[0].riskVOList)||[],riskPremium:o,productId:e==null?void 0:e.productBasicInfoVO.id};return t.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,tenantOrderRiskList:ae(n)},t},H=async()=>{var e;r.value.venderCode=(e=s.value)==null?void 0:e.productBasicInfoVO.insurerCode,r.value.orderAmount=c.value.premium,r.value.orderRealAmount=c.value.premium,ce(T(s.value,c.value,r.value),()=>{})},U=async()=>{Q.confirm({title:"\u5206\u4EAB",message:`\u5373\u5C06\u5411\u5BA2\u6237\u3010${r.value.tenantOrderHolder.name}\u3011\u53D1\u9001\u6295\u4FDD\u786E\u8BA4\u4FE1\u606F,\u8BF7\u786E\u8BA4\u662F\u5426\u7EE7\u7EED\uFF1F`}).then(()=>{H()})};J([()=>r.value.tenantOrderHolder.gender,()=>r.value.tenantOrderHolder.birthday,()=>{var e;return(e=r.value.tenantOrderInsuredList)==null?void 0:e[0].gender},()=>{var e;return(e=r.value.tenantOrderInsuredList)==null?void 0:e[0].birthday},()=>i.value],te(([e,o,a,t])=>{e&&o&&a&&t&&S(r.value,s.value,R.value)},500));const W=async()=>{var n;const{code:e,data:o}=await ne({productCode:h,withInsureInfo:!0,tenantId:I});e==="10000"&&(B.value=o,document.title=o.productFullName||"");const{code:a,data:t}=await re({productCode:h});a==="10000"&&(s.value=t,V.value=t.productFactor,(n=t==null?void 0:t.productRelationPlanVOList)!=null&&n.length&&(i.value=t.productRelationPlanVOList[0].planCode))};return M(()=>{W(),setTimeout(async()=>{window.getIseeBiz&&await window.getIseeBiz()},1500)}),(e,o)=>{const a=p("ProRadioButton"),t=p("ProCard"),n=p("ProCell"),u=p("van-button"),d=p("ProPageWrap"),f=p("van-config-provider");return g(),w(f,{"theme-vars":L(P)},{default:m(()=>[v(d,null,{default:m(()=>{var y,D;return[_("div",pe,[_("div",me,X((D=(y=s.value)==null?void 0:y.productBasicInfoVO)==null?void 0:D.productFullName),1),L(E)?(g(),w(t,{key:0,title:"\u4FDD\u969C\u5E74\u671F"},{default:m(()=>{var b;return[v(a,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=$=>i.value=$),class:"radio-group",prop:{label:"planName",value:"planCode"},options:(b=s.value)==null?void 0:b.productRelationPlanVOList},null,8,["modelValue","options"])]}),_:1})):Y("",!0),v(ie,{ref_key:"formRef",ref:k,"title-collection":{HOLDER:"\u6295\u4FDD\u4EBA",INSURER:"\u88AB\u4FDD\u4EBA",BENEFICIARY:"\u6536\u76CA\u4EBA"},"form-info":r.value,"send-sms-code":()=>{},"input-align":"left","factor-object":V.value},{holderName:m(()=>[fe]),insurerName:m(()=>[ve]),_:1},8,["form-info","send-sms-code","factor-object"]),v(n,{title:"\u4FDD\u8D39",content:L(j)},null,8,["content"]),_("div",_e,[v(u,{type:"primary",block:"",onClick:U},{default:m(()=>[Oe]),_:1})])])]}),_:1})]),_:1},8,["theme-vars"])}}});var Ae=de(Ie,[["__scopeId","data-v-50954d44"]]);export{Ae as default};
