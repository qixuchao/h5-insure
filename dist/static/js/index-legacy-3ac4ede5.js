!function(){var e=document.createElement("style");e.innerHTML=".page-verify .card .people[data-v-4e83b643]{flex:1;margin-left:.53333rem;display:flex;align-items:center}.page-verify .card .people .name[data-v-4e83b643]{font-size:.4rem;font-weight:600;color:#393d46}.page-verify .card .people .status[data-v-4e83b643]{margin-left:.26667rem;text-align:center;width:1.2rem;height:.53333rem;line-height:.53333rem;border-radius:.05333rem;border:1px solid #99a9c0;font-size:.32rem;color:#99a9c0}.page-verify .card .people .status.verified[data-v-4e83b643]{color:#0d6efe;border-color:#0d6efe}.page-verify .card .verify-item[data-v-4e83b643]{display:flex;align-items:center;height:1.41333rem;line-height:1.41333rem;font-size:.4rem;color:#393d46}.page-verify .card .verify-item .no[data-v-4e83b643]{margin-left:.64rem}.page-verify .card .verify-item .action[data-v-4e83b643]{flex:1;display:flex;align-items:center;justify-content:flex-end;color:#99a9c0}.page-verify .card .verify-item .action .icon[data-v-4e83b643]{margin-left:.13333rem;color:#99a9c0;font-size:.32rem}.page-verify .sign-card .resign[data-v-4e83b643]{font-size:.37333rem;color:#0d6efe}.page-verify .sign-card .sign-body[data-v-4e83b643]{padding-bottom:.4rem}.page-verify .sign-card .sign-body .date[data-v-4e83b643]{margin-top:.32rem;font-size:.37333rem;color:#99a9c0;line-height:.53333rem}.page-verify .sign-card .sign-body .file[data-v-4e83b643]{margin-top:.21333rem;font-size:.37333rem;color:#393d46;line-height:.53333rem}.page-verify .sign-card .sign-body .file .file-name[data-v-4e83b643]{color:#0d6efe}.page-verify .sign-card .sign-body .file .file-name .dun-hao[data-v-4e83b643]{color:#393d46}.page-verify .footer[data-v-4e83b643]{position:static;justify-content:space-between}.page-verify .footer .refresh-btn[data-v-4e83b643]{width:.93333rem;border:none;color:#0d6efe;font-size:.4rem;line-height:.37333rem;text-align:center}.page-verify .footer .refresh-btn .text[data-v-4e83b643]{margin-top:.13333rem;font-size:.32rem}.page-verify .footer[data-v-4e83b643] .com-share{flex:1;margin-left:.26667rem}.page-verify .footer .submit-btn[data-v-4e83b643]{flex:1}\n",document.head.appendChild(e),System.register(["./vendor-legacy-8d7d6b09.js","./index-legacy-2a44fc37.js","./index-legacy-b6bb2c8a.js","./index-legacy-eae8ac9f.js","./verify-legacy-448f487e.js","./order-legacy-b77d8afe.js"],(function(e){"use strict";var a,t,r,i,n,l,o,d,s,c,v,u,f,g,m,y,p,b,h,I,x,C,N,k,O,w,_,D,j,H,T,E,L,S,z,U,P,R,q,$,A,M,Y,B;return{setters:[function(e){a=e.g,t=e.O,r=e.ak,i=e.E,n=e.d,l=e.y,o=e.h,d=e.r,s=e.j,c=e.k,v=e.m,u=e.z,f=e.p,g=e.J,m=e.n,y=e.L,p=e.t,b=e.A,h=e.G,I=e.F,x=e.a4,C=e.a5,N=e.C,k=e.T,O=e.D},function(e){w=e.q},function(e){_=e._,D=e.S,j=e.I,H=e.J,T=e.q,E=e.l,L=e.K,S=e.N,z=e.r,U=e.L,P=e.n,R=e.P},function(e){q=e._},function(e){$=e.g,A=e.f,M=e.s,Y=e.a},function(e){B=e.a}],execute:function(){const F=e=>(x("data-v-4e83b643"),e=e(),C(),e),G={class:"page-verify"},J={class:"people"},Q={class:"name"},K={class:"verify-item"},V=F((()=>u("div",{class:"label"},"证件号码",-1))),W={class:"no"},X=N(" 去认证 "),Z={class:"sign-body"},ee={class:"date"},ae={class:"file"},te=N(" 签名将被用于以下文件： "),re={class:"people"},ie={class:"name"},ne={class:"verify-item"},le=F((()=>u("div",{class:"label"},"证件号码",-1))),oe={class:"no"},de=["onClick"],se=N(" 去认证 "),ce=["onClick"],ve={class:"sign-body"},ue={class:"date"},fe={class:"file"},ge=N(" 签名将被用于以下文件： "),me={class:"footer-button footer"},ye=F((()=>u("div",{class:"text"},"刷新",-1))),pe=N("分享"),be=N("提交"),he=a({setup(e){const a=1,x=t(),C=r(),{saleUserId:N="D1234567-1",tenantId:_="9991000007",templateId:F=1,productCode:he="CQ75CQ76",insurerCode:Ie="ancheng",isShare:xe}=x.query;let{orderNo:Ce}=x.query;"object"==typeof Ce&&(Ce=(Ce||[])[0]);const Ne=new D({source:"localStorage"}),ke=i([]),Oe=i(),we=i(),_e=[],De=n().format("YYYY-MM-DD"),je=()=>{var e;null===(e=we.value)||void 0===e||e.clear()},He=(e,a)=>{Y({callbackUrl:window.location.href,certiNo:e,faceAuthMode:"TENCENT",userName:a,tenantId:9991000007}).then((t=>{const{code:r,data:i}=t;if("10000"===r){const{originalUrl:t,serialNo:r}=i;window.location.href=t,Ne.set("verifyData",{serialNo:r,certNo:e,name:a})}}))},Te=e=>`${e}`===H.CERT,Ee=e=>{var a,t,r,i;-1===e?He(null===(a=Oe.value.tenantOrderHolder)||void 0===a?void 0:a.certNo,null===(t=Oe.value.tenantOrderHolder)||void 0===t?void 0:t.name):He(null===(r=Oe.value.tenantOrderInsuredList[e])||void 0===r?void 0:r.certNo,null===(i=Oe.value.tenantOrderInsuredList[e])||void 0===i?void 0:i.name)},Le=e=>{e&&_e.every((a=>a!==e))&&_e.push(e)},Se=()=>{z({orderNo:Ce,saleUserId:N,tenantId:_}).then((e=>{const{code:t,data:r}=e;if("10000"===t)if(r.orderStatus!==B.PENDING)k.fail("订单非待处理状态"),U("paymentResult",x.query);else{var i,n,l,o,d;if(null===(i=we.value)||void 0===i?void 0:i.isEmpty())return void k.fail("请投保人签名");if(_e.some((e=>e.isEmpty())))return void k.fail("请被保人签名");if((null===(n=Oe.value.tenantOrderHolder)||void 0===n||null===(l=n.extInfo)||void 0===l?void 0:l.isCert)!==a&&Te(null===(o=Oe.value.tenantOrderHolder)||void 0===o?void 0:o.certType))return void k.fail("请投保人去认证");if(null!==(d=Oe.value.tenantOrderInsuredList)&&void 0!==d&&d.some((e=>{var t;return(null===(t=e.extInfo)||void 0===t?void 0:t.isCert)!==a&&Te(e.certType)})))return void k.fail("请被保人去认证");O.confirm({title:"提示",message:"请确认信息填写无误后，再进行支付"}).then((()=>{var e,a;const r=null===(e=we.value)||void 0===e?void 0:e.save();Promise.all([M("HOLDER",r,null===(a=Oe.value)||void 0===a?void 0:a.id,`${_}`),..._e.map((e=>{var a;return M("INSURED",e.save(),null===(a=Oe.value)||void 0===a?void 0:a.id,`${_}`)}))]).then((()=>{P({...Oe.value,pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:{...Oe.value.extInfo,pageCode:"sign",templateId:F},venderCode:Ie}).then((e=>{const{code:a,data:r}=e;"10000"===t&&r.success&&C.push({path:R[r.pageAction.data.nextPageCode],query:{orderNo:Ce,saleUserId:N,tenantId:_}})}))}))}))}}))},ze=()=>{z({orderNo:Ce,saleUserId:N,tenantId:_}).then((e=>{const{code:a,data:t}=e;"10000"===a&&(Oe.value=t,setTimeout((()=>{let e=0;t.tenantOrderAttachmentList.forEach((a=>{21===a.category&&(2===a.objectType?(we.value.clear(),we.value.setDataURL(a.fileBase64)):1===a.objectType&&(_e[e].clear(),_e[e].setDataURL(a.fileBase64),e+=1))}))})))}))},Ue=()=>{ze()},Pe=l((()=>{const e={...x.query,isShare:1,sharePageCode:"sign"};return`${window.location.origin}/phoneVerify?${w.stringify(e)}`}));return o((()=>{ze(),$({orderNo:Ce,productCode:he,tenantId:_}).then((e=>{const{code:a,data:t}=e;"10000"===a&&(ke.value=t||[])}));const e=Ne.get("verifyData");if(e){const{serialNo:a,certNo:t,name:r}=e;A({certiNo:t,orderNo:Ce,serialNo:a,tenantId:_,userName:r}).then((e=>{const{code:a,data:t}=e;"10000"===a&&(Ne.remove("verifyData"),ze())}))}})),(e,t)=>{const r=d("ProPDFviewer"),i=d("van-button"),n=d("ProPageWrap");return s(),c(n,null,{default:v((()=>{var e;return[u("div",G,[f(j,{type:"warning",title:"尊敬的客户，本次投保需要进行身份认证",content:"本产品投保需要对投保人、被保人进行实名认证，您购买本产品的累计总保费已超过20万，按监管要求，需要提供投保人、被保人、指定受益人证件影像，本产品非本人投保且带身故责任、需对投保人、被保人（成人）的投保意愿进行签字确认。"}),f(E,{title:"投保人",class:"card"},{extra:v((()=>{var e,t,r,i,n,l,o,d,c,v;return[u("div",J,[u("div",Q,g(null===(e=Oe.value)||void 0===e||null===(t=e.tenantOrderHolder)||void 0===t?void 0:t.name),1),Te(null===(r=Oe.value)||void 0===r||null===(i=r.tenantOrderHolder)||void 0===i?void 0:i.certType)?(s(),m("div",{key:0,class:y(["status",{verified:(null===(n=Oe.value)||void 0===n||null===(l=n.tenantOrderHolder)||void 0===l||null===(o=l.extInfo)||void 0===o?void 0:o.isCert)===a}])},g((null===(d=Oe.value)||void 0===d||null===(c=d.tenantOrderHolder)||void 0===c||null===(v=c.extInfo)||void 0===v?void 0:v.isCert)===a?"已认证":"待认证"),3)):p("",!0)])]})),default:v((()=>{var e,r,i,n,l,o,d;return[u("div",K,[V,u("div",W,g(null===(e=Oe.value)||void 0===e||null===(r=e.tenantOrderHolder)||void 0===r?void 0:r.certNo),1),(null===(i=Oe.value)||void 0===i||null===(n=i.tenantOrderHolder)||void 0===n||null===(l=n.extInfo)||void 0===l?void 0:l.isCert)!==a&&Te(null===(o=Oe.value)||void 0===o||null===(d=o.tenantOrderHolder)||void 0===d?void 0:d.certType)?(s(),m("div",{key:0,class:"action",onClick:t[0]||(t[0]=e=>Ee(-1))},[X,f(T,{name:"right_arrow",class:"icon"})])):p("",!0)])]})),_:1}),f(E,{title:"投保人签名","show-icon":!1,class:"sign-card","show-line":!1},{extra:v((()=>[u("div",{class:"resign",onClick:je},"重签")])),default:v((()=>[f(L,{ref_key:"holderSign",ref:we,class:"sign"},null,512),u("div",Z,[u("div",ee,"签名日期： "+g(b(De)),1),u("div",ae,[te,(s(!0),m(I,null,h(ke.value.filter((e=>e.noticeObject===b(S).HOLDER)),((e,a)=>(s(),c(r,{key:a,class:"file",title:`《${e.materialName}》`,url:e.materialSource},null,8,["title","url"])))),128))])])])),_:1}),(s(!0),m(I,null,h(null===(e=Oe.value)||void 0===e?void 0:e.tenantOrderInsuredList,((e,t)=>(s(),m("div",{key:t},[f(E,{title:"被保人",class:"card"},{extra:v((()=>{var t,r;return[u("div",re,[u("div",ie,g(e.name),1),Te(e.certType)?(s(),m("div",{key:0,class:y(["status",{verified:(null===(t=e.extInfo)||void 0===t?void 0:t.isCert)===a}])},g((null===(r=e.extInfo)||void 0===r?void 0:r.isCert)===a?"已认证":"待认证"),3)):p("",!0)])]})),default:v((()=>{var r;return[u("div",ne,[le,u("div",oe,g(e.certNo),1),(null===(r=e.extInfo)||void 0===r?void 0:r.isCert)!==a&&Te(e.certType)?(s(),m("div",{key:0,class:"action",onClick:e=>Ee(t)},[se,f(T,{name:"right_arrow",class:"icon"})],8,de)):p("",!0)])]})),_:2},1024),f(E,{title:"被保人签名","show-icon":!1,class:"sign-card","show-line":!1},{extra:v((()=>[u("div",{class:"resign",onClick:e=>(e=>{_e[e].clear()})(t)},"重签",8,ce)])),default:v((()=>[f(L,{ref_for:!0,ref:Le,class:"sign"}),u("div",ve,[u("div",ue,"签名日期： "+g(b(De)),1),u("div",fe,[ge,(s(!0),m(I,null,h(ke.value.filter((e=>e.noticeObject===b(S).INSURED)),((e,a)=>(s(),c(r,{key:a,class:"file",title:`《${e.materialName}》`,url:e.materialSource},null,8,["title","url"])))),128))])])])),_:2},1024)])))),128)),u("div",me,[b(xe)?p("",!0):(s(),m("div",{key:0,class:"refresh-btn",onClick:Ue},[u("div",null,[f(T,{name:"refresh"})]),ye])),b(xe)?p("",!0):(s(),c(q,{key:1,title:"邀请您进行身份认证",desc:"邀请您进行身份认证",link:b(Pe)},{default:v((()=>[f(i,{plain:"",type:"primary",class:"share-btn"},{default:v((()=>[pe])),_:1})])),_:1},8,["link"])),f(i,{type:"primary",class:"submit-btn",onClick:Se},{default:v((()=>[be])),_:1})])])]})),_:1})}}});e("default",_(he,[["__scopeId","data-v-4e83b643"]]))}}}))}();
