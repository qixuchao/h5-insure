var ce=Object.defineProperty,de=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var j=(e,t,a)=>t in e?ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,x=(e,t)=>{for(var a in t||(t={}))me.call(t,a)&&j(e,a,t[a]);if(Y)for(var a of Y(t))ve.call(t,a)&&j(e,a,t[a]);return e},k=(e,t)=>de(e,pe(t));import{g as P,j as R,n as Z,z as l,J as W,A as h,t as _e,a4 as fe,a5 as he,a9 as Ie,O as ge,E as d,h as De,r as b,k as Ce,m as Q,p as _,T as I}from"./vendor-17026bfd.js";import{i as we}from"./infoCollection-192ba138.js";import{_ as L,a1 as ye}from"./index-3edccef1.js";import{c as xe,_ as Ue}from"./index-9c1680e1.js";import{a as $e}from"./order-c0ced472.js";import{d as Oe,i as Se,g as Be,s as Ee,e as Ne,E as Fe}from"./trial-cc50a6de.js";import{t as ke}from"./theme-ea709837.js";import{n as be,i as Pe,m as Re,b as Le,a as Ve,t as qe,f as Ae,d as X}from"./utils-e691acb1.js";import{p as Me}from"./product-fc01a5c0.js";import"./utils-b6782348.js";import"./trial-9eb05d43.js";const Te={class:"com-field-info"},ze={class:"title"},He={class:"desc"},Je=P({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup(e){return(t,a)=>(R(),Z("div",Te,[l("div",ze,W(e.title),1),l("div",He,W(e.desc),1)]))}});var U=L(Je,[["__scopeId","data-v-2ff3e068"]]);const ee=e=>(fe("data-v-ed9081ee"),e=e(),he(),e),Ge={key:0,class:"pro-modal"},Ke=ee(()=>l("div",{class:"pro-overlay"},null,-1)),Ye={class:"pro-modal-wrapper"},je=ee(()=>l("div",{class:"pro-modal-content"},[l("p",null,"\u606D\u559C\u60A8"),l("p",null,"\u4FDD\u969C\u5347\u7EA7\u6210\u529F")],-1)),We=["src"],Qe=P({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(e,{emit:t}){const a=e,f=()=>{t("on-close")},i=()=>{t("on-confirm")};return(V,q)=>a.isShow?(R(),Z("div",Ge,[Ke,l("div",Ye,[l("div",{class:"pro-modal-body"},[je,l("div",{class:"pro-modal-btn",onClick:i},"\u6211\u77E5\u9053\u4E86")]),l("div",{class:"pro-modal-close",onClick:f},[l("img",{src:h(xe)},null,8,We)])])])):_e("",!0)}});var Xe=L(Qe,[["__scopeId","data-v-ed9081ee"]]);const Ze={class:"page-activity-upgrade"},et=["src"],tt={class:"container"},ot={class:"main-form"},at=P({setup(e){const t=Ie(),a=ge(),{productCode:f="BWYL2022",tenantId:i,orderNo:V,agentCode:q="",from:te}=a.query;console.log("upload--route.query",a.query);const m=d(),g=d(),n=d(),D=d(),$=d(),y=d(),O=d(!1),S=te==="check",B=d(!1),oe=d(0),E=d("");let N="";const ae=()=>{O.value=!1},ne=async()=>{var u,p,v,C,w;const s=Ve({tenantId:i,applicationNo:n.value.applicationNo,policyNo:n.value.policyNo,saleUserId:q,saleChannelId:n.value.saleChannelId,orderStatus:$e.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:m.value,insureDetail:g.value,paymentMethod:(p=(u=n.value.extInfo)==null?void 0:u.extraInfo)==null?void 0:p.paymentMethod,renewalDK:(C=(v=n.value.extInfo)==null?void 0:v.extraInfo)==null?void 0:C.renewalDK,iseeBizNo:N,successJumpUrl:"",premium:D.value,holder:k(x({},n.value.tenantOrderHolder),{socialFlag:n.value.tenantOrderHolder.extInfo.hasSocialInsurance}),insured:k(x({},n.value.tenantOrderInsuredList[0]),{socialFlag:n.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance}),tenantOrderRiskList:qe({tenantId:i,riskList:Ae(g.value.productRiskVoList[0].riskDetailVOList,m.value),riskPremium:{},productId:(w=m.value)==null?void 0:w.id})}),o=await Ee(s),{code:c,data:r}=o;return c==="10000"?r.data:""},A=s=>`${ye}/internet/orderDetail?orderNo=${s}&productCode=${f}&tenantId=${i}`,se=()=>{t.replace(`/internet/orderDetail?orderNo=${E.value}&productCode=${f}&tenantId=${i}`)},re=async()=>{try{const s=X({tenantId:i,premium:D.value,orderDetail:n.value,productDetail:m.value,insureDetail:g.value,successJumpUrl:""}),o=await Ne(s),{code:c,data:r}=o;c==="10000"&&(D.value=r.installmentPremium,y.value=r.signUrl),I.clear()}catch(s){console.log(s)}},le=async s=>{const o=X({tenantId:i,premium:D.value,orderDetail:n.value,productDetail:m.value,insureDetail:g.value,successJumpUrl:A(s),iseeBizNo:N}),c=await Fe(x({orderNo:s},o)),{code:r,data:u}=c;r==="10000"&&(S?t.replace(`/internet/orderDetail?orderNo=${s}&productCode=${f}&tenantId=${i}`):(I.clear(),O.value=!0))},M=async s=>{try{I.loading({forbidClick:!0,message:"\u5347\u7EA7\u4E2D",duration:15*1e3});const o=await ne(),c=await Oe({tenantId:i,applicationNo:n.value.applicationNo});if(E.value=o,console.log(E.value,"orderNoUp.value===",o),y.value){if(S){const r=encodeURIComponent(encodeURIComponent(A(o))),u=`${y.value}&successUrl=${r}`;window.location.href=u}else{const r=encodeURIComponent(encodeURIComponent(window.location.href)),u=`${y.value}&failUrl=${r}`;window.location.href=u}I.clear()}else le(o)}catch(o){console.log(o),I.clear()}},ie=async s=>{S?B.value=!0:M()},ue=()=>{I.loading({forbidClick:!0,duration:20*1e3,message:"\u8BD5\u7B97\u4E2D"});const s=Me({productCode:f,withInsureInfo:!0,tenantId:i}),o=Se({productCode:f}),c=Be({orderNo:V,tenantId:i});Promise.all([s,o,c]).then(([r,u,p])=>{var v;r.code==="10000"&&(m.value=r.data,document.title=((v=r.data)==null?void 0:v.productFullName)||""),u.code==="10000"&&(g.value=u.data),p.code==="10000"&&(n.value=p.data,$.value=p.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),re()})};return De(()=>{ue(),setTimeout(async()=>{N=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(s,o)=>{const c=b("ProRadioButton"),r=b("ProField"),u=b("van-config-provider");return R(),Ce(u,{"theme-vars":h(ke)},{default:Q(()=>{var p,v,C,w,T,z,H,J,G,K;return[l("div",Ze,[l("img",{src:(v=(p=m.value)==null?void 0:p.tenantProductInsureVO)==null?void 0:v.banner[0],class:"banner"},null,8,et),l("div",tt,[l("div",ot,[_(U,{title:"\u59D3\u540D",desc:h(be)((w=(C=n.value)==null?void 0:C.tenantOrderInsuredList)==null?void 0:w[0].name)},null,8,["desc"]),_(U,{title:"\u8BC1\u4EF6\u53F7\u7801",desc:h(Pe)((z=(T=n.value)==null?void 0:T.tenantOrderInsuredList)==null?void 0:z[0].certNo)},null,8,["desc"]),_(U,{title:"\u624B\u673A\u53F7\u7801",desc:h(Re)((J=(H=n.value)==null?void 0:H.tenantOrderHolder)==null?void 0:J.mobile)},null,8,["desc"]),_(U,{title:"\u6BCF\u6708\u4FDD\u8D39",desc:`${h(Le)(D.value||0)}\u5143 / \u6BCF\u6708`},null,8,["desc"]),_(r,{label:"\u6709\u65E0\u793E\u4FDD",name:"name",required:"",placeholder:"\u8BF7\u9009\u62E9"},{input:Q(()=>[_(c,{modelValue:$.value,"onUpdate:modelValue":o[0]||(o[0]=F=>$.value=F),disabled:!0,options:h(we)},null,8,["modelValue","options"])]),_:1}),l("div",{class:"submit",onClick:ie})])]),_(Xe,{"is-show":O.value,onOnConfirm:se,onOnClose:ae},null,8,["is-show"])]),_(Ue,{show:B.value,"onUpdate:show":o[1]||(o[1]=F=>B.value=F),"content-list":(K=(G=m.value)==null?void 0:G.tenantProductInsureVO)==null?void 0:K.attachmentVOList,"active-index":oe.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9",onSubmit:M},null,8,["show","content-list","active-index"])]}),_:1},8,["theme-vars"])}}});var ft=L(at,[["__scopeId","data-v-bcce89b6"]]);export{ft as default};
