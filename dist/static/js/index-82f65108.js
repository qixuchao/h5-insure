import{aD as e,d as a,r as s,bW as t,x as o,bk as l,Q as r,bl as n,i as c,aI as i,aK as u,bj as d,aO as p,Z as h,bX as v,aR as m,E as g,am as f,c as C,y,f as k,g as b,z as P,R as w,U as L,k as x,h as _,a5 as V,K as I,a8 as S,a0 as j,bY as T,o as M,A as D,w as U,bZ as $,a1 as q,j as H,bt as N,ax as O,B,bA as F,ak as A,al as z,bI as K,az as R,bK as Y,e as W,bu as Z,bJ as E,aa as J,a as Q,u as X,b as G,an as ee}from"./index-f6fa5ecc.js";import{L as ae}from"./index-6cac56ce.js";import{S as se}from"./index-b6d32358.js";import{P as te}from"./index-4ea5171c.js";import{e as oe}from"./empty-c926d8ec.js";import{q as le,a as re}from"./proposalList-51123d1d.js";import{u as ne}from"./createProposal-68c53821.js";import{P as ce}from"./index-b6feb731.js";import{a as ie}from"./trial-d6f8cdcc.js";import"./pdfh5-008ca364.js";const[ue,de,pe]=e("pull-refresh"),he=["pulling","loosing","success"];const ve=m(a({name:ue,props:{disabled:Boolean,modelValue:Boolean,headHeight:i(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:u,successDuration:i(500),animationDuration:i(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:a,slots:i}){let u;const m=s(),g=s(),f=t(m),C=o({status:"normal",distance:0,duration:0}),y=l(),k=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},b=()=>"loading"!==C.status&&"success"!==C.status&&!e.disabled,P=(s,t)=>{const o=+(e.pullDistance||e.headHeight);C.distance=s,C.status=t?"loading":0===s?"normal":s<o?"pulling":"loosing",a("change",{status:C.status,distance:s})},w=()=>{const{status:a}=C;return"normal"===a?"":e[`${a}Text`]||pe(a)},L=()=>{const{status:e,distance:a}=C;if(i[e])return i[e]({distance:a});const s=[];return he.includes(e)&&s.push(c("div",{class:de("text")},[w()])),"loading"===e&&s.push(c(d,{class:de("loading")},{default:w})),s},x=e=>{u=0===v(f.value),u&&(C.duration=0,y.start(e))},_=e=>{b()&&x(e)},V=()=>{u&&y.deltaY.value&&b()&&(C.duration=+e.animationDuration,"loosing"===C.status?(P(+e.headHeight,!0),a("update:modelValue",!0),h((()=>a("refresh")))):P(0))};return r((()=>e.modelValue),(a=>{C.duration=+e.animationDuration,a?P(+e.headHeight,!0):i.success||e.successText?(C.status="success",setTimeout((()=>{P(0)}),+e.successDuration)):P(0,!1)})),n("touchmove",(a=>{if(b()){u||x(a);const{deltaY:s}=y;y.move(a),u&&s.value>=0&&y.isVertical()&&(p(a),P((a=>{const s=+(e.pullDistance||e.headHeight);return a>s&&(a=a<2*s?s+(a-s)/2:1.5*s+(a-2*s)/4),Math.round(a)})(s.value)))}}),{target:g}),()=>{var e;const a={transitionDuration:`${C.duration}ms`,transform:C.distance?`translate3d(0,${C.distance}px, 0)`:""};return c("div",{ref:m,class:de()},[c("div",{ref:g,class:de("track"),style:a,onTouchstartPassive:_,onTouchend:V,onTouchcancel:V},[c("div",{class:de("head"),style:k()},[L()]),null==(e=i.default)?void 0:e.call(i)])])}}}));const me={class:"com-product-item"},ge={class:"content-wrap"},fe={class:"product-image"},Ce={class:"insure-name"},ye={class:"product-info"},ke={class:"title"},be={class:"description"},Pe={class:"tags"},we={key:0,class:"product-tips"};var Le=g(a({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:null},setup(e){const a=e,{productInfo:s}=f(a),t=o({checked:!1});return f(t),(a,t)=>{var o,l,r,n;const i=V;return C(),y("div",me,[k("div",ge,[k("div",fe,[c(i,{src:null==(o=b(s).showConfig)?void 0:o.fileUrl},null,8,["src"]),k("p",Ce,P((b(s).insurerName||"").substring(0,6)),1)]),k("div",ye,[k("p",ke,P(null==(l=b(s).showConfig)?void 0:l.title),1),k("p",be,P(null==(r=b(s).showConfig)?void 0:r.text),1),k("p",Pe,[(C(!0),y(w,null,L(null==(n=b(s).showConfig)?void 0:n.tags,((e,a)=>(C(),y("span",{key:a,class:"tag"},P(e),1)))),128))])]),x(a.$slots,"checkedProduct",{},void 0,!0)]),e.errorMsg?(C(),y("span",we,P(e.errorMsg),1)):_("",!0)])}}}),[["__scopeId","data-v-001656b6"]]);const xe=["xlink:href"],_e=a({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const a=e,s=I((()=>`#icon-${a.name}`)),t=I((()=>a.name?`svg-icon icon-${a.name}`:"svg-icon"));return(a,o)=>(C(),y("svg",S({class:b(t)},a.$attrs,{style:{color:e.color}}),[k("use",{"xlink:href":b(s)},null,8,xe)],16))}});const Ve=e=>(A("data-v-72eaf171"),e=e(),z(),e),Ie={class:"com-tab-filter"},Se={class:"article-mid"},je={class:"article-tag"},Te=["onClick"],Me=Ve((()=>k("span",null,null,-1))),De={class:"popup-inner"},Ue=Ve((()=>k("div",{class:"popup-title"},"保险公司",-1))),$e={class:"footer-button"};var qe=g(a({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:a}){const{isPopShow:t,openPop:l,closePop:r}=function(e=!1){const a=s(e);return{isPopShow:a,openPop:e=>{e instanceof Function&&e(),a.value=!0},closePop:e=>{a.value=!1,e instanceof Function&&e()}}}(!1),n=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:u}=f(n),d=s(""),p=()=>{u.value=[]},h=()=>{a("onSelectInsure",{selectInsureCode:u.value,selectCategory:d.value}),r()};return j((()=>{T().then((e=>{const{code:a,data:s}=e;"10000"===a&&(i.value=null==s?void 0:s.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),M((()=>{le().then((e=>{const{code:a,data:s}=e||{};"10000"===a&&O(s)&&(n.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...s])}))})),(s,o)=>{const v=B,m=F;return C(),y("div",Ie,[k("div",Se,[k("div",je,[(C(!0),y(w,null,L(b(n).productCategoryList,((e,s)=>(C(),y("div",{key:s,class:D(["tag-item",{checked:b(d)==s}]),onClick:t=>((e,s)=>{d.value=s,a("onSelectInsure",{selectInsureCode:u.value,selectCategory:d.value})})(null==e||e.productCategoryId,s)},[k("div",{class:D(["tag-out",{checked:b(d)==s}])},[k("div",{class:D(["tag-item-text",{checked:b(d)==s}])},P(e.productCategoryName),3)],2)],10,Te)))),128))]),e.filter?(C(),y("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>b(l)&&b(l)(...e))},[Me,k("div",{class:D(["text",{"has-select-condition":b(u).length>0}])},"筛选",2),c(_e,{name:"filter"})])):_("",!0),c(m,{show:b(t),position:"right","close-on-click-overlay":"",style:N(e.popupStyle||{width:"322px",height:"100%",padding:"0 15px"}),onClickOverlay:b(r)},{default:U((()=>[k("div",De,[Ue,c($,{modelValue:b(u),"onUpdate:modelValue":o[1]||(o[1]=e=>q(u)?u.value=e:null),options:b(i)},null,8,["modelValue","options"])]),k("div",$e,[c(v,{plain:"",type:"primary",onClick:p},{default:U((()=>[H("重置")])),_:1}),c(v,{type:"primary",onClick:h},{default:U((()=>[H("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])])])}}}),[["__scopeId","data-v-72eaf171"]]);const He={class:"com-trial-product-wrapper"},Ne={class:"container"},Oe=(e=>(A("data-v-73270e0c"),e=e(),z(),e))((()=>k("span",{class:"title"}," 已选产品 ",-1))),Be={class:"popup-body"},Fe={class:"cell-title"},Ae={class:"title"},ze=a({name:"TrialProductPopup"});var Ke=g(a({...ze,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:a}){const t=e,o=s([]),l=s([]),n=s({isShow:t.isShow}),i=()=>{a("close")},u=()=>{l.value=[],a("checked",[])},d=e=>{var s,t,r;null==(r=null==(t=null==(s=null==o?void 0:o.value)?void 0:s[e])?void 0:t.toggle)||r.call(t),a("checked",l.value)};return r((()=>t.isShow),(e=>{n.value.isShow=e})),r((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(a,s)=>{const t=K,r=R,p=E,h=Y,v=F;return C(),y("div",He,[c(v,{show:b(n).isShow,"onUpdate:show":s[1]||(s[1]=e=>b(n).isShow=e),position:"bottom",onClose:i},{default:U((()=>[k("div",Ne,[k("div",{class:"popup-header"},[k("span",{class:"clear-all",onClick:u}," 清空选项 "),Oe,k("span",{class:"close",onClick:i})]),k("div",Be,[c(h,{modelValue:b(l),"onUpdate:modelValue":s[0]||(s[0]=e=>q(l)?l.value=e:null)},{default:U((()=>[c(p,{inset:""},{default:U((()=>[(C(!0),y(w,null,L(e.proposalList,(e=>(C(),W(r,{key:e.productCode,title:e.productName,onClick:a=>d(e.productCode)},{"right-icon":U((()=>[c(t,{ref_for:!0,ref:a=>b(o)[e.productCode]=a,shape:"square",name:e.productCode,onClick:Z((a=>d(e.productCode)),["stop"])},null,8,["name","onClick"])])),title:U((()=>[k("div",Fe,[k("div",Ae,P(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-73270e0c"]]);const Re={class:"search-wrap"},Ye={class:"page-proposal-list"},We={class:"check-button"},Ze={key:1,class:"van-sticky"},Ee={class:"add-plan"},Je={class:"has-select-product"},Qe=(e=>(A("data-v-344b1617"),e=e(),z(),e))((()=>k("span",{class:"icon"},null,-1))),Xe=a({name:"ProposalList"});var Ge=g(a({...Xe,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const a=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{}}),{searchValue:t,tagLists:l,isOpen:r,loading:n,finished:i,refreshing:u,productList:d,selectProduct:p,insurerCodeList:h,showCategory:v,productTotal:m,showFooter:g}=f(a);J();const[x,V]=J(),S=ne(),j=Q(),T=X(),{isCreateProposal:M,productCode:D,productCodeList:$=[]}=T.query;s(M?"repeatAdd":"add");const N=()=>{re({title:t.value,insurerCodeList:h.value,showCategory:v.value,excludeProductCodeList:$,pageNum:1,pageSize:999}).then((e=>{const{code:a,data:s,total:t}=e;"10000"===a&&(d.value=null==s?void 0:s.datas,m.value=t)}))},O=e=>{N()},F=e=>{const{selectInsureCode:a,selectCategory:s}=e;h.value=a,v.value=s,N()},A=()=>{u.value&&(d.value=[],u.value=!1),N(),n.value=!1,m.value===d.value.length&&(i.value=!0)},z=()=>{j.push({path:"historyProposalList"})};I((()=>{var e;const{birthday:a,gender:s}=(null==(e=S.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:a,gender:s}}));const R=I((()=>d.value.length>0)),Y=I((()=>d.value.filter((e=>a.selectProduct.includes(e.productCode))))),Z=({productCode:e})=>{M||j.push({path:"/proposal/createProposal",query:{productCode:e}}),a.productCode=e,a.selectProduct.includes(e)?a.selectProduct=a.selectProduct.filter((a=>a!==e)):(async(e,s)=>{const{code:t,data:o,message:l}=await ie({calcProductFactorList:[{productCode:e}]});"10000"===t?(a.errorMsgMap[e]="","function"==typeof s&&s(!0)):a.errorMsgMap[e]=l})(e,(()=>{a.selectProduct.push(e)}))},E=e=>{a.selectProduct=e},le=()=>{const e=a.proposalList.filter((e=>a.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));S.setTrialData(e),j.replace({path:"/proposal/createProposal",query:{productCode:D,selectProduct:a.selectProduct}})},ue=()=>{i.value=!0,n.value=!0,A()};return(e,s)=>{const o=se,l=K,h=ae,v=ve,m=B,f=G("ProPageWrap");return C(),y(w,null,[c(f,{class:"page-proposal"},{default:U((()=>[k("div",Re,[c(o,{modelValue:b(t),"onUpdate:modelValue":s[0]||(s[0]=e=>q(t)?t.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:O},null,8,["modelValue"]),c(qe,{filter:b(r),"onUpdate:filter":s[1]||(s[1]=e=>q(r)?r.value=e:null),"filter-class":"filter-area",onOnSelectInsure:F},null,8,["filter"])]),b(R)?_("",!0):(C(),W(te,{key:0,"empty-img":b(oe),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),k("div",Ye,[c(v,{modelValue:b(u),"onUpdate:modelValue":s[3]||(s[3]=e=>q(u)?u.value=e:null),onRefresh:ue},{default:U((()=>[c(h,{loading:b(n),"onUpdate:loading":s[2]||(s[2]=e=>q(n)?n.value=e:null),finished:b(i),"finished-text":b(R)?"- 已经到底了哦 -":"",onLoad:A},{default:U((()=>[(C(!0),y(w,null,L(b(d),(e=>(C(),W(Le,{key:e.id,"product-info":e,"error-msg":b(a).errorMsgMap[e.productCode],onClick:a=>Z(e)},ee({_:2},[b(M)?{name:"checkedProduct",fn:U((()=>[k("div",We,[c(l,{name:e.productCode,"model-value":b(p).includes(e.productCode),shape:"square"},null,8,["name","model-value"])])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),b(M)&&b(g)?(C(),y("div",Ze,[k("div",Ee,[k("p",{class:"has-select",onClick:s[4]||(s[4]=e=>b(V)(!b(x)))},[H(" 已选"),k("span",Je,P(b(p).length),1),H("款产品 "),Qe]),c(m,{type:"primary",disabled:!b(p).length,onClick:le},{default:U((()=>[H("添加计划书")])),_:1},8,["disabled"])])])):_("",!0),c(Ke,{modelValue:b(p),"onUpdate:modelValue":s[5]||(s[5]=e=>q(p)?p.value=e:null),"proposal-list":b(Y),"is-show":b(x),onClose:s[6]||(s[6]=e=>b(V)(!1)),onChecked:E},null,8,["modelValue","proposal-list","is-show"])])),_:1}),b(M)?_("",!0):(C(),W(ce,{key:0,"button-image":b("/static/png/lishijihuashu-b6958e78.png"),onClick:z},null,8,["button-image"]))],64)}}}),[["__scopeId","data-v-344b1617"]]);export{Ge as default};
