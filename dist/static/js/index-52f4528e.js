import{g,E as d,O as y,h as N,r as _,j as x,k as P,m as v,z as o,J as C,A as T,H as b,ap as k,L as w,p as R,a4 as U,a5 as M,C as O,T as m}from"./vendor-17026bfd.js";import{_ as V,g as q,s as f}from"./index-b439a588.js";import{s as W,c as z}from"./phoneVerify-e304571d.js";import{c as G}from"./format-99418f69.js";import{a as i}from"./order-973d744d.js";const H=u=>(U("data-v-29510ea1"),u=u(),M(),u),J={class:"page-phone-verify"},L=H(()=>o("div",{class:"title"},"\u901A\u8FC7\u6295\u4FDD\u4EBA\u624B\u673A\u53F7\u9A8C\u8BC1\u540E\uFF0C\u53EF\u8FDB\u884C\u6295\u4FDD\u4FE1\u606F\u9884",-1)),j={class:"phone"},Y={class:"input-wrapper"},$=O("\u4E0B\u4E00\u6B65"),K=g({setup(u){const n=d(""),l=d(""),e=d(0);let p;const c=y(),{agentCode:h,tenantId:D,templateId:Q,productCode:X,insurerCode:Z,orderNo:B}=c.query,E=()=>{p=setInterval(()=>{e.value-=1,e.value<=0&&clearInterval(p)},1e3)},F=()=>{q({orderNo:B,saleUserId:h,tenantId:D}).then(t=>{var r;const{code:s,data:a}=t;s==="10000"&&([i.PENDING,i.PAYMENT_FAILED,i.UNDER_WRITING_SUCCESS].includes(a.orderStatus)?n.value=(r=a==null?void 0:a.tenantOrderHolder)==null?void 0:r.mobile:f("paymentResult",c.query))})},I=()=>{W(n.value).then(({code:t})=>{t==="10000"&&(e.value=60,E())})},A=()=>{z(n.value,l.value).then(({code:t,data:s})=>{t==="10000"&&s?(m.success("\u9A8C\u8BC1\u6210\u529F"),f("infoPreview",c.query)):m.fail("\u9A8C\u8BC1\u5931\u8D25")})};return N(()=>{F()}),(t,s)=>{const a=_("van-button"),r=_("ProPageWrap");return x(),P(r,null,{default:v(()=>[o("div",J,[L,o("div",j,C(T(G)(n.value)),1),o("div",Y,[b(o("input",{"onUpdate:modelValue":s[0]||(s[0]=S=>l.value=S),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",class:"input"},null,512),[[k,l.value]]),o("div",{class:w(["btn",{second:e.value}]),onClick:I},C(e.value?`${e.value}s`:"\u53D1\u9001\u9A8C\u8BC1\u7801"),3)]),R(a,{type:"primary",class:"submit-btn",onClick:A},{default:v(()=>[$]),_:1})])]),_:1})}}});var ue=V(K,[["__scopeId","data-v-29510ea1"]]);export{ue as default};
