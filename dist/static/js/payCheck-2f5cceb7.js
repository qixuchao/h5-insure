import{u as e,aI as o,D as t}from"./index-d66a20d8.js";import{ref as a,onMounted as n}from"vue";import{u as r,b as u,c}from"./core-15eeb464.js";import{u as s}from"./useThread-c502137a.js";import"./pdfh5-e588f83d.js";const v={key:0,class:"wait-loading"},l={key:1,class:"result-view"},d={class:"content-box"},i=vue.createElementVNode("div",{class:"content"},"开通成功，正在为您生成保单...",-1),m=vue.createElementVNode("div",{class:"tip"},"请勿返回或退出",-1),p=vue.defineComponent({__name:"payCheck",setup(p){const f=e().query,h=o(),k=a(!1),C=a(!1),N=a(""),w=a(!0);let g;const x=()=>{u({tenantId:f.tenantId,orderNo:f.orderNo}).then((e=>{const{code:o,data:t}=e;"10000"===o&&(w.value=!1);const a=t.redirectUrl||`/baseInsurance/orderDetail?orderNo=${f.businessTradeNo}&tenantId=${f.tenantId}&productCode=${f.productCode}`;1==+t.status?(C.value=!0,g.stop(),window.location.href=a):1==+f.from_wxpay?k.value=!0:c(f)})).catch()};return g=s({start:()=>{console.log("开始轮询"),x()},stop:()=>{console.log("结束轮询"),C.value||t.alert({title:"提示",message:"未查到支付成功状态，请检查是否已支付完成",confirmButtonText:"好的，我知道了"}).then((()=>{window.location.href=N.value}))},time:2e3,number:5}),r(),n((()=>{1==+f.from_wxpay?(k.value=!0,g.run()):x()})),(e,o)=>{const t=vue.resolveComponent("van-icon"),a=vue.resolveComponent("ProPageWrap"),n=vue.resolveComponent("van-config-provider");return vue.openBlock(),vue.createBlock(n,{"theme-vars":vue.unref(h)},{default:vue.withCtx((()=>[vue.createVNode(a,{"main-class":"page-pay-check"},{default:vue.withCtx((()=>[vue.unref(w)&&!vue.unref(k)?(vue.openBlock(),vue.createElementBlock("div",v,"加载中，请稍候...")):vue.createCommentVNode("",!0),!vue.unref(w)&&vue.unref(k)?(vue.openBlock(),vue.createElementBlock("div",l,[vue.createElementVNode("div",d,[vue.createVNode(t,{name:"checked",class:"large-icon"}),i,m])])):vue.createCommentVNode("",!0)])),_:1})])),_:1},8,["theme-vars"])}}});export{p as default};
