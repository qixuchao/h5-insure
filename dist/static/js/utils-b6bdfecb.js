import{d as i,z as e,o as s,a1 as l,R as a,c as o,A as r,V as n,U as d,g as t,i as u,w as c,h as k,G as I,aT as p}from"./index-1813fb4b.js";/* empty css              */import{I as m}from"./index-cb89834d.js";import{S as v}from"./index-27dd17c6.js";import{l as y}from"./index-1f7f29b4.js";const V={key:0},f={key:0,class:"risk2-field"},g=i({name:"ProductRiskList"});var h=I(i({...g,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(i,{emit:I}){const y=i,g=e({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),h=i=>{const e=[];return i.riskLiabilityInfoVOList.map((i=>(1!=+i.showFlag&&e.push({...i}),[]))),e},R=(i,e,s)=>{var l;g.riskIsInsure[e].data=i;const a=[...g.disabledRiskInfo];null==(l=y.dataSource.insureProductRiskVOList)||l.forEach((i=>{if(1!==i.mainRiskFlag){const e=g.riskIsInsure[i.riskId];e.data&&Object.keys(e.data).length>0&&!e.isDisabled&&a.push(e.data)}})),I("trialChange",a,s)},b=(i,e)=>{var s;null==(s=y.dataSource.productRiskRelationVOList)||s.forEach((s=>{1!==s.collocationType&&(e.riskId===s.riskId?(g.riskIsInsure[e.riskId]&&g.riskIsInsure[e.riskId].selected,2===s.collocationType&&g.riskIsInsure[s.collocationRiskId]&&(g.riskIsInsure[s.collocationRiskId].selected=i),3===s.collocationType&&g.riskIsInsure[s.collocationRiskId]&&(g.riskIsInsure[s.collocationRiskId].selected="1"===i?"2":"1")):e.riskId===s.collocationRiskId&&(3===s.collocationType&&g.riskIsInsure[s.riskId]&&(g.riskIsInsure[s.riskId].selected="1"===i?"2":"1"),2===s.collocationType&&g.riskIsInsure[s.riskId]&&(g.riskIsInsure[s.riskId].selected=i)))})),"2"===i?R({},e.riskId):(i=>{var e,s,l,a,o,r;if(1!==(null==i?void 0:i.factorDisPlayFlag)){const n=null==(e=null==i?void 0:i.productRiskInsureLimitVO)?void 0:e.amountPremiumConfigVO,d={riskCategory:i.riskCategory,riskCode:i.riskCode,riskName:i.riskName,riskId:i.riskId,riskType:i.riskType,mainRiskId:i.mainRiskId,mainRiskCode:i.mainRiskCode,liabilityVOList:h(i)};d.chargePeriod=(null==(s=null==i?void 0:i.paymentPeriodValueList)?void 0:s.length)>0&&(null==i?void 0:i.paymentPeriodValueList[0].code)||null,d.coveragePeriod=(null==(l=null==i?void 0:i.insurancePeriodValueList)?void 0:l.length)>0&&(null==i?void 0:i.insurancePeriodValueList[0].code)||null,d.paymentFrequency=(null==(a=null==i?void 0:i.paymentFrequencyList)?void 0:a.length)>0&&(null==i?void 0:i.paymentFrequencyList[0].code)||null;let t=0;1===n.displayType?t=(null==n?void 0:n.minStepValue)>0?null==n?void 0:n.minStepValue:0:3===n.displayType&&2===n.requireCopies?t=(null==(o=null==n?void 0:n.displayValues)?void 0:o.length)>0?null==n?void 0:n.displayValues[0].value:0:3===n.displayType&&1===n.requireCopies?(t=(null==(r=null==n?void 0:n.displayValues)?void 0:r.length)>0?null==n?void 0:n.displayValues[0].value:0,d.copy=n.minCopiesValue):2===n.displayType?d.copy=n.minCopiesValue:t=0,1===n.saleMethod?d.amount=t:d.premium=t,R(d,i.riskId)}})(e)};return s((()=>{(()=>{var i,e;g.riskIsInsure={},g.disabledRiskInfo=[];let s=null;if(null==(i=y.dataSource.insureProductRiskVOList)||i.forEach((i=>{var e;const l=1!==i.mainRiskFlag?null==(e=y.dataSource.productRiskRelationVOList)?void 0:e.find((e=>e.collocationRiskId===i.riskId)):{};1===i.mainRiskFlag&&(s=i),g.riskIsInsure[i.riskId]={selected:"2",data:null,relation:l,isMust:!1}})),s){const i=null==(e=y.dataSource.productRiskRelationVOList)?void 0:e.filter((i=>i.riskId===s.riskId));if(!i)return;null==i||i.forEach((i=>{var e,s,l,a,o,r,n,d,t;if(2===i.collocationType){g.riskIsInsure[i.collocationRiskId].selected="1",g.riskIsInsure[i.collocationRiskId].isMust=!0;const u=null==(e=y.dataSource.insureProductRiskVOList)?void 0:e.find((e=>i.collocationRiskId===e.riskId));if(u&&1!==u.factorDisPlayFlag&&(null==(s=null==u?void 0:u.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO)){const e=null==(l=u.riskLiabilityInfoVOList)?void 0:l.every((i=>1!==i.showFlag)),s=null==(a=null==u?void 0:u.productRiskInsureLimitVO)?void 0:a.amountPremiumConfigVO;if(e){g.riskIsInsure[i.collocationRiskId].isDisabled=!0;const e={riskCategory:u.riskCategory,riskCode:u.riskCode,riskName:u.riskName,riskId:u.riskId,riskType:u.riskType,mainRiskId:u.mainRiskId,mainRiskCode:u.mainRiskCode,liabilityVOList:h(u)};e.chargePeriod=(null==(o=null==u?void 0:u.paymentPeriodValueList)?void 0:o.length)>0&&(null==u?void 0:u.paymentPeriodValueList[0].code)||null,e.coveragePeriod=(null==(r=null==u?void 0:u.insurancePeriodValueList)?void 0:r.length)>0&&(null==u?void 0:u.insurancePeriodValueList[0].code)||null,e.paymentFrequency=(null==(n=null==u?void 0:u.paymentFrequencyList)?void 0:n.length)>0&&(null==u?void 0:u.paymentFrequencyList[0].code)||null;let l=0;1===s.displayType?l=(null==s?void 0:s.minStepValue)>0?null==s?void 0:s.minStepValue:0:3===s.displayType&&2===s.requireCopies?l=(null==(d=null==s?void 0:s.displayValues)?void 0:d.length)>0?null==s?void 0:s.displayValues[0].value:0:3===s.displayType&&1===s.requireCopies?(l=(null==(t=null==s?void 0:s.displayValues)?void 0:t.length)>0?null==s?void 0:s.displayValues[0].value:0,e.copy=s.minCopiesValue):2===s.displayType&&(e.copy=s.minCopiesValue),1===s.saleMethod?e.amount=l:e.premium=l,g.disabledRiskInfo.push(e),R(e,u.riskId)}}}3===i.collocationType&&(g.riskIsInsure[i.collocationRiskId].selected="2",g.riskIsInsure[i.collocationRiskId].isMust=!0)}))}})()})),l((()=>{g.loading=!0})),a((()=>g.riskIsInsure),(i=>{}),{deep:!0,immediate:!0}),a((()=>y.defaultValue),(i=>{(null==i?void 0:i.length)>0&&i.forEach((i=>{g.risksDefaultValue[i.riskCode]=i,g.riskIsInsure[i.riskId]&&(g.riskIsInsure[i.riskId].selected="1",R(i,i.riskId))}))}),{deep:!0,immediate:!0}),(e,s)=>{const l=v,a=p;return o(!0),r(d,null,n(i.dataSource.insureProductRiskVOList,(e=>{var s,n;return o(),r(d,{key:e.riskCode},[(!i.showMainRisk&&1!==e.mainRiskFlag||i.showMainRisk)&&(null==(n=null==(s=t(g).riskIsInsure)?void 0:s[e.riskId])?void 0:n.relation)?(o(),r("div",V,[u(a,{modelValue:t(g).riskIsInsure[e.riskId].selected,"onUpdate:modelValue":i=>t(g).riskIsInsure[e.riskId].selected=i,label:e.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:c((()=>[u(l,{modelValue:t(g).riskIsInsure[e.riskId].selected,"onUpdate:modelValue":i=>t(g).riskIsInsure[e.riskId].selected=i,"active-value":"1","inactive-value":"2",size:"26px",disabled:t(g).riskIsInsure[e.riskId].isMust,style:{"margin-right":"8px"},onChange:i=>b(i,e)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===t(g).riskIsInsure[e.riskId].selected?(o(),r("div",f,[u(m,{modelValue:t(g).riskIsInsure[e.riskId].data,"onUpdate:modelValue":i=>t(g).riskIsInsure[e.riskId].data=i,"origin-data":e,"product-factor":i.dataSource.productFactor,"default-value":t(g).risksDefaultValue[e.riskCode],onTrialChange:(i,s)=>R(i,e.riskId,s)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):k("",!0)])):k("",!0)],64)})),128)}}}),[["__scopeId","data-v-212a02af"]]);const R=(i,e,s)=>{var l,a,o,r;const n=i,{holder:d}=s,t=s.insuredVOList[0],u=(e||"").split("_");if(u.length<2)return e;if(y.exports.isNaN(Number(u[1])))return e;if(u[1]-=1,1===n.exemptFlag){if("to"===u[0]){let i=0;1===n.exemptType?(null==(l=null==d?void 0:d.personVO)?void 0:l.birthday)&&(i=parseInt(""+((new Date).getTime()-new Date(null==(a=d.personVO)?void 0:a.birthday).getTime())/31536e6,10)):2===n.exemptType&&(null==(o=null==t?void 0:t.personVO)?void 0:o.birthday)&&(i=parseInt(""+(+(new Date).getTime()-new Date(null==(r=t.personVO)?void 0:r.birthday).getTime())/31536e6,10)),u[1]=+u[1]-i}u[0]="year"}return u.join("_")},b=(i,e)=>{const s=[],l={};return i.forEach((i=>{l[i.riskId]=i})),null==e||e.forEach((i=>{var e,a,o,r;const{collocationType:n,collocationRiskId:d,riskId:t}=i;switch(n){case 2:{const i=null==(e=l[t])?void 0:e.riskName,o=null==(a=l[d])?void 0:a.riskName;s.push(`${i} 和 ${o} 必须同时投保`);break}case 3:{const i=null==(o=l[t])?void 0:o.riskName,e=null==(r=l[d])?void 0:r.riskName;s.push(`${i} 和 ${e} 不能同时投保`);break}}})),s};export{h as P,R as d,b as g};
