var ue=Object.defineProperty,de=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var K=(p,s,u)=>s in p?ue(p,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[s]=u,$=(p,s)=>{for(var u in s||(s={}))le.call(s,u)&&K(p,u,s[u]);if(X)for(var u of X(s))ce.call(s,u)&&K(p,u,s[u]);return p},W=(p,s)=>de(p,ie(s));import{g as Z,C as I,X as Y,r as m,h as _,j as L,k as i,y as c,n as d,m as M,E as ee,I as T,F as te,B as D,aj as fe,Q as pe,a5 as me,L as _e,x as ve,o as Ie,z as l,s as w}from"./vendor-fc34688e.js";import{_ as Ee,q as ye,G as h,F as A,P as Oe}from"./index-569184ea.js";import{c as Be,n as Ae,a as Le}from"./index-93460d78.js";import{_ as z,R as ge,B as Ce,a as Te}from"./index-e7e7a45c.js";import"./useDicData-5d4bcf64.js";import"./index-8a9e8c01.js";const he={class:"com-select-container"},De={class:"radio-item-wrapper"},Re={class:"name"},Fe={class:"hone"},be={class:"address"},Ne={class:"footer-button"},xe=D("\u53D6\u6D88"),He=D("\u786E\u8BA4"),Pe=Z({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(p,{emit:s}){const u=p,B=I(u.modelValue),R=I(u.show),q=()=>{s("submit",B.value),R.value=!1},P=()=>{s("close")};return Y(()=>u.modelValue,E=>{console.log("newVal",E),B.value=E}),Y(()=>B.value,E=>{s("update:modelValue",E)}),(E,g)=>{const C=m("van-radio"),n=m("van-radio-group"),F=m("VanButton");return _(),L(ye,{show:R.value,"onUpdate:show":g[1]||(g[1]=f=>R.value=f),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:P},{default:i(()=>[c("div",he,[d(n,{modelValue:B.value,"onUpdate:modelValue":g[0]||(g[0]=f=>B.value=f)},{default:i(()=>[(_(!0),M(te,null,ee(p.dataSource,(f,y)=>(_(),L(C,{key:y,name:y+1,class:"radio-item"},{default:i(()=>[c("div",De,[c("p",null,[c("span",Re,T(f.contactName),1),c("span",Fe,T(f.contactPhoneNo),1)]),c("p",be,T(f.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),c("div",Ne,[d(F,{plain:"",type:"primary"},{default:i(()=>[xe]),_:1}),d(F,{type:"primary",onClick:q},{default:i(()=>[He]),_:1})])]),_:1},8,["show"])}}});var ke=Ee(Pe,[["__scopeId","data-v-9c6de82e"]]);const Se={key:0,class:"beneficiary-part"},Ve={class:"part-title"},Ue={class:"title"},je=D("\u5220\u9664"),$e=D("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),we=D("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Me={class:"radio-item-wrapper"},Ye={class:"name"},qe={class:"hone"},Ge={class:"address"},We={class:"footer-button"},ze=D("\u4E0B\u4E00\u6B65"),nt=Z({setup(p){const s=fe(),u=pe(),{templateId:B=1,orderNo:R="2022072710380711215",tenantId:q="9991000007"}=u.query,[P,E]=me(),g=u.path==="/infoPreview"?"infoPreview":"infoCollection",C=I({}),n=I({extInfo:{pageCode:g},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),F=I(null),f=I([]),y=I([]),b=I([]),G=I([]),J=I([]),v=_e({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),N=ve(()=>{var t,e;return v.currentAddress?v.addressList[v.currentAddress]:((e=(t=n.value.extInfo)==null?void 0:t.contactInfo)==null?void 0:e[0])||{}}),ne=()=>{const t=$({},n.value);t.extInfo=W($({},t.extInfo),{contactInfo:[N.value]}),t.tenantOrderAttachmentList=[{category:h.OBVERSE_CERT,objectType:A.HOLDER,objectId:n.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:f.value[0],id:b.value[0]},{category:h.REVERSE_CERT,objectType:A.HOLDER,objectId:n.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:f.value[1],id:b.value[1]},{category:h.OBVERSE_CERT,objectType:A.INSURED,objectId:n.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:y.value[0],id:G.value[1]},{category:h.REVERSE_CERT,objectType:A.INSURED,objectId:n.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:y.value[1],id:G.value[1]}],F.value.validate().then(e=>{Ae(t).then(({code:r,data:o})=>{r==="10000"&&o.pageAction.pageAction==="jumpToPage"&&s.push({path:Oe[o.pageAction.data.nextPageCode],query:u.query})})})},oe=t=>{console.log("value",t)},re=()=>{v.beneficiaryId+=1,n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:v.beneficiaryId,extInfo:{}})},ae=t=>{n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(e=>e.beneficiaryId!==t.beneficiaryId)},se=()=>{Le({orderNo:R,tenantId:q}).then(({code:t,data:e})=>{if(t==="10000"){const r=e;r.extInfo=W($({},r.extInfo),{pageCode:g,templateId:B}),r.tenantOrderHolder=r.tenantOrderHolder||{},r.tenantOrderHolder.extInfo=r.tenantOrderHolder.extInfo||{},r.tenantOrderInsuredList[0].extInfo=r.tenantOrderInsuredList[0].extInfo||{},r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{const O=o;return O.extInfo={},O}),r.tenantOrderAttachmentList.forEach(o=>{o.category===h.OBVERSE_CERT?o.objectType===A.HOLDER?(f.value[0]=o.uri,b.value[0]=o.id):o.objectType===A.INSURED&&(y.value[0]=o.uri,G.value[0]=o.id):o.category===h.REVERSE_CERT&&(o.objectType===A.HOLDER?(f.value[1]=o.uri,b.value[1]=o.id):o.objectType===A.INSURED&&(y.value[1]=o.uri,b.value[1]=o.id))}),Object.assign(n.value,r)}}).finally(()=>{v.isLoading=!1})};return Ie(()=>{se(),Be({pageCode:"infoCollection",templateId:B}).then(({code:t,data:e})=>{if(t==="10000"){const r={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(o=>{(r[o.moduleType]=r[o.moduleType]||[]).push(o)}),C.value=r}})}),Y(()=>n.value,t=>{var e,r,o,O,k,x,S,V,U,j;if(t){const a=[{contactAddress:(r=(e=t.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:r.familyAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(O=(o=t.tenantOrderHolder)==null?void 0:o.extInfo)==null?void 0:O.workAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(x=(k=t.tenantOrderInsuredList[0])==null?void 0:k.extInfo)==null?void 0:x.familyAddress,contactName:(S=t.tenantOrderInsuredList[0])==null?void 0:S.name,contactPhoneNo:(V=t.tenantOrderInsuredList[0])==null?void 0:V.mobile},{contactAddress:(j=(U=t.tenantOrderInsuredList[0])==null?void 0:U.extInfo)==null?void 0:j.workAddress,contactName:t.tenantOrderInsuredList[0].name,contactPhoneNo:t.tenantOrderInsuredList[0].mobile}];v.addressList=a.filter(H=>H.contactAddress&&H.contactName&&H.contactPhoneNo)}},{deep:!0,immediate:!0}),Y(()=>n.value.tenantOrderInsuredList[0].relationToHolder,t=>{+t==1&&Object.assign(n.value.tenantOrderInsuredList[0],n.value.tenantOrderHolder,{id:n.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(t,e)=>{const r=m("ProCard"),o=m("ProRadioButton"),O=m("ProField"),k=m("ProSvg"),x=m("VanButton"),S=m("ProCheckButton"),V=m("van-cell"),U=m("ProForm"),j=m("ProPageWrap");return _(),L(j,{class:"page-info-wrapper"},{default:i(()=>[l(v).isLoading?w("",!0):(_(),L(U,{key:0,ref_key:"formRef",ref:F},{default:i(()=>[d(r,{title:"\u6295\u4FDD\u4EBA"},{default:i(()=>[d(z,{images:f.value,"onUpdate:images":e[0]||(e[0]=a=>f.value=a),"form-info":n.value.tenantOrderHolder,"factor-list":C.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),d(r,{title:"\u88AB\u4FDD\u4EBA"},{default:i(()=>[d(O,{modelValue:n.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:i(()=>[d(o,{modelValue:n.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.tenantOrderInsuredList[0].relationToHolder=a),options:l(ge)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+n.value.tenantOrderInsuredList[0].relationToHolder!=1?(_(),L(z,{key:0,images:y.value,"onUpdate:images":e[3]||(e[3]=a=>y.value=a),"form-info":n.value.tenantOrderInsuredList[0],"factor-list":C.value.INSURER||[]},null,8,["images","form-info","factor-list"])):w("",!0),d(O,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),d(r,{title:"\u53D7\u76CA\u4EBA"},{default:i(()=>[d(O,{modelValue:n.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:i(()=>[d(o,{modelValue:n.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[4]||(e[4]=a=>n.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:l(Ce)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),n.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(_(),M("div",Se,[(_(!0),M(te,null,ee(n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(a,H)=>(_(),M("div",{key:a.beneficiaryId||a.id,class:"beneficiary-item"},[c("div",Ve,[c("span",Ue,T(`\u53D7\u76CA\u4EBA${H+1}`),1),d(k,{name:"delete",onClick:Q=>ae(a)},{default:i(()=>[je]),_:2},1032,["onClick"])]),d(z,{images:J.value,"onUpdate:images":e[6]||(e[6]=Q=>J.value=Q),"form-info":a,"factor-list":C.value.BENEFICIARY||[]},null,8,["images","form-info","factor-list"]),d(Te,{"form-info":a,"factor-list":C.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),d(x,{onClick:re},{default:i(()=>[$e]),_:1})])):w("",!0)]),_:1}),d(r,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:i(()=>[Object.keys(l(N)).length?(_(),L(V,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:e[8]||(e[8]=a=>l(E)(!0))},{title:i(()=>[c("div",Me,[c("p",null,[c("span",Ye,T(l(N).contactName),1),c("span",qe,T(l(N).contactPhoneNo),1)]),c("p",Ge,T(l(N).contactAddress),1)])]),_:1})):(_(),L(S,{key:0,activated:"",onClick:e[7]||(e[7]=a=>l(E)(!0))},{default:i(()=>[we]),_:1}))]),_:1})]),_:1},512)),c("div",We,[d(x,{block:"",type:"primary",onClick:ne},{default:i(()=>[ze]),_:1})]),l(P)?(_(),L(ke,{key:1,modelValue:l(v).currentAddress,"onUpdate:modelValue":e[9]||(e[9]=a=>l(v).currentAddress=a),show:l(P),"data-source":l(v).addressList,onSubmit:oe,onClose:e[10]||(e[10]=a=>l(E)(!1))},null,8,["modelValue","show","data-source"])):w("",!0)]),_:1})}}});export{nt as default};
