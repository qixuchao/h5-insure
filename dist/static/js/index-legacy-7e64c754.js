!function(){var e=document.createElement("style");e.innerHTML='@charset "UTF-8";.com-product-risk-wrapper .popup-container[data-v-1fbe738d]{background-color:#f2f5fc}.com-product-risk-wrapper .popup-container .popup-title[data-v-1fbe738d]{height:1.38667rem;display:flex;align-items:center;justify-content:center;padding:0 .85333rem;font-size:.45333rem;font-weight:600;background-color:#fff}.com-product-risk-wrapper .part-card[data-v-1fbe738d]{background-color:#fff;margin-bottom:.26667rem}.com-product-risk-wrapper .risk-content[data-v-1fbe738d] .van-collapse-item__title--expanded{padding:0 .4rem 0 0;display:flex;align-items:center}.com-product-risk-wrapper .risk-content[data-v-1fbe738d] .van-collapse-item__content{padding:0}.com-product-risk-wrapper .plan-risk[data-v-1fbe738d] .van-tabs__line{display:none}.com-product-risk-wrapper .footer-bar[data-v-1fbe738d]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4}.com-product-risk-wrapper .footer-bar .trial-result[data-v-1fbe738d]{width:5.86667rem;color:#ff5840;font-size:.32rem;font-weight:600}.com-product-risk-wrapper .footer-bar .trial-result .result-num[data-v-1fbe738d]{font-size:.61333rem;font-weight:500;margin-left:.17333rem}.com-product-risk-wrapper .footer-bar .trial-operate button[data-v-1fbe738d]{width:3.73333rem}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip[data-v-1fbe738d]{position:absolute;z-index:122;height:.56rem;border-radius:1.33333rem;background-color:#ff5840;font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC,sans-serif;font-weight:400;color:#fff;line-height:.49333rem;padding:.04rem .28rem .02667rem .26667rem;right:.4rem;top:-.56rem;display:flex;align-items:center}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip .close-icon[data-v-1fbe738d]{margin-left:.17333rem}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip[data-v-1fbe738d]:after{content:" ";position:absolute;z-index:11;width:0;height:0;border:.13333rem solid transparent;border-top:.13333rem solid #ff5840;border-right:.13333rem solid #ff5840;right:.49333rem;bottom:-.26667rem}\n',document.head.appendChild(e),System.register(["./vendor-legacy-c0d7778e.js","./trial-legacy-fd2c3a57.js","./index-legacy-e9fcc05e.js","./index-legacy-deb8466a.js"],(function(e){"use strict";var r,t,i,a,o,s,n,l,d,c,p,u,f,m,k,g,v,b,h,V,O,y,L,P,w,R;return{setters:[function(e){r=e.a,t=e.g,i=e.C,a=e.L,o=e.a3,s=e.x,n=e.X,l=e.o,d=e.r,c=e.h,p=e.m,u=e.n,f=e.k,m=e.y,k=e.z,g=e.j,v=e.s,b=e.a1,h=e.a2,V=e.B},function(e){O=e.P,y=e.R,L=e.i,P=e.p},function(e){w=e.g},function(e){R=e._}],execute:function(){e("u",r({id:"createProposal",state:()=>({proposalInfo:{},trialData:[]}),actions:{setProposalInfo(e){this.$state.proposalInfo=e},setTrialData(e){this.$state.trialData=e}}}));const I={class:"com-product-risk-wrapper"},D={class:"popup-container"},_=(e=>(b("data-v-1fbe738d"),e=e(),h(),e))((()=>m("div",{class:"popup-title"},"请选择保障方案",-1))),C={class:"risk-trial-wrapper"},F={key:0,class:"part-card"},S={key:1,class:"part-card"},T={class:"risk-content"},j={key:0,class:"risk"},x={class:"footer-bar"},B=V("确认"),N=t({props:{isShow:{type:Boolean,default:!1},type:{default:"add"},productId:{default:0},riskType:{default:1},formInfo:{default:{}},productData:{default:{}}},emits:["close","finished"],setup(e,{emit:r}){const t=e,b=i({personVO:{}}),h=i({insuredCode:"",personVO:{}}),V=i({}),R=i({}),N=i({}),A=i({}),E=i({}),z=a({currentPlan:"0",isShow:t.isShow,riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,enumList:{},ageRange:[],collapseName:["1"]});o("premium",E.value),o("source","proposal");const $=s((()=>{var e;let r="";if(null!==(e=z.riskData)&&void 0!==e&&e[0]){const e=z.riskData[0],t=((null==e?void 0:e.requiredRiderRiskVOList)||[]).map((e=>e.riskName));t.length&&(r=`特殊提示: ${e.riskName}和${t.join("、")}必须同时投保`)}return r})),M=()=>{const e=JSON.parse(JSON.stringify(V.value[z.currentPlan])),t=Object.values(e.riderRiskVOList).map((e=>{const r=e;if("3"===r.chargePeriod){const e=(V.value[z.currentPlan].chargePeriod||"").split("_");e[1]&&(e[1]-=1),r.chargePeriod=e.join("_")}return r.liabilityVOList=(r.liabilityVOList||[]).filter((e=>"-1"!==e.liabilityAttributeValue)).map((e=>{const r=e;return"0"===r.liabilityAttributeValue&&(r.liabilityAttributeValue=""),r})),r}));e.liabilityVOList=e.liabilityVOList.filter((e=>"-1"!==e.liabilityAttributeValue)).map((e=>{const r=e;return"0"===r.liabilityAttributeValue&&(r.liabilityAttributeValue=""),r}));const i={holder:{personVO:{...b.value.personVO,birthday:b.value.personVO.birthday?`${b.value.personVO.birthday} 00:00:00`:""}},productCode:z.riskBaseInfo.productCode,insuredVOList:[{...h.value,personVO:{...h.value.personVO,birthday:h.value.personVO.birthday&&`${h.value.personVO.birthday} 00:00:00`},productPlanVOList:[{planCode:z.currentPlan||"",riskVOList:[{...e,riderRiskVOList:t}]}]}]};P({...i}).then((({code:e,data:t})=>{if("10000"===e){z.retrialTip=!1,z.trialResult=t,z.canTrial=!1;const e={},a=(r=[])=>{r.forEach((r=>{var t;e[r.riskCode]=r,null!==(t=r.riskPremiumDetailVOList)&&void 0!==t&&t.length&&a(r.riskPremiumDetailVOList)}))};a(t.riskPremiumDetailVOList),Object.assign(E.value,e),r("finished",((e,r)=>{var t;const i=(e.insuredVOList[0].productPlanVOList[0].riskVOList[0].riderRiskVOList||[]).map((e=>({...e,premium:r[e.riskCode].premium})));return{proposalHolder:(null===(t=e.holder)||void 0===t?void 0:t.personVO)||{},proposalInsuredList:[{...e.insuredVOList[0].personVO,proposalInsuredProductList:[{productId:z.riskBaseInfo.id,productName:z.riskBaseInfo.productName,proposalProductRiskList:[{...e.insuredVOList[0].productPlanVOList[0].riskVOList[0],premium:r[e.insuredVOList[0].productPlanVOList[0].riskVOList[0].riskCode].premium,riderRiskVOList:i}]}]}]}})(i,e))}else z.retrialTip=!0}))},U=()=>{var e,r,t,i,a;Promise.all([null===(e=R.value)||void 0===e||null===(r=e.validateForm)||void 0===r?void 0:r.call(e),null===(t=N.value)||void 0===t||null===(i=t.validateForm)||void 0===i?void 0:i.call(t),null===(a=A.value)||void 0===a?void 0:a.validate()]).then((()=>{M()}))},H=()=>{r("close")},J=e=>{z.holderFactor=e.holderFactorList,z.insuredFactor=e.insuredFactorList,z.ageRange=e.ageRange};return n([()=>V.value,()=>b.value,()=>h.value],(e=>{e&&!z.canTrial&&(z.canTrial=!0,z.retrialTip=!0)}),{deep:!0}),n((()=>t.isShow),(e=>{z.isShow=e}),{immediate:!0}),n((()=>t.productId),(e=>{e&&L({productId:t.productId,source:2}).then((({code:e,data:r})=>{"10000"===e&&(z.riskBaseInfo=r.productBasicInfoVO,(r.productRelationPlanVOList||r.riskDetailVOList||[]).forEach(((e,r)=>{0===r&&(z.currentPlan=e.planCode||"0"),Object.assign(V.value,{[e.planCode||r]:{liabilityVOList:[],riderRiskVOList:{}}})})),z.riskData=r.riskDetailVOList||[],z.riskPlanData=r.productRelationPlanVOList||[])})).finally((()=>{}))}),{immediate:!0}),n((()=>t.formInfo),((e={})=>{if("edit"===t.type){const r={0:{...e.proposalProductRiskList[0],riderRiskVOList:e.proposalProductRiskList[0].proposalProductRiskVOList}};Object.assign(V.value,r)}}),{deep:!0,immediate:!0}),n((()=>t.productData),(e=>{"edit"===t.type&&(z.riskBaseInfo=e.productBasicInfoVO,z.riskData=e.riskDetailVOList)}),{deep:!0,immediate:!0}),l((()=>{w({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then((({code:e,data:r})=>{if("10000"===e){const e={};r.forEach((r=>{e[r.dictCode]=r.dictItemList})),z.enumList=e}}))})),(e,r)=>{const t=d("ProMessage"),i=d("ProTitle"),a=d("VanForm"),o=d("VanButton"),s=d("VanPopup");return c(),p("div",I,[u(s,{show:k(z).isShow,"onUpdate:show":r[0]||(r[0]=e=>k(z).isShow=e),round:"",position:"bottom",closeable:"",style:{height:"80%"},onClose:H},{default:f((()=>{var e,r;return[m("div",D,[_,k($)?(c(),g(t,{key:0,content:k($)},null,8,["content"])):v("",!0),m("div",C,[k(z).holderFactor.length?(c(),p("div",F,[u(i,{title:"投保人"}),u(O,{ref_key:"holderRef",ref:R,"insured-code":null===(e=k(z).riskBaseInfo)||void 0===e?void 0:e.insurerCode,"form-info":b.value.personVO,"factor-list":k(z).holderFactor,"age-range":k(z).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):v("",!0),k(z).insuredFactor.length?(c(),p("div",S,[u(i,{title:"被保人"}),u(O,{ref_key:"insuredRef",ref:N,"insured-code":null===(r=k(z).riskBaseInfo)||void 0===r?void 0:r.insurerCode,"form-info":h.value.personVO,"factor-list":k(z).insuredFactor,"age-range":k(z).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):v("",!0),m("div",T,[u(i,{title:"投保方案"}),k(z).riskData.length?(c(),p("div",j,[u(a,{ref_key:"riskFormRef",ref:A,"input-align":"right","error-message-align":"right"},{default:f((()=>[u(y,{"risk-info":V.value[0],enums:k(z).enumList,"origin-data":k(z).riskData,"pick-factor":J},null,8,["risk-info","enums","origin-data"])])),_:1},512)])):v("",!0)])]),m("div",x,[u(o,{block:"",type:"primary",onClick:U},{default:f((()=>[B])),_:1})])])]})),_:1},8,["show"])])}}});e("P",R(N,[["__scopeId","data-v-1fbe738d"]]))}}}))}();
