import{aE as e,d as a,r as s,bX as t,z as o,bl as l,R as r,bm as d,i,aJ as u,aL as n,bk as c,aP as p,$ as v,bY as m,aS as h,G as g,an as f,c as C,A as y,f as k,g as P,E as b,U as L,V as w,k as x,a6 as _,L as S,a9 as V,a1 as I,bZ as T,o as j,F as $,h as M,w as D,b_ as U,a2 as B,j as F,bu as H,ay as N,B as O,bB as q,al as A,am as E,bJ as Y,aA as z,bL as J,e as R,bv as G,bK as K,a as W,u as X,ac as Z,b as Q,ao as ee}from"./index-2ad6f565.js";import{L as ae}from"./index-3b50030a.js";import{S as se}from"./index-6dd73fd9.js";import{P as te}from"./index-d01e175e.js";import{e as oe}from"./empty-c926d8ec.js";import{P as le,u as re}from"./ProductTips-a6a114db.js";import{q as de,a as ie}from"./proposalList-6ef409aa.js";import{P as ue}from"./index-4645d7ab.js";import{a as ne}from"./trial-ae8ad1b8.js";import"./pdfh5-008ca364.js";const[ce,pe,ve]=e("pull-refresh"),me=["pulling","loosing","success"];const he=h(a({name:ce,props:{disabled:Boolean,modelValue:Boolean,headHeight:u(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:n,successDuration:u(500),animationDuration:u(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:a,slots:u}){let n;const h=s(),g=s(),f=t(h),C=o({status:"normal",distance:0,duration:0}),y=l(),k=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},P=()=>"loading"!==C.status&&"success"!==C.status&&!e.disabled,b=(s,t)=>{const o=+(e.pullDistance||e.headHeight);C.distance=s,C.status=t?"loading":0===s?"normal":s<o?"pulling":"loosing",a("change",{status:C.status,distance:s})},L=()=>{const{status:a}=C;return"normal"===a?"":e[`${a}Text`]||ve(a)},w=()=>{const{status:e,distance:a}=C;if(u[e])return u[e]({distance:a});const s=[];return me.includes(e)&&s.push(i("div",{class:pe("text")},[L()])),"loading"===e&&s.push(i(c,{class:pe("loading")},{default:L})),s},x=e=>{n=0===m(f.value),n&&(C.duration=0,y.start(e))},_=e=>{P()&&x(e)},S=()=>{n&&y.deltaY.value&&P()&&(C.duration=+e.animationDuration,"loosing"===C.status?(b(+e.headHeight,!0),a("update:modelValue",!0),v((()=>a("refresh")))):b(0))};return r((()=>e.modelValue),(a=>{C.duration=+e.animationDuration,a?b(+e.headHeight,!0):u.success||e.successText?(C.status="success",setTimeout((()=>{b(0)}),+e.successDuration)):b(0,!1)})),d("touchmove",(a=>{if(P()){n||x(a);const{deltaY:s}=y;y.move(a),n&&s.value>=0&&y.isVertical()&&(p(a),b((a=>{const s=+(e.pullDistance||e.headHeight);return a>s&&(a=a<2*s?s+(a-s)/2:1.5*s+(a-2*s)/4),Math.round(a)})(s.value)))}}),{target:g}),()=>{var e;const a={transitionDuration:`${C.duration}ms`,transform:C.distance?`translate3d(0,${C.distance}px, 0)`:""};return i("div",{ref:h,class:pe()},[i("div",{ref:g,class:pe("track"),style:a,onTouchstartPassive:_,onTouchend:S,onTouchcancel:S},[i("div",{class:pe("head"),style:k()},[w()]),null==(e=u.default)?void 0:e.call(u)])])}}}));const ge={class:"com-product-item"},fe={class:"content-wrap"},Ce={class:"product-image"},ye={class:"insure-name"},ke={class:"product-info"},Pe={class:"title"},be={class:"description"},Le={class:"tags"};var we=g(a({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const a=e,{productInfo:s}=f(a),t=o({checked:!1});return f(t),(a,t)=>{var o,l,r,d;const u=_;return C(),y("div",ge,[k("div",fe,[k("div",Ce,[i(u,{src:null==(o=P(s).showConfig)?void 0:o.fileUrl},null,8,["src"]),k("p",ye,b((P(s).insurerName||"").substring(0,6)),1)]),k("div",ke,[k("p",Pe,b(null==(l=P(s).showConfig)?void 0:l.title),1),k("p",be,b(null==(r=P(s).showConfig)?void 0:r.text),1),k("p",Le,[(C(!0),y(L,null,w(null==(d=P(s).showConfig)?void 0:d.tags,((e,a)=>(C(),y("span",{key:a,class:"tag"},b(e),1)))),128))])]),x(a.$slots,"checkedProduct",{},void 0,!0)]),i(le,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-2817dd39"]]);const xe=["xlink:href"],_e=a({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const a=e,s=S((()=>`#icon-${a.name}`)),t=S((()=>a.name?`svg-icon icon-${a.name}`:"svg-icon"));return(a,o)=>(C(),y("svg",V({class:P(t)},a.$attrs,{style:{color:e.color}}),[k("use",{"xlink:href":P(s)},null,8,xe)],16))}});const Se=e=>(A("data-v-1bfdb749"),e=e(),E(),e),Ve={class:"com-tab-filter"},Ie={class:"article-mid"},Te={class:"article-tag"},je=["onClick"],$e=Se((()=>k("span",null,null,-1))),Me={class:"popup-inner"},De=Se((()=>k("div",{class:"popup-title"},"保险公司",-1))),Ue={class:"footer-button"};var Be=g(a({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:a}){const{isPopShow:t,openPop:l,closePop:r}=function(e=!1){const a=s(e);return{isPopShow:a,openPop:e=>{e instanceof Function&&e(),a.value=!0},closePop:e=>{a.value=!1,e instanceof Function&&e()}}}(!1),d=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:u,checkedInsure:n}=f(d),c=s(""),p=()=>{n.value=[]},v=()=>{var e;const{productCategoryId:s}=(null==(e=d.productCategoryList)?void 0:e[c.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:s}),r()};return I((()=>{T().then((e=>{const{code:a,data:s}=e;"10000"===a&&(u.value=null==s?void 0:s.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),j((()=>{de().then((e=>{const{code:a,data:s}=e||{};"10000"===a&&N(s)&&(d.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...s])}))})),(s,o)=>{const m=O,h=q;return C(),y("div",Ve,[k("div",Ie,[k("div",Te,[(C(!0),y(L,null,w(P(d).productCategoryList,((e,s)=>(C(),y("div",{key:s,class:$(["tag-item",{checked:P(c)==s}]),onClick:t=>((e,s)=>{var t;c.value=s;const{productCategoryId:o}=(null==(t=d.productCategoryList)?void 0:t[c.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:o})})(null==e||e.productCategoryId,s)},[k("div",{class:$(["tag-out",{checked:P(c)==s}])},[k("div",{class:$(["tag-item-text",{checked:P(c)==s}])},b(e.productCategoryName),3)],2)],10,je)))),128))]),e.filter?(C(),y("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>P(l)&&P(l)(...e))},[$e,k("div",{class:$(["text",{"has-select-condition":P(n).length>0}])},"筛选",2),i(_e,{name:"filter"})])):M("",!0),i(h,{show:P(t),position:"right","close-on-click-overlay":"",style:H(e.popupStyle||{width:"322px",height:"100%",padding:"0 15px"}),onClickOverlay:P(r)},{default:D((()=>[k("div",Me,[De,i(U,{modelValue:P(n),"onUpdate:modelValue":o[1]||(o[1]=e=>B(n)?n.value=e:null),options:P(u)},null,8,["modelValue","options"])]),k("div",Ue,[i(m,{plain:"",type:"primary",onClick:p},{default:D((()=>[F("重置")])),_:1}),i(m,{type:"primary",onClick:v},{default:D((()=>[F("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])])])}}}),[["__scopeId","data-v-1bfdb749"]]);const Fe={class:"com-trial-product-wrapper"},He={class:"container"},Ne=(e=>(A("data-v-49f70a68"),e=e(),E(),e))((()=>k("span",{class:"title"}," 已选产品 ",-1))),Oe={class:"popup-body"},qe={class:"cell-title"},Ae={class:"title"},Ee=a({name:"TrialProductPopup"});var Ye=g(a({...Ee,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:a}){const t=e,o=s([]),l=s([]),d=s({isShow:t.isShow}),u=()=>{a("close")},n=()=>{l.value=[],a("checked",[])},c=e=>{var s,t,r;null==(r=null==(t=null==(s=null==o?void 0:o.value)?void 0:s[e])?void 0:t.toggle)||r.call(t),a("checked",l.value)};return r((()=>t.isShow),(e=>{d.value.isShow=e})),r(l,((e=[])=>{a("update:modalValue",e)}),{deep:!0,immediate:!0}),r((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(a,s)=>{const t=Y,r=z,p=K,v=J,m=q;return C(),y("div",Fe,[i(m,{show:P(d).isShow,"onUpdate:show":s[1]||(s[1]=e=>P(d).isShow=e),position:"bottom",onClose:u},{default:D((()=>[k("div",He,[k("div",{class:"popup-header"},[k("span",{class:"clear-all",onClick:n}," 清空选项 "),Ne,k("span",{class:"close",onClick:u})]),k("div",Oe,[i(v,{modelValue:P(l),"onUpdate:modelValue":s[0]||(s[0]=e=>B(l)?l.value=e:null)},{default:D((()=>[i(p,{inset:""},{default:D((()=>[(C(!0),y(L,null,w(e.proposalList,(e=>(C(),R(r,{key:e.productCode,title:e.productName,onClick:a=>c(e.productCode)},{"right-icon":D((()=>{var a;return[i(t,{ref_for:!0,ref:a=>P(o)[e.productCode]=a,shape:"square","model-value":null==(a=P(l))?void 0:a.includes(e.productCode),name:e.productCode,onClick:G((a=>c(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:D((()=>[k("div",qe,[k("div",Ae,b(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const ze={class:"search-wrap"},Je={class:"page-proposal-list"},Re={class:"check-button"},Ge={key:1,class:"van-sticky"},Ke={class:"add-plan"},We={class:"has-select-product"},Xe=(e=>(A("data-v-0b66fd1b"),e=e(),E(),e))((()=>k("span",{class:"icon"},null,-1))),Ze=a({name:"ProposalList"});var Qe=g(a({...Ze,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const a=re(),s=W(),t=X(),{isCreateProposal:l}=t.query,r=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1}),{searchValue:d,tagLists:u,isOpen:n,loading:c,finished:p,refreshing:v,productList:m,selectProduct:h,insurerCodeList:g,showCategory:x,productTotal:_,showFooter:V}=f(r);Z();const[I,T]=Z(),$=()=>{const{excludeProductCodeList:e}=r;ie({title:d.value,insurerCodeList:g.value,showCategory:x.value,excludeProductCodeList:Array.isArray(e)?e:[],pageNum:1,pageSize:999}).then((e=>{const{code:a,data:s,total:t}=e;"10000"===a&&(m.value=null==s?void 0:s.datas,_.value=t)}))},U=e=>{$()},H=e=>{const{selectInsureCode:a,selectCategory:s}=e;g.value=a,x.value=s,$()},N=()=>{v.value&&(m.value=[],v.value=!1),$(),c.value=!1,_.value===m.value.length&&(p.value=!0)},q=()=>{s.push({path:"historyProposalList"})};S((()=>{var e;const{birthday:s,gender:t}=(null==(e=a.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:s,gender:t}}));const A=S((()=>m.value.length>0)),E=S((()=>m.value.filter((e=>r.selectProduct.includes(e.productCode))))),z=({productCode:e})=>l?(r.productCode=e,r.selectProduct.includes(e)?(r.selectProduct=r.selectProduct.filter((a=>a!==e)),!1):void(async(e,s)=>{const{code:t,data:o,message:l}=await ne({...a.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===t?(r.errorMsgMap[e]="","function"==typeof s&&s(!0)):r.errorMsgMap[e]=l})(e,(()=>{r.selectProduct.push(e)}))):(s.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),J=e=>{r.selectProduct=e},G=()=>{const e=r.proposalList.filter((e=>r.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));a.setTrialData(e),a.setSelectedProduct(r.selectProduct),s.back()},K=()=>{p.value=!0,c.value=!0,N()};return j((()=>{r.excludeProductCodeList=a.$state.excludeProduct})),(e,a)=>{const s=se,t=Y,o=ae,u=he,h=O,g=Q("ProPageWrap");return C(),y(L,null,[i(g,{class:"page-proposal"},{default:D((()=>[k("div",ze,[i(s,{modelValue:P(d),"onUpdate:modelValue":a[0]||(a[0]=e=>B(d)?d.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:U},null,8,["modelValue"]),i(Be,{filter:P(n),"onUpdate:filter":a[1]||(a[1]=e=>B(n)?n.value=e:null),"filter-class":"filter-area",onOnSelectInsure:H},null,8,["filter"])]),P(A)?M("",!0):(C(),R(te,{key:0,"empty-img":P(oe),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),k("div",Je,[i(u,{modelValue:P(v),"onUpdate:modelValue":a[3]||(a[3]=e=>B(v)?v.value=e:null),onRefresh:K},{default:D((()=>[i(o,{loading:P(c),"onUpdate:loading":a[2]||(a[2]=e=>B(c)?c.value=e:null),finished:P(p),"finished-text":P(A)?"- 已经到底了哦 -":"",onLoad:N},{default:D((()=>[(C(!0),y(L,null,w(P(m),(e=>(C(),R(we,{key:e.id,"product-info":e,"error-msg":P(r).errorMsgMap[e.productCode],onClick:a=>z(e)},ee({_:2},[P(l)?{name:"checkedProduct",fn:D((()=>[k("div",Re,[(C(),R(t,{key:e.id,name:e.productCode,"model-value":P(r).selectProduct.includes(e.productCode),shape:"square"},null,8,["name","model-value"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),P(l)&&P(V)?(C(),y("div",Ge,[k("div",Ke,[k("p",{class:"has-select",onClick:a[4]||(a[4]=e=>P(T)(!P(I)))},[F(" 已选"),k("span",We,b(P(r).selectProduct.length),1),F("款产品 "),Xe]),i(h,{type:"primary",disabled:!P(r).selectProduct.length,onClick:G},{default:D((()=>[F("添加计划书")])),_:1},8,["disabled"])])])):M("",!0),i(Ye,{"modal-value":P(r).selectProduct,"proposal-list":P(E),"is-show":P(I),onClose:a[5]||(a[5]=e=>P(T)(!1)),onChecked:J},null,8,["modal-value","proposal-list","is-show"])])),_:1}),P(l)?M("",!0):(C(),R(ue,{key:0,"button-image":P("/static/png/lishijihuashu-b6958e78.png"),onClick:q},null,8,["button-image"]))],64)}}}),[["__scopeId","data-v-0b66fd1b"]]);export{Qe as default};
