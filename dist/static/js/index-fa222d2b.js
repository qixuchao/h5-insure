var ae=Object.defineProperty,le=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var z=(l,t,s)=>t in l?ae(l,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[t]=s,x=(l,t)=>{for(var s in t||(t={}))ne.call(t,s)&&z(l,s,t[s]);if(U)for(var s of U(t))se.call(t,s)&&z(l,s,t[s]);return l},T=(l,t)=>le(l,te(t));import{g as oe,a0 as K,Q as ie,L as re,C as k,v as ve,ab as R,m,n as o,j as r,z as c,G as Y,T as f,D as ce,r as b,a5 as pe,k as d,I as V,a6 as N,B as D,a2 as me,a3 as de,y as j,d as ye}from"./vendor-e9263418.js";import{k as Fe,l as Be}from"./customer-13670369.js";import{u as g}from"./useCheckBack-f80d3d5c.js";import{_ as _e}from"./plugin-vue_export-helper-46f75680.js";import"./index-b8742a0a.js";const G=l=>(me("data-v-417e7228"),l=l(),de(),l),fe={class:"family-edit"},be=D(" \u5BB6\u5EAD\u5173\u7CFB "),De=G(()=>j("span",{class:"star"},"*",-1)),he=D("\u59D3\u540D"),Ee=G(()=>j("span",{class:"star"},"*",-1)),Ce=D("\u8BC1\u4EF6\u7C7B\u578B"),ke={key:0,class:"value"},ge={key:1,class:"cell-val"},Ae={key:0,class:"footer"},we=D("\u5220\u9664"),$e=D("\u4FDD\u5B58"),qe={key:1,class:"footer"},xe=D("\u4FDD\u5B58"),Te=oe({setup(l){const t=K(),s=[{name:"\u8EAB\u4EFD\u8BC1",value:"01"},{name:"\u62A4\u7167",value:"07"},{name:"\u519B\u5B98\u8BC1",value:"04"},{name:"\u6E2F\u6FB3\u901A\u884C\u8BC1",value:"09"},{name:"\u53F0\u6E7E\u901A\u884C\u8BC1",value:"11"},{name:"\u51FA\u751F\u8BC1",value:"12"},{name:"\u5176\u4ED6",value:"99"}],L=[{name:"\u7236\u4EB2",value:"\u7236\u4EB2"},{name:"\u6BCD\u4EB2",value:"\u6BCD\u4EB2"},{name:"\u914D\u5076",value:"\u914D\u5076"},{name:"\u5973\u513F",value:"\u5973\u513F"},{name:"\u513F\u5B50",value:"\u513F\u5B50"},{name:"\u5176\u4ED6",value:"\u5176\u4ED6"}],Q=u=>{let e="";return u!=null&&u!==""&&(u.length===15?e=`19${u.substr(6,6)}`:u.length===18&&(e=u.substr(6,8)),e=e.replace(/(.{4})(.{2})/,"$1-$2-")),e},X=u=>{let e="";return s.forEach(B=>{B.value===u&&(e=B.name)}),e},Z=K(),n=ie(),A=re({birthday:"",certNo:"",certType:{lable:"",value:""},name:"",phone:"",relation:{label:"",value:""}});g(A);const h=k(!1),w=k(!1),$=k(),S=k("1"),{birthday:_,certNo:i,certType:v,name:y,phone:F,relation:p}=ve(A);R(()=>{console.log(">>>>>",n.query),i.value=n.query.certNo,_.value=n.query.birthday,F.value=n.query.phone,y.value=n.query.name,v.value.value=n.query.certType||"01",v.value.lable=X(n.query.certType)||"\u8EAB\u4EFD\u8BC1",p.value.value=n.query.relation,p.value.label=n.query.relation,g(A)}),R(()=>{var u;v.value.value==="01"&&((u=i.value)==null?void 0:u.length)>=15&&(_.value=Q(i.value))});const C=u=>{S.value=u,u==="1"?$.value=s:$.value=L,w.value=!0},H=u=>{_.value=ye(u).format("YYYY-MM-DD"),h.value=!1},J=u=>{S.value==="1"?(v.value.lable=u.name,v.value.value=u.value):(p.value.label=u.name,p.value.value=u.value)},M=async()=>{const u=/(^[\u4e00-\u9fa5Â·]{2,20}$)|(^[a-zA-Z.]{4,40}$)/,e=/^1[3-9]\d{9}$/,B=/^[0-9]*$/,E=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;if(!y.value||!p.value.value)return f("\u8BF7\u586B\u5199\u5FC5\u586B\u9879");if(!u.test(y.value))return f("\u8BF7\u586B\u5199\u6B63\u786E\u59D3\u540D");if(F.value&&!e.test(F.value))return f("\u8BF7\u8F93\u5165\u6B63\u786E\u624B\u673A\u53F7\u7801");if(v.value.value==="01"){if(i.value&&!E.test(i.value))return f("\u8BC1\u4EF6\u53F7\u7801\u6709\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165")}else if(i.value&&!B.test(i.value))return f("\u8BC1\u4EF6\u53F7\u7801\u6709\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165");await Fe(T(x({},n.query),{familyMember:{birthday:_.value,certNo:i.value,certType:v.value.value,name:y.value,phone:F.value,primaryKey:n.query.primaryKey,relation:p.value.value}})),g(),f("\u4FDD\u5B58\u6210\u529F\uFF01"),t.back()},O=async()=>{ce.confirm({title:"\u63D0\u793A",message:"\u60A8\u786E\u8BA4\u8981\u5220\u9664\u5BB6\u5EAD\u6210\u5458\u4FE1\u606F\u5417?"}).then(async()=>{await Be(T(x({},n.query),{familyMember:{birthday:_.value,certNo:i.value,certType:v.value.value,name:y.value,phone:F.value,primaryKey:n.query.primaryKey,relation:p.value.value}})),f("\u5220\u9664\u6210\u529F").$nextTick(()=>{g(),Z.back()})}).catch(()=>{})};return(u,e)=>{const B=b("van-cell"),E=b("van-field"),P=b("van-cell-group"),W=b("van-action-sheet"),ee=b("van-datetime-picker"),ue=b("van-popup"),q=b("van-button"),I=pe("resize");return d(),m("div",fe,[o(P,{inset:""},{default:r(()=>[o(B,{"is-link":"","title-class":"label"},{title:r(()=>[be,De]),value:r(()=>[c(p).value?(d(),m("span",{key:0,class:"value",onClick:e[0]||(e[0]=a=>C("2"))},V(c(p).label),1)):(d(),m("span",{key:1,onClick:e[1]||(e[1]=a=>C("2"))},"\u8BF7\u9009\u62E9"))]),_:1}),o(E,{modelValue:c(y),"onUpdate:modelValue":e[2]||(e[2]=a=>N(y)?y.value=a:null),"label-class":"label","input-align":"right",placeholder:"\u8BF7\u8F93\u5165\u6210\u5458\u59D3\u540D"},{label:r(()=>[he,Ee]),_:1},8,["modelValue"]),o(B,{"is-link":"","title-class":"label"},{title:r(()=>[Ce]),value:r(()=>[c(v).value?(d(),m("span",{key:0,class:"value",onClick:e[3]||(e[3]=a=>C("1"))},V(c(v).lable),1)):(d(),m("span",{key:1,onClick:e[4]||(e[4]=a=>C("1"))},"\u8BF7\u9009\u62E9"))]),_:1}),o(E,{modelValue:c(i),"onUpdate:modelValue":e[5]||(e[5]=a=>N(i)?i.value=a:null),"label-class":"label",label:"\u8BC1\u4EF6\u53F7\u7801","input-align":"right",placeholder:"\u8BF7\u8F93\u5165\u6210\u5458\u8BC1\u4EF6\u53F7\u7801"},null,8,["modelValue"]),o(B,{title:"\u51FA\u751F\u65E5\u671F","title-class":"label","is-link":"",onClick:e[6]||(e[6]=a=>h.value=!0)},{value:r(()=>[c(_)?(d(),m("span",ke,V(c(_)),1)):(d(),m("span",ge,"\u8BF7\u9009\u62E9\u6210\u5458\u51FA\u751F\u65E5\u671F"))]),_:1}),o(E,{modelValue:c(F),"onUpdate:modelValue":e[7]||(e[7]=a=>N(F)?F.value=a:null),"label-class":"label",type:"number",label:"\u624B\u673A\u53F7\u7801","input-align":"right",placeholder:"\u8BF7\u8F93\u5165\u6210\u5458\u7684\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1}),o(W,{show:w.value,"onUpdate:show":e[8]||(e[8]=a=>w.value=a),actions:$.value,"close-on-click-action":"","cancel-text":"\u53D6\u6D88",onSelect:J},null,8,["show","actions"]),o(ue,{show:h.value,"onUpdate:show":e[10]||(e[10]=a=>h.value=a),position:"bottom",style:{height:"40%"}},{default:r(()=>[o(ee,{type:"date",title:"\u9009\u62E9\u5E74\u6708\u65E5","min-date":new Date(1900,0,1),"max-date":new Date,onConfirm:H,onCancel:e[9]||(e[9]=a=>h.value=!1)},null,8,["min-date","max-date"])]),_:1},8,["show"]),c(n).query.name?Y((d(),m("div",Ae,[o(q,{plain:"",type:"primary",class:"btn1",onClick:O},{default:r(()=>[we]),_:1}),o(q,{type:"primary",class:"btn",onClick:M},{default:r(()=>[$e]),_:1})])),[[I]]):Y((d(),m("div",qe,[o(q,{type:"primary",class:"btn-enable",onClick:M},{default:r(()=>[xe]),_:1})])),[[I]])])}}});var ze=_e(Te,[["__scopeId","data-v-417e7228"]]);export{ze as default};
