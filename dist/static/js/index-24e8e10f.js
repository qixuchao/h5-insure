var ve=Object.defineProperty,fe=Object.defineProperties;var Ee=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable;var Z=(d,t,_)=>t in d?ve(d,t,{enumerable:!0,configurable:!0,writable:!0,value:_}):d[t]=_,ee=(d,t)=>{for(var _ in t||(t={}))Ce.call(t,_)&&Z(d,_,t[_]);if(X)for(var _ of X(t))De.call(t,_)&&Z(d,_,t[_]);return d},te=(d,t)=>fe(d,Ee(t));import{g as re,Q as ie,a5 as Fe,E as k,h as le,y as pe,r as w,j as C,n as g,z as u,A as y,p as E,m as F,F as P,G as U,L as Q,J as h,a6 as he,aj as ge,d as Ae,k as V,t as ue,a1 as me,a2 as ye,C as b,T as O,D as Ie}from"./vendor-83047d1f.js";import{b as Ne,n as Te,a as Re}from"./index-4e6f08ff.js";import{_ as ce,P as Y,S as be,E as xe,p as se,l as S,F as ae,N as oe}from"./index-5e859998.js";import{g as Oe,f as Se,s as ne,a as ke}from"./verify-2b3acd76.js";var we="/static/assets/sidenav.5031dada.png";const Pe={class:"com-navigator"},Ue=["src"],Le={class:"list"},$e=re({setup(d){const t=ie(),{saleUserId:_="D1234567-1",tenantId:q="9991000007",templateId:L=1,productCode:m="CQ75CQ76",insurerCode:$="ancheng",productCategory:H="1"}=t.query,[x,p]=Fe(!1),I=k([]),R=()=>{p(!0)};le(()=>{Ne({productCategory:H,venderCode:$,navbarFlag:1}).then(D=>{const{code:v,data:N}=D;v==="10000"&&(I.value=N.templatePageList)})});const n=pe(()=>Object.keys(Y).find(D=>Y[D]===t.path.replace("/","")));return(D,v)=>{const N=w("van-popup");return C(),g("div",Pe,[u("img",{class:"btn",src:y(we),onClick:R},null,8,Ue),E(N,{show:y(x),"onUpdate:show":v[0]||(v[0]=T=>he(x)?x.value=T:null),position:"right",style:{width:"50%",height:"100%"},"safe-area-inset-top":"",class:"navigation-popup"},{default:F(()=>[u("div",Le,[(C(!0),g(P,null,U(I.value,(T,j)=>(C(),g("div",{key:j,class:Q(["item",{active:T.pageCode===y(n)}])},h(T.pageName),3))),128))])]),_:1},8,["show"])])}}});var He=ce($e,[["__scopeId","data-v-4959b745"]]);const de=d=>(me("data-v-ab7a6660"),d=d(),ye(),d),je={class:"page-verify"},Me={class:"people"},Ve={class:"name"},Qe={class:"verify-item"},Ye=de(()=>u("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),qe={class:"no"},ze=b(" \u53BB\u8BA4\u8BC1 "),Ge={class:"sign-body"},We={class:"date"},Je={class:"file"},Ke=b(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A "),Xe={class:"people"},Ze={class:"name"},et={class:"verify-item"},tt=de(()=>u("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),ut={class:"no"},st=["onClick"],at=b(" \u53BB\u8BA4\u8BC1 "),ot=["onClick"],nt={class:"sign-body"},rt={class:"date"},it={class:"file"},lt=b(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A "),ct={class:"footer-button footer"},dt=b("\u63D0\u4EA4"),_t=re({setup(d){const t={CERT:1,NO_CERT:2},_=ie(),q=ge(),{saleUserId:L="D1234567-1",tenantId:m="9991000007",templateId:$=1,productCode:H="CQ75CQ76",insurerCode:x="ancheng"}=_.query;let{orderNo:p}=_.query;typeof p=="object"&&(p=(p||[])[0]);const I=new be({source:"localStorage"}),R=k([]),n=k(),D=k(),v=[],N=Ae().format("YYYY-MM-DD"),T=()=>{var s;(s=D.value)==null||s.clear()},j=s=>{v[s].clear()},z=(s,o)=>{ke({callbackUrl:window.location.href,certiNo:s,faceAuthMode:"TENCENT",userName:o,tenantId:9991000007}).then(r=>{const{code:i,data:l}=r;if(i==="10000"){const{originalUrl:f,serialNo:e}=l;window.location.href=f,I.set("verifyData",{serialNo:e,certNo:s,name:o})}})},G=s=>{var o,r,i,l;s===-1?z((o=n.value.tenantOrderHolder)==null?void 0:o.certNo,(r=n.value.tenantOrderHolder)==null?void 0:r.name):z((i=n.value.tenantOrderInsuredList[s])==null?void 0:i.certNo,(l=n.value.tenantOrderInsuredList[s])==null?void 0:l.name)},_e=s=>{s&&v.every(o=>o!==s)&&v.push(s)},Be=()=>{var o,r,i,l;if((o=D.value)==null?void 0:o.isEmpty()){O.fail("\u8BF7\u6295\u4FDD\u4EBA\u7B7E\u540D");return}if(v.some(f=>f.isEmpty())){O.fail("\u8BF7\u88AB\u4FDD\u4EBA\u7B7E\u540D");return}if(((i=(r=n.value.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:i.isCert)!==t.CERT){O.fail("\u8BF7\u6295\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}if((l=n.value.tenantOrderInsuredList)==null?void 0:l.some(f=>{var e;return((e=f.extInfo)==null?void 0:e.isCert)!==t.CERT})){O.fail("\u8BF7\u88AB\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}Ie.confirm({title:"\u63D0\u793A",message:"\u8BF7\u786E\u8BA4\u4FE1\u606F\u586B\u5199\u65E0\u8BEF\u540E\uFF0C\u518D\u8FDB\u884C\u652F\u4ED8"}).then(()=>{var e,B;const f=(e=D.value)==null?void 0:e.save();Promise.all([ne("HOLDER",f,(B=n.value)==null?void 0:B.id,`${m}`),...v.map(a=>{var c;return ne("INSURED",a.save(),(c=n.value)==null?void 0:c.id,`${m}`)})]).then(()=>{Te(te(ee({},n.value),{pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:{pageCode:"sign",templateId:$},venderCode:"ancheng"})).then(a=>{const{code:c,data:A}=a;c==="10000"&&A.success&&q.push({path:Y[A.pageAction.data.nextPageCode],query:{orderNo:p,saleUserId:L,tenantId:m}})})})})},W=()=>{Re({orderNo:p,saleUserId:L,tenantId:m}).then(s=>{const{code:o,data:r}=s;o==="10000"&&(n.value=r,setTimeout(()=>{let i=0;r.tenantOrderAttachmentList.forEach(l=>{l.category===21&&(l.objectType===2?(D.value.clear(),D.value.setDataURL(l.fileBase64)):l.objectType===1&&(v[i].clear(),v[i].setDataURL(l.fileBase64),i+=1))})}))})};return le(()=>{W(),Oe({orderNo:p,productCode:H,tenantId:m}).then(o=>{const{code:r,data:i}=o;r==="10000"&&(R.value=i||[])});const s=I.get("verifyData");if(s){const{serialNo:o,certNo:r,name:i}=s;Se({certiNo:r,orderNo:p,serialNo:o,tenantId:m,userName:i}).then(l=>{const{code:f,data:e}=l;f==="10000"&&(I.remove("verifyData"),W())})}}),(s,o)=>{const r=w("ProPDFviewer"),i=w("van-button"),l=w("ProPageWrap");return C(),V(l,null,{default:F(()=>{var f;return[u("div",je,[E(xe,{type:"warning",title:"\u5C0A\u656C\u7684\u5BA2\u6237\uFF0C\u672C\u6B21\u6295\u4FDD\u9700\u8981\u8FDB\u884C\u8EAB\u4EFD\u8BA4\u8BC1",content:"\u672C\u4EA7\u54C1\u6295\u4FDD\u9700\u8981\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\uFF0C\u60A8\u8D2D\u4E70\u672C\u4EA7\u54C1\u7684\u7D2F\u8BA1\u603B\u4FDD\u8D39\u5DF2\u8D85\u8FC720\u4E07\uFF0C\u6309\u76D1\u7BA1\u8981\u6C42\uFF0C\u9700\u8981\u63D0\u4F9B\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u3001\u6307\u5B9A\u53D7\u76CA\u4EBA\u8BC1\u4EF6\u5F71\u50CF\uFF0C\u672C\u4EA7\u54C1\u975E\u672C\u4EBA\u6295\u4FDD\u4E14\u5E26\u8EAB\u6545\u8D23\u4EFB\u3001\u9700\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\uFF08\u6210\u4EBA\uFF09\u7684\u6295\u4FDD\u610F\u613F\u8FDB\u884C\u7B7E\u5B57\u786E\u8BA4\u3002"}),E(S,{title:"\u6295\u4FDD\u4EBA",class:"card"},{extra:F(()=>{var e,B,a,c,A,M,J,K;return[u("div",Me,[u("div",Ve,h((B=(e=n.value)==null?void 0:e.tenantOrderHolder)==null?void 0:B.name),1),u("div",{class:Q(["status",{verified:((A=(c=(a=n.value)==null?void 0:a.tenantOrderHolder)==null?void 0:c.extInfo)==null?void 0:A.isCert)===t.CERT}])},h(((K=(J=(M=n.value)==null?void 0:M.tenantOrderHolder)==null?void 0:J.extInfo)==null?void 0:K.isCert)===t.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:F(()=>{var e,B,a,c,A;return[u("div",Qe,[Ye,u("div",qe,h((B=(e=n.value)==null?void 0:e.tenantOrderHolder)==null?void 0:B.certNo),1),((A=(c=(a=n.value)==null?void 0:a.tenantOrderHolder)==null?void 0:c.extInfo)==null?void 0:A.isCert)!==t.CERT?(C(),g("div",{key:0,class:"action",onClick:o[0]||(o[0]=M=>G(-1))},[ze,E(se,{name:"right_arrow",class:"icon"})])):ue("",!0)])]}),_:1}),E(S,{title:"\u6295\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:F(()=>[u("div",{class:"resign",onClick:T},"\u91CD\u7B7E")]),default:F(()=>[E(ae,{ref_key:"holderSign",ref:D,class:"sign"},null,512),u("div",Ge,[u("div",We,"\u7B7E\u540D\u65E5\u671F\uFF1A "+h(y(N)),1),u("div",Je,[Ke,(C(!0),g(P,null,U(R.value.filter(e=>e.noticeObject===y(oe).HOLDER),(e,B)=>(C(),V(r,{key:B,class:"file",title:`\u300A${e.materialName}\u300B`,url:e.materialSource},null,8,["title","url"]))),128))])])]),_:1}),(C(!0),g(P,null,U((f=n.value)==null?void 0:f.tenantOrderInsuredList,(e,B)=>(C(),g("div",{key:B},[E(S,{title:"\u88AB\u4FDD\u4EBA",class:"card"},{extra:F(()=>{var a,c;return[u("div",Xe,[u("div",Ze,h(e.name),1),u("div",{class:Q(["status",{verified:((a=e.extInfo)==null?void 0:a.isCert)===t.CERT}])},h(((c=e.extInfo)==null?void 0:c.isCert)===t.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:F(()=>{var a;return[u("div",et,[tt,u("div",ut,h(e.certNo),1),((a=e.extInfo)==null?void 0:a.isCert)!==t.CERT?(C(),g("div",{key:0,class:"action",onClick:c=>G(B)},[at,E(se,{name:"right_arrow",class:"icon"})],8,st)):ue("",!0)])]}),_:2},1024),E(S,{title:"\u88AB\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:F(()=>[u("div",{class:"resign",onClick:a=>j(B)},"\u91CD\u7B7E",8,ot)]),default:F(()=>[E(ae,{ref_for:!0,ref:_e,class:"sign"}),u("div",nt,[u("div",rt,"\u7B7E\u540D\u65E5\u671F\uFF1A "+h(y(N)),1),u("div",it,[lt,(C(!0),g(P,null,U(R.value.filter(a=>a.noticeObject===y(oe).INSURED),(a,c)=>(C(),V(r,{key:c,class:"file",title:`\u300A${a.materialName}\u300B`,url:a.materialSource},null,8,["title","url"]))),128))])])]),_:2},1024)]))),128)),u("div",ct,[E(i,{type:"primary",class:"submit-btn",onClick:Be},{default:F(()=>[dt]),_:1})])]),E(He)]}),_:1})}}});var Dt=ce(_t,[["__scopeId","data-v-ab7a6660"]]);export{Dt as default};
