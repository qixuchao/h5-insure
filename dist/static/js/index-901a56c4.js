var oe=Object.defineProperty,de=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var q=(d,n,o)=>n in d?oe(d,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[n]=o,E=(d,n)=>{for(var o in n||(n={}))se.call(n,o)&&q(d,o,n[o]);if(B)for(var o of B(n))ce.call(n,o)&&q(d,o,n[o]);return d},w=(d,n)=>de(d,ie(n));import{g as $,j as K,n as j,z as g,J as R,O as ue,E as y,h as le,r as S,p,m as U,A as pe,C as me,T as Ie}from"./vendor-667a94d7.js";import{_ as z}from"./index-e394c5ef.js";import{i as ye,a as _e,s as Oe,e as ve,E as fe}from"./trial-2752d8d0.js";import{p as Le}from"./product-4ac0113c.js";import{e as M,i as Y,P as Ne,I as ge}from"./trial-03a49d16.js";import{S as Pe}from"./infoCollection-242da9b6.js";const Ce={class:"com-field-info"},De={class:"title"},Te={class:"desc"},be=$({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup(d){return(n,o)=>(K(),j("div",Ce,[g("div",De,R(d.title),1),g("div",Te,R(d.desc),1)]))}});var H=z(be,[["__scopeId","data-v-35c1ec17"]]);const he={class:"page-activity-upgrade"},Ee={class:"container"},Se={class:"main-form"},He=$({setup(d){const n=ue(),{productCode:o,orderId:J,tenantId:_}=n.query,u=y(),P=y(),l=y(),m=y(),C=y(),V=t=>{const r=t.find(e=>e.riskType===M.MAIN_RISK);return t.map(e=>{var A;const{riskInsureLimitVO:a,riskCategory:s,id:i,riskType:c,riskName:O,riskCode:v,riskLiabilityInfoVOList:f,riskCalcMethodInfoVO:L}=e,{insurancePeriodValueList:I,paymentFrequencyList:D,paymentPeriodValueList:T,annuityDrawFrequencyList:b,annuityDrawValueList:h,insurancePeriodRule:ee,paymentPeriodRule:te}=a,{fixedAmount:re,minCopy:ne}=L,N={amount:re,riskCode:v,riskId:i,riskName:O,chargePeriod:T==null?void 0:T[0],annuityDrawDate:h==null?void 0:h[0],riskType:c,annuityDrawFrequency:b==null?void 0:b[0],copy:ne,coveragePeriod:I==null?void 0:I[0],insuredCode:(A=u.value)==null?void 0:A.insurerCode,liabilityVOList:f.filter(ae=>ae.optionalFlag===1),paymentFrequency:D==null?void 0:D[0],riskCategory:s};return c===M.MAIN_RISK?N:(ee===Y.ONE_YEAR&&(N.coveragePeriod="year_1"),te===Y.ONE_YEAR&&(N.chargePeriod="year_1"),w(E({},N),{mainRiskId:r==null?void 0:r.id,mainRiskCode:r==null?void 0:r.riskCode}))})},k=(t,r)=>t.map(e=>{var s,i;return{tenantId:_,amountUnit:1,annuityDrawFrequency:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,paymentFrequency:e.paymentFrequency,paymentPeriod:e.chargePeriod.split("_")[1],paymentPeriodType:Ne[e.chargePeriod.split("_")[0]],insurancePeriodType:ge[e.coveragePeriod==="to_life"?"to_life":e.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+e.coveragePeriod.split("_")[1])?0:e.coveragePeriod.split("_")[1],riskCode:e.riskCode,riskType:e.riskType,extInfo:{riskId:e.riskId,copy:e.copy},initialPremium:(s=r[e.riskCode])==null?void 0:s.premium,liabilityDetails:e.liabilityVOList.map(c=>({liabilityCode:c.liabilityCode,liabilityName:c.liabilityName,refundMethod:c.liabilityAttributeValue})),productId:(i=u.value)==null?void 0:i.id}}),G=()=>{const t=V(P.value.productRiskVoList[0].riskDetailVOList),r=k(t,{}),e=l.value;return{tenantId:_,venderCode:e.venderCode,orderDataSource:e.orderDataSource,tenantOrderHolder:{tenantId:e.tenantOrderHolder.tenantId,name:e.tenantOrderHolder.name,certType:e.tenantOrderHolder.certType,certNo:e.tenantOrderHolder.certNo,mobile:e.tenantOrderHolder.mobile,birthday:e.tenantOrderHolder.birthday,gender:e.tenantOrderHolder.gender},extInfo:e.extInfo.extraInfo,tenantOrderInsuredList:[{tenantId:e.tenantOrderInsuredList[0].tenantId,relationToHolder:e.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:e.tenantOrderInsuredList[0].insuredBeneficiaryType,name:e.tenantOrderInsuredList[0].name,hasSocialInsurance:e.tenantOrderInsuredList[0].hasSocialInsurance,certType:e.tenantOrderInsuredList[0].certType,certNo:e.tenantOrderInsuredList[0].certNo,mobile:e.tenantOrderInsuredList[0].mobile,birthday:e.tenantOrderInsuredList[0].birthday,gender:e.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:e.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:u.value.productCode,productName:u.value.productName,premium:m.value,tenantOrderRiskList:r}]}]}},Q=async()=>{const t=G(),r=await Oe(t),{code:e,data:a}=r;return e==="10000"?a.data:""},x=()=>{const t=l.value;return{agencyId:t.agencyId,venderCode:t.venderCode,applicationNo:t.applicationNo,orderDataSource:t.orderDataSource,orderNo:t.orderNo,orderStatus:t.orderStatus,policyNo:t.policyNo,tenantId:_,orderAmount:m.value,tenantOrderHolder:{tenantId:t.tenantOrderHolder.tenantId,name:t.tenantOrderHolder.name,certType:t.tenantOrderHolder.certType,certNo:t.tenantOrderHolder.certNo,mobile:t.tenantOrderHolder.mobile,birthday:t.tenantOrderHolder.birthday,gender:t.tenantOrderHolder.gender},tenantOrderInsuredList:[{premium:m.value,tenantId:t.tenantOrderInsuredList[0].tenantId,relationToHolder:t.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:t.tenantOrderInsuredList[0].insuredBeneficiaryType,name:t.tenantOrderInsuredList[0].name,hasSocialInsurance:t.tenantOrderInsuredList[0].hasSocialInsurance,certType:t.tenantOrderInsuredList[0].certType,certNo:t.tenantOrderInsuredList[0].certNo,mobile:t.tenantOrderInsuredList[0].mobile,birthday:t.tenantOrderInsuredList[0].birthday,gender:t.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:t.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:u.value.productCode,productName:u.value.productName,tenantOrderRiskList:k(V(P.value.productRiskVoList[0].riskDetailVOList),{})}]}]}},F=async()=>{const t=x(),r=await ve(t),{code:e,data:a}=r;e==="10000"&&(m.value=a.installmentPremium)},W=async t=>{const r=x(),e=await fe(E({id:t},r)),{code:a,data:s}=e;a==="10000"&&Ie("\u4FDD\u969C\u5347\u7EA7\u6210\u529F")},X=async t=>{await F();const r=await Q();W(r)},Z=()=>{const t=Le({productCode:o,withInsureInfo:!0}),r=ye({productCode:o}),e=_e({id:J,tenantId:_});Promise.all([t,r,e]).then(([a,s,i])=>{console.log(a,s,i),a.code==="10000"&&(u.value=a.data),s.code==="10000"&&(P.value=s.data),i.code==="10000"&&(l.value=i.data,C.value=i.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),F()})};return le(()=>{Z()}),(t,r)=>{var i,c,O,v,f,L;const e=S("ProRadioButton"),a=S("ProField"),s=S("VanButton");return K(),j("div",he,[g("div",Ee,[g("div",Se,[p(H,{title:"\u59D3\u540D",desc:(c=(i=l.value)==null?void 0:i.tenantOrderInsuredList)==null?void 0:c[0].name},null,8,["desc"]),p(H,{title:"\u8BC1\u4EF6\u53F7\u7801",desc:(v=(O=l.value)==null?void 0:O.tenantOrderInsuredList)==null?void 0:v[0].certNo},null,8,["desc"]),p(H,{title:"\u624B\u673A\u53F7\u7801",desc:(L=(f=l.value)==null?void 0:f.tenantOrderHolder)==null?void 0:L.mobile},null,8,["desc"]),p(a,{label:"\u6709\u65E0\u793E\u4FDD",name:"name",required:"",placeholder:"\u8BF7\u9009\u62E9"},{input:U(()=>[p(e,{modelValue:C.value,"onUpdate:modelValue":r[0]||(r[0]=I=>C.value=I),disabled:!0,options:pe(Pe)},null,8,["modelValue","options"])]),_:1}),p(s,{class:"upgrade-btn",type:"primary",block:!0,onClick:X},{default:U(()=>[me("\u5347\u7EA7\u4FDD\u969C("+R(m.value)+")",1)]),_:1})])])])}}});var qe=z(He,[["__scopeId","data-v-54eeb6bd"]]);export{qe as default};
