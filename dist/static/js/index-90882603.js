import{_ as e,d as a,J as t,am as r,cl as o,c as l,e as n,w as d,i,bk as s,m as u,r as c,S as I,E as v,g as A,F as p,h as f,n as m,t as g,L as C,j as D,a3 as h,X as E,Y as S,aa as O,bZ as x,u as T,a as P,G as U,f as w,al as G,H as b,cm as y,T as L,bT as k,cn as V,ac as Q,bW as N}from"./index-5239afda.js";import{p as Y}from"./product-079656a3.js";import{q as R,g as B,a as M,i as W}from"./trial-f5b40a6d.js";import K from"./index-04cde60b.js";import{a as z}from"./trial-04861e1a.js";import{e as H}from"./utils-40e09760.js";import{s as j}from"./core-19e81f25.js";import{a as q}from"./order-305ca51f.js";import{O as J}from"./infoCollection-2434be00.js";import{T as F}from"./constant-c3f28a3b.js";import"./pdfh5-008ca364.js";const Z={class:"pro-curtain"},X=["src"];var _=e(a({props:{show:{type:Boolean,default:!0}},emits:["close"],setup(e,{emit:a}){const c=e,I=t({show:c.show});return r((()=>c.show),(()=>{I.show=c.show}),{immediate:!0}),(e,t)=>{const r=o;return l(),n(r,{show:u(I).show},{default:d((()=>[i("div",Z,[s(e.$slots,"default",{},void 0,!0),i("img",{class:"close",src:u("data:image/png;base64,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"),onClick:t[0]||(t[0]=e=>a("close"))},null,8,X)])])),_:3},8,["show"])}}}),[["__scopeId","data-v-4c1ecdfa"]]);const $={class:"guarantee-list"},ee=(e=>(E("data-v-886dfc8a"),e=e(),S(),e))((()=>i("div",{class:"title"},"保障内容",-1))),ae=["src"];var te=e(a({props:{dataSource:{type:Array,default:()=>[]},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:10}},setup(e){const a=e,t=c(a.dataSource||[]),[o,d]=I(!1),s=v((()=>{var e;return!(!t.value||!(null==(e=t.value)?void 0:e.length))&&(t.value.length>a.count&&(!!a.isShowClose||!o.value))})),E=()=>{d()},S=v((()=>{var e;return t.value&&(null==(e=t.value)?void 0:e.length)?t.value.length<=a.count||o.value?t.value:t.value.slice(0,a.count):[]}));return r((()=>a.dataSource),(()=>{t.value=a.dataSource})),(e,a)=>{const t=h;return l(),A("div",$,[ee,(l(!0),A(p,null,f(u(S),((e,a)=>(l(),n(t,{key:a,title:e.title,content:e.desc,border:!1},null,8,["title","content"])))),128)),u(s)?(l(),A("div",{key:0,class:"show-more",onClick:E},[m(g(u(o)?"收起":"查看更多")+" ",1),i("img",{src:u("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAjNJREFUOE+1VEtPE1EUPufM9GXKCnWlqAQZuhEff8CNxpYdSReVatIWJMYI7FkYF+wtxsSCBWNLY4JhZxHd+AdMqhs6PmJJWMkPsO303mPmQs10GJuawOxu5tzvfK9chCP+8Ijx4HgAVyZGskgQEgIXJkvbO//D+sXtyDlN43mW8Du9Vp1VDPNJ4xkiRoC5DhKz6VJ1qxfQ/MTITUSeA8QgM29niuYDBbh6/XyQzwZmAPCWfUbmLdAb2dTLWt0LeDE6FOjr12YYMfp3freRTX2s1Ts8VBuJZwEwxBJ2SMDj1OtqzQn66u7gQIt9jwDwgq1IAixOFs137ZlDobgvMPPTzNrXTaUkcfEG6zTXbaFnyrakcL/+EBBi+5vlB2Cy2meW8j35mk+8LOlaG8VII9v0kA3LzA1gXmwz9vJXAS4njRQC+qnR2kivf99zDubigwO+gH8egbUWwsJUwfzp/L8SHzolA/o4Azeniubqfm3uGBlgPMMITSnE5r3St0ovtXmeHB7VkWLI4Afk3UzBzCvA3DXwkWHEiPCyqgFxxQqGy9NLnywvYHtejxhRALyiHJZckWGzPL0EVoeHzo3Mcs8i8eZ+4cevDgsSwydJwzgBngYAS0hRdio6FErOdYGkKKcOLFhOGJdQxzFbor2QmnLd7blnym5JguUXImohw1WVNsjP4kTfWy9LutZGMSIcQwT/gWzLyfiftemWqG2BT6NxZqYmtTbcnrrvHs972Evnep35AykjACSCRaPlAAAAAElFTkSuQmCC"),class:C(["icon",{showMore:u(o)}])},null,10,ae)])):D("",!0)])}}}),[["__scopeId","data-v-886dfc8a"]]);const re=O([{value:q.PENDING,label:"待处理"},{value:q.PAYING,label:"订单未完成，逾期将失效"},{value:q.PAYMENT_SUCCESS,label:"支付成功"},{value:q.PAYMENT_FAILED,label:"支付失败"},{value:q.CANCELED,label:"已失效"},{value:q.ACCEPT_POLICY,label:"投保成功"},{value:q.INSURER_REJECT,label:"保司拒保"},{value:q.TIMEOUT,label:"订单已经关闭"},{value:q.UNDER_WRITING_SUCCESS,label:"核保通过"},{value:q.NOTE,label:"照会"},{value:q.MANUAL_UNDERWRITING,label:"人工核保"},{value:q.INSURANCE_PROCESSING,label:"保司处理中"}]),oe={[q.ACCEPT_POLICY]:"恭喜 您已成功购买保障",[q.CANCELED]:"赠险保单已失效",[q.PAYING]:"剩余支付时间：23:59:59",[q.TIMEOUT]:"请您重新提交订单"};const le={class:"page-pay-result"},ne={class:"header"},de={class:"product-status"},ie=["innerHTML"],se={class:"prodouct-container"},ue={class:"product-card"},ce={class:"product-name"},Ie={class:"label"},ve={class:"value"},Ae=["src"],pe=["src"];var fe=e(a({setup(e){const a=x(),r=T(),o=P(),{tenantId:s,from:I="other",orderNo:m,code:C,channelCode:h=""}=o.query;let E="";const S=t({insureDetail:{},detail:{},orderDetail:{},showOrderDetail:!1,guaranteeItemVOS:[],pageInfo:{title:"",desc:"",insureList:[],productImage:"",notificationImage:""},timeDown:{},templateId:"2"}),O=c(!1),Z=v((()=>[q.ACCEPT_POLICY,q.CANCELED,q.PAYMENT_SUCCESS].includes(S.orderDetail.orderStatus)?"下载保单":q.PAYING===S.orderDetail.orderStatus?"立即支付":q.TIMEOUT===S.orderDetail.orderStatus?"重下一单":"")),X=v((()=>h||S.orderDetail.extInfo.extraInfo.channelCode)),$=async(e=!1,a="")=>{var t,o,l,n;try{const{insurerCode:d}=S.insureDetail.productBasicInfoVO,{templateId:i}=S.orderDetail.extInfo.extraInfo;delete S.orderDetail.extInfo.extraInfo.templateId;const u={insurerCode:d,productCode:e?null==(o=null==(t=S.insureDetail)?void 0:t.productBasicInfoVO)?void 0:o.upgradeGuaranteeConfigVO.productCode:E,tenantId:s,agencyCode:S.orderDetail.agencyId,agentCode:S.orderDetail.agentCode,saleChannelId:null==(n=null==(l=S.orderDetail.extInfo)?void 0:l.extraInfo)?void 0:n.saleChannelId};if(i===F.UPGRADE)return u.extraInfo=decodeURIComponent(JSON.stringify({...S.orderDetail.extInfo.extraInfo,channelCode:X.value,templateId:i})),u.orderNo=m,void r.push(`/baseInsurance/upgrade?${G.stringify(u)}`);u.extraMap={...S.orderDetail.extInfo.extraInfo,channelCode:X.value},e&&(u.extraMap.promotion=a),delete u.extraMap.templateId;const c=await R(u);if("10000"===c.code){if(!e){const{tenantOrderHolder:e,tenantOrderInsuredList:a}=S.orderDetail;b.set(J,{tenantOrderHolder:e,tenantOrderInsuredList:a})}window.location.href=c.data||""}}catch(d){}},ee=async()=>{var e,a,t,r,o;if("下载保单"===Z.value)if(null==(e=S.orderDetail.extInfo)?void 0:e.policyUrl)(null==(r=S.orderDetail.extInfo)?void 0:r.policyUrl)&&y(null==(o=S.orderDetail.extInfo)?void 0:o.policyUrl);else{const e=await B({orderNo:m,tenantId:s});"10000"===e.code&&(S.orderDetail=e.data,(null==(a=S.orderDetail.extInfo)?void 0:a.policyUrl)?y(null==(t=S.orderDetail.extInfo)?void 0:t.policyUrl):L("电子保单单生成中，请稍后再试"))}else"立即支付"===Z.value?M({...S.orderDetail,extInfo:{...S.orderDetail.extInfo,redirectUrl:window.location.href}}).then((e=>{"10000"===e.code&&j(e.data.paymentUrl)})):"重下一单"===Z.value&&$(!1)},ae=async()=>{var e,a,t,r;const o=await B({orderNo:m,tenantId:s,withProductInfo:!0});if("10000"===o.code){if(S.orderDetail=o.data,E=(null==(r=null==(t=null==(a=null==(e=o.data.tenantOrderInsuredList)?void 0:e[0])?void 0:a.tenantOrderProductList)?void 0:t[0])?void 0:r.productCode)||"",!E)return"";const l=Y({productCode:E,withInsureInfo:!0,tenantId:s}),n=W({productCode:E});Promise.all([l,n]).then((([e,a])=>{"10000"===e.code&&(S.detail=e.data),"10000"===a.code&&(S.insureDetail=a.data),(()=>{var e,a,t,r,o,l,n,d,i,s,u,c,v,A,p,f,m,g,C,D,h,E,x,T,P,U,w,G,b,y;[q.PAYMENT_SUCCESS,q.ACCEPT_POLICY].includes(S.orderDetail.orderStatus)&&(S.orderDetail.orderStatus=q.ACCEPT_POLICY),S.pageInfo.title=re[S.orderDetail.orderStatus],S.pageInfo.desc=oe[S.orderDetail.orderStatus],V((null==(a=null==(e=S.detail)?void 0:e.tenantProductInsureVO)?void 0:a.productName)||""),S.templateId="4";let L="";if("2"===S.templateId.toString()?S.orderDetail.tenantOrderInsuredList[0].tenantOrderProductList.forEach((e=>L?null:(e.tenantOrderRiskList.forEach((e=>{1!==e.riskType||L||(L=H(e.insurancePeriodValue,z[e.insurancePeriodType]))})),!1))):(S.pageInfo.insureList=[{label:(S.templateId===F.UPGRADE&&"1"===(null==(o=null==(r=null==(t=S.orderDetail)?void 0:t.extInfo)?void 0:r.extraInfo)?void 0:o.isUpgrade)?"下":"本")+"期缴费金额",value:`${S.orderDetail.orderAmount}元`}],L=`${Q(S.orderDetail.commencementTime).format("YYYY.MM.DD")}到${Q(S.orderDetail.expiryDate).format("YYYY.MM.DD")}`),S.pageInfo.insureList=[...S.pageInfo.insureList,{label:"被保人",value:null==(d=null==(n=null==(l=S.orderDetail)?void 0:l.tenantOrderInsuredList)?void 0:n[0])?void 0:d.name},{label:"保障期间",value:L||""}],S.templateId=S.orderDetail.extInfo.templateId,"free"!==I&&[q.PAYING,q.TIMEOUT].includes(S.orderDetail.orderStatus)?S.showOrderDetail=!0:(null==(s=null==(i=S.insureDetail)?void 0:i.productBasicInfoVO)?void 0:s.upgradeGuaranteeConfigVO.productCode)&&(S.pageInfo.notificationImage=(null==(A=null==(v=null==(c=null==(u=S.insureDetail)?void 0:u.productBasicInfoVO)?void 0:c.upgradeGuaranteeConfigVO)?void 0:v.notificationImage)?void 0:A[0])||"",S.pageInfo.productImage=(null==(g=null==(m=null==(f=null==(p=S.insureDetail)?void 0:p.productBasicInfoVO)?void 0:f.upgradeGuaranteeConfigVO)?void 0:m.productImage)?void 0:g[0])||"",O.value=!!S.pageInfo.notificationImage),q.PAYING===S.orderDetail.orderStatus){const e=(null==(D=null==(C=S.orderDetail.tenantOrderPaymentInfoList)?void 0:C[0])?void 0:D.paymentExpiryDate)||Q().add(8.5,"hour");S.timeDown=N({time:Q(e).diff(new Date,"millisecond")}),S.timeDown.start()}try{const e=null==(h=S.orderDetail.tenantOrderInsuredList)?void 0:h[0].planCode;(null==(x=null==(E=S.detail)?void 0:E.tenantProductInsureVO)?void 0:x.planInsureVO)?S.guaranteeItemVOS=(null==(y=null==(b=null==(G=S.detail)?void 0:G.tenantProductInsureVO)?void 0:b.planInsureVO)?void 0:y.guaranteeItemVOS)||[]:S.guaranteeItemVOS=(null==(w=null==(U=null==(P=null==(T=S.detail)?void 0:T.tenantProductInsureVO)?void 0:P.planList.filter((a=>a.planCode===e)))?void 0:U[0])?void 0:w.guaranteeItemVOS)||[]}catch(k){}})()}))}return""},fe=e=>{const a=`${e}`.length;let t="";for(let r=0;r<2-a;r++)t+="0";return t+e},me=v((()=>{var e;return q.PAYING===(null==(e=S.orderDetail)?void 0:e.orderStatus)?S.timeDown.current.total<=0?(S.orderDetail.orderStatus=q.TIMEOUT,S.pageInfo.title=re[S.orderDetail.orderStatus],S.pageInfo.desc=oe[S.orderDetail.orderStatus],S.timeDown.pause(),S.pageInfo.desc):`剩余支付时间：${fe(S.timeDown.current.hours)}:${fe(S.timeDown.current.minutes)}:${fe(S.timeDown.current.seconds)}`:S.pageInfo.desc}));return U((()=>{ae()})),(e,t)=>{const r=k;return l(),n(r,{"theme-vars":u(a)},{default:d((()=>{var e,r;return[i("div",le,[i("div",ne,[i("div",de,g(u(S).pageInfo.title),1),"重下一单"!==u(Z)||"3"!==u(S).templateId.toString()?(l(),A("div",{key:0,class:"desc",innerHTML:u(me)},null,8,ie)):D("",!0)]),i("div",se,[i("div",ue,[i("div",ce,g((null==(r=null==(e=u(S).insureDetail)?void 0:e.productBasicInfoVO)?void 0:r.productName)||""),1),(l(!0),A(p,null,f(u(S).pageInfo.insureList,((e,a)=>(l(),A("div",{key:a,class:"list"},[i("span",Ie,g(e.label),1),i("span",ve,g(e.value),1)])))),128)),"重下一单"!==u(Z)||"3"!==u(S).templateId.toString()?(l(),n(K,{key:0,"theme-vars":u(a),class:"btn",text:u(Z),onClick:ee},null,8,["theme-vars","text"])):D("",!0)]),u(S).pageInfo.productImage?(l(),A("img",{key:0,class:"product-img",src:u(S).pageInfo.productImage,onClick:t[0]||(t[0]=e=>$(!0,"GDGGW"))},null,8,Ae)):D("",!0),u(S).showOrderDetail?(l(),n(te,{key:1,"is-show-close":"",count:5,"data-source":u(S).guaranteeItemVOS},null,8,["data-source"])):D("",!0)])]),w(_,{show:O.value,"onUpdate:show":t[2]||(t[2]=e=>O.value=e),onClose:t[3]||(t[3]=e=>O.value=!1)},{default:d((()=>[i("img",{class:"jump-img",src:u(S).pageInfo.notificationImage,style:{display:"block"},onClick:t[1]||(t[1]=e=>$(!0,"TCGGW"))},null,8,pe)])),_:1},8,["show"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-e96bfb8e"]]);export{fe as default};
