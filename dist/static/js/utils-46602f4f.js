import{bR as i,au as e}from"./index-98f74434.js";import{q as t}from"./createProposal-4804d3a9.js";import"./trial-2819e647.js";import"./PolicyInfo-ebe1ca1f.js";const r=async({proposalId:i,productCode:e,tenantId:r,proposalInsuredId:o},a)=>{const l=(await t({id:i,tenantId:r})).data,n={holder:{},insuredVOList:[],productCode:e};n.holder={personVO:null==l?void 0:l.holder},n.insuredVOList=null==l?void 0:l.insuredList.filter((i=>i.id===+o)).map((i=>({personVO:{age:i.age,birthday:i.birthday,bmi:i.bmi,certNo:i.certNo,certType:i.certType,email:i.email,gender:i.gender,hasSocialInsurance:i.hasSocialInsurance,height:i.height,holderRelation:i.holderRelation,insureAreaCode:i.insureAreaCode,insureCityCode:i.insureCityCode,insureProvinceCode:i.insureProvinceCode,mobile:i.mobile,name:i.name,occupationClass:i.occupationClass,occupationCodeList:i.occupationCode,smokeFlag:i.smokeFlag,socialFlag:i.socialFlag,weight:i.weight},productPlanVOList:i.proposalInsuredProductList.map((i=>({insurerCode:null,planCode:"",relationToHolder:"1",riskVOList:i.proposalProductRiskList.map((i=>({amount:i.amount,annuityDrawDate:i.annuityDrawDate,annuityDrawType:i.annuityDrawType,chargePeriod:i.chargePeriod,copy:i.copy,coveragePeriod:i.coveragePeriod,liabilityVOList:i.liabilityVOList.map((i=>({liabilityAmount:null,liabilityAttributeType:i.liabilityAttributeType,liabilityAttributeValueList:i.liabilityAttributeValueList,liabilityCode:i.liabilityCode,liabilityId:i.liabilityId,liabilityRateType:null,liabilityValue:null}))),mainRiskCode:i.mainRiskCode,mainRiskId:i.mainRiskId,paymentFrequency:i.paymentFrequency,premium:i.premium,riskCategory:i.riskCategory,riskCode:i.riskCode,riskId:i.riskId,riskName:i.riskName,riskType:i.riskType})))})))}))),null==a||a(n)},o=(i,t,r)=>{const o={...r,...i},{insuredPremiumList:a=[],initialAmount:l,initialPremium:n=0}=t||{};return o.premium=n,o.orderAmount=n,o.orderRealAmount=n,o.insuredList=(o.insuredList||[]).map(((i,t)=>({...i,certType:i.certType||e.CERT,certNo:(i.certNo||"").toLocaleUpperCase(),productList:(i.productList||[]).map(((i,e)=>{var r,o,l;return{...i,premium:null==(l=null==(o=null==(r=null==a?void 0:a[t])?void 0:r.productPremiumList)?void 0:o[e])?void 0:l.totalPremium,riskList:(i.riskList||[]).map(((i,r)=>{var o,l,s,u;const{initialAmount:d,initialPremium:m,unitAmount:p,unitPremium:c}=(null==(u=null==(s=null==(l=null==(o=null==a?void 0:a[t])?void 0:o.productPremiumList)?void 0:l[e])?void 0:s.riskPremiumDetailVOList)?void 0:u[r])||{};return{...i,initialAmount:d,initialPremium:m,unitAmount:p,unitPremium:c,regularPremium:n,totalPremium:n}}))}}))}))),o},a=e=>{const{holder:t,insuredList:r}=e,{mobile:o,verificationCode:a}=t,l=[];return a&&l.push(i({mobile:o,smsCode:a})),r.forEach((e=>{const{mobile:t,verificationCode:r}=e;r&&l.push(i({mobile:t,smsCode:r}))})),Promise.all(l)};export{r as p,o as t,a as v};
