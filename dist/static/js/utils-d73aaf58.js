import{h as ce,R as xe,P as ve,r as O,d as L,A as ae,$ as S,k as R,C as N,m as i,s as W,n as f,p as b,t as D,x as m,B as Z,G as ie,L as ye,M as Ee,T as ke,aa as Fe,N as ge,F as De,H as Be}from"./vendor-e88cb016.js";import{C as F,V as $,I as Te,J,K as M,Y as te,a6 as se,a3 as Oe}from"./index-1492183a.js";import{R as de,I as Re,g as me}from"./infoCollection-10178fb2.js";import{r as Ae}from"./relativeTime-0177496a.js";import{u as fe}from"./useDicData-e57eabd6.js";import{b as Ce,a as Ve,R as re,i as Ie}from"./trial-4e211944.js";const Ne={key:0,class:"com-personal-wrapper"},we={class:"date-extra"},Le=ie("\u957F\u671F"),Ue=Z("span",{class:"input-extra"},"\u4E07",-1),Pe=Z("span",{class:"input-extra"},"\u4E07",-1),qe=Z("span",{class:"input-extra"},"%",-1),le=ce({props:{formInfo:{default:()=>({})},factorList:{default:()=>[]},images:{default:()=>[]},isView:{type:Boolean,default:!1},prefix:{default:""},beneficiaryList:{default:()=>[]},sendSmsCode:{type:Function,default:(e,v)=>{}}},emits:["update:images"],setup(e,{emit:v}){const I=e;xe();const{venderCode:p=""}=ve().query,s=fe(`${p.toLocaleUpperCase()}_OCCUPATION`),l=fe("NATIONAL_REGION_CODE"),x=O([]),C=O(!1),a=O({formInfo:I.formInfo,birth:{min:new Date("1900-01-01"),max:new Date},certEndDate:{min:new Date("1900-01-01"),max:new Date("2099-12-31")},occupationalText:""});L.extend(Ae);const V=O(I.formInfo.certEndType===2),A=60,g=O(0),B=O("\u83B7\u53D6\u9A8C\u8BC1\u7801"),U=O(!1),T=ae(()=>{const u={};return I.factorList.forEach(t=>{u[t.code]=t}),u});ae(()=>/^1(3|4|5|6|7|8|9)\d{9}$/.test(a.value.formInfo.mobile));const h=()=>{if(g.value>0)return;g.value=A;const u=()=>{B.value=`${g.value}s`,g.value-=1};u();const t=setInterval(()=>{g.value===0?(B.value="\u83B7\u53D6\u9A8C\u8BC1\u7801",g.value=0,clearInterval(t)):u()},1e3)},E=async()=>{g.value>0||I.sendSmsCode(a.value.formInfo.mobile,()=>{U.value=!0,ke({message:"\u77ED\u4FE1\u53D1\u9001\u6210\u529F\uFF0C\u8BF7\u67E5\u6536"}),h()})},y=u=>{a.value.formInfo.certNo=u.personIdCard,a.value.formInfo.name=u.personName,a.value.formInfo.certEndDate=L(u.validDateEnd,"YYYYMMDD").toDate()},n=u=>T.value&&T.value[u]&&T.value[u].isDisplay===te.YES,d=u=>T.value&&T.value[u]&&T.value[u].isMustInput===te.YES,o=(u,t)=>{var k,c;return((c=(k=T.value)==null?void 0:k[u])==null?void 0:c[t])||""},X=ae(()=>[F.CERT,F.HOUSE_HOLD].includes(`${a.value.formInfo.certType}`)?[$.ID_CARD]:`${a.value.formInfo.certType}`===F.BIRTH?[$.BIRTH]:`${a.value.formInfo.certType}`===F.PASSPORT?[$.PASSPORT]:[$.ID_CARD]),H=(u,t)=>d("attachment")?a.value.formInfo.certEndType===2||a.value.formInfo.certEndDate?"":"\u8BF7\u9009\u62E9\u6709\u6548\u671F\u81F3":"",P=(u,t)=>/^\d{1,10}(\.\d{1,2})?$/.test(u)?"":"\u5E74\u6536\u5165\u6700\u591A\u5F55\u516510\u4F4D\u6570\u5B57",Y=(u,t)=>/^[1-9]$|^[1-9][0-9]$|^100$/.test(u)?"":"\u6536\u76CA\u6BD4\u4F8B\u53EA\u80FD\u586B\u51991-100\u7684\u6B63\u6574\u6570",w=(u,t,k)=>t.length>u?`\u6700\u5927\u4E0D\u80FD\u8D85\u8FC7${u}\u4E2A\u5B57\u7B26`:"",j=(u,t)=>{var k,c,z,q,Q,_,ee;if(!n("nationality"))return"";if(((c=(k=a.value.formInfo)==null?void 0:k.extInfo)==null?void 0:c.nationalityCode)==="CHN"){if(![F.CERT,F.HOUSE_HOLD,F.BIRTH,F.MILITARY_CARD].includes(`${u}`))return"\u56FD\u7C4D\u4E3A\u4E2D\u56FD\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u8EAB\u4EFD\u8BC1\u3001\u6237\u53E3\u672C\u3001\u51FA\u751F\u8BC1\u3001\u519B\u5B98\u8BC1"}else if(["HKG","MAC"].includes((q=(z=a.value.formInfo)==null?void 0:z.extInfo)==null?void 0:q.nationalityCode)){if(![F.HK_MACAO_RESIDENCE_PERMIT,F.HONGKONG_MACAO].includes(`${u}`))return"\u56FD\u7C4D\u4E3A\u4E2D\u56FD\u9999\u6E2F\u3001\u4E2D\u56FD\u6FB3\u95E8\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u6E2F\u6FB3\u901A\u884C\u8BC1\u3001\u6E2F\u6FB3\u5C45\u6C11\u5C45\u4F4F\u8BC1"}else if(((_=(Q=a.value.formInfo)==null?void 0:Q.extInfo)==null?void 0:_.nationalityCode)==="TWN"){if(![F.TAIWAN_RESIDENCE_PERMIT,F.TAIWAN_TRAVEL].includes(`${u}`))return"\u56FD\u7C4D\u4E3A\u4E2D\u56FD\u53F0\u6E7E\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u53F0\u6E7E\u901A\u884C\u8BC1\u3001\u53F0\u6E7E\u5C45\u6C11\u5C45\u4F4F\u8BC1"}else if(![F.PASSPORT,F.FOREIGN_PERMANENT].includes(`${u}`))return"\u56FD\u7C4D\u4E3A\u975E\u4E2D\u56FD\u3001\u6E2F\u6FB3\u53F0\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u62A4\u7167\u3001\u5916\u56FD\u4EBA\u6C38\u4E45\u5C45\u7559\u8EAB\u4EFD\u8BC1";return L().year()-L((ee=a.value.formInfo)==null?void 0:ee.birthday).year()>2&&u===F.BIRTH?"\u5E74\u9F84\u5927\u4E8E\u7B49\u4E8E2\u5468\u5C81\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u4E0D\u80FD\u9009\u62E9\u51FA\u751F\u8BC1":""},K=u=>Array.isArray(u)&&u.length===2&&u[0]&&u[1]?"":"\u8BF7\u4E0A\u4F20\u8EAB\u4EFD\u8BC1\u6B63\u53CD\u9762\u7167\u7247";return S(()=>V.value,u=>{u?(a.value.formInfo.certEndType=2,a.value.formInfo.certEndDate=""):a.value.formInfo.certEndType=1},{immediate:!0}),S(()=>a.value.formInfo.certType,u=>{[F.CERT,F.HOUSE_HOLD].includes(u)?C.value=!0:C.value=!1},{deep:!0,immediate:!0}),S(()=>a.value.formInfo.certNo,u=>{Te(u)&&(a.value.formInfo.gender=+J(u),a.value.formInfo.birthday=L(new Date(M(u))).format("YYYY-MM-DD"))},{deep:!0,immediate:!0}),S(()=>I.images,u=>{x.value=u},{immediate:!0}),S(()=>I.formInfo,()=>{a.value.formInfo=I.formInfo},{deep:!0,immediate:!0}),S(x,u=>{v("update:images",u)},{deep:!0}),(u,t)=>{const k=R("ProRadioButton"),c=R("ProField"),z=R("ProDatePicker"),q=R("ProPicker"),Q=R("ProIDCardUpload"),_=R("ProImageUpload"),ee=R("van-checkbox"),G=R("ProCascader"),be=R("van-button");return Object.keys(N(T)).length?(i(),W("div",Ne,[n("insuredBeneficiaryType")?(i(),f(c,{key:0,modelValue:a.value.formInfo.insuredBeneficiaryType,"onUpdate:modelValue":t[1]||(t[1]=r=>a.value.formInfo.insuredBeneficiaryType=r),label:o("insuredBeneficiaryType","title"),name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:b(()=>[D(k,{modelValue:a.value.formInfo.insuredBeneficiaryType,"onUpdate:modelValue":t[0]||(t[0]=r=>a.value.formInfo.insuredBeneficiaryType=r),prop:{label:"value",value:"code"},options:o("insuredBeneficiaryType","attributeValueList")||[]},null,8,["modelValue","options"])]),_:1},8,["modelValue","label"])):m("",!0),n("insuredRelation")?(i(),f(c,{key:1,modelValue:a.value.formInfo.insuredRelation,"onUpdate:modelValue":t[3]||(t[3]=r=>a.value.formInfo.insuredRelation=r),label:o("insuredRelation","title"),name:"insuredRelation",placeholder:"\u8BF7\u9009\u62E9"},{input:b(()=>[D(k,{modelValue:a.value.formInfo.insuredRelation,"onUpdate:modelValue":t[2]||(t[2]=r=>a.value.formInfo.insuredRelation=r),prop:{label:"value",value:"code"},options:o("insuredRelation","attributeValueList")||[]},null,8,["modelValue","options"])]),_:1},8,["modelValue","label"])):m("",!0),n("name")?(i(),f(c,{key:2,modelValue:a.value.formInfo.name,"onUpdate:modelValue":t[4]||(t[4]=r=>a.value.formInfo.name=r),label:o("name","title"),name:`${e.prefix}_name`,required:d("name")},null,8,["modelValue","label","name","required"])):m("",!0),n("sex")?(i(),f(c,{key:3,modelValue:a.value.formInfo.gender,"onUpdate:modelValue":t[6]||(t[6]=r=>a.value.formInfo.gender=r),required:d("sex"),label:o("sex","title"),name:`${e.prefix}_gender`,placeholder:"\u8BF7\u9009\u62E9","is-view":C.value},{input:b(()=>[D(k,{modelValue:a.value.formInfo.gender,"onUpdate:modelValue":t[5]||(t[5]=r=>a.value.formInfo.gender=r),disabled:C.value,"is-view":e.isView,prop:{label:"value",value:"code"},options:o("sex","attributeValueList")||[]},null,8,["modelValue","disabled","is-view","options"])]),_:1},8,["modelValue","required","label","name","is-view"])):m("",!0),n("birthDate")?(i(),f(z,{key:4,modelValue:a.value.formInfo.birthday,"onUpdate:modelValue":t[7]||(t[7]=r=>a.value.formInfo.birthday=r),label:o("birthDate","title"),name:`${e.prefix}_birthday`,min:a.value.birth.min,max:a.value.birth.max,type:"date",required:d("birthDate")},null,8,["modelValue","label","name","min","max","required"])):m("",!0),n("certType")?(i(),f(q,{key:5,modelValue:a.value.formInfo.certType,"onUpdate:modelValue":t[8]||(t[8]=r=>a.value.formInfo.certType=r),label:o("certType","title"),name:`${e.prefix}_certType`,"data-source":o("certType","attributeValueList")||[],mapping:{label:"value",value:"code",children:"child"},required:d("certType"),rules:[{validator:j}]},null,8,["modelValue","label","name","data-source","required","rules"])):m("",!0),n("certImage")&&a.value.formInfo.certType+""=="1"?(i(),f(c,{key:6,label:"\u8EAB\u4EFD\u8BC1\u4E0A\u4F20",block:"",required:d("certImage"),rules:[{validator:K}],name:`${e.prefix}_idCard`},{input:b(()=>[D(Q,{modelValue:x.value,"onUpdate:modelValue":t[9]||(t[9]=r=>x.value=r),"is-view":e.isView,onOnOCR:y},null,8,["modelValue","is-view"])]),_:1},8,["required","rules","name"])):m("",!0),n("certImage")&&a.value.formInfo.certType&&a.value.formInfo.certType+""!="1"?(i(),f(c,{key:7,label:o("certImage","title"),block:"",required:d("certImage")},{input:b(()=>[D(_,{modelValue:x.value,"onUpdate:modelValue":t[10]||(t[10]=r=>x.value=r),"max-count":1},null,8,["modelValue"])]),_:1},8,["label","required"])):m("",!0),n("certNo")?(i(),f(c,{key:8,modelValue:a.value.formInfo.certNo,"onUpdate:modelValue":t[11]||(t[11]=r=>a.value.formInfo.certNo=r),label:o("certNo","title"),name:`${e.prefix}_certNo`,required:d("certNo"),placeholder:"\u8BF7\u8F93\u5165",maxlength:19,"validate-type":N(X)},null,8,["modelValue","label","name","required","validate-type"])):m("",!0),n("certExpiry")?(i(),f(z,{key:9,modelValue:a.value.formInfo.certEndDate,"onUpdate:modelValue":t[13]||(t[13]=r=>a.value.formInfo.certEndDate=r),label:o("certExpiry","title"),name:`${e.prefix}_certEndDate`,type:"date",min:a.value.certEndDate.min,max:a.value.certEndDate.max,"is-view":V.value||e.isView,read:"",rules:[{validator:H}]},{extra:b(()=>[Z("div",we,[D(ee,{modelValue:V.value,"onUpdate:modelValue":t[12]||(t[12]=r=>V.value=r),"icon-size":16,disabled:e.isView},{default:b(()=>[Le]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue","label","name","min","max","is-view","rules"])):m("",!0),n("age")?(i(),f(c,{key:10,modelValue:a.value.formInfo.name,"onUpdate:modelValue":t[14]||(t[14]=r=>a.value.formInfo.name=r),label:o("age","title"),name:`${e.prefix}_age`,required:d("age")},null,8,["modelValue","label","name","required"])):m("",!0),n("residence")?(i(),f(G,{key:11,modelValue:a.value.formInfo.extInfo.provinceCode,"onUpdate:modelValue":t[15]||(t[15]=r=>a.value.formInfo.extInfo.provinceCode=r),field1:a.value.formInfo.extInfo.provinceCode,"onUpdate:field1":t[16]||(t[16]=r=>a.value.formInfo.extInfo.provinceCode=r),field2:a.value.formInfo.extInfo.cityCode,"onUpdate:field2":t[17]||(t[17]=r=>a.value.formInfo.extInfo.cityCode=r),field3:a.value.formInfo.extInfo.areaCode,"onUpdate:field3":t[18]||(t[18]=r=>a.value.formInfo.extInfo.areaCode=r),label:o("residence","title"),name:`${e.prefix}_provinceCode`,placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:d("residence"),"data-source":N(l),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","label","name","required","data-source"])):m("",!0),n("social")?(i(),f(c,{key:12,modelValue:a.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":t[20]||(t[20]=r=>a.value.formInfo.extInfo.hasSocialInsurance=r),label:o("social","title"),name:`${e.prefix}_hasSocialInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:d("social")},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":t[19]||(t[19]=r=>a.value.formInfo.extInfo.hasSocialInsurance=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("social","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("height")?(i(),f(c,{key:13,modelValue:a.value.formInfo.name,"onUpdate:modelValue":t[21]||(t[21]=r=>a.value.formInfo.name=r),label:o("height","title"),name:`${e.prefix}_height`,required:d("height")},null,8,["modelValue","label","name","required"])):m("",!0),n("weight")?(i(),f(c,{key:14,modelValue:a.value.formInfo.name,"onUpdate:modelValue":t[22]||(t[22]=r=>a.value.formInfo.name=r),label:o("weight","title"),name:`${e.prefix}_weight`,required:d("weight")},null,8,["modelValue","label","name","required"])):m("",!0),n("BMI")?(i(),f(c,{key:15,modelValue:a.value.formInfo.name,"onUpdate:modelValue":t[23]||(t[23]=r=>a.value.formInfo.name=r),label:o("BMI","title"),name:`${e.prefix}_BMI`,required:d("BMI")},null,8,["modelValue","label","name","required"])):m("",!0),n("insuredRiskManagementLevel")?(i(),f(c,{key:16,modelValue:a.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":t[25]||(t[25]=r=>a.value.formInfo.extInfo.hasSocialInsurance=r),label:o("insuredRiskManagementLevel","title"),name:`${e.prefix}_hasSocialInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:d("insuredRiskManagementLevel")},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":t[24]||(t[24]=r=>a.value.formInfo.extInfo.hasSocialInsurance=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("insuredRiskManagementLevel","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("purchaseOtherInsurance")?(i(),f(c,{key:17,modelValue:a.value.formInfo.extInfo.purchaseOtherInsurance,"onUpdate:modelValue":t[27]||(t[27]=r=>a.value.formInfo.extInfo.purchaseOtherInsurance=r),label:o("purchaseOtherInsurance","title"),name:`${e.prefix}_purchaseOtherInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:d("purchaseOtherInsurance")},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":t[26]||(t[26]=r=>a.value.formInfo.extInfo.hasSocialInsurance=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("purchaseOtherInsurance","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("injuryInsurance")?(i(),f(c,{key:18,modelValue:a.value.formInfo.extInfo.injuryInsurance,"onUpdate:modelValue":t[29]||(t[29]=r=>a.value.formInfo.extInfo.injuryInsurance=r),label:o("injuryInsurance","title"),name:`${e.prefix}_hasSocialInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:d("injuryInsurance")},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.injuryInsurance,"onUpdate:modelValue":t[28]||(t[28]=r=>a.value.formInfo.extInfo.injuryInsurance=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("injuryInsurance","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("insureArea")?(i(),f(G,{key:19,label:o("insureArea","title"),name:"insureAreaCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:d("insureArea"),"data-source":N(l),mapping:{label:"name",value:"code",children:"children"}},null,8,["label","required","data-source"])):m("",!0),n("occupation")?(i(),f(G,{key:20,modelValue:a.value.formInfo.extInfo.occupationCodeList[0],"onUpdate:modelValue":t[30]||(t[30]=r=>a.value.formInfo.extInfo.occupationCodeList[0]=r),field0:a.value.formInfo.extInfo.occupationCodeList[0],"onUpdate:field0":t[31]||(t[31]=r=>a.value.formInfo.extInfo.occupationCodeList[0]=r),field1:a.value.formInfo.extInfo.occupationCodeList[1],"onUpdate:field1":t[32]||(t[32]=r=>a.value.formInfo.extInfo.occupationCodeList[1]=r),field2:a.value.formInfo.extInfo.occupationCodeList[2],"onUpdate:field2":t[33]||(t[33]=r=>a.value.formInfo.extInfo.occupationCodeList[2]=r),label:o("occupation","title"),name:`${e.prefix}_occupationCodeList`,placeholder:"\u8BF7\u9009\u62E9",required:d("occupation"),"data-source":N(s),mapping:{label:"name",value:"code",children:"children"},"is-link":""},null,8,["modelValue","field0","field1","field2","label","name","required","data-source"])):m("",!0),n("personalAnnualIncome")?(i(),f(c,{key:21,modelValue:a.value.formInfo.extInfo.personalAnnualIncome,"onUpdate:modelValue":t[34]||(t[34]=r=>a.value.formInfo.extInfo.personalAnnualIncome=r),label:o("personalAnnualIncome","title"),name:`${e.prefix}_personalAnnualIncome`,required:d("personalAnnualIncome"),placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:P}]},{extra:b(()=>[Ue]),_:1},8,["modelValue","label","name","required","rules"])):m("",!0),n("familyAnnualIncome")?(i(),f(c,{key:22,modelValue:a.value.formInfo.extInfo.familyAnnualIncome,"onUpdate:modelValue":t[35]||(t[35]=r=>a.value.formInfo.extInfo.familyAnnualIncome=r),label:o("familyAnnualIncome","title"),name:`${e.prefix}_familyAnnualIncome`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:P}],required:d("familyAnnualIncome")},{extra:b(()=>[Pe]),_:1},8,["modelValue","label","name","rules","required"])):m("",!0),n("country")?(i(),f(q,{key:23,modelValue:a.value.formInfo.extInfo.nationalityCode,"onUpdate:modelValue":t[36]||(t[36]=r=>a.value.formInfo.extInfo.nationalityCode=r),label:o("country","title"),name:`${e.prefix}_nationalityCode`,"data-source":o("country","attributeValueList")||[],mapping:{label:"value",value:"code",children:"child"},placeholder:"\u8BF7\u9009\u62E9",required:d("country"),"is-link":""},null,8,["modelValue","label","name","data-source","required"])):m("",!0),n("hasUsCard")?(i(),f(c,{key:24,modelValue:a.value.formInfo.extInfo.hasUsCard,"onUpdate:modelValue":t[38]||(t[38]=r=>a.value.formInfo.extInfo.hasUsCard=r),label:o("hasUsCard","title"),name:`${e.prefix}_hasUsCard`,placeholder:"\u8BF7\u9009\u62E9",required:d("hasUsCard")},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.hasUsCard,"onUpdate:modelValue":t[37]||(t[37]=r=>a.value.formInfo.extInfo.hasUsCard=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("hasUsCard","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("marritalStatus")?(i(),f(q,{key:25,modelValue:a.value.formInfo.extInfo.marriageStatus,"onUpdate:modelValue":t[39]||(t[39]=r=>a.value.formInfo.extInfo.marriageStatus=r),label:o("marritalStatus","title"),name:`${e.prefix}_marriageStatus`,placeholder:"\u8BF7\u9009\u62E9","data-source":o("marritalStatus","attributeValueList")||[],mapping:{label:"value",value:"code",children:"child"},"is-link":"",required:d("marritalStatus")},null,8,["modelValue","label","name","data-source","required"])):m("",!0),n("degree")?(i(),f(q,{key:26,modelValue:a.value.formInfo.extInfo.educationDegree,"onUpdate:modelValue":t[40]||(t[40]=r=>a.value.formInfo.extInfo.educationDegree=r),label:o("degree","title"),name:`${e.prefix}_educationDegree`,"data-source":o("degree","attributeValueList")||[],mapping:{label:"name",value:"code",children:"child"},placeholder:"\u8BF7\u9009\u62E9",required:d("degree"),"is-link":""},null,8,["modelValue","label","name","data-source","required"])):m("",!0),n("mobile")?(i(),f(c,{key:27,modelValue:a.value.formInfo.mobile,"onUpdate:modelValue":t[41]||(t[41]=r=>a.value.formInfo.mobile=r),label:o("mobile","title"),name:`${e.prefix}_mobile`,placeholder:"\u8BF7\u8F93\u5165",maxlength:11,required:d("mobile"),"validate-type":[N($).PHONE]},null,8,["modelValue","label","name","required","validate-type"])):m("",!0),n("verificationCode")?(i(),f(c,{key:28,modelValue:a.value.formInfo.verificationCode,"onUpdate:modelValue":t[42]||(t[42]=r=>a.value.formInfo.verificationCode=r),label:o("verificationCode","title"),name:`${e.prefix}_verificationCode`,required:d("verificationCode")},{extra:b(()=>[D(be,{class:Ee(["sms-code",{"count-down":g.value>0}]),size:"small",type:"primary",onClick:E},{default:b(()=>[ie(ye(B.value),1)]),_:1},8,["class"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("isSmoke")?(i(),f(c,{key:29,modelValue:a.value.formInfo.isSmoke,"onUpdate:modelValue":t[44]||(t[44]=r=>a.value.formInfo.isSmoke=r),required:d("isSmoke"),label:o("isSmoke","title"),name:`${e.prefix}_isSmoke`,placeholder:"\u8BF7\u9009\u62E9","is-view":C.value},{input:b(()=>[D(k,{modelValue:a.value.formInfo.isSmoke,"onUpdate:modelValue":t[43]||(t[43]=r=>a.value.formInfo.isSmoke=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("isSmoke","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","required","label","name","is-view"])):m("",!0),n("contactNo")?(i(),f(c,{key:30,modelValue:a.value.formInfo.contactNo,"onUpdate:modelValue":t[45]||(t[45]=r=>a.value.formInfo.contactNo=r),label:o("contactNo","title"),name:`${e.prefix}_contactNo`,required:d("contactNo")},null,8,["modelValue","label","name","required"])):m("",!0),n("email")?(i(),f(c,{key:31,modelValue:a.value.formInfo.email,"onUpdate:modelValue":t[46]||(t[46]=r=>a.value.formInfo.email=r),label:o("email","title"),name:`${e.prefix}_email`,placeholder:"\u8BF7\u8F93\u5165",required:d("email"),"validate-type":[N($).EMAIL]},null,8,["modelValue","label","name","required","validate-type"])):m("",!0),n("homeAddress")?(i(),f(G,{key:32,modelValue:a.value.formInfo.extInfo.familyAreaCode,"onUpdate:modelValue":t[47]||(t[47]=r=>a.value.formInfo.extInfo.familyAreaCode=r),field1:a.value.formInfo.extInfo.familyProvinceCode,"onUpdate:field1":t[48]||(t[48]=r=>a.value.formInfo.extInfo.familyProvinceCode=r),field2:a.value.formInfo.extInfo.familyCityCode,"onUpdate:field2":t[49]||(t[49]=r=>a.value.formInfo.extInfo.familyCityCode=r),field3:a.value.formInfo.extInfo.familyAreaCode,"onUpdate:field3":t[50]||(t[50]=r=>a.value.formInfo.extInfo.familyAreaCode=r),label:o("homeAddress","title"),name:`${e.prefix}_familyProvinceCode`,placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:d("homeAddress"),"data-source":N(l),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","label","name","required","data-source"])):m("",!0),n("homeAddressDetail")?(i(),f(c,{key:33,modelValue:a.value.formInfo.extInfo.familyAddress,"onUpdate:modelValue":t[51]||(t[51]=r=>a.value.formInfo.extInfo.familyAddress=r),label:o("homeAddressDetail","title"),name:`${e.prefix}_familyAddress`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...r)=>w(100,...r)}],required:d("homeAddressDetail")},null,8,["modelValue","label","name","rules","required"])):m("",!0),n("homePostalCode")?(i(),f(c,{key:34,modelValue:a.value.formInfo.extInfo.familyZipCode,"onUpdate:modelValue":t[52]||(t[52]=r=>a.value.formInfo.extInfo.familyZipCode=r),label:o("homePostalCode","title"),name:`${e.prefix}_familyZipCode`,placeholder:"\u8BF7\u8F93\u5165",required:d("homePostalCode"),"validate-type":[N($).ZIP_CODE]},null,8,["modelValue","label","name","required","validate-type"])):m("",!0),n("workAddress")?(i(),f(G,{key:35,modelValue:a.value.formInfo.extInfo.workAreaCode,"onUpdate:modelValue":t[53]||(t[53]=r=>a.value.formInfo.extInfo.workAreaCode=r),field1:a.value.formInfo.extInfo.workProvinceCode,"onUpdate:field1":t[54]||(t[54]=r=>a.value.formInfo.extInfo.workProvinceCode=r),field2:a.value.formInfo.extInfo.workCityCode,"onUpdate:field2":t[55]||(t[55]=r=>a.value.formInfo.extInfo.workCityCode=r),field3:a.value.formInfo.extInfo.workAreaCode,"onUpdate:field3":t[56]||(t[56]=r=>a.value.formInfo.extInfo.workAreaCode=r),label:o("workAddress","title"),name:`${e.prefix}_workProvinceCode`,placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:d("workAddress"),"data-source":N(l),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","label","name","required","data-source"])):m("",!0),n("workAddressDetail")?(i(),f(c,{key:36,modelValue:a.value.formInfo.extInfo.workAddress,"onUpdate:modelValue":t[57]||(t[57]=r=>a.value.formInfo.extInfo.workAddress=r),label:o("workAddressDetail","title"),name:`${e.prefix}_workAddress`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...r)=>w(100,...r)}],required:d("workAddressDetail")},null,8,["modelValue","label","name","rules","required"])):m("",!0),n("workPostalCode")?(i(),f(c,{key:37,modelValue:a.value.formInfo.extInfo.workZipCode,"onUpdate:modelValue":t[58]||(t[58]=r=>a.value.formInfo.extInfo.workZipCode=r),label:o("workPostalCode","title"),required:d("workZipCode"),name:`${e.prefix}_workPostCode`,placeholder:"\u8BF7\u8F93\u5165","validate-type":[N($).ZIP_CODE]},null,8,["modelValue","label","required","name","validate-type"])):m("",!0),n("companyName")?(i(),f(c,{key:38,modelValue:a.value.formInfo.extInfo.workStation,"onUpdate:modelValue":t[59]||(t[59]=r=>a.value.formInfo.extInfo.workStation=r),label:o("companyName","title"),name:`${e.prefix}_workPostCode`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...r)=>w(20,...r)}],required:d("companyName")},null,8,["modelValue","label","name","rules","required"])):m("",!0),n("workContent")?(i(),f(c,{key:39,modelValue:a.value.formInfo.extInfo.workContent,"onUpdate:modelValue":t[60]||(t[60]=r=>a.value.formInfo.extInfo.workContent=r),label:o("workContent","title"),name:`${e.prefix}_workContent`,required:d("workContent"),placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...r)=>w(100,...r)}]},null,8,["modelValue","label","name","required","rules"])):m("",!0),n("chineseTaxResident")?(i(),f(c,{key:40,modelValue:a.value.formInfo.extInfo.chineseTaxResident,"onUpdate:modelValue":t[62]||(t[62]=r=>a.value.formInfo.extInfo.chineseTaxResident=r),label:o("chineseTaxResident","title"),name:`${e.prefix}_taxResident`,required:d("chineseTaxResident"),placeholder:"\u8BF7\u8F93\u5165"},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.chineseTaxResident,"onUpdate:modelValue":t[61]||(t[61]=r=>a.value.formInfo.extInfo.chineseTaxResident=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("chineseTaxResident","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("taxResident")?(i(),f(q,{key:41,modelValue:a.value.formInfo.taxResident,"onUpdate:modelValue":t[63]||(t[63]=r=>a.value.formInfo.taxResident=r),label:o("taxResident","title"),name:`${e.prefix}_benefitOrder`,"data-source":o("taxResident","attributeValueList")||[],mapping:{label:"value",value:"code",children:"child"},required:d("taxResident")},null,8,["modelValue","label","name","data-source","required"])):m("",!0),n("partTimeJob")?(i(),f(c,{key:42,modelValue:a.value.formInfo.extInfo.isPartTime,"onUpdate:modelValue":t[65]||(t[65]=r=>a.value.formInfo.extInfo.isPartTime=r),label:o("partTimeJob","title"),name:`${e.prefix}_isPartTime`,required:d("partTimeJob"),placeholder:"\u8BF7\u8F93\u5165"},{input:b(()=>[D(k,{modelValue:a.value.formInfo.extInfo.isPartTime,"onUpdate:modelValue":t[64]||(t[64]=r=>a.value.formInfo.extInfo.isPartTime=r),"is-view":e.isView,prop:{label:"value",value:"code"},options:o("partTimeJob","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):m("",!0),n("gasNumberCollection")?(i(),f(c,{key:43,modelValue:a.value.formInfo.extInfo.gasNumberCollection,"onUpdate:modelValue":t[66]||(t[66]=r=>a.value.formInfo.extInfo.gasNumberCollection=r),label:o("gasNumberCollection","title"),name:`${e.prefix}_gasNumberCollection`,required:d("gasNumberCollection"),placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...r)=>w(100,...r)}]},null,8,["modelValue","label","name","required","rules"])):m("",!0),n("benefitOrder")?(i(),f(q,{key:44,modelValue:a.value.formInfo.benefitOrder,"onUpdate:modelValue":t[67]||(t[67]=r=>a.value.formInfo.benefitOrder=r),label:o("benefitOrder","title"),name:`${e.prefix}_benefitOrder`,"data-source":o("benefitOrder","attributeValueList")||[],mapping:{label:"value",value:"code",children:"child"},required:d("benefitOrder")},null,8,["modelValue","label","name","data-source","required"])):m("",!0),n("benefitRate")?(i(),f(c,{key:45,modelValue:a.value.formInfo.benefitRate,"onUpdate:modelValue":t[68]||(t[68]=r=>a.value.formInfo.benefitRate=r),required:d("benefitRate"),name:`${e.prefix}_benefitRate`,rules:[{validator:Y}],label:o("benefitRate","title")},{extra:b(()=>[qe]),_:1},8,["modelValue","required","name","rules","label"])):m("",!0)])):m("",!0)}}});const Se={class:"page-info-wrapper"},he={key:0,class:"beneficiary-part"},$e={class:"part-title"},He={class:"title"},Me=ie("\u5220\u9664"),Qe=ce({props:{factorObject:null,formInfo:{default:()=>({})},isView:{type:Boolean,default:!1},sendSmsCode:{type:Function,default:(e,v)=>{}},titleCollection:{default:()=>({})}},setup(e,{expose:v}){const I=e;Fe(),ve();const p=O({}),s=O({tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),l=O(null),x=O([]),C=O([]);O([]),O([]);const a=O([]);ge({beneficiaryId:0,nextPage:"",currentAddress:null,isLoading:!0});const V=ae(()=>{var y;const E={};return(((y=p.value)==null?void 0:y.INSURER)||[]).forEach(n=>{E[n.code]=n}),E}),A=E=>{var y;return((y=V.value)==null?void 0:y[E].isDisplay)===te.YES},g=E=>{var y;return((y=V.value)==null?void 0:y[E].isMustInput)===te.YES},B=(E,y)=>{var n,d;return((d=(n=V.value)==null?void 0:n[E])==null?void 0:d[y])||""},U=E=>{s.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=s.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(y=>y.beneficiaryId!==E.beneficiaryId||E.id!==y.id)},T=()=>{Object.assign(s.value.tenantOrderInsuredList[0],s.value.tenantOrderHolder,{id:s.value.tenantOrderInsuredList[0].id,extInfo:{...s.value.tenantOrderHolder.extInfo,insureProvinceCode:s.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,insureCityCode:s.value.tenantOrderInsuredList[0].extInfo.insureCityCode,insureAreaCode:s.value.tenantOrderInsuredList[0].extInfo.insureAreaCode}})};return v({validateForm:()=>new Promise((E,y)=>{var n;(n=l.value)==null||n.validate().then(()=>{E(s.value)},()=>{y()})})}),S(()=>I.factorObject,()=>{const E={BENEFICIARY:I.factorObject[3],INSURER:I.factorObject[2],HOLDER:I.factorObject[1]};p.value=E},{immediate:!0,deep:!0}),S([()=>s.value.tenantOrderInsuredList[0].relationToHolder,()=>s.value.tenantOrderHolder],()=>{`${s.value.tenantOrderInsuredList[0].relationToHolder}`===de.SELF&&T()},{deep:!0,immediate:!0}),S(()=>I.formInfo,()=>{I.formInfo&&(s.value=I.formInfo)},{deep:!0,immediate:!0}),(E,y)=>{const n=R("ProCard"),d=R("ProRadioButton"),o=R("ProField"),X=R("ProSvg"),H=R("ProForm");return i(),W("div",Se,[D(H,{ref_key:"formRef",ref:l,"show-error":"","show-error-message":!1,"input-align":"left"},{default:b(()=>{var P,Y,w,j,K,u;return[(P=p.value.HOLDER)!=null&&P.length?(i(),f(n,{key:0,"show-divider":!1,title:(Y=e.titleCollection)==null?void 0:Y.HOLDER},{default:b(()=>[D(le,{images:x.value,"onUpdate:images":y[0]||(y[0]=t=>x.value=t),"form-info":s.value.tenantOrderHolder,"factor-list":p.value.HOLDER,prefix:"holder","is-view":e.isView,"send-sms-code":e.sendSmsCode},null,8,["images","form-info","factor-list","is-view","send-sms-code"])]),_:1},8,["title"])):m("",!0),(w=p.value.INSURER)!=null&&w.length?(i(),f(n,{key:1,"show-divider":!1,title:(j=e.titleCollection)==null?void 0:j.INSURER},{default:b(()=>[A("relationToHolder")?(i(),f(o,{key:0,modelValue:s.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":y[2]||(y[2]=t=>s.value.tenantOrderInsuredList[0].relationToHolder=t),class:"relation-holder",name:"insure_relationToHolder",required:g("relationToHolder"),label:B("relationToHolder","title")},{input:b(()=>[D(d,{modelValue:s.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":y[1]||(y[1]=t=>s.value.tenantOrderInsuredList[0].relationToHolder=t),"is-view":e.isView,prop:{label:"value",value:"code"},options:B("relationToHolder","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","required","label"])):m("",!0),+s.value.tenantOrderInsuredList[0].relationToHolder!=1?(i(),f(le,{key:1,images:C.value,"onUpdate:images":y[3]||(y[3]=t=>C.value=t),"form-info":s.value.tenantOrderInsuredList[0],"factor-list":p.value.INSURER||[],prefix:"insure","send-sms-code":e.sendSmsCode,"is-view":e.isView},null,8,["images","form-info","factor-list","send-sms-code","is-view"])):m("",!0)]),_:1},8,["title"])):m("",!0),(K=p.value.BENEFICIARY)!=null&&K.length?(i(),f(n,{key:2,"show-divider":!1,title:(u=e.titleCollection)==null?void 0:u.BENEFICIARY},{default:b(()=>[s.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(i(),W("div",he,[(i(!0),W(De,null,Be(s.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(t,k)=>(i(),W("div",{key:t.beneficiaryId||t.id,class:"beneficiary-item"},[Z("div",$e,[Z("span",He,ye(`\u53D7\u76CA\u4EBA${k+1}`),1),D(X,{name:"delete",onClick:c=>U(t)},{default:b(()=>[Me]),_:2},1032,["onClick"])]),D(le,{images:a.value,"onUpdate:images":y[4]||(y[4]=c=>a.value=c),"form-info":t,"factor-list":p.value.BENEFICIARY||[],prefix:`beneficiary-${k}`,"is-view":e.isView,"send-sms-code":e.sendSmsCode,"beneficiary-list":s.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","is-view","send-sms-code","beneficiary-list"])]))),128))])):m("",!0)]),_:1},8,["title"])):m("",!0)]}),_:1},512)])}}}),_e=e=>{const{tenantId:v,riskList:I,riskPremium:p,productId:s}=e;return I.map(l=>{var C;return{tenantId:v,amountUnit:1,annuityDrawFrequency:l.annuityDrawDate,annuityDrawType:l.annuityDrawType,paymentFrequency:l.paymentFrequency,paymentPeriod:l.chargePeriod.split("_")[1],paymentPeriodType:Ce[l.chargePeriod.split("_")[0]],insurancePeriodType:Ve[l.coveragePeriod==="to_life"?"to_life":l.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+l.coveragePeriod.split("_")[1])?0:l.coveragePeriod.split("_")[1],riskCode:l.riskCode,riskType:l.riskType,riskName:l.riskName,extInfo:{riskId:l.riskId,copy:l.copy},initialPremium:(C=p[l.riskCode])==null?void 0:C.premium,liabilityDetails:l.liabilityVOList.map(a=>({liabilityCode:a.liabilityCode,liabilityName:a.liabilityName,refundMethod:a.liabilityAttributeValue})),productId:s,currentAmount:l.amount,initialAmount:l.amount}})},ea=e=>{const v=e.find(s=>s.riskType===re.MAIN_RISK),I=e.filter(s=>s.riskType===re.RIDER_RISK),p=s=>s.map(l=>{const{riskCategory:x,riskCode:C,riskType:a,id:V,riskInsureLimitVO:A,riskCalcMethodInfoVO:g}=l,{annuityDrawFrequencyList:B,annuityDrawValueList:U,insurancePeriodValueList:T,paymentFrequencyList:h,paymentPeriodValueList:E}=A,{minCopy:y,maxCopy:n,fixedAmount:d,singeAmount:o}=g;return{amount:d||o,annuityDrawDate:U==null?void 0:U[0],annuityDrawFrequency:B==null?void 0:B[0],chargePeriod:E==null?void 0:E[0],copy:y||n||0,coveragePeriod:T==null?void 0:T[0],liabilityVOList:l.riskLiabilityInfoVOList,mainRisk:l.riskCode===v.riskCode,mainRiskCode:l.riskCode===v.riskCode?v.riskCode:void 0,mainRiskId:l.riskCode===v.riskCode?v.riskId:void 0,paymentFrequency:h==null?void 0:h[0],riderRisk:!0,riderRiskVOList:p(I),riskCategory:x,riskCode:C,riskId:V,riskType:a}});return p([v])},ne=(e,v,I=[],p=me.YEAR,s=!1)=>{const l=e.filter(C=>{try{return C.extraInfo?JSON.parse(C.extraInfo).packageCode?!!I.includes(C.id):!0:!1}catch{return!1}});console.log("lastRiskList",l);const x=l.find(C=>C.riskType===re.MAIN_RISK);return l.map(C=>{const{riskInsureLimitVO:a,riskCategory:V,id:A,riskType:g,riskName:B,riskCode:U,extraInfo:T,riskLiabilityInfoVOList:h,riskCalcMethodInfoVO:E}=C,{insurancePeriodType:y,insurancePeriodValueList:n,paymentFrequencyList:d,paymentPeriodValueList:o,paymentPeriodType:X,annuityDrawFrequencyList:H,annuityDrawValueList:P,insurancePeriodRule:Y,paymentPeriodRule:w}=a,{fixedAmount:j,minCopy:K}=E,u={amount:j,riskCode:U,riskId:A,riskName:B,paymentFrequency:(d==null?void 0:d[0])||me.YEAR,extraInfo:T,chargePeriod:o==null?void 0:o[0],annuityDrawDate:P==null?void 0:P[0],riskType:g,annuityDrawFrequency:H==null?void 0:H[0],copy:K,coveragePeriod:n==null?void 0:n[0],insuredCode:v==null?void 0:v.insurerCode,liabilityVOList:h,riskCategory:V};return g===re.MAIN_RISK?u:(Y===Ie.ONE_YEAR&&(u.coveragePeriod="year_1"),w===Ie.ONE_YEAR&&(u.chargePeriod="year_1"),{...u,mainRiskId:x==null?void 0:x.id,mainRiskCode:x==null?void 0:x.riskCode})})},aa=e=>{var I,p,s;return{orderAmount:e.premium,tenantId:e.tenantId,venderCode:(I=e.detail)==null?void 0:I.insurerCode,applicationNo:e.applicationNo,policyNo:e.policyNo,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:e.orderCategory,orderStatus:e.orderStatus,orderTopStatus:e.orderTopStatus,tenantOrderHolder:{tenantId:e.tenantId,name:e.holder.name,certNo:e.holder.certNo,certType:F.CERT,mobile:e.holder.mobile,birthday:M(e.holder.certNo),gender:J(e.holder.certNo),extInfo:{hasSocialInsurance:e.holder.socialFlag}},extInfo:{extraInfo:{renewalDK:e.renewalDK,paymentMethod:e.paymentMethod,paymentFrequency:e.paymentFrequency,successJumpUrl:e.successJumpUrl},iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{tenantId:e.tenantId,relationToHolder:e.insured.relationToHolder,certNo:e.insured.certNo,certType:F.CERT,name:e.insured.name,mobile:e.insured.relationToHolder===de.SELF?e.holder.mobile:"",birthday:M(e.insured.certNo),gender:J(e.insured.certNo),extInfo:{hasSocialInsurance:e.insured.socialFlag},tenantOrderProductList:[{tenantId:e.tenantId,productCode:(p=e.detail)==null?void 0:p.productCode,productName:(s=e.detail)==null?void 0:s.productName,premium:e.premium,tenantOrderRiskList:e.tenantOrderRiskList}]}]}},ue=(e,v)=>{if(!e)return"";const[I,p]=e.split("_"),s=parseInt(p,10);return I==="day"?L(v).add(s,"day").format("YYYY-MM-DD"):L(v).add(s,"year").format("YYYY-MM-DD")},oe=(e,v=L().format("YYYY-MM-DD"))=>L(e).diff(v,"day"),Ye=(e,v,I)=>{const p=ue(e,I),s=ue(v,I);return oe(p)<=1&&oe(s)>=0},ta=e=>{const{riskCode:v,liabilityCode:I,birth:p,sex:s}=e,l=ue("max_18",p);return console.log("lastDate",l),console.log("diffDate(lastDate)",oe(l)),!(v==="7Y7"&&I==="FXG086"&&!(s===Oe.FEMALE&&oe(l)<=0))},pe=(e,v,I=p=>!0)=>{const p=M(v),s=J(v),l=[];return e.forEach(x=>{const{riskDetailVOList:C}=x,a=C.map(V=>{const{maxHolderAge:A,minHolderAge:g}=V.riskInsureLimitVO;return Ye(g,A,p)?(V.riskLiabilityInfoVOList=V.riskLiabilityInfoVOList.filter(B=>I({riskCode:V.riskCode,liabilityCode:B.liabilityCode,birth:p,sex:s})),V):null});l.push({riskDetailVOList:a.filter(V=>!!(V&&V.riskLiabilityInfoVOList.length>0))})}),l},ra=(e,v=!1,I=p=>!0)=>{var l,x,C;let p=[];if(v)p=ne((x=(l=pe(se(e.insureDetail.productRiskVoList),e.insured.certNo,I))==null?void 0:l[0])==null?void 0:x.riskDetailVOList,e.productDetail,[],e.paymentFrequency,v);else{const a=pe(se(e.insureDetail.productRiskVoList),e.insured.certNo,I);console.log("===result",[...a]),p=a.map(V=>ne(V.riskDetailVOList,e.productDetail,e.packageRiskIdList,e.paymentFrequency,v))}return{calcData:{holder:{personVO:{birthday:M(e.holder.certNo),certType:F.CERT,certNo:e.holder.certNo,gender:Number(J(e.holder.certNo)),mobile:e.holder.mobile,name:e.holder.name,socialFlag:e.holder.socialFlag}},insuredVOList:[{insuredCode:(C=e.productDetail)==null?void 0:C.insurerCode,relationToHolder:e.insured.relationToHolder,personVO:{birthday:M(e.insured.certNo),certType:F.CERT,certNo:e.insured.certNo,gender:Number(J(e.insured.certNo)),name:e.insured.name,socialFlag:e.insured.socialFlag},productPlanVOList:[{riskVOList:p.flat()}]}],productCode:e.productDetail.productCode,tenantId:e.tenantId},riskVOList:p.flat()}},oa=e=>e&&e.length?e.filter(I=>I.value===Re.INSURE).map(I=>I.productRiskVoList.map(p=>p.id)).flat():[],la=(e,v="year")=>L().diff(M(e),v,!0),je=e=>!e||Number.isNaN(+e.split("_")[1])?0:e==null?void 0:e.split("_")[1],Ke=e=>{const{tenantId:v,riskList:I,riskPremium:p,productId:s}=e;return I.map(l=>{var C,a,V,A,g;return{tenantId:v,amountUnit:1,annuityDrawFrequency:l.annuityDrawDate,annuityDrawType:l.annuityDrawType,paymentFrequency:l.paymentFrequency,paymentPeriod:0,paymentPeriodType:(C=Ce)==null?void 0:C[l.chargePeriod],insurancePeriodType:Ve[l.coveragePeriod==="to_life"?"to_life":(V=(a=l.coveragePeriod)==null?void 0:a.split("_"))==null?void 0:V[0]],insurancePeriodValue:je(l.coveragePeriod),riskCode:l.riskCode,riskType:l.riskType,riskName:l.riskName,extInfo:{riskId:l.riskId,copy:l.copy},initialPremium:(A=p[l.riskCode])==null?void 0:A.premium,liabilityDetails:(g=l.liabilityVOList)==null?void 0:g.map(B=>({liabilityCode:B.liabilityCode,liabilityName:B.liabilityName,refundMethod:B.liabilityAttributeValue})),productId:s,currentAmount:l.amount,initialAmount:l.amount}})},na=e=>{var I,p,s,l;return console.log(e,"freeTransform"),{orderAmount:0,tenantId:e.tenantId,venderCode:e.insureDetail.productBasicInfoVO.insurerCode,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:"1",tenantOrderHolder:{tenantId:e.tenantId,certType:e.order.tenantOrderHolder.certEndType,...e.order.tenantOrderHolder},extInfo:{...e.extInfo,templateId:2,buttonCode:e.buttonCode,pageCode:e.pageCode,iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{...e.order.tenantOrderInsuredList[0],tenantId:e.tenantId,certType:e.order.tenantOrderInsuredList[0].certEndType,mobile:e.order.tenantOrderInsuredList[0].relationToHolder===de.SELF?e.order.tenantOrderHolder.mobile:"",tenantOrderProductList:[{tenantId:e.tenantId,productCode:(I=e.insureDetail)==null?void 0:I.productBasicInfoVO.productCode,productName:(p=e.insureDetail)==null?void 0:p.productBasicInfoVO.productName,premium:0,tenantOrderRiskList:Ke({tenantId:e.tenantId,riskList:ne(e.insureDetail.productRiskVoList[0].riskDetailVOList,e.detail),riskPremium:{},productId:(s=e.detail)==null?void 0:s.id})}]}],operateOption:(l=e.order)==null?void 0:l.operateOption}};export{Qe as _,aa as a,la as b,na as f,ra as g,oa as o,ea as r,_e as t,ta as v};
