var ce=Object.defineProperty,de=Object.defineProperties;var pe=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,ve=Object.prototype.propertyIsEnumerable;var W=(e,a,o)=>a in e?ce(e,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[a]=o,x=(e,a)=>{for(var o in a||(a={}))me.call(a,o)&&W(e,o,a[o]);if(j)for(var o of j(a))ve.call(a,o)&&W(e,o,a[o]);return e},F=(e,a)=>de(e,pe(a));import{h as R,k as b,p as ee,A as l,L as Q,B as f,v as _e,a5 as fe,a6 as Ie,aa as he,P as ge,G as d,j as De,r as P,m as Ce,n as X,s as _,T as I}from"./vendor-a1c35ffc.js";import{S as ye}from"./infoCollection-4373f9e7.js";import{_ as L,a4 as we}from"./index-f6aa927b.js";import{c as Ue}from"./close-df102554.js";import{_ as xe}from"./index-48fa44d2.js";import{a as Se}from"./order-75f10202.js";import{d as $e,i as Oe,a as Be,s as ke,e as Ne,E as Ee}from"./trial-37d4377a.js";import{t as Fe}from"./theme-ea709837.js";import{n as Pe,i as Re,m as be,e as Le,b as Ve,t as qe,k as Me,l as Ae,f as Z,h as Te}from"./utils-3d732ab6.js";import{p as He}from"./product-e4eb60e4.js";import"./trial-69fa7313.js";const ze={class:"com-field-info"},Ge={class:"title"},Je={class:"desc"},Ke=R({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup(e){return(a,o)=>(b(),ee("div",ze,[l("div",Ge,Q(e.title),1),l("div",Je,Q(e.desc),1)]))}});var S=L(Ke,[["__scopeId","data-v-2ff3e068"]]);const ae=e=>(fe("data-v-ed9081ee"),e=e(),Ie(),e),Ye={key:0,class:"pro-modal"},je=ae(()=>l("div",{class:"pro-overlay"},null,-1)),We={class:"pro-modal-wrapper"},Qe=ae(()=>l("div",{class:"pro-modal-content"},[l("p",null,"\u606D\u559C\u60A8"),l("p",null,"\u4FDD\u969C\u5347\u7EA7\u6210\u529F")],-1)),Xe=["src"],Ze=R({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(e,{emit:a}){const o=e,h=()=>{a("on-close")},i=()=>{a("on-confirm")};return(V,w)=>o.isShow?(b(),ee("div",Ye,[je,l("div",We,[l("div",{class:"pro-modal-body"},[Qe,l("div",{class:"pro-modal-btn",onClick:i},"\u6211\u77E5\u9053\u4E86")]),l("div",{class:"pro-modal-close",onClick:h},[l("img",{src:f(Ue)},null,8,Xe)])])])):_e("",!0)}});var ea=L(Ze,[["__scopeId","data-v-ed9081ee"]]);const aa={class:"page-activity-upgrade"},ta=["src"],oa={class:"container"},sa={class:"main-form"},na=R({setup(e){const a=he(),o=ge(),{productCode:h="BWYL2022",tenantId:i,orderNo:V,agentCode:w="",from:te}=o.query;console.log("upload--route.query",o.query);const m=d(),g=d(),s=d(),D=d(),$=d(),U=d(),q=d(!1),O=te==="check",B=d(!1),oe=d(0),k=d("");let N="";const se=()=>{q.value=!1},ne=async()=>{var u,p,v,C,y;const n=Ve({tenantId:i,applicationNo:s.value.applicationNo,policyNo:s.value.policyNo,saleUserId:w,saleChannelId:s.value.saleChannelId,orderStatus:Se.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:m.value,insureDetail:g.value,paymentMethod:(p=(u=s.value.extInfo)==null?void 0:u.extraInfo)==null?void 0:p.paymentMethod,renewalDK:(C=(v=s.value.extInfo)==null?void 0:v.extraInfo)==null?void 0:C.renewalDK,iseeBizNo:N,successJumpUrl:"",premium:D.value,holder:F(x({},s.value.tenantOrderHolder),{socialFlag:s.value.tenantOrderHolder.extInfo.hasSocialInsurance}),insured:F(x({},s.value.tenantOrderInsuredList[0]),{socialFlag:s.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance}),tenantOrderRiskList:qe({tenantId:i,riskList:Me(Ae(g.value.productRiskVoList[0].riskDetailVOList),m.value),riskPremium:{},productId:(y=m.value)==null?void 0:y.id})}),t=await ke(n),{code:c,data:r}=t;return c==="10000"?r.data:""},M=n=>`${we}/pay?orderNo=${n}&saleUserId=${w}&tenantId=${i}`,A=()=>{a.replace(`/pay?orderNo=${k.value}&saleUserId=${w}&tenantId=${i}`)},re=async()=>{try{const n=Z({tenantId:i,premium:D.value,orderDetail:s.value,productDetail:m.value,insureDetail:g.value,successJumpUrl:""},Te),t=await Ne(n),{code:c,data:r}=t;c==="10000"&&(D.value=r.installmentPremium,U.value=r.signUrl)}catch(n){console.log(n)}finally{I.clear()}},le=async n=>{const t=Z({tenantId:i,premium:D.value,orderDetail:s.value,productDetail:m.value,insureDetail:g.value,successJumpUrl:M(n),iseeBizNo:N}),c=await Ee(x({orderNo:n},t)),{code:r,data:u}=c;r==="10000"&&(O?a.replace(`/internet/orderDetail?orderNo=${n}&productCode=${h}&tenantId=${i}`):(I.clear(),A()))},T=async n=>{try{I.loading({forbidClick:!0,message:"\u5347\u7EA7\u4E2D",duration:15*1e3});const t=await ne(),c=await $e({tenantId:i,applicationNo:s.value.applicationNo});if(k.value=t,console.log(k.value,"orderNoUp.value===",t),U.value){if(O){const r=encodeURIComponent(encodeURIComponent(M(t))),u=`${U.value}&successUrl=${r}`;window.location.href=u}else{const r=encodeURIComponent(encodeURIComponent(window.location.href)),u=`${U.value}&failUrl=${r}`;window.location.href=u}I.clear()}else le(t)}catch(t){console.log(t),I.clear()}},ie=async n=>{O?B.value=!0:T()},ue=()=>{I.loading({forbidClick:!0,duration:20*1e3,message:"\u8BD5\u7B97\u4E2D"});const n=He({productCode:h,withInsureInfo:!0,tenantId:i}),t=Oe({productCode:h}),c=Be({orderNo:V,tenantId:i});Promise.all([n,t,c]).then(([r,u,p])=>{var v;r.code==="10000"&&(m.value=r.data,document.title=((v=r.data)==null?void 0:v.productFullName)||""),u.code==="10000"&&(g.value=u.data),p.code==="10000"&&(s.value=p.data,$.value=p.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),re()})};return De(()=>{ue(),setTimeout(async()=>{N=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(n,t)=>{const c=P("ProRadioButton"),r=P("ProField"),u=P("van-config-provider");return b(),Ce(u,{"theme-vars":f(Fe)},{default:X(()=>{var p,v,C,y,H,z,G,J,K,Y;return[l("div",aa,[l("img",{src:(v=(p=m.value)==null?void 0:p.tenantProductInsureVO)==null?void 0:v.banner[0],class:"banner"},null,8,ta),l("div",oa,[l("div",sa,[_(S,{title:"\u59D3\u540D",desc:f(Pe)((y=(C=s.value)==null?void 0:C.tenantOrderInsuredList)==null?void 0:y[0].name)},null,8,["desc"]),_(S,{title:"\u8BC1\u4EF6\u53F7\u7801",desc:f(Re)((z=(H=s.value)==null?void 0:H.tenantOrderInsuredList)==null?void 0:z[0].certNo)},null,8,["desc"]),_(S,{title:"\u624B\u673A\u53F7\u7801",desc:f(be)((J=(G=s.value)==null?void 0:G.tenantOrderHolder)==null?void 0:J.mobile)},null,8,["desc"]),_(S,{title:"\u6BCF\u6708\u4FDD\u8D39",desc:`${f(Le)(D.value||0)}\u5143 / \u6BCF\u6708`},null,8,["desc"]),_(r,{label:"\u6709\u65E0\u793E\u4FDD",name:"name",required:"",placeholder:"\u8BF7\u9009\u62E9"},{input:X(()=>[_(c,{modelValue:$.value,"onUpdate:modelValue":t[0]||(t[0]=E=>$.value=E),disabled:!0,options:f(ye)},null,8,["modelValue","options"])]),_:1}),l("div",{class:"submit",onClick:ie})])]),_(ea,{"is-show":q.value,onOnConfirm:A,onOnClose:se},null,8,["is-show"])]),_(xe,{show:B.value,"onUpdate:show":t[1]||(t[1]=E=>B.value=E),"content-list":(Y=(K=m.value)==null?void 0:K.tenantProductInsureVO)==null?void 0:Y.attachmentVOList,"active-index":oe.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9",onSubmit:T},null,8,["show","content-list","active-index"])]}),_:1},8,["theme-vars"])}}});var ha=L(na,[["__scopeId","data-v-048a833a"]]);export{ha as default};
