import{_ as e,d as r,j as t,cb as s,bz as i,o,m as l,w as a,a as n,b as u,u as d,a8 as c,aE as p,aj as m,r as v,d5 as L,z as f,c as k,p as h,F as C,q as V,cY as I,e as g,as as y,by as b,at as O,cd as S,av as P,aw as R,b_ as T,k as _,a6 as D,f as M,aJ as w,aK as j,i as E,aA as x,O as A,g as N,T as q,au as U,bx as F,n as H,E as Y,aD as $,d6 as B,h as K,d7 as z,d8 as W,az as J,c5 as X,l as G,bu as Q,d9 as Z,da as ee,db as re,dc as te,bl as se,aq as ie,ap as oe,bs as le,dd as ae,cu as ne,de as ue,df as de,aI as ce,af as pe,bh as me,aB as ve}from"./index-29312576.js";import{A as Le}from"./index-9f478e47.js";import{l as fe}from"./index-33ddd6e1.js";import{p as ke}from"./utils-6ffca964.js";import{P as he,_ as Ce,u as Ve}from"./index-e0d67aae.js";import"./PolicyInfo-37bc4d83.js";import{a as Ie,b as ge,c as ye}from"./createProposal-3a2a0ada.js";import{e as be,d as Oe,m as Se,q as Pe,p as Re}from"./trial-7802a527.js";import Te from"./index-58ee8cea.js";import{_ as _e}from"./index-a2f996f6.js";import{_ as De}from"./empty-ae586b6c.js";import{a as Me,b as we}from"./format-31cde443.js";import{C as je}from"./index-fb0e5aeb.js";import{R as Ee}from"./trial-539554b9.js";import{_ as xe}from"./InsureInfos-c9b8adb1.js";import{P as Ae}from"./index-f8880f35.js";import{f as Ne,a as qe}from"./findLastIndex-920d0554.js";import{c as Ue}from"./cloneDeep-f160fc21.js";import{R as Fe,a as He}from"./product-7bbf9c44.js";import"./infoCollection-d9103528.js";import"./questionnaire-42dcb602.js";import"./util-316601c3.js";import"./utils-6db2721f.js";import"./index-de25e814.js";import"./TrialButton-1b36a929.js";import"./config-98e8d477.js";import"./isNaN-a0ec2c7e.js";import"./useOrder-d57e6e21.js";import"./index-85b786dc.js";import"./index-f7ad38c7.js";const Ye={class:"trial-button"};var $e=e(r({__name:"TrialPopup",props:{productCode:{default:""},productName:{default:""}},emits:["finish"],setup(e,{expose:r,emit:v}){const L=e,f=t(null);s(i,{insuredFactorCodes:["hasSocialInsurance","occupationCodeList"],holderFactorCodes:["birthday","gender","hasSocialInsurance","occupationCodeList"]});const k=(e,r)=>{var t,s;const{holder:i,insuredList:o}=e||{},{productList:l,...a}=(null==o?void 0:o[0])||{},n=p(null==r?void 0:r.insuredPremiumList)?null==(s=null==(t=null==r?void 0:r.insuredPremiumList)?void 0:t[0])?void 0:s.productPremiumList.reduce(((e,r)=>(e[r.productCode]=r.riskPremiumDetailVOList.reduce(((e,r)=>(e[r.riskCode]={initialPremium:r.initialPremium,initialAmount:r.initialAmount,unitAmount:r.unitAmount,unitPremium:r.unitPremium},e)),{}),e)),{}):{};return{holder:i,insuredPersonVO:a,insuredProductList:l.map((e=>({productCode:e.productCode,productName:e.productName,occupationCodeList:null==a?void 0:a.occupationCodeList,occupationClass:null==a?void 0:a.occupationClass,riskList:e.riskList.map((r=>{var t,s,i,o,l,a,u,d;return{...r,unitPremium:null==(s=null==(t=null==n?void 0:n[e.productCode])?void 0:t[r.riskCode])?void 0:s.unitPremium,unitAmount:null==(o=null==(i=null==n?void 0:n[e.productCode])?void 0:i[r.riskCode])?void 0:o.unitAmount,initialPremium:null==(a=null==(l=null==n?void 0:n[e.productCode])?void 0:l[r.riskCode])?void 0:a.initialPremium,initialAmount:null==(d=null==(u=null==n?void 0:n[e.productCode])?void 0:u[r.riskCode])?void 0:d.initialAmount}}))})))}};return r({...["open","close"].reduce(((e,r)=>(e[r]=(...e)=>{var t;null==(t=f.value)||t[r](...e)},e)),{}),formatData:k}),(r,t)=>{const s=m;return o(),l(Te,{ref_key:"trialRef",ref:f,"hide-benefit":"","hide-popup-button":"",title:"选择保障方案",class:"proposal-trial","product-info":{productCode:e.productCode},"tenant-product-detail":{}},{trialBtn:a((e=>{var r,t;return[n("div",Ye,[u(s,{disabled:!(null==(t=null==(r=d(f))?void 0:r.getTrialSuccessFlag)?void 0:t.call(r)),type:"primary",onClick:r=>(({trialData:e,riskPremium:r,personalInfoRef:t})=>v("finish",k({...e,productCode:L.productCode},r)))(e)},{default:a((()=>[c("确定")])),_:2},1032,["disabled","onClick"])])]})),_:1},8,["product-info"])}}}),[["__scopeId","data-v-97b0a8d6"]]);const Be={class:"com-risk-list-wrapper"},Ke=(e=>(P("data-v-7d3c3028"),e=e(),R(),e))((()=>n("div",{class:"popup-title"},"选择附加险",-1))),ze={class:"risk-list"},We={class:"cell-title"},Je={class:"title"},Xe={class:"footer-button"};var Ge=e(r({__name:"index",props:{riskList:{default:()=>[]},show:{type:Boolean,default:!1},collocationList:{default:()=>[]},disabled:{default:()=>[]},modelValue:{default:()=>[]}},emits:["finished","close","update:modelValue"],setup(e,{emit:r}){const s=e,i=t([]),p=t([]),P=t([...s.disabled]),R=v({show:s.show,currentChecked:[...s.modelValue]}),T=e=>{var r,t,o;if(P.value.includes(e))return;((e,r)=>{if(!s.collocationList.length)return r?void(R.currentChecked=[]):void R.currentChecked.push(e);let t=R.currentChecked,i=P.value;r?(s.collocationList.forEach((r=>{e===r.riskId&&(2===r.collocationType?t=t.filter((t=>t!==r.collocationRiskId||t!==e)):3===r.collocationType?(t=t.filter((r=>r!==e)),i=i.filter((e=>e!==r.collocationRiskId))):t=t.filter((r=>r!==e)))})),R.currentChecked=t,P.value=i):(s.collocationList.forEach((s=>{e===s.riskId&&(r||(2===s.collocationType?t.push(s.collocationRiskId):3===s.collocationType&&i.push(s.collocationRiskId),t.push(e)))})),R.currentChecked.push(...t),P.value=i)})(e,R.currentChecked.includes(e)),null==(o=null==(t=null==(r=null==i?void 0:i.value)?void 0:r[e])?void 0:t.toggle)||o.call(t)},_=()=>{r("close")},D=()=>{const e=s.riskList.filter((e=>R.currentChecked.includes(e.id)));r("update:modelValue",[...new Set(p.value)]),r("finished",e,P.value),r("close")};return L((()=>{i.value=[]})),f((()=>R.currentChecked),(e=>{p.value=e}),{deep:!0,immediate:!0}),f((()=>s.modelValue),(e=>{p.value=e||[],P.value.push(...e||[])}),{deep:!0,immediate:!0}),(r,t)=>{const s=y,v=b,L=je,f=O,M=m,w=S;return o(),k("div",Be,[u(w,{show:d(R).show,"onUpdate:show":t[1]||(t[1]=e=>d(R).show=e),title:"选择附加险","show-footer":"",round:"",position:"bottom",closeable:"",onClose:_},{default:a((()=>[Ke,n("div",ze,[u(f,{modelValue:d(p),"onUpdate:modelValue":t[0]||(t[0]=e=>h(p)?p.value=e:null)},{default:a((()=>[u(L,{inset:""},{default:a((()=>[(o(!0),k(C,null,V(e.riskList,(e=>(o(),l(v,{key:e.id,title:e.riskName,disabled:d(P).includes(e.id),onClick:r=>T(e.id)},{"right-icon":a((()=>[u(s,{ref_for:!0,ref:r=>d(i)[e.id]=r,shape:"square",disabled:d(P).includes(e.id),name:e.id,onClick:I((r=>T(e.id)),["stop"])},null,8,["disabled","name","onClick"])])),title:a((()=>[n("div",We,[n("div",Je,g(e.riskName),1)])])),_:2},1032,["title","disabled","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])]),n("div",Xe,[u(M,{type:"primary",disabled:!d(R).currentChecked.length,block:"",onClick:D},{default:a((()=>[c("确认")])),_:1},8,["disabled"])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-7d3c3028"]]);const Qe=e=>(P("data-v-7cdbc064"),e=e(),R(),e),Ze={class:"com-product-list-wrapper"},er={class:"risk-item-wrapper"},rr={class:"operate-bar"},tr=["onClick"],sr=["onClick"],ir={class:"content"},or={class:"risk-factor"},lr={class:"factor"},ar={class:"factor-value"},nr=Qe((()=>n("span",{class:"factor-name"}," 保额(元) ",-1))),ur={class:"factor"},dr={class:"factor-value"},cr=Qe((()=>n("span",{class:"factor-name"}," 保障期间 ",-1))),pr={class:"factor"},mr={class:"factor-value"},vr=Qe((()=>n("span",{class:"factor-name"}," 交费期间 ",-1))),Lr={class:"operate-bar-wrap"},fr={class:"risk-premium"},kr={class:"premium"},hr={key:0,class:"operate-bar"},Cr=r({name:"ProductList"});var Vr=e(r({...Cr,props:{productRiskList:{default:()=>[]},productInfo:{default:()=>({})},productData:{default:()=>({})},pickProductPremium:{type:Function,default:()=>{}},productNum:{default:0},errorMsg:{default:""},productIndex:null,currentSelectInsure:{default:0}},emits:["deleteRisk","updateRisk","addRiderRisk"],setup(e,{emit:r}){const s=e,[i,p]=T(),m=t({checkedList:[],disabledList:[],riderRiskList:[],mainRiskData:{},totalPremium:0,currentRiskRecord:{},productRiskList:[]}),v=_((()=>{var e,r;return(null==(r=null==(e=s.productData)?void 0:e.productRiskVoList)?void 0:r[0].riskDetailVOList.filter((e=>1===e.collocationType)))||[]}));_((()=>{var e,r;const t=s.productRiskList.map((e=>e.riskId)),i=((null==(r=null==(e=s.productData)?void 0:e.productRiskVoList)?void 0:r[0].riskDetailVOList)||[]).filter((e=>t.includes(e.id)&&1===e.collocationType));return v.value.length-i.length})),_((()=>e=>{var r,t;const i=(null==(t=null==(r=s.productData)?void 0:r.productRiskVoList)?void 0:t[0].riskDetailVOList.find((r=>r.id!==e)))||{};let o=!1;return o=!!s.productNum||2===i.riskType&&1===i.collocationType,o}));const L=_((()=>{var e,r;return(null==(r=null==(e=s.productData)?void 0:e.productRiskVoList)?void 0:r[0].riskDetailVOList.find((e=>1===e.riskType)))||{}})),h=_((()=>L.value.collocationVOList||[])),I=(e,t)=>{const i=e.map((e=>e.id)).filter((e=>!m.value.disabledList.includes(e)));r("addRiderRisk",i,s.productInfo)};return f((()=>s.productInfo),(e=>{let r=0;(e.riskList||[]).forEach((e=>{r+=e.initialPremium})),m.value.totalPremium=r}),{deep:!0,immediate:!0}),f((()=>s.productRiskList),(e=>{const r=[],t=[],s=[];(e||[]).forEach((e=>{1===e.riskType?r.unshift(e):(t.push(e.riskId),s.push(e.riskId),r.push(e))})),m.value.disabledList=t,m.value.checkedList=s,m.value.productRiskList=r}),{deep:!0,immediate:!0}),(t,L)=>{const f=w,y=j;return o(),k("div",Ze,[(o(!0),k(C,null,V(d(m).productRiskList,(t=>{var i,l;return o(),k("div",{key:t.riskId},[n("div",er,[u(f,{"risk-type":t.riskType,title:t.riskName,class:"no-border"},{default:a((()=>[n("div",rr,[t.exemptFlag!==d(D).YES?(o(),k("div",{key:0,class:"add-risk btn",onClick:e=>{r("updateRisk",t,s.productInfo)}},"修改",8,tr)):M("",!0),n("div",{class:"delete-risk btn",onClick:e=>{r("deleteRisk",t,s.productInfo)}},"删除",8,sr)])])),_:2},1032,["risk-type","title"]),n("div",ir,[n("div",or,[n("div",lr,[n("span",ar,g((null==(i=t.initialAmount)?void 0:i.toLocaleString())||"-"),1),nr]),n("div",ur,[n("span",dr,g(d(Me)(t.coveragePeriod)||"-"),1),cr]),n("div",pr,[n("span",mr,g(d(we)(t.chargePeriod)||"-"),1),vr])]),n("div",Lr,[n("div",fr,[c(" 保费:"),n("span",kr,g(!e.errorMsg&&t.initialPremium?`￥${null==(l=t.initialPremium)?void 0:l.toLocaleString()}`:"-"),1)]),t.riskType===d(Ee).MAIN_RISK?(o(),k("div",hr,[u(y,{activated:"",onClick:i=>((e,t)=>{var i;const o=null==(i=s.productData.productPlanInsureVOList)?void 0:i[0].insureProductRiskVOList.find((e=>e.riskCode===t.riskCode));r("addRiderRisk",e,t,o)})(e.productInfo,t)},{default:a((()=>[c("+附加险")])),_:2},1032,["onClick"])])):M("",!0)])])])])})),128)),d(i)?(o(),l(Ge,{key:0,modelValue:d(m).checkedList,"onUpdate:modelValue":L[0]||(L[0]=e=>d(m).checkedList=e),show:d(i),disabled:d(m).disabledList,"risk-list":d(v),"collocation-list":d(h),onFinished:I,onClose:L[1]||(L[1]=e=>d(p)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):M("",!0),u(he,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-7cdbc064"]]);const Ir={class:"popup-container"},gr={class:"popup-header"},yr={class:"title"},br=(e=>(P("data-v-776ed406"),e=e(),R(),e))((()=>n("p",{class:"tip"},"已为您筛选符合被保人年龄、性别的附加险",-1))),Or={class:"search"},Sr={key:0,class:"risk-list"},Pr={class:"footer-button"},Rr=r({name:"riskSelect"});var Tr=e(r({...Rr,props:{type:{default:2},show:{type:Boolean,default:!1},title:{default:"添加附加险"},holder:{default:()=>({})},insuredList:{default:()=>[]},mainRisk:{default:()=>({})},selectList:{default:()=>[]},currentProduct:{default:()=>({})},currentRiskData:{default:()=>({})}},emits:["cancel","confirm"],setup(e,{emit:r}){const s=e,i=E(),{insurerCode:p="lianlife"}=i.query,m=t([]),v=t([]),L=t([]),S=t(),P=_((()=>s.show)),R=t({}),T=t([]),D=t([]),w=()=>{r("cancel")},j=()=>{m.value=[]},F=()=>{var e;if(!(null==(e=m.value)?void 0:e.length))return void q(`暂未添加任何${s.type===Ee.MAIN_RISK?"主":"附加"}险`);const t=Ne(s.currentProduct.riskList,(e=>e.riskCode===s.mainRisk.riskCode)),i=qe(s.currentProduct.riskList,(e=>e.mainRiskCode===s.mainRisk.riskCode));let o=t;-1!==i&&(o=i);const l=[...s.currentProduct.riskList.slice(0,o+1),...D.value,...s.currentProduct.riskList.slice(o+1)],a={holder:s.holder,insuredList:s.insuredList.map((e=>(e.productList=[{...s.currentProduct,riskList:l}],e)))},n=Object.keys(R.value||{}).reduce(((e,r)=>{var t;return(null==(t=R.value[r])?void 0:t.errorMessage)||e.push(R.value[r].riskDetail),e}),[]);r("confirm",a,n)},H=["annuityDrawDate","coveragePeriod","chargePeriod","paymentFrequency"],Y=e=>{s.type===Ee.RIDER_RISK&&(L.value||[]).forEach((r=>{m.value.includes(e)?e===r.relatedRiskCode?(2===r.collocationType&&m.value.push(r.collocationRiskCode),3===r.collocationType&&(m.value.push(e),m.value=m.value.filter((e=>e!==r.collocationRiskCode)))):e===r.collocationRiskCode&&(2===r.collocationType&&m.value.push(r.relatedRiskCode),3===r.collocationType&&(m.value=m.value.filter((e=>e!==r.relatedRiskCode)))):e===r.relatedRiskCode?(2===r.collocationType&&(m.value=m.value.filter((e=>e!==r.collocationRiskCode))),3===r.collocationType&&(m.value.push(e),m.value=m.value.filter((e=>e!==r.collocationRiskCode)))):e===r.collocationRiskCode&&(2===r.collocationType&&(m.value=m.value.filter((e=>e!==r.relatedRiskCode))),3===r.collocationType&&(m.value=m.value.filter((e=>e!==r.relatedRiskCode))))})),m.value=[...new Set(m.value)]},$=async()=>{const e={insuredList:s.insuredList,holder:s.holder||{},mainRiskCode:s.mainRisk.riskCode,insureCode:p,productCategory:"",keyword:S.value,selectRiskCodes:s.selectList},{code:r,data:t}=await Ie(e);"10000"===r&&(v.value=t.riskInfoList,L.value=t.collocationInfoResList)};return f((()=>m.value),x((e=>{const r={};Object.keys(R.value).reduce(((r,t)=>((e||[]).includes(t)&&(r[t]=R.value[t]),r)),r),R.value=r;const t=(e||[]).filter((e=>!Object.keys(R.value).includes(e)));(null==t?void 0:t.length)&&(async e=>{const{code:r,data:t}=await be({holder:s.holder,insuredList:s.insuredList,calcRiskDefaultFactorVO:{mainRiskInfo:s.mainRisk,riskCodeList:e}},{loading:!0});"10000"===r&&t.reduce(((e,{insureProductRiskVO:r,errorMessage:t,...i})=>(e[i.riskCode]={defaultValue:i,riskDetail:{...r,mainRiskCode:s.mainRisk.riskCode},errorMessage:t},e)),R.value)})(t)}),1e3),{immediate:!0,deep:!0}),f((()=>R.value),(e=>{D.value=Object.keys(R.value||{}).reduce(((e,r)=>{var t;return(null==(t=R.value[r])?void 0:t.errorMessage)||e.push(R.value[r].defaultValue),e}),[])}),{immediate:!0,deep:!0}),A((()=>{$()})),(r,t)=>{const i=Ce,p=y,L=b,f=je,_=O,E=_e,x=U;return o(),l(x,{show:d(P),"onUpdate:show":t[3]||(t[3]=e=>h(P)?P.value=e:null),class:"popup-risk-select",closeable:!1},{default:a((()=>{var y,b;return[n("div",Ir,[n("div",gr,[n("span",{class:"clear-all",onClick:j}," 清空选项 "),n("span",yr,g(e.title),1),n("span",{class:"close",onClick:w},"X")]),br,n("div",Or,[u(i,{modelValue:d(S),"onUpdate:modelValue":t[0]||(t[0]=e=>h(S)?S.value=e:null),placeholder:"请输入附加险名称",onSearch:$},null,8,["modelValue"])]),(null==(y=d(v))?void 0:y.length)?(o(),k("div",Sr,[u(_,{modelValue:d(m),"onUpdate:modelValue":t[2]||(t[2]=e=>h(m)?m.value=e:null)},{default:a((()=>[u(f,{inset:""},{default:a((()=>[(o(!0),k(C,null,V(d(v),(({riskCode:e,riskName:i})=>{var n,c,m,v,f;return o(),k(C,{key:e},[u(L,{clickable:"",title:i,onClick:r=>Y(e)},{"right-icon":a((()=>[u(p,{ref_for:!0,ref:e=>d(T)[r.index]=e,name:e,onClick:I((r=>Y(e)),["stop"])},null,8,["name","onClick"])])),_:2},1032,["title","onClick"]),(null==(n=d(R)[e])?void 0:n.riskDetail)?(o(),l(xe,{key:0,ref_for:!0,ref:"insureInfosRef",class:"insure-part","origin-data":null==(c=d(R)[e])?void 0:c.riskDetail,"default-value":null==(m=d(R)[e])?void 0:m.defaultValue,onTrialChange:t[1]||(t[1]=(e,t)=>(async(e,r,t)=>{var i;if(r){const o=Ue(e);if(delete o.insurancePeriodValueList,delete o.paymentFrequencyList,delete o.paymentPeriodValueList,H.indexOf(r.key)>=0&&`${r.oldValue}`!=`${r.newValue}`){const l={};switch(r.key){case"annuityDrawDate":l.changeType=3;break;case"coveragePeriod":l.changeType=2;break;case"chargePeriod":l.changeType=1;break;case"paymentFrequency":l.changeType=4}const a=[{insureProductRiskVO:s.currentRiskData,insureRiskEditReqVO:s.mainRisk},{insureProductRiskVO:null==(i=R.value[e.riskCode])?void 0:i.riskDetail,insureRiskEditReqVO:{riskId:e.riskId,riskCode:e.riskCode,...o,...l}}],n=s.insuredList.filter((e=>e.birthday))||[];if(!n.length)return!1;await Oe({calcProductFactorList:[{planCode:"",productCode:t,riskEditVOList:a}],insuredVOList:n,holderVO:s.holder})}}return!0})(e,t,r.productCode))},null,8,["origin-data","default-value"])):M("",!0),(null==(v=d(R)[e])?void 0:v.errorMessage)?(o(),l(he,{key:1,"error-msg":null==(f=d(R)[e])?void 0:f.errorMessage},null,8,["error-msg"])):M("",!0)],64)})),128))])),_:1})])),_:1},8,["modelValue"])])):(o(),l(E,{key:1,title:`暂无关联${e.type===d(Ee).MAIN_RISK?"主":"附加"}险、请选择其他险种`},null,8,["title"])),n("div",Pr,[u(Ae,{shadow:!1,disabled:!(null==(b=d(D))?void 0:b.length),onClick:F},{default:a((()=>[N(r.$slots,"default",{},(()=>[c("确定")]),!0)])),_:3},8,["disabled"])])])]})),_:3},8,["show"])}}}),[["__scopeId","data-v-776ed406"]]);const _r=e=>(P("data-v-60460aa9"),e=e(),R(),e),Dr={class:"insurer-list"},Mr=["onClick"],wr=_r((()=>n("span",{class:"insure-name"},"被保人",-1))),jr={key:0,class:"insure-relate"},Er={key:1,class:"insure-relate"},xr=["onClick"],Ar=_r((()=>n("div",{class:"gap"},null,-1))),Nr=_r((()=>n("span",null,"+",-1))),qr=r({name:"InsurerSelect"});var Ur=e(r({...qr,props:{insurerList:{default:()=>[]},config:{default:()=>{}},canChangeSelect:{type:Boolean,default:()=>!0}},emits:["listChange","currentChange","add","delete","validateTab"],setup(e,{expose:r,emit:s}){const i=e,l=t(),a=t(),u=t({currentSelected:0}),p=t(i.insurerList),m=(e=!1)=>{a.value&&Y((()=>{var r;null==(r=l.value[u.value.currentSelected])||r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),0===u.value.currentSelected?a.value.scrollLeft=0:e&&u.value.currentSelected>=3&&(a.value.scrollLeft=a.value.scrollWidth)}))};F((()=>{m(!0)}));const v=e=>{var r;if((null==e?void 0:e.personVO)&&(null==(r=null==e?void 0:e.personVO)?void 0:r.relationToMainInsured)){const r=Fe.find((r=>{var t;return r.value===`${null==(t=null==e?void 0:e.personVO)?void 0:t.relationToMainInsured}`}));if(r)return r.label}return"关系"},L=()=>{var e,r,t,s,i;return!(!(null==(r=null==(e=p.value)?void 0:e[u.value.currentSelected])?void 0:r.productList)||(null==(i=null==(s=null==(t=p.value)?void 0:t[u.value.currentSelected])?void 0:s.productList)?void 0:i.length)<=0)},h=()=>{L()?s("validateTab",(()=>{p.value.push({}),u.value.currentSelected=p.value.length-1,s("add",{},p.value.length-1)})):q("请确认信息是否录入完整!")};return f((()=>i.insurerList.length),(()=>{p.value=i.insurerList,m()}),{deep:!0,immediate:!0}),r({updateInsurer:(e,r)=>{}}),(e,r)=>(o(),k("div",Dr,[n("div",{ref_key:"tabsRef",ref:a,class:"list"},[(o(!0),k(C,null,V(d(p),((e,r)=>(o(),k("div",{ref_for:!0,ref_key:"tabRef",ref:l,key:`insure_${r}`,class:H("insure-box "+(r===d(u).currentSelected?"selected":"")),onClick:e=>((e,r)=>{L()?i.canChangeSelect&&s("validateTab",(()=>{u.value.currentSelected=r,s("currentChange",r),m()})):q("请确认信息是否录入完整!")})(0,r)},[wr,0===r?(o(),k("span",jr,"本人")):(o(),k("span",Er,g(v(e)),1)),r>0?(o(),k("div",{key:2,class:"delete-btn",onClick:e=>((e,r)=>{e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0,$.confirm({message:"确定要删除该被保人吗？"}).then((()=>{s("delete",r,(()=>{r<u.value.currentSelected?(u.value.currentSelected-=1,s("currentChange",u.value.currentSelected)):r===u.value.currentSelected&&(u.value.currentSelected=0,s("currentChange",0))}))})).catch((()=>{}))})(e,r)},"×",8,xr)):M("",!0)],10,Mr)))),128))],512),n("div",{class:"operate"},[Ar,n("div",{class:"add-btn",onClick:h},[Nr,c(" 被保人")])])]))}}),[["__scopeId","data-v-60460aa9"]]);const Fr=e=>(P("data-v-877d65b0"),e=e(),R(),e),Hr={class:"proposal-header"},Yr={key:0,class:"container"},$r=Fr((()=>n("div",{class:"title-tip-icon"},"投保人信息",-1))),Br=Fr((()=>n("span",null,"为TA换个产品",-1))),Kr={key:0,class:"operate-bar"},zr={key:0,class:"operate-bar"},Wr={class:"footer-bar"},Jr={class:"trial-result"},Xr={class:"result-num"},Gr={class:"trial-operate"},Qr=r({name:"CreateProposal"});var Zr=e(r({...Qr,setup(e){const r=[{name:"保存修改"},{name:"另存为新计划书"}],s=B(),[i,L]=T(),[I,y]=T(),b=t({holder:{},insuredList:[{name:"",gender:"",birthday:"",productList:[]}],proposalName:"",totalPremium:0,relationUserType:2}),O=K(),S=E(),P=Ve(),R={},{productCode:D,id:w,preview:A}=S.query,N=["age","gender","birthday","hasSocialInsurance","occupationCodeList"];z("LIANLIFE_OCCUPATION");const U=t(null),H=v({selectedProductCodeList:[],selectedProductList:[],insuredPersonVO:{},insurerList:[],currentProductCode:"",currentProduct:{},holder:{},productList:[],productCollection:{},productErrorMap:{},defaultData:null,currentSelectInsure:0,isLoading:!1,updateRiskCode:"",currentMainRisk:()=>({}),currentRiskData:()=>({})}),he=t(!1),Ce=t(null),Ie=t(null),be=t(null),Te=(e,r,t)=>e?+e<18?"投保人年龄不得小于18周岁":"":"请输入投保人年龄";_((()=>{var e;return(null==(e=H.insurerList[H.currentSelectInsure])?void 0:e.productList)?H.insurerList[H.currentSelectInsure].productList.map((e=>e.productCode)).filter((e=>Boolean(e))):[]}));const Me=()=>H.insurerList[H.currentSelectInsure].productList.map((e=>e.productCode)).filter((e=>Boolean(e))),we=_((()=>{const{productPlanInsureVOList:e}=H.productCollection[D]||{},[{insureProductRiskVOList:r=[]}={}]=e||[],{riskInsureLimitVO:t}=(null==r?void 0:r.find((e=>1===e.riskType)))||{};return null==t?void 0:t.sexLimit})),je=_((()=>"-1"!==we.value&&we.value?W.filter((e=>we.value===e.value)):W)),Ee=_((()=>{var e;return(null==(e=H.productCollection)?void 0:e[H.currentProductCode])||{}}));_((()=>{var e,r;return(null==(r=null==(e=Ee.value)?void 0:e.productPlanInsureVOList)?void 0:r[0])||{}})),_((()=>{var e,r,t;return null==(t=null==(r=null==(e=Ee.value)?void 0:e.productPlanInsureVOList)?void 0:r[0])?void 0:t.multiInsuredConfigVO}));const xe=_((()=>!he.value||Boolean(Object.values(H.productErrorMap).join("")))),Ae=t(),Ne=_((()=>"1"!=`${A}`)),qe=_((()=>H.insurerList.reduce(((e,r)=>+(r.productList.reduce(((e,r)=>+e+ +r.riskList.reduce(((e,r)=>+e+ +(r.initialPremium||0)),0)),0)+ +e)),0))),Ue=e=>{var r,t;const s=[null==(r=Ie.value)?void 0:r.validate()];if(0===H.currentSelectInsure){if(1===H.insurerList[0].personVO.relationToHolder&&H.insurerList[0].personVO.age<18||1!==H.insurerList[0].personVO.relationToHolder&&H.holder.age<18)return void q("投保人年龄不得小于18周岁");s.push(null==(t=be.value)?void 0:t.validate())}Promise.all(s).then((()=>{e()})).catch((e=>{q("请确认信息是否录入完整!")}))},Ye=()=>{const e=H.insurerList.findIndex((({personVO:e})=>e.relationToMainInsured===+He.MATE));return Fe.map((r=>r.value===He.SELF||r.value===He.MATE&&e>=0&&e!==H.currentSelectInsure?{...r,disabled:!0}:{...r}))},Be=(e,r="")=>{H.productErrorMap[e]=r},Ke=e=>{e.insuredProductList.reduce(((e,r)=>{var t,s;const i=null==(s=null==(t=H.insurerList)?void 0:t[H.currentSelectInsure])?void 0:s.productList.findIndex((e=>e.productCode===r.productCode));return-1!==i?e[i]=r:e.push(r),e}),H.insurerList[H.currentSelectInsure].productList)},ze=e=>{var r;console.log("onFinished",e),Object.assign(H.holder,e.holder),0===H.currentSelectInsure&&(e.insuredPersonVO.relationToHolder=H.insurerList[H.currentSelectInsure].personVO.relationToHolder),H.insurerList[H.currentSelectInsure]&&Object.assign(H.insurerList[H.currentSelectInsure].personVO,e.insuredPersonVO),Ke(e),Be(e.productCode),he.value=!0,null==(r=U.value)||r.close()},We=_((()=>{var e;return 1===(null==(e=H.insurerList[H.currentSelectInsure].productList)?void 0:e.length)})),Je=()=>{P.setInsuredPersonVO(H.insurerList[H.currentSelectInsure].personVO),P.setHolderPersonVO(H.holder),P.setExcludeProduct([]),P.setProposalInfo(b.value),H.insurerList[H.currentSelectInsure].productList=[],O.push({path:"/proposalListSelect",query:{isCreateProposal:"1"}})},Xe=()=>{var e,r;Promise.all([null==(e=Ie.value)?void 0:e.validate(),null==(r=be.value)?void 0:r.validate()]).then((()=>{P.setProposalInfo(b.value),P.setExcludeProduct(Me()),P.setExcludeMainRiskCode(H.insurerList[H.currentSelectInsure].productList.reduce(((e,r)=>e.concat(r.riskList.filter((e=>1===e.riskType)).map((e=>e.riskCode)))),[])),P.setInsuredPersonVO(H.insurerList[H.currentSelectInsure].personVO),P.setHolderPersonVO(H.holder),O.push({path:"/proposalListSelect",query:{isCreateProposal:"1",productClass:Ae.value}})})).catch((e=>{console.log("e",e),q("请确认被保人信息是否录入完整!")}))},Ge=(e,r)=>{const t=e;Re(t).then((({code:e,data:s,message:i})=>{var o;e===ve&&s?(null==r||r(),(null==s?void 0:s.errorInfo)&&q(`${null==s?void 0:s.errorInfo}`),p(s.insuredPremiumList)&&Ke(null==(o=U.value)?void 0:o.formatData(t,s)),Be(t.productCode),he.value=!0):Be(t.productCode,i)}))},Qe=e=>{e&&(H.insurerList[H.currentSelectInsure].personVO.age=ie(new Date).diff(e,"year"))},Ze=e=>{e&&(H.holder.age=ie(new Date).diff(e,"year"))},er=e=>{const{value:r}=e;let t={age:30,birthday:ie().subtract(30,"year").format("YYYY-MM-DD"),gender:+oe.MALE};[He.MATE,He.CHILD].includes(r)?t={age:r===He.MATE?H.insurerList[0].personVO.age:0,birthday:r===He.MATE?H.insurerList[0].personVO.birthday:ie().subtract(28,"day").format("YYYY-MM-DD"),gender:r===He.MATE?1==+H.insurerList[0].personVO.gender?2:1:+oe.MALE}:He.PARENT===r&&(t={age:+H.insurerList[0].personVO.age+18,birthday:ie(H.insurerList[0].personVO.birthday).subtract(18,"year").format("YYYY-MM-DD"),gender:+oe.MALE}),Object.assign(H.insurerList[H.currentSelectInsure].personVO,t)},rr=()=>{H.insurerList[H.currentSelectInsure].personVO.birthday=""},tr=()=>{if(0===H.currentSelectInsure){const e=H.insurerList.findIndex((e=>!(!e||!e.personVO)&&+e.personVO.relationToMainInsured==+He.MATE));-1!==e&&(H.insurerList[e].personVO.gender=1==+H.insurerList[0].personVO.gender?2:1)}},sr=()=>{H.holder.birthday=""},ir=e=>{Se(e).then((({code:e,data:r})=>{var t,s;"10000"===e&&p(r.productDetailResList)&&(Ae.value=null==(s=null==(t=null==r?void 0:r.productDetailResList)?void 0:t[0])?void 0:s.productClass,null==r||r.productDetailResList.reduce(((e,r)=>(e[r.productCode]=r,R[r.productCode]=r.productName,e)),H.productCollection))})).finally((()=>{}))},or=()=>{if(1==+H.insurerList[0].personVO.relationToHolder){const{relationToHolder:e,relationToMainInsured:r,productList:t,...s}=H.insurerList[0].personVO;return w&&(s.id=H.holder.id),s}return H.holder},lr=e=>0===e&&2==+H.insurerList[e].personVO.relationToHolder?{...H.insurerList[e].personVO,relationToHolder:null}:H.insurerList[e].personVO,ar=async(e,r=!1)=>{if(!p(e))return;const{code:t,data:s}=await Pe({calcProductFactorList:e,...H.insurerList[H.currentSelectInsure]&&H.insurerList[H.currentSelectInsure].personVO||{}},{isCustomError:!r});if("10000"===t&&s&&s){const{holder:e,insuredList:t}=s,{productList:i,...o}=(t||[])[0]||{},[{riskList:l=[],...a}={}]=i||[],n={...a,riskList:l};r&&(H.insurerList[H.currentSelectInsure]&&Object.assign(H.insurerList[H.currentSelectInsure].personVO,o,{relationToHolder:1}),Object.assign(H.holder,e)),t.forEach(((e,r)=>{const{productList:t,...s}=e;0===H.insurerList.length&&(s.relationToMainInsured||(s.relationToMainInsured=He.SELF),H.insurerList.push({productList:t.map((e=>({...e}))),personVO:s}))}));const u=Me().findIndex((e=>e===(null==i?void 0:i[0].productCode)));u>-1?H.productList[u]=n:H.productList.push(n),Y((()=>{Ge({...s,holder:{...or()},insuredList:[{...lr(H.currentSelectInsure),productList:i}]})}))}},nr=e=>(H.insurerList[H.currentSelectInsure].productList.find((r=>r.productCode===e)),{holder:{...or()},insuredList:[{...lr(H.currentSelectInsure),productList:H.insurerList[H.currentSelectInsure].productList}]}),ur=(e,r)=>{const t=r;$.confirm({message:"确认删除该险种？"}).then((()=>{1===e.riskType?H.insurerList[H.currentSelectInsure].productList=H.insurerList[H.currentSelectInsure].productList.filter((e=>e.productCode!==t.productCode)).map((e=>({...e,nanoid:le()}))):t.riskList=t.riskList.filter((r=>r.riskId!==e.riskId)),Be(t.productCode)}))},dr=(e,r)=>{var t;H.updateRiskCode=e.riskCode,H.currentProductCode=r.productCode;const s=fe.exports.cloneDeep(nr(r.productCode));H.defaultData=s,null==(t=U.value)||t.open()},cr=t({}),pr=(e,r,t)=>{var s,i;Promise.all([null==(s=Ie.value)?void 0:s.validate(),null==(i=be.value)?void 0:i.validate()]).then((()=>{cr.value[e.productCode]=e.riskList.map((e=>e.riskCode)),H.currentProduct=e,H.currentMainRisk=r,H.currentRiskData=t,L(!0)})).catch((e=>{console.log("e",e),q("请确认投被保人信息是否录入完整!")}))},mr=(e,r)=>{Ge(e,(()=>{H.productCollection[e.insuredList[0].productList[0].productCode].productPlanInsureVOList[0].insureProductRiskVOList.push(...r)})),L(!1)},vr=()=>{L(!1)},Lr=e=>{var r,t,s;if(H.insurerList.some((e=>0===e.productList.length)))return void q("请先添加产品");const i=[null==(r=Ce.value)?void 0:r.validate(),null==(t=Ie.value)?void 0:t.validate()];if(0===H.currentSelectInsure){if(1===H.insurerList[0].personVO.relationToHolder&&H.insurerList[0].personVO.age<18||1!==H.insurerList[0].personVO.relationToHolder&&H.holder.age<18)return void q("投保人年龄不得小于18周岁");i.push(null==(s=be.value)?void 0:s.validate())}Promise.all(i).then((()=>{H.isLoading=!0,ye({holder:{...or()},insuredList:H.insurerList.map(((e,r)=>({...lr(r),productList:e.productList.map((e=>({...e,productName:R[e.productCode]})))}))),proposalName:H.insuredPersonVO.proposalName,totalPremium:qe.value,relationUserType:2,id:e}).then((e=>{const{code:r,data:t}=e||{};"10000"===r&&(P.$reset(),O.push({path:"/compositionProposal",query:{id:t,preview:A}}))})).catch((()=>{H.isLoading=!1}))}))},fr=()=>{w?y(!0):Lr(w)},kr=(e,r)=>{Lr(r?void 0:w)},hr=e=>{var r;H.currentSelectInsure=e,(null==(r=H.insurerList[e])?void 0:r.productList.length)>0?ir(ke(H.insurerList[e].productList)):H.productCollection={}},Cr=(e,r)=>{if(H.insurerList.length-1===r){const t=H.insurerList.findIndex((e=>!(!e||!e.personVO)&&+e.personVO.relationToMainInsured==+He.MATE));H.insurerList[r]={...e,personVO:{age:t<0?H.insurerList[0].personVO.age:0,birthday:t<0?H.insurerList[0].personVO.birthday:ie().subtract(28,"day").format("YYYY-MM-DD"),relationToMainInsured:t<0?He.MATE:He.CHILD,gender:t<0?1==+H.insurerList[0].personVO.gender?2:1:oe.MALE,hasSocialInsurance:ae.NO},productList:[]}}H.currentSelectInsure=r,H.productCollection={}},Ir=(e,r)=>{H.insurerList.splice(e,1),null==r||r()};return f([()=>N.map((e=>H.insurerList[H.currentSelectInsure]?H.insurerList[H.currentSelectInsure].personVO[e]:"")),()=>H.currentSelectInsure,()=>N.map((e=>H.holder?H.holder[e]:""))],(([e,r,t],[s,i,o])=>{e.join(",")===s.join(",")&&t.join(",")===o.join(",")||r!==i||p(Object.keys(H.productCollection))&&(async e=>{try{const{code:e,data:r,message:t}=await Oe({calcProductFactorList:H.insurerList[H.currentSelectInsure].productList.map((({productCode:e,riskList:r})=>{const{productPlanInsureVOList:t}=H.productCollection[e]||{},[{insureProductRiskVOList:s}={}]=t||[];return{productCode:e,planCode:"",riskEditVOList:p(r)?r.map((e=>(console.log("riskItem",e,s),{insureProductRiskVO:(null==s?void 0:s.find((r=>r.riskCode===e.riskCode)))||{},insureRiskEditReqVO:e}))):[]}})),insuredVOList:[H.insurerList[H.currentSelectInsure].personVO],holderVO:H.holder},{isCustomError:!0});"10000"===e&&p(r)&&(H.insurerList[H.currentSelectInsure].productList.forEach((({productCode:e,riskList:t})=>{const{productRiskDyInsureFactorVOList:s,errorMessage:i,productCode:o}=r[0]||r.find((r=>r.productCode===e))||{};Be(o,i),t.forEach((e=>{const r=s.find((r=>r.riskCode===e.riskCode));Object.assign(e,{...e,...r})}))})),Ge(nr()))}catch(r){console.log("Error",r)}})(Me())}),{deep:!0}),f((()=>H.selectedProductCodeList),x((e=>{if(p(e)){console.log("选择的产品变动了",e,fe.exports.cloneDeep(H.insurerList)),ar(e.map((e=>({productCode:e}))));const r=Object.keys(H.productCollection),t=null==e?void 0:e.filter((e=>!r.includes(e)));p(t)}})),{deep:!0}),F((()=>{const{selectedProduct:e,selectedProductList:r}=P.$state;H.selectedProductList=r,H.selectedProductCodeList=p(e)?e:[]})),J((()=>{if(X(),D){const e=[{productCode:D}];ir({productList:[{productCode:D,mergeRiskReqList:[]}]}),ar(e,!0)}w&&(((e={})=>{ge(e).then((({code:e,data:r})=>{if("10000"===e&&r){const{insuredList:e,holder:t,proposalName:s}=r||{},[{productList:i,...o}]=e||[];H.holder=t,H.insuredPersonVO={...o,proposalName:s};let l=!1;H.insurerList=e.map(((e,r)=>{const{productList:t,...s}=e,{occupationCodeList:i,occupationClass:o}=(null==t?void 0:t[0])||{};return Object.assign(s,{occupationCodeList:i,occupationClass:o}),0===r&&(s.relationToHolder=s.relationToHolder?1:2,Ze(H.holder.birthday)),{productList:t.filter((e=>(l||1===e.shelfStatus||(l=!0),1===e.shelfStatus))),personVO:s}})),l&&q("计划书中存在已下架产品，请重新生成计划书"),ir(ke(i.filter((e=>1===e.shelfStatus)))),H.productList=i}}))})({id:w}),he.value=!0);const e=(w?"编辑":"创建")+"计划书";S.meta.title=e,document.title=e})),(e,t)=>{const p=ne,v=ue,L=de,f=ce,b=pe,O=j,S=m,P=Le,R=G("ProPageWrap"),T=me;return o(),l(T,{"theme-vars":d(s)},{default:a((()=>[u(R,{class:"page-create-wrapper"},{default:a((()=>{var e,s;return[n("div",Hr,[u(p,{ref_key:"formRef",ref:Ce,class:"mb20",model:d(H).insuredPersonVO},{default:a((()=>[u(d(Q),{modelValue:d(H).insuredPersonVO.proposalName,"onUpdate:modelValue":t[0]||(t[0]=e=>d(H).insuredPersonVO.proposalName=e),class:"ra20",label:"计划书名称",name:"proposalName",maxlength:20},null,8,["modelValue"])])),_:1},8,["model"]),u(Ur,{config:d(H),"insurer-list":d(H).insurerList,"can-change-select":!0,onValidateTab:Ue,onCurrentChange:hr,onAdd:Cr,onDelete:Ir},null,8,["config","insurer-list"])]),d(H).insurerList[d(H).currentSelectInsure]?(o(),k("div",Yr,[u(f,{title:"被保人信息",class:"com-pro-form-with-card com-card-body-no-padding insure-containe","show-divider":!1},{default:a((()=>[u(p,{ref_key:"insuredFormRef",ref:Ie,model:d(H).insurerList[d(H).currentSelectInsure]},{default:a((()=>[u(d(Q),{modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.name,"onUpdate:modelValue":t[1]||(t[1]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.name=e),label:"姓名",name:"name",maxlength:20,required:""},null,8,["modelValue"]),0!==d(H).currentSelectInsure&&d(H).insurerList[d(H).currentSelectInsure]?(o(),l(v,{key:0,modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.relationToMainInsured,"onUpdate:modelValue":t[2]||(t[2]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.relationToMainInsured=e),label:"与主被保人关系","is-default-selected":!0,name:"relationToMainInsured",columns:Ye(),required:"",onConfirm:er},null,8,["modelValue","columns"])):M("",!0),u(d(Q),{modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.age,"onUpdate:modelValue":t[4]||(t[4]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.age=e),class:"age-field-wrap",name:"age",label:"年龄",type:"digit",maxlength:3,required:"",onChange:rr},{extra:a((()=>[u(d(Z),{modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.birthday,"onUpdate:modelValue":[t[3]||(t[3]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.birthday=e),Qe],class:"birthday-field-wrap",label:"出生日期",name:"birthday"},null,8,["modelValue"])])),_:1},8,["modelValue"]),u(d(ee),{modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.gender,"onUpdate:modelValue":t[5]||(t[5]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.gender=e),label:"性别",name:"gender",columns:d(je),disabled:+d(H).insurerList[d(H).currentSelectInsure].personVO.relationToMainInsured==+d(He).MATE,required:"",onChange:tr},null,8,["modelValue","columns","disabled"]),u(d(ee),{modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.hasSocialInsurance,"onUpdate:modelValue":t[6]||(t[6]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.hasSocialInsurance=e),label:"社保",name:"hasSocialInsurance",columns:d(re),required:""},null,8,["modelValue","columns"]),u(L,{modelValue:d(H).insurerList[d(H).currentSelectInsure].personVO.occupationCodeList,"onUpdate:modelValue":t[7]||(t[7]=e=>d(H).insurerList[d(H).currentSelectInsure].personVO.occupationCodeList=e),label:"职业",name:"occupationCodeList","dict-code":"LIANLIFE_OCCUPATION",required:""},null,8,["modelValue"])])),_:1},8,["model"]),0===d(H).currentSelectInsure?(o(),k(C,{key:0},[$r,u(p,{ref_key:"holderFormRef",ref:be,model:d(H).holder,class:"insure-container"},{default:a((()=>[u(d(ee),{modelValue:d(H).insurerList[0].personVO.relationToHolder,"onUpdate:modelValue":t[8]||(t[8]=e=>d(H).insurerList[0].personVO.relationToHolder=e),label:"投被保人是同一人",columns:d(te),required:""},null,8,["modelValue","columns"]),2===d(H).insurerList[0].personVO.relationToHolder?(o(),k(C,{key:0},[u(d(Q),{modelValue:d(H).holder.name,"onUpdate:modelValue":t[9]||(t[9]=e=>d(H).holder.name=e),name:"name",label:"姓名",maxlength:20,required:""},null,8,["modelValue"]),u(d(Q),{modelValue:d(H).holder.age,"onUpdate:modelValue":t[11]||(t[11]=e=>d(H).holder.age=e),class:"age-field-wrap",name:"age",label:"年龄",type:"digit",maxlength:3,required:"",rules:[{required:!0,message:"请输入年龄"},{trigger:"onChange",validator:Te}],onChange:sr},{extra:a((()=>[u(d(Z),{modelValue:d(H).holder.birthday,"onUpdate:modelValue":[t[10]||(t[10]=e=>d(H).holder.birthday=e),Ze],class:"birthday-field-wrap",label:"出生日期",name:"birthday"},null,8,["modelValue"])])),_:1},8,["modelValue","rules"]),u(d(ee),{modelValue:d(H).holder.gender,"onUpdate:modelValue":t[12]||(t[12]=e=>d(H).holder.gender=e),label:"性别",name:"gender",columns:d(W),required:""},null,8,["modelValue","columns"]),u(d(ee),{modelValue:d(H).holder.hasSocialInsurance,"onUpdate:modelValue":t[13]||(t[13]=e=>d(H).holder.hasSocialInsurance=e),label:"社保",name:"hasSocialInsurance",columns:d(re),required:""},null,8,["modelValue","columns"]),u(L,{modelValue:d(H).holder.occupationCodeList,"onUpdate:modelValue":t[14]||(t[14]=e=>d(H).holder.occupationCodeList=e),label:"职业",name:"occupationCodeList","dict-code":"LIANLIFE_OCCUPATION",required:""},null,8,["modelValue"])],64)):M("",!0)])),_:1},8,["model"])],64)):M("",!0)])),_:1}),u(d(se),{ref:"productFormRef",title:"保障计划",class:"product-container"},{cardTitleExtra:a((()=>[d(We)?(o(),k("div",{key:0,class:"replace-product",onClick:Je},[u(b,{name:"refresh",color:"var(--van-primary-color)"}),Br])):M("",!0)])),default:a((()=>{var e;return[d(H).insurerList[d(H).currentSelectInsure].productList.length>0?(o(!0),k(C,{key:0},V(d(H).insurerList[d(H).currentSelectInsure].productList,((e,r)=>(o(),l(f,{key:`${e.nanoid}_${r}_${e.productCode}`,class:"product-item-card","show-line":!1,"show-divider":!1},{default:a((()=>{var t;return[u(Vr,{"product-risk-list":e.riskList,"product-info":e,"product-num":(null==(t=d(H).insurerList[d(H).currentSelectInsure].productList)?void 0:t.length)-1,"product-data":d(H).productCollection[e.productCode],"error-msg":d(H).productErrorMap[e.productCode],"product-index":r,"current-select-insure":d(H).currentSelectInsure,onUpdateRisk:dr,onDeleteRisk:ur,onAddRiderRisk:pr},null,8,["product-risk-list","product-info","product-num","product-data","error-msg","product-index","current-select-insure"])]})),_:2},1024)))),128)):(o(),k(C,{key:1},[d(Ne)?(o(),k("div",Kr,[(null==(e=d(H).insurerList[d(H).currentSelectInsure].productList)?void 0:e.length)<=0?(o(),l(_e,{key:0,"empty-img":d(De),title:"该成员还未配置产品，去添加吧！","empty-class":"empty-select"},null,8,["empty-img"])):M("",!0),u(O,{activated:"",round:34,onClick:Xe},{default:a((()=>[c("+新增主险")])),_:1})])):M("",!0)],64))]})),_:1},512),d(Ne)&&4===d(Ae)&&d(H).insurerList[d(H).currentSelectInsure].productList.length>0?(o(),k("div",zr,[u(O,{activated:"",round:34,onClick:Xe},{default:a((()=>[c("+新增主险")])),_:1})])):M("",!0)])):M("",!0),n("div",Wr,[n("span",Jr,[c("总保费"),n("span",Xr,g(d(xe)?"-":`￥${null==(e=d(qe))?void 0:e.toLocaleString()}`),1)]),n("div",Gr,[u(S,{disabled:d(xe)||d(H).isLoading,loading:d(H).isLoading,"loading-type":"spinner",type:"primary",onClick:fr},{default:a((()=>[c("保存并预览")])),_:1},8,["disabled","loading"])])]),d(i)?(o(),l(Tr,{key:1,show:d(i),holder:d(H).holder,"insured-list":[null==(s=d(H).insurerList[d(H).currentSelectInsure])?void 0:s.personVO],"main-risk":d(H).currentMainRisk,"current-risk-data":d(H).currentRiskData,"current-product":d(H).currentProduct,"select-list":d(cr)[d(H).currentProduct.productCode],onCancel:vr,onConfirm:mr},null,8,["show","holder","insured-list","main-risk","current-risk-data","current-product","select-list"])):M("",!0),u(P,{show:d(I),"onUpdate:show":t[15]||(t[15]=e=>h(I)?I.value=e:null),actions:r,"cancel-text":"取消","close-on-click-action":"",onCancel:t[16]||(t[16]=e=>d(y)(!1)),onSelect:kr},null,8,["show"]),u($e,{ref_key:"trialPopupRef",ref:U,"data-source":{[d(Ee).productCode]:d(Ee)},"product-code":d(H).currentProductCode,"default-data":d(H).defaultData,"update-risk-code":d(H).updateRiskCode,onFinish:ze},null,8,["data-source","product-code","default-data","update-risk-code"])]})),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-877d65b0"]]);export{Zr as default};
