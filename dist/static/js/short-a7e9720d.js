import{_ as e,d as a,a_ as t,r as n,a8 as l,y as r,H as o,aT as i,b as u,q as s,c as d,g as c,i as v,F as m,l as p,h as f,C as y,t as I,j as O,e as h,n as g,f as P,J as C,R as V,w as L,s as k,L as S,M as b,a9 as D,aK as A,b5 as w,aY as N,a0 as x,A as F,a3 as q,ar as T,at as R,az as E,T as U,b6 as H,V as B,u as _,a as j,a$ as M,b0 as Y,ao as Q,z as G,aR as K,aM as z,a5 as $}from"./index-b589d675.js";import{d as W}from"./debounce-90b8f9b8.js";import{i as X,b as J,p as Z,g as ee}from"./trial-76d5a7f9.js";import{p as ae}from"./product-16968ac2.js";import{_ as te,n as ne}from"./nextStep-6b4615fc.js";import{C as le,m as re,n as oe,o as ie,p as ue,S as se,R as de,O as ce}from"./infoCollection-0fc64060.js";import{k as ve,j as me}from"./trial-67b52178.js";import{u as pe}from"./core-08c98f50.js";import{u as fe,B as ye,I as Ie,A as Oe,P as he}from"./useAddressList-5007fb85.js";import{u as ge}from"./theme-40e4e415.js";import{o as Pe,g as Ce,v as Ve,r as Le,t as ke}from"./utils-e9bf9759.js";import{v as Se}from"./validator-5a13dc82.js";import{P as be}from"./index-915dfe7c.js";import{_ as De}from"./index-8398ab67.js";import{u as Ae}from"./useDicData-7030b04c.js";import{P as we}from"./index-ca5ac0a4.js";import{s as Ne,c as xe}from"./phoneVerify-cf5a09ca.js";import{s as Fe}from"./useStorage-ed78a76a.js";import"./pdfdist-c1c6a344.js";import"./relativeTime-91b0b491.js";import"./index-a2996b75.js";const qe={class:"guarantee-list"},Te=(e=>(S("data-v-ac4580b0"),e=e(),b(),e))((()=>v("span",null,"保障计划",-1))),Re={key:0,class:"picture-payment-content"},Ee=["onClick"],Ue=["src"],He=["src"],Be={key:1,class:"plan-list"},_e=["onClick"],je={key:2,class:"feerate-view"},Me={key:0},Ye={class:"extinfo-info-list"},Qe={class:"guarantee-detail"},Ge={class:"content"};var Ke=e(a({props:{dataSource:{type:Object,default:()=>{}},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:5},activePlanCode:{type:String,default:""},isMultiplePlan:{type:Boolean,default:!1},paymentFrequency:{type:String,default:""},premiumInfo:{type:Object,default:()=>{}}},emits:["update-active-plan"],setup(e,{emit:a}){var S;const b=e;t((e=>({"541c7141":K.value})));const D=n(null==(S=b.dataSource)?void 0:S.planList),A=n(b.activePlanCode),w=n();l([()=>b.dataSource,()=>b.activePlanCode],(()=>{var e,a;b.isMultiplePlan&&(D.value=null==(e=b.dataSource)?void 0:e.planList,A.value=b.activePlanCode,w.value=null==(a=b.dataSource)?void 0:a.planList.findIndex((e=>e.planCode===A.value)))}),{immediate:!0});const N=n([]),x=n([]),F=n(),q=r((()=>b.isMultiplePlan?b.dataSource.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[]));l([()=>b.dataSource,()=>b.activePlanCode,()=>b.paymentFrequency,()=>A.value],(()=>{var e,a,t,n,l;if(b.isMultiplePlan){if(D.value&&D.value.length>0){let e=0;const a=D.value.findIndex((e=>e.planCode===A.value));a>-1&&(e=a),N.value=D.value[e].guaranteeItemVOS,x.value=D.value[e].extInfoVOList;const t=D.value[e].productPremiumVOList.find((e=>e.paymentFrequency===b.paymentFrequency));F.value=t||(null==(l=D.value[e])?void 0:l.productPremiumVOList[0])}}else{N.value=null==(e=b.dataSource)?void 0:e.planInsureVO.guaranteeItemVOS,x.value=null==(a=b.dataSource)?void 0:a.planInsureVO.extInfoVOList;const l=null==(t=b.dataSource)?void 0:t.planInsureVO.productPremiumVOList.find((e=>e.paymentFrequency===b.paymentFrequency));F.value=l||(null==(n=b.dataSource)?void 0:n.planInsureVO.productPremiumVOList[0])}}),{immediate:!0,deep:!0});const T=r((()=>{var e;return(null==(e=b.dataSource)?void 0:e.rateUri)||""})),R=r((()=>!!(F.value&&F.value.paymentFrequencyValue&&F.value.premiumUnit&&T))),[E,U]=o(!1),H=r((()=>{var e;return!(!N.value||!(null==(e=N.value)?void 0:e.length))&&(N.value.length>b.count&&(!!b.isShowClose||!E.value))})),B=()=>{U()},_=r((()=>{var e;return N.value&&(null==(e=N.value)?void 0:e.length)?N.value.length<=b.count||E.value?N.value:N.value.slice(0,b.count):[]})),j=e=>{var a;A.value=e,w.value=null==(a=b.dataSource)?void 0:a.planList.findIndex((e=>e.planCode===A.value))},M=n(!1),Y=()=>{M.value=!0},Q=()=>{Pe({fileType:"pdf",fileUri:T.value})},G=e=>{A.value=D.value[e.name].planCode},K=n("");return l([()=>A.value,()=>M.value],(()=>{i((()=>{(()=>{var e,a;const t=((null==(e=document.querySelector(".guarantee-popup .extinfo-info-list"))?void 0:e.clientHeight)||0)+1,n=t+((null==(a=document.querySelector(".guarantee-popup .custom-plan-tab"))?void 0:a.clientHeight)||0)+(t?5:0);K.value=`calc( 100% - ${n}px )`})()}))})),(a,t)=>{var n,l;const r=u("ProCell"),o=u("ProTab"),i=u("ProPopup"),S=s("dompurify-html");return d(),c(m,null,[v("div",qe,[v("div",{class:"header"},[Te,v("span",{onClick:Y},"查看详情")]),e.isMultiplePlan?(d(),c(m,{key:0},[p(q).length>0?(d(),c("div",Re,[(d(!0),c(m,null,f(p(q),(e=>(d(),c("div",{key:e.planCode,class:y("picture-payment-item"),onClick:a=>j(e.planCode)},[A.value==e.planCode?(d(),c("img",{key:0,src:e.selectedPic},null,8,Ue)):(d(),c("img",{key:1,src:e.unSelectedPic},null,8,He))],8,Ee)))),128))])):(d(),c("div",Be,[(d(!0),c(m,null,f(D.value,((e,a)=>(d(),c("div",{key:`${e.planCode}_${a}`,class:y("plan-list-item "+(e.planCode===A.value?"plan-list-item-active":"")),onClick:a=>j(e.planCode)},[v("span",null,I(e.planName),1)],10,_e)))),128))]))],64)):O("",!0),(d(!0),c(m,null,f(p(_),((e,a)=>(d(),h(r,{key:a,class:"guarantee-item",title:e.title,content:e.desc,border:!1},null,8,["title","content"])))),128)),p(H)?(d(),c("div",{key:1,class:"show-more",onClick:B},[g(I(p(E)?"收起":"查看更多")+" ",1),P(C,{name:"arrow-down-dobule",class:y(["icon",{showMore:p(E)}])},null,8,["class"])])):O("",!0),p(R)?(d(),c("div",je,[v("span",null,I(`${(null==(n=F.value)?void 0:n.paymentFrequencyValue)||""}${(null==(l=F.value)?void 0:l.premiumUnit)||""}`),1),p(T)?(d(),c("span",{key:0,onClick:Q},"查看保费")):O("",!0)])):O("",!0)]),P(V),P(i,{show:M.value,"onUpdate:show":t[1]||(t[1]=e=>M.value=e),title:"保障详情",class:"guarantee-popup"},{default:L((()=>[x.value&&x.value.length>0?(d(),c("div",Me,[v("div",Ye,[(d(!0),c(m,null,f(x.value,((e,a)=>(d(),h(r,{key:a,title:e.name,content:e.description,border:!1,size:"small"},null,8,["title","content"])))),128))]),P(V)])):O("",!0),e.isMultiplePlan?(d(),h(o,{key:1,active:w.value,"onUpdate:active":t[0]||(t[0]=e=>w.value=e),list:D.value.map(((e,a)=>({title:e.planName}))),class:"custom-plan-tab",onClickTab:G},null,8,["active","list"])):O("",!0),v("div",Qe,[(d(!0),c(m,null,f(N.value,((e,a)=>(d(),c("div",{key:a,class:"guarantee-item"},[P(r,{title:e.title,content:e.desc,border:!1,size:"small"},null,8,["title","content"]),k(v("div",Ge,null,512),[[S,e.content]])])))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-ac4580b0"]]);const ze={class:"com-custom-card"},$e={class:"title"};var We=e(a({props:{title:{type:String,required:!0}},setup:e=>(a,t)=>(d(),c("div",ze,[v("div",$e,I(e.title),1),v("div",null,[D(a.$slots,"default",{},void 0,!0)])]))}),[["__scopeId","data-v-059c21ee"]]);const Xe={class:"question"},Je={class:"title"};var Ze=e(a({props:{name:{type:String,default:""},question:{type:String,default:""},answer:{type:String,default:""}},setup:e=>(a,t)=>{const n=u("ProSvg"),l=u("van-collapse-item");return d(),h(l,{name:e.name,class:"com-question-item"},{title:L((()=>[v("div",Xe,[P(n,{name:"question"}),v("div",Je,I(e.question),1)])])),default:L((()=>[g(" "+I(e.answer),1)])),_:1},8,["name"])}}),[["__scopeId","data-v-0d7ea124"]]);const ea={class:"com-question"};var aa=e(a({props:{list:{type:Array,default:()=>[]}},setup(e){const a=e,[t,l]=o(!1),i=n([]),s=()=>{l()},v=r((()=>a.list.length<=4||t.value?a.list:a.list.slice(0,4)));return(a,n)=>{const l=u("van-collapse");return d(),c("div",ea,[P(l,{modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=e=>i.value=e)},{default:L((()=>[(d(!0),c(m,null,f(p(v),((e,a)=>(d(),h(Ze,{key:a,name:a.toString(),question:e.title,answer:e.desc},null,8,["name","question","answer"])))),128))])),_:1},8,["modelValue"]),e.list.length>4?(d(),c("div",{key:0,class:"show-more",onClick:s},[g(I(p(t)?"收起":"展开")+" ",1),P(C,{name:"down",class:y(["icon",{showMore:p(t)}])},null,8,["class"])])):O("",!0)])}}}),[["__scopeId","data-v-1b7e97e9"]]);const ta={class:"spec"},na={key:1,class:"spec"};var la=e(a({props:{isCheck:{type:Boolean,default:!1},url:{type:String,default:""},detail:{type:Object,default:()=>{}}},setup(e,{expose:a}){const t=e,l=n(),o=n([{title:"产品亮点",slotName:"tab1"},{title:"理赔说明",slotName:"tab2"},{title:"我要投保",slotName:"tab3"}]),i=r((()=>{var e,a,n,l;return(null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.spec)&&(null==(l=null==(n=t.detail)?void 0:n.tenantProductInsureVO)?void 0:l.spec.length)>0})),s=r((()=>{var e,a,n,l,r,o,i,u,s,d,c,v,m,p;const f=null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.settlementProcessVO.settlementProcessType;return!!(f===le.WORD&&(null==(r=null==(l=null==(n=t.detail)?void 0:n.tenantProductInsureVO)?void 0:l.settlementProcessVO)?void 0:r.settlementProcessList)&&(null==(u=null==(i=null==(o=t.detail)?void 0:o.tenantProductInsureVO)?void 0:i.settlementProcessVO)?void 0:u.settlementProcessList.length)>0||f===le.IMAGE&&(null==(c=null==(d=null==(s=t.detail)?void 0:s.tenantProductInsureVO)?void 0:d.settlementProcessVO)?void 0:c.settlementProcessPicList)&&(null==(p=null==(m=null==(v=t.detail)?void 0:v.tenantProductInsureVO)?void 0:m.settlementProcessVO)?void 0:p.settlementProcessPicList.length)>0)})),y=r((()=>{var e,a,n,l;return(null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.questionList)&&(null==(l=null==(n=t.detail)?void 0:n.tenantProductInsureVO)?void 0:l.questionList.length)>0})),I=r((()=>{let e=[...o.value];return i.value||(e=e.filter((e=>"tab1"!==e.slotName))),s.value||y.value||(e=e.filter((e=>"tab2"!==e.slotName))),e}));return a({handleClickTab:()=>{var e;return null==(e=l.value)?void 0:e.handleClickTab}}),(e,a)=>{const n=u("van-image"),r=u("ProSvg");return d(),h(N,{ref_key:"scrollRef",ref:l,class:"tabs",list:p(I),sticky:"",scrollspy:""},A({tab3:L((()=>[D(e.$slots,"form",{},void 0,!0)])),_:2},[p(i)?{name:"tab1",fn:L((()=>{var e,a;return[v("div",ta,[(d(!0),c(m,null,f((null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.spec)||[],((e,a)=>(d(),h(w,{key:a},{fallback:L((()=>[P(r,{name:"img",style:{"font-size":"40px",margin:"10px auto",display:"block"}})])),default:L((()=>[(d(),h(n,{key:a,class:"detail-img",width:"100%",src:e},null,8,["src"]))])),_:2},1024)))),128)),P(V)])]}))}:void 0,p(s)||p(y)?{name:"tab2",fn:L((()=>{var e,a;return[p(s)?(d(),c(m,{key:0},[(null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.settlementProcessVO.settlementProcessType)===p(le).WORD?(d(),h(We,{key:0,title:"理赔说明"},{default:L((()=>{var e,a,n;return[P(be,{list:null==(n=null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.settlementProcessVO)?void 0:n.settlementProcessList},null,8,["list"])]})),_:1})):(d(),c("div",na,[(d(),h(w,null,{fallback:L((()=>[P(r,{name:"img",style:{"font-size":"40px",margin:"10px auto",display:"block"}})])),default:L((()=>{var e,a,l;return[(d(!0),c(m,null,f((null==(l=null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.settlementProcessVO)?void 0:l.settlementProcessPicList)||[],((e,a)=>(d(),h(n,{key:a,width:"100%",src:e,class:"detail-img"},null,8,["src"])))),128))]})),_:1}))])),P(V)],64)):O("",!0),p(y)?(d(),c(m,{key:1},[P(We,{title:"常见问题"},{default:L((()=>{var e,a;return[P(aa,{list:null==(a=null==(e=t.detail)?void 0:e.tenantProductInsureVO)?void 0:a.questionList},null,8,["list"])]})),_:1}),P(V)],64)):O("",!0)]}))}:void 0]),1032,["list"])}}}),[["__scopeId","data-v-10149cea"]]);const ra=v("div",{class:"tip"},[v("div",{class:"content"},[v("span",null,[v("span",{class:"important-text"},"重要"),g(" 请确认被保险人是否存在下列问题，请如实告知，否则将对您的理赔权益或合同效力产生影响 ")])])],-1),oa={class:"title"},ia={class:"list"},ua={class:"item"},sa={class:"footer"},da=g("不符合"),ca=g("符合，立即投保"),va=a({props:{show:{type:Boolean,default:!0},activeIndex:{default:0},contentList:{default:()=>[]}},emits:["update:show","onConfirmHealth","onCloseHealthByMask"],setup(e,{emit:a}){const t=e,o=ge(),i=n(t.show),s=n(t.activeIndex),c=r((()=>{var e;return null==(e=t.contentList[s.value])?void 0:e.attachmentUri})),m=r((()=>{var e;return null==(e=t.contentList[s.value])?void 0:e.attachmentType})),f=n(!0),y=e=>{"allFalse"===e&&(f.value=!1,a("update:show",!1)),a("onConfirmHealth",e)};return l((()=>t),(()=>{i.value=t.show,s.value=t.activeIndex}),{deep:!0,immediate:!0}),(t,n)=>{const l=u("ProFilePreview"),r=u("VanButton"),s=u("van-config-provider"),O=u("ProPopup");return d(),h(O,{show:i.value,"onUpdate:show":n[2]||(n[2]=e=>i.value=e),height:80,class:"health-notice-preview-popup-wrap",closeable:!1,onClose:n[3]||(n[3]=e=>{f.value&&a("onCloseHealthByMask")})},{default:L((()=>[P(s,{"theme-vars":p(o),class:"custom-provider"},{default:L((()=>[ra,v("div",oa,I(e.contentList[0].attachmentName),1),v("div",ia,[v("div",ua,[(d(),h(l,{key:p(c),content:p(c),type:p(m)},null,8,["content","type"]))])]),v("div",sa,[P(r,{block:"",round:"",class:"left",onClick:n[0]||(n[0]=e=>y("N"))},{default:L((()=>[da])),_:1}),P(r,{type:"primary",plain:"",block:"",round:"",onClick:n[1]||(n[1]=e=>y("allFalse"))},{default:L((()=>[ca])),_:1})])])),_:1},8,["theme-vars"])])),_:1},8,["show"])}}}),ma=(e,a="YYYY-MM-DD")=>x(e).format(a),pa=(e,a=0,t="day",n="YYYY-MM-DD")=>x(e).add(a,t).format(n),fa=(e,a=0,t="day",n="YYYY-MM-DD")=>x(e).subtract(a,t).format(n);const ya=e=>(S("data-v-986cd31c"),e=e(),b(),e),Ia={class:"com-period-cell"},Oa={key:0,class:"period-custom-cell period-check-btn-cell"},ha=ya((()=>v("div",{class:"period-cell-label"},"保障期间",-1))),ga={class:"period-cell-content"},Pa=ya((()=>v("div",{class:"period-cell-label"},"生效日期",-1))),Ca={class:"period-cell-content period-custom-cell-content"},Va={key:2,class:"period-custom-cell period-common-cell"},La=ya((()=>v("div",{class:"period-cell-label"},"保障期限",-1))),ka={class:"period-cell-content"},Sa=ya((()=>v("div",{class:"picker-custom-title"},"保险开始生效日期",-1))),ba=g("确 定");var Da=e(a({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(e,{expose:a,emit:t}){const i=e;n({});const s=(e,a)=>"year"===e?`${a}年`:"month"===e?`${a}月`:"day"===e?`${a}日`:a,f=n(new Date),y=Ae("RISK_INSURANCE_PERIOD"),h=F({formInfo:i.formInfo});l((()=>h.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(f.value=new Date(e))}));const g=n(),C=n([]);l([()=>i.insureDetail,()=>h.formInfo.activePlanCode],(()=>{var e;if(h.formInfo.insuranceStartDate="",h.formInfo.insuranceEndDate="",h.formInfo.commencementTime="",i.insureDetail)if(i.insureDetail.productRelationPlanVOList&&i.insureDetail.productRelationPlanVOList.length>0){let a=0;const t=i.insureDetail.productRelationPlanVOList.findIndex((e=>e.planCode===h.formInfo.activePlanCode));t>-1&&(a=t);const n=((null==(e=i.insureDetail.productRelationPlanVOList[a])?void 0:e.productRiskVoList[0].riskDetailVOList)||[]).find((e=>1===e.riskType));n&&(g.value=n)}else{const e=(i.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find((e=>1===e.riskType));e&&(g.value=e)}}),{deep:!0,immediate:!0}),l([()=>g.value,()=>y.value],(()=>{C.value=[],Array.isArray(y.value)&&y.value.length>1&&g.value&&(C.value=(g.value.riskInsureLimitVO.insurancePeriodValueList||[]).map((e=>{const a=y.value.find((a=>a.value===e));return a?{label:a.name,value:a.value}:null})).filter((e=>!!e))),C.value.length>0?C.value.findIndex((e=>e.value===h.formInfo.insurancePeriodValue))<0&&(h.formInfo.insurancePeriodValue=C.value[0].value):h.formInfo.insurancePeriodValue=ve.YEAR_1}),{deep:!0,immediate:!0});const V=r((()=>{var e,a;return(null==(e=g.value)?void 0:e.insuranceStartType)?String(null==(a=g.value)?void 0:a.insuranceStartType):re.CURRENT_DAY})),k=r((()=>{var e,a;return(null==(e=g.value)?void 0:e.insuranceEndType)?String(null==(a=g.value)?void 0:a.insuranceEndType):oe.CURRENT_DAY})),[S,b]=o(!1),D=()=>{b(!0)},A=new Date(pa(new Date,1,"day")),w=r((()=>{var e;if(V.value===re.CUSTOM_DAY){const a=null==(e=g.value)?void 0:e.riskInsureLimitVO.maxInsuranceDay;if(!a)return new Date;const t=pa(new Date,Number(a),"day");return new Date(t)}return new Date})),N=e=>{h.formInfo.insuranceStartDate=`${ma(e)} 00:00:00`,b(!1)},x=()=>{b(!1)};return l([()=>V.value,()=>h.formInfo.insurancePeriodValue,()=>h.formInfo.insuranceStartDate,()=>g.value],(()=>{if(i.insureDetail){const{productBasicInfoVO:e}=i.insureDetail;if(e&&"CX48"===e.productCode){h.formInfo.insuranceStartDate=`${pa(new Date,7,"day")} 00:00:00`;const e=`${fa(h.formInfo.insuranceStartDate,1,"day")} 00:00:00`;return void(h.formInfo.insuranceEndDate=`${pa(e,1,"year")} 23:59:59`)}}if(!h.formInfo.insurancePeriodValue)return;const[e,a]=h.formInfo.insurancePeriodValue.split("_");if(h.formInfo.insuranceStartDate||(V.value===re.CUSTOM_DAY||V.value===re.NEXT_DAY?h.formInfo.insuranceStartDate=`${pa(new Date,1,"day")} 00:00:00`:h.formInfo.insuranceStartDate=`${ma(new Date)} 00:00:00`),"to"!==e){const t=`${fa(h.formInfo.insuranceStartDate,1,"day")} 00:00:00`;k.value===oe.CURRENT_DAY?h.formInfo.insuranceEndDate=`${pa(t,Number(a),e)} 23:59:59`:h.formInfo.insuranceEndDate=`${pa(h.formInfo.insuranceStartDate,Number(a),e)} 00:00:00`}else{let t=h.formInfo.tenantOrderInsuredList[0].birthday;h.formInfo.tenantOrderInsuredList[0].certType===q.CERT&&h.formInfo.tenantOrderInsuredList[0].certNo&&T(h.formInfo.tenantOrderInsuredList[0].certNo)&&(t=R(h.formInfo.tenantOrderInsuredList[0].certNo));const n=`${fa(t,1,"day")} 00:00:00`;"single"===a&&(h.formInfo.insuranceEndDate="9999-99-99 23:59:59"),k.value===oe.CURRENT_DAY?h.formInfo.insuranceEndDate=`${pa(n,Number(a),e)} 23:59:59`:h.formInfo.insuranceEndDate=`${pa(t,Number(a),e)} 00:00:00`}}),{immediate:!0}),a({}),(e,a)=>{const t=u("ProRadioButton"),n=u("ProSvg"),l=u("van-config-provider"),r=u("VanButton"),o=u("van-datetime-picker"),i=u("ProPopup");return d(),c(m,null,[P(l,null,{default:L((()=>[v("div",Ia,[C.value.length>1?(d(),c("div",Oa,[ha,v("div",ga,[P(t,{modelValue:p(h).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=e=>p(h).formInfo.insurancePeriodValue=e),options:C.value},null,8,["modelValue","options"])])])):O("",!0),p(V)===p(re).CUSTOM_DAY?(d(),c("div",{key:1,class:"period-custom-cell period-common-cell",onClick:D},[Pa,v("div",Ca,[v("span",null,I(p(h).formInfo.insuranceStartDate?p(ma)(p(h).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),P(n,{class:"custom--arrow-right",name:"arrow-right"})])])):O("",!0),p(V)!==p(re).CUSTOM_DAY?(d(),c("div",Va,[La,v("div",ka,I(p(h).formInfo.insuranceStartDate?p(ma)(p(h).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+I(p(h).formInfo.insuranceEndDate?p(ma)(p(h).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):O("",!0)])])),_:1}),P(i,{show:p(S),"onUpdate:show":a[3]||(a[3]=e=>E(S)?S.value=e:null),height:"340",closeable:!0},{default:L((()=>[P(o,{modelValue:f.value,"onUpdate:modelValue":a[2]||(a[2]=e=>f.value=e),type:"date",title:"保险开始生效日期","min-date":p(A),"max-date":p(w),formatter:s,"visible-item-count":5,class:"custom-date-picker",onConfirm:N,onCancel:x},{cancel:L((()=>[])),title:L((()=>[Sa])),confirm:L((()=>[P(r,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:a[1]||(a[1]=e=>S.value=!1)},{default:L((()=>[ba])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-986cd31c"]]);const Aa=e=>(S("data-v-679123b1"),e=e(),b(),e),wa={class:"com-payment-type"},Na={class:"title"},xa={key:0,class:"picture-payment-content"},Fa=["onClick"],qa=["src"],Ta=["src"],Ra={key:1,class:"custom-cell check-btn-cell"},Ea=Aa((()=>v("div",{class:"cell-label"},"保障方案",-1))),Ua={class:"cell-content"},Ha={key:0,class:"picture-payment-content"},Ba=["onClick"],_a=["src"],ja=["src"],Ma={key:1,class:"default-payment-content"},Ya=[Aa((()=>v("div",{class:"pay-method"},[v("span",{class:"method"},I("按月交费")),v("span",{class:"acount"},I("共12期"))],-1)))],Qa=[Aa((()=>v("div",null,[v("div",{class:"tip"},[v("span",null,I("比按月支付最高省16%"))]),v("div",{class:"triangle"}),v("div",{class:"pay-method"},[v("span",{class:"method"},I("一次交清")),v("span",{class:"acount"},I("比月交保费省最高2014元"))])],-1)))],Ga={key:2,class:"custom-cell check-btn-cell"},Ka=Aa((()=>v("div",{class:"cell-label"},"交费方式",-1))),za={class:"cell-content"},$a={class:"custom-cell common-cell"},Wa=Aa((()=>v("div",{class:"cell-label"},"实付保费",-1))),Xa={key:0,class:"cell-content actual-premium"},Ja={class:"cell-content actual-premium"},Za={key:0,class:"actual-premium actual-premium-month-tip"},et={key:0,class:"feerate-explain"},at={class:"content"},tt=Aa((()=>v("div",{class:"triangle-top"},null,-1)));var nt=e(a({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premiumInfo:{type:Object,default:()=>{}}},emits:["update-active-plan"],setup(e,{expose:a,emit:t}){const o=e;n({});const i=F({formInfo:o.formInfo}),s=n([]),g=n(),C=n(),V=r((()=>{var e;return"1"===String(null==(e=g.value)?void 0:e.paymentFrequencyFlag)}));r((()=>{var e;return null==(e=C.value)?void 0:e.productPremiumVOList.find((e=>e.paymentFrequency===i.formInfo.paymentFrequency))}));const k=r((()=>o.premiumInfo.premiumLoadingText?o.premiumInfo.premiumLoadingText:o.premiumInfo.premium?`${o.premiumInfo.premium||""}${o.premiumInfo.actualUnit||"元"}`:`${o.premiumInfo.minPremiun||""}${o.premiumInfo.unit||""}`)),S=r((()=>{if(C){const{premiumExplain:e,premiumExplainViewName:a,premiumExplainUri:t}=C.value||{};return{premiumExplain:e,premiumExplainUri:t,premiumExplainViewName:a}}return null})),b=r((()=>S.value&&S.value.premiumExplain&&S.value.premiumExplainViewName));l((()=>o.configDetail),(()=>{var e;o.isMultiplePlan&&o.configDetail&&(s.value=null==(e=o.configDetail.tenantProductInsureVO)?void 0:e.planList)}),{immediate:!0,deep:!0}),l([()=>o.configDetail,()=>o.isMultiplePlan,()=>i.formInfo.activePlanCode],(()=>{if(o.configDetail)if(o.isMultiplePlan){let e=0;const a=o.configDetail.tenantProductInsureVO.planList.findIndex((e=>e.planCode===i.formInfo.activePlanCode));a>-1&&(e=a),g.value=o.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,C.value=o.configDetail.tenantProductInsureVO.planList[e]}else g.value=o.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,C.value=o.configDetail.tenantProductInsureVO.planInsureVO}),{deep:!0,immediate:!0});const D=r((()=>{var e;if(g.value&&g.value.paymentFrequency){return((null==(e=g.value.paymentFrequency)?void 0:e.split(","))||[]).length>1}return!1})),A=n(!1);l((()=>g.value),(()=>{var e;if(g.value){const a=(null==(e=g.value.paymentFrequency)?void 0:e.split(","))||[];if(1===a.length)return i.formInfo.paymentFrequency=g.value.paymentFrequency,void(A.value=!1);if(2===a.length&&a.filter((e=>![ie.SINGLE,ie.MONTH].includes(e))).length<1)return A.value=!0,void(i.formInfo.paymentFrequency||(i.formInfo.paymentFrequency=ie.SINGLE));a.length>1&&!i.formInfo.paymentFrequency&&(i.formInfo.paymentFrequency=null==a?void 0:a[0]),A.value=!1}}),{immediate:!0,deep:!0});const w=r((()=>{var e;return g.value?null==(e=g.value.paymentFrequencyList||[])?void 0:e.map((e=>({...e,paymentFrequency:e.skinValue}))):[]})),N=r((()=>w.value.length>0)),x=r((()=>o.isMultiplePlan?o.configDetail.tenantProductInsureVO.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[])),q=r((()=>{var e,a;if(g.value){const t=(null==(e=g.value.paymentFrequency)?void 0:e.split(","))||[];return 1===t.length&&(i.formInfo.paymentFrequency=t[0]),null==(a=t||[])?void 0:a.map((e=>({label:ue[e],value:e})))}return[]})),T=e=>{i.formInfo.paymentFrequency=e},R=e=>{i.formInfo.activePlanCode=e},E=()=>{var e,a;(null==(e=S.value)?void 0:e.premiumExplainUri)?Pe({fileType:"pdf",fileUri:null==(a=S.value)?void 0:a.premiumExplainUri}):U("无费率文件！")};return a({}),(a,t)=>{const n=u("ProRadioButton"),l=u("templat"),r=u("ProDivider"),g=u("van-config-provider");return d(),h(g,null,{default:L((()=>[v("div",wa,[v("div",Na,I(p(D)?"交费方式":"保障计划"),1),e.isMultiplePlan?(d(),c(m,{key:0},[p(x).length>0?(d(),c("div",xa,[(d(!0),c(m,null,f(p(x),(e=>(d(),c("div",{key:e.planCode,class:y("picture-payment-item"),onClick:a=>R(e.planCode)},[p(i).formInfo.activePlanCode==e.planCode?(d(),c("img",{key:0,src:e.selectedPic},null,8,qa)):(d(),c("img",{key:1,src:e.unSelectedPic},null,8,Ta))],8,Fa)))),128))])):(d(),c("div",Ra,[Ea,v("div",Ua,[P(n,{modelValue:p(i).formInfo.activePlanCode,"onUpdate:modelValue":t[0]||(t[0]=e=>p(i).formInfo.activePlanCode=e),options:s.value,prop:{value:"planCode",label:"planName"},onChange:R},null,8,["modelValue","options"])])]))],64)):O("",!0),p(V)?(d(),h(l,{key:1},{default:L((()=>[p(N)&&p(w).length>1?(d(),c("div",Ha,[(d(!0),c(m,null,f(p(w),(e=>(d(),c("div",{key:e.paymentFrequency,class:y("picture-payment-item"),onClick:a=>T(e.paymentFrequency)},[p(i).formInfo.paymentFrequency==e.paymentFrequency?(d(),c("img",{key:0,src:e.selectedPic},null,8,_a)):(d(),c("img",{key:1,src:e.unSelectedPic},null,8,ja))],8,Ba)))),128))])):A.value?(d(),c("div",Ma,[v("div",{class:y("com-payment-type-item "+(p(i).formInfo.paymentFrequency==p(ie).MONTH?"active":"")),onClick:t[1]||(t[1]=e=>T(p(ie).MONTH))},Ya,2),v("div",{class:y("com-payment-type-item "+(p(i).formInfo.paymentFrequency==p(ie).SINGLE?"active":"")),onClick:t[2]||(t[2]=e=>T(p(ie).SINGLE))},Qa,2)])):p(q).length>1?(d(),c("div",Ga,[Ka,v("div",za,[P(n,{modelValue:p(i).formInfo.paymentFrequency,"onUpdate:modelValue":t[3]||(t[3]=e=>p(i).formInfo.paymentFrequency=e),options:p(q)},null,8,["modelValue","options"])])])):O("",!0)])),_:1})):O("",!0),P(Da,{"form-info":p(i).formInfo,"insure-detail":e.insureDetail,"config-detail":e.configDetail},null,8,["form-info","insure-detail","config-detail"]),p(k)&&p(b)?(d(),c(m,{key:2},[v("div",$a,[Wa,o.premiumInfo.premiumLoadingText?(d(),c("div",Xa,I(p(k)),1)):(d(),c(m,{key:1},[v("div",Ja,I(p(k)),1),"5"===p(i).formInfo.paymentFrequency?(d(),c("div",Za," 共12期 ")):O("",!0)],64))]),p(b)?(d(),c("div",et,[v("div",at,[tt,v("div",null,[v("span",null,I(p(S).premiumExplain||""),1),v("span",{class:"file-name",onClick:E},"《"+I(p(S).premiumExplainViewName||"")+"》",1)])])])):O("",!0)],64)):O("",!0)]),P(r)])),_:1})}}}),[["__scopeId","data-v-679123b1"]]);const lt={class:"customer-body"},rt={class:"header"},ot={class:"conatiner"},it=["onClick"],ut={class:"name"},st=g("确 定");var dt=e(a({props:{userInfo:{type:Object,default:()=>({})},relationCode:{type:String,default:"1"},title:{type:String,default:"选择投保人"},data:{type:Array,default:()=>[]}},emits:["change"],setup(e,{emit:a}){const t=e,n=F({loading:!1,select:{},list:[]});l((()=>t.data),(e=>{n.list=t.data}),{deep:!0,immediate:!0}),l([()=>t.userInfo,()=>n.loading],(()=>{n.select={...t.userInfo}}),{deep:!0,immediate:!0});const r=()=>{n.loading=!1,a("change",n.select)},o=()=>{n.select={},n.loading=!1},i=()=>{n.loading=!1,n.loading=!0};return(a,t)=>{const l=u("ProSvg"),s=u("van-icon"),O=u("VanButton"),h=u("ProPopup");return d(),c(m,null,[P(l,{name:"customer",onClick:i}),P(h,{class:"customer-list",style:{height:"416px"},show:p(n).loading,closeable:!1,onClose:o},{default:L((()=>[v("div",lt,[v("div",rt,[v("span",null,I(e.title),1),P(s,{name:p("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUCAYAAAAcaxDBAAAAAXNSR0IArs4c6QAAAuRJREFUeF7t3DtOI0EQBuDfEtImXAdyNoIEAffYkIALrFZaMu4BiAQiyOE6myARoJI8kteyx/3469FWTTxT3fVNdY/dY/cCeVAFFtRoGQwJSi6CBE1QsgA5XFZogpIFyOGyQhOULEAOlxWaoGQBcris0CCglwB+ATgEcA/gFsAXuW/W4Q4AXAOQ3P4BuAPwUNuJlgqVBgVx9XheduSztgNBzv+xxDtb689VLWoL6CuAkw0Qo6Juw5QU3wD8rLnpLaDvAI62NDIa6hympPgB4Fgb9AbA75lGRkHdhSkpSq5/tEFl8n4CsD7fjDSnlmBKYZzXPmxbhrzAlXZIHmDRHlSqfW8FHRVVFVNQekBHQ1XHZICOgmqCyQKNjmqGyQSNimqKyQaNhmqOqQEaBdUFUwvUG9UNUxPUC9UVUxvUGtUd0wLUCjUEphWoNmoYTEtQLdRQmNagbNRwmB6gLNSQmF6gvahhMT1BW1FDY3qD1qLK+fKePPSrl94FZkmy9yipupdlI6czjYV4ORgBtLRS525cCMwIQ34VqaRSN6GGwYwG2lKpoTAjgk6ojwDm5ks5T+bVi2ivqaPMoetDP0F7H/XL62vn0RzyM/C1mFOoUKhRhnwrZjjUCKAlmPnBvnBOLcGchnR+9dyBWoM5/YKv5ZrCe8s5zWvI98D0XMtRm4niAcoAYcRQwbUGZUIwY9FwLUE1ADRiduFagWomrhm7GtcC1CJhizaKcLVBLRO1bGsrriaoR4Iebf6HqwXqmZhn293/AtlU+q4JVSwDqqxSsSs0AuZ0k136wgR1SUBhvaDoab7tJBZoREyXSmWARsY0R+0FHQHTFLUHdCRMM9RW0BExTVBbQHMDAvICc26RQQbNTVzIoLnNEBk0N8Iig0q41a3a5Gfaf2t3j+n6fqdzsdtWbTrp7EnUlo9Ne5K6ThoJSnZN0AQlC5DDZYUmKFmAHC4rNEHJAuRwWaEJShYgh8sKJYN+A6+yQmSPqqjtAAAAAElFTkSuQmCC"),onClick:t[0]||(t[0]=e=>p(n).loading=!1)},null,8,["name"])]),v("div",ot,[(d(!0),c(m,null,f(p(n).list,((e,a)=>{var t,l;return d(),c("div",{key:`${e.customerId}_${a}`,class:y({item:!0,active:p(n).select.certNo===(null==(t=e.cert[0])?void 0:t.certNo)}),onClick:a=>(e=>{n.select.name=e.cert[0].certName,n.select.certNo=e.cert[0].certNo,n.select.mobile=e.contact[0].contactNo})(e)},[v("span",ut,I(e.cert[0].certName),1),v("span",null,I(p(H)(e.cert[0].certNo)),1),k(P(s,{class:"check-icon",name:p("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAn9JREFUSEvtlktIVFEcxn/XXpM6Mz5zVBzR8oFUVARRUljhItKNhZC0qVYhZjMMFIG0aFUUtijKB0GEBL02WmZqRjlbFyWSYQ+EynKyh5baNHPi3hsNtzuj89Bp44G7Oec732/u//y/c0cSQgj+w5AWwNGqevRK/eMLXD0AAx2wu47ogD8OwcVyGHmuFnSJIQrgwR5o2Avfx3ynuL5insFPmuB6NXjcPmjhDqhunSew1wO3HNB9Xtur+SVQ0wZL4+YBPPkVmvdBf7sWmrcVau7Bsnhlfm6ba/SV2kTvB7TQlcVwpB0Mxr/zkvj8VigtvqYMjKnhx/jFY2jYAxMurUfuZqi9DwaTZl4SdQWCD4NgssChFpAPP9ThvAIth8HzU7szZxPUdsBys85REsetgrFhdUGKUcKtPDGLZsfLTXTnGHSe02uzN8LRTohN8OsjiSGnoH4nuKd8goLt6tub0wPDp8ahuQqetek11g1g64LYxID71ebquw2NlSC8PqExDQ5eg6JS/WbXG7WJ3vXr17LWga0b4pJmrJivq+XM3bBpxXLpd52A8pMQs1hdG+qFyxUwPqo3zlwL9m6IT5n1mLRxummDrn9CL1vkbYP9jSpUvol+TeuNM1aD/WHQydCCvV5oqkQpfSgjvUiFmtKC3qW/QNyTUF8KL53BmVgKwd4DZktw+j8q/zfXxCc4U4yS75nGinxwyNCMkKBKcgP+53K9htNb4NuIf9PUVeB4BAmZIUNnBsurw31wtgSmx7XmKbkqNDErLOjsYFkx8AAulPm+qck5KjTJGjY0OLCsetoKd0+p+ay6BMnZEUGDB0eM0RvM7fc4hB+4AA6hWJFJfwMaXAhFHVsobQAAAABJRU5ErkJggg==")},null,8,["name"]),[[B,p(n).select.certNo===(null==(l=e.cert[0])?void 0:l.certNo)]])],10,it)})),128))]),P(O,{type:"primary",round:"",block:"",class:"linear-btn",onClick:r},{default:L((()=>[st])),_:1})])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-3de8b298"]]);const ct=e=>(S("data-v-7c6f011e"),e=e(),b(),e),vt={class:"page-internet-product-detail"},mt={class:"info"},pt={class:"custom-page-form"},ft=ct((()=>v("div",{class:"form-title"},"请填写投保信息",-1))),yt={key:2,class:"footer-area"},It={class:"price"},Ot={key:0},ht=g(I("立即投保")),gt=ct((()=>v("div",{id:"xinaoDialog"},null,-1)));var Pt=e(a({setup(e){var a,t;const o=ge();_();const s=j(),{productCode:f="",tenantId:y,agentCode:g="",agencyCode:C,saleChannelId:V,extraInfo:k,insurerCode:S,preview:b}=s.query;let D={};try{D=JSON.parse(decodeURIComponent(k))}catch(pa){}const{openId:w}=D,N=n(),x=n(),F=n(),T=n(!1),R=n(),E=n(),H=n(!1),B=n(!1),le=n(0),re=n(!1),oe=n({}),ue=n({}),Pe=n(!0),be=n(!0),Ae=n(""),qe=n(),Te=n(),Re=n(""),Ee=n(""),Ue=n("");w&&fe({openId:w},(e=>{ue.value=e}));const He="jumpToPage",Be=n({tenantId:y,agencyId:C,agentCode:g,orderCategory:1,saleChannelId:V,venderCode:S,productCode:f,insuranceStartDate:null,insuranceEndDate:null,activePlanCode:"",paymentFrequency:"",premium:0,insurancePeriodValue:ve.YEAR_1,commencementTime:"",tenantOrderHolder:{extInfo:{hasSocialInsurance:se.HAS}},tenantOrderInsuredList:[{dontFetchDefaultInfo:!1,relationToHolder:de.SELF,extInfo:{hasSocialInsurance:se.HAS},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{tenantId:y,productCode:(null==(a=R.value)?void 0:a.productCode)||"",planCode:"",productName:(null==(t=R.value)?void 0:t.productName)||"",premium:qe.value||0,tenantOrderRiskList:[]}]}],extInfo:{buttonCode:"EVENT_SHORT_saveOrder",pageCode:"productInfo",extraInfo:D,templateId:(null==D?void 0:D.templateId)||"1",iseeBizNo:""},operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),_e=r((()=>!!b)),je=r((()=>{var e,a,t,n,l,r;return!!R.value&&!!((null==(a=null==(e=R.value)?void 0:e.tenantProductInsureVO)?void 0:a.planList)&&Array.isArray(null==(n=null==(t=R.value)?void 0:t.tenantProductInsureVO)?void 0:n.planList)&&(null==(r=null==(l=R.value)?void 0:l.tenantProductInsureVO)?void 0:r.planList.length)>0)})),Me=r((()=>{if(ue.value){const e=[];return Object.keys(ue.value).forEach((a=>{e.push(...ue.value[a])})),e}return[]})),Ye=r((()=>Me.value.length>0)),Qe=r((()=>{var e,a,t;let n={};if((null==(e=E.value)?void 0:e.productFactor)?n=null==(a=E.value)?void 0:a.productFactor:Be.value.activePlanCode&&(n=(null==(t=E.value)?void 0:t.planFactor[Be.value.activePlanCode])||{}),Ye.value&&n[1]){const e=n[1].findIndex((e=>"verificationCode"===e.code&&1===e.isDisplay));e>-1&&(n[1][e].isDisplay=2)}return n})),Ge=r((()=>{if(Qe.value[1]){if(Qe.value[1].findIndex((e=>"verificationCode"===e.code&&1===e.isDisplay))>-1)return!0}return!1}));l((()=>je.value),(()=>{var e,a;je.value&&(Be.value.activePlanCode=Be.value.activePlanCode?Be.value.activePlanCode:null==(a=null==(e=R.value)?void 0:e.tenantProductInsureVO)?void 0:a.planList[0].planCode)}),{immediate:!0});const ze=r((()=>{var e,a,t;return je.value?(null==(a=null==(e=E.value)?void 0:e.productRelationPlanVOList.find((e=>e.planCode===Be.value.activePlanCode)))?void 0:a.productRiskVoList)||[]:(null==(t=E.value)?void 0:t.productRiskVoList)||[]})),$e=r((()=>{var e;if(!R.value)return{};if(je.value){const a=null==(e=R.value)?void 0:e.tenantProductInsureVO.planList.find((e=>e.planCode===Be.value.activePlanCode));return a||{}}return R.value.tenantProductInsureVO.planInsureVO})),We=e=>{Be.value.activePlanCode=e},Xe=r((()=>{var e,a,t;if((null==(e=E.value)?void 0:e.productQuestionnaireVOList)&&(null==(a=E.value)?void 0:a.productQuestionnaireVOList.length)>0){const e=null==(t=E.value)?void 0:t.productQuestionnaireVOList[0];if(e){const{basicInfo:{questionnaireType:a},questions:t}=e.questionnaireDetailResponseVO||{};return"2"===String(a)?[{attachmentName:null==e?void 0:e.questionnaireName,attachmentUri:t,attachmentType:"question"}]:[{attachmentName:null==e?void 0:e.questionnaireName,attachmentUri:t[0].content,attachmentType:Ce(String(t[0].textType),t[0].content)}]}}return[]})),Je=n();l([()=>je.value,()=>Be.value.activePlanCode,()=>R.value],(()=>{var e,a;let t=null;if(je.value&&R.value){const a=null==(e=R.value)?void 0:e.tenantProductInsureVO.planList.find((e=>e.planCode===(Be.value.activePlanCode||"")));a&&(t=null==a?void 0:a.attachmentVOList)}else R.value&&(t=null==(a=R.value)?void 0:a.tenantProductInsureVO.planInsureVO.attachmentVOList);Je.value=t?Object.keys(t).map((e=>(t[e].forEach((e=>{e.attachmentType=Ce(String(e.attachmentType),e.attachmentUri)})),{attachmentName:e,attachmentList:t[e]}))):[]}),{immediate:!0});const Ze=async({mobile:e,type:a},t)=>{var n;if(N.value){if(_e.value)return void(null==t||t());null==(n=N.value)||n.validateForm(`${a}_mobile`).then((async()=>{const a=await Ne(e),{code:n,data:l}=a;"10000"===n&&(null==t||t())}))}},ea=()=>{x.value.handleClickTab()("tab3")},aa=e=>{be.value=!1,Object.assign(Be.value.tenantOrderHolder,e),i((()=>{be.value=!0}))},ta=e=>{be.value=!1,Object.assign(Be.value.tenantOrderInsuredList[0],e),i((()=>{be.value=!0}))},na=e=>{le.value=e,B.value=!0},ra=async()=>{try{await ne(((e={},a={},t={})=>{var n;const l={...t},r={tenantId:y,riskList:(null==(n=l.tenantOrderInsuredList[0])?void 0:n.tenantOrderProductList[0].riskVOList)||[],riskPremium:a,productId:null==e?void 0:e.productBasicInfoVO.id};return l.extInfo.iseeBizNo=Ae.value,l.productCode=e.productBasicInfoVO.productCode,l.commencementTime=l.insuranceStartDate,l.expiryDate=l.insuranceEndDate,l.paymentFrequency=l.paymentFrequency||ie.SINGLE,l.tenantOrderHolder={...l.tenantOrderHolder,socialFlag:l.tenantOrderHolder.extInfo.hasSocialInsurance||se.HAS,certType:l.tenantOrderHolder.certType||q.CERT,extInfo:{...l.tenantOrderHolder.extInfo,hasSocialInsurance:l.tenantOrderHolder.extInfo.hasSocialInsurance||se.HAS}},l.tenantOrderInsuredList=l.tenantOrderInsuredList.map((e=>({...e,certType:e.certType||q.CERT,socialFlag:e.socialFlag||se.HAS,planCode:Be.value.activePlanCode?Be.value.activePlanCode:null}))),l.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:qe.value,productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,planCode:Be.value.activePlanCode?Be.value.activePlanCode:null,tenantOrderRiskList:ke(r)},l})(E.value,oe.value,Be.value),(async(e,a)=>{a===He&&(null==e?void 0:e.orderNo)&&await(async e=>{try{const{code:a,data:t}=await ee({orderNo:e,tenantId:y});"10000"===a&&(t.extInfo={...t.extInfo,buttonCode:"EVENT_SHORT_underWrite"},await ne(t))}catch(pa){}})(null==e?void 0:e.orderNo)}))}catch(pa){}},oa=async(e,a,t,n=!0)=>{var l;try{Ue.value="保费试算中...";const r=Le(t).map((a=>({...a,paymentFrequency:e.paymentFrequency||ie.SINGLE,insurancePeriodValue:e.insurancePeriodValue,coveragePeriod:e.insurancePeriodValue}))),o={tenantId:y,productCode:null==(l=R.value)?void 0:l.productCode,insuranceStartDate:e.insuranceStartDate,insuranceEndDate:e.insuranceEndDate,commencementTime:e.insuranceStartDate,expiryDate:e.insuranceEndDate,paymentFrequency:e.paymentFrequency||ie.SINGLE,holder:{personVO:{...e.tenantOrderHolder,socialFlag:e.tenantOrderHolder.extInfo.hasSocialInsurance||se.HAS,certType:e.tenantOrderHolder.certType||q.CERT,extInfo:{...e.tenantOrderHolder.extInfo,hasSocialInsurance:e.tenantOrderHolder.extInfo.hasSocialInsurance||se.HAS}}},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",relationToHolder:e.relationToHolder,personVO:{...e,socialFlag:e.extInfo.hasSocialInsurance||se.HAS,certType:e.certType||q.CERT,extInfo:{...e.extInfo,hasSocialInsurance:e.extInfo.hasSocialInsurance||se.HAS}},productPlanVOList:[{insurerCode:a.productBasicInfoVO.insurerCode,planCode:Be.value.activePlanCode?Be.value.activePlanCode:null,riskVOList:r}]})))},{code:i,message:u}=await J(o);if("10000"===i){const{code:e,data:a}=await Z(o);if("10000"===e){if(Ue.value="",Be.value.tenantOrderInsuredList[0].tenantOrderProductList=o.insuredVOList[0].productPlanVOList,qe.value=null==a?void 0:a.premium,Be.value.premium=a.premium,Be.value.orderAmount=a.premium,Be.value.orderRealAmount=a.premium,!n){const e={};a.riskPremiumDetailVOList&&a.riskPremiumDetailVOList.length&&a.riskPremiumDetailVOList.forEach((a=>{e[a.riskCode]={premium:a.premium,amount:a.amount}})),oe.value=e,Je.value.length>0?(Pe.value=!1,na(0)):Xe.value.length>0?H.value=!0:await ra()}}else Ue.value=""}else Ue.value="",U(u)}catch(pa){Ue.value=""}},ia=async()=>{var e;try{H.value=!1,B.value=!1,N.value&&(null==(e=N.value)||e.validateForm().then((async()=>{var e;if(Ye.value||!Ge.value)await oa(Be.value,E.value,ze.value,!1);else{const a=null==(e=Be.value.tenantOrderHolder)?void 0:e.verificationCode;if(!a||!Ve(a))return void U({message:"请输入正确的验证码"});const{code:t,data:n}=await xe(Be.value.tenantOrderHolder.mobile,a);"10000"===t&&await oa(Be.value,E.value,ze.value,!1)}})))}catch(a){}},ua=e=>{"allFalse"===e?(H.value=!1,ra()):$.confirm({className:"xinao-custom-dialog",title:"提示",teleport:"#xinaoDialog",message:"被保人不符合健康要求，很抱歉暂时无法投保该产品",confirmButtonText:"选错了",cancelButtonText:"为其他人投保"}).then((()=>{})).catch((()=>{H.value=!1}))},sa=()=>{B.value=!1,Xe.value.length<1?ra():H.value=!0},da=()=>{H.value=!1,B.value=!1};l((()=>Be.value.tenantOrderInsuredList[0].relationToHolder),(()=>{i((()=>{Be.value.tenantOrderInsuredList[0]&&Be.value.tenantOrderInsuredList[0].extInfo&&!Be.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance&&(Be.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance=se.HAS)}))}),{deep:!0,immediate:!0});const ca=()=>{const{name:e,birthday:a,gender:t,certType:n,extInfo:{hasSocialInsurance:l}}=Be.value.tenantOrderInsuredList[0];return!!(a&&t&&Be.value.paymentFrequency&&e&&Se(e)&&l)},ma=()=>{if(ca()&&(Ue.value="保费试算中..."),$e.value&&$e.value.productPremiumVOList){const e=$e.value.productPremiumVOList.find((e=>e.paymentFrequency===Be.value.paymentFrequency));e&&(qe.value=null,Te.value=e.paymentFrequencyValue?Number(e.paymentFrequencyValue):null,Re.value=e.premiumUnit,Ee.value=e.actualPremiumUnit)}};l([()=>$e.value,()=>Be.value.activePlanCode,()=>Be.value.paymentFrequency],(()=>{ma()}),{deep:!0,immediate:!0}),l([()=>Be.value.tenantOrderInsuredList[0].birthday,()=>Be.value.tenantOrderInsuredList[0].name,()=>Be.value.tenantOrderInsuredList[0].gender,()=>Be.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance,()=>Be.value.activePlanCode,()=>Be.value.paymentFrequency,()=>Be.value.insurancePeriodValue],W((()=>{if(ca()){if(_e.value)return;oa(Be.value,E.value,ze.value)}else ma()}),500)),l((()=>Be.value.tenantOrderInsuredList[0]),(e=>{if(M(ue.value))return null;const a=ue.value[e.relationToHolder]||[];return 1===a.length&&(me.SELF!==e.relationToHolder?Be.value.tenantOrderInsuredList[0].dontFetchDefaultInfo||(Be.value.tenantOrderInsuredList[0].dontFetchDefaultInfo=!0,Be.value.tenantOrderInsuredList[0].certNo=Be.value.tenantOrderInsuredList[0].certNo?Be.value.tenantOrderInsuredList[0].certNo:a[0].cert[0].certNo,Be.value.tenantOrderInsuredList[0].name=Be.value.tenantOrderInsuredList[0].name?Be.value.tenantOrderInsuredList[0].name:a[0].cert[0].certName,Be.value.tenantOrderInsuredList[0].mobile=Be.value.tenantOrderInsuredList[0].mobile?Be.value.tenantOrderInsuredList[0].mobile:a[0].contact[0].contactNo):Be.value.tenantOrderHolder.dontFetchDefaultInfo||(Be.value.tenantOrderHolder.dontFetchDefaultInfo=!0,Be.value.tenantOrderHolder.certNo=Be.value.tenantOrderHolder.certNo?Be.value.tenantOrderHolder.certNo:a[0].cert[0].certNo,Be.value.tenantOrderHolder.name=Be.value.tenantOrderHolder.name?Be.value.tenantOrderHolder.name:a[0].cert[0].certName,Be.value.tenantOrderHolder.mobile=Be.value.tenantOrderHolder.mobile?Be.value.tenantOrderHolder.mobile:a[0].contact[0].contactNo)),!1}),{immediate:!0,deep:!0});return i((()=>{Y(F,(([{isIntersecting:e}],a)=>{T.value=!e}))})),pe(),Q((()=>{var e;const a=Fe.get(ce);if(a){const{tenantOrderHolder:t,tenantOrderInsuredList:n}=a;if(t&&(Be.value.tenantOrderHolder={...t,certType:t.certType||q.CERT}),Array(n)&&n[0]){const a=n[0]||{};if(Be.value.activePlanCode=a.planCode,a.tenantOrderProductListtenantOrderProductList&&a.tenantOrderProductList[0]&&a.tenantOrderProductList[0].tenantOrderRiskList){const t=null==(e=a.tenantOrderProductList[0].tenantOrderRiskList)?void 0:e.find((e=>"1"===String(e.riskType)));t&&(Be.value.paymentFrequency=(null==t?void 0:t.paymentFrequency)?String(null==t?void 0:t.paymentFrequency):ie.SINGLE)}}}})),G((()=>{(async()=>{await ae({productCode:f,withInsureInfo:!0,tenantId:y}).then((e=>{var a,t;"10000"===e.code&&(R.value={...e.data},document.title=(null==(t=null==(a=e.data)?void 0:a.tenantProductInsureVO)?void 0:t.productName)||"")})),await X({productCode:f}).then((e=>{"10000"===e.code&&(re.value=!0,E.value=e.data)}))})(),setTimeout((async()=>{Ae.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),K((()=>{Fe.remove(ce)})),(e,a)=>{const t=u("van-config-provider");return d(),c(m,null,[P(t,{"theme-vars":p(o)},{default:L((()=>{var e,t,n,l,r,i,u,s,f;return[v("div",vt,[v("div",mt,[P(ye,{url:null==(t=null==(e=R.value)?void 0:e.tenantProductInsureVO)?void 0:t.banner[0]},null,8,["url"]),(null==(l=null==(n=R.value)?void 0:n.tenantProductInsureVO)?void 0:l.bannerMove)?(d(),h(ye,{key:0,url:null==(i=null==(r=R.value)?void 0:r.tenantProductInsureVO)?void 0:i.bannerMove[0],onClick:ea},null,8,["url"])):O("",!0),v("div",{ref_key:"observeRef",ref:F},null,512)]),P(Ke,{"show-service-config":"","data-source":null==(u=R.value)?void 0:u.tenantProductInsureVO,"is-multiple-plan":p(je),"active-plan-code":Be.value.activePlanCode,"payment-frequency":Be.value.paymentFrequency,"premium-info":{premium:qe.value,unit:Re.value,premiumLoadingText:Ue.value},onUpdateActivePlan:We},null,8,["data-source","is-multiple-plan","active-plan-code","payment-frequency","premium-info"]),P(la,{ref_key:"detailScrollRef",ref:x,detail:R.value},{form:L((()=>[v("div",pt,[ft,P(te,{ref_key:"formRef",ref:N,"title-collection":{HOLDER:"本人信息（投保人）",INSURER:"为谁投保（被保人）"},"form-info":Be.value,"need-desensitize":be.value,"send-sms-code":Ze,"factor-object":p(Qe)||{}},A({_:2},[p(Me).length>1?{name:"holderName",fn:L((()=>[P(dt,{"user-info":Be.value.tenantOrderHolder,data:p(Me),onChange:aa},null,8,["user-info","data"])]))}:void 0,p(Me).length>1?{name:"insurerName",fn:L((()=>[P(dt,{title:"选择被保人","user-info":Be.value.tenantOrderInsuredList[0],data:p(Me),onChange:ta},null,8,["user-info","data"])]))}:void 0]),1032,["form-info","need-desensitize","factor-object"])]),P(nt,{"form-info":Be.value,"insure-detail":E.value,"config-detail":R.value,"is-multiple-plan":p(je),"premium-info":{premium:qe.value,unit:Re.value,minPremiun:Te.value,actualUnit:Ee.value,premiumLoadingText:Ue.value},onUpdateActivePlan:We},null,8,["form-info","insure-detail","config-detail","is-multiple-plan","premium-info"])])),_:1},8,["detail"]),(null==(s=R.value)?void 0:s.tenantProductInsureVO.inscribedContent)?(d(),h(Ie,{key:0,"inscribed-content":null==(f=R.value)?void 0:f.tenantProductInsureVO.inscribedContent},null,8,["inscribed-content"])):O("",!0),Je.value&&Je.value.length>0?(d(),h(Oe,{key:1,"attachement-list":Je.value,"pre-text":"请阅读",onPreviewFile:a[0]||(a[0]=e=>na(e))},null,8,["attachement-list"])):O("",!0),T.value?(d(),c("div",yt,[v("div",It,[Ue.value?(d(),c("span",Ot,I(Ue.value),1)):qe.value?(d(),c(m,{key:1},[v("span",null,I(p(z)(qe.value)),1),v("span",null,I(Ee.value||"元"),1)],64)):(d(),c(m,{key:2},[v("span",null,I(Te.value),1),v("span",null,I(Re.value),1)],64))]),P(we,{disabled:p(_e),shadow:!1,"theme-vars":p(o),class:"right",text:"立即投保",onClick:ia},{default:L((()=>[ht])),_:1},8,["disabled","theme-vars"])])):O("",!0)]),re.value?(d(),h(he,{key:0,"product-detail":R.value},null,8,["product-detail"])):O("",!0),gt]})),_:1},8,["theme-vars"]),P(va,{show:H.value,"onUpdate:show":a[1]||(a[1]=e=>H.value=e),"content-list":p(Xe),"active-index":0,onOnConfirmHealth:ua,onOnCloseHealthByMask:da},null,8,["show","content-list"]),B.value?(d(),h(De,{key:0,show:B.value,"onUpdate:show":a[2]||(a[2]=e=>B.value=e),"content-list":Je.value,"is-only-view":Pe.value,"active-index":le.value,text:Pe.value?"关闭":"我已逐页阅读并确认告知内容","force-read-cound":0,"on-close-file-preview":"",onSubmit:sa,onOnCloseFilePreviewByMask:da},null,8,["show","content-list","is-only-view","active-index","text"])):O("",!0)],64)}}}),[["__scopeId","data-v-7c6f011e"]]);export{Pt as default};
