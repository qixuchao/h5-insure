import{B as t,d as e,j as s,D as o,C as i,Y as a,k as n,b_ as l,G as r,l as c,E as d,V as f,b as u,cv as p,R as h,J as g,cw as v,X as m,N as x,W as y,M as k,cx as C,cy as b,K as w,r as T,a6 as $,a2 as z,$ as I,cz as O,O as S,cA as W,H as P,cn as A,a1 as R}from"./index-a2b9e947.js";const[B,L]=t("index-bar"),j={sticky:h,zIndex:g,teleport:[String,Object],highlightColor:String,stickyOffsetTop:v(0),indexList:{type:Array,default:function(){const t="A".charCodeAt(0);return Array(26).fill("").map(((e,s)=>String.fromCharCode(t+s)))}}},E=Symbol(B);var H=e({name:B,props:j,emits:["select","change"],setup(t,{emit:e,slots:h}){const g=s(),v=s(),T=s(""),$=o(),z=i(g),{children:I,linkChildren:O}=a(E);let S;O({props:t});const W=n((()=>{if(l(t.zIndex))return{zIndex:+t.zIndex+1}})),P=n((()=>{if(t.highlightColor)return{color:t.highlightColor}})),A=(e,s)=>{for(let o=I.length-1;o>=0;o--){const i=o>0?s[o-1].height:0;if(e+(t.sticky?i+t.stickyOffsetTop:0)>=s[o].top)return o}return-1},R=t=>I.find((e=>String(e.index)===t)),B=()=>{if(m(g))return;const{sticky:e,indexList:s}=t,o=x(z.value),i=y(z),a=I.map((t=>t.getRect(z.value,i)));let n=-1;if(S){const t=R(S);if(t){const e=t.getRect(z.value,i);n=A(e.top,a)}}else n=A(o,a);T.value=s[n],e&&I.forEach(((e,s)=>{const{state:l,$el:r}=e;if(s===n||s===n-1){const t=r.getBoundingClientRect();l.left=t.left,l.width=t.width}else l.left=null,l.width=null;if(s===n)l.active=!0,l.top=Math.max(t.stickyOffsetTop,a[s].top-o)+i.top;else if(s===n-1&&""===S){const t=a[n].top-o;l.active=t>0,l.top=t+i.top-a[s].height}else l.active=!1})),S=""},j=()=>{k(B)};r("scroll",B,{target:z,passive:!0}),c(j),d((()=>t.indexList),j),d(T,(t=>{t&&e("change",t)}));const H=s=>{S=String(s);const o=R(S);if(o){const s=x(z.value),i=y(z),{offsetHeight:a}=document.documentElement;if(o.$el.scrollIntoView(),s===a-i.height)return void B();t.sticky&&t.stickyOffsetTop&&C(b()-t.stickyOffsetTop),e("select",o.index)}},M=t=>{const{index:e}=t.dataset;e&&H(e)},V=t=>{M(t.target)};let X;const D=()=>u("div",{ref:v,class:L("sidebar"),style:W.value,onClick:V,onTouchstartPassive:$.start},[t.indexList.map((t=>{const e=t===T.value;return u("span",{class:L("index",{active:e}),style:e?P.value:void 0,"data-index":t},[t])}))]);return f({scrollTo:H}),r("touchmove",(t=>{if($.move(t),$.isVertical()){w(t);const{clientX:e,clientY:s}=t.touches[0],o=document.elementFromPoint(e,s);if(o){const{index:t}=o.dataset;t&&X!==t&&(X=t,M(o))}}}),{target:v}),()=>{var e;return u("div",{ref:g,class:L()},[t.teleport?u(p,{to:t.teleport},{default:()=>[D()]}):D(),null==(e=h.default)?void 0:e.call(h)])}}});const[M,V]=t("index-anchor");const X=S(e({name:M,props:{index:g},setup(t,{slots:e}){const o=T({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),i=s(),{parent:a}=$(E);if(!a)return;const l=()=>o.active&&a.props.sticky,r=n((()=>{const{zIndex:t,highlightColor:e}=a.props;if(l())return z(I(t),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:e})}));return f({state:o,getRect:(t,e)=>{const s=y(i);return o.rect.height=s.height,t===window||t===document.body?o.rect.top=s.top+b():o.rect.top=s.top+x(t)-e.top,o.rect}}),()=>{const s=l();return u("div",{ref:i,style:{height:s?`${o.rect.height}px`:void 0}},[u("div",{style:r.value,class:[V({sticky:s}),{[O]:s}]},[e.default?e.default():t.index])])}}})),D=S(H),[F,N]=t("swipe-cell");const Y=S(e({name:F,props:{name:P(""),disabled:Boolean,leftWidth:g,rightWidth:g,beforeClose:Function,stopPropagation:Boolean},emits:["open","close","click"],setup(t,{emit:e,slots:i}){let a,c,d;const p=s(),h=s(),g=s(),v=T({offset:0,dragging:!1}),m=o(),x=t=>t.value?y(t).width:0,k=n((()=>l(t.leftWidth)?+t.leftWidth:x(h))),C=n((()=>l(t.rightWidth)?+t.rightWidth:x(g))),b=s=>{v.offset="left"===s?k.value:-C.value,a||(a=!0,e("open",{name:t.name,position:s}))},$=s=>{v.offset=0,a&&(a=!1,e("close",{name:t.name,position:s}))},z=e=>{t.disabled||(d=v.offset,m.start(e))},I=()=>{v.dragging&&(v.dragging=!1,(t=>{const e=Math.abs(v.offset),s=a?.85:.15,o="left"===t?k.value:C.value;o&&e>o*s?b(t):$(t)})(v.offset>0?"left":"right"),setTimeout((()=>{c=!1}),0))},O=(s="outside")=>{e("click",s),a&&!c&&R(t.beforeClose,{args:[{name:t.name,position:s}],done:()=>$(s)})},S=(t,e)=>s=>{e&&s.stopPropagation(),O(t)},P=(t,e)=>{const s=i[t];if(s)return u("div",{ref:e,class:N(t),onClick:S(t,!0)},[s()])};return f({open:b,close:$}),W(p,(()=>O("outside")),{eventName:"touchstart"}),r("touchmove",(e=>{if(t.disabled)return;const{deltaX:s}=m;if(m.move(e),m.isHorizontal()){c=!0,v.dragging=!0;(!a||s.value*d<0)&&w(e,t.stopPropagation),v.offset=A(s.value+d,-C.value,k.value)}}),{target:p}),()=>{var t;const e={transform:`translate3d(${v.offset}px, 0, 0)`,transitionDuration:v.dragging?"0s":".6s"};return u("div",{ref:p,class:N(),onClick:S("cell",c),onTouchstartPassive:z,onTouchend:I,onTouchcancel:I},[u("div",{class:N("wrapper"),style:e},[P("left",h),null==(t=i.default)?void 0:t.call(i),P("right",g)])])}}}));export{X as I,Y as S,D as a};
