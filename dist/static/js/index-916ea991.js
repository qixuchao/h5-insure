import{reactive as e,ref as a,toRefs as t,computed as o}from"vue";import{_ as r,aI as u,a as l,R as n,D as i,T as s}from"./index-deb4ddfb.js";/* empty css              */import{P as d}from"./index-0c1a061b.js";import{_ as c}from"./empty-ae586b6c.js";import{P as V}from"./index-537a5f71.js";import{d as p,h as m}from"./proposalList-f0d28251.js";import{a as v,b as f,t as h}from"./format-b5e9d8b9.js";import"./pdfh5-e588f83d.js";const x={class:"proposal-content"},y={class:"title"},g={class:"premium"},N={class:"operate-btn"};var C=r(Vue.defineComponent({__name:"index",setup(r){const C=u(),k=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:e=>v(null==e?void 0:e.coveragePeriod)},{title:"交费期间",dataIndex:"chargePeriod",width:110,render:e=>f(null==e?void 0:e.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:e=>h(null==e?void 0:e.initialPremium)}],b=e({historyList:[],searchValue:""}),P=a(!1),_=a(!1),w=a(1),{historyList:j,searchValue:B}=t(b),E=l(),I=()=>{m({name:B.value,pageNum:w.value,pageSize:20,relationUserType:2}).then((e=>{const{code:a,data:t}=e;"10000"===a&&(1===w.value?j.value=t.datas||[]:j.value=j.value.concat(t.datas),P.value=!1,w.value+=1,_.value=j.value.length>=t.total)}))},L=()=>{I()},T=o((()=>j.value.length>0)),R=e=>{B.value=e,w.value=1,I()};return(e,a)=>{const t=Vue.resolveComponent("van-search"),o=Vue.resolveComponent("van-button"),r=Vue.resolveComponent("van-list"),u=Vue.resolveComponent("ProPageWrap"),l=Vue.resolveComponent("van-config-provider");return Vue.openBlock(),Vue.createBlock(l,{"theme-vars":Vue.unref(C)},{default:Vue.withCtx((()=>[Vue.createVNode(u,{class:"page-history-proposal"},{default:Vue.withCtx((()=>[Vue.createVNode(t,{modelValue:Vue.unref(B),"onUpdate:modelValue":a[0]||(a[0]=e=>Vue.isRef(B)?B.value=e:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:R},null,8,["modelValue"]),Vue.createElementVNode("div",x,[Vue.createVNode(r,{loading:Vue.unref(P),"onUpdate:loading":a[1]||(a[1]=e=>Vue.isRef(P)?P.value=e:null),finished:Vue.unref(_),"finished-text":Vue.unref(T)?"- 没有更多了 -":"",onLoad:L},{default:Vue.withCtx((()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(Vue.unref(j),(e=>(Vue.openBlock(),Vue.createElementBlock("div",{key:e.id,class:"proposal-item"},[Vue.createElementVNode("div",y,Vue.toDisplayString(e.proposalName),1),Vue.createElementVNode("p",g,[Vue.createTextVNode(" 保费："),Vue.createElementVNode("span",null,"¥"+Vue.toDisplayString(Vue.unref(n)(e.totalPremium)),1)]),Vue.createVNode(V,{columns:k,class:"table","data-source":e.proposalProductRiskVOList},null,8,["data-source"]),Vue.createElementVNode("div",N,[Vue.createVNode(o,{plain:"",round:"",type:"primary",class:"del-btn",onClick:a=>{return t=e.id,void i.confirm({message:"是否确定删除计划书？"}).then((()=>{p(t).then((e=>{const{code:a}=e;"10000"===a&&(s.success("删除成功"),w.value=1,I())}))})).catch((()=>{}));var t}},{default:Vue.withCtx((()=>[Vue.createTextVNode("删除")])),_:2},1032,["onClick"]),Vue.createVNode(o,{plain:"",round:"",type:"primary",onClick:a=>{return t=e.id,void E.push({path:"/proposal/createProposal",query:{id:t}});var t}},{default:Vue.withCtx((()=>[Vue.createTextVNode("编辑")])),_:2},1032,["onClick"]),Vue.createVNode(o,{plain:"",round:"",type:"primary",onClick:a=>{return t=e.id,void E.push({path:"compositionProposal",query:{id:t}});var t}},{default:Vue.withCtx((()=>[Vue.createTextVNode("预览")])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),Vue.unref(T)||Vue.unref(P)?Vue.createCommentVNode("",!0):(Vue.openBlock(),Vue.createBlock(d,{key:0,"empty-img":Vue.unref(c),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-3ad77c53"]]);export{C as default};
