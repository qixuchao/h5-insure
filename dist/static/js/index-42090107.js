var le=Object.defineProperty,re=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var ce=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var W=(s,n,u)=>n in s?le(s,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[n]=u,M=(s,n)=>{for(var u in n||(n={}))ce.call(n,u)&&W(s,u,n[u]);if(K)for(var u of K(n))de.call(n,u)&&W(s,u,n[u]);return s},U=(s,n)=>re(s,ie(n));import{g as $,E as m,M as q,_ as me,r as D,j as B,k as A,m as x,p as v,A as o,z as a,J as pe,L as H,T as L,n as z,t as Q,a4 as fe,a5 as ve,O as _e,a9 as he,y as X,h as Fe,G as Ce,F as Be,C as R}from"./vendor-06835924.js";import{R as De}from"./infoCollection-b0426750.js";import{s as be,c as ge}from"./phoneVerify-e83a8d28.js";import{v as Y,a as Ee,b as ye}from"./validator-ebd71d12.js";import{F as T,g as Ie}from"./utils-83f109f3.js";import{G as we,_ as ke}from"./index-34b5a724.js";import{g as Ne,m as Ve,i as Ae}from"./trial-237179f5.js";import{p as xe}from"./product-490eafb9.js";import{t as Se}from"./theme-eeb93d73.js";import{c as Oe,_ as Le}from"./index-92e77691.js";import{_ as Pe}from"./index-a2992193.js";import"./trial-fc87d688.js";const Te=$({props:{isCheck:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>{}}},emits:["on-verify"],setup(s,{emit:n}){var N;const u=s,r=m({}),c=m(!1),k=30,p=m(0),b=m("\u83B7\u53D6\u9A8C\u8BC1\u7801"),i=q({mobile:(N=u.userInfo)==null?void 0:N.mobile,smsCode:""}),g=f=>Y(f)?!0:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7",y=()=>{if(p.value>0)return;p.value=k;const f=()=>{b.value=`${p.value}s`,p.value-=1};f();const e=setInterval(()=>{p.value===0?(b.value="\u83B7\u53D6\u9A8C\u8BC1\u7801",p.value=0,clearInterval(e)):f()},1e3)},_=async()=>{p.value>0||r==null||r.value.validate("mobile").then(async()=>{const f=await be(i.mobile),{code:e,data:F}=f;e==="10000"&&(c.value=!0,L({message:"\u77ED\u4FE1\u53D1\u9001\u6210\u529F\uFF0C\u8BF7\u67E5\u6536"}),y())})},I=async()=>{const f=await ge(i.mobile,i.smsCode),{data:e}=f;e&&n("on-verify",i)},h=async()=>{r==null||r.value.validate().then(async()=>{I()})};return me(()=>i,()=>{Y(i.mobile)&&Ee(i.smsCode)&&c.value&&I()},{deep:!0,immediate:!0}),(f,e)=>{const F=D("van-field"),P=D("van-cell-group"),S=D("VanForm");return B(),A(S,{ref_key:"formRef",ref:r,"label-width":"80"},{default:x(()=>[v(P,null,{default:x(()=>[v(F,{modelValue:o(i).mobile,"onUpdate:modelValue":e[0]||(e[0]=V=>o(i).mobile=V),name:"mobile",label:"\u624B\u673A\u53F7",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",maxlength:o(T).MOBILE,rules:[{validator:g}]},null,8,["modelValue","maxlength","rules"]),v(F,{modelValue:o(i).smsCode,"onUpdate:modelValue":e[1]||(e[1]=V=>o(i).smsCode=V),type:"digit",name:"smsCode",label:"\u9A8C\u8BC1\u7801",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",maxlength:o(T).SMS_CODE},{button:x(()=>[a("div",{class:H(["sms-code",{"count-down":p.value>0}]),onClick:_},pe(b.value),3)]),_:1},8,["modelValue","maxlength"])]),_:1}),a("div",{class:H([{"check-submit":u.isCheck},{submit:!u.isCheck}]),onClick:h},null,2)]),_:1},512)}}}),$e=$({props:{isCheck:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>{}}},emits:["on-submit"],setup(s,{emit:n}){const u=s,r=m({}),c=q({name:u.userInfo.name,certNo:u.userInfo.certNo}),k=i=>we(c.certNo)?!0:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u8BC1\u4EF6\u53F7",p=i=>ye(i)?!0:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u59D3\u540D",b=()=>{r==null||r.value.validate().then(async i=>{n("on-submit",c)})};return(i,g)=>{const y=D("van-field"),_=D("van-cell-group"),I=D("VanForm");return B(),A(I,{ref_key:"formRef",ref:r,"label-width":"80"},{default:x(()=>[v(_,null,{default:x(()=>[v(y,{modelValue:o(c).name,"onUpdate:modelValue":g[0]||(g[0]=h=>o(c).name=h),name:"name",label:"\u59D3\u540D",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",maxlength:o(T).NAME,rules:[{validator:p}]},null,8,["modelValue","maxlength","rules"]),v(y,{modelValue:o(c).certNo,"onUpdate:modelValue":g[1]||(g[1]=h=>o(c).certNo=h),name:"certNo",label:"\u8EAB\u4EFD\u8BC1",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",maxlength:o(T).ID_CARD,rules:[{validator:k}]},null,8,["modelValue","maxlength","rules"])]),_:1}),a("div",{class:H([{"check-submit":u.isCheck},{submit:!u.isCheck}]),onClick:b},null,2)]),_:1},512)}}});var Me="/static/assets/title-step1.97cb9efa.png",Ue="/static/assets/title-step2.258af5e9.png";const Z=s=>(fe("data-v-a6bc1804"),s=s(),ve(),s),He={key:0,class:"pro-modal"},ze=Z(()=>a("div",{class:"pro-overlay"},null,-1)),qe={class:"pro-modal-wrapper"},Re=Z(()=>a("div",{class:"pro-modal-content"},[a("p",null,"\u606D\u559C\u60A8"),a("p",null,"\u9886\u53D6\u6210\u529F")],-1)),je=["src"],Ge=$({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(s,{emit:n}){const u=s,r=()=>{n("on-close")};return(c,k)=>u.isShow?(B(),z("div",He,[ze,a("div",qe,[a("div",{class:"pro-modal-body"},[Re,a("div",{class:"pro-modal-btn",onClick:r},"\u6211\u77E5\u9053\u4E86")]),a("div",{class:"pro-modal-close",onClick:r},[a("img",{src:o(Oe)},null,8,je)])])])):Q("",!0)}});var Je=ke(Ge,[["__scopeId","data-v-a6bc1804"]]);const Ke={class:"page-activity-invite"},We=["src"],Xe={class:"container"},Ye={class:"main-form"},Qe={class:"title"},Ze=["src"],et={class:"agree"},tt={class:"check-wrap"},ut=R(" \u6211\u5DF2\u9605\u8BFB\u5E76\u540C\u610F "),ot={key:2,class:"tips"},at=R(" \u4EA7\u54C1\u4ECB\u7ECD\u9875\u9762\u4EC5\u4F9B\u53C2\u8003\uFF0C\u5177\u4F53\u8D23\u4EFB\u63CF\u8FF0\u4EE5\u4FDD\u9669\u5408\u540C\u4E3A\u51C6\uFF0C\u4F17\u5B89\u4FDD\u9669\u6700\u8FD1\u5B63\u5EA6\u507F\u4ED8\u80FD\u529B\u7B26\u5408\u76D1\u7BA1\u8981\u6C42\uFF0C\u8BE6\u60C5\u8BF7\u53C2\u89C1\u4F17\u5B89\u4FDD\u9669\u5B98\u7F51 ("),nt=a("a",{href:"https://www.zhongan.com"},"www.zhongan.com",-1),st=R("\uFF09\u507F\u4ED8\u80FD\u529B\u4FE1\u606F\u62AB\u9732\uFF0C\u8BE5\u4FDD\u9669\u4EA7\u54C1\u7531\u4F17\u5B89\u5728\u7EBF\u8D22\u4EA7\u4FDD\u9669\u80A1\u4EFD\u6709\u9650\u516C\u53F8\u627F\u4FDD\u5E76\u8D1F\u8D23\u7406\u8D54\u3002 "),lt=[at,nt,st],Dt=$({setup(s){const n=_e(),u=he(),{productCode:r="7X9",tenantId:c="",phoneNo:k,saleChannelId:p,agentCode:b="",paymentMethod:i,from:g}=n.query,y=m(!0),_=g==="check",I=m(!1),h=m(!1),N=m(!1),f=m(0),e=q({title:Me,attachmentList:[],userInfo:{mobile:k,certNo:"",name:""},agree:!1}),F=m(),P=m(),S=m(!1);let V="";const ee=X(()=>{var t,l;return((l=(t=F.value)==null?void 0:t.tenantProductInsureVO)==null?void 0:l.attachmentVOList.filter(d=>d.attachmentName==="\u5065\u5EB7\u544A\u77E5"))||[]}),j=X(()=>{var t,l;return((l=(t=F.value)==null?void 0:t.tenantProductInsureVO)==null?void 0:l.attachmentVOList.filter(d=>d.attachmentName!=="\u5065\u5EB7\u544A\u77E5"))||[]}),te=async t=>{var w,O;e.userInfo.mobile=t.mobile;const l=await Ne({holderPhone:e.userInfo.mobile,productCode:r,tenantId:c}),{code:d,data:C}=l;d==="10000"&&(e.userInfo.name=(w=C.tenantOrderHolder)==null?void 0:w.name,e.userInfo.certNo=(O=C.tenantOrderHolder)==null?void 0:O.certNo),e.title=Ue,y.value=!1},G=async t=>{if((t==null?void 0:t.certNo)&&(e.userInfo.certNo=t==null?void 0:t.certNo),(t==null?void 0:t.name)&&(e.userInfo.name=t==null?void 0:t.name),_&&!I.value){N.value=!0;return}if(!e.agree){L("\u8BF7\u52FE\u9009\u534F\u8BAE");return}try{L({message:"\u9886\u53D6\u4E2D...",forbidClick:!0,loadingType:"spinner"});const l=Ie({tenantId:c,detail:F.value,insureDetail:P.value,saleChannelId:p,saleUserId:b,holder:e.userInfo,insured:U(M({},e.userInfo),{relationToHolder:De.SELF}),paymentMethod:i,renewalDK:"",iseeBizNo:V,successJumpUrl:"",premium:0,orderStatus:"",orderTopStatus:"",tenantOrderRiskList:[]}),d=await Ve(l),{code:C}=d;if(C==="10000"){if(_){L.clear(),S.value=!0;return}u.push({path:"/chuangxin/baigebao/productDetail",query:U(M({},n.query),{tenantId:c,phoneNo:e.userInfo.mobile,certNo:e.userInfo.certNo,name:e.userInfo.name,productCode:"BWYL2021",agentCode:b})})}}catch(l){console.log(l),L.clear()}},ue=()=>{I.value=!0,G()},oe=t=>{t==="allFalse"&&(h.value=!0)},ae=()=>{S.value=!1},ne=async()=>{const t=xe({productCode:r,withInsureInfo:!0,tenantId:c}),l=Ae({productCode:r});Promise.all([t,l]).then(([d,C])=>{var w;d.code==="10000"&&(F.value=d.data,document.title=((w=d.data)==null?void 0:w.productFullName)||""),C.code==="10000"&&(P.value=C.data)})};return Fe(()=>{ne(),setTimeout(async()=>{V=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(t,l)=>{const d=D("van-checkbox"),C=D("ProPDFviewer"),w=D("van-config-provider");return B(),A(w,{"theme-vars":o(Se)},{default:x(()=>{var O,J;return[a("div",Ke,[a("img",{src:(J=(O=F.value)==null?void 0:O.tenantProductInsureVO)==null?void 0:J.banner[0],class:"banner"},null,8,We),a("div",Xe,[a("div",Ye,[a("div",Qe,[a("img",{src:o(e).title},null,8,Ze)]),y.value?(B(),A(Te,{key:0,"is-check":_,"user-info":o(e).userInfo,onOnVerify:te},null,8,["user-info"])):(B(),A($e,{key:1,"is-check":_,"user-info":o(e).userInfo,onOnSubmit:G},null,8,["user-info"])),a("div",et,[a("div",tt,[v(d,{modelValue:o(e).agree,"onUpdate:modelValue":l[0]||(l[0]=E=>o(e).agree=E),name:"agree",shape:"square"},null,8,["modelValue"])]),a("div",null,[ut,(B(!0),z(Be,null,Ce(o(j)||[],(E,se)=>(B(),A(C,{key:se,class:"file-name",title:`\u300A${E.attachmentName}\u300B`,content:E.attachmentUri,type:"pdf"},null,8,["title","content"]))),128))])]),_?(B(),z("div",ot,lt)):Q("",!0)])])]),v(Je,{"is-show":S.value,onOnClose:ae},null,8,["is-show"]),v(Le,{show:h.value,"onUpdate:show":l[1]||(l[1]=E=>h.value=E),"content-list":o(j),"active-index":f.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9",onSubmit:ue},null,8,["show","content-list","active-index"]),v(Pe,{show:N.value,"onUpdate:show":l[2]||(l[2]=E=>N.value=E),"content-list":o(ee),"active-index":0,onOnConfirmHealth:oe},null,8,["show","content-list"])]}),_:1},8,["theme-vars"])}}});export{Dt as default};
