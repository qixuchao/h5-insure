import{l as e}from"./index-760d5d11.js";import{d as i,z as s,o as l,a1 as a,R as o,c as r,A as d,V as n,U as t,g as u,i as c,w as k,h as I,G as p,aV as m}from"./index-d44a19aa.js";/* empty css              */import{I as y}from"./index-5d924819.js";import{S as v}from"./index-c565cb72.js";const V=(i,s,l)=>{var a,o,r,d;const n=i,{holder:t}=l,u=l.insuredVOList[0],c=(s||"").split("_");if(c.length<2)return s;if(e.exports.isNaN(Number(c[1])))return s;if(c[1]-=1,1===n.exemptFlag){if("to"===c[0]){let e=0;1===n.exemptType?(null==(a=null==t?void 0:t.personVO)?void 0:a.birthday)&&(e=parseInt(""+((new Date).getTime()-new Date(null==(o=t.personVO)?void 0:o.birthday).getTime())/31536e6,10)):2===n.exemptType&&(null==(r=null==u?void 0:u.personVO)?void 0:r.birthday)&&(e=parseInt(""+(+(new Date).getTime()-new Date(null==(d=u.personVO)?void 0:d.birthday).getTime())/31536e6,10)),c[1]=+c[1]-e}c[0]="year"}return c.join("_")};const f={key:0},g={key:0,class:"risk2-field"},R=i({name:"ProductRiskList"});var h=p(i({...R,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(e,{emit:i}){const p=e,V=s({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),R=e=>{const i=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&i.push({...e}),[]))),i},h=(e,s,l)=>{var a;V.riskIsInsure[s].data=e;const o=[...V.disabledRiskInfo];null==(a=p.dataSource.insureProductRiskVOList)||a.forEach((e=>{if(1!==e.mainRiskFlag){const i=V.riskIsInsure[e.riskId];i.data&&Object.keys(i.data).length>0&&!i.isDisabled&&o.push(i.data)}})),i("trialChange",o,l)},C=(e,i)=>{var s;null==(s=p.dataSource.productRiskRelationVOList)||s.forEach((s=>{1!==s.collocationType&&(i.riskId===s.riskId?(V.riskIsInsure[i.riskId]&&V.riskIsInsure[i.riskId].selected,2===s.collocationType&&V.riskIsInsure[s.collocationRiskId]&&(V.riskIsInsure[s.collocationRiskId].selected=e),3===s.collocationType&&V.riskIsInsure[s.collocationRiskId]&&(V.riskIsInsure[s.collocationRiskId].selected="1"===e?"2":"1")):i.riskId===s.collocationRiskId&&(3===s.collocationType&&V.riskIsInsure[s.riskId]&&(V.riskIsInsure[s.riskId].selected="1"===e?"2":"1"),2===s.collocationType&&V.riskIsInsure[s.riskId]&&(V.riskIsInsure[s.riskId].selected=e)))})),"2"===e?h({},i.riskId):(e=>{var i,s,l,a,o,r;if(1!==(null==e?void 0:e.factorDisPlayFlag)){const d=null==(i=null==e?void 0:e.productRiskInsureLimitVO)?void 0:i.amountPremiumConfigVO,n={riskCategory:e.riskCategory,riskCode:e.riskCode,riskName:e.riskName,riskId:e.riskId,riskType:e.riskType,mainRiskId:e.mainRiskId,mainRiskCode:e.mainRiskCode,liabilityVOList:R(e)};n.chargePeriod=(null==(s=null==e?void 0:e.paymentPeriodValueList)?void 0:s.length)>0&&(null==e?void 0:e.paymentPeriodValueList[0].code)||null,n.coveragePeriod=(null==(l=null==e?void 0:e.insurancePeriodValueList)?void 0:l.length)>0&&(null==e?void 0:e.insurancePeriodValueList[0].code)||null,n.paymentFrequency=(null==(a=null==e?void 0:e.paymentFrequencyList)?void 0:a.length)>0&&(null==e?void 0:e.paymentFrequencyList[0].code)||null;let t=0;1===d.displayType?t=(null==d?void 0:d.minStepValue)>0?null==d?void 0:d.minStepValue:0:3===d.displayType&&2===d.requireCopies?t=(null==(o=null==d?void 0:d.displayValues)?void 0:o.length)>0?null==d?void 0:d.displayValues[0].value:0:3===d.displayType&&1===d.requireCopies?(t=(null==(r=null==d?void 0:d.displayValues)?void 0:r.length)>0?null==d?void 0:d.displayValues[0].value:0,n.copy=d.minCopiesValue):2===d.displayType?n.copy=d.minCopiesValue:t=0,1===d.saleMethod?n.amount=t:n.premium=t,h(n,e.riskId)}})(i)};return l((()=>{(()=>{var e,i;V.riskIsInsure={},V.disabledRiskInfo=[];let s=null;if(null==(e=p.dataSource.insureProductRiskVOList)||e.forEach((e=>{var i;const l=1!==e.mainRiskFlag?null==(i=p.dataSource.productRiskRelationVOList)?void 0:i.find((i=>i.collocationRiskId===e.riskId)):{};1===e.mainRiskFlag&&(s=e),V.riskIsInsure[e.riskId]={selected:"2",data:null,relation:l,isMust:!1}})),s){const e=null==(i=p.dataSource.productRiskRelationVOList)?void 0:i.filter((e=>e.riskId===s.riskId));if(!e)return;null==e||e.forEach((e=>{var i,s,l,a,o,r,d,n,t;if(2===e.collocationType){V.riskIsInsure[e.collocationRiskId].selected="1",V.riskIsInsure[e.collocationRiskId].isMust=!0;const u=null==(i=p.dataSource.insureProductRiskVOList)?void 0:i.find((i=>e.collocationRiskId===i.riskId));if(u&&1!==u.factorDisPlayFlag&&(null==(s=null==u?void 0:u.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO)){const i=null==(l=u.riskLiabilityInfoVOList)?void 0:l.every((e=>1!==e.showFlag)),s=null==(a=null==u?void 0:u.productRiskInsureLimitVO)?void 0:a.amountPremiumConfigVO;if(i){V.riskIsInsure[e.collocationRiskId].isDisabled=!0;const i={riskCategory:u.riskCategory,riskCode:u.riskCode,riskName:u.riskName,riskId:u.riskId,riskType:u.riskType,mainRiskId:u.mainRiskId,mainRiskCode:u.mainRiskCode,liabilityVOList:R(u)};i.chargePeriod=(null==(o=null==u?void 0:u.paymentPeriodValueList)?void 0:o.length)>0&&(null==u?void 0:u.paymentPeriodValueList[0].code)||null,i.coveragePeriod=(null==(r=null==u?void 0:u.insurancePeriodValueList)?void 0:r.length)>0&&(null==u?void 0:u.insurancePeriodValueList[0].code)||null,i.paymentFrequency=(null==(d=null==u?void 0:u.paymentFrequencyList)?void 0:d.length)>0&&(null==u?void 0:u.paymentFrequencyList[0].code)||null;let l=0;1===s.displayType?l=(null==s?void 0:s.minStepValue)>0?null==s?void 0:s.minStepValue:0:3===s.displayType&&2===s.requireCopies?l=(null==(n=null==s?void 0:s.displayValues)?void 0:n.length)>0?null==s?void 0:s.displayValues[0].value:0:3===s.displayType&&1===s.requireCopies?(l=(null==(t=null==s?void 0:s.displayValues)?void 0:t.length)>0?null==s?void 0:s.displayValues[0].value:0,i.copy=s.minCopiesValue):2===s.displayType&&(i.copy=s.minCopiesValue),1===s.saleMethod?i.amount=l:i.premium=l,V.disabledRiskInfo.push(i),h(i,u.riskId)}}}3===e.collocationType&&(V.riskIsInsure[e.collocationRiskId].selected="2",V.riskIsInsure[e.collocationRiskId].isMust=!0)}))}})()})),a((()=>{V.loading=!0})),o((()=>V.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>p.defaultValue),(e=>{(null==e?void 0:e.length)>0&&e.forEach((e=>{V.risksDefaultValue[e.riskCode]=e,V.riskIsInsure[e.riskId]&&(V.riskIsInsure[e.riskId].selected="1",h(e,e.riskId))}))}),{deep:!0,immediate:!0}),(i,s)=>{const l=v,a=m;return r(!0),d(t,null,n(e.dataSource.insureProductRiskVOList,(i=>{var s,o;return r(),d(t,{key:i.riskCode},[(!e.showMainRisk&&1!==i.mainRiskFlag||e.showMainRisk)&&(null==(o=null==(s=u(V).riskIsInsure)?void 0:s[i.riskId])?void 0:o.relation)?(r(),d("div",f,[c(a,{modelValue:u(V).riskIsInsure[i.riskId].selected,"onUpdate:modelValue":e=>u(V).riskIsInsure[i.riskId].selected=e,label:i.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:k((()=>[c(l,{modelValue:u(V).riskIsInsure[i.riskId].selected,"onUpdate:modelValue":e=>u(V).riskIsInsure[i.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"26px",disabled:u(V).riskIsInsure[i.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>C(e,i)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===u(V).riskIsInsure[i.riskId].selected?(r(),d("div",g,[c(y,{modelValue:u(V).riskIsInsure[i.riskId].data,"onUpdate:modelValue":e=>u(V).riskIsInsure[i.riskId].data=e,"origin-data":i,"product-factor":e.dataSource.productFactor,"default-value":u(V).risksDefaultValue[i.riskCode],onTrialChange:(e,s)=>h(e,i.riskId,s)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):I("",!0)])):I("",!0)],64)})),128)}}}),[["__scopeId","data-v-212a02af"]]);export{h as P,V as d};
