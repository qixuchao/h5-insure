import{k as e,r as t,b as a,p as n,s as o,B as l,C as r,E as s,y as i,S as d,v as u,H as c,G as v,u as p,aa as f,o as m,t as I,M as b,T as y,a5 as j,a6 as C}from"./vendor-225246ae.js";import{u as w}from"./theme-467ed2f7.js";import{g as _,a as g,i as E}from"./trial-9b9675d9.js";import{_ as h,n as x}from"./nextStep-df570520.js";import{s as N}from"./verify-e6c3758c.js";import{p as L}from"./product-f92b0dbe.js";import{a as O}from"./order-3972843b.js";import{_ as T,aa as R}from"./index-5b290e74.js";import{P as S}from"./index-239bc173.js";import"./infoCollection-fadc392e.js";import"./relativeTime-a39e84b6.js";import"./useDicData-2398fdc4.js";const k={class:"sign-wrap"},H=["src"],P=v("点击签字"),V={class:"popup-body"},A={class:"sign-container-wrap"},B={class:"operate-bar"},D=r("span",null,"请投保人正楷签署您的签名:",-1),U=v("返回"),F=v("重写"),G=v("确定签字"),z=e({props:{option:{default:{}},modelValue:{default:""}},emits:["update:modelValue"],setup(e,{emit:v}){const p=t(!1),f=t(),m=a((()=>{let e="";return f.value&&(e=f.value.save()),e})),I=()=>{p.value=!0},b=()=>{p.value=!1},y=()=>{var e,t;null==(t=null==(e=f.value)?void 0:e.clear)||t.call(e)},j=()=>{v("update:modelValue",m.value),p.value=!1};return(e,t)=>{const a=n("van-button"),v=n("ProSign"),C=n("van-popup");return o(),l(c,null,[r("div",k,[s(m)?(o(),l("img",{key:0,class:"previewSign",src:s(m),alt:""},null,8,H)):i("",!0),d(a,{type:"primary",size:"small",onClick:I},{default:u((()=>[P])),_:1})]),d(C,{show:p.value,"onUpdate:show":t[0]||(t[0]=e=>p.value=e),position:"bottom",style:{height:"100%"}},{default:u((()=>[r("div",V,[r("div",A,[d(v,{ref_key:"signRef",ref:f},null,512),r("div",B,[D,d(a,{type:"default",onClick:b},{default:u((()=>[U])),_:1}),d(a,{type:"default",onClick:y},{default:u((()=>[F])),_:1}),d(a,{type:"default",disabled:!s(m),onClick:j},{default:u((()=>[G])),_:1},8,["disabled"])])])])])),_:1},8,["show"])],64)}}});const Y={class:"net-sale-wrap"},q={class:"part"},J={class:"product-name"},M={class:"part"},W={class:"part"},X={class:"part"},$={class:"sign-cell"},K=(e=>(j("data-v-0aaad64f"),e=e(),C(),e))((()=>r("div",{class:"sign-label"},"签名",-1))),Q={class:"footer-button"};var Z=T(e({setup(e){const a=w(),l=p();f();const{orderNo:c="2022120119060692150",tenantId:v="9991000001",productCode:j="HTEJBX"}=l.query;t();const C=t({}),T=t({commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_airSignature",pageCode:"infoCollection",templateId:3,iseeBizNo:""},orderCategory:1,tenantId:v,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:v}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),k=t(),H=t(),P=t(""),V=async()=>{P.value?(await N("HOLDER",P.value,T.value.id,`${v}`),x(T.value)):y("请先签字")};return m((()=>{(async()=>{const{code:e,data:t}=await E({productCode:j,tenantId:v});"10000"===e&&(k.value=t,C.value=t.productFactor)})(),(async()=>{const{data:e,code:t}=await L({productCode:j,tenantId:v});"10000"===t&&(H.value=e)})(),(async()=>{const{code:e,data:t}=await _({orderNo:c,tenantId:v});if("10000"===e&&(t.extInfo.buttonCode="EVENT_NETSALE_airSignature",T.value=t,t.orderStatus===O.PAYING)){T.value.extInfo.redirectUrl="";const{code:e,data:t}=await g(T.value);"10000"===e&&R(t.paymentUrl)}})()})),(e,t)=>{const l=n("ProCell"),c=n("ProCard"),v=n("van-cell"),p=n("ProPageWrap"),f=n("van-config-provider");return o(),I(f,{"theme-vars":s(a)},{default:u((()=>[d(p,null,{default:u((()=>[r("div",Y,[T.value.id?(o(),I(c,{key:0,"show-line":!1,title:"投保信息"},{default:u((()=>{var e,t,a,n,o,s;return[r("div",q,[r("div",J,b(null==(e=k.value)?void 0:e.productBasicInfoVO.productFullName),1)]),r("div",M,[d(l,{title:"保费",content:T.value.orderAmount},null,8,["content"]),d(l,{title:"保险期限",content:null==(t=T.value.tenantOrderInsuredList[0])?void 0:t.planName},null,8,["content"]),d(l,{title:"起保日期",content:T.value.commencementTime},null,8,["content"]),d(l,{title:"终保日期",content:T.value.expiryDate},null,8,["content"]),d(l,{title:"保单状态",content:T.value.orderStatus},null,8,["content"])]),r("div",W,[d(l,{title:"订单编号",content:T.value.orderNo},null,8,["content"]),d(l,{title:"销售人名称",content:""}),d(l,{title:"房屋地址",content:null==(n=null==(a=T.value.tenantOrderHolder)?void 0:a.extInfo)?void 0:n.familyAddress},null,8,["content"]),d(l,{title:"燃气编号",content:null==(s=null==(o=T.value.tenantOrderInsuredList)?void 0:o[0])?void 0:s.extInfo.subjectRelatedUserId},null,8,["content"])])]})),_:1})):i("",!0),d(h,{ref:"formRef","title-collection":{HOLDER:"投保人信息",INSURER:"被保人信息",BENEFICIARY:"受益人"},"is-view":!0,"form-info":T.value,"factor-object":C.value,"input-align":"right"},null,8,["form-info","factor-object"]),d(c,{title:"阅读条款合同"},{default:u((()=>[r("div",X,[d(v,{title:"客户告知书","is-link":""})])])),_:1}),d(c,{title:"客户签名"},{default:u((()=>[r("div",$,[K,d(z,{modelValue:P.value,"onUpdate:modelValue":t[0]||(t[0]=e=>P.value=e)},null,8,["modelValue"])])])),_:1}),r("div",Q,[d(S,{text:"提交",onClick:V})])])])),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-0aaad64f"]]);export{Z as default};
