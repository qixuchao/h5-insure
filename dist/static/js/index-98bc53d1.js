var he=Object.defineProperty,Se=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var ie=(e,p,l)=>p in e?he(e,p,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[p]=l,v=(e,p)=>{for(var l in p||(p={}))Ne.call(p,l)&&ie(e,l,p[l]);if(de)for(var l of de(p))Le.call(p,l)&&ie(e,l,p[l]);return e},D=(e,p)=>Se(e,Ve(p));import{g as ve,E as C,_ as pe,y as ye,j as n,n as $,k as f,A as E,t as b,m as k,p as y,a4 as Ee,a5 as fe,z as S,C as U,O as Oe,ak as xe,h as we,r as q,G as Ge,F as qe,T as ce,L as Me,J as We}from"./vendor-96e68f0e.js";import{_ as je,q as Pe}from"./index-643c0270.js";import{_ as be,Y as Ie,h as W,T as M,U as He,m as Ke,V as $e,W as Ue,w as ze,X as Z,l as Q,Z as Je,$ as Ze,r as me,K as Qe,L as R,M as _,n as Xe,P as Ye}from"./index-91dffbec.js";import{c as j,a as ea}from"./order-ad7bcd6c.js";import{u as aa}from"./useDicData-c4f2f1d8.js";var Y=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(Y||{});const ee=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];j(ee);var ae=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(ae||{});const De=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];j(De);var h=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(h||{});const Ce=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];j(Ce);var A=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(A||{});const ua=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];j(Ce);var ke=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(ke||{});const Re=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];j(Re);const ta=e=>(Ee("data-v-c2f6ec68"),e=e(),fe(),e),la={class:"com-bank-card-info"},oa=ta(()=>S("span",{class:"field-title"},[U("\u94F6\u884C\u5361\u7167\u7247 "),S("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),na=ve({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:p}){const l=e,z=aa("BANK"),r=C({bankCardType:ae.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),g=s=>l.factor&&l.factor[s]&&l.factor[s].isDisplay===Ie.YES,x=s=>s&&s.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247",P=s=>{$e({ossKey:[s],imageType:Ue.BANK_CARD}).then(d=>{const{data:i,code:L}=d;L==="10000"&&i&&i.bankCardOcrVO&&(r.value.bankCardNo=i.bankCardOcrVO.bankNo)})};pe(()=>l.modelValue,s=>{r.value=s},{immediate:!0}),pe(r,s=>{p("update:modelValue",s)});const w=ye(()=>z.value.map(s=>({label:s.name,value:s.code})));return(s,d)=>(n(),$("div",la,[g("cardType")?(n(),f(W,{key:0,modelValue:r.value.bankCardType,"onUpdate:modelValue":d[0]||(d[0]=i=>r.value.bankCardType=i),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":E(De),"is-view":""},null,8,["modelValue","data-source"])):b("",!0),g("bankCardNumber")?(n(),f(M,{key:1,modelValue:r.value.bankCardNo,"onUpdate:modelValue":d[1]||(d[1]=i=>r.value.bankCardNo=i),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):b("",!0),g("cardHolder")?(n(),f(M,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):b("",!0),g("bank")?(n(),f(W,{key:3,modelValue:r.value.payBank,"onUpdate:modelValue":d[2]||(d[2]=i=>r.value.payBank=i),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":E(w),required:""},null,8,["modelValue","data-source"])):b("",!0),g("bankCardAttachment")?(n(),f(M,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:x}]},{label:k(()=>[oa]),input:k(()=>[y(Ke,{modelValue:r.value.images,"onUpdate:modelValue":d[3]||(d[3]=i=>r.value.images=i),"max-count":2,"upload-type":E(He).BANK_CARD,onOnUploadFinished:P},null,8,["modelValue","upload-type"])]),_:1},8,["rules"])):b("",!0),g("bankPreMobile")?(n(),f(M,{key:5,modelValue:r.value.mobile,"onUpdate:modelValue":d[4]||(d[4]=i=>r.value.mobile=i),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):b("",!0)]))}});var X=be(na,[["__scopeId","data-v-c2f6ec68"]]);const ra=e=>(Ee("data-v-72b25f27"),e=e(),fe(),e),sa={class:"page-bank-card"},da={class:"reprise-card-list"},ia=["onClick"],pa={class:"agree"},ca=U(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),ma={class:"footer-button footer"},va=ra(()=>S("div",{class:"text"},"\u5237\u65B0",-1)),ya=U("\u5206\u4EAB"),Ea=U("\u4E0B\u4E00\u6B65"),fa=ve({setup(e){const p={1:"pdf",4:"picture",2:"richText",3:"link"},l=Oe(),z=xe(),{orderNo:r="2022072710380711215",agentCode:g="D1234567-1",tenantId:x="9991000007",templateId:P=1,isShare:w,insureCode:s="kunlunhealth"}=l.query,d={bankCardType:ae.DEBIT};let i={};const L=C(""),I=C({payMethod:Y.REAL_TIME,bankData:D(v({},d),{imagesId:[],images:[]})}),o=C({payMethod:Y.REAL_TIME,expiryMethod:ke.AUTOMATIC_PADDING,bankData:D(v({},d),{imagesId:[],images:[]}),payInfoType:A.FIRST_SAME}),T=C({bankData:D(v({},d),{imagesId:[],images:[]})}),O=C(A.FIRST_SAME),B=C({}),J=C(!1),ue=C(),te=C(),le=C(),oe=C({}),H=C(1),Te=m=>{O.value=m},K=(m,u)=>B.value&&B.value[u]&&B.value[u][m]&&B.value[u][m].isDisplay===Ie.YES,Fe=()=>{Ze({insureCode:s,objectType:4,tenantId:x,orderNo:r}).then(({code:m,data:u})=>{m==="10000"&&(oe.value=u,u.materialSource===1?u.materialContent.indexOf(".pdf")!==-1?H.value=1:H.value=4:H.value=u.materialSource)})},ge=()=>{me({orderNo:r,saleUserId:g,tenantId:x}).then(m=>{var c,a,G;const{code:u,data:V}=m;u==="10000"&&(V.orderStatus!==ea.PENDING?Qe("paymentResult",l.query):Promise.all([(c=ue.value)==null?void 0:c.validate(),(a=te.value)==null?void 0:a.validate(),(G=le.value)==null?void 0:G.validate()]).then(F=>{if(!J.value){ce.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}const t=[D(v({},F[0]),{id:I.value.id,paymentType:h.FIRST_TERM}),D(v({},F[1]),{id:o.value.id,paymentType:h.RENEW_TERM}),D(v({},F[2]),{id:T.value.id,paymentType:h.REPRISE,payInfoType:O.value})],N=[{category:R.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.INIT_SIGN,type:"png",uri:F[0].images[0],id:I.value.bankData.imagesId[0]},{category:R.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.INIT_SIGN,type:"png",uri:F[0].images[1],id:I.value.bankData.imagesId[1]}];o.value.payInfoType===A.OTHER&&(N.push({category:R.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:F[1].images[0],id:o.value.bankData.imagesId[0]}),N.push({category:R.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:F[1].images[1],id:o.value.bankData.imagesId[1]})),O.value===A.OTHER&&(N.push({category:R.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:F[2].images[0],id:T.value.bankData.imagesId[0]}),N.push({category:R.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:F[2].images[1],id:T.value.bankData.imagesId[1]})),Xe(D(v({},i),{pageCode:"payInfo",tenantOrderPayInfoList:t,extInfo:D(v({},i.extInfo),{templateId:P,pageCode:"payInfo",shareFlag:w?"Y":"N"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:N})).then(re=>{const{code:Be,data:se}=re;Be==="10000"&&se.success&&z.push({path:Ye[se.pageAction.data.nextPageCode],query:l.query})})}))})},_e=ye(()=>{const m=D(v({},l.query),{isShare:1,sharePageCode:"payInfo"});return`${window.location.origin}/phoneVerify?${Pe.stringify(m)}`}),ne=(m=!1)=>{me({orderNo:r,saleUserId:g,tenantId:x}).then(u=>{const{code:V,data:c}=u;V==="10000"&&c&&(i=c,L.value=c.tenantOrderHolder.name,c.tenantOrderPayInfoList.forEach(a=>{a.paymentType===h.FIRST_TERM?(I.value=a,I.value.bankData=D(v(v({},d),a),{images:[],imagesId:[]})):a.paymentType===h.RENEW_TERM?(o.value=a,o.value.bankData=D(v({},a),{images:[],imagesId:[]})):a.paymentType===h.REPRISE&&(T.value=a,T.value.bankData=D(v({},a),{images:[],imagesId:[]}),O.value=a.payInfoType)}),c.tenantOrderAttachmentList.forEach(a=>{a.objectType===_.INIT_SIGN?(a.category===R.OBVERSE_BANK_CARD&&(I.value.bankData.images[0]=a.uri,I.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(I.value.bankData.images[1]=a.uri,I.value.bankData.imagesId[1]=a.id)):a.objectType===_.RENEWAL_SIGN?(a.category===R.OBVERSE_BANK_CARD&&(o.value.bankData.images[0]=a.uri,o.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(o.value.bankData.images[1]=a.uri,o.value.bankData.imagesId[1]=a.id)):a.objectType===_.ANNUAL_SIGN&&(a.category===R.OBVERSE_BANK_CARD&&(T.value.bankData.images[0]=a.uri,T.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(T.value.bankData.images[1]=a.uri,T.value.bankData.imagesId[1]=a.id))}),m&&(c.tenantOrderPayInfoList.find(a=>a.paymentType===h.FIRST_TERM&&a.bankCardNo)||ce("\u7528\u6237\u672A\u5B8C\u6210\u94F6\u884C\u5361\u4FE1\u606F\u586B\u5199")))})},Ae=()=>{ne(!0)};return we(()=>{Fe(),ze({pageCode:"payInfo",templateId:P}).then(m=>{const{code:u,data:V}=m;if(u==="10000"){const c={};V.productInsureFactorList.forEach(a=>{c[a.moduleType]||(c[a.moduleType]={}),c[a.moduleType][a.code]=a}),B.value=c}}),ne()}),(m,u)=>{const V=q("van-switch"),c=q("van-checkbox"),a=q("ProSvg"),G=q("van-button"),F=q("ProPageWrap");return n(),f(F,null,{default:k(()=>[S("div",sa,[y(Q,{title:"\u9996\u671F\u652F\u4ED8"},{default:k(()=>[y(Z,{ref_key:"form1",ref:ue},{default:k(()=>[K("paymentMethod","INIT")?(n(),f(W,{key:0,modelValue:I.value.payMethod,"onUpdate:modelValue":u[0]||(u[0]=t=>I.value.payMethod=t),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":E(ee)},null,8,["modelValue","data-source"])):b("",!0),y(X,{modelValue:I.value.bankData,"onUpdate:modelValue":u[1]||(u[1]=t=>I.value.bankData=t),"holder-name":L.value,factor:B.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),y(Q,{title:"\u7EED\u671F\u652F\u4ED8"},{default:k(()=>[y(Z,{ref_key:"form2",ref:te},{default:k(()=>[K("sameAsInit","RENEWAL")?(n(),f(M,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:k(()=>[y(V,{modelValue:o.value.payInfoType,"onUpdate:modelValue":u[2]||(u[2]=t=>o.value.payInfoType=t),size:"22","active-value":E(A).FIRST_SAME,"inactive-value":E(A).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):b("",!0),K("paymentMethod","RENEWAL")?(n(),f(W,{key:1,modelValue:o.value.payMethod,"onUpdate:modelValue":u[3]||(u[3]=t=>o.value.payMethod=t),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":E(ee),required:""},null,8,["modelValue","data-source"])):b("",!0),K("overduePayment","RENEWAL")?(n(),f(W,{key:2,modelValue:o.value.expiryMethod,"onUpdate:modelValue":u[4]||(u[4]=t=>o.value.expiryMethod=t),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":E(Re),required:"","label-width":"200"},null,8,["modelValue","data-source"])):b("",!0),o.value.payInfoType!==E(A).FIRST_SAME?(n(),f(X,{key:3,modelValue:o.value.bankData,"onUpdate:modelValue":u[5]||(u[5]=t=>o.value.bankData=t),"holder-name":L.value,factor:B.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):b("",!0)]),_:1},512)]),_:1}),y(Q,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:k(()=>[S("div",da,[(n(!0),$(qe,null,Ge(E(ua),(t,N)=>(n(),$("div",{key:N,class:Me(["reprise-card-item",{selected:O.value===t.value}]),onClick:re=>Te(t.value)},We(t.label),11,ia))),128))]),y(Z,{ref_key:"form3",ref:le},{default:k(()=>[O.value===E(A).OTHER?(n(),f(X,{key:0,modelValue:T.value.bankData,"onUpdate:modelValue":u[6]||(u[6]=t=>T.value.bankData=t),"holder-name":L.value,factor:B.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):b("",!0)]),_:1},512)]),_:1}),S("div",pa,[y(c,{modelValue:J.value,"onUpdate:modelValue":u[7]||(u[7]=t=>J.value=t),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),ca,y(Je,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",content:oe.value.materialContent,type:p[H.value]},null,8,["content","type"])]),S("div",ma,[E(w)?b("",!0):(n(),$("div",{key:0,class:"refresh-btn",onClick:Ae},[S("div",null,[y(a,{name:"refresh"})]),va])),E(w)?b("",!0):(n(),f(je,{key:1,title:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",desc:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",link:E(_e),"-":""},{default:k(()=>[y(G,{plain:"",type:"primary"},{default:k(()=>[ya]),_:1})]),_:1},8,["link"])),y(G,{type:"primary",class:"submit-btn",onClick:ge},{default:k(()=>[Ea]),_:1})])])]),_:1})}}});var Ta=be(fa,[["__scopeId","data-v-72b25f27"]]);export{Ta as default};
