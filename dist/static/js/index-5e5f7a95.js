import{_ as a,d as e,A as s,r as t,aE as l,u as o,y as r,b as i,c as d,e as n,w as u,f as p,l as c,az as m,i as v,g as h,h as f,t as y,aM as g,F as b,j as P,n as k,a5 as x,T as j}from"./index-24c1b645.js";import{Z as _,e as C}from"./empty-74e992a7.js";import{P as V}from"./index-8f88e0dd.js";import{d as I,h as L}from"./proposalList-ba4ff360.js";import{a as w,b as N,t as U}from"./format-12461bbc.js";import"./pdfh5-3b8067b2.js";import"./pdfdist-964d560e.js";const q={class:"proposal-content"},z={class:"title"},S={class:"premium"},T=k(" 保费："),A={class:"operate-btn"},E=k("删除"),F=k("编辑"),M=k("预览");var O=a(e({setup(a){const e=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:a=>w(null==a?void 0:a.coveragePeriod)},{title:"缴费期间",dataIndex:"chargePeriod",width:110,render:a=>N(null==a?void 0:a.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:a=>U(null==a?void 0:a.premium)}],k=s({historyList:[],searchValue:""}),O=t(!1),R=t(!1),W=t(1),{historyList:Z,searchValue:B}=l(k),D=o(),G=()=>{L({name:B.value,pageNum:W.value,pageSize:20,relationUserType:2}).then((a=>{const{code:e,data:s}=a;"10000"===e&&(1===W.value?Z.value=s.datas||[]:Z.value=Z.value.concat(s.datas),W.value+=1,O.value=!1,R.value=Z.value.length>=s.total)}))},H=()=>{G()},J=r((()=>Z.value.length>0)),K=a=>{B.value=a,W.value=1,G()};return(a,s)=>{const t=i("van-search"),l=i("van-button"),o=i("van-list"),r=i("ProPageWrap");return d(),n(r,{class:"page-history-proposal"},{default:u((()=>[p(t,{modelValue:c(B),"onUpdate:modelValue":s[0]||(s[0]=a=>m(B)?B.value=a:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:K},null,8,["modelValue"]),v("div",q,[p(o,{loading:O.value,"onUpdate:loading":s[1]||(s[1]=a=>O.value=a),finished:R.value,"finished-text":c(J)?"- 没有更多了 -":"",onLoad:H},{default:u((()=>[(d(!0),h(b,null,f(c(Z),(a=>(d(),h("div",{key:a.id,class:"proposal-item"},[v("div",z,y(a.proposalName)+"计划书",1),v("p",S,[T,v("span",null,"¥"+y(c(g)(a.totalPremium)),1)]),p(V,{columns:e,class:"table","data-source":a.proposalProductRiskVOList},null,8,["data-source"]),v("div",A,[p(l,{plain:"",round:"",type:"primary",class:"del-btn",onClick:e=>{return s=a.id,void x.confirm({message:"是否确定删除计划书？"}).then((()=>{I(s).then((a=>{const{code:e}=a;"10000"===e&&(j.success("删除成功"),W.value=1,G())}))})).catch((()=>{}));var s}},{default:u((()=>[E])),_:2},1032,["onClick"]),p(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void D.push({path:"/proposal/createProposal",query:{id:s}});var s}},{default:u((()=>[F])),_:2},1032,["onClick"]),p(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void D.push({path:"compositionProposal",query:{id:s}});var s}},{default:u((()=>[M])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),c(J)?P("",!0):(d(),n(_,{key:0,"empty-img":c(C),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})}}}),[["__scopeId","data-v-36b7a1a3"]]);export{O as default};
