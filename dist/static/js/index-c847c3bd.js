import{a as e,aS as t,h as a,b7 as o,_ as d,D as r,T as n,p as u,b8 as s,aI as l,u as i,b9 as c}from"./index-d66a20d8.js";import{ref as v,computed as p,watch as m,onMounted as f}from"vue";/* empty css              */import{d as C,g as N}from"./order-e0b99dc6.js";import"./pdfh5-e588f83d.js";const g=e=>(vue.pushScopeId("data-v-7faf90ea"),e=e(),vue.popScopeId(),e),I={class:"com-order-item"},y={class:"header"},h={class:"product-name"},k={class:"status"},b={class:"info"},V={class:"info-item"},E=g((()=>vue.createElementVNode("div",{class:"label"},"投保人",-1))),S={class:"desc"},B={class:"info-item"},D=g((()=>vue.createElementVNode("div",{class:"label"},"创建时间",-1))),x={class:"desc"},_={class:"footer"},T={class:"fee"},Y={class:"money"},w={key:0,class:"buttons"},U={key:1,class:"buttons"},M={key:2,class:"buttons"};var L=d(vue.defineComponent({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(d,{emit:l}){const i=d,c=e(),v=()=>{r.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{C(i.detail.id,i.detail.orderStatus).then((e=>{const{code:t,data:a}=e;"10000"===t&&(n.success("删除成功"),l("afterDelete"))}))}))},p=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:d,templateId:r,tenantId:n,insurerCode:u,productCategory:l,agencyId:v,saleChannelId:p,orderTopStatus:m}=i.detail;if((o.PENDING===m||o.PAYING===m)&&[s.ZXYS,s.BWYL,s.BWYLUP].includes(e)){const a={[s.ZXYS]:"/internet/productDetail/package",[s.BWYL]:"/internet/productDetail",[s.BWYLUP]:"/internet/guaranteeUpgrade"};return c.push({path:a[e],query:{productCode:e,saleChannelId:p,agentCode:d,tenantId:n,agencyCode:v,orderNo:t}}),!0}return!1},m=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:d,tenantId:r,insurerCode:n,productCategory:u,agencyId:s}=i.detail;p()||c.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:o,templateId:d,tenantId:r,insurerCode:n,productCategory:u,agencyCode:s}})};return(e,r)=>{const n=vue.resolveComponent("van-button");return vue.openBlock(),vue.createElementBlock("div",I,[vue.createElementVNode("div",y,[vue.createElementVNode("div",h,vue.toDisplayString(d.detail.goodsName),1),vue.createElementVNode("div",k,vue.toDisplayString(vue.unref(t)[d.detail.orderStatus]),1)]),vue.createElementVNode("div",b,[vue.createElementVNode("div",V,[E,vue.createElementVNode("div",S,vue.toDisplayString(d.detail.policyHolder),1)]),vue.createElementVNode("div",B,[D,vue.createElementVNode("div",x,vue.toDisplayString(vue.unref(a)(d.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss")),1)])]),vue.createElementVNode("div",_,[vue.createElementVNode("div",T,[vue.createTextVNode(" 保费："),vue.createElementVNode("span",Y,"￥"+vue.toDisplayString(d.detail.prem),1)]),d.detail.orderTopStatus===vue.unref(o).PENDING?(vue.openBlock(),vue.createElementBlock("div",w,[vue.createVNode(n,{class:"button",onClick:vue.withModifiers(v,["stop"])},{default:vue.withCtx((()=>[vue.createTextVNode("删除")])),_:1},8,["onClick"]),vue.createVNode(n,{class:"button primary",onClick:r[0]||(r[0]=vue.withModifiers((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:d,tenantId:r,insurerCode:n,productCategory:s,agencyId:l,saleChannelId:c,orderStatus:v,abbreviation:m}=i.detail;p()||u("orderDetail",{orderNo:t,agentCode:o,tenantId:r,abbreviation:m,productCategory:s})})()),["stop"]))},{default:vue.withCtx((()=>[vue.createTextVNode("去处理")])),_:1})])):vue.createCommentVNode("",!0),d.detail.orderTopStatus===vue.unref(o).PAYING?(vue.openBlock(),vue.createElementBlock("div",U,[vue.createVNode(n,{class:"button primary",onClick:vue.withModifiers(m,["stop"])},{default:vue.withCtx((()=>[vue.createTextVNode("去支付")])),_:1},8,["onClick"])])):vue.createCommentVNode("",!0),d.detail.orderTopStatus===vue.unref(o).TIMEOUT?(vue.openBlock(),vue.createElementBlock("div",M,[vue.createVNode(n,{class:"button",onClick:vue.withModifiers(v,["stop"])},{default:vue.withCtx((()=>[vue.createTextVNode("删除")])),_:1},8,["onClick"])])):vue.createCommentVNode("",!0)])])}}}),[["__scopeId","data-v-7faf90ea"]]);const P={class:"page-order"};var j=d(vue.defineComponent({__name:"index",setup(t){const a=l();e();const o=i().query,d=v({"-1":1,0:2,1:3,2:4}[o.type]||0),r=v(1),s=v(!1),C=v(!1),g=v([]),I=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],y=p((()=>(g.value=[],I[d.value].status))),h=()=>{n.loading({message:"加载中...",forbidClick:!0}),s.value=!0,N({condition:{orderTopStatus:y.value},pageSize:10,pageNum:r.value}).then((e=>{s.value=!1;const{code:t,data:a}=e;"10000"===t&&a&&(1===r.value?g.value=a.datas||[]:g.value=[...g.value,...a.datas||[]]),C.value=!a||g.value.length>=(null==a?void 0:a.total)})).then((()=>{n.clear()}))},k=()=>{r.value+=1,h()},b=()=>{r.value=1,h()};return m(y,(()=>{r.value=1,h()})),f((()=>{h()})),(e,t)=>{const o=vue.resolveComponent("van-list"),r=vue.resolveComponent("van-config-provider");return vue.openBlock(),vue.createBlock(r,{"theme-vars":vue.unref(a)},{default:vue.withCtx((()=>[vue.createElementVNode("div",P,[vue.createVNode(c,{active:vue.unref(d),"onUpdate:active":t[0]||(t[0]=e=>vue.isRef(d)?d.value=e:null),list:I,class:"tab"},null,8,["active"]),vue.createVNode(o,{class:"body",loading:vue.unref(s),finished:vue.unref(C),onLoad:k},{default:vue.withCtx((()=>[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(vue.unref(g),((e,t)=>(vue.openBlock(),vue.createBlock(L,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,tenantId:o,abbreviation:d,productCategory:r}=e;u("orderDetail",{orderNo:t,agentCode:a,tenantId:o,abbreviation:d,productCategory:r})})(e),onAfterDelete:b},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-42effda0"]]);export{j as default};
