import{C as e}from"./index-0a399663.js";import{q as i}from"./createProposal-ad9dcdf9.js";import{b as r,c as t}from"./trial-4f7380aa.js";const a=(e,i)=>{const a=[];return e.forEach((e=>{var n;null==(n=e.tenantOrderRiskList)||n.forEach((e=>{const{currentAmount:n,paymentPeriod:o,paymentPeriodType:s,liabilityDetails:d,extInfo:l,insurancePeriodValue:u,insurancePeriodType:c,paymentFrequency:p,riskType:y,riskCode:m,initialPremium:C,initialAmount:k,annuityDrawFrequency:b,annuityDrawDate:I}=e;let T=`${r[s]}_${o}`;1===s&&(T="single");let h=`${t[c]}_${u}`;5===c&&(h="to_life"),a.push({amount:k,annuityDrawDate:I,annuityDrawFrequency:b,chargePeriod:T,copy:(null==l?void 0:l.copy)||"",coveragePeriod:h,insuredCode:i,liabilityVOList:d,mainRisk:"",mainRiskCode:"",mainRiskId:"",paymentFrequency:p,premium:C,riskType:y,riskCode:m,riskId:(null==l?void 0:l.riskId)||"",riderRisk:"",riderRiskVOList:[]})}))})),a},n=({holder:e,insuredList:i=[]})=>{const r=["birthday","certEndDate","certEndType","certNo","certStartDate","verificationCode","certType","email","gender","mobile","name","id","insuredBeneficiaryType","relationToHolder","relationToMainInsured","tenantOrderBeneficiaryList","extInfo"],t=e=>{const i={extInfo:{}};return"[object Object]"==={}.toString.call(e)&&Object.keys(e).forEach((t=>{r.includes(t)?i[t]=e[t]:i.extInfo[t]=e[t]})),i};return{tenantOrderHolder:t(e),tenantOrderInsuredList:(i||[]).map((e=>t(e)))}},o=(i,r,t)=>{var n;const{tenantId:o,commencementTime:s,expiryDate:d,venderCode:l,tenantOrderHolder:u,tenantOrderInsuredList:c}=i;return{tenantId:o,productCode:null==r?void 0:r.productCode,insuranceStartDate:s,insuranceEndDate:d,holder:{personVO:{...u,socialFlag:null==(n=u.extInfo)?void 0:n.hasSocialInsurance,certType:u.certType||e.CERT}},insuredVOList:c.map((r=>({insuredCode:"",relationToHolder:r.relationToHolder,personVO:{...r,socialFlag:r.extInfo.hasSocialInsurance,certType:r.certType||e.CERT},productPlanVOList:[{insurerCode:l,planCode:t||"",riskVOList:a(r.tenantOrderProductList||[],i.venderCode)}]})))}},s=async({proposalId:e,productCode:r,tenantId:t},a)=>{const n=(await i({id:e,tenantId:t})).data,o={holder:{},insuredVOList:[],productCode:r};o.holder={personVO:null==n?void 0:n.proposalHolder},o.insuredVOList=null==n?void 0:n.proposalInsuredList.map((e=>({personVO:{age:e.age,birthday:e.birthday,bmi:e.bmi,certNo:e.certNo,certType:e.certType,email:e.email,gender:e.gender,hasSocialInsurance:e.hasSocialInsurance,height:e.height,holderRelation:e.holderRelation,insureAreaCode:e.insureAreaCode,insureCityCode:e.insureCityCode,insureProvinceCode:e.insureProvinceCode,mobile:e.mobile,name:e.name,occupationClass:e.occupationClass,occupationCodeList:e.occupationCode,smokeFlag:e.smokeFlag,socialFlag:e.socialFlag,weight:e.weight},productPlanVOList:e.proposalInsuredProductList.map((e=>({insurerCode:null,planCode:"",relationToHolder:"1",riskVOList:e.proposalProductRiskList.map((e=>({amount:e.amount,annuityDrawDate:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,chargePeriod:e.chargePeriod,copy:e.copy,coveragePeriod:e.coveragePeriod,liabilityVOList:e.liabilityVOList.map((e=>({liabilityAmount:null,liabilityAttributeType:e.liabilityAttributeType,liabilityAttributeValueList:e.liabilityAttributeValueList,liabilityCode:e.liabilityCode,liabilityId:e.liabilityId,liabilityRateType:null,liabilityValue:null}))),mainRiskCode:e.mainRiskCode,mainRiskId:e.mainRiskId,paymentFrequency:e.paymentFrequency,premium:e.premium,riskCategory:e.riskCategory,riskCode:e.riskCode,riskId:e.riskId,riskName:e.riskName,riskType:e.riskType})))})))}))),null==a||a(o)};export{n as f,o,s as p};
