var ve=Object.defineProperty,Ee=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var te=(d,u,B)=>u in d?ve(d,u,{enumerable:!0,configurable:!0,writable:!0,value:B}):d[u]=B,L=(d,u)=>{for(var B in u||(u={}))De.call(u,B)&&te(d,B,u[B]);if(ee)for(var B of ee(u))pe.call(u,B)&&te(d,B,u[B]);return d},M=(d,u)=>Ee(d,Ce(u));import{g as ne,a5 as Fe,r as P,j as f,n as p,z as a,A as N,p as v,a6 as he,Q as Ae,aj as ge,E as V,d as ye,y as me,h as Te,k as j,m as C,J as A,L as ue,t as O,G as Y,F as q,a1 as Ne,a2 as xe,C as R,T as S,D as Ie}from"./vendor-c15a8cf7.js";import{_ as re,S as Re,D as ke,E as Oe,p as se,l as w,F as ae,P as Se}from"./index-e3e68c47.js";import{g as we,f as Pe,s as oe,a as be}from"./verify-cc479cb0.js";import{n as Ue,a as $e}from"./index-4ebeb1a6.js";var He="/static/assets/sidenav.5031dada.png";const Le={class:"com-navigator"},Me=["src"],Ve=ne({setup(d){const[u,B]=Fe(!1),k=()=>{B(!0)};return(Q,x)=>{const F=P("van-popup");return f(),p("div",Le,[a("img",{class:"btn",src:N(He),onClick:k},null,8,Me),v(F,{show:N(u),"onUpdate:show":x[0]||(x[0]=b=>he(u)?u.value=b:null),position:"right",style:{width:"50%",height:"100%"},"safe-area-inset-top":""},null,8,["show"])])}}});var je=re(Ve,[["__scopeId","data-v-48192b24"]]);const ie=d=>(Ne("data-v-41315954"),d=d(),xe(),d),Ye={class:"page-verify"},qe={class:"people"},Qe={class:"name"},ze={class:"verify-item"},Ge=ie(()=>a("div",{class:"label"},"\u8BC1\u4EF6\u53F7\u7801",-1)),We={class:"no"},Je=R(" \u53BB\u8BA4\u8BC1 "),Ke={class:"sign-body"},Xe={class:"date"},Ze={class:"file"},et=R(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A "),tt={class:"people"},ut={class:"name"},st={class:"verify-item"},at=ie(()=>a("div",{class:"label"},"\u8BC1\u4EF6\u53F7\u7801",-1)),ot={class:"no"},nt=["onClick"],rt=R(" \u53BB\u8BA4\u8BC1 "),it=["onClick"],lt={class:"sign-body"},ct={class:"date"},dt={class:"file"},_t=R(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A "),Bt={class:"footer-button footer"},ft=R("\u63D0\u4EA4"),vt=ne({setup(d){const u={CERT:1,NO_CERT:2},B={1:"pdf",4:"picture",2:"richText",3:"link"},k=Ae(),Q=ge(),{saleUserId:x="D1234567-1",tenantId:F="9991000007",templateId:b=1,productCode:le="CQ75CQ76",insurerCode:ce="ancheng"}=k.query;let{orderNo:g}=k.query;typeof g=="object"&&(g=(g||[])[0]);const U=new Re({source:"localStorage"}),$=V([]),o=V(),m=V(),y=[],z=ye().format("YYYY-MM-DD"),G=me(()=>e=>{let s=1;return e.materialSource===1?e.materialContent.indexOf(".pdf")!==-1?s=1:s=4:s=e.materialSource,B[s]}),de=()=>{var e;(e=m.value)==null||e.clear()},_e=e=>{y[e].clear()},W=(e,s)=>{be({callbackUrl:window.location.href,certiNo:e,faceAuthMode:"TENCENT",userName:s,tenantId:9991000007}).then(r=>{const{code:i,data:l}=r;if(i==="10000"){const{originalUrl:D,serialNo:t}=l;window.location.href=D,U.set("verifyData",{serialNo:t,certNo:e,name:s})}})},T=e=>`${e}`===Oe.CERT,J=e=>{var s,r,i,l;e===-1?W((s=o.value.tenantOrderHolder)==null?void 0:s.certNo,(r=o.value.tenantOrderHolder)==null?void 0:r.name):W((i=o.value.tenantOrderInsuredList[e])==null?void 0:i.certNo,(l=o.value.tenantOrderInsuredList[e])==null?void 0:l.name)},Be=e=>{e&&y.every(s=>s!==e)&&y.push(e)},fe=()=>{var s,r,i,l,D;if((s=m.value)==null?void 0:s.isEmpty()){S.fail("\u8BF7\u6295\u4FDD\u4EBA\u7B7E\u540D");return}if(y.some(t=>t.isEmpty())){S.fail("\u8BF7\u88AB\u4FDD\u4EBA\u7B7E\u540D");return}if(((i=(r=o.value.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:i.isCert)!==u.CERT&&T((l=o.value.tenantOrderHolder)==null?void 0:l.certType)){S.fail("\u8BF7\u6295\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}if((D=o.value.tenantOrderInsuredList)==null?void 0:D.some(t=>{var c;return((c=t.extInfo)==null?void 0:c.isCert)!==u.CERT&&T(t.certType)})){S.fail("\u8BF7\u88AB\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}Ie.confirm({title:"\u63D0\u793A",message:"\u8BF7\u786E\u8BA4\u4FE1\u606F\u586B\u5199\u65E0\u8BEF\u540E\uFF0C\u518D\u8FDB\u884C\u652F\u4ED8"}).then(()=>{var c,n;const t=(c=m.value)==null?void 0:c.save();Promise.all([oe("HOLDER",t,(n=o.value)==null?void 0:n.id,`${F}`),...y.map(_=>{var E;return oe("INSURED",_.save(),(E=o.value)==null?void 0:E.id,`${F}`)})]).then(()=>{Ue(M(L({},o.value),{pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:M(L({},o.value.extInfo),{pageCode:"sign",templateId:b}),venderCode:ce})).then(_=>{const{code:E,data:h}=_;E==="10000"&&h.success&&Q.push({path:Se[h.pageAction.data.nextPageCode],query:{orderNo:g,saleUserId:x,tenantId:F}})})})})},K=()=>{$e({orderNo:g,saleUserId:x,tenantId:F}).then(e=>{const{code:s,data:r}=e;s==="10000"&&(o.value=r,setTimeout(()=>{let i=0;r.tenantOrderAttachmentList.forEach(l=>{l.category===21&&(l.objectType===2?(m.value.clear(),m.value.setDataURL(l.fileBase64)):l.objectType===1&&(y[i].clear(),y[i].setDataURL(l.fileBase64),i+=1))})}))})};return Te(()=>{K(),we({orderNo:g,productCode:le,tenantId:F}).then(s=>{const{code:r,data:i}=s;r==="10000"&&($.value=i||[])});const e=U.get("verifyData");if(e){const{serialNo:s,certNo:r,name:i}=e;Pe({certiNo:r,orderNo:g,serialNo:s,tenantId:F,userName:i}).then(l=>{const{code:D,data:t}=l;D==="10000"&&(U.remove("verifyData"),K())})}}),(e,s)=>{const r=P("ProPDFviewer"),i=P("van-button"),l=P("ProPageWrap");return f(),j(l,null,{default:C(()=>{var D;return[a("div",Ye,[v(ke,{type:"warning",title:"\u5C0A\u656C\u7684\u5BA2\u6237\uFF0C\u672C\u6B21\u6295\u4FDD\u9700\u8981\u8FDB\u884C\u8EAB\u4EFD\u8BA4\u8BC1",content:"\u672C\u4EA7\u54C1\u6295\u4FDD\u9700\u8981\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\uFF0C\u60A8\u8D2D\u4E70\u672C\u4EA7\u54C1\u7684\u7D2F\u8BA1\u603B\u4FDD\u8D39\u5DF2\u8D85\u8FC720\u4E07\uFF0C\u6309\u76D1\u7BA1\u8981\u6C42\uFF0C\u9700\u8981\u63D0\u4F9B\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u3001\u6307\u5B9A\u53D7\u76CA\u4EBA\u8BC1\u4EF6\u5F71\u50CF\uFF0C\u672C\u4EA7\u54C1\u975E\u672C\u4EBA\u6295\u4FDD\u4E14\u5E26\u8EAB\u6545\u8D23\u4EFB\u3001\u9700\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\uFF08\u6210\u4EBA\uFF09\u7684\u6295\u4FDD\u610F\u613F\u8FDB\u884C\u7B7E\u5B57\u786E\u8BA4\u3002"}),v(w,{title:"\u6295\u4FDD\u4EBA",class:"card"},{extra:C(()=>{var t,c,n,_,E,h,I,H,X,Z;return[a("div",qe,[a("div",Qe,A((c=(t=o.value)==null?void 0:t.tenantOrderHolder)==null?void 0:c.name),1),T((_=(n=o.value)==null?void 0:n.tenantOrderHolder)==null?void 0:_.certType)?(f(),p("div",{key:0,class:ue(["status",{verified:((I=(h=(E=o.value)==null?void 0:E.tenantOrderHolder)==null?void 0:h.extInfo)==null?void 0:I.isCert)===u.CERT}])},A(((Z=(X=(H=o.value)==null?void 0:H.tenantOrderHolder)==null?void 0:X.extInfo)==null?void 0:Z.isCert)===u.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)):O("",!0)])]}),default:C(()=>{var t,c,n,_,E,h,I;return[a("div",ze,[Ge,a("div",We,A((c=(t=o.value)==null?void 0:t.tenantOrderHolder)==null?void 0:c.certNo),1),((E=(_=(n=o.value)==null?void 0:n.tenantOrderHolder)==null?void 0:_.extInfo)==null?void 0:E.isCert)!==u.CERT&&T((I=(h=o.value)==null?void 0:h.tenantOrderHolder)==null?void 0:I.certType)?(f(),p("div",{key:0,class:"action",onClick:s[0]||(s[0]=H=>J(-1))},[Je,v(se,{name:"right_arrow",class:"icon"})])):O("",!0)])]}),_:1}),v(w,{title:"\u6295\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:C(()=>[a("div",{class:"resign",onClick:de},"\u91CD\u7B7E")]),default:C(()=>[v(ae,{ref_key:"holderSign",ref:m,class:"sign"},null,512),a("div",Ke,[a("div",Xe,"\u7B7E\u540D\u65E5\u671F\uFF1A "+A(N(z)),1),a("div",Ze,[et,(f(!0),p(q,null,Y($.value,(t,c)=>(f(),j(r,{key:c,class:"file",title:`\u300A${t.materialName}\u300B`,content:t.materialContent,type:N(G)(t)},null,8,["title","content","type"]))),128))])])]),_:1}),(f(!0),p(q,null,Y((D=o.value)==null?void 0:D.tenantOrderInsuredList,(t,c)=>(f(),p("div",{key:c},[v(w,{title:"\u88AB\u4FDD\u4EBA",class:"card"},{extra:C(()=>{var n,_;return[a("div",tt,[a("div",ut,A(t.name),1),T(t.certType)?(f(),p("div",{key:0,class:ue(["status",{verified:((n=t.extInfo)==null?void 0:n.isCert)===u.CERT}])},A(((_=t.extInfo)==null?void 0:_.isCert)===u.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)):O("",!0)])]}),default:C(()=>{var n;return[a("div",st,[at,a("div",ot,A(t.certNo),1),((n=t.extInfo)==null?void 0:n.isCert)!==u.CERT&&T(t.certType)?(f(),p("div",{key:0,class:"action",onClick:_=>J(c)},[rt,v(se,{name:"right_arrow",class:"icon"})],8,nt)):O("",!0)])]}),_:2},1024),v(w,{title:"\u88AB\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:C(()=>[a("div",{class:"resign",onClick:n=>_e(c)},"\u91CD\u7B7E",8,it)]),default:C(()=>[v(ae,{ref_for:!0,ref:Be,class:"sign"}),a("div",lt,[a("div",ct,"\u7B7E\u540D\u65E5\u671F\uFF1A "+A(N(z)),1),a("div",dt,[_t,(f(!0),p(q,null,Y($.value,(n,_)=>(f(),j(r,{key:_,class:"file",title:`\u300A${n.materialName}\u300B`,content:n.materialContent,type:N(G)(n)},null,8,["title","content","type"]))),128))])])]),_:2},1024)]))),128)),a("div",Bt,[v(i,{type:"primary",class:"submit-btn",onClick:fe},{default:C(()=>[ft]),_:1})])]),v(je)]}),_:1})}}});var ht=re(vt,[["__scopeId","data-v-41315954"]]);export{ht as default};
