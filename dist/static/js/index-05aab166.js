import{d as e,t as a,j as s,i as n,z as t,ao as i,k as l,a1 as o,ar as u,bd as r,c1 as d,ct as m,o as c,c as p,a as w,u as q,d4 as v,V,q as k,b as y,w as L,l as f,F as h,n as g,a6 as b,aE as _,a8 as x,e as R,_ as O,a2 as j,am as C,m as T,cC as $,g as A,h as D,O as I,T as U}from"./index-b7b909b3.js";import{l as E}from"./product-225824c0.js";import{b as F}from"./index-b19915a7.js";import{c as Q}from"./cloneDeep-5d541e55.js";import"./keysIn-131bbce9.js";import"./isObjectLike-a9798079.js";import"./_getTag-0507d0b1.js";import"./debounce-6981b306.js";import"./ProRenderFormWithCard.vue_vue_type_style_index_0_scoped_true_lang-6a9ab8dc.js";import"./phoneVerify-6efdd32d.js";import"./merge-e7788e50.js";/* empty css              */import"./index-b55a66af.js";import"./useDicData-93afb491.js";const S={class:"com-question"},P={class:"question-item"},N={key:0,class:"question-desc"},Y={key:0,class:"question-desc"},z={key:0,class:"child"},B={key:1},M={key:0},W={key:4,class:"question-muti-blank"},G={key:0,class:"literal"},H=e({name:"Question"});var J=O(e({...H,props:{index:null,data:null,isView:{type:Boolean},name:null,modelValue:null},emits:["update:modelValue"],setup(e,{expose:O,emit:j}){const C=e,T=1,$=2,A=3,D=4,I=5,{index:U,data:E,parentAnswer:F}=a(C),Q=s((()=>void 0===C.index?C.data.title:`问题${C.index+1}. ${C.data.title}`)),H=s((()=>{if(v(E.value.questionType,I)){let e=-1;return E.value.optionList[0].value.replaceAll("_____","∝$blank∝").split("∝").map((a=>("$blank"===a&&(e+=1),{type:"$blank"===a?"variable":"literal",value:"$blank"===a?"":a,index:e})))}return[]})),J=n(C.modelValue),K=n();t((()=>C.modelValue),(e=>{J.value=e}),{deep:!0}),t((()=>J.value),(e=>{j("update:modelValue",e)}),{deep:!0,immediate:!0});const X=()=>{const e=[];return K.value&&K.value.length?K.value.forEach((a=>{console.log("child:",a.getData()),e.push(a.getData())})):[]};return O({getData:()=>({...J.value,childAnswerList:X()})}),(a,s)=>{const n=i,t=l("Question",!0),O=o,j=u,U=r,F=d,X=m("dompurify-html");return c(),p("div",S,[w("div",P,[q(E).questionDesc&&q(v)(q(E).questionDescPosition,1)?V((c(),p("div",N,null,512)),[[X,q(E).questionDesc]]):k("",!0),y(_,{title:q(Q)},{default:L((()=>[q(E).questionDesc&&q(v)(q(E).questionDescPosition,2)?V((c(),p("div",Y,null,512)),[[X,q(E).questionDesc]]):k("",!0),q(v)(q(E).questionType,T)||q(v)(q(E).questionType,A)?(c(),f(O,{key:1,name:`${C.name}.answer`,rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请选择"}]},{input:L((()=>[y(j,{modelValue:J.value.answer,"onUpdate:modelValue":s[1]||(s[1]=e=>J.value.answer=e)},{default:L((()=>[(c(!0),p(h,null,g(q(E).optionList,((a,i)=>(c(),p("div",{key:i,class:"option-row"},[y(n,{name:a.code},{default:L((()=>[x(R(a.value),1)])),_:2},1032,["name"]),q(v)(J.value.answer,a.code)?(c(),p("div",z,[(c(!0),p(h,null,g(a.detailList,((a,s)=>(c(),f(t,{key:a.id,ref_for:!0,ref_key:"childRef",ref:K,modelValue:J.value.childAnswerList[s].answerVO,"onUpdate:modelValue":e=>J.value.childAnswerList[s].answerVO=e,name:`${C.name}.childAnswerlist.${s}.answerVO`,data:a,"is-view":e.isView},null,8,["modelValue","onUpdate:modelValue","name","data","is-view"])))),128))])):k("",!0),q(v)(a.optionType,2)&&q(v)(J.value.answer,a.code)?(c(),p("div",B,[y(O,{modelValue:J.value.questionRemark,"onUpdate:modelValue":s[0]||(s[0]=e=>J.value.questionRemark=e),name:`${C.name}.questionRemark`,rows:"2",autosize:"",label:"",type:"textarea",maxlength:"100",placeholder:"请输入告知说明","show-word-limit":!e.isView},null,8,["modelValue","name","show-word-limit"])])):k("",!0)])))),128))])),_:1},8,["modelValue"])])),_:1},8,["name","rules"])):k("",!0),q(E).questionType===$?(c(),f(O,{key:2,name:`${C.name}.answerList`,label:"",rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请选择"}]},{input:L((()=>[y(F,{modelValue:J.value.answerList,"onUpdate:modelValue":s[2]||(s[2]=e=>J.value.answerList=e)},{default:L((()=>[(c(!0),p(h,null,g(q(E).optionList,((a,s)=>{var n;return c(),p("div",{key:s,class:"option-row"},[y(U,{name:s,shape:"square"},{default:L((()=>[x(R(a.value),1)])),_:2},1032,["name"]),q(v)(a.optionType,2)&&(null==(n=J.value.answerList)?void 0:n.indexOf(+a.code))>-1?(c(),p("div",M,[y(O,{modelValue:J.value.questionRemarkList[s],"onUpdate:modelValue":e=>J.value.questionRemarkList[s]=e,name:`${C.name}.questionRemarkList.${s}`,rows:"2",autosize:"",label:"",type:"textarea",maxlength:100,placeholder:"请输入告知说明","show-word-limit":!e.isView},null,8,["modelValue","onUpdate:modelValue","name","show-word-limit"])])):k("",!0)])})),128))])),_:1},8,["modelValue"])])),_:1},8,["name","rules"])):k("",!0),q(E).questionType===D?(c(),f(O,{key:3,modelValue:J.value.answer,"onUpdate:modelValue":s[3]||(s[3]=e=>J.value.answer=e),name:`${C.name}.answer`,placeholder:"请输入",maxlength:100,rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请输入"}]},null,8,["modelValue","name","rules"])):k("",!0),q(E).questionType===I?(c(),p("div",W,[(c(!0),p(h,null,g(q(H),((e,a)=>(c(),p(h,{key:a},["literal"===e.type?(c(),p("span",G,R(e.value),1)):(c(),f(O,{key:1,modelValue:J.value.answerList[e.index],"onUpdate:modelValue":a=>J.value.answerList[e.index]=a,class:"custom-cell",name:`${C.name}.answerList.${e.index}`,placeholder:"请输入",maxlength:"100",rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请输入"}]},null,8,["modelValue","onUpdate:modelValue","name","rules"]))],64)))),128))])):k("",!0)])),_:1},8,["title"])])])}}}),[["__scopeId","data-v-4b450488"]]);const K=e({name:"Questionnaire"}),X=e({...K,props:{data:null,isView:{type:Boolean},params:null},setup(e){const a=e,s=n([{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""}]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""}]},id:"",questionCode:""},{answerVO:{answer:"这里是单项填空的结果",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""}]),t=n([]),i=n(),l=()=>{const e={answerList:[],objectType:a.data.basicInfo.objectType||1,contentType:a.data.basicInfo.questionnaireType,questionnaireId:a.data.basicInfo.id,...a.params,imageList:t.value};var n;i.value.forEach(((s,n)=>{e.answerList.push({answerVO:s.getData(),id:a.data.questions[n].id,questionCode:a.data.questions[n].questionCode})})),console.log("请求参数：",s),(n=e,j({url:"/api/app/insure/insurance/saveMarketerNotices",method:"POST",data:n})).then((e=>{}))},u=n(),r=e=>{console.log("values:",e),l()},d=window.location.origin.indexOf("localhost")>0;return(n,l)=>{const m=$,w=o,v=C;return c(),f(F,{ref_key:"formRef",ref:u,model:q(s),"input-align":"left","scroll-to-error":"","show-error-message":"","is-view":e.isView,onSubmit:r},{default:L((()=>[1===a.data.basicInfo.questionnaireType?(c(),p(h,{key:0},[x("文本问卷")],64)):(c(!0),p(h,{key:1},g(a.data.questions,((a,n)=>(c(),f(J,{ref_for:!0,ref_key:"questionsRef",ref:i,key:a.id,modelValue:q(s)[n].answerVO,"onUpdate:modelValue":e=>q(s)[n].answerVO=e,name:`${n}.answerVO`,data:a,index:n,"is-view":e.isView},null,8,["modelValue","onUpdate:modelValue","name","data","index","is-view"])))),128)),y(_,{title:a.data.imageConfig.name},{default:L((()=>[y(w,{name:"imageList"},{input:L((()=>{var e;return[y(m,{modelValue:q(t),"onUpdate:modelValue":l[0]||(l[0]=e=>T(t)?t.value=e:null),"max-count":(null==(e=a.data.imageConfig)?void 0:e.maxNum)||10},null,8,["modelValue","max-count"])]})),_:1})])),_:1},8,["title"]),d?(c(),f(v,{key:2,round:"",type:"primary",block:"","native-type":"submit"},{default:L((()=>[x(" 提交 ")])),_:1})):k("",!0)])),_:1},8,["model","is-view"])}}}),Z=e({name:"QuestionPreview"}),ee=e({...Z,setup(e){A();const a=D(),{questionnaireId:s,id:t}=a.query,i={objectId:123,noticeType:1,orderNo:"2023083017475048217",tenantId:9991000011},l=n({basicInfo:{questionnaireName:""},questions:[],imageConfig:{showFlag:2,name:"",maxCount:1}});return I((()=>{U.loading("加载中..."),E({questionnaireId:s||t}).then((e=>{var a;const{code:s,data:n}=e;"10000"===s&&n.productQuestionnaireVOList.length>0?(l.value=(e=>{var a;const s=Q(e);return s.questions=e.questions.map((e=>({...e,answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[]}}))),null!=(a=s.imageConfig).images||(a.images=[]),s})(null==(a=n.productQuestionnaireVOList)?void 0:a[0].questionnaireDetailResponseVO),document.title=l.value.basicInfo.title):U.error("获取问卷出错")})).finally((()=>{U.clear()}))})),(e,a)=>(c(),f(X,{data:q(l),params:i},null,8,["data"]))}});export{ee as default};
