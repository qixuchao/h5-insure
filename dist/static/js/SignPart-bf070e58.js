import{d as e,ax as a,ay as s,j as i,k as l,aN as n,E as t,o,c as r,b as d,w as v,a as u,e as c,u as g,n as f,az as m,f as p,v as y,p as h,q as w,ag as S,aG as _,ar as k}from"./index-ecfbfc6d.js";import{S as x}from"./index-0ce4bfa9.js";const E={class:"com-sign-part"},V={class:"people"},b={class:"name"},C={key:0,class:"verify-item"},Y=u("div",{class:"label"},"证件号码",-1),I={class:"no"},P={class:"sign-status"},L=["src"],j={key:1,class:"sign-desc"},B={class:"sign-body"},T={class:"date"},D={class:"file"},N=e({name:"signPart"}),R=e({...N,props:{signString:{default:()=>[]},personalInfo:{default:()=>({})},fileList:{},title:{default:""},showSign:{type:Boolean,default:!1},showVerify:{type:Boolean,default:!1},showShareSign:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["handleVerify","handleSign"],setup(e,{expose:N,emit:R}){const $=a((()=>s((()=>import("./index-c2e28c93.js")),["static/js/index-c2e28c93.js","static/css/index-793d1580.css","static/js/index-ecfbfc6d.js","static/css/index-051cce43.css"]))),M=a((()=>s((()=>import("./index-9dec29f7.js")),["static/js/index-9dec29f7.js","static/css/index-fa4edf2a.css","static/js/index-ecfbfc6d.js","static/css/index-051cce43.css","static/js/theme-94cf7d00.js","static/js/index-a3a6063f.js","static/css/index-bbfdd7ec.css","static/js/utils-6b1044bf.js","static/js/infoCollection-9eb10417.js","static/js/trial-91f90222.js"]))),O=e,A=R,F=i({}),U=i([]);i([]),i({}),i(!0);const q=i(!1),z=i(0),G=e=>`${e}`===S.CERT,H=l((()=>n().format("YYYY-MM-DD"))),J=()=>{var e,a;A("handleVerify",null==(e=F.value)?void 0:e.name,null==(a=F.value)?void 0:a.certNo)},K=()=>{q.value=!1},Q=i(),W=()=>{Q.value&&Q.value.openSign(!0)},X=()=>{O.disabled||Q.value&&Q.value.openSign()},Z=e=>{A("handleSign",e)};return N({validateSign:()=>new Promise(((e,a)=>{var s;(null==(s=U.value)?void 0:s.length)?e(!0):a(new Error(`请先完成${O.title}签名`))})),validateVerify:()=>new Promise(((e,a)=>{var s;(null==(s=O.personalInfo)?void 0:s.isCert)!==m.YES?a(new Error(`请${O.title}完成认证`)):e(!0)}))}),t((()=>O.signString),(()=>{U.value=O.signString}),{immediate:!0,deep:!0}),t((()=>O.personalInfo),(()=>{F.value=O.personalInfo}),{deep:!0,immediate:!0}),(e,a)=>{const s=_,i=k;return o(),r("div",E,[d(i,{title:e.title,class:"card"},{extra:v((()=>{var a,s,i,l;return[u("div",V,[u("div",b,c(null==(a=g(F))?void 0:a.name),1),e.showVerify&&G(null==(s=g(F))?void 0:s.certType)?(o(),r("div",{key:0,class:f(["status",{verified:(null==(i=g(F))?void 0:i.isCert)===g(m).YES}])},c((null==(l=g(F))?void 0:l.isCert)===g(m).YES?"已认证":"待认证"),3)):p("",!0)])]})),default:v((()=>{var a,i,l,n;return[e.showVerify&&(null==(a=g(F))?void 0:a.certNo)?(o(),r("div",C,[Y,u("div",I,c(null==(i=g(F))?void 0:i.certNo),1),(null==(l=g(F))?void 0:l.isCert)!==g(m).YES&&G(null==(n=g(F))?void 0:n.certType)?(o(),r("div",{key:0,class:"action",onClick:J},[y(" 去认证 "),d(s,{name:"right_arrow",class:"icon"})])):p("",!0)])):p("",!0)]})),_:1},8,["title"]),e.showSign?(o(),h(i,{key:0,title:`${e.title}签名`,"show-icon":!1,class:"sign-card","show-line":!1},{extra:v((()=>[u("div",P,[e.disabled?p("",!0):(o(),r("div",{key:0,class:"resign",onClick:W},"重签"))])])),default:v((()=>{var s,i;return[d(x,{ref_key:"signRef",ref:Q,modelValue:g(U),"onUpdate:modelValue":a[0]||(a[0]=e=>w(U)?U.value=e:null),"sign-string":(null==(s=g(F))?void 0:s.name)||"",class:"sign",onSubmitSign:Z},{signImg:v((({data:e})=>[u("div",{class:"sign-board",onClick:X},[e?(o(),r("img",{key:0,src:e,class:"sign-img",alt:""},null,8,L)):(o(),r("span",j,"请签名"))])])),_:1},8,["modelValue","sign-string"]),u("div",B,[u("div",T,"签名日期： "+c(g(H)),1),u("div",D,[(null==(i=e.fileList)?void 0:i.length)?(o(),h(g($),{key:0,"attachment-list":e.fileList,"pre-text":"签名将被用于以下文件：",onPreviewFile:a[1]||(a[1]=e=>(e=>{z.value=e,q.value=!0})(e))},null,8,["attachment-list"])):p("",!0)])])]})),_:1},8,["title"])):p("",!0),g(q)?(o(),h(g(M),{key:1,show:g(q),"onUpdate:show":a[2]||(a[2]=e=>w(q)?q.value=e:null),"content-list":e.fileList,"is-only-view":"","active-index":g(z),text:"关闭",onOnCloseFilePreviewByMask:K},null,8,["show","content-list","active-index"])):p("",!0)])}}});export{R as _};
