import{d as e,j as r,cb as t,bz as s,o as i,m as o,w as l,a as n,b as a,u,a8 as d,_ as c,aE as p,aj as m,r as v,d5 as L,z as f,c as k,p as h,F as C,q as V,cY as I,e as g,as as y,by as b,at as O,cd as S,av as P,aw as R,b_ as T,k as _,f as w,aJ as M,aK as D,i as E,aA as j,O as x,g as A,T as N,au as q,bx as U,n as F,E as H,aD as Y,d6 as $,h as B,d7 as K,d8 as z,az as W,c5 as J,l as X,bu as G,d9 as Q,da as Z,db as ee,dc as re,bl as te,aq as se,ap as ie,bs as oe,dd as le,cu as ne,de as ae,df as ue,aI as de,af as ce,bh as pe,aB as me}from"./index-8ccea0ec.js";import{A as ve}from"./index-7f5a8367.js";import{l as Le}from"./index-828ac02c.js";import{P as fe,_ as ke,u as he}from"./index-4e40a154.js";import"./PolicyInfo-11287dc5.js";import{a as Ce,d as Ve,e as Ie,f as ge}from"./createProposal-683c8b9a.js";import{e as ye,d as be,q as Oe,p as Se}from"./trial-eee9ad28.js";import Pe from"./index-53eb10a8.js";import{_ as Re}from"./index-d680c3b2.js";import{_ as Te}from"./empty-ae586b6c.js";import{a as _e,b as we}from"./format-31cde443.js";import{C as Me}from"./index-92ce2a7f.js";import{R as De}from"./trial-c0526383.js";import{_ as Ee}from"./InsureInfos-c802c7fc.js";import{P as je}from"./index-26608712.js";import{f as xe,a as Ae}from"./findLastIndex-2c59f8d7.js";import{c as Ne}from"./cloneDeep-5f280262.js";import{R as qe,a as Ue}from"./product-7bbf9c44.js";import"./infoCollection-86362f87.js";import"./questionnaire-42dcb602.js";import"./util-c1f91244.js";import"./index-158d5796.js";import"./TrialButton-91a089dc.js";import"./config-98e8d477.js";import"./isNaN-bcccce3b.js";import"./useOrder-99173ff9.js";import"./index-de590a0b.js";const Fe={class:"trial-button"};var He=c(e({__name:"TrialPopup",props:{productCode:{default:""},productName:{default:""}},emits:["finish"],setup(e,{expose:c,emit:v}){const L=e,f=r(null);t(s,{insuredFactorCodes:["hasSocialInsurance","occupationCodeList"],holderFactorCodes:["birthday","gender","hasSocialInsurance","occupationCodeList"]});const k=(e,r)=>{var t,s;const{holder:i,insuredList:o}=e||{},{productList:l,...n}=(null==o?void 0:o[0])||{},a=p(null==r?void 0:r.insuredPremiumList)?null==(s=null==(t=null==r?void 0:r.insuredPremiumList)?void 0:t[0])?void 0:s.productPremiumList.reduce(((e,r)=>(e[r.productCode]=r.riskPremiumDetailVOList.reduce(((e,r)=>(e[r.riskCode]={initialPremium:r.initialPremium,initialAmount:r.initialAmount,unitAmount:r.unitAmount,unitPremium:r.unitPremium},e)),{}),e)),{}):{};return{holder:i,insuredPersonVO:n,insuredProductList:l.map((e=>({productCode:e.productCode,productName:e.productName,occupationCodeList:null==n?void 0:n.occupationCodeList,occupationClass:null==n?void 0:n.occupationClass,riskList:e.riskList.map((r=>{var t,s,i,o,l,n,u,d;return{...r,unitPremium:null==(s=null==(t=null==a?void 0:a[e.productCode])?void 0:t[r.riskCode])?void 0:s.unitPremium,unitAmount:null==(o=null==(i=null==a?void 0:a[e.productCode])?void 0:i[r.riskCode])?void 0:o.unitAmount,initialPremium:null==(n=null==(l=null==a?void 0:a[e.productCode])?void 0:l[r.riskCode])?void 0:n.initialPremium,initialAmount:null==(d=null==(u=null==a?void 0:a[e.productCode])?void 0:u[r.riskCode])?void 0:d.initialAmount}}))})))}};return c({...["open","close"].reduce(((e,r)=>(e[r]=(...e)=>{var t;null==(t=f.value)||t[r](...e)},e)),{}),formatData:k}),(e,r)=>{const t=m;return i(),o(Pe,{ref_key:"trialRef",ref:f,"hide-benefit":"","hide-popup-button":"",title:"选择保障方案",class:"proposal-trial","product-info":{productCode:e.productCode},"tenant-product-detail":{}},{trialBtn:l((e=>{var r,s;return[n("div",Fe,[a(t,{disabled:!(null==(s=null==(r=u(f))?void 0:r.getTrialSuccessFlag)?void 0:s.call(r)),type:"primary",onClick:r=>(({trialData:e,riskPremium:r,personalInfoRef:t})=>v("finish",k({...e,productCode:L.productCode},r)))(e)},{default:l((()=>[d("确定")])),_:2},1032,["disabled","onClick"])])]})),_:1},8,["product-info"])}}}),[["__scopeId","data-v-97b0a8d6"]]);const Ye={class:"com-risk-list-wrapper"},$e=(e=>(P("data-v-7d3c3028"),e=e(),R(),e))((()=>n("div",{class:"popup-title"},"选择附加险",-1))),Be={class:"risk-list"},Ke={class:"cell-title"},ze={class:"title"},We={class:"footer-button"};var Je=c(e({__name:"index",props:{riskList:{default:()=>[]},show:{type:Boolean,default:!1},collocationList:{default:()=>[]},disabled:{default:()=>[]},modelValue:{default:()=>[]}},emits:["finished","close","update:modelValue"],setup(e,{emit:t}){const s=e,c=r([]),p=r([]),P=r([...s.disabled]),R=v({show:s.show,currentChecked:[...s.modelValue]}),T=e=>{var r,t,i;if(P.value.includes(e))return;((e,r)=>{if(!s.collocationList.length)return r?void(R.currentChecked=[]):void R.currentChecked.push(e);let t=R.currentChecked,i=P.value;r?(s.collocationList.forEach((r=>{e===r.riskId&&(2===r.collocationType?t=t.filter((t=>t!==r.collocationRiskId||t!==e)):3===r.collocationType?(t=t.filter((r=>r!==e)),i=i.filter((e=>e!==r.collocationRiskId))):t=t.filter((r=>r!==e)))})),R.currentChecked=t,P.value=i):(s.collocationList.forEach((s=>{e===s.riskId&&(r||(2===s.collocationType?t.push(s.collocationRiskId):3===s.collocationType&&i.push(s.collocationRiskId),t.push(e)))})),R.currentChecked.push(...t),P.value=i)})(e,R.currentChecked.includes(e)),null==(i=null==(t=null==(r=null==c?void 0:c.value)?void 0:r[e])?void 0:t.toggle)||i.call(t)},_=()=>{t("close")},w=()=>{const e=s.riskList.filter((e=>R.currentChecked.includes(e.id)));t("update:modelValue",[...new Set(p.value)]),t("finished",e,P.value),t("close")};return L((()=>{c.value=[]})),f((()=>R.currentChecked),(e=>{p.value=e}),{deep:!0,immediate:!0}),f((()=>s.modelValue),(e=>{p.value=e||[],P.value.push(...e||[])}),{deep:!0,immediate:!0}),(e,r)=>{const t=y,s=b,v=Me,L=O,f=m,M=S;return i(),k("div",Ye,[a(M,{show:u(R).show,"onUpdate:show":r[1]||(r[1]=e=>u(R).show=e),title:"选择附加险","show-footer":"",round:"",position:"bottom",closeable:"",onClose:_},{default:l((()=>[$e,n("div",Be,[a(L,{modelValue:u(p),"onUpdate:modelValue":r[0]||(r[0]=e=>h(p)?p.value=e:null)},{default:l((()=>[a(v,{inset:""},{default:l((()=>[(i(!0),k(C,null,V(e.riskList,(e=>(i(),o(s,{key:e.id,title:e.riskName,disabled:u(P).includes(e.id),onClick:r=>T(e.id)},{"right-icon":l((()=>[a(t,{ref_for:!0,ref:r=>u(c)[e.id]=r,shape:"square",disabled:u(P).includes(e.id),name:e.id,onClick:I((r=>T(e.id)),["stop"])},null,8,["disabled","name","onClick"])])),title:l((()=>[n("div",Ke,[n("div",ze,g(e.riskName),1)])])),_:2},1032,["title","disabled","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])]),n("div",We,[a(f,{type:"primary",disabled:!u(R).currentChecked.length,block:"",onClick:w},{default:l((()=>[d("确认")])),_:1},8,["disabled"])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-7d3c3028"]]);const Xe=e=>(P("data-v-7841f409"),e=e(),R(),e),Ge={class:"com-product-list-wrapper"},Qe={class:"risk-item-wrapper"},Ze={class:"operate-bar"},er=["onClick"],rr=["onClick"],tr={class:"content"},sr={class:"risk-factor"},ir={class:"factor"},or={class:"factor-value"},lr=Xe((()=>n("span",{class:"factor-name"}," 保额(元) ",-1))),nr={class:"factor"},ar={class:"factor-value"},ur=Xe((()=>n("span",{class:"factor-name"}," 保障期间 ",-1))),dr={class:"factor"},cr={class:"factor-value"},pr=Xe((()=>n("span",{class:"factor-name"}," 交费期间 ",-1))),mr={class:"operate-bar-wrap"},vr={class:"risk-premium"},Lr={class:"premium"},fr={class:"operate-bar"},kr=e({name:"ProductList"});var hr=c(e({...kr,props:{productRiskList:{default:()=>[]},productInfo:{default:()=>({})},productData:{default:()=>({})},pickProductPremium:{type:Function,default:()=>{}},productNum:{default:0},errorMsg:{default:""},productIndex:{},currentSelectInsure:{default:0}},emits:["deleteRisk","updateRisk","addRiderRisk"],setup(e,{emit:t}){const s=e,[c,p]=T(),m=r({checkedList:[],disabledList:[],riderRiskList:[],mainRiskData:{},totalPremium:0,currentRiskRecord:{},productRiskList:[]}),v=_((()=>{var e,r;return(null==(r=null==(e=s.productData)?void 0:e.productRiskVoList)?void 0:r[0].riskDetailVOList.filter((e=>1===e.collocationType)))||[]}));_((()=>{var e,r;const t=s.productRiskList.map((e=>e.riskId)),i=((null==(r=null==(e=s.productData)?void 0:e.productRiskVoList)?void 0:r[0].riskDetailVOList)||[]).filter((e=>t.includes(e.id)&&1===e.collocationType));return v.value.length-i.length})),_((()=>e=>{var r,t;const i=(null==(t=null==(r=s.productData)?void 0:r.productRiskVoList)?void 0:t[0].riskDetailVOList.find((r=>r.id!==e)))||{};let o=!1;return o=!!s.productNum||2===i.riskType&&1===i.collocationType,o}));const L=_((()=>{var e,r;return(null==(r=null==(e=s.productData)?void 0:e.productRiskVoList)?void 0:r[0].riskDetailVOList.find((e=>1===e.riskType)))||{}})),h=_((()=>L.value.collocationVOList||[])),I=(e,r)=>{const i=e.map((e=>e.id)).filter((e=>!m.value.disabledList.includes(e)));t("addRiderRisk",i,s.productInfo)};return f((()=>s.productInfo),(e=>{let r=0;(e.riskList||[]).forEach((e=>{r+=e.initialPremium})),m.value.totalPremium=r}),{deep:!0,immediate:!0}),f((()=>s.productRiskList),(e=>{const r=[],t=[],s=[];(e||[]).forEach((e=>{1===e.riskType?r.unshift(e):(t.push(e.riskId),s.push(e.riskId),r.push(e))})),m.value.disabledList=t,m.value.checkedList=s,m.value.productRiskList=r}),{deep:!0,immediate:!0}),(e,r)=>{const L=M,f=D;return i(),k("div",Ge,[(i(!0),k(C,null,V(u(m).productRiskList,(r=>{var o,c;return i(),k("div",{key:r.riskId},[n("div",Qe,[a(L,{"risk-type":r.riskType,title:r.riskName,class:"no-border"},{default:l((()=>[n("div",Ze,[r.riskType===u(De).MAIN_RISK?(i(),k("div",{key:0,class:"add-risk btn",onClick:i=>((e,r)=>{var i;const o=null==(i=s.productData.productPlanInsureVOList)?void 0:i[0].insureProductRiskVOList.find((e=>e.riskCode===r.riskCode));t("addRiderRisk",e,r,o)})(e.productInfo,r)}," +附加险 ",8,er)):w("",!0),n("div",{class:"delete-risk btn",onClick:e=>{t("deleteRisk",r,s.productInfo)}},"删除",8,rr)])])),_:2},1032,["risk-type","title"]),n("div",tr,[n("div",sr,[n("div",ir,[n("span",or,g((null==(o=r.initialAmount)?void 0:o.toLocaleString())||"-"),1),lr]),n("div",nr,[n("span",ar,g(u(_e)(r.coveragePeriod)||"-"),1),ur]),n("div",dr,[n("span",cr,g(u(we)(r.chargePeriod)||"-"),1),pr])]),n("div",mr,[n("div",vr,[d(" 保费:"),n("span",Lr,g(!e.errorMsg&&r.initialPremium?`￥${null==(c=r.initialPremium)?void 0:c.toLocaleString()}`:"-"),1)]),n("div",fr,[a(f,{activated:"",onClick:e=>{t("updateRisk",r,s.productInfo)}},{default:l((()=>[d("修改")])),_:2},1032,["onClick"])])])])])])})),128)),u(c)?(i(),o(Je,{key:0,modelValue:u(m).checkedList,"onUpdate:modelValue":r[0]||(r[0]=e=>u(m).checkedList=e),show:u(c),disabled:u(m).disabledList,"risk-list":u(v),"collocation-list":u(h),onFinished:I,onClose:r[1]||(r[1]=e=>u(p)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):w("",!0),a(fe,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-7841f409"]]);const Cr={class:"popup-container"},Vr={class:"popup-header"},Ir={class:"title"},gr=(e=>(P("data-v-0649c3e5"),e=e(),R(),e))((()=>n("p",{class:"tip"},"已为您筛选符合被保人年龄、性别的附加险",-1))),yr={class:"search"},br={key:0,class:"risk-list"},Or={class:"footer-button"},Sr=e({name:"riskSelect"});var Pr=c(e({...Sr,props:{type:{default:2},show:{type:Boolean,default:!1},title:{default:"添加附加险"},holder:{default:()=>({})},insuredList:{default:()=>[]},mainRisk:{default:()=>({})},selectList:{default:()=>[]},currentProduct:{default:()=>({})},currentRiskData:{default:()=>({})}},emits:["cancel","confirm"],setup(e,{emit:t}){const s=e,c=E(),{insurerCode:p="lianlife"}=c.query,m=r([]),v=r([]),L=r([]),S=r(),P=_((()=>s.show)),R=r({}),T=r([]),M=r([]),D=()=>{t("cancel")},U=()=>{m.value=[]},F=()=>{var e;if(!(null==(e=m.value)?void 0:e.length))return void N(`暂未添加任何${s.type===De.MAIN_RISK?"主":"附加"}险`);const r=xe(s.currentProduct.riskList,(e=>e.riskCode===s.mainRisk.riskCode)),i=Ae(s.currentProduct.riskList,(e=>e.mainRiskCode===s.mainRisk.riskCode));let o=r;-1!==i&&(o=i);const l=[...s.currentProduct.riskList.slice(0,o+1),...M.value,...s.currentProduct.riskList.slice(o+1)],n={holder:s.holder,insuredList:s.insuredList.map((e=>(e.productList=[{...s.currentProduct,riskList:l}],e)))};t("confirm",n)},H=["annuityDrawDate","coveragePeriod","chargePeriod","paymentFrequency"],Y=e=>{s.type===De.RIDER_RISK&&(L.value||[]).forEach((r=>{m.value.includes(e)?e===r.relatedRiskCode?(2===r.collocationType&&m.value.push(r.collocationRiskCode),3===r.collocationType&&(m.value.push(e),m.value=m.value.filter((e=>e!==r.collocationRiskCode)))):e===r.collocationRiskCode&&(2===r.collocationType&&m.value.push(r.relatedRiskCode),3===r.collocationType&&(m.value=m.value.filter((e=>e!==r.relatedRiskCode)))):e===r.relatedRiskCode?(2===r.collocationType&&(m.value=m.value.filter((e=>e!==r.collocationRiskCode))),3===r.collocationType&&(m.value.push(e),m.value=m.value.filter((e=>e!==r.collocationRiskCode)))):e===r.collocationRiskCode&&(2===r.collocationType&&(m.value=m.value.filter((e=>e!==r.relatedRiskCode))),3===r.collocationType&&(m.value=m.value.filter((e=>e!==r.relatedRiskCode))))})),m.value=[...new Set(m.value)]},$=async()=>{const e={insuredList:[],holder:{},mainRiskCode:s.mainRisk.riskCode,insureCode:p,productCategory:"",keyword:S.value,selectRiskCodes:s.selectList},{code:r,data:t}=await Ce(e);"10000"===r&&(v.value=t.riskInfoList,L.value=t.collocationInfoResList)};return f((()=>m.value),j((e=>{const r={};Object.keys(R.value).reduce(((r,t)=>((e||[]).includes(t)&&(r[t]=R.value[t]),r)),r),R.value=r;const t=(e||[]).filter((e=>!Object.keys(R.value).includes(e)));(null==t?void 0:t.length)&&(async e=>{const{code:r,data:t}=await ye({holder:s.holder,insuredList:s.insuredList,calcRiskDefaultFactorVO:{mainRiskInfo:s.mainRisk,riskCodeList:e}},{loading:!0});"10000"===r&&t.reduce(((e,{insureProductRiskVO:r,errorMessage:t,...s})=>(e[s.riskCode]={defaultValue:s,riskDetail:r,errorMessage:t},e)),R.value)})(t)}),1e3),{immediate:!0,deep:!0}),f((()=>R.value),(e=>{M.value=Object.keys(R.value||{}).reduce(((e,r)=>{var t;return(null==(t=R.value[r])?void 0:t.errorMessage)||e.push(R.value[r].defaultValue),e}),[])}),{immediate:!0,deep:!0}),x((()=>{$()})),(e,r)=>{const t=ke,c=y,p=b,L=Me,f=O,_=Re,E=q;return i(),o(E,{show:u(P),"onUpdate:show":r[3]||(r[3]=e=>h(P)?P.value=e:null),class:"popup-risk-select",closeable:!1},{default:l((()=>{var y,b;return[n("div",Cr,[n("div",Vr,[n("span",{class:"clear-all",onClick:U}," 清空选项 "),n("span",Ir,g(e.title),1),n("span",{class:"close",onClick:D},"X")]),gr,n("div",yr,[a(t,{modelValue:u(S),"onUpdate:modelValue":r[0]||(r[0]=e=>h(S)?S.value=e:null),placeholder:"请输入附加险名称",onSearch:$},null,8,["modelValue"])]),(null==(y=u(v))?void 0:y.length)?(i(),k("div",br,[a(f,{modelValue:u(m),"onUpdate:modelValue":r[2]||(r[2]=e=>h(m)?m.value=e:null)},{default:l((()=>[a(L,{inset:""},{default:l((()=>[(i(!0),k(C,null,V(u(v),(({riskCode:t,riskName:n})=>{var d,m,v,L,f;return i(),k(C,{key:t},[a(p,{clickable:"",title:n,onClick:e=>Y(t)},{"right-icon":l((()=>[a(c,{ref_for:!0,ref:r=>u(T)[e.index]=r,name:t,onClick:I((e=>Y(t)),["stop"])},null,8,["name","onClick"])])),_:2},1032,["title","onClick"]),(null==(d=u(R)[t])?void 0:d.riskDetail)?(i(),o(Ee,{key:0,ref_for:!0,ref:"insureInfosRef",class:"insure-part","origin-data":null==(m=u(R)[t])?void 0:m.riskDetail,"default-value":null==(v=u(R)[t])?void 0:v.defaultValue,onTrialChange:r[1]||(r[1]=(r,t)=>(async(e,r,t)=>{var i;if(r){const o=Ne(e);if(delete o.insurancePeriodValueList,delete o.paymentFrequencyList,delete o.paymentPeriodValueList,H.indexOf(r.key)>=0&&`${r.oldValue}`!=`${r.newValue}`){const l={};switch(r.key){case"annuityDrawDate":l.changeType=3;break;case"coveragePeriod":l.changeType=2;break;case"chargePeriod":l.changeType=1;break;case"paymentFrequency":l.changeType=4}const n=[{insureProductRiskVO:s.currentRiskData,insureRiskEditReqVO:s.mainRisk},{insureProductRiskVO:null==(i=R.value[e.riskCode])?void 0:i.riskDetail,insureRiskEditReqVO:{riskId:e.riskId,riskCode:e.riskCode,...o,...l}}],a=s.insuredList.filter((e=>e.birthday))||[];if(!a.length)return!1;await be({calcProductFactorList:[{planCode:"",productCode:t,riskEditVOList:n}],insuredVOList:a,holderVO:s.holder})}}return!0})(r,t,e.productCode))},null,8,["origin-data","default-value"])):w("",!0),(null==(L=u(R)[t])?void 0:L.errorMessage)?(i(),o(fe,{key:1,"error-msg":null==(f=u(R)[t])?void 0:f.errorMessage},null,8,["error-msg"])):w("",!0)],64)})),128))])),_:1})])),_:1},8,["modelValue"])])):(i(),o(_,{key:1,title:`暂无关联${e.type===u(De).MAIN_RISK?"主":"附加"}险、请选择其他险种`},null,8,["title"])),n("div",Or,[a(je,{shadow:!1,disabled:!(null==(b=u(M))?void 0:b.length),onClick:F},{default:l((()=>[A(e.$slots,"default",{},(()=>[d("确定")]),!0)])),_:3},8,["disabled"])])])]})),_:3},8,["show"])}}}),[["__scopeId","data-v-0649c3e5"]]);const Rr=e=>(P("data-v-60460aa9"),e=e(),R(),e),Tr={class:"insurer-list"},_r=["onClick"],wr=Rr((()=>n("span",{class:"insure-name"},"被保人",-1))),Mr={key:0,class:"insure-relate"},Dr={key:1,class:"insure-relate"},Er=["onClick"],jr=Rr((()=>n("div",{class:"gap"},null,-1))),xr=Rr((()=>n("span",null,"+",-1))),Ar=e({name:"InsurerSelect"});var Nr=c(e({...Ar,props:{insurerList:{default:()=>[]},config:{default:()=>{}},canChangeSelect:{type:Boolean,default:()=>!0}},emits:["listChange","currentChange","add","delete","validateTab"],setup(e,{expose:t,emit:s}){const o=e,l=r(),a=r(),c=r({currentSelected:0}),p=r(o.insurerList),m=(e=!1)=>{a.value&&H((()=>{var r;null==(r=l.value[c.value.currentSelected])||r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),0===c.value.currentSelected?a.value.scrollLeft=0:e&&c.value.currentSelected>=3&&(a.value.scrollLeft=a.value.scrollWidth)}))};U((()=>{m(!0)}));const v=e=>{var r;if((null==e?void 0:e.personVO)&&(null==(r=null==e?void 0:e.personVO)?void 0:r.relationToMainInsured)){const r=qe.find((r=>{var t;return r.value===`${null==(t=null==e?void 0:e.personVO)?void 0:t.relationToMainInsured}`}));if(r)return r.label}return"关系"},L=()=>{var e,r,t,s,i;return!(!(null==(r=null==(e=p.value)?void 0:e[c.value.currentSelected])?void 0:r.productList)||(null==(i=null==(s=null==(t=p.value)?void 0:t[c.value.currentSelected])?void 0:s.productList)?void 0:i.length)<=0)},h=()=>{L()?s("validateTab",(()=>{p.value.push({}),c.value.currentSelected=p.value.length-1,s("add",{},p.value.length-1)})):N("请确认信息是否录入完整!")};return f((()=>o.insurerList.length),(()=>{p.value=o.insurerList,m()}),{deep:!0,immediate:!0}),t({updateInsurer:(e,r)=>{}}),(e,r)=>(i(),k("div",Tr,[n("div",{ref_key:"tabsRef",ref:a,class:"list"},[(i(!0),k(C,null,V(u(p),((e,r)=>(i(),k("div",{ref_for:!0,ref_key:"tabRef",ref:l,key:`insure_${r}`,class:F("insure-box "+(r===u(c).currentSelected?"selected":"")),onClick:e=>((e,r)=>{L()?o.canChangeSelect&&s("validateTab",(()=>{c.value.currentSelected=r,s("currentChange",r),m()})):N("请确认信息是否录入完整!")})(0,r)},[wr,0===r?(i(),k("span",Mr,"本人")):(i(),k("span",Dr,g(v(e)),1)),r>0?(i(),k("div",{key:2,class:"delete-btn",onClick:e=>((e,r)=>{e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0,Y.confirm({message:"确定要删除该被保人吗？"}).then((()=>{s("delete",r,(()=>{r<c.value.currentSelected?(c.value.currentSelected-=1,s("currentChange",c.value.currentSelected)):r===c.value.currentSelected&&(c.value.currentSelected=0,s("currentChange",0))}))})).catch((()=>{}))})(e,r)},"×",8,Er)):w("",!0)],10,_r)))),128))],512),n("div",{class:"operate"},[jr,n("div",{class:"add-btn",onClick:h},[xr,d(" 被保人")])])]))}}),[["__scopeId","data-v-60460aa9"]]);const qr=e=>(P("data-v-04793f66"),e=e(),R(),e),Ur={class:"proposal-header"},Fr={key:0,class:"container"},Hr=qr((()=>n("div",{class:"title-tip-icon"},"投保人信息",-1))),Yr=qr((()=>n("span",null,"为TA换个产品",-1))),$r={key:0,class:"operate-bar"},Br={key:0,class:"operate-bar"},Kr={class:"footer-bar"},zr={class:"trial-result"},Wr={class:"result-num"},Jr={class:"trial-operate"},Xr=e({name:"CreateProposal"});var Gr=c(e({...Xr,setup(e){const t=[{name:"保存修改"},{name:"另存为新计划书"}],s=$(),[c,L]=T(),[I,y]=T(),b=r({holder:{},insuredList:[{name:"",gender:"",birthday:"",productList:[]}],proposalName:"",totalPremium:0,relationUserType:2}),O=B(),S=E(),P=he(),R={},{productCode:M,id:x,preview:A}=S.query,q=["age","gender","birthday","hasSocialInsurance","occupationCodeList"];K("LIANLIFE_OCCUPATION");const F=r(null),fe=v({selectedProductCodeList:[],selectedProductList:[],insuredPersonVO:{},insurerList:[],currentProductCode:"",currentProduct:{},holder:{},productList:[],productCollection:{},productErrorMap:{},defaultData:null,currentSelectInsure:0,isLoading:!1,currentMainRisk:()=>({}),currentRiskData:()=>({})}),ke=r(!1),Ce=r(null),ye=r(null),Pe=r(null),_e=(e,r,t)=>e?+e<18?"投保人年龄不得小于18周岁":"":"请输入投保人年龄";_((()=>{var e;return(null==(e=fe.insurerList[fe.currentSelectInsure])?void 0:e.productList)?fe.insurerList[fe.currentSelectInsure].productList.map((e=>e.productCode)).filter((e=>Boolean(e))):[]}));const we=()=>fe.insurerList[fe.currentSelectInsure].productList.map((e=>e.productCode)).filter((e=>Boolean(e))),Me=_((()=>{const{productPlanInsureVOList:e}=fe.productCollection[M]||{},[{insureProductRiskVOList:r=[]}={}]=e||[],{riskInsureLimitVO:t}=(null==r?void 0:r.find((e=>1===e.riskType)))||{};return null==t?void 0:t.sexLimit})),De=_((()=>"-1"!==Me.value&&Me.value?z.filter((e=>Me.value===e.value)):z)),Ee=_((()=>{var e;return(null==(e=fe.productCollection)?void 0:e[fe.currentProductCode])||{}}));_((()=>{var e,r;return(null==(r=null==(e=Ee.value)?void 0:e.productPlanInsureVOList)?void 0:r[0])||{}})),_((()=>{var e,r,t;return null==(t=null==(r=null==(e=Ee.value)?void 0:e.productPlanInsureVOList)?void 0:r[0])?void 0:t.multiInsuredConfigVO}));const je=_((()=>!ke.value||Boolean(Object.values(fe.productErrorMap).join("")))),xe=r(),Ae=_((()=>"1"!=`${A}`)),Ne=_((()=>fe.insurerList.reduce(((e,r)=>+(r.productList.reduce(((e,r)=>+e+ +r.riskList.reduce(((e,r)=>+e+ +(r.initialPremium||0)),0)),0)+ +e)),0))),Fe=e=>{var r,t;const s=[null==(r=ye.value)?void 0:r.validate()];if(0===fe.currentSelectInsure){if(1===fe.insurerList[0].personVO.relationToHolder&&fe.insurerList[0].personVO.age<18||1!==fe.insurerList[0].personVO.relationToHolder&&fe.holder.age<18)return void N("投保人年龄不得小于18周岁");s.push(null==(t=Pe.value)?void 0:t.validate())}Promise.all(s).then((()=>{e()})).catch((e=>{N("请确认信息是否录入完整!")}))},Ye=()=>{const e=fe.insurerList.findIndex((({personVO:e})=>e.relationToMainInsured===+Ue.MATE));return qe.map((r=>r.value===Ue.SELF||r.value===Ue.MATE&&e>=0&&e!==fe.currentSelectInsure?{...r,disabled:!0}:{...r}))},$e=(e,r="")=>{fe.productErrorMap[e]=r},Be=e=>{e.insuredProductList.reduce(((e,r)=>{var t,s;const i=null==(s=null==(t=fe.insurerList)?void 0:t[fe.currentSelectInsure])?void 0:s.productList.findIndex((e=>e.productCode===r.productCode));return-1!==i?e[i]=r:e.push(r),e}),fe.insurerList[fe.currentSelectInsure].productList)},Ke=e=>{var r;console.log("onFinished",e),Object.assign(fe.holder,e.holder),0===fe.currentSelectInsure&&(e.insuredPersonVO.relationToHolder=fe.insurerList[fe.currentSelectInsure].personVO.relationToHolder),fe.insurerList[fe.currentSelectInsure]&&Object.assign(fe.insurerList[fe.currentSelectInsure].personVO,e.insuredPersonVO),Be(e),$e(e.productCode),ke.value=!0,null==(r=F.value)||r.close()},ze=_((()=>{var e;return 1===(null==(e=fe.insurerList[fe.currentSelectInsure].productList)?void 0:e.length)})),We=()=>{P.setInsuredPersonVO(fe.insurerList[fe.currentSelectInsure].personVO),P.setExcludeProduct([]),P.setProposalInfo(b.value),fe.insurerList[fe.currentSelectInsure].productList=[],O.push({path:"/proposalListSelect",query:{isCreateProposal:"1"}})},Je=()=>{var e;null==(e=ye.value)||e.validate().then((()=>{P.setProposalInfo(b.value),P.setExcludeProduct(we()),P.setExcludeMainRiskCode(fe.insurerList[fe.currentSelectInsure].productList.reduce(((e,r)=>e.concat(r.riskList.filter((e=>1===e.riskType)).map((e=>e.riskCode)))),[])),P.setInsuredPersonVO(fe.insurerList[fe.currentSelectInsure].personVO),O.push({path:"/proposalListSelect",query:{isCreateProposal:"1"}})})).catch((e=>{console.log("e",e),N("请确认被保人信息是否录入完整!")}))},Xe=e=>{const r=(e=>(e.insuredList=e.insuredList.map((e=>(e.productList=e.productList.map((e=>(e.riskList=e.riskList.map((e=>({...e,initialPremium:e.unitPremium||e.initialPremium,initialAmount:e.unitAmount||e.initialAmount}))),e))),e))),e))(e);Se(r).then((({code:e,data:t,message:s})=>{var i;e===me&&t?((null==t?void 0:t.errorInfo)&&N(`${null==t?void 0:t.errorInfo}`),p(t.insuredPremiumList)&&Be(null==(i=F.value)?void 0:i.formatData(r,t)),$e(r.productCode),ke.value=!0):$e(r.productCode,s)}))},Ge=e=>{e&&(fe.insurerList[fe.currentSelectInsure].personVO.age=se(new Date).diff(e,"year"))},Qe=e=>{e&&(fe.holder.age=se(new Date).diff(e,"year"))},Ze=e=>{const{value:r}=e;let t={age:30,birthday:se().subtract(30,"year").format("YYYY-MM-DD"),gender:+ie.MALE};[Ue.MATE,Ue.CHILD].includes(r)?t={age:r===Ue.MATE?fe.insurerList[0].personVO.age:0,birthday:r===Ue.MATE?fe.insurerList[0].personVO.birthday:se().subtract(28,"day").format("YYYY-MM-DD"),gender:r===Ue.MATE?1==+fe.insurerList[0].personVO.gender?2:1:+ie.MALE}:Ue.PARENT===r&&(t={age:+fe.insurerList[0].personVO.age+18,birthday:se(fe.insurerList[0].personVO.birthday).subtract(18,"year").format("YYYY-MM-DD"),gender:+ie.MALE}),Object.assign(fe.insurerList[fe.currentSelectInsure].personVO,t)},er=()=>{fe.insurerList[fe.currentSelectInsure].personVO.birthday=""},rr=()=>{if(0===fe.currentSelectInsure){const e=fe.insurerList.findIndex((e=>!(!e||!e.personVO)&&+e.personVO.relationToMainInsured==+Ue.MATE));-1!==e&&(fe.insurerList[e].personVO.gender=1==+fe.insurerList[0].personVO.gender?2:1)}},tr=()=>{fe.holder.birthday=""},sr=e=>{Ve(e).then((({code:e,data:r})=>{var t;"10000"===e&&p(r)&&(xe.value=null==(t=null==r?void 0:r[0])?void 0:t.productClass,r.reduce(((e,r)=>(e[r.productCode]=r,R[r.productCode]=r.productName,e)),fe.productCollection))})).finally((()=>{}))},ir=()=>{if(1==+fe.insurerList[0].personVO.relationToHolder){const{relationToHolder:e,relationToMainInsured:r,productList:t,...s}=fe.insurerList[0].personVO;return x&&(s.id=fe.holder.id),s}return fe.holder},or=e=>0===e&&2==+fe.insurerList[e].personVO.relationToHolder?{...fe.insurerList[e].personVO,relationToHolder:null}:fe.insurerList[e].personVO,lr=async(e,r=!1)=>{if(!p(e))return;const{code:t,data:s}=await Oe({calcProductFactorList:e,...fe.insurerList[fe.currentSelectInsure]&&fe.insurerList[fe.currentSelectInsure].personVO||{}},{isCustomError:!r});if("10000"===t&&s&&s){const{holder:e,insuredList:t}=s,{productList:i,...o}=(t||[])[0]||{},[{riskList:l=[],...n}={}]=i||[],a={...n,riskList:l};r&&(fe.insurerList[fe.currentSelectInsure]&&Object.assign(fe.insurerList[fe.currentSelectInsure].personVO,o,{relationToHolder:1}),Object.assign(fe.holder,e)),t.forEach(((e,r)=>{const{productList:t,...s}=e;0===fe.insurerList.length&&(s.relationToMainInsured||(s.relationToMainInsured=Ue.SELF),fe.insurerList.push({productList:t.map((e=>({...e}))),personVO:s}))}));const u=we().findIndex((e=>e===(null==i?void 0:i[0].productCode)));u>-1?fe.productList[u]=a:fe.productList.push(a),H((()=>{Xe({...s,holder:{...ir()},insuredList:[{...or(fe.currentSelectInsure),productList:i}]})}))}},nr=e=>(fe.insurerList[fe.currentSelectInsure].productList.find((r=>r.productCode===e)),{holder:{...ir()},insuredList:[{...or(fe.currentSelectInsure),productList:fe.insurerList[fe.currentSelectInsure].productList}]}),ar=(e,r)=>{const t=r;Y.confirm({message:"确认删除该险种？"}).then((()=>{1===e.riskType?fe.insurerList[fe.currentSelectInsure].productList=fe.insurerList[fe.currentSelectInsure].productList.filter((e=>e.productCode!==t.productCode)).map((e=>({...e,nanoid:oe()}))):t.riskList=t.riskList.filter((r=>r.riskId!==e.riskId)),$e(t.productCode)}))},ur=(e,r)=>{var t;fe.currentProductCode=r.productCode;const s=Le.exports.cloneDeep(nr(r.productCode));console.log("tempParams",((e,r)=>{var t,s;const i=null==(t=e.insuredList)?void 0:t[0],o=(null==(s=i.productList)?void 0:s.find((e=>e.productCode===r)))||{};return i.occupationClass=null==o?void 0:o.occupationClass,i.occupationCodeList=null==o?void 0:o.occupationCodeList,i.productList=i.productList.filter((e=>e.productCode===r)),e})(s,r.productCode)),fe.defaultData=s,null==(t=F.value)||t.open()},dr=r({}),cr=(e,r,t)=>{dr.value[e.productCode]=e.riskList.map((e=>e.riskCode)),fe.currentProduct=e,fe.currentMainRisk=r,fe.currentRiskData=t,L(!0)},pr=(e,r)=>{dr.value[fe.currentProduct.productCode]=r,Xe(e),L(!1)},mr=()=>{L(!1)},vr=e=>{var r,t,s;if(fe.insurerList.some((e=>0===e.productList.length)))return void N("请先添加产品");const i=[null==(r=Ce.value)?void 0:r.validate(),null==(t=ye.value)?void 0:t.validate()];if(0===fe.currentSelectInsure){if(1===fe.insurerList[0].personVO.relationToHolder&&fe.insurerList[0].personVO.age<18||1!==fe.insurerList[0].personVO.relationToHolder&&fe.holder.age<18)return void N("投保人年龄不得小于18周岁");i.push(null==(s=Pe.value)?void 0:s.validate())}Promise.all(i).then((()=>{fe.isLoading=!0,ge({holder:{...ir()},insuredList:fe.insurerList.map(((e,r)=>({...or(r),productList:e.productList.map((e=>({...e,productName:R[e.productCode]})))}))),proposalName:fe.insuredPersonVO.proposalName,totalPremium:Ne.value,relationUserType:2,id:e}).then((e=>{const{code:r,data:t}=e||{};"10000"===r&&(P.$reset(),O.push({path:"/compositionProposal",query:{id:t,preview:A}}))})).catch((()=>{fe.isLoading=!1}))}))},Lr=()=>{x?y(!0):vr(x)},fr=(e,r)=>{vr(r?void 0:x)},kr=e=>{var r;fe.currentSelectInsure=e,(null==(r=fe.insurerList[e])?void 0:r.productList.length)>0?sr(fe.insurerList[e].productList.map((({productCode:e})=>({productCode:e})))):fe.productCollection={}},Cr=(e,r)=>{if(fe.insurerList.length-1===r){const t=fe.insurerList.findIndex((e=>!(!e||!e.personVO)&&+e.personVO.relationToMainInsured==+Ue.MATE));fe.insurerList[r]={...e,personVO:{age:t<0?fe.insurerList[0].personVO.age:0,birthday:t<0?fe.insurerList[0].personVO.birthday:se().subtract(28,"day").format("YYYY-MM-DD"),relationToMainInsured:t<0?Ue.MATE:Ue.CHILD,gender:t<0?1==+fe.insurerList[0].personVO.gender?2:1:ie.MALE,hasSocialInsurance:le.NO},productList:[]}}fe.currentSelectInsure=r,fe.productCollection={}},Vr=(e,r)=>{fe.insurerList.splice(e,1),null==r||r()};return f([()=>q.map((e=>fe.insurerList[fe.currentSelectInsure]?fe.insurerList[fe.currentSelectInsure].personVO[e]:"")),()=>fe.currentSelectInsure],(([e,r],[t,s])=>{e.join(",")!==t.join(",")&&r===s&&(console.log(r,"被保人条件变动",s),p(Object.keys(fe.productCollection))&&(async e=>{try{const{code:e,data:r,message:t}=await be({calcProductFactorList:fe.insurerList[fe.currentSelectInsure].productList.map((({productCode:e,riskList:r})=>{const{productPlanInsureVOList:t}=fe.productCollection[e]||{},[{insureProductRiskVOList:s}={}]=t||[];return{productCode:e,planCode:"",riskEditVOList:p(r)?r.map((e=>(console.log("riskItem",e,s),{insureProductRiskVO:(null==s?void 0:s.find((r=>r.riskCode===e.riskCode)))||{},insureRiskEditReqVO:e}))):[]}})),insuredVOList:[fe.insurerList[fe.currentSelectInsure].personVO],holderVO:fe.holder},{isCustomError:!0});"10000"===e&&p(r)&&(fe.insurerList[fe.currentSelectInsure].productList.forEach((({productCode:e,riskList:t})=>{const{productRiskDyInsureFactorVOList:s}=r[0]||r.find((r=>r.productCode===e))||{};t.forEach((e=>{const r=s.find((r=>r.riskCode===e.riskCode));Object.assign(e,{...e,...r})}))})),Xe(nr()))}catch(r){console.log("Error",r)}})(we()))}),{deep:!0}),f((()=>fe.selectedProductCodeList),j((e=>{if(p(e)){console.log("选择的产品变动了",e,Le.exports.cloneDeep(fe.insurerList)),lr(e.map((e=>({productCode:e}))));const r=Object.keys(fe.productCollection),t=null==e?void 0:e.filter((e=>!r.includes(e)));p(t)&&sr(null==t?void 0:t.map((e=>({productCode:e}))))}})),{deep:!0}),U((()=>{const{selectedProduct:e,selectedProductList:r}=P.$state;fe.selectedProductList=r,fe.selectedProductCodeList=p(e)?e:[]})),W((()=>{if(J(),M){const e=[{productCode:M}];sr(e),lr(e,!0)}x&&(((e={})=>{Ie(e).then((({code:e,data:r})=>{if("10000"===e&&r){const{insuredList:e,holder:t,proposalName:s}=r||{},[{productList:i,...o}]=e||[];fe.holder=t,fe.insuredPersonVO={...o,proposalName:s};let l=!1;fe.insurerList=e.map(((e,r)=>{const{productList:t,...s}=e,{occupationCodeList:i,occupationClass:o}=(null==t?void 0:t[0])||{};return Object.assign(s,{occupationCodeList:i,occupationClass:o}),0===r&&(s.relationToHolder=s.relationToHolder?1:2,Qe(fe.holder.birthday)),{productList:t.filter((e=>(l||1===e.shelfStatus||(l=!0),1===e.shelfStatus))),personVO:s}})),l&&N("计划书中存在已下架产品，请重新生成计划书"),sr(i.filter((e=>1===e.shelfStatus)).map((e=>({productCode:e.productCode})))),fe.productList=i}}))})({id:x}),ke.value=!0);const e=(x?"编辑":"创建")+"计划书";S.meta.title=e,document.title=e})),(e,r)=>{const p=ne,v=ae,L=ue,f=de,b=ce,O=D,S=m,P=ve,R=X("ProPageWrap"),T=pe;return i(),o(T,{"theme-vars":u(s)},{default:l((()=>[a(R,{class:"page-create-wrapper"},{default:l((()=>{var e,s,m;return[n("div",Ur,[a(p,{ref_key:"formRef",ref:Ce,class:"mb20",model:u(fe).insuredPersonVO},{default:l((()=>[a(u(G),{modelValue:u(fe).insuredPersonVO.proposalName,"onUpdate:modelValue":r[0]||(r[0]=e=>u(fe).insuredPersonVO.proposalName=e),class:"ra20",label:"计划书名称",name:"proposalName",maxlength:20},null,8,["modelValue"])])),_:1},8,["model"]),a(Nr,{config:u(fe),"insurer-list":u(fe).insurerList,"can-change-select":!0,onValidateTab:Fe,onCurrentChange:kr,onAdd:Cr,onDelete:Vr},null,8,["config","insurer-list"])]),u(fe).insurerList[u(fe).currentSelectInsure]?(i(),k("div",Fr,[a(f,{title:"被保人信息",class:"com-pro-form-with-card com-card-body-no-padding insure-containe","show-divider":!1},{default:l((()=>[a(p,{ref_key:"insuredFormRef",ref:ye,model:u(fe).insurerList[u(fe).currentSelectInsure]},{default:l((()=>[a(u(G),{modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.name,"onUpdate:modelValue":r[1]||(r[1]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.name=e),label:"姓名",name:"name",maxlength:20,required:""},null,8,["modelValue"]),0!==u(fe).currentSelectInsure&&u(fe).insurerList[u(fe).currentSelectInsure]?(i(),o(v,{key:0,modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.relationToMainInsured,"onUpdate:modelValue":r[2]||(r[2]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.relationToMainInsured=e),label:"与主被保人关系","is-default-selected":!0,name:"relationToMainInsured",columns:Ye(),required:"",onConfirm:Ze},null,8,["modelValue","columns"])):w("",!0),a(u(G),{modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.age,"onUpdate:modelValue":r[4]||(r[4]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.age=e),class:"age-field-wrap",name:"age",label:"年龄",type:"digit",maxlength:3,required:"",onChange:er},{extra:l((()=>[a(u(Q),{modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.birthday,"onUpdate:modelValue":[r[3]||(r[3]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.birthday=e),Ge],class:"birthday-field-wrap",label:"出生日期",name:"birthday"},null,8,["modelValue"])])),_:1},8,["modelValue"]),a(u(Z),{modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.gender,"onUpdate:modelValue":r[5]||(r[5]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.gender=e),label:"性别",name:"gender",columns:u(De),disabled:+u(fe).insurerList[u(fe).currentSelectInsure].personVO.relationToMainInsured==+u(Ue).MATE,required:"",onChange:rr},null,8,["modelValue","columns","disabled"]),a(u(Z),{modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.hasSocialInsurance,"onUpdate:modelValue":r[6]||(r[6]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.hasSocialInsurance=e),label:"社保",name:"hasSocialInsurance",columns:u(ee),required:""},null,8,["modelValue","columns"]),a(L,{modelValue:u(fe).insurerList[u(fe).currentSelectInsure].personVO.occupationCodeList,"onUpdate:modelValue":r[7]||(r[7]=e=>u(fe).insurerList[u(fe).currentSelectInsure].personVO.occupationCodeList=e),label:"职业",name:"occupationCodeList","dict-code":"LIANLIFE_OCCUPATION",required:""},null,8,["modelValue"])])),_:1},8,["model"]),0===u(fe).currentSelectInsure?(i(),k(C,{key:0},[Hr,a(p,{ref_key:"holderFormRef",ref:Pe,model:u(fe).holder,class:"insure-container"},{default:l((()=>[a(u(Z),{modelValue:u(fe).insurerList[0].personVO.relationToHolder,"onUpdate:modelValue":r[8]||(r[8]=e=>u(fe).insurerList[0].personVO.relationToHolder=e),label:"投被保人是同一人",columns:u(re),required:""},null,8,["modelValue","columns"]),2===u(fe).insurerList[0].personVO.relationToHolder?(i(),k(C,{key:0},[a(u(G),{modelValue:u(fe).holder.name,"onUpdate:modelValue":r[9]||(r[9]=e=>u(fe).holder.name=e),name:"name",label:"姓名",maxlength:20,required:""},null,8,["modelValue"]),a(u(G),{modelValue:u(fe).holder.age,"onUpdate:modelValue":r[11]||(r[11]=e=>u(fe).holder.age=e),class:"age-field-wrap",name:"age",label:"年龄",type:"digit",maxlength:3,required:"",rules:[{required:!0,message:"请输入年龄"},{trigger:"onChange",validator:_e}],onChange:tr},{extra:l((()=>[a(u(Q),{modelValue:u(fe).holder.birthday,"onUpdate:modelValue":[r[10]||(r[10]=e=>u(fe).holder.birthday=e),Qe],class:"birthday-field-wrap",label:"出生日期",name:"birthday"},null,8,["modelValue"])])),_:1},8,["modelValue","rules"]),a(u(Z),{modelValue:u(fe).holder.gender,"onUpdate:modelValue":r[12]||(r[12]=e=>u(fe).holder.gender=e),label:"性别",name:"gender",columns:u(z),required:""},null,8,["modelValue","columns"]),a(u(Z),{modelValue:u(fe).holder.hasSocialInsurance,"onUpdate:modelValue":r[13]||(r[13]=e=>u(fe).holder.hasSocialInsurance=e),label:"社保",name:"hasSocialInsurance",columns:u(ee),required:""},null,8,["modelValue","columns"]),a(L,{modelValue:u(fe).holder.occupationCodeList,"onUpdate:modelValue":r[14]||(r[14]=e=>u(fe).holder.occupationCodeList=e),label:"职业",name:"occupationCodeList","dict-code":"LIANLIFE_OCCUPATION",required:""},null,8,["modelValue"])],64)):w("",!0)])),_:1},8,["model"])],64)):w("",!0)])),_:1}),a(u(te),{ref:"productFormRef",title:"保障计划",class:"product-container"},{cardTitleExtra:l((()=>[u(ze)?(i(),k("div",{key:0,class:"replace-product",onClick:We},[a(b,{name:"refresh",color:"var(--van-primary-color)"}),Yr])):w("",!0)])),default:l((()=>{var e;return[u(fe).insurerList[u(fe).currentSelectInsure].productList.length>0?(i(!0),k(C,{key:0},V(u(fe).insurerList[u(fe).currentSelectInsure].productList,((e,r)=>(i(),o(f,{key:`${e.nanoid}_${r}_${e.productCode}`,class:"product-item-card","show-line":!1,"show-divider":!1},{default:l((()=>{var t;return[a(hr,{"product-risk-list":e.riskList,"product-info":e,"product-num":(null==(t=u(fe).insurerList[u(fe).currentSelectInsure].productList)?void 0:t.length)-1,"product-data":u(fe).productCollection[e.productCode],"error-msg":u(fe).productErrorMap[e.productCode],"product-index":r,"current-select-insure":u(fe).currentSelectInsure,onUpdateRisk:ur,onDeleteRisk:ar,onAddRiderRisk:cr},null,8,["product-risk-list","product-info","product-num","product-data","error-msg","product-index","current-select-insure"])]})),_:2},1024)))),128)):(i(),k(C,{key:1},[u(Ae)?(i(),k("div",$r,[(null==(e=u(fe).insurerList[u(fe).currentSelectInsure].productList)?void 0:e.length)<=0?(i(),o(Re,{key:0,"empty-img":u(Te),title:"该成员还未配置产品，去添加吧！","empty-class":"empty-select"},null,8,["empty-img"])):w("",!0),a(O,{activated:"",round:34,onClick:Je},{default:l((()=>[d("+新增主险")])),_:1})])):w("",!0)],64))]})),_:1},512),u(Ae)&&4===u(xe)&&u(fe).insurerList[u(fe).currentSelectInsure].productList.length>0?(i(),k("div",Br,[a(O,{activated:"",round:34,onClick:Je},{default:l((()=>[d("+新增主险")])),_:1})])):w("",!0)])):w("",!0),n("div",Kr,[n("span",zr,[d("总保费"),n("span",Wr,g(u(je)?"-":`￥${null==(e=u(Ne))?void 0:e.toLocaleString()}`),1)]),n("div",Jr,[a(S,{disabled:u(je)||u(fe).isLoading,loading:u(fe).isLoading,"loading-type":"spinner",type:"primary",onClick:Lr},{default:l((()=>[d("保存并预览")])),_:1},8,["disabled","loading"])])]),u(c)?(i(),o(Pr,{key:1,show:u(c),holder:u(fe).holder,"insured-list":[null==(s=u(fe).insurerList[u(fe).currentSelectInsure])?void 0:s.personVO],"main-risk":u(fe).currentMainRisk,"current-risk-data":u(fe).currentRiskData,"current-product":u(fe).currentProduct,"select-list":u(dr)[u(fe).currentProduct.productCode],onCancel:mr,onConfirm:pr},null,8,["show","holder","insured-list","main-risk","current-risk-data","current-product","select-list"])):w("",!0),a(P,{show:u(I),"onUpdate:show":r[15]||(r[15]=e=>h(I)?I.value=e:null),actions:t,"cancel-text":"取消","close-on-click-action":"",onCancel:r[16]||(r[16]=e=>u(y)(!1)),onSelect:fr},null,8,["show"]),a(He,{ref_key:"trialPopupRef",ref:F,"data-source":{[u(Ee).productCode]:u(Ee)},"product-code":u(fe).currentProductCode,"default-data":null==(m=u(fe).defaultData)?void 0:m[u(fe).currentSelectInsure],onFinish:Ke},null,8,["data-source","product-code","default-data"])]})),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-04793f66"]]);export{Gr as default};
