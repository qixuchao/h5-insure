import{v as s,d as t,j as a,x as e,r as n,y as i,z as o,A as u,b as l,B as c,C as r,L as d,D as h,E as g,G as m,H as p}from"./index-8ccea0ec.js";const[v,f,x]=s("pull-refresh"),D=["pulling","loosing","success"];const T=p(t({name:v,props:{disabled:Boolean,modelValue:Boolean,headHeight:c(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:r,successDuration:c(500),animationDuration:c(300)},emits:["change","refresh","update:modelValue"],setup(s,{emit:t,slots:c}){let r;const p=a(),v=a(),T=e(p),H=n({status:"normal",distance:0,duration:0}),V=i(),S=()=>{if(50!==s.headHeight)return{height:`${s.headHeight}px`}},$=()=>"loading"!==H.status&&"success"!==H.status&&!s.disabled,b=(a,e)=>{const n=+(s.pullDistance||s.headHeight);H.distance=a,H.status=e?"loading":0===a?"normal":a<n?"pulling":"loosing",t("change",{status:H.status,distance:a})},y=()=>{const{status:t}=H;return"normal"===t?"":s[`${t}Text`]||x(t)},B=()=>{const{status:s,distance:t}=H;if(c[s])return c[s]({distance:t});const a=[];return D.includes(s)&&a.push(l("div",{class:f("text")},[y()])),"loading"===s&&a.push(l(d,{class:f("loading")},{default:y})),a},j=s=>{r=0===m(T.value),r&&(H.duration=0,V.start(s))},P=s=>{$()&&j(s)},Y=()=>{r&&V.deltaY.value&&$()&&(H.duration=+s.animationDuration,"loosing"===H.status?(b(+s.headHeight,!0),t("update:modelValue",!0),g((()=>t("refresh")))):b(0))};return o((()=>s.modelValue),(t=>{H.duration=+s.animationDuration,t?b(+s.headHeight,!0):c.success||s.successText?(H.status="success",setTimeout((()=>{b(0)}),+s.successDuration)):b(0,!1)})),u("touchmove",(t=>{if($()){r||j(t);const{deltaY:a}=V;V.move(t),r&&a.value>=0&&V.isVertical()&&(h(t),b((t=>{const a=+(s.pullDistance||s.headHeight);return t>a&&(t=t<2*a?a+(t-a)/2:1.5*a+(t-2*a)/4),Math.round(t)})(a.value)))}}),{target:v}),()=>{var s;const t={transitionDuration:`${H.duration}ms`,transform:H.distance?`translate3d(0,${H.distance}px, 0)`:""};return l("div",{ref:p,class:f()},[l("div",{ref:v,class:f("track"),style:t,onTouchstartPassive:P,onTouchend:Y,onTouchcancel:Y},[l("div",{class:f("head"),style:S()},[B()]),null==(s=c.default)?void 0:s.call(c)])])}}}));export{T as P};
