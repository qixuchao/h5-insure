import{x as e,d as a,j as o,ci as t,dn as s,M as l,D as r,C as d,b as c,co as i,d2 as n,bS as u,J as p,X as v,dp as m,dq as f,dr as h,cn as g,k as C,ds as y,a0 as k,dt as b,bt as P,t as L,r as x,o as _,c as w,a as I,u as S,e as V,F as j,s as M,g as $,_ as q,I as O,l as B,du as U,az as A,n as F,f as N,p as R,w as T,dv as z,q as D,a8 as E,cc as W,aE as J,aj as X,cf as Z,av as G,aw as H,A as K,cZ as Q,as as Y,by as ee,at as ae,h as oe,i as te,d7 as se,b$ as le,m as re,bW as de,T as ce,bh as ie}from"./index-c752b76c.js";import{P as ne}from"./index-3f24ea17.js";import{L as ue}from"./index-0f55e55e.js";import{P as pe,u as ve,_ as me}from"./index-b1f7bdb5.js";import{_ as fe}from"./index-381de707.js";import{_ as he}from"./empty-ae586b6c.js";import{q as ge,a as Ce}from"./proposalList-bbcdd5be.js";import{P as ye}from"./index-d16951e4.js";import{C as ke}from"./index-479de092.js";import{q as be}from"./trial-8fff5f38.js";import"./index-fd91f219.js";const[Pe,Le]=e("tabbar"),xe={route:Boolean,fixed:l,border:l,zIndex:r,placeholder:Boolean,activeColor:String,beforeChange:Function,inactiveColor:String,modelValue:d(0),safeAreaInsetBottom:{type:Boolean,default:null}},_e=Symbol(Pe);const we=p(a({name:Pe,props:xe,emits:["change","update:modelValue"],setup(e,{emit:a,slots:l}){const r=o(),{linkChildren:d}=t(_e),p=s(r,Le),v=()=>{var a;return null!=(a=e.safeAreaInsetBottom)?a:e.fixed},m=()=>{var a;const{fixed:o,zIndex:t,border:s}=e;return c("div",{ref:r,role:"tablist",style:i(t),class:[Le({fixed:o}),{[n]:s,"van-safe-area-bottom":v()}]},[null==(a=l.default)?void 0:a.call(l)])};return d({props:e,setActive:(o,t)=>{u(e.beforeChange,{args:[o],done(){a("update:modelValue",o),a("change",o),t()}})}}),()=>e.fixed&&e.placeholder?p(m):m()}})),[Ie,Se]=e("tabbar-item");const Ve=p(a({name:Ie,props:v({},m,{dot:Boolean,icon:String,name:r,badge:r,badgeProps:Object,iconPrefix:String}),emits:["click"],setup(e,{emit:a,slots:o}){const t=f(),s=h().proxy,{parent:l,index:r}=g(_e);if(!l)return;const d=C((()=>{var a;const{route:o,modelValue:t}=l.props;if(o&&"$route"in s){const{$route:a}=s,{to:o}=e,t=b(o)?o:{path:o};return!!a.matched.find((e=>{const a="path"in t&&t.path===e.path,o="name"in t&&t.name===e.name;return a||o}))}return(null!=(a=e.name)?a:r.value)===t})),i=o=>{var s;d.value||l.setActive(null!=(s=e.name)?s:r.value,t),a("click",o)},n=()=>o.icon?o.icon({active:d.value}):e.icon?c(P,{name:e.icon,classPrefix:e.iconPrefix},null):void 0;return()=>{var a;const{dot:t,badge:s}=e,{activeColor:r,inactiveColor:u}=l.props,p=d.value?r:u;return c("div",{role:"tab",class:Se({active:d.value}),style:{color:p},tabindex:0,"aria-selected":d.value,onClick:i},[c(y,k({dot:t,class:Se("icon"),content:s},e.badgeProps),{default:n}),c("div",{class:Se("text")},[null==(a=o.default)?void 0:a.call(o,{active:d.value})])])}}}));const je={class:"com-product-item"},Me={class:"content-wrap"},$e={class:"product-image"},qe={class:"product-info"},Oe={class:"title"},Be={class:"description"},Ue={class:"tags"};var Ae=q(a({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const a=e,{productInfo:o}=L(a),t=x({checked:!1});return L(t),(e,a)=>{var t,s,l,r,d;const i=O;return _(),w("div",je,[I("div",Me,[I("div",$e,[c(i,{src:(null==(t=S(o).showConfig)?void 0:t.fileThumbnailUrl)||(null==(s=S(o).showConfig)?void 0:s.fileUrl)},null,8,["src"])]),I("div",qe,[I("p",Oe,V(null==(l=S(o).showConfig)?void 0:l.title),1),I("p",Be,V(null==(r=S(o).showConfig)?void 0:r.text),1),I("p",Ue,[(_(!0),w(j,null,M(null==(d=S(o).showConfig)?void 0:d.tags,((e,a)=>(_(),w("span",{key:a,class:"tag"},V(e),1)))),128))])]),$(e.$slots,"checkedProduct",{},void 0,!0)]),c(pe,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-002f53ee"]]);const Fe=["xlink:href"],Ne=a({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const a=e,o=C((()=>`#icon-${a.name}`)),t=C((()=>a.name?`svg-icon icon-${a.name}`:"svg-icon"));return(a,s)=>(_(),w("svg",k({class:S(t)},a.$attrs,{style:{color:e.color}}),[I("use",{"xlink:href":S(o)},null,8,Fe)],16))}});const Re=e=>(G("data-v-88e3365a"),e=e(),H(),e),Te={class:"com-tab-filter"},ze={class:"article-mid"},De={class:"article-tag"},Ee=["onClick"],We=Re((()=>I("span",null,null,-1))),Je={class:"popup-inner"},Xe=Re((()=>I("div",{class:"popup-title"},"保险公司",-1))),Ze={class:"footer-button"};var Ge=q(a({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:a}){const t=e,{isPopShow:s,openPop:l,closePop:r}=function(e=!1){const a=o(e);return{isPopShow:a,openPop:e=>{e instanceof Function&&e(),a.value=!0},closePop:e=>{a.value=!1,e instanceof Function&&e()}}}(!1),d=x({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:n}=L(d),u=o(""),p=()=>{n.value=[]},v=()=>{var e;const{productCategoryId:o}=(null==(e=d.productCategoryList)?void 0:e[u.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:o}),r()};B((()=>{t.filter&&U().then((e=>{const{code:a,data:o}=e;"10000"===a&&(i.value=null==o?void 0:o.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),A((()=>{ge().then((e=>{const{code:a,data:o}=e||{};"10000"===a&&J(o)&&(d.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...o])}))}));const m=o();return B((()=>{m.value=document.querySelector(".page-proposal")})),(o,t)=>{const f=X,h=Z;return _(),w("div",Te,[I("div",ze,[I("div",De,[(_(!0),w(j,null,M(S(d).productCategoryList,((e,o)=>(_(),w("div",{key:o,class:F(["tag-item",{checked:S(u)==o}]),onClick:t=>((e,o)=>{var t;u.value=o;const{productCategoryId:s}=(null==(t=d.productCategoryList)?void 0:t[u.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:s})})(null==e||e.productCategoryId,o)},[I("div",{class:F(["tag-out",{checked:S(u)==o}])},[I("div",{class:F(["tag-item-text",{checked:S(u)==o}])},V(e.productCategoryName),3)],2)],10,Ee)))),128))]),e.filter?(_(),w("div",{key:0,class:"filter",onClick:t[0]||(t[0]=(...e)=>S(l)&&S(l)(...e))},[We,I("div",{class:F(["text",{"has-select-condition":S(n).length>0}])},"筛选",2),c(Ne,{name:"filter"})])):N("",!0),S(m)?(_(),R(h,{key:1,show:S(s),position:"right","close-on-click-overlay":"",class:"proposal-list-filter-popup-wrap",style:W(e.popupStyle),onClickOverlay:S(r)},{default:T((()=>[I("div",Je,[Xe,c(z,{modelValue:S(n),"onUpdate:modelValue":t[1]||(t[1]=e=>D(n)?n.value=e:null),options:S(i)},null,8,["modelValue","options"])]),I("div",Ze,[c(f,{plain:"",type:"primary",onClick:p},{default:T((()=>[E("重置")])),_:1}),c(f,{type:"primary",onClick:v},{default:T((()=>[E("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])):N("",!0)])])}}}),[["__scopeId","data-v-88e3365a"]]);const He={class:"com-trial-product-wrapper"},Ke={class:"container"},Qe=(e=>(G("data-v-49f70a68"),e=e(),H(),e))((()=>I("span",{class:"title"}," 已选产品 ",-1))),Ye={class:"popup-body"},ea={class:"cell-title"},aa={class:"title"},oa=a({name:"TrialProductPopup"});var ta=q(a({...oa,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:a}){const t=e,s=o([]),l=o([]),r=o({isShow:t.isShow}),d=()=>{a("close")},i=()=>{l.value=[],a("checked",[])},n=e=>{var o,t,r;null==(r=null==(t=null==(o=null==s?void 0:s.value)?void 0:o[e])?void 0:t.toggle)||r.call(t),a("checked",l.value)};return K((()=>t.isShow),(e=>{r.value.isShow=e})),K(l,((e=[])=>{a("update:modalValue",e)}),{deep:!0,immediate:!0}),K((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(e,a)=>{const o=Y,t=ee,u=ke,p=ae,v=Z;return _(),w("div",He,[c(v,{show:S(r).isShow,"onUpdate:show":a[1]||(a[1]=e=>S(r).isShow=e),position:"bottom",onClose:d},{default:T((()=>[I("div",Ke,[I("div",{class:"popup-header"},[I("span",{class:"clear-all",onClick:i}," 清空选项 "),Qe,I("span",{class:"close",onClick:d})]),I("div",Ye,[c(p,{modelValue:S(l),"onUpdate:modelValue":a[0]||(a[0]=e=>D(l)?l.value=e:null)},{default:T((()=>[c(u,{inset:""},{default:T((()=>[(_(!0),w(j,null,M(e.proposalList,(e=>(_(),R(t,{key:e.productCode,title:e.productName,onClick:a=>n(e.productCode)},{"right-icon":T((()=>{var a;return[c(o,{ref_for:!0,ref:a=>S(s)[e.productCode]=a,shape:"square","model-value":null==(a=S(l))?void 0:a.includes(e.productCode),name:e.productCode,onClick:Q((a=>n(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:T((()=>[I("div",ea,[I("div",aa,V(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const sa={class:"page-proposal-list"},la={class:"check-button"},ra={key:1,class:"van-sticky"},da={class:"add-plan"},ca={class:"has-select-product"},ia=(e=>(G("data-v-a3bf660a"),e=e(),H(),e))((()=>I("span",{class:"icon"},null,-1))),na=a({name:"ProposalList"});var ua=q(a({...na,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const a=ve(),t=oe(),s=te(),{isCreateProposal:l,productClass:r}=s.query,d=se(),i=x({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],excludeMainRiskCode:[],firstLoading:!0}),{searchValue:n,tagLists:u,isOpen:p,loading:v,finished:m,refreshing:f,productList:h,selectProduct:g,insurerCodeList:y,showCategory:k,productTotal:b,showFooter:P}=L(i);le();const[$,q]=le(),O=o(+(r||1)),B=C((()=>{const e=a.$state.insuredPersonVO||{};return Object.keys(e).length?[e]:[]})),U=()=>{const{excludeProductCodeList:e}=i;i.firstLoading&&ce.loading("加载中..."),Ce({productName:n.value,insurerCodeList:y.value,productClass:O.value,showCategory:k.value,selectProductCodes:Array.isArray(e)?e:[],selectRiskCodes:i.excludeMainRiskCode||[],insuredList:B.value,holder:a.$state.holder,pageNum:1,pageSize:999}).then((e=>{const{code:a,data:o,total:t}=e;"10000"===a&&(h.value=o,b.value=t)})).finally((()=>{ce.clear(),i.firstLoading=!1}))},F=e=>{U()},z=e=>{const{selectInsureCode:a,selectCategory:o}=e;y.value=a,k.value=o,U()},W=()=>{f.value&&(h.value=[],f.value=!1),U(),v.value=!1,b.value===h.value.length&&(m.value=!0)},J=()=>{t.push({path:"historyProposalList"})};C((()=>{var e;const{birthday:o,gender:t}=(null==(e=a.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:o,gender:t}}));const Z=C((()=>h.value.length>0)),G=({productCode:e})=>l?(i.productCode=e,i.selectProduct.includes(e)?(i.selectProduct=i.selectProduct.filter((a=>a!==e)),!1):void(async(e,o)=>{const{code:t,data:s,message:l}=await be({...a.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===t?(i.errorMsgMap[e]="","function"==typeof o&&o(!0)):i.errorMsgMap[e]=l})(e,(()=>{i.selectProduct.push(e)}))):(t.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),H=e=>{i.selectProduct=e,i.selectedProductList=i.selectedProductList.filter((a=>e.includes(a.productCode)))},K=()=>{const e=i.proposalList.filter((e=>i.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));a.setTrialData(e),a.setSelectedProduct(i.selectProduct),a.setSelectedProductList(i.selectedProductList),t.back()},Q=()=>{m.value=!0,v.value=!0,W()};return A((()=>{i.excludeProductCodeList=a.$state.excludeProduct,i.excludeMainRiskCode=a.$state.excludeMainRiskCode})),(e,a)=>{const o=Ve,t=we,s=me,u=Y,p=ue,g=ne,C=X,y=re("ProPageWrap"),k=ie;return _(),R(k,{"theme-vars":S(d)},{default:T((()=>[c(y,{class:"page-proposal"},{default:T((()=>[c(s,{modelValue:S(n),"onUpdate:modelValue":a[1]||(a[1]=e=>D(n)?n.value=e:null),placeholder:"请输入计划书名称",onSearch:F},{default:T((()=>[c(Ge,{"filter-class":"filter-area",onOnSelectInsure:z}),c(t,{modelValue:S(O),"onUpdate:modelValue":a[0]||(a[0]=e=>D(O)?O.value=e:null),disabled:"","active-color":"var(--van-primary-color)","inactive-color":"black",fixed:!1,"before-change":()=>!S(r),onChange:U},{default:T((()=>[c(o,{name:1},{default:T((()=>[E("非组合计划书")])),_:1}),c(o,{name:4},{default:T((()=>[E("组合计划书")])),_:1})])),_:1},8,["modelValue","before-change"])])),_:1},8,["modelValue"]),S(Z)||S(i).firstLoading?N("",!0):(_(),R(fe,{key:0,"empty-img":S(he),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),I("div",sa,[c(g,{modelValue:S(f),"onUpdate:modelValue":a[3]||(a[3]=e=>D(f)?f.value=e:null),onRefresh:Q},{default:T((()=>[c(p,{loading:S(v),"onUpdate:loading":a[2]||(a[2]=e=>D(v)?v.value=e:null),finished:S(m),"finished-text":S(Z)?"- 已经到底了哦 -":"",onLoad:W},{default:T((()=>[(_(!0),w(j,null,M(S(h),(e=>(_(),R(Ae,{key:e.id,"product-info":e,"error-msg":S(i).errorMsgMap[e.productCode],onClick:a=>G(e)},de({_:2},[S(l)?{name:"checkedProduct",fn:T((()=>[I("div",la,[(_(),R(u,{key:e.id,name:e.productCode,"model-value":S(i).selectProduct.includes(e.productCode),shape:"square",onChange:a=>((e,a)=>{e?i.selectedProductList.push(a):i.selectedProductList=i.selectedProductList.filter((e=>e.productCode!==a.productCode))})(a,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),S(l)&&S(P)?(_(),w("div",ra,[I("div",da,[I("p",{class:"has-select",onClick:a[4]||(a[4]=e=>S(q)(!S($)))},[E(" 已选"),I("span",ca,V(S(i).selectProduct.length),1),E("款产品 "),ia]),c(C,{type:"primary",disabled:!S(i).selectProduct.length,onClick:K},{default:T((()=>[E("添加到计划书")])),_:1},8,["disabled"])])])):N("",!0),c(ta,{"modal-value":S(i).selectProduct,"proposal-list":S(i).selectedProductList,"is-show":S($),onClose:a[5]||(a[5]=e=>S(q)(!1)),onChecked:H},null,8,["modal-value","proposal-list","is-show"])])),_:1}),S(l)?N("",!0):(_(),R(ye,{key:0,"button-image":S("/static/png/lishijihuashu-b6958e78.png"),onClick:J},null,8,["button-image"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-a3bf660a"]]);export{ua as default};
