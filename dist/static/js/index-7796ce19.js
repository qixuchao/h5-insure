var Fe=Object.defineProperty,Te=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var ne=(e,n,d)=>n in e?Fe(e,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[n]=d,v=(e,n)=>{for(var d in n||(n={}))Ae.call(n,d)&&ne(e,d,n[d]);if(oe)for(var d of oe(n))Be.call(n,d)&&ne(e,d,n[d]);return e},I=(e,n)=>Te(e,_e(n));import{g as ie,E as g,_ as re,y as pe,j as s,n as H,k as E,A as m,t as f,m as D,p as y,a4 as ce,a5 as me,z as S,C as K,O as Se,ak as he,h as Ve,r as w,G as Ne,F as Le,T as se,L as Oe,J as xe}from"./vendor-96e68f0e.js";import{q as we}from"./index-fbbc79b7.js";import{_ as ve,Y as ye,h as W,T as G,U as Ge,m as We,V as qe,W as Me,w as Pe,X as U,l as z,r as de,L as je,M as k,Q as _,n as He,P as Ke}from"./index-d89e7f03.js";import{c as q,a as $e}from"./order-ad7bcd6c.js";import{u as Ue}from"./useDicData-dcf8935a.js";import{P as ze}from"./index-328f0e88.js";import{_ as Je}from"./index-751c1829.js";var Q=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(Q||{});const Z=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];q(Z);var X=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(X||{});const Ee=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];q(Ee);var B=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(B||{});const fe=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];q(fe);var A=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(A||{});const Qe=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];q(fe);var be=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(be||{});const Ie=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];q(Ie);const Ze=e=>(ce("data-v-c2f6ec68"),e=e(),me(),e),Xe={class:"com-bank-card-info"},Ye=Ze(()=>S("span",{class:"field-title"},[K("\u94F6\u884C\u5361\u7167\u7247 "),S("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),ea=ie({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:n}){const d=e,M=Ue("BANK"),p=g({bankCardType:X.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),F=r=>d.factor&&d.factor[r]&&d.factor[r].isDisplay===ye.YES,P=r=>r&&r.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247",O=r=>{qe({ossKey:[r],imageType:Me.BANK_CARD}).then(i=>{const{data:u,code:t}=i;t==="10000"&&u&&u.bankCardOcrVO&&(p.value.bankCardNo=u.bankCardOcrVO.bankNo)})};re(()=>d.modelValue,r=>{p.value=r},{immediate:!0}),re(p,r=>{n("update:modelValue",r)});const N=pe(()=>M.value.map(r=>({label:r.name,value:r.code})));return(r,i)=>(s(),H("div",Xe,[F("cardType")?(s(),E(W,{key:0,modelValue:p.value.bankCardType,"onUpdate:modelValue":i[0]||(i[0]=u=>p.value.bankCardType=u),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":m(Ee),"is-view":""},null,8,["modelValue","data-source"])):f("",!0),F("bankCardNumber")?(s(),E(G,{key:1,modelValue:p.value.bankCardNo,"onUpdate:modelValue":i[1]||(i[1]=u=>p.value.bankCardNo=u),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):f("",!0),F("cardHolder")?(s(),E(G,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):f("",!0),F("bank")?(s(),E(W,{key:3,modelValue:p.value.payBank,"onUpdate:modelValue":i[2]||(i[2]=u=>p.value.payBank=u),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":m(N),required:""},null,8,["modelValue","data-source"])):f("",!0),F("bankCardAttachment")?(s(),E(G,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:P}]},{label:D(()=>[Ye]),input:D(()=>[y(We,{modelValue:p.value.images,"onUpdate:modelValue":i[3]||(i[3]=u=>p.value.images=u),"max-count":2,"upload-type":m(Ge).BANK_CARD,onOnUploadFinished:O},null,8,["modelValue","upload-type"])]),_:1},8,["rules"])):f("",!0),F("bankPreMobile")?(s(),E(G,{key:5,modelValue:p.value.mobile,"onUpdate:modelValue":i[4]||(i[4]=u=>p.value.mobile=u),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):f("",!0)]))}});var J=ve(ea,[["__scopeId","data-v-c2f6ec68"]]),aa="/static/assets/bank.588e555f.pdf";const ua=e=>(ce("data-v-50f6f221"),e=e(),me(),e),la={class:"page-bank-card"},ta={class:"reprise-card-list"},oa=["onClick"],na={class:"agree"},ra=K(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),sa={class:"footer-button footer"},da=ua(()=>S("div",{class:"text"},"\u5237\u65B0",-1)),ia=K("\u5206\u4EAB"),pa=K("\u4E0B\u4E00\u6B65"),ca=ie({setup(e){const n=Se(),d=he(),{orderNo:M="2022072710380711215",agentCode:p="D1234567-1",tenantId:F="9991000007",templateId:P=1,isShare:O}=n.query,N={bankCardType:X.DEBIT};let r={};const i=g(""),u=g({payMethod:Q.REAL_TIME,bankData:I(v({},N),{imagesId:[],images:[]})}),t=g({payMethod:Q.REAL_TIME,expiryMethod:be.AUTOMATIC_PADDING,bankData:I(v({},N),{imagesId:[],images:[]}),payInfoType:A.FIRST_SAME}),C=g({bankData:I(v({},N),{imagesId:[],images:[]})}),L=g(A.FIRST_SAME),T=g({}),$=g(!1),Y=g(),ee=g(),ae=g(),De=b=>{L.value=b},j=(b,l)=>(console.log("factor",T.value),T.value&&T.value[l]&&T.value[l][b]&&T.value[l][b].isDisplay===ye.YES),ke=()=>{de({orderNo:M,saleUserId:p,tenantId:F}).then(b=>{var c,a,x;const{code:l,data:h}=b;l==="10000"&&(h.orderStatus!==$e.PENDING?je("paymentResult",n.query):Promise.all([(c=Y.value)==null?void 0:c.validate(),(a=ee.value)==null?void 0:a.validate(),(x=ae.value)==null?void 0:x.validate()]).then(R=>{if(!$.value){se.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}const o=[I(v({},R[0]),{id:u.value.id,paymentType:B.FIRST_TERM}),I(v({},R[1]),{id:t.value.id,paymentType:B.RENEW_TERM}),I(v({},R[2]),{id:C.value.id,paymentType:B.REPRISE,payInfoType:L.value})],V=[{category:k.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.INIT_SIGN,type:"png",uri:R[0].images[0],id:u.value.bankData.imagesId[0]},{category:k.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.INIT_SIGN,type:"png",uri:R[0].images[1],id:u.value.bankData.imagesId[1]}];t.value.payInfoType===A.OTHER&&(V.push({category:k.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:R[1].images[0],id:t.value.bankData.imagesId[0]}),V.push({category:k.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:R[1].images[1],id:t.value.bankData.imagesId[1]})),L.value===A.OTHER&&(V.push({category:k.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:R[2].images[0],id:C.value.bankData.imagesId[0]}),V.push({category:k.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:R[2].images[1],id:C.value.bankData.imagesId[1]})),He(I(v({},r),{pageCode:"payInfo",tenantOrderPayInfoList:o,extInfo:I(v({},r.extInfo),{templateId:P,pageCode:"payInfo",shareFlag:O?"Y":"N"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:V})).then(le=>{const{code:ge,data:te}=le;ge==="10000"&&te.success&&d.push({path:Ke[te.pageAction.data.nextPageCode],query:n.query})})}))})},Ce=pe(()=>{const b=I(v({},n.query),{isShare:1,sharePageCode:"payInfo"});return`${window.location.origin}/phoneVerify?${we.stringify(b)}`}),ue=(b=!1)=>{de({orderNo:M,saleUserId:p,tenantId:F}).then(l=>{const{code:h,data:c}=l;h==="10000"&&c&&(r=c,i.value=c.tenantOrderHolder.name,c.tenantOrderPayInfoList.forEach(a=>{a.paymentType===B.FIRST_TERM?(u.value=a,u.value.bankData=I(v(v({},N),a),{images:[],imagesId:[]})):a.paymentType===B.RENEW_TERM?(t.value=a,t.value.bankData=I(v({},a),{images:[],imagesId:[]})):a.paymentType===B.REPRISE&&(C.value=a,C.value.bankData=I(v({},a),{images:[],imagesId:[]}),L.value=a.payInfoType)}),c.tenantOrderAttachmentList.forEach(a=>{a.objectType===_.INIT_SIGN?(a.category===k.OBVERSE_BANK_CARD&&(u.value.bankData.images[0]=a.uri,u.value.bankData.imagesId[0]=a.id),a.category===k.REVERSE_BANK_CARD&&(u.value.bankData.images[1]=a.uri,u.value.bankData.imagesId[1]=a.id)):a.objectType===_.RENEWAL_SIGN?(a.category===k.OBVERSE_BANK_CARD&&(t.value.bankData.images[0]=a.uri,t.value.bankData.imagesId[0]=a.id),a.category===k.REVERSE_BANK_CARD&&(t.value.bankData.images[1]=a.uri,t.value.bankData.imagesId[1]=a.id)):a.objectType===_.ANNUAL_SIGN&&(a.category===k.OBVERSE_BANK_CARD&&(C.value.bankData.images[0]=a.uri,C.value.bankData.imagesId[0]=a.id),a.category===k.REVERSE_BANK_CARD&&(C.value.bankData.images[1]=a.uri,C.value.bankData.imagesId[1]=a.id))}),b&&(c.tenantOrderPayInfoList.find(a=>a.paymentType===B.FIRST_TERM&&a.bankCardNo)||se("\u7528\u6237\u672A\u5B8C\u6210\u94F6\u884C\u5361\u4FE1\u606F\u586B\u5199")))})},Re=()=>{ue(!0)};return Ve(()=>{Pe({pageCode:"payInfo",templateId:P}).then(b=>{const{code:l,data:h}=b;if(l==="10000"){const c={};h.productInsureFactorList.forEach(a=>{c[a.moduleType]||(c[a.moduleType]={}),c[a.moduleType][a.code]=a}),T.value=c}}),ue()}),(b,l)=>{const h=w("van-switch"),c=w("van-checkbox"),a=w("ProSvg"),x=w("van-button"),R=w("ProPageWrap");return s(),E(R,null,{default:D(()=>[S("div",la,[y(z,{title:"\u9996\u671F\u652F\u4ED8"},{default:D(()=>[y(U,{ref_key:"form1",ref:Y},{default:D(()=>[j("paymentMethod","INIT")?(s(),E(W,{key:0,modelValue:u.value.payMethod,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.payMethod=o),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":m(Z)},null,8,["modelValue","data-source"])):f("",!0),y(J,{modelValue:u.value.bankData,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.bankData=o),"holder-name":i.value,factor:T.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),y(z,{title:"\u7EED\u671F\u652F\u4ED8"},{default:D(()=>[y(U,{ref_key:"form2",ref:ee},{default:D(()=>[j("sameAsInit","RENEWAL")?(s(),E(G,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:D(()=>[y(h,{modelValue:t.value.payInfoType,"onUpdate:modelValue":l[2]||(l[2]=o=>t.value.payInfoType=o),size:"22","active-value":m(A).FIRST_SAME,"inactive-value":m(A).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):f("",!0),j("paymentMethod","RENEWAL")?(s(),E(W,{key:1,modelValue:t.value.payMethod,"onUpdate:modelValue":l[3]||(l[3]=o=>t.value.payMethod=o),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":m(Z),required:""},null,8,["modelValue","data-source"])):f("",!0),j("overduePayment","RENEWAL")?(s(),E(W,{key:2,modelValue:t.value.expiryMethod,"onUpdate:modelValue":l[4]||(l[4]=o=>t.value.expiryMethod=o),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":m(Ie),required:"","label-width":"200"},null,8,["modelValue","data-source"])):f("",!0),t.value.payInfoType!==m(A).FIRST_SAME?(s(),E(J,{key:3,modelValue:t.value.bankData,"onUpdate:modelValue":l[5]||(l[5]=o=>t.value.bankData=o),"holder-name":i.value,factor:T.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):f("",!0)]),_:1},512)]),_:1}),y(z,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:D(()=>[S("div",ta,[(s(!0),H(Le,null,Ne(m(Qe),(o,V)=>(s(),H("div",{key:V,class:Oe(["reprise-card-item",{selected:L.value===o.value}]),onClick:le=>De(o.value)},xe(o.label),11,oa))),128))]),y(U,{ref_key:"form3",ref:ae},{default:D(()=>[L.value===m(A).OTHER?(s(),E(J,{key:0,modelValue:C.value.bankData,"onUpdate:modelValue":l[6]||(l[6]=o=>C.value.bankData=o),"holder-name":i.value,factor:T.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):f("",!0)]),_:1},512)]),_:1}),S("div",na,[y(c,{modelValue:$.value,"onUpdate:modelValue":l[7]||(l[7]=o=>$.value=o),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),ra,y(ze,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",url:m(aa)},null,8,["url"])]),S("div",sa,[m(O)?f("",!0):(s(),H("div",{key:0,class:"refresh-btn",onClick:Re},[S("div",null,[y(a,{name:"refresh"})]),da])),m(O)?f("",!0):(s(),E(Je,{key:1,title:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",desc:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",link:m(Ce),"-":""},{default:D(()=>[y(x,{plain:"",type:"primary"},{default:D(()=>[ia]),_:1})]),_:1},8,["link"])),y(x,{type:"primary",class:"submit-btn",onClick:ke},{default:D(()=>[pa]),_:1})])])]),_:1})}}});var ka=ve(ca,[["__scopeId","data-v-50f6f221"]]);export{ka as default};
