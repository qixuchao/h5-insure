var pe=Object.defineProperty;var J=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable;var G=(_,c,d)=>c in _?pe(_,c,{enumerable:!0,configurable:!0,writable:!0,value:d}):_[c]=d,Q=(_,c)=>{for(var d in c||(c={}))ve.call(c,d)&&G(_,d,c[d]);if(J)for(var d of J(c))he.call(c,d)&&G(_,d,c[d]);return _};import{g as U,C as x,L as te,a4 as fe,r as O,k as o,m as r,y as s,I as C,F as D,E as j,J as H,G as K,H as W,a7 as ge,B as T,n as v,z as e,s as I,U as ye,T as se,l as Ce,o as $e,h as w,j as g,Q as ae,v as q,a0 as M,x as ne,a2 as oe,a3 as ue,M as Be,d as ke}from"./vendor-e9263418.js";import{_ as Fe,a as be,t as X}from"./constant-2d4194ea.js";import{_ as R}from"./plugin-vue_export-helper-46f75680.js";import{d as Ee,e as Te,f as xe,m as De}from"./customer-13670369.js";import{u as V}from"./index-b8742a0a.js";import{q as Z}from"./businessOpportunity-65064208.js";import Ie from"./index-f8419607.js";import{b as we}from"./record-2e0ec2a3.js";import{_ as ee}from"./index-654379f5.js";import"./record-dffa77ad.js";import"./play-93cba0e9.js";import"./index-e4c11be9.js";import"./jsbridge-7ca0f033.js";const Ae={class:"com-search-filter-custom"},Se={class:"list"},Oe=["id","onUpdate:modelValue","onBlur"],Ue={class:"text"},Le=U({props:{list:{type:Array,default:()=>[]},data:{type:Object,default:()=>{}}},emits:["onChange"],setup(_,{emit:c}){const d=_,h=x(),t=te(d.list.map(f=>({text:f,status:"complete"}))),b=f=>{t.findIndex(a=>a.status==="typing")>-1||(t.push({status:"typing",text:""}),ye(()=>{const a=document.getElementById(`cus${(t.length||1)-1}`);setTimeout(()=>{a.scrollIntoView({behavior:"smooth"})},200),a.focus()}))},m=f=>{t[f].text!==""?(console.log(t),d.data.validate.includes(t[f].text)||t.findIndex(a=>a.text===t[f].text&&a.status==="complete")>-1?(se("\u6807\u7B7E\u5DF2\u5B58\u5728\uFF0C\u65E0\u9700\u91CD\u590D\u521B\u5EFA"),t.splice(f,1)):t[f].status="complete"):t.splice(f,1)},$=f=>{t.splice(f,1)};return fe(t,f=>{c("onChange",f.map(a=>a.text))}),(f,a)=>{const B=O("van-icon");return o(),r("div",Ae,[s("h2",null,C(_.data.title),1),s("div",Se,[(o(!0),r(D,null,j(e(t),(u,l)=>(o(),r("div",{key:l,class:H(["item",u.status])},[K(s("input",{id:"cus"+l,ref_for:!0,ref_key:"inputRef",ref:h,"onUpdate:modelValue":n=>u.text=n,autofocus:"",maxlength:"5",class:"input",onBlur:n=>m(l)},null,40,Oe),[[W,u.status==="typing"],[ge,u.text]]),K(s("div",Ue,[T(C(u.text)+" ",1),v(B,{name:"cross",class:"icon",onClick:n=>$(l)},null,8,["onClick"])],512),[[W,u.status==="complete"]])],2))),128)),e(t).length<6?(o(),r("div",{key:0,class:"add-button",onClick:b},"+ \u6DFB\u52A0\u6807\u7B7E")):I("",!0)])])}}});var je=R(Le,[["__scopeId","data-v-5662a14a"]]);const qe={class:"com-search-filter"},Re={key:0,class:"action-bar"},Ne=T("\u91CD\u7F6E"),ze=T("\u786E\u5B9A"),He=U({props:{list:{type:Array,required:!0,default:()=>[]},data:{type:Object,default:()=>{}}},emits:["on-submit","on-reset"],setup(_,{expose:c,emit:d}){const h=_,t=x(h.list),b=x(!0),m=x(Ce.exports.cloneDeep(h.data)||{}),$=(B,u)=>{u.value==="customizeTag"?m.value[u.value]=B==null?void 0:B.filter(l=>l):m.value[u.value]=B},f=()=>{d("on-submit",m.value)},a=()=>{m.value={},d("on-reset",m.value)};return $e(()=>{const B=document.documentElement.clientHeight||document.body.clientHeight;window.addEventListener("resize",()=>{(document.documentElement.clientHeight||document.body.clientHeight)>=B?b.value=!0:b.value=!1})}),c({handleReset:a}),(B,u)=>{const l=O("van-button");return o(),r("div",qe,[(o(!0),r(D,null,j(t.value,(n,F)=>(o(),r("div",{key:F,class:"insure-list"},[n.type==="multi"?(o(),w(Fe,{key:0,data:n,value:m.value[n.value],onOnChange:y=>$(y,n)},null,8,["data","value","onOnChange"])):n.type==="single"?(o(),w(be,{key:1,data:n,value:m.value[n.value],onOnChange:y=>$(y,n)},null,8,["data","value","onOnChange"])):(o(),w(je,{key:2,data:n,list:m.value[n.value],onOnChange:y=>$(y,n)},null,8,["data","list","onOnChange"]))]))),128)),b.value?(o(),r("div",Re,[v(l,{plain:"",type:"primary",class:"btn btn-com",onClick:a},{default:g(()=>[Ne]),_:1}),v(l,{type:"primary",class:"btn1 btn-com",onClick:f},{default:g(()=>[ze]),_:1})])):I("",!0)])}}});var Me=R(He,[["__scopeId","data-v-13317f13"]]);const le=_=>(oe("data-v-0d02890e"),_=_(),ue(),_),Ve={class:"detail-info"},Pe={key:0,class:"cell-des"},Ye={class:"cell-des"},Je={class:"cell-des"},Ge={class:"cell-des"},Qe=["src"],Ke=le(()=>s("span",{class:"custom-title"},"\u5BA2\u6237\u6807\u7B7E",-1)),We=["src"],Xe={key:0,class:"com-tag"},Ze=["src"],et=le(()=>s("span",{class:"custom-title"},"\u66F4\u591A\u4FE1\u606F",-1)),tt={key:0,class:"cell-val"},st={key:1,class:"van-cell__value"},at={key:0,class:"cell-val"},nt={key:1,class:"van-cell__value"},ot=U({props:{data:{type:Object,required:!0,default:()=>{}}},emits:["on-success","on-open"],setup(_,{emit:c}){const d=_,{getIconUrl:h}=V();ae();const{data:t}=q(d),b=M(),m=x(!1),$=u=>{const{agentCustomerId:l,customerType:n}=t.value;b.push({name:u,query:{agentCustomerId:l,customerType:n}})},f=ne(()=>{var l;const u={};return((l=t.value.customerTags)==null?void 0:l.length)>0&&t.value.customerTags.forEach(n=>{X.findIndex(y=>{var i;return((i=y.list)==null?void 0:i.findIndex(E=>E.title===n))>-1?(y.type==="single"?u[y.value]=n:u[y.value]=[...u[y.value]||[],n],!0):!1})===-1&&(u.customizeTag=[...u.customizeTag||[],n])}),u}),a=u=>{m.value=u,c("on-open",m.value)},B=async u=>{const{agentCustomerId:l,customerType:n}=t.value;m.value=!1;const F={};Object.keys(u).forEach(i=>{Array.isArray(u[i])?F[i]=u[i].map(E=>({tagName:E,tagCode:E})):F[i]={tagName:u[i],tagCode:u[i]}}),(await Ee(Q({agentCustomerId:l,customerType:n},F))).data.status===200&&(se("\u4FDD\u5B58\u6210\u529F"),c("on-success"))};return(u,l)=>{var y;const n=O("van-cell"),F=O("van-popup");return o(),r("div",Ve,[v(n,{title:"\u51FA\u751F\u65E5\u671F"},{value:g(()=>[e(t).age?(o(),r("span",Pe,[T(C(e(t).birthday)+" ",1),s("span",null,C(e(t).age)+" \u5C81",1)])):I("",!0)]),_:1}),v(n,{title:"\u8054\u7CFB\u7535\u8BDD"},{value:g(()=>[s("span",Ye,C(e(t).phone?`${e(t).phone.substring(0,3)} ${e(t).phone.substring(3,7)} ${e(t).phone.substring(7)}`:""),1)]),_:1}),v(n,{title:"\u7535\u5B50\u90AE\u7BB1"},{value:g(()=>[s("span",Je,C(e(t).email),1)]),_:1}),v(n,{title:"\u901A\u8BAF\u5730\u5740"},{value:g(()=>[s("span",Ge,C(`${(e(t).address||"").replace("/","")}`),1)]),_:1}),v(n,{class:"title"},{title:g(()=>[s("img",{src:e(h)("customer.info"),alt:"",class:"line"},null,8,Qe),Ke]),value:g(()=>{var i;return[s("span",{class:"select",onClick:l[0]||(l[0]=E=>a(!0))},[T(C(((i=e(t).customerTags)==null?void 0:i.length)>0?"\u7F16\u8F91":"\u9009\u62E9")+" ",1),s("img",{src:e(h)("customer.arrowRed"),alt:""},null,8,We)])]}),_:1}),((y=e(t).customerTags)==null?void 0:y.length)>0?(o(),r("div",Xe,[(o(!0),r(D,null,j(e(t).customerTags,i=>(o(),r("span",{key:i,class:"item"},C(i),1))),128))])):I("",!0),v(n,{class:"title"},{title:g(()=>[s("img",{src:e(h)("customer.moreInfo"),alt:"",class:"line"},null,8,Ze),et]),_:1}),v(n,{title:"\u8BC1\u4EF6\u4FE1\u606F","is-link":"",onClick:l[1]||(l[1]=i=>$("docList"))},{value:g(()=>{var i,E,A,S;return[((E=(i=e(t))==null?void 0:i.certificateList)==null?void 0:E.length)>0?(o(),r("span",tt,C((S=(A=e(t))==null?void 0:A.certificateList)==null?void 0:S.length)+"\u5F20",1)):(o(),r("span",st,"\u53BB\u6DFB\u52A0"))]}),_:1}),v(n,{title:"\u5BB6\u5EAD\u4FE1\u606F","is-link":"",onClick:l[2]||(l[2]=i=>$("familyList"))},{value:g(()=>{var i,E,A,S;return[((E=(i=e(t))==null?void 0:i.memberList)==null?void 0:E.length)>0?(o(),r("span",at,C((S=(A=e(t))==null?void 0:A.memberList)==null?void 0:S.length)+"\u4EBA",1)):(o(),r("span",nt,"\u53BB\u6DFB\u52A0"))]}),_:1}),v(n,{title:"\u8865\u5145\u4FE1\u606F",center:"","is-link":"",value:"\u8BE6\u60C5",onClick:l[3]||(l[3]=i=>$("editSuppleInfo"))}),v(n,{title:"\u4FDD\u5355\u4FE1\u606F",center:"","is-link":"",value:"\u8BE6\u60C5",onClick:l[4]||(l[4]=i=>$("policyList"))}),v(n,{title:"\u5BA2\u6237\u98CE\u9669\u7D2F\u8BA1","is-link":"",value:"\u8BE6\u60C5",onClick:l[5]||(l[5]=i=>$("riskDetail"))}),v(F,{show:m.value,position:"right",onClickOverlay:l[6]||(l[6]=i=>a(!1))},{default:g(()=>[m.value?(o(),w(Me,{key:0,list:e(X),data:e(f),onOnSubmit:B},null,8,["list","data"])):I("",!0)]),_:1},8,["show"])])}}});var ut=R(ot,[["__scopeId","data-v-0d02890e"]]);const lt={class:"common"},ct={class:"tp"},it={class:"tp-top"},rt=s("span",null,"\u67E5\u770B\u4E86",-1),dt={class:"title"},_t={class:"time"},mt={style:{display:"flex"}},pt=["src"],vt={style:{display:"flex"}},ht=["src"],ft={class:"imgs"},gt=["src"],yt=U({props:{data:{type:Object,required:!1,default:()=>Object}},setup(_){const c=_,{getIconUrl:d}=V(),h=M(),{data:t}=q(c),b=()=>{if(t.value.contentType==="vcard")h.push("/businessCard");else if(t.value.contentType==="article"&&t.value.extendUrl){const m=new URLSearchParams(new URL(t.value.extendUrl).search);h.push({path:"./articleDetail",query:{articleId:m.get("articleId"),flag:"Y",isInnerEntry:"Y",isOuterUrl:m.get("isOuterUrl")}})}};return(m,$)=>(o(),r("div",{class:"trend-item",onClick:b},[s("div",lt,[s("div",ct,[s("div",it,[rt,s("span",dt,C(e(t).contentTitle),1)]),s("div",_t,[s("div",mt,[s("span",null,[s("img",{src:e(d)("customer.time"),class:"img1"},null,8,pt)]),s("span",null,C(e(t).visitPeriod),1)]),s("div",vt,[s("span",null,[s("img",{src:e(d)("customer.visited"),class:"img2"},null,8,ht)]),s("span",null," \u8BBF\u95EE"+C(e(t).stayDuration),1)])])]),s("div",ft,[s("img",{src:e(t).contentImg,alt:""},null,8,gt)])])]))}});const Ct={class:"trend-list"},$t=U({props:{data:{type:Object,required:!1,default:()=>Object}},setup(_){const c=_,{data:d}=q(c);return(h,t)=>(o(),r("div",Ct,[(o(!0),r(D,null,j(e(d),(b,m)=>(o(),w(yt,{key:m,data:b},null,8,["data"]))),128))]))}});const P=_=>(oe("data-v-84ab0e74"),_=_(),ue(),_),Bt=["src"],kt={class:"detail"},Ft={class:"left"},bt=["src"],Et=["src"],Tt={class:"middle"},xt={class:"middle-row"},Dt={class:"name ellipsis blod"},It=["src"],wt={key:0,class:"cus-tag-out"},At=["src","onClick"],St={class:"userTags"},Ot={class:"it"},Ut=P(()=>s("div",{class:"line"},null,-1)),Lt={class:"it"},jt={class:"footer"},qt=["src"],Rt=T(" \u53D1\u77ED\u4FE1 "),Nt=["src"],zt=T(" \u6253\u7535\u8BDD"),Ht={key:1,class:"empty"},Mt=["src"],Vt=P(()=>s("p",null,"\u8BE5\u5BA2\u6237\u8FD8\u6CA1\u6709\u5173\u8054\u7EBF\u4E0A\u8BBF\u5BA2\u5FAE\u4FE1",-1)),Pt=P(()=>s("p",{class:"p1"},"\u8BD5\u8BD5\u5173\u8054\u4E00\u4E2A\u5427\uFF5E",-1)),Yt=T("\u5173\u8054\u8BBF\u5BA2"),Jt=U({setup(_){const{getIconUrl:c}=V(),d=x(0),h=x(!1),t=M(),b=ae(),{agentCustomerId:m,customerType:$}=b.query,f=te({userInfo:{},activity:{list:[],pageNum:1}}),{userInfo:a,activity:B}=q(f),u=x(!1),l=x(!1),n=p=>{l.value=p},F=async()=>{const p=await Te({agentCustomerId:m,customerType:$}),{data:k}=p.data;a.value=k||{},h.value=(k==null?void 0:k.followStatus)==="Y"},y=async()=>{a.value.customerType||F(),u.value=!0;const p=await xe({pageNum:"1",pageSize:"999",queryBean:{agentCustomerId:m,customerType:a.value.customerType||$}});p.data.status===200&&(B.value=p.data.data||[]),u.value=!1};Be(()=>{const p=new URL(decodeURIComponent(window.location.href)).hash;p==="#2"?(d.value=2,a.value.customerType||F()):p==="#1"?(d.value=1,y()):F()});const i=p=>{p.name===0?F():p.name===1&&y(),we(),window.location.replace(`${window.location.href.toString().replace(window.location.hash,"")}#${p.name}`)},E=async()=>{await De({agentCustomerId:a.value.agentCustomerId,customerType:a.value.customerType,markStatus:h.value?"N":"Y"}),h.value=!h.value},A=()=>{t.push({name:"editCustomer",query:{agentCustomerId:a.value.agentCustomerId,customerType:a.value.customerType}})},S=p=>{t.push("./visitor")},ce=()=>{Z({agentCustomerId:a.value.agentCustomerId,customerType:a.value.customerType,businessType:"06",useType:"TEL"}).then(p=>{var k;window.location.href=`tel:${(k=p==null?void 0:p.data)==null?void 0:k.data}`})},ie=()=>{Z({agentCustomerId:a.value.agentCustomerId,customerType:a.value.customerType,businessType:"06",useType:"SMS"}).then(p=>{var k;window.location.href=`sms:${(k=p==null?void 0:p.data)==null?void 0:k.data}`})},re=p=>{window.location.href=a.value.jumpUrl},de=ne(()=>a.value.createTime?ke().diff(a.value.createTime,"day")+1:1);return(p,k)=>{var Y;const N=O("van-button"),z=O("van-tab"),_e=O("van-tabs");return o(),r("div",{class:H(["customer-detail",{hidden:l.value}])},[s("div",{class:H(["info-con",{"info-bg-unchecked":!h.value,"info-bg-checked":h.value}])},[s("span",{class:"star",onClick:E},[s("img",{src:e(c)("customer.star"),class:"img"},null,8,Bt),T(" \u6807\u8BB0"+C(h.value?"\u5DF2":"\u5F85")+"\u8DDF\u8FDB",1)]),s("div",kt,[s("div",Ft,[s("img",{src:((Y=e(a))==null?void 0:Y.wechatImg)||(e(a).gender?e(a).gender==="F"?e(c)("customer.female"):e(c)("customer.male"):e(c)("customer.male")),alt:""},null,8,bt),s("img",{src:e(c)("customer.edit"),class:"ed",onClick:k[0]||(k[0]=L=>A())},null,8,Et)]),s("div",Tt,[s("div",xt,[s("div",Dt,[T(C(e(a).customerName)+" ",1),e(a).gender?(o(),r("img",{key:0,class:"fm",src:e(a).gender==="F"?e(c)("customer.female1"):e(c)("customer.male1")},null,8,It)):I("",!0)])]),e(a).member?(o(),r("div",wt,[(o(!0),r(D,null,j(e(a).member,(L,me)=>(o(),r(D,{key:me},[L.memberSystemUrl?(o(),r("img",{key:0,src:L.memberSystemUrl,alt:"",class:"cust-tag",onClick:Gt=>re()},null,8,At)):I("",!0)],64))),128))])):I("",!0),s("div",St,[s("div",Ot,"\u6765\u6E90\uFF1A"+C(e(a).source),1),Ut,s("div",Lt,"\u5DF2\u76F8\u8BC6"+C(e(de))+"\u5929",1)])])])],2),s("div",null,[v(_e,{active:d.value,"onUpdate:active":k[1]||(k[1]=L=>d.value=L),sticky:"",onClickTab:i},{default:g(()=>[v(z,{title:"\u57FA\u7840\u4FE1\u606F"},{default:g(()=>[u.value?(o(),w(ee,{key:0})):(o(),r(D,{key:1},[v(ut,{data:e(a),onOnSuccess:F,onOnOpen:n},null,8,["data"]),s("div",jt,[v(N,{plain:"",type:"primary",class:"com-bt",onClick:ie},{default:g(()=>[s("img",{src:e(c)("customer.text"),class:"tx"},null,8,qt),Rt]),_:1}),v(N,{type:"primary",class:"com-bt bt2",onClick:ce},{default:g(()=>[s("img",{class:"ph",src:e(c)("customer.phone1"),alt:""},null,8,Nt),zt]),_:1})])],64))]),_:1}),v(z,{title:"\u5BA2\u6237\u52A8\u6001"},{default:g(()=>[u.value?(o(),w(ee,{key:0})):(o(),r(D,{key:1},[e(B).list.length?(o(),w($t,{key:0,data:e(B).list},null,8,["data"])):(o(),r("div",Ht,[s("img",{src:e(c)("customer.empty1"),alt:""},null,8,Mt),Vt,Pt,v(N,{type:"primary",class:"bt",onClick:S},{default:g(()=>[Yt]),_:1})]))],64))]),_:1}),v(z,{title:"\u62DC\u8BBF\u8BB0\u5F55"},{default:g(()=>[v(Ie)]),_:1})]),_:1},8,["active"])])],2)}}});var is=R(Jt,[["__scopeId","data-v-84ab0e74"]]);export{is as default};
