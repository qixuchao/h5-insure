import{d as e,g as t,an as a,o,c as s,a as d,e as l,u as n,da as r,b as i,al as c,a8 as u,dx as p,w as v,aw as m,c2 as b,l as g,q as y,_ as I,at as f,au as C,aA as h,T as N,a9 as k,dy as _,co as D,h as S,i as Y,j as U,z as T,O as x,b7 as j,m as L,d9 as P,n as q,F as w}from"./index-0bb786f6.js";import{_ as A}from"./index-9ba0265b.js";import{L as B}from"./index-478518c3.js";import{d as E,q as G}from"./order-266b7261.js";import{I as W}from"./infoItem-25f75bbf.js";import"./empty-ae586b6c.js";const M={class:"com-order-item"},O={class:"header"},R={class:"product-name"},z={class:"status"},F={class:"info"},H={class:"info-bottom"},X=(e=>(f("data-v-4c15aef8"),e=e(),C(),e))((()=>d("div",{style:{width:"25%"}},[d("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),Z={class:"footer"},J={class:"fee"},K={class:"money"},Q={key:0,class:"buttons"},V={key:1,class:"buttons"},$={key:2,class:"buttons"};var ee=I(e({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:I}){const f=e,C=t(),D=()=>{h.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{E(f.detail.id,f.detail.orderStatus).then((e=>{const{code:t,data:a}=e;"10000"===t&&(N.success("删除成功"),I("afterDelete"))}))}))},S=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyId:r,saleChannelId:i,orderTopStatus:c}=f.detail;if((p.PENDING===c||p.PAYING===c)&&[_.ZXYS,_.BWYL,_.BWYLUP].includes(e)){const a={[_.ZXYS]:"/internet/productDetail/package",[_.BWYL]:"/internet/productDetail",[_.BWYLUP]:"/internet/guaranteeUpgrade"};return C.push({path:a[e],query:{productCode:e,saleChannelId:i,agentCode:o,tenantId:d,agencyCode:r,orderNo:t}}),!0}return!1},Y=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyId:r}=f.detail;S()||C.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyCode:r}})};return(t,I)=>{var C;const h=a;return o(),s("div",M,[d("div",O,[d("div",R,l(e.detail.productName),1),d("div",z,l(n(r)[e.detail.orderStatus]),1)]),d("div",F,[i(W,{label:"订单号",content:e.detail.orderNo,line:"","is-copy":""},null,8,["content"]),i(W,{label:"投保单号",content:e.detail.applicationNo,line:"","is-copy":""},null,8,["content"]),i(W,{label:"保单号",content:e.detail.policyNo,line:"","is-copy":""},null,8,["content"]),d("div",H,[d("div",null,[i(W,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),i(W,{label:"被保人",content:null==(C=e.detail.insuredName)?void 0:C[0],line:""},null,8,["content"]),i(W,{label:"创建时间",content:n(c)(e.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss"),line:""},null,8,["content"])]),X])]),d("div",Z,[d("div",J,[u(" 保费："),d("span",K,"￥"+l(e.detail.premium),1)]),e.detail.orderTopStatus===n(p).PENDING?(o(),s("div",Q,[i(h,{class:"button",onClick:m(D,["stop"])},{default:v((()=>[u("删除")])),_:1},8,["onClick"]),n(b).UNDERWRITING_FAILED!==e.detail.orderStatus?(o(),g(h,{key:0,class:"button primary",onClick:I[0]||(I[0]=m((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyId:r,saleChannelId:i,orderStatus:c,abbreviation:u}=f.detail;S()||k("orderDetail",{orderNo:t,agentCode:o,tenantId:d,abbreviation:u,productCategory:n})})()),["stop"]))},{default:v((()=>[u("去处理")])),_:1})):y("",!0)])):y("",!0),e.detail.orderTopStatus===n(p).PAYING?(o(),s("div",V,[i(h,{class:"button primary",onClick:m(Y,["stop"])},{default:v((()=>[u("去支付")])),_:1},8,["onClick"])])):y("",!0),e.detail.orderTopStatus===n(p).TIMEOUT?(o(),s("div",$,[i(h,{class:"button",onClick:m(D,["stop"])},{default:v((()=>[u("删除")])),_:1},8,["onClick"])])):y("",!0)])])}}}),[["__scopeId","data-v-4c15aef8"]]);const te={class:"page-order"},ae=(e=>(f("data-v-93b0bdf6"),e=e(),C(),e))((()=>d("div",{class:"footer"},[d("img",{src:"/static/png/logo-b728275d.png",alt:"",style:{width:"100%",height:"128px"}})],-1))),oe={key:1,class:"empty-box"};var se=I(e({__name:"index",setup(e){const a=D();t();const l=S(),{type:r,tenantId:c,agentCode:u}=l.query,p=Y({"-1":1,0:2,1:3,2:4}[r]||0),m=Y(1),b=Y(!1),y=Y(!1),I=Y([]);Y(0),Y(0),Y(0);const f=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],C=U((()=>(I.value=[],f[p.value].status))),h=()=>{N.loading({message:"加载中...",forbidClick:!0}),b.value=!0,G({condition:{orderTopStatus:C.value,tenantId:c,agentCode:u},pageSize:10,pageNum:m.value}).then((e=>{var t;b.value=!1;const{code:a,data:o}=e;"10000"===a&&o&&(1===m.value?I.value=o.datas||[]:I.value=[...I.value,...(null==(t=o.datas[0])?void 0:t.applicationResList)||[]]),y.value=!o||I.value.length>=(null==o?void 0:o.total)})).then((()=>{N.clear()}))},_=()=>{m.value+=1,h()},E=()=>{m.value=1,h()};return T(C,(()=>{m.value=1,h()})),x((()=>{h()})),(e,t)=>{const l=B,r=A,m=j;return o(),g(m,{"theme-vars":n(a)},{default:v((()=>[d("div",te,[i(P,{active:n(p),"onUpdate:active":t[0]||(t[0]=e=>L(p)?p.value=e:null),list:f,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),n(I).length?(o(),g(l,{key:0,class:"body",loading:n(b),finished:n(y),onLoad:_},{default:v((()=>[(o(!0),s(w,null,q(n(I),((e,t)=>(o(),g(ee,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,abbreviation:o,productCategory:s,applicationNo:d,orderId:l}=e;k("orderDetail",{orderNo:t,agentCode:u,tenantId:c,abbreviation:o,productCategory:s,applicationNo:d,orderId:l})})(e),onAfterDelete:E},null,8,["detail","onClick"])))),128)),ae])),_:1},8,["loading","finished"])):(o(),s("div",oe,[i(r,{title:"暂无投保单","empty-class":"empty-select"})]))])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-93b0bdf6"]]);export{se as default};
