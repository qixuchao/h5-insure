import{_ as e,d as a,c as t,g as l,i as o,t as n,l as s,j as d,L as r,M as i,u,a as c,r as v,z as p,b as m,e as f,w as I,f as h,T as w,aP as y}from"./index-e0d5649a.js";import{j as g}from"./infoCollection-2d7c6e58.js";import{c as C,_ as b}from"./index-27ad402d.js";import{a as N}from"./order-c39de349.js";import{d as O,i as U,g as $,s as S,e as j,E as k}from"./trial-883d34cb.js";import{t as x}from"./theme-ea709837.js";import{n as L,i as D,m as _,e as P,g as R,t as V,k as B,f as z,h as F}from"./utils-1ed709d0.js";import{p as H}from"./product-778d2aed.js";import"./pdfh5-3b8067b2.js";import"./pdfdist-82d43a90.js";import"./trial-4d97b702.js";const J={class:"com-field-info"},M={class:"title"},T={class:"desc"};var q=e(a({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup:e=>(a,s)=>(t(),l("div",J,[o("div",M,n(e.title),1),o("div",T,n(e.desc),1)]))}),[["__scopeId","data-v-2ff3e068"]]);const E=e=>(r("data-v-ed9081ee"),e=e(),i(),e),K={key:0,class:"pro-modal"},G=E((()=>o("div",{class:"pro-overlay"},null,-1))),W={class:"pro-modal-wrapper"},Y=E((()=>o("div",{class:"pro-modal-content"},[o("p",null,"恭喜您"),o("p",null,"保障升级成功")],-1))),A=["src"];var Q=e(a({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(e,{emit:a}){const n=e,r=()=>{a("on-close")},i=()=>{a("on-confirm")};return(e,a)=>n.isShow?(t(),l("div",K,[G,o("div",W,[o("div",{class:"pro-modal-body"},[Y,o("div",{class:"pro-modal-btn",onClick:i},"我知道了")]),o("div",{class:"pro-modal-close",onClick:r},[o("img",{src:s(C)},null,8,A)])])])):d("",!0)}}),[["__scopeId","data-v-ed9081ee"]]);const X={class:"page-activity-upgrade"},Z=["src"],ee={class:"container"},ae={class:"main-form"};var te=e(a({setup(e){const a=u(),l=c(),{productCode:n="BWYL2022",tenantId:d,orderNo:r,agentCode:i="",from:C}=l.query,J=v(),M=v(),T=v(),E=v(),K=v(),G=v(),W=v(!1),Y="check"===C,A=v(!1),te=v(0),le=v("");let oe="";const ne=()=>{W.value=!1},se=e=>`${y}/pay?orderNo=${e}&saleUserId=${i}&tenantId=${d}`,de=()=>{a.replace(`/pay?orderNo=${le.value}&saleUserId=${i}&tenantId=${d}`)},re=async e=>{try{w.loading({forbidClick:!0,message:"升级中",duration:15e3});const e=await(async()=>{var e,a,t,l,o;const n=R({tenantId:d,applicationNo:T.value.applicationNo,policyNo:T.value.policyNo,saleUserId:i,saleChannelId:T.value.saleChannelId,orderStatus:N.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:J.value,insureDetail:M.value,paymentMethod:null==(a=null==(e=T.value.extInfo)?void 0:e.extraInfo)?void 0:a.paymentMethod,renewalDK:null==(l=null==(t=T.value.extInfo)?void 0:t.extraInfo)?void 0:l.renewalDK,iseeBizNo:oe,successJumpUrl:"",premium:E.value,holder:{...T.value.tenantOrderHolder,socialFlag:T.value.tenantOrderHolder.extInfo.hasSocialInsurance},insured:{...T.value.tenantOrderInsuredList[0],socialFlag:T.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance},tenantOrderRiskList:V({tenantId:d,riskList:B(M.value.productRiskVoList[0].riskDetailVOList,J.value),riskPremium:{},productId:null==(o=J.value)?void 0:o.id})}),s=await S(n),{code:r,data:u}=s;return"10000"===r?u.data:""})();await O({tenantId:d,applicationNo:T.value.applicationNo});if(le.value=e,G.value){if(Y){const a=encodeURIComponent(encodeURIComponent(se(e))),t=`${G.value}&successUrl=${a}`;window.location.href=t}else{const e=encodeURIComponent(encodeURIComponent(window.location.href)),a=`${G.value}&failUrl=${e}`;window.location.href=a}w.clear()}else(async e=>{const t=z({tenantId:d,premium:E.value,orderDetail:T.value,productDetail:J.value,insureDetail:M.value,successJumpUrl:se(e),iseeBizNo:oe}),l=await k({orderNo:e,...t}),{code:o,data:s}=l;"10000"===o&&(Y?a.replace(`/internet/orderDetail?orderNo=${e}&productCode=${n}&tenantId=${d}`):(w.clear(),de()))})(e)}catch(t){w.clear()}},ie=async e=>{Y?A.value=!0:re()},ue=()=>{w.loading({forbidClick:!0,duration:2e4,message:"试算中"});const e=H({productCode:n,withInsureInfo:!0,tenantId:d}),a=U({productCode:n}),t=$({orderNo:r,tenantId:d});Promise.all([e,a,t]).then((([e,a,t])=>{var l;"10000"===e.code&&(J.value=e.data,document.title=(null==(l=e.data)?void 0:l.productFullName)||""),"10000"===a.code&&(M.value=a.data),"10000"===t.code&&(T.value=t.data,K.value=t.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),(async()=>{try{const e=z({tenantId:d,premium:E.value,orderDetail:T.value,productDetail:J.value,insureDetail:M.value,successJumpUrl:""},F),a=await j(e),{code:t,data:l}=a;"10000"===t&&(E.value=l.installmentPremium,G.value=l.signUrl)}catch(e){}finally{w.clear()}})()}))};return p((()=>{ue(),setTimeout((async()=>{oe=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const l=m("ProRadioButton"),n=m("ProField"),d=m("van-config-provider");return t(),f(d,{"theme-vars":s(x)},{default:I((()=>{var e,t,d,r,i,u,c,v,p,m;return[o("div",X,[o("img",{src:null==(t=null==(e=J.value)?void 0:e.tenantProductInsureVO)?void 0:t.banner[0],class:"banner"},null,8,Z),o("div",ee,[o("div",ae,[h(q,{title:"姓名",desc:s(L)(null==(r=null==(d=T.value)?void 0:d.tenantOrderInsuredList)?void 0:r[0].name)},null,8,["desc"]),h(q,{title:"证件号码",desc:s(D)(null==(u=null==(i=T.value)?void 0:i.tenantOrderInsuredList)?void 0:u[0].certNo)},null,8,["desc"]),h(q,{title:"手机号码",desc:s(_)(null==(v=null==(c=T.value)?void 0:c.tenantOrderHolder)?void 0:v.mobile)},null,8,["desc"]),h(q,{title:"每月保费",desc:`${s(P)(E.value||0)}元 / 每月`},null,8,["desc"]),h(n,{label:"有无社保",name:"name",required:"",placeholder:"请选择"},{input:I((()=>[h(l,{modelValue:K.value,"onUpdate:modelValue":a[0]||(a[0]=e=>K.value=e),disabled:!0,options:s(g)},null,8,["modelValue","options"])])),_:1}),o("div",{class:"submit",onClick:ie})])]),h(Q,{"is-show":W.value,onOnConfirm:de,onOnClose:ne},null,8,["is-show"])]),h(b,{show:A.value,"onUpdate:show":a[1]||(a[1]=e=>A.value=e),"content-list":null==(m=null==(p=J.value)?void 0:p.tenantProductInsureVO)?void 0:m.attachmentVOList,"active-index":te.value,text:"我已逐页阅读并确认告知内容",onSubmit:re},null,8,["show","content-list","active-index"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-72c7b778"]]);export{te as default};
