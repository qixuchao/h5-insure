var H=Object.defineProperty,K=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var U=(o,a,e)=>a in o?H(o,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[a]=e,k=(o,a)=>{for(var e in a||(a={}))Q.call(a,e)&&U(o,e,a[e]);if(y)for(var e of y(a))Y.call(a,e)&&U(o,e,a[e]);return o},C=(o,a)=>K(o,P(a));import{t as O}from"./theme-ea709837.js";import{g as Z,E as d,y as b,_ as F,r as i,j as c,k as v,m as w,p as j,t as z,z as g,A as u,C as M,J as R}from"./vendor-ec22d003.js";var $="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAB0CAMAAABjROYVAAAAAXNSR0IArs4c6QAAAT5QTFRFAAAA////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////tGB6DAAAAGl0Uk5TAAIEBQYHCgsMDxAREhMUGRoeICctMzQ4OTo7PUBBREZISUpLTE1OT1JbYWNnaG1wdHV2eXp7g4uNkZSVlpecnaivsLG4ubvFxsfKy87S1dfY2d/g4eLk5+jp6uzt7/Dz9Pb3+fr7/P3+/72HPAAABS9JREFUaN7Fm/0/G00QwEfloaUpRb1WKaXo4yVUCBpvqaDeizxIEUnI9///B54f7hKJXu72Lnu5+c3H7H4/t5mdnZmdFXEnjZ3jkXgieXh2k83enB0mE/HIeGej+Cdtk/GTPBaSP4lPtvkAfDW6eoytHK+OvtKK/BC7RkGuYx90Ed9Ejp7nLVzsrMyM9HV1hEOhcEdX38jMys5F4fn/R5E3GpDvorfFCXPJ6GCzlU7zYDSZK2rdRt/VajvL9+Zc6bXh13aar4d/pE3V++VarCq0mDG/cWsipKA+sWV+b2Yx5JX56dS0j4Ww6pDwgmlxJ588Ids3jOGXs01uhjXNXhrjNtrdM78Yv9DVtOuF+mf6yrCCL2693VIB4Gmtxcsitaw9ARSWXPnH93sA7Hd7NYfuXwDsvVcfMpAGyM01eDf8hrkcQHpAdcDXB4Dzntq2eM85wMNXNe1vjwDbrbX6stZtgMdvKrrfAfiuw2srT/UdID+l56yYyitRvwFkxnSdUGMZAIcV/voI/OnXdxL3/wEeba1p4AHIaGSK9GeAB5ud8z4N5MdEq4w9AumqXqJxD2BKNMsUwF41j7ikba9YbIilKudKAdj2I3bdBgqWZ057Gvjd6ge09RxIW52vG0CuR3yRnhywYRGbAMz5lRzMAfwVwYROgf0Gv6AN+8DpyyBkEXjqFt+k+wlYfBHfZoA1H5MvWQMylfHwMnDV4ie05QpYrsgd7oF/xVeZBu7LM44ocBnyFxq6BKJledktMCs+yyxw+5zTRYDrJr+hTddApPTnEbAgvssCcFTKs4Fc2H9oOAcUc/UYsGmv/zZ2cHcQe1uDgojIFhAzaxjXwISt9sf/AEgNVVMYMhU+2k4zAVwb1ZBRIG27X96mzBw7WyWUGcuaCinbbw2lgVEREVl19ICxUh3DmlpillavivwAVkVE5BgYttU9wJZaxuTAdqJh4FhEpA3I2dYw5A47ajmTO9uJXueANhGZBJKi+qV/UyuYDl8qSWBSROKVLtH+N/2bWsl0+E0lCsRF5AQYdNilqarUF8yUw04dBE5EGvNQaHbwJUPZKtQXzOyQw0TNBcg3Sidw4ZwbWFPHsgAOG6pCLoBOGQd2xBvVPVN2gHGZB1bEE9UDU1aAiKwDM+KF6oUpM8C6/AQ+ixeqF6aMAD9lF+gVL1QvTOkFduUQ6JJaqapM6QIO5QzokBqpykzpAM7kBlAPVayp6kwJAzeSBVxEvFZUF0wJAVm3UAuqG6YJdbe8FlRXTHN5XRlS7VDDkNxsGQ3La2yZJNBXP0PqA5KSAEbqt2VGgIS6w9fjHGaAuEQUjzZNbtA42hQPcV0O3zjE1cIVbUebEa4oBWbaDnEzMFMJQfWFK2YIqhJs6wvMisG2QlqhLwQtphUKCZS2YLuUQCmkitrSilKq6CoprjGBek6KndN/XaliWfrvXOjQlRSXFTokBmzVI/0vK+k4F680FToqileOZTpNJZ2KMp1zQfJjyql4lXIuXr0oSDqXXnWU6V6UXgMpMhvl9Ok6l9MDuTgI5ookkMsg36+9flldewVywRfMVaZxaXte50vbQK6ng7mID6blwKfmirxtc0UwbSTBNMwE0xoUTBNUMO1ewTS2FVv4fte1hS+YZkUdbZn7rtsyg2lAlVpabUNeW20lmKZiqa19+vSTV3N4bhTfVGsU36y9UVwCaYkXCaT5X8TymUNv8ZlDrz/PHIxcve4POoxqSP2frphWVe9HOiX/2Dk+v57YLT5H2k2sz7t/jvQ/OUv8Dn3rFHYAAAAASUVORK5CYII=";const q={class:"item"},J={class:"footer"},ee=Z({props:{show:{type:Boolean,default:!1},contentList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0},text:{type:String,default:""},beforeReadOverText:{type:String,default:"\u540C\u610F\uFF0C\u4E0B\u4E00\u6761"},forceReadCound:{type:Number,default:0}},emits:["update:show","submit","onCloseFilePreview"],setup(o,{emit:a}){const e=o,f=d(e.show),A=d(!0),r=d(e.contentList.map((t,s)=>C(k({},t),{disabled:!0,readDisabled:!0}))),l=d(e.activeIndex),p=d(0),D=d(null),m=b(()=>{var t,s;return(s=(t=r.value)==null?void 0:t[l.value])==null?void 0:s.attachmentUri}),V=b(()=>{var t;return(t=r.value[l.value])==null?void 0:t.readDisabled}),E=b(()=>l.value>=e.forceReadCound-1||p.value>=e.forceReadCound?!1:p.value<e.forceReadCound?l.value!==e.forceReadCound-1:!1),X=()=>{l.value+=1},x=()=>{a("update:show",!1),a("submit")};F(()=>e,()=>{f.value=e.show,l.value=e.activeIndex},{deep:!0,immediate:!0});const N=t=>{t&&(console.log("el.target.scrollHeight",t.target.scrollHeight),console.log("el.target.scrollTop",t.target.scrollTop),console.log("el.target.clientHeight",t.target.clientHeight),console.log("calcuateFlg",A.value),Math.floor(t.target.scrollHeight-t.target.scrollTop-15)<=t.target.clientHeight&&A.value&&r.value[l.value].readDisabled&&(r.value[l.value].disabled=!1,r.value[l.value].readDisabled=!1,r.value[l.value+1].disabled=!1,p.value+=1))};return F(()=>l.value,()=>{A.value=!1,e.show&&(p.value>=e.forceReadCound&&r.value.forEach(t=>{t.disabled=!1,t.readDisabled=!1}),setTimeout(()=>{A.value=!0},1e3))},{immediate:!0}),(t,s)=>{const G=i("ProTab"),T=i("ProFilePreview"),h=i("VanButton"),I=i("van-config-provider"),S=i("ProPopup");return c(),v(S,{show:f.value,"onUpdate:show":s[1]||(s[1]=n=>f.value=n),class:"file-preview-popup-wrap",closeable:!1,onClose:s[2]||(s[2]=n=>a("onCloseFilePreview"))},{default:w(()=>[j(I,{"theme-vars":u(O),class:"custom-provider"},{default:w(()=>[f.value?(c(),v(G,{key:0,active:l.value,"onUpdate:active":s[0]||(s[0]=n=>l.value=n),list:r.value.map((n,B)=>({title:n.attachmentName,disabled:B==l.value?!1:n.disabled||!1,slotName:`guarantee-${B}`})),class:"tab"},null,8,["active","list"])):z("",!0),g("div",{ref_key:"previewRef",ref:D,class:"list",onScroll:N},[g("div",q,[(c(),v(T,{key:u(m),content:u(m),type:"pdf","forbid-click":!0},null,8,["content"]))])],544),g("div",J,[u(E)?(c(),v(h,{key:0,disabled:u(V),type:"primary",block:"",round:"",onClick:X},{default:w(()=>[M(R(`${o.beforeReadOverText}(${l.value+1}/${o.forceReadCound})`),1)]),_:1},8,["disabled"])):(c(),v(h,{key:1,disabled:u(V),type:"primary",block:"",round:"",onClick:x},{default:w(()=>[M(R(e.text),1)]),_:1},8,["disabled"]))])]),_:1},8,["theme-vars"])]),_:1},8,["show"])}}});export{ee as _,$ as c};
