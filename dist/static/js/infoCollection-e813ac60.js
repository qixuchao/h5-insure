import{d as e,j as a,r as l,bd as i,O as t,z as s,o as n,c as o,b as u,u as r,F as d,f as c,aO as p,aG as v,q as m,w as f,g as k,_ as I,bb as y,b9 as h,m as g,a as L,ba as b,c1 as V,k as C,c2 as R,c3 as O,n as P,e as x,c4 as T,aK as D,aE as w,aF as _,V as S,a8 as F,W as N,c5 as E,p as j,ae as A,ai as U,c6 as M,c7 as q,i as Y,h as B,aH as $,aI as X,T as K,E as H,aL as Q,aM as W,a9 as z,aN as G,a4 as J,a5 as Z,a6 as ee,c8 as ae,bw as le,aa as ie,ab as te}from"./index-e55a5aab.js";import{_ as se}from"./PayInfo-b220ec8f.js";import"./PolicyInfo-204c2b2d.js";import{u as ne,c as oe,h as ue,d as re,q as de,g as ce,i as pe}from"./trial-7beeb937.js";import{_ as ve}from"./TrialButton-77e16761.js";import{n as me}from"./nextStep-989d7262.js";import{u as fe}from"./useAttachment-81727a9b.js";import{a as ke,c as Ie}from"./product-96d5c534.js";import{g as ye}from"./utils-9eb3d524.js";import{u as he}from"./useOrder-747e3c47.js";import{_ as ge,P as Le,B as be}from"./constants-8edfc3f6.js";import{t as Ve}from"./utils-8e877127.js";import{c as Ce}from"./cloneDeep-74240b7b.js";import{B as Re,P as Oe,R as Pe,a as xe}from"./index-b0c7585c.js";import{o as Te}from"./index-85b786dc.js";import{_ as De}from"./index-36260c6b.js";import{S as we,_ as _e}from"./box-title-d547a3c4.js";import{_ as Se}from"./index-0d6c3845.js";import{_ as Fe}from"./empty-ae586b6c.js";import{R as Ne}from"./trial-5aa151d8.js";import{P as Ee}from"./config-98e8d477.js";import{i as je}from"./isNaN-f3e409b0.js";import"./index-1c351f68.js";import"./format-31cde443.js";import"./core-d721bab5.js";import"./constants-4b08cf92.js";import"./infoCollection-ede4c173.js";import"./createProposal-0f6d5a07.js";import"./index-f45d5971.js";import"./index-0e382750.js";import"./search-7f468ce8.js";import"./product-7bbf9c44.js";const Ae=e({name:"InsureInfos"}),Ue=e({...Ae,props:{originData:{default:()=>({})},modelValue:{default:()=>({})},defaultValue:{default:()=>({})},trialResult:{default:()=>({})}},emits:["trialChange"],setup(e,{expose:v,emit:m}){const f=e,k=a(null),I=a({}),y=a({}),h=l({personalInfo:{},basicsAmount:"",basicsPremium:"",defaultValues:f.defaultValue,changeData:null,sValues:I.value});i("premium"),y.value=i("enumList")||{},t((()=>{}));const g=e=>{f.originData.mainRiskFlag,I.value.riskCategory=f.originData.riskCategory,I.value.riskCode=f.originData.riskCode,I.value.riskId=f.originData.riskId,I.value.riskType=f.originData.riskType,I.value.riskName=f.originData.riskName,I.value.riskType=f.originData.riskType,I.value.mainRiskCode=f.originData.mainRiskCode,I.value.mainRiskId=f.originData.mainRiskId,e?m("trialChange",I.value,e):m("trialChange",I.value)},L=(e,a)=>{a?I.value[a.key]=a.newValue:Te(e).forEach((a=>{I.value[a]=e[a]})),g(a)},b=e=>{var a,l;1==+(null==(l=null==(a=f.originData)?void 0:a.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO.saleMethod)?h.basicsAmount=null==e?void 0:e.initialAmount:h.basicsAmount=null==e?void 0:e.initialPremium,Te(e).forEach((a=>{I.value[a]=e[a]})),g()},V=e=>{I.value.liabilityList=e,g()};return s((()=>f.defaultValue),(e=>{e&&(console.log("--default change ",e),h.defaultValues=Ce(e),I.value={...e})}),{deep:!0,immediate:!0}),s((()=>I.value),(e=>{h.sValues=e}),{deep:!0,immediate:!0}),v({validate:async()=>{var e;await(null==(e=k.value)?void 0:e.validate())}}),(a,l)=>{var i,t,s,v,m,f;const k=p;return 1===(null==(i=e.originData)?void 0:i.factorDisPlayFlag)?(n(),o(d,{key:0},[u(k,{title:"保障计划",class:"insurePlan","show-divider":!1}),u(r(Re),{"v-model":r(h).sValues,"origin-data":null==(s=null==(t=e.originData)?void 0:t.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO,"defalut-value":r(h).defaultValues,"trial-result":e.trialResult,onTrialChange:b},null,8,["v-model","origin-data","defalut-value","trial-result"]),u(r(Oe),{"v-model":r(h).sValues,"use-data":r(h).sValues,"origin-data":e.originData.productRiskInsureLimitVO,"risk-info":e.originData,"default-value":r(h).defaultValues,onTrialChange:L},null,8,["v-model","use-data","origin-data","risk-info","default-value"]),u(r(Pe),{"data-source-folmulate":r(I),"data-source":e.originData,params:{amountUnit:null==(m=null==(v=e.originData)?void 0:v.productRiskInsureLimitVO)?void 0:m.amountPremiumConfigVO.displayUnit,basicsAmount:r(h).basicsAmount,basicsPremium:r(h).basicsPremium,riskId:null==(f=e.originData)?void 0:f.riskId},"default-value":r(h).defaultValues,onTrialChange:V},null,8,["data-source-folmulate","data-source","params","default-value"])],64)):c("",!0)}}});const Me={key:0},qe={key:0,class:"risk2-field"},Ye=e({name:"ProductRiskList"});var Be=I(e({...Ye,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(e,{emit:a}){const i=e,p=l({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),I=e=>{const a=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&a.push({...e}),[]))),a},g=(e,l,t)=>{var s;p.riskIsInsure[l].data=e;const n=[...p.disabledRiskInfo];null==(s=i.dataSource.insureProductRiskVOList)||s.forEach((e=>{if(1!==e.mainRiskFlag){const a=p.riskIsInsure[e.riskId];a.data&&Object.keys(a.data).length>0&&"1"===a.selected&&n.push(a.data)}})),a("trialChange",n,t)},L=(e,a)=>{var l;null==(l=i.dataSource.productRiskRelationVOList)||l.forEach((l=>{1!==l.collocationType&&(a.riskId===l.riskId?(p.riskIsInsure[a.riskId]&&p.riskIsInsure[a.riskId].selected,2===l.collocationType&&p.riskIsInsure[l.collocationRiskId]&&(p.riskIsInsure[l.collocationRiskId].selected=e),3===l.collocationType&&p.riskIsInsure[l.collocationRiskId]&&"1"===e&&(p.riskIsInsure[l.collocationRiskId].selected="1"===e?"2":"1")):a.riskId===l.collocationRiskId&&(3===l.collocationType&&"1"===e&&p.riskIsInsure[l.riskId]&&(p.riskIsInsure[l.riskId].selected="1"===e?"2":"1"),2===l.collocationType&&p.riskIsInsure[l.riskId]&&(p.riskIsInsure[l.riskId].selected=e)))})),"2"===e?g({},a.riskId):(e=>{var a,l,i,t,s,n,o,u,r,d,c,p;if(1!==(null==e?void 0:e.factorDisPlayFlag)){const v=null==(a=null==e?void 0:e.productRiskInsureLimitVO)?void 0:a.amountPremiumConfigVO,m={riskCategory:e.riskCategory,riskCode:e.riskCode,riskName:e.riskName,riskId:e.riskId,riskType:e.riskType,mainRiskId:e.mainRiskId,mainRiskCode:e.mainRiskCode,liabilityList:I(e)};m.chargePeriod=(null==(i=null==(l=null==e?void 0:e.productRiskInsureLimitVO)?void 0:l.paymentPeriodValueList)?void 0:i.length)>0&&(null==(t=null==e?void 0:e.productRiskInsureLimitVO)?void 0:t.paymentPeriodValueList[0].code)||null,m.coveragePeriod=(null==(n=null==(s=null==e?void 0:e.productRiskInsureLimitVO)?void 0:s.insurancePeriodValueList)?void 0:n.length)>0&&(null==(o=null==e?void 0:e.productRiskInsureLimitVO)?void 0:o.insurancePeriodValueList[0].code)||null,m.paymentFrequency=(null==(r=null==(u=null==e?void 0:e.productRiskInsureLimitVO)?void 0:u.paymentFrequencyList)?void 0:r.length)>0&&(null==(d=null==e?void 0:e.productRiskInsureLimitVO)?void 0:d.paymentFrequencyList[0].code)||null;let f=0;1===v.displayType?f=(null==v?void 0:v.minStepValue)>0?null==v?void 0:v.minStepValue:0:3===v.displayType&&2===v.requireCopies?f=(null==(c=null==v?void 0:v.displayValues)?void 0:c.length)>0?null==v?void 0:v.displayValues[0].value:0:3===v.displayType&&1===v.requireCopies?(f=(null==(p=null==v?void 0:v.displayValues)?void 0:p.length)>0?null==v?void 0:v.displayValues[0].value:0,m.copy=v.minCopiesValue):2===v.displayType?m.copy=v.minCopiesValue:f=0,1===v.saleMethod?m.initialAmount=f:m.initialPremium=f,g(m,e.riskId)}})(a)};return v((()=>{(()=>{var e,a;p.disabledRiskInfo=[];let l=null;if(null==(e=i.dataSource.insureProductRiskVOList)||e.forEach((e=>{var a;const t=1!==e.mainRiskFlag?null==(a=i.dataSource.productRiskRelationVOList)?void 0:a.find((a=>a.collocationRiskId===e.riskId)):{};1===e.mainRiskFlag&&(l=e),p.riskIsInsure[e.riskId]?(p.riskIsInsure[e.riskId].data=null,p.riskIsInsure[e.riskId].relation=t,p.riskIsInsure[e.riskId].isMust=!1):p.riskIsInsure[e.riskId]={selected:"2",data:null,relation:t,isMust:!1}})),l){const e=null==(a=i.dataSource.productRiskRelationVOList)?void 0:a.filter((e=>e.riskId===l.riskId));if(!e)return;null==e||e.forEach((e=>{var a,l,t,s,n,o,u,r,d,c,v,m,f,k,y;if(2===e.collocationType){p.riskIsInsure[e.collocationRiskId].selected="1",p.riskIsInsure[e.collocationRiskId].isMust=!0;const h=null==(a=i.dataSource.insureProductRiskVOList)?void 0:a.find((a=>e.collocationRiskId===a.riskId));if(h&&1!==h.factorDisPlayFlag&&(null==(l=null==h?void 0:h.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO)){const a=null==(t=h.riskLiabilityInfoVOList)?void 0:t.every((e=>1!==e.showFlag)),l=null==(s=null==h?void 0:h.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO;if(a){p.riskIsInsure[e.collocationRiskId].isDisabled=!0;const a={riskCategory:h.riskCategory,riskCode:h.riskCode,riskName:h.riskName,riskId:h.riskId,riskType:h.riskType,mainRiskId:h.mainRiskId,mainRiskCode:h.mainRiskCode,liabilityList:I(h)};a.chargePeriod=(null==(o=null==(n=null==h?void 0:h.productRiskInsureLimitVO)?void 0:n.paymentPeriodValueList)?void 0:o.length)>0&&(null==(u=null==h?void 0:h.productRiskInsureLimitVO)?void 0:u.paymentPeriodValueList[0].code)||null,a.coveragePeriod=(null==(d=null==(r=null==h?void 0:h.productRiskInsureLimitVO)?void 0:r.insurancePeriodValueList)?void 0:d.length)>0&&(null==(c=null==h?void 0:h.productRiskInsureLimitVO)?void 0:c.insurancePeriodValueList[0].code)||null,a.paymentFrequency=(null==(m=null==(v=null==h?void 0:h.productRiskInsureLimitVO)?void 0:v.paymentFrequencyList)?void 0:m.length)>0&&(null==(f=null==h?void 0:h.productRiskInsureLimitVO)?void 0:f.paymentFrequencyList[0].code)||null;let i=0;1===l.displayType?i=(null==l?void 0:l.minStepValue)>0?null==l?void 0:l.minStepValue:0:3===l.displayType&&2===l.requireCopies?i=(null==(k=null==l?void 0:l.displayValues)?void 0:k.length)>0?null==l?void 0:l.displayValues[0].value:0:3===l.displayType&&1===l.requireCopies?(i=(null==(y=null==l?void 0:l.displayValues)?void 0:y.length)>0?null==l?void 0:l.displayValues[0].value:0,a.copy=l.minCopiesValue):2===l.displayType&&(a.copy=l.minCopiesValue),1===l.saleMethod?a.initialAmount=i:a.initialPremium=i,p.disabledRiskInfo.push(a),g(a,h.riskId)}}}3===e.collocationType&&(p.riskIsInsure[e.collocationRiskId].selected="2",p.riskIsInsure[e.collocationRiskId].isMust=!0)}))}})()})),t((()=>{p.loading=!0})),s((()=>p.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),s((()=>i.defaultValue),(e=>{(null==e?void 0:e.length)>0&&e.forEach((e=>{p.risksDefaultValue[e.riskCode]=e,p.riskIsInsure[e.riskId]?(p.riskIsInsure[e.riskId].selected="1",g(e,e.riskId)):p.riskIsInsure[e.riskId]={selected:"1",isMust:!1}}))}),{deep:!0,immediate:!0}),(a,l)=>{const i=y,t=h;return n(!0),o(d,null,m(e.dataSource.insureProductRiskVOList,(l=>{var s,v;return n(),o(d,{key:l.riskCode},[(!e.showMainRisk&&1!==l.mainRiskFlag||e.showMainRisk)&&(null==(v=null==(s=r(p).riskIsInsure)?void 0:s[l.riskId])?void 0:v.relation)?(n(),o("div",Me,[u(t,{modelValue:r(p).riskIsInsure[l.riskId].selected,"onUpdate:modelValue":e=>r(p).riskIsInsure[l.riskId].selected=e,label:l.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:f((()=>[u(i,{modelValue:r(p).riskIsInsure[l.riskId].selected,"onUpdate:modelValue":e=>r(p).riskIsInsure[l.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"0.68rem",disabled:r(p).riskIsInsure[l.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>L(e,l)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===r(p).riskIsInsure[l.riskId].selected?(n(),o("div",qe,[u(Ue,{modelValue:r(p).riskIsInsure[l.riskId].data,"onUpdate:modelValue":e=>r(p).riskIsInsure[l.riskId].data=e,"origin-data":l,"product-factor":e.dataSource.productFactor,"default-value":r(p).risksDefaultValue[l.riskCode],onTrialChange:(e,a)=>g(e,l.riskId,a)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):c("",!0),1===l.exemptFlag&&"1"===r(p).riskIsInsure[l.riskId].selected?k(a.$slots,"holderForm",{key:1},void 0,!0):c("",!0)])):c("",!0)],64)})),128)}}}),[["__scopeId","data-v-58a61f59"]]);const $e={class:"pro-radio-wrap"},Xe=e({name:"PlanSelect"}),Ke=e({...Xe,props:{planList:{default:()=>[]},defaultPlan:{default:()=>{}}},emits:["planChange"],setup(e,{emit:l}){const i=e,o=a("");let r=!1;return t((()=>{i.defaultPlan&&(r=!0,o.value=i.defaultPlan.planCode)})),s((()=>o),(e=>{r||l("planChange",o.value),r&&(r=!1)}),{deep:!0,immediate:!0}),(a,l)=>{const t=b,s=h;return e.planList.length>0?(n(),g(s,{key:0,modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value=e),label:"保障计划",name:"planCode",class:"risk-select-field"},{input:f((()=>[L("div",$e,[u(t,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=e=>o.value=e),options:i.planList.map((e=>({label:e.planName,value:e.planCode})))},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):c("",!0)}}});var He=I(e({__name:"ScrollWrap",props:{moduleValue:{type:Number,default:0},scrollX:{type:Boolean,default:!1},scrollY:{type:Boolean,default:!1}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:u}){const d=e,c=l({offsetX:0,offsetY:0,startX:0,startY:0}),p=a(null),v=a(null),{width:m,height:f}=V(p),{width:I,height:y}=V(v),h=i("PRO_TABLE_KEY"),g=C((()=>{const e=m.value>I.value+4;return u("update:needFixed",e),e})),L=C((()=>f.value>y.value+4)),{direction:b}=R(p,{passive:!1,onSwipeStart(e){const{clientX:a,clientY:l}=e.touches[0];c.startX=a,c.startY=l},onSwipe(e){const{clientX:a,clientY:l}=e.touches[0];if(["LEFT","RIGHT"].includes(b.value)){const e=c.offsetX-(c.startX-a);e>-m.value+I.value&&e<0&&(c.offsetX=e,h.state.offsetX=c.offsetX),c.startX=a}if(["UP","DOWN"].includes(b.value)){const e=c.offsetY-(c.startY-l);e>-f.value+y.value&&e<0&&(c.offsetY=e,h.state.offsetY=c.offsetY),c.startY=l}},onSwipeEnd(e){}}),P=C((()=>d.scrollX||d.scrollY?`transform: translate(${d.scrollX?`${c.offsetX}px`:0},${d.scrollY?`${c.offsetY}px`:0} );`:""));return s((()=>null==h?void 0:h.state),(()=>{const{offsetX:e,offsetY:a}=(null==h?void 0:h.state)||{};g.value&&(c.offsetX=e),L.value&&(c.offsetY=a)}),{deep:!0,immediate:!0}),t((()=>{var e;v.value=null==(e=p.value)?void 0:e.parentElement})),(e,a)=>(n(),o("div",{ref_key:"swiperEl",ref:p,class:"scroll-wrap",style:O(r(P))},[k(e.$slots,"default",{},void 0,!0)],4))}}),[["__scopeId","data-v-0ba94815"]]);const Qe={class:"pro-com-table-wrap"},We={ref:"tableHeadRef",class:"com-table"},ze={class:"com-table-head"},Ge={class:"com-table-row"},Je={ref:"tableBodyRef",class:"com-table"},Ze={class:"com-table-head"},ea={class:"com-table-row"},aa={class:"com-table-body"};var la=I(e({__name:"Table",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},translateY:{type:Number,default:0}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:a}){const l=e=>{a("update:needFixed",e)};return(a,i)=>(n(),o("div",Qe,[u(He,{ref:"tableScroll",class:"pro-table-head","scroll-x":"","onUpdate:needFixed":l},{default:f((()=>[L("table",We,[L("thead",ze,[L("tr",Ge,[(n(!0),o(d,null,m(e.columns,((e,a)=>(n(),o("th",{key:a,class:P(["table-cell",`table-cell-${a}`]),style:O({minWidth:`${e.width||80}px`})},x(e.title),7)))),128))])])],512)])),_:1},512),u(He,{ref:"tableScroll",class:"pro-table-body","scroll-y":"","scroll-x":""},{default:f((()=>[L("table",Je,[L("thead",Ze,[L("tr",ea,[(n(!0),o(d,null,m(e.columns,((e,a)=>(n(),o("th",{key:a,class:P(["table-cell",`table-cell-${a}`]),style:O({minWidth:`${e.width||80}px`})},x(e.title),7)))),128))])]),L("tbody",aa,[(n(!0),o(d,null,m(e.data,((a,l)=>(n(),o("tr",{key:l,class:"com-table-row"},[(n(!0),o(d,null,m(e.columns,((e,i)=>(n(),o("td",{key:i,class:P(["table-cell"])},[L("span",null,x(e.render?e.render(a,l):a[e.key]),1)])))),128))])))),128))])],512)])),_:1},512)]))}}),[["__scopeId","data-v-f37eb4be"]]);const ia=e=>(w("data-v-0cf962f9"),e=e(),_(),e),ta={key:0,class:"pro-table-wrap"},sa={key:1,class:"no-data-wrap"},na=[ia((()=>L("img",{src:Fe,alt:"暂无数据"},null,-1))),ia((()=>L("span",null,"暂无数据～",-1)))];var oa=I(e({__name:"ProTable",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},setup(e){const i=e;a(null),a(null);const t=l({translateY:0,translateX:0,offsetX:0,offsetY:0,needFixed:!1});T("PRO_TABLE_KEY",{state:t});const s=C((()=>D(i.columns)?i.columns.filter((e=>e.fixed)):[])),d=e=>{t.needFixed=e};return(a,l)=>e.data&&e.data.length?(n(),o("div",ta,[u(la,{"translate-y":r(t).translateY,"onUpdate:translateY":l[0]||(l[0]=e=>r(t).translateY=e),columns:e.columns,data:e.data,"onUpdate:needFixed":d},null,8,["translate-y","columns","data"]),r(t).needFixed?(n(),g(la,{key:0,"translate-y":r(t).translateY,"onUpdate:translateY":l[1]||(l[1]=e=>r(t).translateY=e),class:"pro-table-fixed",style:{width:"160px"},columns:r(s),data:e.data},null,8,["translate-y","columns","data"])):c("",!0)])):(n(),o("div",sa,na))}}),[["__scopeId","data-v-0cf962f9"]]);const ua={class:"benefit-table"},ra=e({__name:"BenefitTable",props:{dataSource:null},setup(e){const a=e,l=C((()=>D(a.dataSource.headers)?a.dataSource.headers.map(((e,a)=>({title:e,key:`header_${a}`,fixed:a<2}))):[])),i=C((()=>D(a.dataSource.dataList)?a.dataSource.dataList.map((e=>{const a={};return e.forEach(((e,l)=>{a[`header_${l}`]=e})),a})):[]));return(e,a)=>(n(),o("div",ua,[u(oa,{columns:r(l),data:r(i),"is-clone":!0},null,8,["columns","data"])]))}});const da=e=>(w("data-v-5e4dfbe9"),e=e(),_(),e),ca={key:0,class:"benefit-container"},pa={key:0,class:"benefit"},va=da((()=>L("div",{class:"line"},null,-1))),ma={class:"box-title box-title-chart"},fa=da((()=>L("img",{class:"tl",src:_e,alt:""},null,-1))),ka=da((()=>L("img",{class:"transform-z180 tr",src:_e,alt:""},null,-1))),Ia={key:0},ya={class:"box"},ha={class:"box-title"},ga=da((()=>L("img",{class:"tl",src:_e,alt:""},null,-1))),La=da((()=>L("img",{class:"transform-z180 tr",src:_e,alt:""},null,-1))),ba={class:"box-price"},Va={class:"text1"},Ca={class:"text2"},Ra={key:1},Oa={key:2,style:{width:"100%, minWidth: 338px"}},Pa={class:"slider"},xa={style:{flex:"1",margin:"0px 5px"}},Ta={class:"custom-button"},Da=da((()=>L("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),wa={class:"btn-two"},_a={key:1,class:"benefit-container"},Sa={key:0},Fa={class:"benefit"},Na=da((()=>L("div",{class:"line"},null,-1))),Ea=da((()=>L("div",null,[L("div",{class:"box"},[L("p",{class:"box-title"},[L("img",{class:"tl",src:_e,alt:""}),F(" 保单年度"),L("span",null,"-"),F("年度，被保人"),L("span",null,"-"),F("岁时 "),L("img",{class:"transform-z180 tr",src:_e,alt:""})]),L("div",{class:"box-price"})])],-1))),ja={class:"slider"},Aa={class:"opt lf"},Ua={style:{flex:"1",margin:"0px 5px"}},Ma=da((()=>L("div",{class:"custom-button"},"0 岁",-1))),qa={class:"opt rg"},Ya=da((()=>L("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),Ba={class:"btn-two"},$a={key:1,class:"empty-box"},Xa=e({name:"Benefit"});var Ka=I(e({...Xa,props:{dataSource:{default:()=>({showTypeList:["1"]})},productInfo:{default:()=>null}},setup(e){var l;const i=e,t="1",p="2",v="3",k=a(0),I=a(0),y=a(0),h=a(),b=a(0),V=a(null==(l=i.dataSource.showTypeList)?void 0:l[0]),C=a(),R=e=>{if(!(null==e?void 0:e.benefitRiskResultVOList))return;const a=null==e?void 0:e.benefitRiskResultVOList[k.value];I.value=a.ageBegin+1,b.value=a.ageBegin+1,y.value=a.ageEnd},O=()=>{var e,a,l,t,s,n;const o=null==(a=null==(e=i.dataSource)?void 0:e.benefitRiskResultVOList)?void 0:a[k.value];C.value=null==(s=null==(t=null==(l=i.dataSource)?void 0:l.benefitRiskResultVOList)?void 0:t[k.value].benefitRiskTableResultVOList)?void 0:s[0];const{a:u,year:r}=((e,a)=>{const l=[],i=[];for(let t=e,s=0;t<=a;t++,s++)l.push(t.toString()),i.push(s+1);return{a:l,year:i}})(I.value,y.value),d={index:u.indexOf(b.value.toString()),age:u,year:r,result:null==(n=null==o?void 0:o.benefitRiskItemResultVOList)?void 0:n[0]};h.value=d},P=()=>{b.value>y.value-1||(b.value+=1,O())},T=()=>{b.value>I.value&&(b.value-=1,O())},D=e=>{k.value=e.name,R(i.dataSource),O()};return s((()=>i.dataSource),(e=>{var a;e&&(R(e),O(),V.value=null==(a=e.showTypeList)?void 0:a[0])}),{deep:!0,immediate:!0}),s(b,(()=>{O()})),(a,l)=>{var s;const R=A,O=we,w=U,_=M,Y=q,B=De;return(null==(s=e.dataSource)?void 0:s.benefitRiskResultVOList)?(n(),o("div",ca,[u(Y,{active:r(k),onClickTab:D},{default:f((()=>{var e;return[(n(!0),o(d,null,m(null==(e=i.dataSource)?void 0:e.benefitRiskResultVOList,((e,a)=>(n(),g(_,{key:a,name:a,title:e.riskName},{default:f((()=>{var e,s,D,_,A,U,M,q,Y,B,$,X,K,H,Q,W;return[a==r(k)?(n(),o("div",pa,[va,S(L("p",ma,[fa,F(" 保单年度"),L("span",null,x(null==(D=null==(e=r(h))?void 0:e.year)?void 0:D[null==(s=r(h))?void 0:s.index]),1),F("年度，被保人"),L("span",null,x(null==(U=null==(_=r(h))?void 0:_.age)?void 0:U[null==(A=r(h))?void 0:A.index]),1),F("岁时 "),ka],512),[[N,r(V)===p]]),r(V)===t?(n(),o("div",Ia,[L("div",ya,[L("p",ha,[ga,F(" 保单年度"),L("span",null,x(null==(Y=null==(M=r(h))?void 0:M.year)?void 0:Y[null==(q=r(h))?void 0:q.index]),1),F("年度，被保人"),L("span",null,x(null==(X=null==(B=r(h))?void 0:B.age)?void 0:X[null==($=r(h))?void 0:$.index]),1),F("岁时 "),La]),L("div",ba,[(n(!0),o(d,null,m(null==(H=null==(K=r(h))?void 0:K.result)?void 0:H.headers,((e,a)=>{var l,i,t,s,u,d,c,p,v,m;return n(),o("div",{key:a,style:{width:"33%"}},[L("p",Va,x(("0"==(null==(u=null==(s=null==(i=null==(l=r(h))?void 0:l.result)?void 0:i.dataList)?void 0:s[null==(t=r(h))?void 0:t.index])?void 0:u[a])?"0":r(E)(Number(null==(m=null==(v=null==(c=null==(d=r(h))?void 0:d.result)?void 0:c.dataList)?void 0:v[null==(p=r(h))?void 0:p.index])?void 0:m[a])))||"0"),1),L("p",Ca,x(e)+"(元）",1)])})),128))])])])):c("",!0),r(V)===v?(n(),o("div",Ra,[u(ra,{"data-source":r(C)},null,8,["data-source"])])):c("",!0),r(V)==p?(n(),o("div",Oa,[u(Se,{min:r(I),max:r(y),current:r(b),data:null==(W=null==(Q=r(h))?void 0:Q.result)?void 0:W.benefitRiskItemList},null,8,["min","max","current","data"])])):c("",!0),r(V)!=v?(n(),o(d,{key:3},[L("div",Pa,[L("div",{class:"opt lf",onClick:T},[u(R,{name:"minus"})]),L("div",xa,[r(I)?(n(),g(O,{key:0,modelValue:r(b),"onUpdate:modelValue":l[0]||(l[0]=e=>j(b)?b.value=e:null),min:r(I),max:r(y),"bar-height":"8px"},{button:f((()=>[L("div",Ta,x(r(b))+" 岁",1)])),_:1},8,["modelValue","min","max"])):c("",!0)]),L("div",{class:"opt rg",onClick:P},[u(R,{name:"plus"})])]),Da],64)):c("",!0),L("div",wa,[i.dataSource.showTypeList.includes(t)?(n(),g(w,{key:0,round:"",plain:r(V)!==t,type:"primary",class:"btn",onClick:l[1]||(l[1]=e=>V.value=t)},{default:f((()=>[F("图表展示")])),_:1},8,["plain"])):c("",!0),i.dataSource.showTypeList.includes(p)?(n(),g(w,{key:1,round:"",plain:r(V)!==p,type:"primary",class:"btn",onClick:l[2]||(l[2]=e=>V.value=p)},{default:f((()=>[F("趋势展示")])),_:1},8,["plain"])):c("",!0),i.dataSource.showTypeList.includes(v)?(n(),g(w,{key:2,round:"",plain:r(V)!==v,type:"primary",class:"btn",onClick:l[3]||(l[3]=e=>V.value=v)},{default:f((()=>[F("表格展示")])),_:1},8,["plain"])):c("",!0)])])):c("",!0)]})),_:2},1032,["name","title"])))),128))]})),_:1},8,["active"])])):(n(),o("div",_a,[i.productInfo?(n(),o("div",Sa,[u(Y,{active:r(k),onClickTab:D},{default:f((()=>[(n(),g(_,{key:1,name:1,title:e.productInfo.insureProductRiskVOList[0].riskName},{default:f((()=>[L("div",Fa,[Na,Ea,L("div",ja,[L("div",Aa,[u(R,{name:"minus"})]),L("div",Ua,[u(O,{modelValue:r(b),"onUpdate:modelValue":l[4]||(l[4]=e=>j(b)?b.value=e:null),min:0,max:80,"bar-height":"8px",disabled:""},{button:f((()=>[Ma])),_:1},8,["modelValue"])]),L("div",qa,[u(R,{name:"plus"})])]),Ya,L("div",Ba,[u(w,{round:"",plain:!0,type:"primary",class:"btn",disabled:""},{default:f((()=>[F("图表展示")])),_:1}),u(w,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:f((()=>[F("趋势展示")])),_:1}),u(w,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:f((()=>[F("表格展示")])),_:1})])])])),_:1},8,["title"]))])),_:1},8,["active"])])):(n(),o("div",$a,[u(B,{title:"试算结果正在计算中...","empty-class":"empty-select"})]))]))}}}),[["__scopeId","data-v-5e4dfbe9"]]);const Ha=(e,a,l)=>{const i=e,{holder:t}=l,s=l.insuredList[0],n=(a||"").split("_");if(n.length<2)return a;if(je(Number(n[1])))return a;if(n[1]-=1,1===i.exemptFlag){if("to"===n[0]){let e=0;1===i.exemptType?(null==t?void 0:t.birthday)&&(e=parseInt(""+((new Date).getTime()-new Date(t.birthday).getTime())/31536e6,10)):2===i.exemptType&&(null==s?void 0:s.birthday)&&(e=parseInt(""+(+(new Date).getTime()-new Date(s.birthday).getTime())/31536e6,10)),n[1]=+n[1]-e}n[0]="year"}return n.join("_")},Qa=(e,a)=>{const l=[],i={};return null==e||e.forEach((e=>{i[e.riskId]=e})),null==a||a.forEach((e=>{var a,t,s,n;const{collocationType:o,collocationRiskId:u,riskId:r}=e;switch(o){case 2:{const e=null==(a=i[r])?void 0:a.riskName,s=null==(t=i[u])?void 0:t.riskName;l.push(`${e} 和 ${s} 必须同时投保`);break}case 3:{const e=null==(s=i[r])?void 0:s.riskName,a=null==(n=i[u])?void 0:n.riskName;l.push(`${e} 和 ${a} 不能同时投保`);break}}})),l};const Wa={class:"com-body"},za={class:"trial-body"},Ga={class:"container"},Ja={class:"container"},Za={class:"container"},el=(e=>(w("data-v-48af32c8"),e=e(),_(),e))((()=>L("div",{class:"empty"},null,-1))),al=e({name:"TrialBody"});var ll=I(e({...al,props:{selfKey:{default:""},dataSource:{default:()=>[]},productInfo:{default:()=>({productCode:"",productName:"",insurerCode:"",tenantId:"",planList:[]})},tenantProductDetail:{default:()=>({})},hideBenefit:{type:Boolean,default:!1},hidePopupButton:{type:Boolean,default:!1},title:{default:"算一算保费"},defaultData:{default:null},isTrial:{type:Boolean,default:!1},defaultOrder:{default:()=>({})}},emits:["trialStart","trialEnd","update:userData","closeCustomerPopoup"],setup(e,{expose:i,emit:d}){const p=e,m=a(null),I=Y();B();const{tenantId:y,templateId:h,preview:b}=I.query,V=a(),R=l({loading:!1,show:!1,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},riskList:[{}],mainRiskVO:{},ifPersonalInfoSuccess:!1,trialMsg:"",trialResultPremium:0,trialResult:{initialPremium:0,initialAmount:0},isAniShow:!1,defaultValue:null,isAutoChange:!1,planIndex:0,isSkipFirstTrial:!1,hadSkipFirstTrial:!1,isQuerying:!1,currentPlanCode:""}),O=he();a();const P=a(),x=a(p.dataSource),T=a([]),w=e=>{const{holder:a,insuredList:l}=e||{};a&&(R.submitData.holder=a),l&&l.length>0&&l.forEach(((e,a)=>{var l;R.submitData.insuredList&&R.submitData.insuredList.length>a?R.submitData.insuredList[a]=e:((null==(l=R.submitData)?void 0:l.insuredList)||(R.submitData.insuredList=[]),R.submitData.insuredList.push(e))}))},_=C((()=>p.productInfo.planList&&p.productInfo.planList.length>2)),S=(e,a)=>{if(e){const l=["birthday","age","gender","id"];a.includes("occupationCodeList")&&l.push("occupationClass"),Object.keys(e).forEach((i=>{[...a,...l].includes(i)||(e[i]=null)}))}},F=e=>{console.log("我是客户数据",e),d("closeCustomerPopoup",e)},N=(e,a=(e=>!0))=>D(e)?e.filter(a).map((e=>e.code)):[],E=()=>{console.log("--current plan = ",x.value),console.log("---current submit = ",R.submitData);const e=Ce(R.submitData);if(!_.value)return e;const{1:a,2:l,3:i}=x.value.productFactor||{};if(e.holder&&S(e.holder,N(a)),e.insuredList){const a=["productList","beneficiaryList"],t=N(l,(e=>"2"!==String(e.subModuleType))),s=N(l,(e=>"2"===String(e.subModuleType))),n=D(s),o=N(i),u=D(o);e.insuredList.forEach(((e,l)=>{var i,r,d;S(e,[...l>=1&&n?s:t,...a,...u?["insuredBeneficiaryType"]:[]]),(null==(i=e.beneficiaryList)?void 0:i.length)>0&&(u?e.beneficiaryList.forEach((e=>S(e,o))):e.beneficiaryList.length=0),e.planCode=x.value.planCode;const c=(null==(d=null==(r=e.productList)?void 0:r[0])?void 0:d.riskList)||[],p=x.value.insureProductRiskVOList||[];if(c.length&&p){const a=c.filter((e=>null!==p.find((a=>a.riskCode===e.riskCode))));e.productList[0].riskList=a}}))}return e},j=a(),A=a({}),U=["annuityDrawDate","coveragePeriod","chargePeriod","paymentFrequency"],M=e=>{var a,l,i,t,s,n;if(null==(l=null==(a=null==e?void 0:e.data)?void 0:a[0])?void 0:l.productRiskDyInsureFactorVOList){const a=[];if(null==(i=x.value)||i.insureProductRiskVOList.forEach((l=>{var i,t;const s=null==(t=null==(i=null==e?void 0:e.data)?void 0:i[0])?void 0:t.productRiskDyInsureFactorVOList.find((e=>e.riskCode===l.riskCode));if(s){l.productRiskInsureLimitVO={...l.productRiskInsureLimitVO,...s};const e=R.riskList.find((e=>e.riskCode===l.riskCode));let i=!1;Ee.forEach((a=>{if(U.indexOf(a.valueKey)>=0){const t=l.productRiskInsureLimitVO[a.configKey];if(t&&e){const l=t.find((l=>l.code===e[a.valueKey]));if(l&&2===l.useFlag){const l=t.find((e=>1===e.defaultFlag));e[a.valueKey]=l.code,i=!0}}}})),i&&a.push({...e,...s,riskCode:l.riskCode})}})),a.length>0&&(null==(n=null==(s=null==(t=R.defaultValue)?void 0:t.insuredList)?void 0:s[0])?void 0:n.productList))return a.forEach((e=>{var a,l,i;R.defaultValue.insuredList[0].productList=null==(i=null==(l=null==(a=R.defaultValue)?void 0:a.insuredList)?void 0:l[0])?void 0:i.productList.map((a=>(a.riskList=null==a?void 0:a.riskList.map((a=>(a.riskCode===e.riskCode&&(a=e),a))),a)))})),!1}return!0},q=$((async(e,a=!0)=>{R.trialMsg="试算中...",R.trialResultPremium=0,R.loading=!0,d("trialStart");let l=!1;if(a){const{code:a}=await ne(e);l="10000"===a}!l&&a||(R.isQuerying=!0,p.hideBenefit||oe(e).then((e=>{e.data&&e.code===X&&(A.value=e.data)})).finally((()=>{R.loading=!1})),ue(e).then((a=>{var l,i;if(a.data&&a.code===X){(null==(l=null==a?void 0:a.data)?void 0:l.errorInfo)&&K(`${null==(i=null==a?void 0:a.data)?void 0:i.errorInfo}`),R.trialMsg="",R.trialResultPremium=a.data.initialPremium,R.trialResult=a.data;const t={};a.data.riskPremiumDetailVOList&&a.data.riskPremiumDetailVOList.length&&a.data.riskPremiumDetailVOList.forEach((e=>{t[e.riskCode]={initialAmount:e.initialAmount,initialPremium:e.initialPremium}})),j.value=t,d("trialEnd",a.data,e)}})).finally((()=>{R.loading=!1,R.isQuerying=!1})))}),500),J=$((async()=>{console.log(">>>>>调用试算<<<<<",R.ifPersonalInfoSuccess,V.value.canTrail());const{productCode:e,productName:a}=p.productInfo||{};if(R.ifPersonalInfoSuccess||V.value.canTrail()){R.submitData.productCode=e,R.submitData.productName=a,R.submitData.tenantId=p.productInfo.tenantId,R.riskList=R.riskList.map((e=>(e=>{var a,l,i,t;const s=null==(a=x.value.insureProductRiskVOList)?void 0:a.find((a=>e.riskId===a.riskId));if(s&&1!==s.mainRiskFlag){const a=null==(i=null==(l=x.value)?void 0:l.productRiskRelationVOList)?void 0:i.filter((e=>{var a;if(e.collocationRiskId===s.riskId&&3!==e.collocationType){const l=null==(a=x.value.insureProductRiskVOList)?void 0:a.find((a=>e.riskId===a.riskId));if(l&&l.riskType===Ne.MAIN_RISK)return!0}return!1})),n=a.length>0?a[0]:null;if(n){const a=null==(t=R.riskList)?void 0:t.find((e=>e.riskId===n.riskId));Ee.forEach((l=>{l.ruleKey&&s.productRiskInsureLimitVO&&a&&(1===s.productRiskInsureLimitVO[l.ruleKey]&&(e[l.valueKey]=a[l.valueKey]),3===s.productRiskInsureLimitVO[l.ruleKey]&&(1!==s.exemptFlag?e[l.valueKey]=Ha(s,a[l.valueKey],R.submitData):e[l.valueKey]=Ha(s,a[l.ruleValueKey],R.submitData)))}))}}return e})(e))),R.submitData.insuredList&&R.submitData.insuredList.forEach((l=>{l.productList=[{productCode:e,productName:a,riskList:R.riskList}]}));const l=E();console.log(">>>数据构建<<<",l),await q(l)}}),300),Z=async e=>{console.log("人的信息更改了"),w(e),R.ifPersonalInfoSuccess=!0,console.log("处理第一被保人修改的dy变化"),J()};C((()=>{var e;return((null==(e=R.userData)?void 0:e.insuredList)||[]).map((e=>e.birthday)).join(",")})),s((()=>{var e;return((null==(e=R.userData)?void 0:e.insuredList)||[]).map((e=>e.birthday)).join(",")}),$((async e=>{var a;if(x.value.insureProductRiskVOList&&e){const e=R.userData.insuredList.filter((e=>e.birthday))||[];if(!e.length)return;const l=await re({calcProductFactorList:[{planCode:x.value.planCode,productCode:p.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:null==(a=x.value.insureProductRiskVOList)?void 0:a[0]}]}],insuredVOList:e});M(l)}})),{});const ee=async(e,a)=>{var l,i;if(a){const t=Ce(e);delete t.insurancePeriodValueList,delete t.paymentFrequencyList,delete t.paymentPeriodValueList;if(U.indexOf(a.key)>=0&&`${a.oldValue}`!=`${a.newValue}`){const s={};switch(a.key){case"annuityDrawDate":s.changeType=3;break;case"coveragePeriod":s.changeType=2;break;case"chargePeriod":s.changeType=1;break;case"paymentFrequency":s.changeType=4}const n=null==(i=null==(l=x.value)?void 0:l.insureProductRiskVOList)?void 0:i.find((a=>a.riskCode===e.riskCode));if(!R.isAutoChange){R.isQuerying=!0;const a=R.userData.insuredList.filter((e=>e.birthday))||[];if(!a.length)return!1;const l=await re({calcProductFactorList:[{planCode:x.value.planCode,productCode:p.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:n,insureRiskEditReqVO:{riskId:e.riskId,riskCode:e.riskCode,...t,...s}}]}],insuredVOList:a});R.isQuerying=!1;const i=M(l);return i||(R.isAutoChange=!0),i}R.isAutoChange=!1}}return!0},ae=async(e,a)=>{R.mainRiskVO=e;await ee(e,a)&&(R.riskList.length>0&&(R.riskList[0]=e),console.log("标准险种的信息回传",e),J())},le=async(e,a)=>{if(R.riskList=[R.mainRiskVO,...e],console.log("附加险列表数据回传",e),a){const l=e.find((e=>e.riskCode===a.riskCode));if(!(await ee(l,a)))return}J()},ie=e=>{var a,l,i,t;R.userData=e,R.defaultValue=e;const s=(null==(a=e.insuredList)?void 0:a[0].productList.findIndex((e=>e.planCode===x.value.planCode)))||0;R.planIndex=-1===s?0:s,R.riskList=(null==(t=null==(i=null==(l=null==e?void 0:e.insuredList)?void 0:l[0].productList)?void 0:i[R.planIndex])?void 0:t.riskList)||[],q(e,!0)},te=async e=>{var a;if(p.defaultData){const e=p.defaultData.find((e=>e.productCode===p.productInfo.productCode))||p.defaultData[0];ie(e),w(null==(a=p.defaultData)?void 0:a[0])}else T.value.push(x.value.planCode),await(async()=>{var e;const a=await de({calcProductFactorList:[{planCode:x.value.planCode,productCode:p.productInfo.productCode}]});if(a.data){const l=a.data.find((e=>e.productCode===p.productInfo.productCode))||a.data[0];ie(l),w(null==(e=a.data)?void 0:e[0])}})()},se=async e=>{var a,l;const i=p.productInfo.planList.findIndex((a=>a.planCode===e)),t=(null==(l=null==(a=R.defaultValue)?void 0:a.insuredList)?void 0:l[0].productList.findIndex((a=>a.planCode===e)))||0,s=i>=0?p.productInfo.planList[i]:null;s&&(R.currentPlanCode=e,x.value=s,R.planIndex=t>=0?t:0,R.defaultValue.insuredList[0].productList[R.planIndex].riskList=R.riskList,T.value.findIndex((a=>a===e))<0&&T.value.push(e))};v((()=>{var e,a;R.select={},R.list=[],R.userData={},R.riskIsInsure={},R.submitData={},R.riskList=[{}],R.mainRiskVO={},R.ifPersonalInfoSuccess=!1,R.trialMsg="",R.trialResultPremium=0,R.riskIsInsure={},null==(a=null==(e=x.value)?void 0:e.insureProductRiskVOList)||a.forEach((e=>{var a;const l=null==(a=x.value.productRiskRelationVOList)?void 0:a.find((a=>a.collocationRiskId===e.riskId));l&&(R.riskIsInsure[e.riskCode]={selected:"2",data:null,relation:l})}))})),t((()=>{x.value=p.dataSource,R.loading=!0,R.show=!0,R.isAniShow=!0,R.isSkipFirstTrial=!0,R.hadSkipFirstTrial=!1,H((()=>{te()}))}));return i({getTrialSuccessFlag:()=>R.trialResultPremium>0,validate:()=>V.value.validate(!1),validateTrialFields:()=>V.value.validateTrialFields(),validateHolder:e=>{var a;return null==(a=V.value)?void 0:a.validateHolder(e)},getUserData:()=>({...R.userData}),onShare:e=>{var a;R.trialResultPremium&&(null==(a=m.value)||a.validate().then((()=>{Object.assign(O.value,p.defaultOrder,{extInfo:{...O.value.extInfo,buttonCode:be.TRIAL_PREMIUM,pageCode:Le.TRIAL_PREMIUM,templateId:h}});const a=Ve(p.productInfo,j.value,O.value);me(a,((a,l)=>{l===W.JUMP_PAGE&&(P.value.link=`${window.location.href}&isShare=1&orderNo=${a.orderNo}`,e())})),console.log("---- validate success ----")})))},onNext:()=>{var e;const{productCode:a,productName:l}=p.productInfo;b?Q(Le.TRIAL_PREMIUM,I.query):R.trialResultPremium&&(null==(e=m.value)||e.validate().then((()=>{Object.assign(O.value,p.defaultOrder,{extInfo:{templateId:h,...O.value.extInfo,...p.defaultOrder.extInfo||{},buttonCode:be.TRIAL_PREMIUM,pageCode:Le.TRIAL_PREMIUM}}),console.log("dealMixData()",E());const e=Ve({...E(),productCode:a,productName:l},R.trialResult,O.value);me(e,((e,a)=>{a===W.JUMP_PAGE&&z(e.nextPageCode,{...I.query,orderNo:e.orderNo})})),console.log("---- validate success ----")})),R.loading=!1,R.show=!0,R.isAniShow=!0)},dealMixData:E}),s((()=>R.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),s((()=>R.userData),(e=>{if(e){const{holder:a,insuredList:l}=e||{},i={holder:a,insuredList:l};Object.assign(R.submitData,i),d("update:userData",i)}}),{deep:!0}),s((()=>p.dataSource),(e=>{x.value=e}),{deep:!0,immediate:!0}),(a,l)=>{var i,t,s,d,p,v,I,y;const h=G;return n(),o("div",Wa,[k(a.$slots,"trialHead",{},void 0,!0),L("div",za,[u(ge,{labels:r(Qa)((null==(i=x.value)?void 0:i.insureProductRiskVOList)||[],x.value.productRiskRelationVOList)},null,8,["labels"]),L("div",Ga,[!e.hideBenefit&&(null==(t=A.value)?void 0:t.benefitRiskResultVOList)?(n(),g(Ka,{key:0,class:"benefit-wrap","data-source":A.value,"product-info":x.value,"show-type-list":A.value.showTypList},null,8,["data-source","product-info","show-type-list"])):c("",!0),r(_)?(n(),g(Ke,{key:1,"plan-list":e.productInfo.planList,"default-plan":x.value,onPlanChange:se},null,8,["plan-list","default-plan"])):c("",!0),x.value.productFactor?(n(),g(r(xe),{ref_key:"personalInfoRef",ref:V,key:x.value.planCode,modelValue:r(R).userData,"onUpdate:modelValue":l[0]||(l[0]=e=>r(R).userData=e),"is-trial":e.isTrial,"product-factor":x.value.productFactor,"multi-insured-config":null==(s=x.value)?void 0:s.multiInsuredConfigVO,onTrailChange:Z,onCloseCustomerPopoup:F},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):c("",!0)]),u(h,{size:"large"}),L("div",Ja,[(n(),g(Ue,{ref_key:"insureInfosRef",ref:m,key:x.value.planCode,"origin-data":null==(d=x.value.insureProductRiskVOList)?void 0:d[0],"product-factor":x.value.productFactor,"default-value":r(R).defaultValue?null==(v=null==(p=r(R).defaultValue)?void 0:p.insuredList[0].productList[r(R).planIndex])?void 0:v.riskList[0]:null,"trial-result":r(R).trialResult,onTrialChange:ae},null,8,["origin-data","product-factor","default-value","trial-result"]))]),L("div",Za,[x.value.insureProductRiskVOList?(n(),g(Be,{key:x.value.planCode,"data-source":x.value,"show-main-risk":!1,"default-value":r(R).defaultValue?null==(y=null==(I=r(R).defaultValue)?void 0:I.insuredList[0].productList[r(R).planIndex])?void 0:y.riskList:[],onTrialChange:le},{holderForm:f((()=>{var a;return[e.isTrial&&e.dataSource.productFactor?(n(),g(r(xe),{key:0,ref_key:"personalInfoRef",ref:V,modelValue:r(R).userData,"onUpdate:modelValue":l[1]||(l[1]=e=>r(R).userData=e),"is-trial":e.isTrial,"is-only-holder":!0,"product-factor":e.dataSource.productFactor,"multi-insured-config":null==(a=e.dataSource)?void 0:a.multiInsuredConfigVO,onTrailChange:Z},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):c("",!0)]})),_:1},8,["data-source","default-value"])):c("",!0)]),el]),k(a.$slots,"trialBtn",{trialData:r(R).submitData,riskPremium:r(R).trialResult,loading:r(R).isQuerying,personalInfoRef:V.value},void 0,!0)])}}}),[["__scopeId","data-v-48af32c8"]]);const il={class:"long-info-collection"},tl=e({__name:"infoCollection",setup(e){const i=J((()=>Z((()=>import("./index-17c78dd7.js")),["static/js/index-17c78dd7.js","static/css/index-fa4edf2a.css","static/js/index-e55a5aab.js","static/css/index-887396aa.css","static/js/theme-94cf7d00.js","static/js/index-1c351f68.js","static/css/index-bbfdd7ec.css","static/js/utils-9eb3d524.js","static/js/infoCollection-ede4c173.js","static/js/trial-5aa151d8.js"]))),t=J((()=>Z((()=>import("./index-23561fc5.js")),["static/js/index-23561fc5.js","static/css/index-bf024e9b.css","static/js/index-e55a5aab.js","static/css/index-887396aa.css"]))),s=Y(),d=he(),{productCode:p="",tenantId:m,agentCode:k="",agencyCode:I,saleChannelId:y,isShare:h,orderNo:L,extraInfo:b,insurerCode:V,preview:R}=s.query;let O={};try{O=JSON.parse(decodeURIComponent(b))}catch(De){}const P=l({isView:!1,personalInfo:{},payInfo:{schema:[],config:[],formData:[]},defaultValue:null,isAutoChange:!1,defaultPlanCode:"",userData:{}}),x=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`,T=a({imgUrl:"",desc:"",title:"",link:x}),D=a();a();const w=a(),_=a({}),S=a({}),N=a([]),E=a(),A=a({}),U=a(!1),M=a(!1),q=a(0),B=a(!0),{fileList:$,mustReadFileCount:X,popupFileList:H}=fe(A,E),G=a(!1),ne=a(!1),oe=()=>{M.value=!1,B.value=!0,N.value.length<1||(U.value=!0)},ue=()=>{U.value=!1,M.value=!1,B.value=!0};a({}),a(!1),a([{}]);const re=a(""),de=a(0),ge=a(!1);a(),a(),a(),C((()=>{var e,a;const{insureProductRiskVOList:l}=(null==(a=null==(e=S.value)?void 0:e.productPlanInsureVOList)?void 0:a[0])||{};return(l||[]).find((e=>e.mainRiskFlag===ee.YES))}));const Ce=a(0);a({});const Re=a(),Oe=()=>{re.value="试算中...",de.value=0,ge.value=!0},Pe=(e,a)=>{re.value="",Ce.value=e.premium,de.value=e,Re.value=a,ge.value=!1},xe=async()=>{var e,a;if(R)return void Q(Le.INFO_COLLECTION,s.query);if(!de.value)return;const l=[];w.value&&l.push(null==(e=w.value)?void 0:e.validate(!1)),D.value&&l.push(null==(a=D.value)?void 0:a.validate(!1)),Promise.all(l).then((()=>{if(!G.value)return void K("请勾选投保人阅读并接受");Object.assign(d.value,{extInfo:{...d.value.extInfo,buttonCode:be.INFO_COLLECTION,pageCode:Le.INFO_COLLECTION}});const e=w.value.dealMixData(),a=Ve({...e,productCode:p,productName:S.value.productName},de.value,d.value);me(a,((e,a)=>{a===W.JUMP_PAGE&&z(e.nextPageCode,s.query)}))}))};l({tenantOrderPayInfoList:[]});const Te=async()=>{ke({productCode:p,tenantId:m}).then((({data:e,code:a})=>{if("10000"===a){_.value=e;const{wxShareConfig:a,showWXShare:l,title:i,desc:t,image:s}=(null==e?void 0:e.PRODUCT_LIST)||{};l?Object.assign(T.value,{...a,imgUrl:a.image,isShare:l}):Object.assign(T.value,{title:i,desc:t,imgUrl:s,isShare:l}),e.BASIC_INFO&&e.BASIC_INFO.themeType&&ae(e.BASIC_INFO.themeType)}})),L&&await ce({orderNo:L,tenantId:m}).then((({code:e,data:a})=>{var l;if("10000"===e){if(de.value=a.orderAmount,(null==(l=a.insuredList)?void 0:l.length)>0){const{planCode:e}=a.insuredList[0];P.defaultPlanCode=e}Object.assign(d.value,a,{tenantOrderPayInfoList:a.tenantOrderPayInfoList||[],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0,withPayInfo:!0},productCode:p}),P.defaultValue=d.value,ne.value=!0}})),Ie({productCode:p}).then((({code:e,data:a})=>{var l,i,t,s;if("10000"===e){const{productMaterialPlanVOList:e,productQuestionnaireVOList:n}=a;E.value=e||[];const{basicInfo:{questionnaireType:o},questions:u,questionnaireName:r}=(null==(l=null==n?void 0:n[0])?void 0:l.questionnaireDetailResponseVO)||{basicInfo:{}};o&&(N.value=2===o?[{attachmentName:r,attachmentUri:u,attachmentType:"question"}]:[{attachmentName:r,attachmentUri:null==(i=null==u?void 0:u[0])?void 0:i.content,attachmentType:ye(String(null==(t=null==u?void 0:u[0])?void 0:t.textType),null==(s=null==u?void 0:u[0])?void 0:s.content)}])}})),await pe({productCode:p,isTenant:!R}).then((({data:e,code:a})=>{var l;if("10000"===a){S.value=e,A.value=e.productPlanInsureVOList.find((e=>!P.defaultPlanCode||e.planCode===P.defaultPlanCode))||{};const{payInfo:a}=le(null==(l=A.value)?void 0:l.productFactor);P.payInfo={...P.payInfo,...a}}}))};return v((()=>{Te()})),(e,a)=>{var l,s,v,k,I,y;const L=ie,b=te;return n(),o("div",il,[u(L),r(ne)||r(R)?(n(),g(ll,{key:0,ref_key:"personalInfoRef",ref:w,"data-source":r(A),"product-info":{productCode:r(p),productName:r(S).productName,insurerCode:r(V),tenantId:r(m),planList:r(S).productPlanInsureVOList},"tenant-product-detail":r(_),"hide-benefit":"","default-data":[r(P).defaultValue],onTrialStart:Oe,onTrialEnd:Pe,"onUpdate:userData":a[0]||(a[0]=e=>r(P).userData=e)},null,8,["data-source","product-info","tenant-product-detail","default-data"])):c("",!0),r(P).payInfo.schema.length?(n(),g(r(se),{key:1,ref_key:"payInfoRef",ref:D,modelValue:r(d).tenantOrderPayInfoList,"onUpdate:modelValue":a[1]||(a[1]=e=>r(d).tenantOrderPayInfoList=e),schema:r(P).payInfo.schema,"is-view":r(P).isView,"user-data":r(P).userData},null,8,["modelValue","schema","is-view","user-data"])):c("",!0),u(b,null,{default:f((()=>{var e;return[(null==(e=r($))?void 0:e.length)?(n(),g(r(t),{key:0,modelValue:r(G),"onUpdate:modelValue":a[2]||(a[2]=e=>j(G)?G.value=e:null),"has-bg-color":!1,"attachment-list":r($),"is-show-radio":"","pre-text":"投保人阅读并接受",onPreviewFile:a[3]||(a[3]=e=>(e=>{q.value=e,M.value=!0})(e))},null,8,["modelValue","attachment-list"])):c("",!0)]})),_:1}),r(M)?(n(),g(r(i),{key:2,show:r(M),"onUpdate:show":a[4]||(a[4]=e=>j(M)?M.value=e:null),"content-list":r(B)?r($):r(H),"is-only-view":r(B),"active-index":r(q),text:r(B)?"关闭":"我已逐页阅读并确认告知内容","force-read-count":r(B)?0:r(X),onSubmit:oe,onOnCloseFilePreviewByMask:ue},null,8,["show","content-list","is-only-view","active-index","text","force-read-count"])):c("",!0),u(ve,{"is-share":r(T).isShare&&!r(h),premium:null==(l=r(de))?void 0:l.initialPremium,"share-info":r(T),"loading-text":r(re),"payment-frequency":(null==(y=null==(I=null==(k=null==(v=null==(s=r(Re))?void 0:s.insuredList)?void 0:v[0].productList)?void 0:k[0].riskList)?void 0:I[0])?void 0:y.paymentFrequency)+"","tenant-product-detail":r(_),"handle-share":e=>(e=>{w.value.validateHolder(["mobile"]).then((()=>{Object.assign(d.value,{extInfo:{...d.value.extInfo,buttonCode:be.INFO_COLLECTION,pageCode:Le.INFO_COLLECTION}});const a=w.value.getUserData(),l=Ve({...Re.value,holder:null==a?void 0:a.holder},de.value||{},d.value);me(l,((a,l)=>{l===W.JUMP_PAGE&&(null==e||e())}))})).catch((()=>{K("请录入投保人手机号后进行分享")}))})(e),disabled:!r(de),onHandleClick:xe},{default:f((()=>[F("下一步")])),_:1},8,["is-share","premium","share-info","loading-text","payment-frequency","tenant-product-detail","handle-share","disabled"])])}}});export{tl as default};
