import{d as k}from"./vendor-d350434b.js";import{I as v,R as F,g as B}from"./infoCollection-6431f35d.js";import{b as Y,a as x,R as h,i as M}from"./trial-41713e63.js";import{a6 as S,K as p,C as R,J as y,a3 as K}from"./index-beb6065e.js";const W=e=>{const{tenantId:t,riskList:n,riskPremium:i,productId:a}=e;return n.map(r=>{var o;return{tenantId:t,amountUnit:1,annuityDrawFrequency:r.annuityDrawDate,annuityDrawType:r.annuityDrawType,paymentFrequency:r.paymentFrequency,paymentPeriod:r.chargePeriod.split("_")[1],paymentPeriodType:Y[r.chargePeriod.split("_")[0]],insurancePeriodType:x[r.coveragePeriod==="to_life"?"to_life":r.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+r.coveragePeriod.split("_")[1])?0:r.coveragePeriod.split("_")[1],riskCode:r.riskCode,riskType:r.riskType,riskName:r.riskName,extInfo:{riskId:r.riskId,copy:r.copy},initialPremium:(o=i[r.riskCode])==null?void 0:o.premium,liabilityDetails:r.liabilityVOList.map(s=>({liabilityCode:s.liabilityCode,liabilityName:s.liabilityName,refundMethod:s.liabilityAttributeValue})),productId:a,currentAmount:r.amount,initialAmount:r.amount}})},ee=e=>{const t=e.find(a=>a.riskType===h.MAIN_RISK),n=e.filter(a=>a.riskType===h.RIDER_RISK),i=a=>a.map(r=>{const{riskCategory:l,riskCode:o,riskType:s,id:d,riskInsureLimitVO:m,riskCalcMethodInfoVO:c}=r,{annuityDrawFrequencyList:u,annuityDrawValueList:I,insurancePeriodValueList:f,paymentFrequencyList:N,paymentPeriodValueList:C}=m,{minCopy:_,maxCopy:g,fixedAmount:V,singeAmount:O}=c;return{amount:V||O,annuityDrawDate:I==null?void 0:I[0],annuityDrawFrequency:u==null?void 0:u[0],chargePeriod:C==null?void 0:C[0],copy:_||g||0,coveragePeriod:f==null?void 0:f[0],liabilityVOList:r.riskLiabilityInfoVOList,mainRisk:r.riskCode===t.riskCode,mainRiskCode:r.riskCode===t.riskCode?t.riskCode:void 0,mainRiskId:r.riskCode===t.riskCode?t.riskId:void 0,paymentFrequency:N==null?void 0:N[0],riderRisk:!0,riderRiskVOList:i(n),riskCategory:l,riskCode:o,riskId:d,riskType:s}});return i([t])},E=(e,t,n=[],i=B.YEAR,a=!1)=>{const r=e.filter(o=>{try{return o.extraInfo?JSON.parse(o.extraInfo).packageCode?!!n.includes(o.id):!0:!1}catch{return!1}});console.log("lastRiskList",r);const l=r.find(o=>o.riskType===h.MAIN_RISK);return r.map(o=>{const{riskInsureLimitVO:s,riskCategory:d,id:m,riskType:c,riskName:u,riskCode:I,extraInfo:f,riskLiabilityInfoVOList:N,riskCalcMethodInfoVO:C}=o,{insurancePeriodType:_,insurancePeriodValueList:g,paymentFrequencyList:V,paymentPeriodValueList:O,paymentPeriodType:$,annuityDrawFrequencyList:L,annuityDrawValueList:b,insurancePeriodRule:U,paymentPeriodRule:H}=s,{fixedAmount:w,minCopy:q}=C,T={amount:w,riskCode:I,riskId:m,riskName:u,paymentFrequency:i,extraInfo:f,chargePeriod:O==null?void 0:O[0],annuityDrawDate:b==null?void 0:b[0],riskType:c,annuityDrawFrequency:L==null?void 0:L[0],copy:q,coveragePeriod:g==null?void 0:g[0],insuredCode:t==null?void 0:t.insurerCode,liabilityVOList:N,riskCategory:d};return c===h.MAIN_RISK?T:(U===M.ONE_YEAR&&(T.coveragePeriod="year_1"),H===M.ONE_YEAR&&(T.chargePeriod="year_1"),{...T,mainRiskId:l==null?void 0:l.id,mainRiskCode:l==null?void 0:l.riskCode})})},re=e=>{var n,i,a;return{orderAmount:e.premium,tenantId:e.tenantId,venderCode:(n=e.detail)==null?void 0:n.insurerCode,applicationNo:e.applicationNo,policyNo:e.policyNo,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:e.orderCategory,orderStatus:e.orderStatus,orderTopStatus:e.orderTopStatus,tenantOrderHolder:{tenantId:e.tenantId,name:e.holder.name,certNo:e.holder.certNo,certType:R.CERT,mobile:e.holder.mobile,birthday:p(e.holder.certNo),gender:y(e.holder.certNo),extInfo:{hasSocialInsurance:e.holder.socialFlag}},extInfo:{extraInfo:{renewalDK:e.renewalDK,paymentMethod:e.paymentMethod,paymentFrequency:e.paymentFrequency,successJumpUrl:e.successJumpUrl},iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{tenantId:e.tenantId,relationToHolder:e.insured.relationToHolder,certNo:e.insured.certNo,certType:R.CERT,name:e.insured.name,mobile:e.insured.relationToHolder===F.SELF?e.holder.mobile:"",birthday:p(e.insured.certNo),gender:y(e.insured.certNo),extInfo:{hasSocialInsurance:e.insured.socialFlag},tenantOrderProductList:[{tenantId:e.tenantId,productCode:(i=e.detail)==null?void 0:i.productCode,productName:(a=e.detail)==null?void 0:a.productName,premium:e.premium,tenantOrderRiskList:e.tenantOrderRiskList}]}]}},P=(e,t)=>{if(!e)return"";const[n,i]=e.split("_"),a=parseInt(i,10);return n==="day"?k(t).add(a,"day").format("YYYY-MM-DD"):k(t).add(a,"year").format("YYYY-MM-DD")},D=(e,t=k().format("YYYY-MM-DD"))=>k(e).diff(t,"day"),J=(e,t,n)=>{const i=P(e,n),a=P(t,n);return D(i)<=1&&D(a)>=0},te=e=>{const{riskCode:t,liabilityCode:n,birth:i,sex:a}=e,r=P("max_18",i);return console.log("lastDate",r),console.log("diffDate(lastDate)",D(r)),!(t==="7Y7"&&n==="FXG086"&&!(a===K.FEMALE&&D(r)<=0))},A=(e,t,n=i=>!0)=>{const i=p(t),a=y(t),r=[];return e.forEach(l=>{const{riskDetailVOList:o}=l,s=o.map(d=>{const{maxHolderAge:m,minHolderAge:c}=d.riskInsureLimitVO;return J(c,m,i)?(d.riskLiabilityInfoVOList=d.riskLiabilityInfoVOList.filter(u=>n({riskCode:d.riskCode,liabilityCode:u.liabilityCode,birth:i,sex:a})),d):null});r.push({riskDetailVOList:s.filter(d=>!!(d&&d.riskLiabilityInfoVOList.length>0))})}),r},ne=(e,t=!1,n=i=>!0)=>{var r,l,o;let i=[];if(t)i=E((l=(r=A(S(e.insureDetail.productRiskVoList),e.insured.certNo,n))==null?void 0:r[0])==null?void 0:l.riskDetailVOList,e.productDetail,[],e.paymentFrequency,t);else{const s=A(S(e.insureDetail.productRiskVoList),e.insured.certNo,n);console.log("===result",[...s]),i=s.map(d=>E(d.riskDetailVOList,e.productDetail,e.packageRiskIdList,e.paymentFrequency,t))}return{calcData:{holder:{personVO:{birthday:p(e.holder.certNo),certType:R.CERT,certNo:e.holder.certNo,gender:Number(y(e.holder.certNo)),mobile:e.holder.mobile,name:e.holder.name,socialFlag:e.holder.socialFlag}},insuredVOList:[{insuredCode:(o=e.productDetail)==null?void 0:o.insurerCode,relationToHolder:e.insured.relationToHolder,personVO:{birthday:p(e.insured.certNo),certType:R.CERT,certNo:e.insured.certNo,gender:Number(y(e.insured.certNo)),name:e.insured.name,socialFlag:e.insured.socialFlag},productPlanVOList:[{riskVOList:i.flat()}]}],productCode:e.productDetail.productCode,tenantId:e.tenantId},riskVOList:i.flat()}},ie=e=>e&&e.length?e.filter(n=>n.value===v.INSURE).map(n=>n.productRiskVoList.map(i=>i.id)).flat():[],ae=e=>{let t=(Math.round(parseFloat(e.toString())*100)/100).toString();const n=t.toString().split(".");return n.length===1?(t=`${t.toString()}.00`,t):n.length>1?(n[1].length<2&&(t=`${t.toString()}0`),t):e},oe=(e,t="year")=>k().diff(p(e),t,!0),z=e=>!e||Number.isNaN(+e.split("_")[1])?0:e==null?void 0:e.split("_")[1],X=e=>{const{tenantId:t,riskList:n,riskPremium:i,productId:a}=e;return n.map(r=>{var o,s,d,m,c;return{tenantId:t,amountUnit:1,annuityDrawFrequency:r.annuityDrawDate,annuityDrawType:r.annuityDrawType,paymentFrequency:r.paymentFrequency,paymentPeriod:0,paymentPeriodType:(o=Y)==null?void 0:o[r.chargePeriod],insurancePeriodType:x[r.coveragePeriod==="to_life"?"to_life":(d=(s=r.coveragePeriod)==null?void 0:s.split("_"))==null?void 0:d[0]],insurancePeriodValue:z(r.coveragePeriod),riskCode:r.riskCode,riskType:r.riskType,riskName:r.riskName,extInfo:{riskId:r.riskId,copy:r.copy},initialPremium:(m=i[r.riskCode])==null?void 0:m.premium,liabilityDetails:(c=r.liabilityVOList)==null?void 0:c.map(u=>({liabilityCode:u.liabilityCode,liabilityName:u.liabilityName,refundMethod:u.liabilityAttributeValue})),productId:a,currentAmount:r.amount,initialAmount:r.amount}})},se=e=>{var n,i,a;return console.log(e,"sksksk"),{buttonCode:e.buttonCode,templateId:1,orderAmount:0,tenantId:e.tenantId,venderCode:e.insureDetail.productBasicInfoVO.insurerCode,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:"1",tenantOrderHolder:{tenantId:e.tenantId,name:e.order.tenantOrderHolder.name,certNo:e.order.tenantOrderHolder.certNo,certType:e.order.tenantOrderHolder.certEndType,mobile:e.order.tenantOrderHolder.mobile,birthday:p(e.order.tenantOrderHolder.certNo),gender:y(e.order.tenantOrderHolder.certNo)},extInfo:{extraInfo:{renewalDK:e.renewalDK,paymentMethod:e.paymentMethod,paymentFrequency:e.paymentFrequency,successJumpUrl:e.successJumpUrl},buttonCode:e.buttonCode,iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{tenantId:e.tenantId,relationToHolder:e.order.tenantOrderInsuredList[0].relationToHolder,certNo:e.order.tenantOrderInsuredList[0].certNo,certType:e.order.tenantOrderInsuredList[0].certEndType,name:e.order.tenantOrderInsuredList[0].name,mobile:e.order.tenantOrderInsuredList[0].relationToHolder===F.SELF?e.order.tenantOrderHolder.mobile:"",birthday:p(e.order.tenantOrderInsuredList[0].certNo),gender:y(e.order.tenantOrderInsuredList[0].certNo),tenantOrderProductList:[{tenantId:e.tenantId,productCode:(n=e.insureDetail)==null?void 0:n.productBasicInfoVO.productCode,productName:(i=e.insureDetail)==null?void 0:i.productBasicInfoVO.productName,premium:0,tenantOrderRiskList:X({tenantId:e.tenantId,riskList:E(e.insureDetail.productRiskVoList[0].riskDetailVOList,e.detail),riskPremium:{},productId:(a=e.detail)==null?void 0:a.id})}]}],operateOption:{withHolderInfo:!0,withInsuredInfo:!0,withProductInfo:!0}}};export{re as a,oe as b,ae as c,se as f,ne as g,ie as o,ee as r,W as t,te as v};
