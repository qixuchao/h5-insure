import{d as e,h as a,o as t,c as l,a as s,e as n,b as o,w as d,F as i,s as r,p as c,u,_ as v,bo as p,bp as m,di as f,i as b,j as g,k as y,E as h,l as _,q as k,dL as I,f as N,a_ as j,T as C,z as S}from"./index-a46ed5f2.js";import{L as w}from"./index-cff5fcdc.js";import{I as D}from"./infoItem-b8283189.js";import{O as q}from"./OperateBtn-d11f4e2b.js";import{t as x}from"./format-31cde443.js";import{q as L}from"./order-1e0faf7b.js";const O={class:"com-order-item"},T={class:"header"},U={class:"product-name"},V={class:"status"},z={class:"info"},E={class:"content-list"},R={class:"info-bottom"},A=(e=>(p("data-v-473dcbcc"),e=e(),m(),e))((()=>s("div",{style:{width:"25%"}},[s("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),B={class:"footer"};var F=v(e({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:v}){const p=v;a();const m=()=>{p("afterDelete")};return(a,v)=>{var p;return t(),l("div",O,[s("div",T,[s("div",U,n(e.detail.productName),1),s("div",V,n(e.detail.orderStatusDesc),1)]),s("div",z,[o(D,{label:"订单号",content:e.detail.orderNo,line:"","is-copy":""},null,8,["content"]),o(D,{label:"投/保单号",line:""},{content:d((()=>[s("div",E,[(t(!0),l(i,null,r(e.detail.policyNo||e.detail.applicationNo||[""],(e=>(t(),c(D,{key:e,"is-copy":"",content:e},null,8,["content"])))),128))])])),_:1}),s("div",R,[s("div",null,[o(D,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),o(D,{label:"被保险人",content:null==(p=e.detail.insuredName)?void 0:p[0],line:""},null,8,["content"]),o(D,{label:"创建时间",content:e.detail.orderStartDate,line:""},null,8,["content"]),o(D,{label:"保费",content:u(x)(e.detail.premium),line:""},null,8,["content"])]),A])]),s("div",B,[o(q,{detail:e.detail,onRefreshOrder:m},null,8,["detail"])])])}}}),[["__scopeId","data-v-473dcbcc"]]);const G={id:"page-order",class:"page-order"};var H=v(e({__name:"index",setup(e){f(),a();const n=b(),{type:v,tenantId:p,agentCode:m}=n.query,D=g({"-1":1,0:2,1:3,2:4}[v]||0),q=g(1),x=g(!1),O=g(!1),T=g(!1),U=g([]),V=g(""),z=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"3"},{title:"已失效",status:"2"}],E=y((()=>(U.value=[],z[D.value].status))),R=()=>{C.loading({message:"加载中...",forbidClick:!0}),x.value=!0,L({condition:{orderTopStatus:E.value,tenantId:p,agentCode:m,keyword:V.value},pageSize:10,pageNum:q.value}).then((e=>{const{code:a,data:t}=e;"10000"===a&&t&&(x.value=!1,O.value=!1,1===q.value?U.value=t.datas||[]:U.value=U.value.concat(t.datas||[]),t.datas.length<10&&(T.value=!0))})).then((()=>{C.clear()}))},A=()=>{q.value+=1,R()},B=()=>{q.value=1,R()};h(E,(()=>{q.value=1,R()}));const H=g(),J=g({}),K=g(!1);return h((()=>J.value.scrollTop),(e=>{K.value=!(e<=0)})),_((()=>{var e,a;null==(a=null==(e=document.querySelector("#page-order").querySelector(".list-wrap"))?void 0:e.addEventListener)||a.call(e,"scroll",(()=>{J.value=H.value.scrollTop})),R()})),(e,a)=>{const n=S,v=w;return t(),l("div",G,[o(n,{modelValue:u(V),"onUpdate:modelValue":a[0]||(a[0]=e=>k(V)?V.value=e:null),placeholder:"请输入订单号/投保单号/投保人姓名",onCancel:B,onSearch:B},null,8,["modelValue"]),o(I,{active:u(D),"onUpdate:active":a[1]||(a[1]=e=>k(D)?D.value=e:null),list:z,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),s("div",{ref_key:"refreshRef",ref:H,class:"list-wrap"},[u(U).length?(t(),c(v,{key:0,loading:u(x),"onUpdate:loading":a[2]||(a[2]=e=>k(x)?x.value=e:null),class:"body",finished:u(T),onLoad:A},{default:d((()=>[(t(!0),l(i,null,r(u(U),((e,a)=>(t(),c(F,{key:a,detail:e,onClick:a=>(e=>{const{orderNo:a,insurerCode:t,templateId:l}=e;j("orderDetail",{orderNo:a,agentCode:m,tenantId:p,templateId:l})})(e),onAfterDelete:B},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])):N("",!0)],512)])}}}),[["__scopeId","data-v-0faefb44"]]);export{H as default};
