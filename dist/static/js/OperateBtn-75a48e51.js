import{d as e,h as r,i as a,k as t,bQ as o,o as d,c as n,u as s,F as i,p as l,w as c,v as p,d7 as u,f as m,_ as h,y,aY as f,bi as C,b3 as I,T as k,eh as N,cF as g,cI as B,cH as z,dJ as $}from"./index-ce7a290e.js";import{c as F}from"./order-36a7dc50.js";const S={class:"operate-wrap"},w=e({name:"operateBtn"});var T=h(e({...w,props:{detail:{default:()=>({})}},emits:["handleCancel","refresh-order"],setup(e,{emit:h}){const w=e,T=r(),_=a(),{tenantId:b,nextPageCode:x,isShare:q,operateType:v}=_.query,P=t((()=>"/orderRecordList"===_.path)),Y=t((()=>{const{showRepayButton:e}=w.detail;return y.orderList===_.path&&e===f.YES})),j=t((()=>{const{orderTopStatus:e,productClassFlag:r,orderStatus:a}=w.detail;return!("-1"!==e||y.orderList!==_.path||"underWritingFailed"===a&&r===f.YES||["manualUnderWriting","offlinePayment","paymentFailed"].includes(a))})),D=t((()=>{const{showCancelButton:e}=w.detail;return e===f.YES})),E=t((()=>{const{orderStatus:e}=w.detail;return!v&&["offlinePayment","manualUnderWriting","paymentFailed"].includes(e)})),L=t((()=>{const{showDeleteButton:e}=w.detail;return e===f.YES})),W=()=>{const{orderStatus:e,orderNo:r,insurerCode:a,underwriteFlag:t,templateId:o,iseeBizNo:d}=w.detail;let n=y.sign;("collectInfo"===e||"underWritingFailed"===e&&t===f.NO)&&(n=y.infoCollection),T.push({path:n,query:{..._.query,tenantId:b,orderNo:r,insurerCode:a,templateId:o,iseeBizNo:d}})},U=()=>{const{orderNo:e}=w.detail||{},r=k.loading({message:"加载中...",duration:0});N({tenantId:b,orderNo:e}).then((({code:e,data:r})=>{"10000"===e&&h("refresh-order")})).finally((()=>{r.clear()}))},O=()=>{const{orderId:e,orderNo:r}=w.detail||{};T.push({path:"orderTrajectory",query:{..._.query,orderId:e,orderNo:r}})},R=()=>{const{orderNo:e,orderId:r}=w.detail;q?C.confirm({message:"撤单后将无法恢复，请您确认是否撤销本次投保"}).then((()=>{h("handleCancel")})):F({tenantId:b,orderNo:e,type:1,cancelFlag:1}).then((({code:e,data:r})=>{"10000"===e&&C.confirm({message:"确认取消当前订单？"}).then((()=>{(e=>{const{holderName:r,holderGender:a,orderId:t,orderNo:o,insurerCode:d,iseeBizNo:n,templateId:s}=w.detail||{},i=r,l=`${g[a]}士`;B({shareType:0,title:`${z.cancel.title}`,desc:z.cancel.desc.replace("{name}",`${i}${l}`),url:`${window.location.href}&objectType=${e}&insurerCode=${d}&templateId=${s}&isShare=1&orderNo=${o}&iseeBizNo=${n}&orderId=${t}&nextPageCode=orderDetail`.replace(/\/orderDetail|\/order/,"/baseInsurance/long/phoneVerify"),imageUrl:$})})("holder")}))}))},G=()=>{const{orderNo:e,orderId:r}=w.detail;y.orderList!==_.path&&C.confirm({message:"保单取消后不可恢复，是否确认？",confirmButtonText:"是",cancelButtonText:"否"}).then((()=>{F({tenantId:b,orderNo:e,cancelFlag:2}).then((({code:e,data:r})=>{"10000"===e&&T.back()}))}))},H=()=>{const{orderNo:e,orderId:r,insurerCode:a,iseeBizNo:t}=w.detail;T.push({path:y.updateBankInfo,query:{tenantId:b,orderNo:e,orderId:r,insurerCode:a,nextPageCode:"orderDetail",iseeBizNo:t}})};return(e,r)=>{const a=I,t=o;return d(),n("div",S,[s(P)?(d(),l(t,{key:1,label:"",value:"查看订单状态","is-link":"",onClick:u(O,["stop"])},null,8,["onClick"])):(d(),n(i,{key:0},[s(Y)?(d(),l(a,{key:0,type:"primary",size:"small",onClick:u(U,["stop"])},{default:c((()=>[p("去支付")])),_:1},8,["onClick"])):m("",!0),s(j)?(d(),l(a,{key:1,type:"primary",size:"small",onClick:u(W,["stop"])},{default:c((()=>[p("去处理")])),_:1},8,["onClick"])):m("",!0),s(D)?(d(),l(a,{key:2,type:"primary",plain:"",size:"small",onClick:u(R,["stop"])},{default:c((()=>[p("撤单")])),_:1},8,["onClick"])):m("",!0),s(E)?(d(),l(a,{key:3,plain:"",size:"small",onClick:u(H,["stop"])},{default:c((()=>[p("银行卡修改")])),_:1},8,["onClick"])):m("",!0),s(L)?(d(),l(a,{key:4,plain:"",size:"small",onClick:G},{default:c((()=>[p("取消订单")])),_:1})):m("",!0)],64))])}}}),[["__scopeId","data-v-000a2c11"]]);export{T as O};
