var ie=Object.defineProperty,le=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var K=Object.getOwnPropertySymbols;var fe=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var Z=(f,s,u)=>s in f?ie(f,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):f[s]=u,j=(f,s)=>{for(var u in s||(s={}))fe.call(s,u)&&Z(f,u,s[u]);if(K)for(var u of K(s))pe.call(s,u)&&Z(f,u,s[u]);return f},z=(f,s)=>le(f,ce(s));import{g as ee,C as _,X as M,r as p,h as m,j as A,k as d,y as c,n as i,m as w,E as te,I as g,F as ne,B as x,aj as me,Q as ve,a5 as Ie,L as _e,x as Oe,o as Ee,z as l,s as $}from"./vendor-8e0cf49f.js";import{_ as ye,v as Be,H as R,G as L,P as Le}from"./index-9b7b1833.js";import{c as Ae,n as Ce,a as ge}from"./index-2cd07127.js";import{u as De}from"./useDicData-2f3800ab.js";import{_ as J,R as Te,B as Re}from"./index-37a3b37e.js";const xe={class:"com-select-container"},Fe={class:"radio-item-wrapper"},be={class:"name"},he={class:"hone"},Ne={class:"address"},Pe={class:"footer-button"},He=x("\u53D6\u6D88"),ke=x("\u786E\u8BA4"),Ve=ee({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(f,{emit:s}){const u=f,y=_(u.modelValue),F=_(u.show),q=()=>{s("submit",y.value),F.value=!1},P=()=>{s("close")};return M(()=>u.modelValue,O=>{console.log("newVal",O),y.value=O}),M(()=>y.value,O=>{s("update:modelValue",O)}),(O,C)=>{const Y=p("van-radio"),D=p("van-radio-group"),t=p("VanButton");return m(),A(Be,{show:F.value,"onUpdate:show":C[1]||(C[1]=I=>F.value=I),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:P},{default:d(()=>[c("div",xe,[i(D,{modelValue:y.value,"onUpdate:modelValue":C[0]||(C[0]=I=>y.value=I)},{default:d(()=>[(m(!0),w(ne,null,te(f.dataSource,(I,E)=>(m(),A(Y,{key:E,name:E+1,class:"radio-item"},{default:d(()=>[c("div",Fe,[c("p",null,[c("span",be,g(I.contactName),1),c("span",he,g(I.contactPhoneNo),1)]),c("p",Ne,g(I.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),c("div",Pe,[i(t,{plain:"",type:"primary"},{default:d(()=>[He]),_:1}),i(t,{type:"primary",onClick:q},{default:d(()=>[ke]),_:1})])]),_:1},8,["show"])}}});var Se=ye(Ve,[["__scopeId","data-v-9c6de82e"]]);const Ue={key:0,class:"beneficiary-part"},je={class:"part-title"},$e={class:"title"},we=x("\u5220\u9664"),Me=x("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),qe=x("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ye={class:"radio-item-wrapper"},Ge={class:"name"},We={class:"hone"},ze={class:"address"},Je={class:"footer-button"},Qe=x("\u4E0B\u4E00\u6B65"),ot=ee({setup(f){const s=me(),u=ve(),{templateId:y=1,orderNo:F="2022072710380711215",tenantId:q="9991000007"}=u.query,[P,O]=Ie(),C=u.path==="/infoPreview"?"infoPreview":"infoCollection",Y=De("NATIONAL_REGION_CODE"),D=_({}),t=_({extInfo:{pageCode:C},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),I=_(null),E=_([]),T=_([]),b=_([]),G=_([]),Q=_([]),v=_e({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),h=Oe(()=>{var o,e;return v.currentAddress?v.addressList[v.currentAddress]:((e=(o=t.value.extInfo)==null?void 0:o.contactInfo)==null?void 0:e[0])||{}}),oe=()=>{const o=j({},t.value);o.extInfo=z(j({},o.extInfo),{contactInfo:[h.value]}),o.tenantOrderAttachmentList=[{category:R.OBVERSE_CERT,objectType:L.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:E.value[0],id:b.value[0]},{category:R.REVERSE_CERT,objectType:L.HOLDER,objectId:t.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:E.value[1],id:b.value[1]},{category:R.OBVERSE_CERT,objectType:L.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:T.value[0],id:G.value[1]},{category:R.REVERSE_CERT,objectType:L.INSURED,objectId:t.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:T.value[1],id:G.value[1]}],I.value.validate().then(e=>{Ce(o).then(({code:a,data:r})=>{a==="10000"&&r.pageAction.pageAction==="jumpToPage"&&s.push({path:Le[r.pageAction.data.nextPageCode],query:u.query})})})},re=o=>{console.log("value",o)},ae=()=>{v.beneficiaryId+=1,t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:v.beneficiaryId,extInfo:{}})},se=o=>{t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(e=>e.beneficiaryId!==o.beneficiaryId)},ue=()=>{ge({orderNo:F,tenantId:q}).then(({code:o,data:e})=>{if(o==="10000"){const a=e;a.extInfo=z(j({},a.extInfo),{pageCode:C,templateId:y}),a.tenantOrderHolder=a.tenantOrderHolder||{},a.tenantOrderHolder.extInfo=a.tenantOrderHolder.extInfo||{},a.tenantOrderInsuredList[0].extInfo=a.tenantOrderInsuredList[0].extInfo||{},a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(r=>{const B=r;return B.extInfo={},B}),a.tenantOrderAttachmentList.forEach(r=>{r.category===R.OBVERSE_CERT?r.objectType===L.HOLDER?(E.value[0]=r.uri,b.value[0]=r.id):r.objectType===L.INSURED&&(T.value[0]=r.uri,G.value[0]=r.id):r.category===R.REVERSE_CERT&&(r.objectType===L.HOLDER?(E.value[1]=r.uri,b.value[1]=r.id):r.objectType===L.INSURED&&(T.value[1]=r.uri,b.value[1]=r.id))}),Object.assign(t.value,a)}}).finally(()=>{v.isLoading=!1})};return Ee(()=>{ue(),Ae({pageCode:"infoCollection",templateId:y}).then(({code:o,data:e})=>{if(o==="10000"){const a={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(r=>{(a[r.moduleType]=a[r.moduleType]||[]).push(r)}),D.value=a}})}),M(()=>t.value,o=>{var e,a,r,B,H,k,N,V,S,U;if(o){const W=[{contactAddress:(a=(e=o.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:a.familyAddress,contactName:o.tenantOrderHolder.name,contactPhoneNo:o.tenantOrderHolder.mobile},{contactAddress:(B=(r=o.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:B.workAddress,contactName:o.tenantOrderHolder.name,contactPhoneNo:o.tenantOrderHolder.mobile},{contactAddress:(k=(H=o.tenantOrderInsuredList[0])==null?void 0:H.extInfo)==null?void 0:k.familyAddress,contactName:(N=o.tenantOrderInsuredList[0])==null?void 0:N.name,contactPhoneNo:(V=o.tenantOrderInsuredList[0])==null?void 0:V.mobile},{contactAddress:(U=(S=o.tenantOrderInsuredList[0])==null?void 0:S.extInfo)==null?void 0:U.workAddress,contactName:o.tenantOrderInsuredList[0].name,contactPhoneNo:o.tenantOrderInsuredList[0].mobile}];v.addressList=W.filter(n=>n.contactAddress&&n.contactName&&n.contactPhoneNo)}},{deep:!0,immediate:!0}),M(()=>t.value.tenantOrderInsuredList[0].relationToHolder,o=>{+o==1&&Object.assign(t.value.tenantOrderInsuredList[0],t.value.tenantOrderHolder,{id:t.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(o,e)=>{const a=p("ProCard"),r=p("ProRadioButton"),B=p("ProField"),H=p("ProCascader"),k=p("ProSvg"),N=p("VanButton"),V=p("ProCheckButton"),S=p("van-cell"),U=p("ProForm"),W=p("ProPageWrap");return m(),A(W,{class:"page-info-wrapper"},{default:d(()=>[l(v).isLoading?$("",!0):(m(),A(U,{key:0,ref_key:"formRef",ref:I},{default:d(()=>[i(a,{title:"\u6295\u4FDD\u4EBA"},{default:d(()=>[i(J,{images:E.value,"onUpdate:images":e[0]||(e[0]=n=>E.value=n),"form-info":t.value.tenantOrderHolder,"factor-list":D.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),i(a,{title:"\u88AB\u4FDD\u4EBA"},{default:d(()=>[i(B,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=n=>t.value.tenantOrderInsuredList[0].relationToHolder=n),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:d(()=>[i(r,{modelValue:t.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=n=>t.value.tenantOrderInsuredList[0].relationToHolder=n),options:l(Te)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+t.value.tenantOrderInsuredList[0].relationToHolder!=1?(m(),A(J,{key:0,images:T.value,"onUpdate:images":e[3]||(e[3]=n=>T.value=n),"form-info":t.value.tenantOrderInsuredList[0],"factor-list":D.value.INSURER||[]},null,8,["images","form-info","factor-list"])):$("",!0),i(H,{modelValue:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:modelValue":e[4]||(e[4]=n=>t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=n),field1:t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":e[5]||(e[5]=n=>t.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=n),field2:t.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":e[6]||(e[6]=n=>t.value.tenantOrderInsuredList[0].extInfo.insureCityCode=n),field3:t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":e[7]||(e[7]=n=>t.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=n),label:"\u6295\u4FDD\u5730\u533A",name:"insureProvinceCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:"","data-source":l(Y),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])]),_:1}),i(a,{title:"\u53D7\u76CA\u4EBA"},{default:d(()=>[i(B,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[9]||(e[9]=n=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=n),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:d(()=>[i(r,{modelValue:t.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[8]||(e[8]=n=>t.value.tenantOrderInsuredList[0].insuredBeneficiaryType=n),options:l(Re)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),t.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(m(),w("div",Ue,[(m(!0),w(ne,null,te(t.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(n,de)=>(m(),w("div",{key:n.beneficiaryId||n.id,class:"beneficiary-item"},[c("div",je,[c("span",$e,g(`\u53D7\u76CA\u4EBA${de+1}`),1),i(k,{name:"delete",onClick:X=>se(n)},{default:d(()=>[we]),_:2},1032,["onClick"])]),i(J,{images:Q.value,"onUpdate:images":e[10]||(e[10]=X=>Q.value=X),"form-info":n,"factor-list":D.value.BENEFICIARY||[]},null,8,["images","form-info","factor-list"])]))),128)),i(N,{onClick:ae},{default:d(()=>[Me]),_:1})])):$("",!0)]),_:1}),i(a,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:d(()=>[Object.keys(l(h)).length?(m(),A(S,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:e[12]||(e[12]=n=>l(O)(!0))},{title:d(()=>[c("div",Ye,[c("p",null,[c("span",Ge,g(l(h).contactName),1),c("span",We,g(l(h).contactPhoneNo),1)]),c("p",ze,g(l(h).contactAddress),1)])]),_:1})):(m(),A(V,{key:0,activated:"",onClick:e[11]||(e[11]=n=>l(O)(!0))},{default:d(()=>[qe]),_:1}))]),_:1})]),_:1},512)),c("div",Je,[i(N,{block:"",type:"primary",onClick:oe},{default:d(()=>[Qe]),_:1})]),l(P)?(m(),A(Se,{key:1,modelValue:l(v).currentAddress,"onUpdate:modelValue":e[13]||(e[13]=n=>l(v).currentAddress=n),show:l(P),"data-source":l(v).addressList,onSubmit:re,onClose:e[14]||(e[14]=n=>l(O)(!1))},null,8,["modelValue","show","data-source"])):$("",!0)]),_:1})}}});export{ot as default};
