!function(){var e=document.createElement("style");e.innerHTML=".page-internet-product-detail[data-v-224d0f1e]{padding-bottom:2rem;background:#f1f5fc}.page-internet-product-detail .footer-button[data-v-224d0f1e]{justify-content:space-between}.page-internet-product-detail .price[data-v-224d0f1e]{color:#393d46;font-size:.45333rem;font-weight:400;display:flex;align-items:center}.page-internet-product-detail .price span[data-v-224d0f1e]{color:var(--van-primary-color);font-weight:700}.page-internet-product-detail .price .premium-loading[data-v-224d0f1e]{display:inline-block;line-height:.69333rem;margin-left:.4rem}.page-internet-product-detail .price .premium-loading[data-v-224d0f1e] .van-loading__spinner{width:.45333rem!important;height:.45333rem!important}.page-internet-product-detail .right[data-v-224d0f1e]{width:3.73333rem;background:var(--van-primary-color);border-color:var(--van-primary-color)}\n",document.head.appendChild(e),System.register(["./index-legacy-a5e5a4bc.js","./debounce-legacy-211ba60e.js","./order-legacy-7040d8c2.js","./infoCollection-legacy-63bdd2f7.js","./trial-legacy-771b1d4a.js","./product-legacy-f18b5c33.js","./utils-legacy-3b099070.js","./theme-legacy-a8152f06.js","./auth-legacy-7d140391.js","./close-legacy-5822a3dd.js","./pdfh5-legacy-9f98dc45.js","./isObject-legacy-83e04b6f.js","./isObjectLike-legacy-7cedb542.js","./trial-legacy-2de42c7c.js","./index-legacy-2a5ae6cb.js","./index-legacy-36a9574d.js","./index-legacy-196317f9.js","./index-legacy-530a3cef.js","./bankCard-legacy-6a5e8e8e.js","./validator-legacy-5e43cc69.js","./phoneVerify-legacy-3ddc231a.js"],(function(e){"use strict";var a,n,t,r,o,i,l,d,u,c,s,v,p,m,y,f,h,g,I,N,w,b,k,T,C,O,F,L,P,j,D,S,H,x,E,U,A,q,R,V,_,B,M,K,Y,$,z,J,G,W,X,Q,Z,ee,ae,ne,te,re,oe,ie,le,de,ue,ce,se,ve,pe,me,ye,fe;return{setters:[function(e){a=e._,n=e.d,t=e.u,r=e.a,o=e.r,i=e.J,l=e.ah,d=e.E,u=e.an,c=e.G,s=e.aB,v=e.z,p=e.c,m=e.h,y=e.f,f=e.w,h=e.g,g=e.A,I=e.k,N=e.j,w=e.t,b=e.bB,k=e.e,T=e.n,C=e.a7,O=e.F,F=e.T,L=e.aj,P=e.B,j=e.bT,D=e.X,S=e.Y,H=e.aJ,x=e.b3,E=e.bI,U=e.aK},function(e){A=e.d},function(e){q=e.a},function(e){R=e.S,V=e.R,_=e.P,B=e.I},function(e){M=e.i,K=e.u,Y=e.a,$=e.s,z=e.p,J=e.g},function(e){G=e.p},function(e){W=e.t,X=e.g,Q=e.a,Z=e.o,ee=e.s,ae=e.v,ne=e.b,te=e.j},function(e){re=e.t},function(e){oe=e.d,ie=e.B,le=e.D,de=e.G,ue=e.S,ce=e.H,se=e.P,ve=e.U,pe=e._,me=e.W,ye=e.a},function(e){fe=e._},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){const he={key:0},ge={class:"page-internet-product-detail"},Ie={class:"info"},Ne={class:"footer-button"},we={class:"price"},be=(e=>(D("data-v-224d0f1e"),e=e(),S(),e))((()=>N("span",null,"总保费",-1))),ke={key:0};e("default",a(n({__name:"packageProcess",setup(e){const a=t(),n=r(),{productCode:D="BWYL2021",tenantId:S,orderNo:Te,phoneNo:Ce,agentCode:Oe="",saleChannelId:Fe,paymentMethod:Le,certNo:Pe,name:je,pageCode:De,from:Se}=n.query,He=o(),xe=o(),Ee=o(),Ue=o(),Ae="payBack"===De;o(!1);const qe=o(!1),Re=o(!1),Ve=o(0),_e=o(!1),Be=o(!1),Me=o({show:!1,html:""}),Ke=o({}),Ye=o(),$e=o(!1),ze=o("");let Je="";const Ge=i({holder:{certNo:Pe,certType:l.CERT,mobile:Ce,name:je,socialFlag:R.HAS},insured:{certNo:Pe,certType:l.CERT,name:je,socialFlag:R.HAS,relationToHolder:V.SELF},paymentMethod:Le,renewalDK:"Y",paymentFrequency:_.YEAR,packageProductList:[],mobileSmsCode:""}),We=o(oe),Xe=o(oe),Qe=i({showInsure:!Ae,canInsure:!1,canUpgrade:!1}),Ze=d((()=>{var e,a;return(null===(e=xe.value)||void 0===e||null===(a=e.tenantProductInsureVO)||void 0===a?void 0:a.attachmentVOList.filter((e=>"健康告知"===e.attachmentName)))||[]})),ea=d((()=>{var e,a;return(null===(e=xe.value)||void 0===e||null===(a=e.tenantProductInsureVO)||void 0===a?void 0:a.attachmentVOList.filter((e=>"健康告知"!==e.attachmentName)))||[]})),aa=()=>{ze.value=Ue.value?Ge.paymentFrequency==_.YEAR?"元/年":"元/月":""},na=()=>{a.push({path:"/internet/guaranteeUpgrade",query:{...n.query,tenantId:S,productCode:"BWYL2022",orderNo:Te,agentCode:Oe}})},ta=()=>{Be.value=!1},ra=()=>{Xe.value=We.value},oa=()=>{Xe.value={...Xe.value,relationToHolderDisable:!1,insuredNameDisable:!1,insuredCertDisable:!1,insuredSocialDisable:!1}},ia=e=>`${E}/internet/payFail?tenantId=${S}&orderNo=${e}&agentCode=${Oe}&pageCode=payBack&from=${Se||"normal"}`,la=async e=>{const a=X({tenantId:S,saleUserId:Oe,saleChannelId:Fe,detail:xe.value,insureDetail:Ee.value,paymentMethod:Ge.paymentMethod,paymentFrequency:Ge.paymentFrequency,renewalDK:Ge.renewalDK,iseeBizNo:Je,successJumpUrl:"",premium:Ue.value,holder:Ge.holder,insured:Ge.insured,tenantOrderRiskList:e,orderStatus:"",orderTopStatus:"",orderNo:Te,originOrderIds:Ye.value});try{const e=await $(a),{code:t,data:r}=e;Re.value=!1,qe.value=!1,"10000"===t&&(F.clear(),delete a.id,Ke.value={orderNo:r.data,order:a},Re.value=!0,n=0,Ve.value=n,Re.value=!0)}catch(t){F.clear(),Qe.canInsure=!0}var n},da=()=>new Promise(((e,a)=>{var n,t;null===(n=He.value)||void 0===n||null===(t=n.validateForm)||void 0===t||t.call(n).then((async()=>{if(!(()=>{if(Ge.holder.certNo){const e=U(Ge.holder.certNo);if(ae(Ge.holder.certNo,18,"year"))return F("投保人年龄必须大于等于18岁！"),!1;if(Ge.insured.certNo&&Ge.insured.relationToHolder===V.MATE&&e===U(Ge.insured.certNo))return F("被保人为配偶时，性别不可相同！"),!1}if(Ge.insured.certNo){if(Ge.insured.relationToHolder===V.CHILD&&ae(Ge.insured.certNo,30,"day"))return F("被保人为子女时，年龄必须大于等于30天！"),!1;if(Ge.insured.relationToHolder===V.PARENT&&!ae(Ge.insured.certNo,71,"year"))return F("被保人为父母时，年龄必须小于等于70岁！"),!1}if([V.CHILD,V.PARENT].includes(Ge.insured.relationToHolder)){const e=ne(Ge.holder.certNo,"year"),a=ne(Ge.insured.certNo,"year");if(Ge.insured.relationToHolder===V.CHILD&&e-a<18)return F("投保人和子女年龄必须相差18岁！"),!1;if(Ge.insured.relationToHolder===V.PARENT&&a-e<18)return F("投保人和父母年龄必须相差18岁！"),!1}return!0})())return void(Qe.canInsure=!0);const{calcData:n,riskVOList:t}=Q({holder:Ge.holder,insured:Ge.insured,tenantId:S,productDetail:xe.value,insureDetail:Ee.value,paymentFrequency:Ge.paymentFrequency,packageRiskIdList:Z(Ge.packageProductList)},!1,te);(!Array.isArray(t)||t.length<1)&&(F("被保人年龄需在30天(含) - 70岁(含)之间！"),Ue.value=null,a(new Error));const r=await z(n),{code:o,data:i}=r;"10000"===o?(Ue.value=i.premium,e({condition:t,data:i})):(Ue.value=null,a(new Error))})).catch((e=>{Qe.canInsure=!0,ee(e)}))})),ua=async()=>{if(Ae)na();else try{var e;F.loading({message:"订单生成中...",forbidClick:!0,duration:0});const{condition:a,data:n}=await da(),t={},r=(e=[])=>{(e||[]).forEach((e=>{var a;t[e.riskCode]=e,null!==(a=e.riskPremiumDetailVOList)&&void 0!==a&&a.length&&r(e.riskPremiumDetailVOList)}))};r(n.riskPremiumDetailVOList);const o=W({tenantId:S,riskList:a,riskPremium:t,productId:null===(e=xe.value)||void 0===e?void 0:e.id});la(o)}catch(a){Qe.canInsure=!0}finally{F.clear()}},ca=e=>{var a;"allFalse"===e?(qe.value=!1,Qe.canInsure=!0,(async e=>{F.loading({message:"核保中...",forbidClick:!0,duration:0});try{const a=await K(e),{code:n}=a;if("10000"===n){const a=await Y({orderNo:e.orderNo,tenantId:S}),{data:n}=a;"10000"===a.code&&(2===n.type?(Me.value={show:!0,html:n.paymentUrl},x((()=>{const e=document.getElementById("cashierSubmit");null==e||e.addEventListener("submit",(e=>{e.preventDefault()})),null==e||e.submit()}))):window.location.href=n.paymentUrl)}Qe.canInsure=!0}catch(a){Qe.canInsure=!0}finally{F.clear()}})({...Ke.value.order,orderNo:Ke.value.orderNo,extInfo:{extraInfo:{renewalDK:Ge.renewalDK,paymentMethod:Ge.paymentMethod,paymentFrequency:Ge.paymentFrequency,successJumpUrl:(a=Ke.value.orderNo,`${E}/pay?orderNo=${a}&saleUserId=${Oe}&tenantId=${S}`),failUrl:ia(Ke.value.orderNo)},iseeBizNo:Je}})):L.confirm({message:"您当前的健康状况不符合该产品",confirmButtonText:"确定"}).then((()=>{window.history.back()})).catch((()=>{Qe.canInsure=!0}))},sa=()=>{Re.value=!1,qe.value=!1,Qe.canInsure=!0},va=()=>{Re.value=!1,qe.value=!0};u([()=>Ge.insured.certNo,()=>Ge.insured.socialFlag,()=>Ge.packageProductList,()=>Ge.paymentFrequency],A((()=>{Ge.insured.certNo&&Ge.insured.socialFlag&&(()=>{const{holder:{certNo:e,mobile:a,name:n,socialFlag:t},insured:{certNo:r,name:o,socialFlag:i,relationToHolder:l},paymentMethod:d}=Ge;return!(!H(r)||!i)})()&&(async()=>{const{calcData:e,riskVOList:a}=Q({holder:Ge.holder,insured:Ge.insured,tenantId:S,productDetail:xe.value,insureDetail:Ee.value,paymentFrequency:Ge.paymentFrequency,packageRiskIdList:Z(Ge.packageProductList)},!1,te);if(!Array.isArray(a)||a.length<1)return F("被保人年龄需在30天(含) - 70岁(含)之间！"),Ue.value=null,{};$e.value=!0;const n=await z(e);$e.value=!1;const{code:t,data:r}=n;"10000"===t?Ge.insured.certNo?(Ue.value=r.premium,aa()):(Ue.value=null,aa()):Ue.value=null})()}),500),{deep:!0,immediate:!0}),u((()=>Ge.insured.certNo),(()=>{Ge.insured.certNo||(Ue.value=null)}));const pa=async()=>{const e=await J({orderNo:Te,tenantId:S}),{code:a,data:n}=e;if("10000"===a){var t,r,o,i,l,d,u,c;const{id:e,tenantOrderHolder:a,tenantOrderInsuredList:g,extInfo:I}=n;if(!Ae){var s,v,p,m,y,f,h;Ye.value={id:e,holderId:null==a?void 0:a.id,insuredId:null==g?void 0:g[0].id};const n=((null===(s=g[0])||void 0===s||null===(v=s.tenantOrderProductList[0])||void 0===v?void 0:v.tenantOrderRiskList)||[]).map((e=>{var a;return(null===(a=e.extInfo)||void 0===a?void 0:a.riskId)||""}));return Ge.packageProductList.forEach((e=>{e.value=e.productRiskVoList.filter((e=>n.includes(e.id))).length>0?B.INSURE:B.UN_INSURE})),Object.assign(Ge,{holder:{certNo:a.certNo,certType:a.certType,mobile:a.mobile,name:a.name,socialFlag:R.HAS},insured:{certNo:null==g?void 0:g[0].certNo,certType:null===(p=g[0])||void 0===p?void 0:p.certType,name:null===(m=g[0])||void 0===m?void 0:m.name,socialFlag:null===(y=g[0])||void 0===y||null===(f=y.extInfo)||void 0===f?void 0:f.hasSocialInsurance,relationToHolder:null===(h=g[0])||void 0===h?void 0:h.relationToHolder},paymentMethod:I.extraInfo.paymentMethod,paymentFrequency:I.extraInfo.paymentFrequency,renewalDK:I.extraInfo.renewalDK||"N"}),void(Qe.canInsure=!0)}Object.assign(Ge,{holder:{certNo:a.certNo,certType:a.certType,mobile:a.mobile,name:a.name,socialFlag:R.HAS},insured:{certNo:null==g?void 0:g[0].certNo,certType:null===(t=g[0])||void 0===t?void 0:t.certType,name:null===(r=g[0])||void 0===r?void 0:r.name,socialFlag:null===(o=g[0])||void 0===o||null===(i=o.extInfo)||void 0===i?void 0:i.hasSocialInsurance,relationToHolder:null===(l=g[0])||void 0===l?void 0:l.relationToHolder},paymentMethod:I.extraInfo.paymentMethod,paymentFrequency:I.extraInfo.paymentFrequency,renewalDK:I.extraInfo.renewalDK||"N"}),Ue.value=null===(d=g[0])||void 0===d||null===(u=d.tenantOrderProductList)||void 0===u||null===(c=u[0])||void 0===c?void 0:c.premium,n.orderStatus!==q.ACCEPT_POLICY&&n.orderStatus!==q.PAYMENT_SUCCESS||(Qe.canUpgrade=!0,_e.value=!1,Be.value=!0),n.orderStatus===q.PAYING&&(_e.value=!0,setTimeout((()=>{pa()}),3e3))}};return c((()=>{Xe.value=ye,We.value=ye,Qe.canInsure=!0,(async()=>{const e=await G({productCode:D,withInsureInfo:!0,tenantId:S});var a;"10000"===e.code&&(xe.value=e.data,document.title=(null===(a=e.data)||void 0===a?void 0:a.productFullName)||"");const n=await M({productCode:D});var t;"10000"===n.code&&(Ge.packageProductList=((null===(t=n.data)||void 0===t?void 0:t.packageProductVOList)||[]).map((e=>({...e,value:B.UN_INSURE,disabled:!1}))),Ee.value=n.data),Te&&pa()})(),setTimeout((async()=>{Je=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const n=s,t=P,r=j,o=v("dompurify-html");return p(),m(O,null,[y(r,{"theme-vars":h(re)},{default:f((()=>{var e,a,r,i,l,d,u;return[h(Me).show?g((p(),m("div",he,null,512)),[[o,h(Me).html]]):I("",!0),N("div",ge,[N("div",Ie,[y(ie,{url:null===(e=h(xe))||void 0===e||null===(a=e.tenantProductInsureVO)||void 0===a?void 0:a.banner[0]},null,8,["url"]),y(le,{"product-name":null===(r=h(xe))||void 0===r?void 0:r.productFullName,"product-desc":null===(i=h(xe))||void 0===i||null===(l=i.showConfigVO)||void 0===l?void 0:l.desc},null,8,["product-name","product-desc"])]),y(de,{"show-service-config":"","guarantee-list":null===(d=h(xe))||void 0===d||null===(u=d.tenantProductInsureVO)||void 0===u?void 0:u.titleAndDescVOS},null,8,["guarantee-list"]),y(ue,{detail:h(xe).tenantProductInsureVO},{form:f((()=>[y(ce,{ref_key:"formRef",ref:He,"is-show-package":"",disable:!h(Qe).showInsure,"form-auth":h(Xe),"form-info":h(Ge),"product-detail":h(xe),onOnReset:ra,onOnUpdate:oa},null,8,["disable","form-auth","form-info","product-detail"])])),_:1},8,["detail"]),N("div",Ne,[N("div",we,[be,h($e)?(p(),k(n,{key:1,class:"premium-loading",type:"spinner"})):(p(),m("span",ke,w(h(Ue)?"￥":"")+w(h(b)(h(Ue)))+" "+w(h(ze)),1))]),y(t,{type:"primary",class:"right",disabled:!(h(Qe).canInsure||h(Qe).canUpgrade),onClick:ua},{default:f((()=>[T(w(h(Qe).showInsure?"立即投保":"升级保障"),1)])),_:1},8,["disabled"])])]),h(Te)?I("",!0):(p(),k(se,{key:1,"product-detail":h(xe)},null,8,["product-detail"])),y(ve,{"order-no":h(Te),"tenant-id":h(S),"is-show":h(Be),onOnConfirm:na,onOnClose:ta},null,8,["order-no","tenant-id","is-show"])]})),_:1},8,["theme-vars"]),y(pe,{show:h(qe),"onUpdate:show":a[0]||(a[0]=e=>C(qe)?qe.value=e:null),"content-list":h(Ze),"active-index":0,onOnConfirmHealth:ca,onOnCloseHealth:sa},null,8,["show","content-list"]),h(Re)?(p(),k(fe,{key:0,show:h(Re),"onUpdate:show":a[1]||(a[1]=e=>C(Re)?Re.value=e:null),"content-list":h(ea),"active-index":h(Ve),text:"我已逐页阅读并确认告知内容","force-read-cound":2,"on-close-file-preview":"",onSubmit:va,onOnCloseFilePreview:sa},null,8,["show","content-list","active-index"])):I("",!0),y(me,{"is-show":h(_e)},null,8,["is-show"])],64)}}}),[["__scopeId","data-v-224d0f1e"]]))}}}))}();
