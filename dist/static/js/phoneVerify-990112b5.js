import{ar as a,d as e,r as s,u as r,R as t,Z as o,b as l,g as d,w as n,i,$ as u,f as c,b2 as p,V as v,b3 as I,a0 as f,e as m,j as b,l as C,T as N,b4 as h,p as T,B as _,aS as j,aT as S}from"./index-74a96f3f.js";import{s as y,c as E}from"./phoneVerify-701a085e.js";import{c as O}from"./format-b5e9d8b9.js";import{u as g}from"./useOrder-fb21d6e1.js";import"./merge-c5599fa4.js";import"./keysIn-a287568b.js";import"./isObjectLike-a9798079.js";const P={class:"page-phone-verify"},k=(a=>(j("data-v-6781f4aa"),a=a(),S(),a))((()=>i("div",{class:"title"},"通过投保人手机号验证后，可进行投保信息填写",-1))),A={class:"phone"},D={class:"input-wrapper"};var R=a(e({__name:"phoneVerify",setup(a){const e=g(),j=s(""),S=s(""),R=s(0);let U;const V=r(),{agentCode:q,tenantId:w,templateId:F,productCode:W,insurerCode:x,orderNo:G,orderCode:L}=V.query,$=()=>{y(j.value).then((({code:a})=>{"10000"===a&&(R.value=60,U=setInterval((()=>{R.value-=1,R.value<=0&&clearInterval(U)}),1e3))}))},B=()=>{E(j.value,S.value).then((({code:a,data:s})=>{"10000"===a&&s?(N.success("验证成功"),e.value.orderStatus===h.PROCESSING?T("infoCollection",{...V.query,isShare:1}):[h.WAIT_IDENTIFICATION,h.IDENTIFICATION_COMPLETE,h.IN_IDENTIFICATION,h.UNDER_WRITING_SUCCESS].includes(e.value.orderStatus)&&T("infoPreview",{...V.query,isShare:1})):N.fail("验证失败")}))};return t((()=>{C({orderNo:L||G,saleUserId:q,tenantId:w}).then((({code:a,data:s})=>{var r;"10000"===a&&(Object.assign(e.value,s),j.value=null==(r=null==s?void 0:s.holder)?void 0:r.mobile)}))})),(a,e)=>{const s=_,r=o("ProPageWrap");return l(),d(r,null,{default:n((()=>[i("div",P,[k,i("div",A,u(c(O)(c(j)||"")),1),i("div",D,[p(i("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>v(S)?S.value=a:null),placeholder:"请输入验证码",class:"input"},null,512),[[I,c(S)]]),i("div",{class:f(["btn",{second:c(R)}]),onClick:$},u(c(R)?`${c(R)}s`:"发送验证码"),3)]),m(s,{type:"primary",class:"submit-btn",onClick:B},{default:n((()=>[b("下一步")])),_:1})])])),_:1})}}}),[["__scopeId","data-v-6781f4aa"]]);export{R as default};
