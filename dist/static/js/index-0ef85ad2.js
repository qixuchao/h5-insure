import{t as S}from"./theme-e4a7893d.js";import{h as U,r as v,A as $,$ as L,k as i,m as l,n as p,p as f,t as g,x as V,B as w,C as r,s as x,F as M,H as O,L as T,G as F}from"./vendor-d350434b.js";const G={key:0,class:"item"},j={key:1,class:"attachment-list"},q=["onClick"],z={class:"attachment-list-item-name"},J={class:"attachment-list-item-icon"},K={class:"footer"},oe=U({props:{show:{type:Boolean,default:!1},contentList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0},text:{type:String,default:""},beforeReadOverText:{type:String,default:"\u540C\u610F\uFF0C\u4E0B\u4E00\u6761"},forceReadCound:{type:Number,default:0}},emits:["update:show","submit","onCloseFilePreview"],setup(y,{emit:m}){const a=y,c=v(a.show),n=v(a.contentList.map((e,t)=>({...e,disabled:!0,readDisabled:!0}))),o=v(a.activeIndex),_=v(0),b=v(null),h=$(()=>{var e,t;return(t=(e=n.value)==null?void 0:e[o.value])==null?void 0:t.attachmentList}),d=$(()=>{var e;return(e=n.value[o.value])==null?void 0:e.readDisabled}),s=$(()=>o.value>=a.forceReadCound-1||_.value>=a.forceReadCound?!1:_.value<a.forceReadCound?o.value!==a.forceReadCound-1:!1),B=e=>{const{origin:t}=window.location;console.log("item",e);const C=`${t}/template/filePreview?fileType=${e.attachmentType}&fileUri=${e.attachmentUri}`;window.open(C)},N=()=>{o.value+=1},k=()=>{m("update:show",!1),m("submit")};L(()=>a,()=>{c.value=a.show,o.value=a.activeIndex},{deep:!0,immediate:!0});const R=e=>{e&&Math.floor(e.target.scrollHeight-e.target.scrollTop)===e.target.clientHeight&&n.value[o.value].readDisabled&&(n.value[o.value].disabled=!1,n.value[o.value].readDisabled=!1,n.value[o.value+1].disabled=!1,_.value+=1)};return L(()=>o.value,()=>{a.show&&(_.value>=a.forceReadCound&&n.value.forEach(e=>{e.disabled=!1,e.readDisabled=!1}),b.value&&(b.value.scrollTop=0))},{immediate:!0}),(e,t)=>{const C=i("ProTab"),A=i("ProFilePreview"),E=i("ProSvg"),I=i("VanButton"),H=i("van-config-provider"),D=i("ProPopup");return l(),p(D,{show:c.value,"onUpdate:show":t[1]||(t[1]=u=>c.value=u),class:"file-preview-popup-wrap",closeable:!1,onClose:t[2]||(t[2]=u=>m("onCloseFilePreview"))},{default:f(()=>[g(H,{"theme-vars":r(S),class:"custom-provider"},{default:f(()=>[c.value?(l(),p(C,{key:0,active:o.value,"onUpdate:active":t[0]||(t[0]=u=>o.value=u),list:n.value.map((u,P)=>({title:u.attachmentName,disabled:P==o.value?!1:u.disabled||!1,slotName:`guarantee-${P}`})),class:"tab"},null,8,["active","list"])):V("",!0),w("div",{ref_key:"previewRef",ref:b,class:"list",onScroll:R},[r(h).length===1?(l(),x("div",G,[(l(),p(A,{key:r(h)[0].attachmentName,content:r(h)[0].attachmentUri,type:r(h)[0].attachmentType,"forbid-click":!0},null,8,["content","type"]))])):(l(),x("div",j,[(l(!0),x(M,null,O(r(h),(u,P)=>(l(),x("div",{key:P,class:"attachment-list-item",onClick:ee=>B(u)},[w("div",z,T(u.attachmentName),1),w("div",J,[g(E,{name:"arrow-right"})])],8,q))),128))]))],544),w("div",K,[r(s)?(l(),p(I,{key:0,disabled:r(d),type:"primary",block:"",round:"",onClick:N},{default:f(()=>[F(T(`${y.beforeReadOverText}(${o.value+1}/${y.forceReadCound})`),1)]),_:1},8,["disabled"])):(l(),p(I,{key:1,disabled:r(d),type:"primary",block:"",round:"",onClick:k},{default:f(()=>[F(T(a.text),1)]),_:1},8,["disabled"]))])]),_:1},8,["theme-vars"])]),_:1},8,["show"])}}});const Q={class:"list"},W={class:"item"},X={class:"footer"},Y=F("\u90E8\u5206\u4E3A\u662F"),Z=F("\u5168\u90E8\u4E3A\u5426"),ne=U({props:{show:{type:Boolean,default:!0},activeIndex:{default:0},contentList:{default:()=>[]}},emits:["update:show","onConfirmHealth","onCloseHealth"],setup(y,{emit:m}){const a=y,c=v(a.show),n=v(a.activeIndex),o=$(()=>{var d;return(d=a.contentList[n.value])==null?void 0:d.attachmentUri}),_=v(!0),b=d=>{_.value=!1,m("update:show",!1),m("onConfirmHealth",d)},h=()=>{_.value&&m("onCloseHealth")};return L(()=>a,()=>{c.value=a.show,n.value=a.activeIndex},{deep:!0,immediate:!0}),(d,s)=>{const B=i("ProTab"),N=i("ProFilePreview"),k=i("VanButton"),R=i("van-config-provider"),e=i("ProPopup");return l(),p(e,{show:c.value,"onUpdate:show":s[3]||(s[3]=t=>c.value=t),height:80,class:"health-notice-preview-popup-wrap",closeable:!1,onClose:s[4]||(s[4]=t=>h())},{default:f(()=>[g(R,{"theme-vars":r(S),class:"custom-provider"},{default:f(()=>[c.value?(l(),p(B,{key:0,active:n.value,"onUpdate:active":s[0]||(s[0]=t=>n.value=t),list:y.contentList.map((t,C)=>({title:t.attachmentName,slotName:`guarantee-${C}`})),class:"tab"},null,8,["active","list"])):V("",!0),w("div",Q,[w("div",W,[(l(),p(N,{key:r(o),content:r(o),type:"pdf"},null,8,["content"]))])]),w("div",X,[g(k,{type:"primary",block:"",round:"",onClick:s[1]||(s[1]=t=>b("N"))},{default:f(()=>[Y]),_:1}),g(k,{type:"primary",plain:"",block:"",round:"",onClick:s[2]||(s[2]=t=>b("allFalse"))},{default:f(()=>[Z]),_:1})])]),_:1},8,["theme-vars"])]),_:1},8,["show"])}}});export{ne as _,oe as a};
