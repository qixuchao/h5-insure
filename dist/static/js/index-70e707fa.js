var oe=Object.defineProperty,ne=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var $=(c,l,B)=>l in c?oe(c,l,{enumerable:!0,configurable:!0,writable:!0,value:B}):c[l]=B,Y=(c,l)=>{for(var B in l||(l={}))ie.call(l,B)&&$(c,B,l[B]);if(V)for(var B of V(l))ce.call(l,B)&&$(c,B,l[B]);return c},Q=(c,l)=>ne(c,re(l));import{g as le,Q as de,af as Be,C as x,d as _e,M as De,r as q,h as D,j as fe,k as f,y as t,n as E,I as F,J as z,m as v,s as N,z as m,E as w,F as R,a1 as Ee,a2 as Fe,B as A,T as W,D as ve}from"./vendor-d47732e4.js";import{_ as Ce,S as he,B as Ae,n as G,j as O,C as J,N as k,P as pe}from"./index-c52e51e2.js";import{g as ge,f as me,s as K,a as ye}from"./verify-266f9a61.js";import{n as Ie,a as Ne}from"./index-f0b18e0c.js";const X=c=>(Ee("data-v-8407324c"),c=c(),Fe(),c),Oe={class:"page-verify"},ke={class:"people"},Se={class:"name"},be={class:"verify-item"},xe=X(()=>t("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),we={class:"no"},Re=A(" \u53BB\u8BA4\u8BC1 "),Pe={class:"sign-body"},Le={class:"date"},Te={class:"file"},Ue=A(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A"),He={key:0,class:"dun-hao"},je={class:"people"},Me={class:"name"},Ve={class:"verify-item"},$e=X(()=>t("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),Ye={class:"no"},Qe=["onClick"],qe=A(" \u53BB\u8BA4\u8BC1 "),ze=["onClick"],We={class:"sign-body"},Ge={class:"date"},Je={class:"file"},Ke=A(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A"),Xe={key:0,class:"dun-hao"},Ze={class:"footer-button footer"},eu=A("\u63D0\u4EA4"),uu=le({setup(c){const l=de(),B=Be(),{orderNo:I="2022072810590219649",saleUserId:P="D1234567-1",tenantId:p="9991000007",templateId:Z=1,productCode:ee="CQ75CQ76",insurerCode:tu="ancheng"}=l.query,S=new he({source:"localStorage"}),y=x([]),d=x(),g=x(),C=[],L=_e().format("YYYY-MM-DD"),ue=()=>{var u;(u=g.value)==null||u.clear()},te=u=>{C[u].clear()},T=(u,o)=>{ye({callbackUrl:window.location.href,certiNo:u,faceAuthMode:"TENCENT",userName:o,tenantId:9991000007}).then(r=>{const{code:i,data:n}=r;if(i==="10000"){const{originalUrl:e,serialNo:a}=n;window.location.href=e,S.set("verifyData",{serialNo:a,certNo:u,name:o})}})},U=u=>{var o,r,i,n;u===-1?T((o=d.value.tenantOrderHolder)==null?void 0:o.certNo,(r=d.value.tenantOrderHolder)==null?void 0:r.name):T((i=d.value.tenantOrderInsuredList[u])==null?void 0:i.certNo,(n=d.value.tenantOrderInsuredList[u])==null?void 0:n.name)},se=u=>{u&&C.every(o=>o!==u)&&C.push(u)},ae=()=>{var o;if((o=g.value)==null?void 0:o.isEmpty()){W.fail("\u8BF7\u6295\u4FDD\u4EBA\u7B7E\u540D");return}if(C.some(r=>r.isEmpty())){W.fail("\u8BF7\u88AB\u4FDD\u4EBA\u7B7E\u540D");return}ve.confirm({title:"\u63D0\u793A",message:"\u8BF7\u786E\u8BA4\u4FE1\u606F\u586B\u5199\u65E0\u8BEF\u540E\uFF0C\u518D\u8FDB\u884C\u652F\u4ED8"}).then(()=>{var i,n;const r=(i=g.value)==null?void 0:i.save();Promise.all([K("HOLDER",r,(n=d.value)==null?void 0:n.id,`${p}`),...C.map(e=>{var a;return K("INSURED",e.save(),(a=d.value)==null?void 0:a.id,`${p}`)})]).then(()=>{Ie(Q(Y({},d.value),{pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:{pageCode:"sign",templateId:Z},venderCode:"ancheng"})).then(e=>{const{code:a,data:s}=e;a==="10000"&&s.success&&B.push({path:pe[s.pageAction.data.nextPageCode],query:{orderNo:I,saleUserId:P,tenantId:p}})})})})},H=()=>{Ne({orderNo:I,saleUserId:P,tenantId:p}).then(u=>{const{code:o,data:r}=u;o==="10000"&&(d.value=r,setTimeout(()=>{let i=0;r.tenantOrderAttachmentList.forEach(n=>{n.category===21&&(n.objectType===2?(g.value.clear(),g.value.setDataURL(n.fileBase64)):n.objectType===1&&(C[i].clear(),C[i].setDataURL(n.fileBase64),i+=1))})}))})};return De(()=>{H(),ge({orderNo:I,productCode:ee,tenantId:p}).then(o=>{const{code:r,data:i}=o;r==="10000"&&(y.value=i||[])});const u=S.get("verifyData");if(u){const{serialNo:o,certNo:r,name:i}=u;me({certiNo:r,orderNo:I,serialNo:o,tenantId:p,userName:i}).then(n=>{const{code:e,data:a}=n;e==="10000"&&(S.remove("verifyData"),H())})}}),(u,o)=>{const r=q("van-button"),i=q("ProPageWrap");return D(),fe(i,null,{default:f(()=>{var n;return[t("div",Oe,[E(Ae,{type:"warning",title:"\u5C0A\u656C\u7684\u5BA2\u6237\uFF0C\u672C\u6B21\u6295\u4FDD\u9700\u8981\u8FDB\u884C\u8EAB\u4EFD\u8BA4\u8BC1",content:"\u672C\u4EA7\u54C1\u6295\u4FDD\u9700\u8981\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\uFF0C\u60A8\u8D2D\u4E70\u672C\u4EA7\u54C1\u7684\u7D2F\u8BA1\u603B\u4FDD\u8D39\u5DF2\u8D85\u8FC720\u4E07\uFF0C\u6309\u76D1\u7BA1\u8981\u6C42\uFF0C\u9700\u8981\u63D0\u4F9B\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u3001\u6307\u5B9A\u53D7\u76CA\u4EBA\u8BC1\u4EF6\u5F71\u50CF\uFF0C\u672C\u4EA7\u54C1\u975E\u672C\u4EBA\u6295\u4FDD\u4E14\u5E26\u8EAB\u6545\u8D23\u4EFB\u3001\u9700\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\uFF08\u6210\u4EBA\uFF09\u7684\u6295\u4FDD\u610F\u613F\u8FDB\u884C\u7B7E\u5B57\u786E\u8BA4\u3002"}),E(O,{title:"\u6295\u4FDD\u4EBA",class:"card"},{extra:f(()=>{var e,a,s,_,h,b,j,M;return[t("div",ke,[t("div",Se,F((a=(e=d.value)==null?void 0:e.tenantOrderHolder)==null?void 0:a.name),1),t("div",{class:z(["status",{verified:(h=(_=(s=d.value)==null?void 0:s.tenantOrderHolder)==null?void 0:_.extInfo)==null?void 0:h.isCert}])},F(((M=(j=(b=d.value)==null?void 0:b.tenantOrderHolder)==null?void 0:j.extInfo)==null?void 0:M.isCert)?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:f(()=>{var e,a,s,_,h;return[t("div",be,[xe,t("div",we,F((a=(e=d.value)==null?void 0:e.tenantOrderHolder)==null?void 0:a.certNo),1),((h=(_=(s=d.value)==null?void 0:s.tenantOrderHolder)==null?void 0:_.extInfo)==null?void 0:h.isCert)?N("",!0):(D(),v("div",{key:0,class:"action",onClick:o[0]||(o[0]=b=>U(-1))},[Re,E(G,{name:"right_arrow",class:"icon"})]))])]}),_:1}),E(O,{title:"\u6295\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:f(()=>[t("div",{class:"resign",onClick:ue},"\u91CD\u7B7E")]),default:f(()=>[E(J,{ref_key:"holderSign",ref:g,class:"sign"},null,512),t("div",Pe,[t("div",Le,"\u7B7E\u540D\u65E5\u671F\uFF1A "+F(m(L)),1),t("div",Te,[Ue,(D(!0),v(R,null,w(y.value.filter(e=>e.noticeObject===m(k).HOLDER),(e,a)=>(D(),v("span",{key:a,class:"file-name"},[A(F(`\u300A${e.materialName}\u300B`),1),a!==y.value.filter(s=>s.noticeObject===m(k).HOLDER).length-1?(D(),v("span",He,"\u3001")):N("",!0)]))),128))])])]),_:1}),(D(!0),v(R,null,w((n=d.value)==null?void 0:n.tenantOrderInsuredList,(e,a)=>(D(),v("div",{key:a},[E(O,{title:"\u88AB\u4FDD\u4EBA",class:"card"},{extra:f(()=>{var s,_;return[t("div",je,[t("div",Me,F(e.name),1),t("div",{class:z(["status",{verified:(s=e.extInfo)==null?void 0:s.isCert}])},F(((_=e.extInfo)==null?void 0:_.isCert)?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:f(()=>{var s;return[t("div",Ve,[$e,t("div",Ye,F(e.certNo),1),((s=e.extInfo)==null?void 0:s.isCert)?N("",!0):(D(),v("div",{key:0,class:"action",onClick:_=>U(a)},[qe,E(G,{name:"right_arrow",class:"icon"})],8,Qe))])]}),_:2},1024),E(O,{title:"\u88AB\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:f(()=>[t("div",{class:"resign",onClick:s=>te(a)},"\u91CD\u7B7E",8,ze)]),default:f(()=>[E(J,{ref_for:!0,ref:se,class:"sign"}),t("div",We,[t("div",Ge,"\u7B7E\u540D\u65E5\u671F\uFF1A "+F(m(L)),1),t("div",Je,[Ke,(D(!0),v(R,null,w(y.value.filter(s=>s.noticeObject===m(k).INSURED),(s,_)=>(D(),v("span",{key:_,class:"file-name"},[A(F(`\u300A${s.materialName}\u300B`),1),_!==y.value.filter(h=>h.noticeObject===m(k).INSURED).length-1?(D(),v("span",Xe,"\u3001")):N("",!0)]))),128))])])]),_:2},1024)]))),128)),t("div",Ze,[E(r,{type:"primary",class:"submit-btn",onClick:ae},{default:f(()=>[eu]),_:1})])])]}),_:1})}}});var iu=Ce(uu,[["__scopeId","data-v-8407324c"]]);export{iu as default};
