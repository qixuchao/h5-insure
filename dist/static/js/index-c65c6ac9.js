import{a2 as a,d as e,dw as t,j as l,k as s,bt as o,dX as r,o as n,c as i,a as c,e as u,a8 as d,b as m,w as p,F as v,q as y,u as w,_ as h,ar as b,f as k,af as f,cg as g,ch as C,by as S,m as _,p as N,n as T,au as D,av as V,aw as j,i as x,r as O,O as P,ag as I,eh as A,dB as L,L as M,bX as U}from"./index-081cd25a.js";import{_ as R}from"./index-fba18d38.js";import{S as $}from"./index-b1c77978.js";import{d as q,e as B}from"./trial-d7088865.js";import{C as F}from"./index-8ecff8a0.js";import{g as J}from"./utils-e9c1c4d1.js";import{w as X,c as E}from"./watermark-4aa82108.js";import"./empty-ae586b6c.js";import"./infoCollection-6d4c4fa9.js";const Y={class:"com-type-filter"},z={class:"wrapper"},G=["onClick"],H=e({name:"TypeFilter"});var K=h(e({...H,props:{type:{type:Number,default:1},modelValue:{type:Number,default:0},items:{type:Array,default:()=>[]}},emits:["change","update:modelValue"],setup(a,{emit:e}){const h=a,b=[{label:"全部",value:""},{label:"长期",value:1},{label:"短期",value:3}],k=t(h,"modelValue",e),f=l(!1),g=s((()=>{switch(+h.type){case 1:return[{label:"全部",value:""},...B];case 2:return[{label:"全部",value:""},...q];default:return b}})),C=s((()=>{const a=g.value.find((a=>+a.value==+k.value));return console.log("types",g.value,"当前type：",a),a?a.label:"全部"}));return(a,t)=>{const l=o,s=r;return n(),i(v,null,[c("div",Y,[c("div",{onClick:t[0]||(t[0]=a=>f.value=!0)},[c("span",null,u(C.value),1),d(),m(l,{name:"arrow-down"})])]),m(s,{show:f.value,style:{"background-color":"transparent"},onClick:t[1]||(t[1]=a=>f.value=!1)},{default:p((()=>[c("div",z,[(n(!0),i(v,null,y(g.value.filter((a=>+a.value!=+w(k))),(a=>(n(),i("div",{key:a.label,class:"block",onClick:t=>{return l=a,k.value=l.value,void e("change",l);var l}},u(a.label),9,G)))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-129d7a22"]]);const Q={class:"com-card-data"},W={class:"title"},Z={class:"item-list"},aa={class:"label"},ea={class:"files"},ta=["onClick"],la=e({name:"Row"}),sa=e({...la,props:{list:{type:Array,default:()=>[]}},emits:["preview"],setup(a,{emit:e}){const t=b(B),l=b(q),s=["产品说明书","产品条款","费率表","风险告知书","其他","投保规则","责任条款"],r=[{key:"riskCategory",label:"险种类别",value:"寿险",format:a=>l[a]},{key:"riskType",label:"主附险",value:"主险",format:a=>t[a]},{key:"insurancePeriodValues",label:"保障期间",value:"180天"},{key:"paymentPeriodValues",label:"交费期间",value:"终生"}],p=a=>r.filter((e=>a[e.key])).map((e=>{const t=a[e.key];return{...e,value:e.format?e.format(t):t}}));return(e,t)=>{const l=o,r=f;return n(),i("div",Q,[(n(!0),i(v,null,y(a.list,(a=>(n(),i("div",{key:a.riskId,class:"card"},[c("div",W,[d(u(a.riskName),1),m(l,{name:"arrow",color:"#c2c2c2"})]),c("div",Z,[(n(!0),i(v,null,y(p(a),(({label:a,value:e})=>(n(),i(v,null,[e?(n(),i("div",{key:a,class:"item"},[c("span",aa,u(a)+":",1),d(),c("span",null,u(e),1)])):k("",!0)],64)))),256))]),c("div",ea,[(n(!0),i(v,null,y(null==a?void 0:a.attachmentDetailVOS,(a=>(n(),i("div",{key:a.riskId,class:"file",onClick:t=>e.$emit("preview",a)},[m(r,{name:s.includes(a.categoryName)?a.categoryName:"自定义"},null,8,["name"]),c("div",null,u(a.categoryName),1)],8,ta)))),128))])])))),128))])}}});const oa={class:"com-row-tabs"},ra={class:"row-data"},na={class:"file-name"},ia=(a=>(V("data-v-a74781f4"),a=a(),j(),a))((()=>c("span",{class:"dot"},null,-1))),ca=["onClick"],ua=e({name:"Tabs"});var da=h(e({...ua,props:{tabs:{type:Array,default:()=>[]},list:{type:Array,default:()=>[]},active:{type:String,default:""}},emits:["@update:active","preview"],setup(a,{emit:e}){const s=t(a,"active",e),o=l(!1);return(t,l)=>{const r=g,d=C,h=f,b=S,V=F,j=D;return n(),i(v,null,[c("div",oa,[a.tabs.length?(n(),_(d,{key:0,active:w(s),"onUpdate:active":l[0]||(l[0]=a=>N(s)?s.value=a:null),class:T(["tabs",a.tabs.length>3?"w80":""])},{default:p((()=>[(n(!0),i(v,null,y(a.tabs,(a=>(n(),_(r,{key:a,name:a,title:a},null,8,["name","title"])))),128))])),_:1},8,["active","class"])):k("",!0),a.tabs.length>3?(n(),i("div",{key:1,class:"more-arrow",onClick:l[1]||(l[1]=a=>o.value=!0)},[m(h,{name:"down-fill",color:"red"})])):k("",!0)]),c("div",ra,[m(V,null,{default:p((()=>[(n(!0),i(v,null,y(a.list,(a=>(n(),_(b,{key:a.id,"is-link":"",onClick:e=>t.$emit("preview",a)},{title:p((()=>[c("div",na,[ia,c("span",null,u(a.displayName),1)])])),_:2},1032,["onClick"])))),128))])),_:1})]),m(j,{show:o.value,title:"已选类别",onClose:l[2]||(l[2]=a=>o.value=!1)},{default:p((()=>[(n(!0),i(v,null,y(a.tabs,((a,t)=>(n(),i("div",{key:t,class:T(["tab-item",a==w(s)?"active":""]),onClick:t=>(a=>{s.value=a,o.value=!1,e("@update:active",a)})(a)},[c("div",null,u(a),1)],10,ca)))),128))])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-a74781f4"]]);const ma={class:"page page-product-lib"},pa={key:1,class:"tac",style:{"margin-top":"50px"}},va={class:"review-pdf"},ya=e({name:"ProductLib"});var wa=h(e({...ya,setup(e){const t=x(),{preview:o=!1,insurerCode:r="lianlife"}=t.query,u=O({rowDataMap:{},cardDatas:[],tabs:[],currentTab:""}),d=s((()=>(console.log("rowDatas",u.rowDataMap,u.tabs,u.currentTab),u.rowDataMap[u.currentTab]))),v=/Mobi|Android|iPhone/i.test(navigator.userAgent),y=l({id:"",insurerCode:"lianlife",showStyle:1,materialCategoryShowStyle:1,riskName:"",showStyleDetails:[],isShowStopSellingLabel:"Y",showCategoryIds:[],showCategoryName:[],showStyleDetailName:[]}),h=l(!0),b=(e=(()=>{}))=>{((e={})=>a({url:"/api/app/insure/product/category/queryProductBoxConfig",method:"POST",data:e}))({insurerCode:r}).then((a=>{var t;console.log("获取配置成功",a),y.value=a.data,y.value.riskName="",u.currentTab=null==(t=u.tabs)?void 0:t[0],e&&(null==e||e())}))},f=()=>{h.value=!0,((e={})=>a({url:"/api/app/insure/product/category/riskAttachmentList",method:"POST",data:e}))({insurerCode:r,materialCategoryShowStyle:y.value.materialCategoryShowStyle,showStyle:y.value.showStyle,riskName:y.value.riskName,riskType:y.value.riskType,categoryId:y.value.showCategoryIds,showStyleDetails:y.value.showStyleDetails}).then((a=>{var e;const{attachmentListResMap:t,attachmentDetailVOS:l}=a.data||{attachmentListResMap:{},attachmentDetailVOS:[]};u.rowDataMap={...t};const s=Object.keys(t);u.tabs=null==(e=y.value.showCategoryName)?void 0:e.filter((a=>s.includes(a))),u.cardDatas=l,console.log("state.rowDatas",d)})).finally((()=>{h.value=!1}))},g=()=>{y.value.id?f():b((()=>{f()}))},C=l({attachmentName:"",attachmentContent:"",attachmentSource:1,show:!1}),N=O({name:"测试水印",agentCode:"1234"}),T=a=>{console.log("文件预览",N),C.value={...a,show:!0},X({watermark_txt:`${N.name}\r\n${N.agentCode}`,watermark_color:"#333",watermark_angle:30,watermark_width:100,watermark_height:60})},V=a=>{console.log("关闭文件预览"),E(),C.value={attachmentName:"",attachmentContent:"",attachmentSource:1,show:!1}};return P((()=>{o?window.addEventListener("message",(a=>{var e;console.log("子应用收到的数据",a.data);"object"==typeof JSON.parse(a.data)&&(y.value={...y.value,...JSON.parse(a.data)},u.currentTab=null==(e=u.tabs)?void 0:e[0],f()),console.log("合并后的config:",y.value)}),!1):b();const a=I.get(A);a&&(N.name=a.name,N.agentCode=a.agentCode),setTimeout((()=>{g()}),1e3)})),(a,e)=>{const t=$,l=S,s=L,o=M,r=R,b=U,f=D;return n(),i("div",ma,[m(s,null,{default:p((()=>[m(l,{class:"top-bar"},{default:p((()=>[c("div",null,[m(K,{modelValue:w(y).riskType,"onUpdate:modelValue":[e[0]||(e[0]=a=>w(y).riskType=a),e[1]||(e[1]=a=>w(y).riskType=a)],type:w(y).materialCategoryShowStyle,onChange:g},null,8,["modelValue","type"])]),m(t,{modelValue:w(y).riskName,"onUpdate:modelValue":e[2]||(e[2]=a=>w(y).riskName=a),"left-icon":"none",placeholder:"请搜索险种名称",shape:"round","clear-trigger":"always","show-action":"",clearable:w(v),onSearch:g},{action:p((()=>[c("div",{onClick:g},"搜索")])),_:1},8,["modelValue","clearable"])])),_:1})])),_:1}),c("div",null,[w(h)||1!=+w(y).showStyle?k("",!0):(n(),_(da,{key:0,active:w(u).currentTab,tabs:w(u).tabs,list:w(d),"onUpdate:active":e[3]||(e[3]=a=>w(u).currentTab=a),onPreview:T},null,8,["active","tabs","list"])),w(h)?(n(),i("div",pa,[m(o,{type:"spinner"})])):k("",!0),w(h)||2!=+w(y).showStyle?k("",!0):(n(),_(sa,{key:2,list:w(u).cardDatas,onPreview:T},null,8,["list"])),w(h)||w(u).cardDatas.length?k("",!0):(n(),_(r,{key:3,title:"没有找到产品资料",style:{"margin-top":"40px"}}))]),m(f,{show:w(C).show,"onUpdate:show":e[4]||(e[4]=a=>w(C).show=a),class:"pre-file-wrap",title:w(C).attachmentName,position:"bottom","close-on-click-overlay":!1,style:{overflow:"hidden"},"header-style":{paddingRight:"40px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",paddingTop:"4px"},onClose:V},{default:p((()=>[c("div",va,[m(b,{"is-iframe":!1,content:w(C).attachmentContent,type:w(J)(w(C).attachmentSource,w(C).attachmentContent)},null,8,["content","type"])])])),_:1},8,["show","title"])])}}}),[["__scopeId","data-v-c43b2a96"]]);export{wa as default};
