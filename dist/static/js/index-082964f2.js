import{m as e,n,l as a,o as t}from"./infoCollection-3279d2ee.js";import{a0 as l,_ as i,d as r,r as o,z as u,aa as s,x as c,G as m,a4 as d,ao as f,aq as p,b as v,c as y,h as I,f as D,w as g,j as V,g as k,k as P,F as Y,t as O,X as b,n as C,K as S,L as x,e as E,i as L,B as h,T as M}from"./index-4c2d8b53.js";import{l as w}from"./trial-215b0045.js";import{h as _,o as N}from"./utils-cc47900a.js";import"./pdfh5-008ca364.js";import"./useStorage-16bb1f6c.js";const T=(e,n="YYYY-MM-DD")=>l(e).format(n),F=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).add(n,a).format(t),q=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).subtract(n,a).format(t);const U=e=>(S("data-v-09e20056"),e=e(),x(),e),R={class:"com-period-cell"},$={key:0,class:"period-custom-cell period-check-btn-cell"},j=U((()=>V("div",{class:"period-cell-label"},"保障期间",-1))),A={class:"period-cell-content"},B=U((()=>V("div",{class:"period-cell-label"},"生效日期",-1))),G={class:"period-cell-content period-custom-cell-content"},H=U((()=>V("div",{class:"period-cell-label"},"保障期限",-1))),X={class:"period-cell-content period-custom-cell-content"},z={key:2,class:"period-custom-cell period-common-cell"},K=U((()=>V("div",{class:"period-cell-label"},"保障期限",-1))),J={class:"period-cell-content"},Q=U((()=>V("div",{class:"picker-custom-title"},"保险开始生效日期",-1)));var W=i(r({__name:"index",props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(a,{expose:t,emit:l}){const i=a;o({});const r=(e,n)=>"year"===e?`${n}年`:"month"===e?`${n}月`:"day"===e?`${n}日`:n,S=o(new Date),x=u({formInfo:i.formInfo}),E=o(!0),L=o(),h=o([]);s((()=>x.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(S.value=new Date(e))})),s([()=>i.insureDetail,()=>x.formInfo.activePlanCode],(()=>{var e;if(x.formInfo.insuranceStartDate="",x.formInfo.insuranceEndDate="",x.formInfo.commencementTime="",i.insureDetail)if(i.insureDetail.productRelationPlanVOList&&i.insureDetail.productRelationPlanVOList.length>0){let n=0;const a=i.insureDetail.productRelationPlanVOList.findIndex((e=>e.planCode===x.formInfo.activePlanCode));a>-1&&(n=a);const t=((null==(e=i.insureDetail.productRelationPlanVOList[n])?void 0:e.productRiskVoList[0].riskDetailVOList)||[]).find((e=>1===e.riskType));t&&(L.value=t)}else{const e=(i.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find((e=>1===e.riskType));e&&(L.value=e)}}),{deep:!0,immediate:!0}),s((()=>L.value),(()=>{var e,n;h.value=[],h.value=_((null==(n=null==(e=L.value)?void 0:e.riskInsureLimitVO)?void 0:n.insurancePeriodValueList)||[]),h.value.length>0?h.value.findIndex((e=>e.value===x.formInfo.insurancePeriodValue))<0&&(x.formInfo.insurancePeriodValue=h.value[0].value):x.formInfo.insurancePeriodValue=w.YEAR_1}),{deep:!0,immediate:!0});const M=c((()=>{var n,a;return(null==(n=L.value)?void 0:n.insuranceStartType)?String(null==(a=L.value)?void 0:a.insuranceStartType):e.CURRENT_DAY})),N=c((()=>{var e,a;return(null==(e=L.value)?void 0:e.insuranceEndType)?String(null==(a=L.value)?void 0:a.insuranceEndType):n.CURRENT_DAY})),[U,W]=m(!1),Z=()=>{E.value&&W(!0)},ee=c((()=>{var n;if(M.value===e.CUSTOM_DAY){const e=null==(n=L.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(e&&e.indexOf(",")){const[n,a]=e.split(",");return new Date(F(new Date,Number(n),"day"))}}return new Date(F(new Date,1,"day"))})),ne=c((()=>{var n;if(M.value===e.CUSTOM_DAY){const e=null==(n=L.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(!e)return new Date;if(e.indexOf(",")){const[n,a]=e.split(",");return new Date(F(new Date,Number(a),"day"))}const a=F(new Date,Number(e),"day");return new Date(a)}return new Date})),ae=e=>{x.formInfo.insuranceStartDate=`${T(e)} 00:00:00`,W(!1)},te=()=>{W(!1)};return s([()=>M.value,()=>x.formInfo.insurancePeriodValue,()=>x.formInfo.insuranceStartDate,()=>L.value],(()=>{var a;if(!x.formInfo.insurancePeriodValue)return;const[t,l]=x.formInfo.insurancePeriodValue.split("_");if(!x.formInfo.insuranceStartDate)if(M.value===e.CUSTOM_DAY){const e=null==(a=L.value)?void 0:a.riskInsureLimitVO.maxInsuranceDay;if(e)if(e.indexOf(",")){const[n,a]=e.split(",");x.formInfo.insuranceStartDate=`${F(new Date,Number(n),"day")} 00:00:00`,E.value=n!==a}else x.formInfo.insuranceStartDate=`${F(new Date,e,"day")} 00:00:00`;else x.formInfo.insuranceStartDate=`${F(new Date,1,"day")} 00:00:00`}else M.value===e.NEXT_DAY?x.formInfo.insuranceStartDate=`${F(new Date,1,"day")} 00:00:00`:x.formInfo.insuranceStartDate=`${T(new Date)} 00:00:00`;if("to"!==t){const e=`${q(x.formInfo.insuranceStartDate,1,"day")} 00:00:00`;N.value===n.CURRENT_DAY?x.formInfo.insuranceEndDate=`${F(e,Number(l),t)} 23:59:59`:x.formInfo.insuranceEndDate=`${F(x.formInfo.insuranceStartDate,Number(l),t)} 00:00:00`}else{let e=x.formInfo.tenantOrderInsuredList[0].birthday;x.formInfo.tenantOrderInsuredList[0].certType===d.CERT&&x.formInfo.tenantOrderInsuredList[0].certNo&&f(x.formInfo.tenantOrderInsuredList[0].certNo)&&(e=p(x.formInfo.tenantOrderInsuredList[0].certNo));const a=`${q(e,1,"day")} 00:00:00`;"single"===l&&(x.formInfo.insuranceEndDate="9999-99-99 23:59:59"),N.value===n.CURRENT_DAY?x.formInfo.insuranceEndDate=`${F(a,Number(l),t)} 23:59:59`:x.formInfo.insuranceEndDate=`${F(e,Number(l),t)} 00:00:00`}}),{immediate:!0}),t({}),(n,a)=>{const t=v("ProRadioButton"),l=v("ProSvg"),i=v("van-config-provider"),o=v("VanButton"),u=v("van-datetime-picker"),s=v("ProPopup");return y(),I(Y,null,[D(i,null,{default:g((()=>[V("div",R,[k(h).length>1?(y(),I("div",$,[j,V("div",A,[D(t,{modelValue:k(x).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=e=>k(x).formInfo.insurancePeriodValue=e),options:k(h)},null,8,["modelValue","options"])])])):P("",!0),k(M)===k(e).CUSTOM_DAY?(y(),I("div",{key:1,class:"period-custom-cell period-common-cell",onClick:Z},[k(E)?(y(),I(Y,{key:0},[B,V("div",G,[V("span",null,O(k(x).formInfo.insuranceStartDate?k(T)(k(x).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),D(l,{class:"custom--arrow-right",name:"arrow-right"})])],64)):(y(),I(Y,{key:1},[H,V("div",X,[V("span",null,O(k(x).formInfo.insuranceStartDate?k(T)(k(x).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+O(k(x).formInfo.insuranceEndDate?k(T)(k(x).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])],64))])):P("",!0),k(M)!==k(e).CUSTOM_DAY?(y(),I("div",z,[K,V("div",J,O(k(x).formInfo.insuranceStartDate?k(T)(k(x).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+O(k(x).formInfo.insuranceEndDate?k(T)(k(x).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):P("",!0)])])),_:1}),D(s,{show:k(U),"onUpdate:show":a[3]||(a[3]=e=>b(U)?U.value=e:null),height:"340",closeable:!0},{default:g((()=>[D(u,{modelValue:k(S),"onUpdate:modelValue":a[2]||(a[2]=e=>b(S)?S.value=e:null),type:"date",title:"保险开始生效日期","min-date":k(ee),"max-date":k(ne),formatter:r,"visible-item-count":5,class:"custom-date-picker",onConfirm:ae,onCancel:te},{cancel:g((()=>[])),title:g((()=>[Q])),confirm:g((()=>[D(o,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:a[1]||(a[1]=e=>U.value=!1)},{default:g((()=>[C("确 定")])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-09e20056"]]);const Z=e=>(S("data-v-13d6b458"),e=e(),x(),e),ee={class:"com-payment-type"},ne={class:"title"},ae={key:0,class:"picture-payment-content"},te=["onClick"],le=["src"],ie=["src"],re={key:1,class:"custom-cell check-btn-cell"},oe=Z((()=>V("div",{class:"cell-label"},"保障方案",-1))),ue={class:"cell-content"},se={key:0,class:"picture-payment-content"},ce=["onClick"],me=["src"],de=["src"],fe={key:1,class:"custom-cell check-btn-cell"},pe=Z((()=>V("div",{class:"cell-label"},"交费方式",-1))),ve={class:"cell-content"},ye={class:"custom-cell common-cell"},Ie=Z((()=>V("div",{class:"cell-label"},"实付保费",-1))),De={key:0,class:"cell-content actual-premium"},ge={class:"cell-content actual-premium"},Ve={key:0,class:"actual-premium actual-premium-month-tip"},ke={key:0,class:"feerate-explain"},Pe={class:"content"},Ye=Z((()=>V("div",{class:"triangle-top"},null,-1)));var Oe=i(r({__name:"index",props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premiumInfo:{type:Object,default:()=>{}}},setup(e){const n=e;o({});const l=u({formInfo:n.formInfo}),i=o([]),r=o(),m=o(),d=c((()=>{var e;return"1"===String(null==(e=r.value)?void 0:e.paymentFrequencyFlag)})),f=c((()=>n.premiumInfo.premiumLoadingText?n.premiumInfo.premiumLoadingText:n.premiumInfo.premium?`${n.premiumInfo.premium||""}${n.premiumInfo.actualUnit||"元"}`:`${n.premiumInfo.minPremiun||""}${n.premiumInfo.unit||""}`)),p=c((()=>{if(m){const{premiumExplain:e,premiumExplainViewName:n,premiumExplainUri:a}=m.value||{};return{premiumExplain:e,premiumExplainUri:a,premiumExplainViewName:n}}return null})),b=c((()=>p.value&&p.value.premiumExplain&&p.value.premiumExplainViewName));s((()=>n.configDetail),(()=>{var e;n.isMultiplePlan&&n.configDetail&&(i.value=null==(e=n.configDetail.tenantProductInsureVO)?void 0:e.planList)}),{immediate:!0,deep:!0}),s([()=>n.configDetail,()=>n.isMultiplePlan,()=>l.formInfo.activePlanCode],(()=>{if(n.configDetail)if(n.isMultiplePlan){let e=0;const a=n.configDetail.tenantProductInsureVO.planList.findIndex((e=>e.planCode===l.formInfo.activePlanCode));a>-1&&(e=a),r.value=n.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,m.value=n.configDetail.tenantProductInsureVO.planList[e]}else r.value=n.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,m.value=n.configDetail.tenantProductInsureVO.planInsureVO}),{deep:!0,immediate:!0});const C=c((()=>{var e;if(r.value&&r.value.paymentFrequency){return((null==(e=r.value.paymentFrequency)?void 0:e.split(","))||[]).length>1}return!1}));s((()=>r.value),(()=>{var e;if(r.value){const n=(null==(e=r.value.paymentFrequency)?void 0:e.split(","))||[];if(1===n.length)return void(l.formInfo.paymentFrequency=r.value.paymentFrequency);if(2===n.length&&n.filter((e=>![a.SINGLE,a.MONTH].includes(e))).length<1)return void(l.formInfo.paymentFrequency||(l.formInfo.paymentFrequency=a.SINGLE));n.length>1&&!l.formInfo.paymentFrequency&&(l.formInfo.paymentFrequency=null==n?void 0:n[0])}}),{immediate:!0,deep:!0});const S=c((()=>{var e;return r.value?null==(e=r.value.paymentFrequencyList||[])?void 0:e.map((e=>({...e,paymentFrequency:e.skinValue}))):[]})),x=c((()=>S.value.length>0)),w=c((()=>n.isMultiplePlan?n.configDetail.tenantProductInsureVO.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[])),_=c((()=>{var e,n;if(r.value){const a=(null==(e=r.value.paymentFrequency)?void 0:e.split(","))||[];return 1===a.length&&(l.formInfo.paymentFrequency=a[0]),null==(n=a||[])?void 0:n.map((e=>({label:t[e],value:e})))}return[]})),T=e=>{l.formInfo.activePlanCode=e},F=()=>{var e,n;(null==(e=p.value)?void 0:e.premiumExplainUri)?N({fileType:"pdf",fileUri:null==(n=p.value)?void 0:n.premiumExplainUri}):M("无费率文件！")};return(a,t)=>{const r=v("ProRadioButton"),o=v("templat"),u=v("ProDivider"),s=v("van-config-provider");return y(),E(s,null,{default:g((()=>[V("div",ee,[V("div",ne,O(k(C)?"交费方式":"保障计划"),1),e.isMultiplePlan?(y(),I(Y,{key:0},[k(w).length>0?(y(),I("div",ae,[(y(!0),I(Y,null,L(k(w),(e=>(y(),I("div",{key:e.planCode,class:h("picture-payment-item"),onClick:n=>T(e.planCode)},[k(l).formInfo.activePlanCode==e.planCode?(y(),I("img",{key:0,src:e.selectedPic},null,8,le)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,ie))],8,te)))),128))])):(y(),I("div",re,[oe,V("div",ue,[D(r,{modelValue:k(l).formInfo.activePlanCode,"onUpdate:modelValue":t[0]||(t[0]=e=>k(l).formInfo.activePlanCode=e),options:k(i),prop:{value:"planCode",label:"planName"},onChange:T},null,8,["modelValue","options"])])]))],64)):P("",!0),k(d)?(y(),E(o,{key:1},{default:g((()=>[k(x)&&k(S).length>1?(y(),I("div",se,[(y(!0),I(Y,null,L(k(S),(e=>(y(),I("div",{key:e.paymentFrequency,class:h("picture-payment-item"),onClick:n=>{return a=e.paymentFrequency,void(l.formInfo.paymentFrequency=a);var a}},[k(l).formInfo.paymentFrequency==e.paymentFrequency?(y(),I("img",{key:0,src:e.selectedPic},null,8,me)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,de))],8,ce)))),128))])):k(_).length>1?(y(),I("div",fe,[pe,V("div",ve,[D(r,{modelValue:k(l).formInfo.paymentFrequency,"onUpdate:modelValue":t[1]||(t[1]=e=>k(l).formInfo.paymentFrequency=e),options:k(_)},null,8,["modelValue","options"])])])):P("",!0)])),_:1})):P("",!0),D(W,{"form-info":k(l).formInfo,"insure-detail":e.insureDetail,"config-detail":e.configDetail},null,8,["form-info","insure-detail","config-detail"]),k(f)&&k(b)?(y(),I(Y,{key:2},[V("div",ye,[Ie,n.premiumInfo.premiumLoadingText?(y(),I("div",De,O(k(f)),1)):(y(),I(Y,{key:1},[V("div",ge,O(k(f)),1),"5"===k(l).formInfo.paymentFrequency?(y(),I("div",Ve," 共12期 ")):P("",!0)],64))]),k(b)?(y(),I("div",ke,[V("div",Pe,[Ye,V("div",null,[V("span",null,O(k(p).premiumExplain||""),1),V("span",{class:"file-name",onClick:F},"《"+O(k(p).premiumExplainViewName||"")+"》",1)])])])):P("",!0)],64)):P("",!0)]),D(u)])),_:1})}}}),[["__scopeId","data-v-13d6b458"]]);export{Oe as default};
