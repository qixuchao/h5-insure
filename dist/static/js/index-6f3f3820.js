var X=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var S=(f,d,i)=>d in f?X(f,d,{enumerable:!0,configurable:!0,writable:!0,value:i}):f[d]=i,x=(f,d)=>{for(var i in d||(d={}))Z.call(d,i)&&S(f,i,d[i]);if(j)for(var i of j(d))ee.call(d,i)&&S(f,i,d[i]);return f},U=(f,d)=>J(f,K(d));import{g as te,af as ne,Q as re,a5 as oe,C as v,L as ae,o as se,X as ue,r as m,h as I,j as O,k as c,z as s,n as l,s as D,m as H,F as de,E as ie,y,I as T,B as P}from"./vendor-50171071.js";import{P as le}from"./index-718d16f0.js";import{c as ce,n as fe,a as pe}from"./index-4b25bde2.js";import{_ as V,R as me,B as Ie,A as ye,a as _e}from"./index-db2fb9c3.js";import"./useDicData-121a6edd.js";const Be={key:0,class:"beneficiary-part"},Oe={class:"part-title"},Ae={class:"title"},Le=P("\u5220\u9664"),ve=P("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),ge=P("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ee={class:"radio-item-wrapper"},Ce={class:"name"},Fe={class:"hone"},be={class:"address"},he={class:"footer-button"},De=P("\u4E0B\u4E00\u6B65"),je=te({setup(f){const d=ne(),i=re(),{templateId:N=1,orderNo:q="2022072710380711215",tenantId:$="9991000007"}=i.query,[k,w]=oe(),R=i.path==="/infoPreview"?"infoPreview":"infoCollection",g=v({}),o=v({extInfo:{pageCode:R},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),Y=v(null),_=v([]),B=v([]),u=ae({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),M=()=>{const n=x({},o.value);n.tenantOrderAttachmentList=[{category:22,objectType:2,objectId:o.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:_.value[0]},{category:23,objectType:2,objectId:o.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:_.value[1]},{category:22,objectType:3,objectId:o.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:B.value[0]},{category:23,objectType:3,objectId:o.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:B.value[1]}],fe(n).then(({code:e,data:t})=>{e==="10000"&&t.pageAction.pageAction==="jumpToPage"&&d.push({path:le[t.pageAction.data.nextPageCode],query:i.query})})},W=n=>{console.log("value",n)},z=()=>{u.beneficiaryId+=1,o.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:u.beneficiaryId,extInfo:{}})},G=n=>{o.value.tenantOrderInsuredList[0].beneficiaryReqList=o.value.tenantOrderInsuredList[0].beneficiaryReqList.filter(e=>e.beneficiaryId!==n.beneficiaryId)},Q=()=>{pe({orderNo:q,tenantId:$}).then(({code:n,data:e})=>{if(n==="10000"){const t=e;t.extInfo=U(x({},t.extInfo),{pageCode:R,templateId:N}),t.tenantOrderHolder=t.tenantOrderHolder||{},t.tenantOrderHolder.extInfo=t.tenantOrderHolder.extInfo||{},t.tenantOrderInsuredList[0].extInfo=t.tenantOrderInsuredList[0].extInfo||{},t.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=t.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(r=>{const p=r;return p.extInfo={},p}),t.tenantOrderAttachmentList.forEach(r=>{r.category,r.objectType,r.category===22?r.objectType===2?_[0]=r.uri:r.objectType===3&&(B[0]=r.uri):r.category===23&&(r.objectType===2?_[1]=r.uri:r.objectType===3&&(B[1]=r.uri))}),Object.assign(o.value,t)}}).finally(()=>{u.isLoading=!1})};return se(()=>{Q(),ce({pageCode:"infoCollection",templateId:N}).then(({code:n,data:e})=>{if(n==="10000"){const t={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(r=>{(t[r.moduleType]=t[r.moduleType]||[]).push(r)}),g.value=t}})}),ue(()=>o.value,n=>{var e,t,r,p,E,A,C,F,b,h;if(n){const a=[{contactAddress:((t=(e=n.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:t.familyAddress)||1231123,contactName:n.tenantOrderHolder.name||123131,contactPhoneNo:n.tenantOrderHolder.mobile||123132},{contactAddress:(p=(r=n.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:p.workAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(A=(E=n.tenantOrderInsuredList[0])==null?void 0:E.extInfo)==null?void 0:A.familyAddress,contactName:(C=n.tenantOrderInsuredList[0])==null?void 0:C.name,contactPhoneNo:(F=n.tenantOrderInsuredList[0])==null?void 0:F.mobile},{contactAddress:(h=(b=n.tenantOrderInsuredList[0])==null?void 0:b.extInfo)==null?void 0:h.workAddress,contactName:n.tenantOrderInsuredList[0].name,contactPhoneNo:n.tenantOrderInsuredList[0].mobile}];u.addressList=a.filter(L=>L.contactAddress&&L.contactName&&L.contactPhoneNo)}},{deep:!0,immediate:!0}),(n,e)=>{const t=m("ProCard"),r=m("ProRadioButton"),p=m("ProField"),E=m("ProSvg"),A=m("VanButton"),C=m("ProCheckButton"),F=m("van-cell"),b=m("ProForm"),h=m("ProPageWrap");return I(),O(h,{class:"page-info-wrapper"},{default:c(()=>[s(u).isLoading?D("",!0):(I(),O(b,{key:0,ref_key:"formRef",ref:Y},{default:c(()=>[l(t,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[l(V,{images:_.value,"onUpdate:images":e[0]||(e[0]=a=>_.value=a),"form-info":o.value.tenantOrderHolder,"factor-list":g.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),l(t,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[l(p,{modelValue:o.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(r,{modelValue:o.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.tenantOrderInsuredList[0].relationToHolder=a),options:s(me)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+o.value.tenantOrderInsuredList[0].relationToHolder!=1?(I(),O(V,{key:0,images:B.value,"onUpdate:images":e[3]||(e[3]=a=>B.value=a),"form-info":o.value.tenantOrderInsuredList[0],"factor-list":g.value.INSURER||[]},null,8,["images","form-info","factor-list"])):D("",!0),l(p,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),l(t,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[l(p,{modelValue:o.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(r,{modelValue:o.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:s(Ie)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),o.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(I(),H("div",Be,[(I(!0),H(de,null,ie(o.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(a,L)=>(I(),H("div",{key:a.beneficiaryId,class:"beneficiary-item"},[y("div",Oe,[y("span",Ae,T(`\u53D7\u76CA\u4EBA${L+1}`),1),l(E,{name:"delete",onClick:Te=>G(a)},{default:c(()=>[Le]),_:2},1032,["onClick"])]),l(_e,{"form-info":a,"factor-list":g.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),l(A,{onClick:z},{default:c(()=>[ve]),_:1})])):D("",!0)]),_:1}),l(t,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>[s(u).currentAddress?(I(),O(F,{key:1,title:"\u5355\u5143\u683C","is-link":""},{title:c(()=>[y("div",Ee,[y("p",null,[y("span",Ce,T(s(u).addressList[s(u).currentAddress-1].contactName),1),y("span",Fe,T(s(u).addressList[s(u).currentAddress-1].contactPhoneNo),1)]),y("p",be,T(s(u).addressList[s(u).currentAddress-1].contactAddress),1)])]),_:1})):(I(),O(C,{key:0,activated:"",onClick:e[6]||(e[6]=a=>s(w)(!0))},{default:c(()=>[ge]),_:1}))]),_:1})]),_:1},512)),y("div",he,[l(A,{block:"",type:"primary",onClick:M},{default:c(()=>[De]),_:1})]),s(k)?(I(),O(ye,{key:1,modelValue:s(u).currentAddress,"onUpdate:modelValue":e[7]||(e[7]=a=>s(u).currentAddress=a),show:s(k),"data-source":s(u).addressList,onSubmit:W},null,8,["modelValue","show","data-source"])):D("",!0)]),_:1})}}});export{je as default};
