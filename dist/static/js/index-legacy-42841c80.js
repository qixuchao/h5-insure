!function(){var e=document.createElement("style");e.innerHTML=".com-product-list-wrapper .content[data-v-7995980e]{padding:0 var(--zaui-card-border, .4rem)}.com-product-list-wrapper .premium-total[data-v-7995980e]{padding:0 var(--zaui-card-border, .4rem);font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC;font-weight:400;color:#333;margin:.26667rem 0 .4rem}.com-product-list-wrapper .premium-total .premium[data-v-7995980e]{color:#ff5840;font-weight:600}.com-product-list-wrapper .risk-item-wrapper[data-v-7995980e]{margin:var(--zaui-card-border, .4rem);background-color:#f6f6fa;border-radius:.26667rem}.com-product-list-wrapper .risk-item-wrapper[data-v-7995980e] .card-title .van-cell{background-color:#f6f6fa;padding-bottom:0;border-radius:.26667rem}.com-product-list-wrapper .risk-item-wrapper .premium[data-v-7995980e]{color:var(--zaui-price, #ff5840)}.com-product-list-wrapper .risk-item-wrapper .risk-premium[data-v-7995980e]{color:#333;font-weight:400;font-size:.34667rem}.com-product-list-wrapper .risk-item-wrapper .risk-factor[data-v-7995980e]{display:flex;justify-content:space-between}.com-product-list-wrapper .risk-item-wrapper .risk-factor .factor[data-v-7995980e]{display:flex;flex-direction:column;align-items:center;padding:.37333rem 0 .54667rem}.com-product-list-wrapper .risk-item-wrapper .risk-factor .factor .factor-value[data-v-7995980e]{width:100%;text-align:center;font-size:.37333rem;font-family:Arial-BoldMT,Arial,self;font-weight:400;color:#393d46;line-height:.42667rem;margin-bottom:.10667rem}.com-product-list-wrapper .risk-item-wrapper .risk-factor .factor .factor-name[data-v-7995980e]{width:100%;font-size:.32rem;font-family:PingFangSC-Regular,PingFang SC,serif;font-weight:400;color:#99a9c0;line-height:.44rem}.com-product-list-wrapper .risk-item-wrapper .operate-bar[data-v-7995980e]{display:flex;align-content:center;justify-content:flex-end;padding-bottom:.26667rem}.com-product-list-wrapper .risk-item-wrapper .operate-bar .border[data-v-7995980e]{border:.02667rem solid #e6e6eb}.com-product-list-wrapper .risk-item-wrapper .operate-bar[data-v-7995980e] .com-check-btn{margin-left:.21333rem}.page-create-wrapper[data-v-9b8052b4]{background-color:#f2f5fc}.page-create-wrapper .container[data-v-9b8052b4]{padding:.4rem .4rem 2.4rem}.page-create-wrapper .container[data-v-9b8052b4] .com-card-wrap .body{padding:0}.page-create-wrapper .container .operate-bar[data-v-9b8052b4]{width:100%;justify-content:center;display:flex;margin-top:.53333rem}.page-create-wrapper .container .operate-bar[data-v-9b8052b4] .com-check-btn{height:.90667rem;width:3.2rem}.page-create-wrapper .footer-bar[data-v-9b8052b4]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4}.page-create-wrapper .footer-bar .trial-result[data-v-9b8052b4]{width:5.86667rem;color:#ff5840;font-size:.32rem;font-weight:600}.page-create-wrapper .footer-bar .trial-result .result-num[data-v-9b8052b4]{font-size:.61333rem;font-weight:500;margin-left:.17333rem}.page-create-wrapper .footer-bar .trial-operate button[data-v-9b8052b4]{width:3.73333rem}\n",document.head.appendChild(e),System.register(["./vendor-legacy-5d3b395b.js","./index-legacy-2a41cbfe.js","./index-legacy-e6a31d4c.js","./trial-legacy-c705bd53.js","./useDicData-legacy-f3255018.js","./trial-legacy-6324db1d.js"],(function(e){"use strict";var r,t,a,o,i,l,s,d,p,u,n,c,m,v,f,k,g,b,I,h,L,y,w,P,R,V,C,_,D,j,O,x,T;return{setters:[function(e){r=e.g,t=e.Q,a=e.E,o=e.y,i=e._,l=e.r,s=e.j,d=e.n,p=e.F,u=e.G,n=e.z,c=e.p,m=e.J,v=e.A,f=e.k,k=e.m,g=e.t,b=e.C,I=e.a4,h=e.a5,L=e.ak,y=e.O,w=e.o,P=e.R,R=e.D},function(e){V=e.u,C=e.P},function(e){_=e.b,D=e._,j=e.s,O=e.t},function(e){x=e.a},function(e){T=e.u},function(){}],execute:function(){const S=e=>(I("data-v-7995980e"),e=e(),h(),e),z={class:"com-product-list-wrapper"},U={class:"risk-item-wrapper"},F={class:"content"},N={class:"risk-premium"},E=b(" 保费:"),$={class:"premium"},q={class:"risk-factor"},A={class:"factor"},B={class:"factor-value"},H=S((()=>n("span",{class:"factor-name"}," 保额(元) ",-1))),M={class:"factor"},K={class:"factor-value"},G=S((()=>n("span",{class:"factor-name"}," 保障期间 ",-1))),J={class:"factor"},Q={class:"factor-value"},W=S((()=>n("span",{class:"factor-name"}," 缴费期间 ",-1))),Y={class:"operate-bar"},X=b("删除"),Z=b("+ 附加险"),ee=b("修改"),re={class:"premium-total"},te=b(" 保费: "),ae={class:"premium"};var oe=D(r({props:{productRiskList:{default:()=>[]},productInfo:{default:()=>({})},productData:{default:()=>({})},pickProductPremium:{type:Function,default:()=>{}},productNum:{default:0}},emits:["deleteRisk","updateRisk","addRiderRisk"],setup(e,{emit:r}){const b=e,[I,h]=t(),L=a({checkedList:[],disabledList:[],riderRiskList:[],mainRiskData:{},totalPremium:0,currentRiskRecord:{},productRiskList:[]}),y=T("RISK_PAYMENT_PERIOD"),w=T("RISK_INSURANCE_PERIOD"),P=o((()=>{var e,r;return(null===(e=b.productData)||void 0===e||null===(r=e.productRiskVoList)||void 0===r?void 0:r[0].riskDetailVOList.filter((e=>1===e.collocationType)))||[]})),R=o((()=>{var e,r;const t=b.productRiskList.map((e=>e.riskId)),a=((null===(e=b.productData)||void 0===e||null===(r=e.productRiskVoList)||void 0===r?void 0:r[0].riskDetailVOList)||[]).filter((e=>t.includes(e.id)&&1===e.collocationType));return P.value.length-a.length})),V=o((()=>e=>{var r,t;const a=(null===(r=b.productData)||void 0===r||null===(t=r.productRiskVoList)||void 0===t?void 0:t[0].riskDetailVOList.find((r=>r.id!==e)))||{};let o=!1;return o=!!b.productNum||2===a.riskType&&1===a.collocationType,o})),C=o((()=>{var e,r;return(null===(e=b.productData)||void 0===e||null===(r=e.productRiskVoList)||void 0===r?void 0:r[0].riskDetailVOList.find((e=>1===e.riskType)))||{}})),_=o((()=>C.value.collocationVOList||[])),D=(e,t)=>{const a=e.map((e=>e.id)).filter((e=>!L.value.disabledList.includes(e)));r("addRiderRisk",a,b.productInfo)};return i((()=>b.productInfo),(e=>{var r;let t=0;(e.proposalProductRiskList||[]).forEach((e=>{t+=e.premium})),null===(r=b.pickProductPremium)||void 0===r||r.call(b,{[`${e.productId}`]:t}),L.value.totalPremium=t}),{deep:!0,immediate:!0}),i((()=>b.productRiskList),(e=>{const r=[],t=[],a=[];(e||[]).forEach((e=>{1===e.riskType?r.unshift(e):(t.push(e.riskId),a.push(e.riskId),r.push(e))})),L.value.disabledList=t,L.value.checkedList=a,L.value.productRiskList=r}),{deep:!0,immediate:!0}),(e,t)=>{const a=l("ProTitle"),o=l("ProCheckButton");return s(),d("div",z,[(s(!0),d(p,null,u(L.value.productRiskList,(e=>{var t,i;return s(),d("div",{key:e.riskId},[n("div",U,[c(a,{"risk-type":e.riskType,title:e.riskName},null,8,["risk-type","title"]),n("div",F,[n("div",N,[E,n("span",$,"￥"+m(null===(t=e.premium)||void 0===t?void 0:t.toLocaleString()),1)]),n("div",q,[n("div",A,[n("span",B,m(null===(i=e.amount)||void 0===i?void 0:i.toLocaleString()),1),H]),n("div",M,[n("span",K,m(v(j)(v(w),e.coveragePeriod)),1),G]),n("div",J,[n("span",Q,m(v(j)(v(y),e.chargePeriod)),1),W])]),n("div",Y,[v(V)(e.riskId)?(s(),f(o,{key:0,round:32,class:"border",onClick:t=>{r("deleteRisk",e,b.productInfo)}},{default:k((()=>[X])),_:2},1032,["onClick"])):g("",!0),v(R)?(s(),f(o,{key:1,activated:"",round:32,onClick:r=>{return t=e,h(!0),void(L.value.currentRiskRecord=t);var t}},{default:k((()=>[Z])),_:2},1032,["onClick"])):g("",!0),c(o,{activated:"",round:32,onClick:t=>{r("updateRisk",e,b.productInfo)}},{default:k((()=>[ee])),_:2},1032,["onClick"])])])])])})),128)),n("div",re,[te,n("span",ae,"￥"+m(L.value.totalPremium.toLocaleString()),1)]),v(I)?(s(),f(x,{key:0,modelValue:L.value.checkedList,"onUpdate:modelValue":t[0]||(t[0]=e=>L.value.checkedList=e),show:v(I),disabled:L.value.disabledList,"risk-list":v(P),"collocation-list":v(_),onFinished:D,onClose:t[1]||(t[1]=e=>v(h)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):g("",!0)])}}}),[["__scopeId","data-v-7995980e"]]);const ie={class:"container"},le=(e=>(I("data-v-9b8052b4"),e=e(),h(),e))((()=>n("span",null,"计划书名称",-1))),se={class:"operate-bar"},de=b("添加主险"),pe={class:"footer-bar"},ue={class:"trial-result"},ne=b(" 总保费 "),ce={class:"result-num"},me={class:"trial-operate"},ve=b("保存并预览"),fe=r({setup(e){const r=[{name:"保存修改"},{name:"另存为新计划书"}],[b,I]=t(),[h,D]=t(),j=a({proposalHolder:{},proposalInsuredList:[{name:"",gender:"",birthday:"",proposalInsuredProductList:[]}],proposalName:"",totalPremium:0,relationUserType:2}),x=L(),T=y(),S=V(),{id:z,type:U="add",isCreateProposal:F}=T.query,N=a({productId:0,productCollection:{},productInfo:{},productPremium:{},riderRisk:{},type:"add",currentRisk:[]}),E=a();a({}),a([]),o((()=>({min:"",max:""})));const $=()=>{E.value.validate().then((()=>{var e;(e=j.value,_.post("/api/app/insure/proposal/addOrUpdateProposal",e)).then((({code:e,data:r})=>{"10000"===e&&(S.$reset(),S.proposalId=r,x.push({path:"/compositionProposal",query:{id:r}}))}))}))},q=()=>{!z&&S.proposalId?D(!0):$()},A=(e,r)=>{r&&(j.value.id=null),$()},B=(e,r,t)=>r?/^.{1,20}$/.test(r)?"":`${e}不能超过20个字符`:"",H=(e={})=>{Object.assign(N.value.productPremium,e),j.value.totalPremium=Object.values(N.value.productPremium).reduce(((e,r)=>e+r),0)},M=(e,r)=>{const t=r;R.confirm({message:"确认删除该险种？"}).then((()=>{1===e.riskType?(j.value.proposalInsuredList[0].proposalInsuredProductList=j.value.proposalInsuredList[0].proposalInsuredProductList.filter((e=>e.productId!==t.productId)),H({[t.productId]:0})):t.proposalProductRiskList=t.proposalProductRiskList.filter((r=>r.riskId!==e.riskId))}))},K=(e,r)=>{N.value.productId=r.productId,N.value.productInfo=r,N.value.type="edit",N.value.currentRisk=[e.riskId],I(!0)},G=(e,r)=>{N.value.productId=r.productId,N.value.productInfo=r,N.value.type="addRiderRisk",N.value.currentRisk=e,I(!0)},J=(e={})=>{((e={})=>_.get(`/api/app/insure/proposal/queryProposalDetail/${e.id}`,e))(e).then((({code:e,data:r})=>{"10000"===e&&Object.assign(j.value,r)}))},Q=e=>{j.value.proposalInsuredList[0].proposalInsuredProductList=j.value.proposalInsuredList[0].proposalInsuredProductList.map((r=>{let t=r;return r.productId===e.proposalInsuredList[0].proposalInsuredProductList[0].productId&&(t={...e.proposalInsuredList[0].proposalInsuredProductList[0]}),t})),I(!1)},W=e=>{((e={})=>_.post("/api/app/insure/product/listInsureProductDetail",e))(e).then((({code:e,data:r})=>{"10000"===e&&(N.value.productCollection=r)})).finally((()=>{}))},Y=()=>{S.setProposalInfo(j.value),S.setTrialData([]),S.setExcludeProduct(Object.keys(N.value.productCollection)),x.push({path:"/proposalList",query:{isCreateProposal:"1",...T.query}})},X=()=>{I(!1)};return w((()=>{const e=S.$state.trialData,r=S.$state.proposalInfo,t=S.$state.proposalId;z&&!F||t?J({id:z||t}):!Object.keys(r).length&&e.length?Object.assign(j.value,e[0]):Object.keys(r).length&&e.length?(r.proposalInsuredList[0].proposalInsuredProductList.push(...e[0].proposalInsuredList[0].proposalInsuredProductList),j.value=r):Object.keys(r).length&&!e.length&&(j.value=r),S.setTrialData([])})),i((()=>{var e;return null===(e=j.value.proposalInsuredList[0].proposalInsuredProductList)||void 0===e?void 0:e.length}),(()=>{const e=j.value.proposalInsuredList[0].proposalInsuredProductList.map((e=>({productId:e.productId,source:2})));W({voList:e})})),(e,t)=>{const a=l("VanField"),o=l("ProCard"),i=l("ProDatePicker"),I=l("ProRadioButton"),L=l("VanForm"),y=l("ProCheckButton"),w=l("VanButton"),R=l("VanActionSheet"),V=l("ProPageWrap");return s(),f(V,{class:"page-create-wrapper"},{default:k((()=>{var e;return[n("div",ie,[c(L,{ref_key:"formRef",ref:E,"input-align":"right","error-message-align":"right"},{default:k((()=>[c(o,null,{default:k((()=>[c(a,{modelValue:j.value.proposalName,"onUpdate:modelValue":t[0]||(t[0]=e=>j.value.proposalName=e),name:"proposalName",placeholder:"请输入计划书名称",rules:[{validator:(...e)=>B("计划书名称",...e)}]},{label:k((()=>[le])),_:1},8,["modelValue","rules"])])),_:1}),c(o,{title:"被保人信息"},{default:k((()=>[c(a,{modelValue:j.value.proposalInsuredList[0].name,"onUpdate:modelValue":t[1]||(t[1]=e=>j.value.proposalInsuredList[0].name=e),name:"name",label:"姓名",rules:[{validator:(...e)=>B("姓名",...e)}],placeholder:"请输入（选填）"},null,8,["modelValue","rules"]),c(i,{modelValue:j.value.proposalInsuredList[0].birthday,"onUpdate:modelValue":t[2]||(t[2]=e=>j.value.proposalInsuredList[0].birthday=e),name:"birthday",label:"出生日期",type:"date","is-link":"",readonly:"",placeholder:"请选择",rules:[{required:!0,message:"请选择"}]},null,8,["modelValue"]),c(a,{modelValue:j.value.proposalInsuredList[0].gender,"onUpdate:modelValue":t[4]||(t[4]=e=>j.value.proposalInsuredList[0].gender=e),name:"gender",label:"性别",rules:[{required:!0,message:"请选择"}]},{input:k((()=>[c(I,{modelValue:j.value.proposalInsuredList[0].gender,"onUpdate:modelValue":t[3]||(t[3]=e=>j.value.proposalInsuredList[0].gender=e),options:v(O)},null,8,["modelValue","options"])])),_:1},8,["modelValue"])])),_:1})])),_:1},512),(s(!0),d(p,null,u(j.value.proposalInsuredList[0].proposalInsuredProductList||[],(e=>(s(),f(o,{key:e.productId},{default:k((()=>{var r,t;return[c(oe,{"product-risk-list":e.proposalProductRiskList,"product-info":e,"product-num":(null===(r=j.value.proposalInsuredList[0])||void 0===r||null===(t=r.proposalInsuredProductList)||void 0===t?void 0:t.length)-1,"product-data":N.value.productCollection[e.productId],"pick-product-premium":H,onAddRiderRisk:G,onUpdateRisk:K,onDeleteRisk:M},null,8,["product-risk-list","product-info","product-num","product-data"])]})),_:2},1024)))),128)),n("div",se,[c(y,{activated:"",round:34,onClick:Y},{default:k((()=>[de])),_:1})])]),n("div",pe,[n("span",ue,[ne,n("span",ce,"￥"+m(j.value.totalPremium.toLocaleString()),1)]),n("div",me,[c(w,{type:"primary",onClick:q},{default:k((()=>[ve])),_:1})])]),v(b)?(s(),f(C,{key:0,"is-show":v(b),type:N.value.type,"rider-risk":(null===(e=N.value.riderRisk)||void 0===e?void 0:e[N.value.productId])||[],"product-data":N.value.productCollection[N.value.productId],"form-info":N.value.productInfo,holder:j.value.proposalHolder,insured:j.value.proposalInsuredList[0],"current-risk":N.value.currentRisk,onClose:X,onFinished:Q},null,8,["is-show","type","rider-risk","product-data","form-info","holder","insured","current-risk"])):g("",!0),c(R,{show:v(h),"onUpdate:show":t[5]||(t[5]=e=>P(h)?h.value=e:null),actions:r,"cancel-text":"取消","close-on-click-action":"",onCancel:t[6]||(t[6]=e=>v(D)(!1)),onSelect:A},null,8,["show"])]})),_:1})}}});e("default",D(fe,[["__scopeId","data-v-9b8052b4"]]))}}}))}();
