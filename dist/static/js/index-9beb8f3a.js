var ae=Object.defineProperty,se=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var Q=(p,s,u)=>s in p?ae(p,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[s]=u,S=(p,s)=>{for(var u in s||(s={}))de.call(s,u)&&Q(p,u,s[u]);if(J)for(var u of J(s))ie.call(s,u)&&Q(p,u,s[u]);return p},q=(p,s)=>se(p,ue(s));import{g as X,C as B,X as M,r as m,h as _,j as A,k as i,y as c,n as d,m as w,E as K,I as C,F as Z,B as T,aj as le,Q as ce,a5 as fe,L as pe,x as me,o as _e,z as l,s as j}from"./vendor-413031aa.js";import{_ as Ie,u as ve,G as U,F as $,P as ye}from"./index-78c8ea05.js";import{c as Oe,n as Ee,a as Be}from"./index-2f50a653.js";import{_ as G,R as Ae,B as Le,a as ge}from"./index-8fe42c0e.js";import"./useDicData-58b2bbcb.js";const Ce={class:"com-select-container"},Te={class:"radio-item-wrapper"},he={class:"name"},Fe={class:"hone"},De={class:"address"},be={class:"footer-button"},Ne=T("\u53D6\u6D88"),Re=T("\u786E\u8BA4"),xe=X({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(p,{emit:s}){const u=p,E=B(u.modelValue),h=B(u.show),Y=()=>{s("submit",E.value),h.value=!1},R=()=>{s("close")};return M(()=>u.modelValue,v=>{console.log("newVal",v),E.value=v}),M(()=>E.value,v=>{s("update:modelValue",v)}),(v,L)=>{const g=m("van-radio"),n=m("van-radio-group"),F=m("VanButton");return _(),A(ve,{show:h.value,"onUpdate:show":L[1]||(L[1]=f=>h.value=f),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:R},{default:i(()=>[c("div",Ce,[d(n,{modelValue:E.value,"onUpdate:modelValue":L[0]||(L[0]=f=>E.value=f)},{default:i(()=>[(_(!0),w(Z,null,K(p.dataSource,(f,y)=>(_(),A(g,{key:y,name:y+1,class:"radio-item"},{default:i(()=>[c("div",Te,[c("p",null,[c("span",he,C(f.contactName),1),c("span",Fe,C(f.contactPhoneNo),1)]),c("p",De,C(f.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),c("div",be,[d(F,{plain:"",type:"primary"},{default:i(()=>[Ne]),_:1}),d(F,{type:"primary",onClick:Y},{default:i(()=>[Re]),_:1})])]),_:1},8,["show"])}}});var Pe=Ie(xe,[["__scopeId","data-v-9c6de82e"]]);const He={key:0,class:"beneficiary-part"},ke={class:"part-title"},Ve={class:"title"},Se=T("\u5220\u9664"),je=T("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),Ue=T("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),$e={class:"radio-item-wrapper"},we={class:"name"},Me={class:"hone"},Ye={class:"address"},qe={class:"footer-button"},Ge=T("\u4E0B\u4E00\u6B65"),Ze=X({setup(p){const s=le(),u=ce(),{templateId:E=1,orderNo:h="2022072710380711215",tenantId:Y="9991000007"}=u.query,[R,v]=fe(),L=u.path==="/infoPreview"?"infoPreview":"infoCollection",g=B({}),n=B({extInfo:{pageCode:L},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),F=B(null),f=B([]),y=B([]),W=B([]),I=pe({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),D=me(()=>{var t,e;return I.currentAddress?I.addressList[I.currentAddress]:((e=(t=n.value.extInfo)==null?void 0:t.contactInfo)==null?void 0:e[0])||{}}),ee=()=>{const t=S({},n.value);t.extInfo=q(S({},t.extInfo),{contactInfo:[D.value]}),t.tenantOrderAttachmentList=[{category:U.OBVERSE_CERT,objectType:$.HOLDER,objectId:n.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:f.value[0]},{category:U.REVERSE_CERT,objectType:$.HOLDER,objectId:n.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:f.value[1]},{category:U.OBVERSE_CERT,objectType:$.INSURED,objectId:n.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:y.value[0]},{category:U.REVERSE_CERT,objectType:$.INSURED,objectId:n.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:y.value[1]}],F.value.validate().then(e=>{Ee(t).then(({code:r,data:o})=>{r==="10000"&&o.pageAction.pageAction==="jumpToPage"&&s.push({path:ye[o.pageAction.data.nextPageCode],query:u.query})})})},te=t=>{console.log("value",t)},ne=()=>{I.beneficiaryId+=1,n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:I.beneficiaryId,extInfo:{}})},oe=t=>{n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(e=>e.beneficiaryId!==t.beneficiaryId)},re=()=>{Be({orderNo:h,tenantId:Y}).then(({code:t,data:e})=>{if(t==="10000"){const r=e;r.extInfo=q(S({},r.extInfo),{pageCode:L,templateId:E}),r.tenantOrderHolder=r.tenantOrderHolder||{},r.tenantOrderHolder.extInfo=r.tenantOrderHolder.extInfo||{},r.tenantOrderInsuredList[0].extInfo=r.tenantOrderInsuredList[0].extInfo||{},r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{const O=o;return O.extInfo={},O}),r.tenantOrderAttachmentList.forEach(o=>{o.category,o.objectType,o.category===22?o.objectType===2?f[0]=o.uri:o.objectType===3&&(y[0]=o.uri):o.category===23&&(o.objectType===2?f[1]=o.uri:o.objectType===3&&(y[1]=o.uri))}),Object.assign(n.value,r)}}).finally(()=>{I.isLoading=!1})};return _e(()=>{re(),Oe({pageCode:"infoCollection",templateId:E}).then(({code:t,data:e})=>{if(t==="10000"){const r={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(o=>{(r[o.moduleType]=r[o.moduleType]||[]).push(o)}),g.value=r}})}),M(()=>n.value,t=>{var e,r,o,O,x,b,P,H,k,V;if(t){const a=[{contactAddress:(r=(e=t.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:r.familyAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(O=(o=t.tenantOrderHolder)==null?void 0:o.extInfo)==null?void 0:O.workAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(b=(x=t.tenantOrderInsuredList[0])==null?void 0:x.extInfo)==null?void 0:b.familyAddress,contactName:(P=t.tenantOrderInsuredList[0])==null?void 0:P.name,contactPhoneNo:(H=t.tenantOrderInsuredList[0])==null?void 0:H.mobile},{contactAddress:(V=(k=t.tenantOrderInsuredList[0])==null?void 0:k.extInfo)==null?void 0:V.workAddress,contactName:t.tenantOrderInsuredList[0].name,contactPhoneNo:t.tenantOrderInsuredList[0].mobile}];I.addressList=a.filter(N=>N.contactAddress&&N.contactName&&N.contactPhoneNo)}},{deep:!0,immediate:!0}),M(()=>n.value.tenantOrderInsuredList[0].relationToHolder,t=>{+t==1&&Object.assign(n.value.tenantOrderInsuredList[0],n.value.tenantOrderHolder,{id:n.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(t,e)=>{const r=m("ProCard"),o=m("ProRadioButton"),O=m("ProField"),x=m("ProSvg"),b=m("VanButton"),P=m("ProCheckButton"),H=m("van-cell"),k=m("ProForm"),V=m("ProPageWrap");return _(),A(V,{class:"page-info-wrapper"},{default:i(()=>[l(I).isLoading?j("",!0):(_(),A(k,{key:0,ref_key:"formRef",ref:F},{default:i(()=>[d(r,{title:"\u6295\u4FDD\u4EBA"},{default:i(()=>[d(G,{images:f.value,"onUpdate:images":e[0]||(e[0]=a=>f.value=a),"form-info":n.value.tenantOrderHolder,"factor-list":g.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),d(r,{title:"\u88AB\u4FDD\u4EBA"},{default:i(()=>[d(O,{modelValue:n.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=a=>n.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:i(()=>[d(o,{modelValue:n.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.tenantOrderInsuredList[0].relationToHolder=a),options:l(Ae)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+n.value.tenantOrderInsuredList[0].relationToHolder!=1?(_(),A(G,{key:0,images:y.value,"onUpdate:images":e[3]||(e[3]=a=>y.value=a),"form-info":n.value.tenantOrderInsuredList[0],"factor-list":g.value.INSURER||[]},null,8,["images","form-info","factor-list"])):j("",!0),d(O,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),d(r,{title:"\u53D7\u76CA\u4EBA"},{default:i(()=>[d(O,{modelValue:n.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:i(()=>[d(o,{modelValue:n.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[4]||(e[4]=a=>n.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:l(Le)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),n.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(_(),w("div",He,[(_(!0),w(Z,null,K(n.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(a,N)=>(_(),w("div",{key:a.beneficiaryId||a.id,class:"beneficiary-item"},[c("div",ke,[c("span",Ve,C(`\u53D7\u76CA\u4EBA${N+1}`),1),d(x,{name:"delete",onClick:z=>oe(a)},{default:i(()=>[Se]),_:2},1032,["onClick"])]),d(G,{images:W.value,"onUpdate:images":e[6]||(e[6]=z=>W.value=z),"form-info":a,"factor-list":g.value.BENEFICIARY||[]},null,8,["images","form-info","factor-list"]),d(ge,{"form-info":a,"factor-list":g.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),d(b,{onClick:ne},{default:i(()=>[je]),_:1})])):j("",!0)]),_:1}),d(r,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:i(()=>[Object.keys(l(D)).length?(_(),A(H,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:e[8]||(e[8]=a=>l(v)(!0))},{title:i(()=>[c("div",$e,[c("p",null,[c("span",we,C(l(D).contactName),1),c("span",Me,C(l(D).contactPhoneNo),1)]),c("p",Ye,C(l(D).contactAddress),1)])]),_:1})):(_(),A(P,{key:0,activated:"",onClick:e[7]||(e[7]=a=>l(v)(!0))},{default:i(()=>[Ue]),_:1}))]),_:1})]),_:1},512)),c("div",qe,[d(b,{block:"",type:"primary",onClick:ee},{default:i(()=>[Ge]),_:1})]),l(R)?(_(),A(Pe,{key:1,modelValue:l(I).currentAddress,"onUpdate:modelValue":e[9]||(e[9]=a=>l(I).currentAddress=a),show:l(R),"data-source":l(I).addressList,onSubmit:te,onClose:e[10]||(e[10]=a=>l(v)(!1))},null,8,["modelValue","show","data-source"])):j("",!0)]),_:1})}}});export{Ze as default};
