var Be=Object.defineProperty,he=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Ve=Object.prototype.hasOwnProperty,Ne=Object.prototype.propertyIsEnumerable;var se=(e,n,d)=>n in e?Be(e,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[n]=d,E=(e,n)=>{for(var d in n||(n={}))Ve.call(n,d)&&se(e,d,n[d]);if(re)for(var d of re(n))Ne.call(n,d)&&se(e,d,n[d]);return e},C=(e,n)=>he(e,Se(n));import{g as me,E as T,y as ve,_ as de,j as s,n as $,k as f,A as y,t as I,m as k,z as B,p as b,a4 as ye,a5 as Ee,C as K,O as Oe,a9 as Le,h as xe,r as G,G as we,F as Ge,T as ie,L as qe,J as We}from"./vendor-af6fda0a.js";import{q as Me}from"./index-a99815ab.js";import{_ as be,Y as fe,h as W,U as q,V as je,m as He,W as Pe,X as $e,w as Ke,Z as J,l as Z,B as Ue,$ as ze,a0 as Je,r as pe,H as Ze,R,T as _,n as Qe,P as Xe}from"./index-7f6a159e.js";import{c as M,a as ce}from"./order-35b0e3c5.js";import{u as Ye}from"./useDicData-b633388b.js";import{_ as ea}from"./index-04e666fe.js";var X=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(X||{});const Y=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];M(Y);var ee=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(ee||{});const Ie=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];M(Ie);var V=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(V||{});const De=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];M(De);var A=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(A||{});const aa=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];M(De);var Ce=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(Ce||{});const ke=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];M(ke);const ua=e=>(ye("data-v-bb02bba6"),e=e(),Ee(),e),ta={class:"com-bank-card-info"},la=ua(()=>B("span",{class:"field-title"},[K("\u94F6\u884C\u5361\u7167\u7247 "),B("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),oa={class:"image-wrap"},na=me({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:n}){const d=e,x=Ye("BANK"),i=T({bankCardType:ee.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),F=o=>d.factor&&d.factor[o]&&d.factor[o].isDisplay===fe.YES,j=o=>o&&o.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247",O=ve(()=>x.value.map(o=>({label:o.name,value:o.code}))),U=o=>{Pe({ossKey:[o],imageType:$e.BANK_CARD}).then(p=>{const{data:r,code:m}=p;if(m==="10000"&&r&&r.bankCardOcrVO){i.value.bankCardNo=r.bankCardOcrVO.cardNo;const t=O.value.find(D=>D.label===r.bankCardOcrVO.bankName);t&&(i.value.payBank=t.value)}})};return de(()=>d.modelValue,o=>{i.value=o},{immediate:!0}),de(i,o=>{n("update:modelValue",o)}),(o,p)=>(s(),$("div",ta,[F("cardType")?(s(),f(W,{key:0,modelValue:i.value.bankCardType,"onUpdate:modelValue":p[0]||(p[0]=r=>i.value.bankCardType=r),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":y(Ie),"is-view":""},null,8,["modelValue","data-source"])):I("",!0),F("bankCardNumber")?(s(),f(q,{key:1,modelValue:i.value.bankCardNo,"onUpdate:modelValue":p[1]||(p[1]=r=>i.value.bankCardNo=r),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):I("",!0),F("cardHolder")?(s(),f(q,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):I("",!0),F("bank")?(s(),f(W,{key:3,modelValue:i.value.payBank,"onUpdate:modelValue":p[2]||(p[2]=r=>i.value.payBank=r),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":y(O),required:""},null,8,["modelValue","data-source"])):I("",!0),F("bankCardAttachment")?(s(),f(q,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:j}]},{label:k(()=>[la]),input:k(()=>[B("div",oa,[b(He,{modelValue:i.value.images,"onUpdate:modelValue":p[3]||(p[3]=r=>i.value.images=r),"max-count":2,"upload-type":y(je).BANK_CARD,onOnUploadFinished:U},null,8,["modelValue","upload-type"])])]),_:1},8,["rules"])):I("",!0),F("bankPreMobile")?(s(),f(q,{key:5,modelValue:i.value.mobile,"onUpdate:modelValue":p[4]||(p[4]=r=>i.value.mobile=r),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):I("",!0)]))}});var Q=be(na,[["__scopeId","data-v-bb02bba6"]]);const ra=e=>(ye("data-v-94393ad6"),e=e(),Ee(),e),sa={class:"page-bank-card"},da={class:"reprise-card-list"},ia=["onClick"],pa={class:"agree"},ca=K(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),ma={class:"footer-button footer"},va=ra(()=>B("div",{class:"text"},"\u5237\u65B0",-1)),ya=K("\u5206\u4EAB"),Ea=K("\u4E0B\u4E00\u6B65"),ba=me({setup(e){const n=Oe(),d=Le(),{orderNo:x="2022072710380711215",agentCode:i="D1234567-1",tenantId:F="9991000007",templateId:j=1,isShare:O,insureCode:U="kunlunhealth"}=n.query,o={bankCardType:ee.DEBIT};let p={};const r=T(""),m=T({payMethod:X.REAL_TIME,bankData:C(E({},o),{imagesId:[],images:[]})}),t=T({payMethod:X.REAL_TIME,expiryMethod:Ce.AUTOMATIC_PADDING,bankData:C(E({},o),{imagesId:[],images:[]}),payInfoType:A.FIRST_SAME}),D=T({bankData:C(E({},o),{imagesId:[],images:[]})}),L=T(A.FIRST_SAME),h=T({}),z=T(!1),ae=T(),ue=T(),te=T(),H=T({}),Re=v=>{L.value=v},P=(v,u)=>h.value&&h.value[u]&&h.value[u][v]&&h.value[u][v].isDisplay===fe.YES,Te=()=>{Je({insureCode:U,objectType:4,tenantId:F,orderNo:x}).then(({code:v,data:u})=>{v==="10000"&&(H.value=u)})},ge=()=>{pe({orderNo:x,saleUserId:i,tenantId:F}).then(v=>{var c,a,w;const{code:u,data:S}=v;u==="10000"&&(S.orderStatus===ce.PENDING||S.orderStatus===ce.PAYMENT_FAILED?Promise.all([(c=ae.value)==null?void 0:c.validate(),(a=ue.value)==null?void 0:a.validate(),(w=te.value)==null?void 0:w.validate()]).then(g=>{if(!z.value){ie.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}const l=[C(E({},g[0]),{id:m.value.id,paymentType:V.FIRST_TERM}),C(E({},g[1]),{id:t.value.id,paymentType:V.RENEW_TERM}),C(E({},g[2]),{id:D.value.id,paymentType:V.REPRISE,payInfoType:L.value})],N=[{category:R.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.INIT_SIGN,type:"png",uri:g[0].images[0],id:m.value.bankData.imagesId[0]},{category:R.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.INIT_SIGN,type:"png",uri:g[0].images[1],id:m.value.bankData.imagesId[1]}];t.value.payInfoType===A.OTHER&&(N.push({category:R.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:g[1].images[0],id:t.value.bankData.imagesId[0]}),N.push({category:R.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:g[1].images[1],id:t.value.bankData.imagesId[1]})),L.value===A.OTHER&&(N.push({category:R.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:g[2].images[0],id:D.value.bankData.imagesId[0]}),N.push({category:R.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:g[2].images[1],id:D.value.bankData.imagesId[1]})),Qe(C(E({},p),{pageCode:"payInfo",tenantOrderPayInfoList:l,extInfo:C(E({},p.extInfo),{templateId:j,pageCode:"payInfo",shareFlag:O?"Y":"N"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:N})).then(oe=>{const{code:Ae,data:ne}=oe;Ae==="10000"&&ne.success&&d.push({path:Xe[ne.pageAction.data.nextPageCode],query:n.query})})}):Ze("paymentResult",n.query))})},Fe=ve(()=>{const v=C(E({},n.query),{isShare:1,sharePageCode:"payInfo"});return`${window.location.origin}/phoneVerify?${Me.stringify(v)}`}),le=(v=!1)=>{pe({orderNo:x,saleUserId:i,tenantId:F}).then(u=>{const{code:S,data:c}=u;S==="10000"&&c&&(p=c,r.value=c.tenantOrderHolder.name,c.tenantOrderPayInfoList.forEach(a=>{a.paymentType===V.FIRST_TERM?(m.value=a,m.value.bankData=C(E(E({},o),a),{images:[],imagesId:[]})):a.paymentType===V.RENEW_TERM?(t.value=a,t.value.bankData=C(E({},a),{images:[],imagesId:[]})):a.paymentType===V.REPRISE&&(D.value=a,D.value.bankData=C(E({},a),{images:[],imagesId:[]}),L.value=a.payInfoType)}),c.tenantOrderAttachmentList.forEach(a=>{a.objectType===_.INIT_SIGN?(a.category===R.OBVERSE_BANK_CARD&&(m.value.bankData.images[0]=a.uri,m.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(m.value.bankData.images[1]=a.uri,m.value.bankData.imagesId[1]=a.id)):a.objectType===_.RENEWAL_SIGN?(a.category===R.OBVERSE_BANK_CARD&&(t.value.bankData.images[0]=a.uri,t.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(t.value.bankData.images[1]=a.uri,t.value.bankData.imagesId[1]=a.id)):a.objectType===_.ANNUAL_SIGN&&(a.category===R.OBVERSE_BANK_CARD&&(D.value.bankData.images[0]=a.uri,D.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(D.value.bankData.images[1]=a.uri,D.value.bankData.imagesId[1]=a.id))}),v&&(c.tenantOrderPayInfoList.find(a=>a.paymentType===V.FIRST_TERM&&a.bankCardNo)||ie("\u7528\u6237\u672A\u5B8C\u6210\u94F6\u884C\u5361\u4FE1\u606F\u586B\u5199")))})},_e=()=>{le(!0)};return xe(()=>{Te(),Ke({pageCode:"payInfo",templateId:j}).then(v=>{const{code:u,data:S}=v;if(u==="10000"){const c={};S.productInsureFactorList.forEach(a=>{c[a.moduleType]||(c[a.moduleType]={}),c[a.moduleType][a.code]=a}),h.value=c}}),le()}),(v,u)=>{const S=G("van-switch"),c=G("van-checkbox"),a=G("ProSvg"),w=G("van-button"),g=G("ProPageWrap");return s(),f(g,null,{default:k(()=>[B("div",sa,[b(Z,{title:"\u9996\u671F\u652F\u4ED8"},{default:k(()=>[b(J,{ref_key:"form1",ref:ae},{default:k(()=>[P("paymentMethod","INIT")?(s(),f(W,{key:0,modelValue:m.value.payMethod,"onUpdate:modelValue":u[0]||(u[0]=l=>m.value.payMethod=l),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":y(Y)},null,8,["modelValue","data-source"])):I("",!0),b(Q,{modelValue:m.value.bankData,"onUpdate:modelValue":u[1]||(u[1]=l=>m.value.bankData=l),"holder-name":r.value,factor:h.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),b(Z,{title:"\u7EED\u671F\u652F\u4ED8"},{default:k(()=>[b(J,{ref_key:"form2",ref:ue},{default:k(()=>[P("sameAsInit","RENEWAL")?(s(),f(q,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:k(()=>[b(S,{modelValue:t.value.payInfoType,"onUpdate:modelValue":u[2]||(u[2]=l=>t.value.payInfoType=l),size:"22","active-value":y(A).FIRST_SAME,"inactive-value":y(A).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):I("",!0),P("paymentMethod","RENEWAL")?(s(),f(W,{key:1,modelValue:t.value.payMethod,"onUpdate:modelValue":u[3]||(u[3]=l=>t.value.payMethod=l),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":y(Y),required:""},null,8,["modelValue","data-source"])):I("",!0),P("overduePayment","RENEWAL")?(s(),f(W,{key:2,modelValue:t.value.expiryMethod,"onUpdate:modelValue":u[4]||(u[4]=l=>t.value.expiryMethod=l),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":y(ke),required:"","label-width":"200"},null,8,["modelValue","data-source"])):I("",!0),t.value.payInfoType!==y(A).FIRST_SAME?(s(),f(Q,{key:3,modelValue:t.value.bankData,"onUpdate:modelValue":u[5]||(u[5]=l=>t.value.bankData=l),"holder-name":r.value,factor:h.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):I("",!0)]),_:1},512)]),_:1}),b(Z,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:k(()=>[B("div",da,[(s(!0),$(Ge,null,we(y(aa),(l,N)=>(s(),$("div",{key:N,class:qe(["reprise-card-item",{selected:L.value===l.value}]),onClick:oe=>Re(l.value)},We(l.label),11,ia))),128))]),b(J,{ref_key:"form3",ref:te},{default:k(()=>[L.value===y(A).OTHER?(s(),f(Q,{key:0,modelValue:D.value.bankData,"onUpdate:modelValue":u[6]||(u[6]=l=>D.value.bankData=l),"holder-name":r.value,factor:h.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):I("",!0)]),_:1},512)]),_:1}),B("div",pa,[b(c,{modelValue:z.value,"onUpdate:modelValue":u[7]||(u[7]=l=>z.value=l),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),ca,b(ze,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",content:H.value.materialContent,type:y(Ue)(H.value.materialContent,H.value.materialSource+"")},null,8,["content","type"])]),B("div",ma,[y(O)?I("",!0):(s(),$("div",{key:0,class:"refresh-btn",onClick:_e},[B("div",null,[b(a,{name:"refresh"})]),va])),y(O)?I("",!0):(s(),f(ea,{key:1,title:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",desc:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",link:y(Fe),"-":""},{default:k(()=>[b(w,{plain:"",type:"primary"},{default:k(()=>[ya]),_:1})]),_:1},8,["link"])),b(w,{type:"primary",class:"submit-btn",onClick:ge},{default:k(()=>[Ea]),_:1})])])]),_:1})}}});var ga=be(ba,[["__scopeId","data-v-94393ad6"]]);export{ga as default};
