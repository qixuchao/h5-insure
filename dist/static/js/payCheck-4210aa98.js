import{u as e,aI as o,D as t}from"./index-deb4ddfb.js";import{ref as a,onMounted as n}from"vue";import{u as r,b as u,c}from"./core-5f3b09dd.js";import{u as s}from"./useThread-c502137a.js";import"./pdfh5-e588f83d.js";const d={key:0,class:"wait-loading"},l={key:1,class:"result-view"},i={class:"content-box"},m=Vue.createElementVNode("div",{class:"content"},"开通成功，正在为您生成保单...",-1),V=Vue.createElementVNode("div",{class:"tip"},"请勿返回或退出",-1),p=Vue.defineComponent({__name:"payCheck",setup(p){const f=e().query,v=o(),h=a(!1),k=a(!1),C=a(""),N=a(!0);let w;const b=()=>{u({tenantId:f.tenantId,orderNo:f.orderNo}).then((e=>{const{code:o,data:t}=e;"10000"===o&&(N.value=!1);const a=t.redirectUrl||`/baseInsurance/orderDetail?orderNo=${f.businessTradeNo}&tenantId=${f.tenantId}&productCode=${f.productCode}`;1==+t.status?(k.value=!0,w.stop(),window.location.href=a):1==+f.from_wxpay?h.value=!0:c(f)})).catch()};return w=s({start:()=>{console.log("开始轮询"),b()},stop:()=>{console.log("结束轮询"),k.value||t.alert({title:"提示",message:"未查到支付成功状态，请检查是否已支付完成",confirmButtonText:"好的，我知道了"}).then((()=>{window.location.href=C.value}))},time:2e3,number:5}),r(),n((()=>{1==+f.from_wxpay?(h.value=!0,w.run()):b()})),(e,o)=>{const t=Vue.resolveComponent("van-icon"),a=Vue.resolveComponent("ProPageWrap"),n=Vue.resolveComponent("van-config-provider");return Vue.openBlock(),Vue.createBlock(n,{"theme-vars":Vue.unref(v)},{default:Vue.withCtx((()=>[Vue.createVNode(a,{"main-class":"page-pay-check"},{default:Vue.withCtx((()=>[Vue.unref(N)&&!Vue.unref(h)?(Vue.openBlock(),Vue.createElementBlock("div",d,"加载中，请稍候...")):Vue.createCommentVNode("",!0),!Vue.unref(N)&&Vue.unref(h)?(Vue.openBlock(),Vue.createElementBlock("div",l,[Vue.createElementVNode("div",i,[Vue.createVNode(t,{name:"checked",class:"large-icon"}),m,V])])):Vue.createCommentVNode("",!0)])),_:1})])),_:1},8,["theme-vars"])}}});export{p as default};
