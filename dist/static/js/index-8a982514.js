import{g as T,a5 as x,C as g,x as q,X as so,r as h,h as L,m as C,F as N,E as U,y as o,n as s,I,k as i,z as d,j as S,s as M,B as f,a1 as Y,a2 as j,ad as ao,Q as uo,o as no,d as ro,a6 as io,D as lo}from"./vendor-4dbfa310.js";import{g as co}from"./index-43962f28.js";import{u as po,P as _o}from"./index-01cc03ba.js";import{b as K,_ as W,n as mo}from"./index-e3074f98.js";import{b as fo,i as vo}from"./trial-ef6a620a.js";const ho=r=>K.post("/api/app/insure/proposal/AddOrUpdateProposal",r),ko=(r={})=>K.get(`/api/app/insure/proposal/queryProposalDetail/${r.id}`,r);const P=r=>(Y("data-v-0fddfe52"),r=r(),j(),r),Io={class:"com-product-list-wrapper"},Lo={class:"risk-item-wrapper"},Fo={class:"content"},Do={class:"risk-premium"},Po=f(" \u4FDD\u8D39:"),go={class:"premium"},Co={class:"risk-factor"},Ro={class:"factor"},yo={class:"factor-value"},Vo=P(()=>o("span",{class:"factor-name"}," \u4FDD\u989D(\u5143) ",-1)),Bo={class:"factor"},Eo={class:"factor-value"},bo=P(()=>o("span",{class:"factor-name"}," \u4FDD\u969C\u671F\u95F4 ",-1)),$o={class:"factor"},wo={class:"factor-value"},So=P(()=>o("span",{class:"factor-name"}," \u7F34\u8D39\u671F\u95F4 ",-1)),Ao={class:"operate-bar"},Oo=f("\u5220\u9664"),xo=f("+ \u9644\u52A0\u9669"),No=f("\u4FEE\u6539"),Uo={class:"content"},qo={class:"risk-premium"},To=f(" \u4FDD\u8D39:"),Mo={class:"premium"},Yo={class:"risk-factor"},jo={class:"factor"},Ko={class:"factor-value"},Wo=P(()=>o("span",{class:"factor-name"}," \u4FDD\u989D(\u5143) ",-1)),Xo={class:"factor"},zo={class:"factor-value"},Ho=P(()=>o("span",{class:"factor-name"}," \u4FDD\u969C\u671F\u95F4 ",-1)),Qo={class:"factor"},Go={class:"factor-value"},Jo=P(()=>o("span",{class:"factor-name"}," \u7F34\u8D39\u671F\u95F4 ",-1)),Zo={class:"operate-bar"},ot=f("\u5220\u9664"),tt=f("+ \u9644\u52A0\u9669"),et=f("\u4FEE\u6539"),st=P(()=>o("div",{class:"premium-total"},[f(" \u4FDD\u8D39: "),o("span",{class:"premium"},"\uFFE5"+I(234234))],-1)),at=T({props:{productRiskList:{default:()=>[]},enumList:{default:()=>({})},productInfo:{default:()=>({})},productData:{default:()=>({})}},emits:["deleteRisk","updateRisk","addRisk"],setup(r,{emit:D}){const v=r,[R,y]=x(),e=g({checkedList:[],disabledList:[],riderRiskList:[],mainRiskData:{}}),B=q(()=>{var l,p;return((p=(l=v.productData)==null?void 0:l.riskDetailVOList)==null?void 0:p[0].optionalRiderRiskVOList)||[]}),A=q(()=>{var l,p;return((p=(l=v.productData)==null?void 0:l.riskDetailVOList)==null?void 0:p[0].collocationVOList)||[]}),E=()=>{console.log("12313")},V=l=>{D("deleteRisk",l,v.productInfo)},O=l=>{D("updateRisk",l,v.productInfo)},c=l=>{y(!0),D("addRisk",l,v.productInfo)};return so(()=>v,()=>{console.log("props",v)},{deep:!0,immediate:!0}),(l,p)=>{const b=h("ProTitle"),F=h("ProCheckButton");return L(),C("div",Io,[(L(!0),C(N,null,U(r.productRiskList,u=>(L(),C("div",{key:u.riskId},[o("div",Lo,[s(b,{"risk-type":u.riskType,title:u.riskName},null,8,["risk-type","title"]),o("div",Fo,[o("div",Do,[Po,o("span",go,"\uFFE5"+I(u.premium.toLocaleString()),1)]),o("div",Co,[o("div",Ro,[o("span",yo,I(u.amount.toLocaleString()),1),Vo]),o("div",Bo,[o("span",Eo,I(u.coveragePeriod),1),bo]),o("div",$o,[o("span",wo,I(u.chargePeriod),1),So])]),o("div",Ao,[s(F,{round:32,class:"border",onClick:_=>V(u)},{default:i(()=>[Oo]),_:2},1032,["onClick"]),s(F,{activated:"",round:32,onClick:_=>c(u)},{default:i(()=>[xo]),_:2},1032,["onClick"]),s(F,{activated:"",round:32,onClick:_=>O(u)},{default:i(()=>[No]),_:2},1032,["onClick"])])])]),(L(!0),C(N,null,U(u.riderRiskVOList,_=>(L(),C("div",{key:_.riskCode,class:"risk-item-wrapper"},[s(b,{"risk-type":_.riskType,title:_.riskName},null,8,["risk-type","title"]),o("div",Uo,[o("div",qo,[To,o("span",Mo,"\uFFE5"+I(_.premium.toLocaleString()),1)]),o("div",Yo,[o("div",jo,[o("span",Ko,I(u.amount.toLocaleString()),1),Wo]),o("div",Xo,[o("span",zo,I(u.coveragePeriod),1),Ho]),o("div",Qo,[o("span",Go,I(u.chargePeriod),1),Jo])]),o("div",Zo,[s(F,{round:32,class:"border",onClick:$=>V(_)},{default:i(()=>[ot]),_:2},1032,["onClick"]),s(F,{activated:"",round:32,onClick:$=>c(_)},{default:i(()=>[tt]),_:2},1032,["onClick"]),s(F,{activated:"",round:32,onClick:$=>O(_)},{default:i(()=>[et]),_:2},1032,["onClick"])])])]))),128)),st]))),128)),d(R)?(L(),S(fo,{key:0,modelValue:e.value.checkedList,"onUpdate:modelValue":p[0]||(p[0]=u=>e.value.checkedList=u),show:d(R),disabled:e.value.disabledList,"risk-list":d(B),"collocation-list":d(A),onFinished:E,onClose:p[1]||(p[1]=u=>d(y)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):M("",!0)])}}});var ut=W(at,[["__scopeId","data-v-0fddfe52"]]);const nt=r=>(Y("data-v-7afe8830"),r=r(),j(),r),rt={class:"container"},it=nt(()=>o("span",null,"\u8BA1\u5212\u4E66\u540D\u79F0",-1)),lt={class:"operate-bar"},dt=f("\u6DFB\u52A0\u4E3B\u9669"),ct={class:"footer-bar"},pt={class:"trial-result"},_t=f(" \u603B\u4FDD\u8D39 "),mt={class:"result-num"},ft={class:"trial-operate"},vt=f("\u4FDD\u5B58\u5E76\u9884\u89C8"),ht=T({setup(r){const[D,v]=x(!1),[R,y]=x(),e=g({proposalHolder:{},proposalInsuredList:[{name:"",gender:"",birthday:"",proposalInsuredProductList:[]}],proposalName:"",totalPremium:0,relationUserType:2}),B=ao(),A=uo(),E=po(),{id:V,type:O="add"}=A.query,c=g({enumList:{},productId:0,productCollection:{},productInfo:{}}),l=g();g({}),g([]);const p=(n,t)=>{const m=t;lo.confirm({message:"\u786E\u8BA4\u5220\u9664\u8BE5\u9669\u79CD\uFF1F"}).then(()=>{n.riskType===1?e.value.proposalInsuredList[0].proposalInsuredProductList=e.value.proposalInsuredList[0].proposalInsuredProductList.filter(k=>k.productId!==t.productId):m.proposalProductRiskList[0].riderRiskVOList=m.proposalProductRiskList[0].riderRiskVOList.filter(k=>k.riskId!==n.riskId)})},b=(n,t)=>{c.value.productId=t.productId,c.value.productInfo=t,y(!0)},F=n=>{},u=()=>{ko({id:V}).then(({code:n,data:t})=>{n==="10000"&&Object.assign(e.value,t)})},_=()=>{ho(e.value).then(({code:n,data:t})=>{n==="10000"&&B.push({path:"/compositionProposal",query:{id:t}})})},$=()=>{co({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then(({code:t,data:m})=>{if(t==="10000"){const k={};m.forEach(w=>{k[w.dictCode]=w.dictItemList}),c.enumList=k}})},X=n=>{e.value.proposalInsuredList[0]=e.value.proposalInsuredList[0].map(t=>{let m=t;return t[0].productId===n.proposalInsuredList[0].proposalInsuredProductList[0].productId&&(m=n.proposalInsuredList[0].proposalInsuredProductList),m})},z=()=>{vo({productId:118,source:2}).then(({code:n,data:t})=>{n==="10000"&&(c.value.productCollection[t.productBasicInfoVO.id]=t)}).finally(()=>{})},H=()=>{E.setProposalInfo(e.value),B.push({path:"/proposalList",query:{isCreateProposal:"1"}})},Q=()=>{y(!1)};return no(()=>{const n=E.$state.trialData;V?u():n.length&&Object.assign(e.value,n[0]),z(),$()}),(n,t)=>{const m=h("VanField"),k=h("ProCard"),w=h("ProRadioButton"),G=h("VanForm"),J=h("ProCheckButton"),Z=h("VanButton"),oo=h("van-datetime-picker"),to=h("van-popup"),eo=h("ProPageWrap");return L(),S(eo,{class:"page-create-wrapper"},{default:i(()=>[o("div",rt,[s(G,{ref_key:"formRef",ref:l,"input-align":"right","error-message-align":"right"},{default:i(()=>[s(k,null,{default:i(()=>[s(m,{modelValue:e.value.proposalName,"onUpdate:modelValue":t[0]||(t[0]=a=>e.value.proposalName=a),name:"proposalName",placeholder:"\u8BF7\u8F93\u5165\u8BA1\u5212\u4E66\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BA1\u5212\u4E66\u540D\u79F0"}]},{label:i(()=>[it]),_:1},8,["modelValue"])]),_:1}),s(k,{title:"\u88AB\u4FDD\u4EBA\u4FE1\u606F"},{default:i(()=>[s(m,{modelValue:e.value.proposalInsuredList[0].name,"onUpdate:modelValue":t[1]||(t[1]=a=>e.value.proposalInsuredList[0].name=a),name:"name",label:"\u59D3\u540D",placeholder:"\u8BF7\u8F93\u5165\uFF08\u9009\u586B\uFF09"},null,8,["modelValue"]),s(m,{modelValue:e.value.proposalInsuredList[0].birthday,"onUpdate:modelValue":t[2]||(t[2]=a=>e.value.proposalInsuredList[0].birthday=a),name:"birthday",label:"\u51FA\u751F\u65E5\u671F","is-link":"",readonly:"",placeholder:"\u8BF7\u9009\u62E9",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],onClick:t[3]||(t[3]=a=>d(v)(!0))},null,8,["modelValue"]),s(m,{modelValue:e.value.proposalInsuredList[0].gender,"onUpdate:modelValue":t[5]||(t[5]=a=>e.value.proposalInsuredList[0].gender=a),name:"gender",label:"\u6027\u522B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:i(()=>[s(w,{modelValue:e.value.proposalInsuredList[0].gender,"onUpdate:modelValue":t[4]||(t[4]=a=>e.value.proposalInsuredList[0].gender=a),options:d(mo)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])]),_:1})]),_:1},512),(L(!0),C(N,null,U(e.value.proposalInsuredList[0].proposalInsuredProductList||[],a=>(L(),S(k,{key:a.productId},{default:i(()=>[s(ut,{"enum-list":c.value.enumList,"product-risk-list":a.proposalProductRiskList,"product-info":a,"product-data":c.value.productCollection[a.productId],onAddRisk:F,onUpdateRisk:b,onDeleteRisk:p},null,8,["enum-list","product-risk-list","product-info","product-data"])]),_:2},1024))),128)),o("div",lt,[s(J,{activated:"",round:34,onClick:H},{default:i(()=>[dt]),_:1})])]),o("div",ct,[o("span",pt,[_t,o("span",mt,"\uFFE5"+I(e.value.totalPremium.toLocaleString()),1)]),o("div",ft,[s(Z,{type:"primary",onClick:_},{default:i(()=>[vt]),_:1})])]),s(to,{show:d(D),"onUpdate:show":t[8]||(t[8]=a=>io(D)?D.value=a:null),position:"bottom"},{default:i(()=>[s(oo,{type:"date",onConfirm:t[6]||(t[6]=a=>{e.value.proposalInsuredList[0].birthday=d(ro)(a).format("YYYY-MM-DD"),d(v)(!1)}),onCancel:t[7]||(t[7]=a=>d(v)(!1))})]),_:1},8,["show"]),d(R)?(L(),S(_o,{key:0,"is-show":d(R),type:"edit","product-data":c.value.productCollection[c.value.productId],"form-info":c.value.productInfo,onClose:Q,onFinished:X},null,8,["is-show","product-data","form-info"])):M("",!0)]),_:1})}}});var Pt=W(ht,[["__scopeId","data-v-7afe8830"]]);export{Pt as default};
