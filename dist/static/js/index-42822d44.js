import{v as e,d as a,j as o,c9 as t,d3 as s,K as l,C as r,B as d,b as c,cf as i,cO as n,bK as u,H as p,X as v,d4 as m,d5 as f,d6 as h,ce as g,k as C,d7 as y,a0 as k,d8 as P,bo as b,o as L,c as x,u as _,p as w,g as V,_ as I,t as S,r as j,a as M,e as $,F as B,q as O,I as U,O as q,d9 as F,aG as T,n as A,f as N,m as R,w as z,da as K,a8 as E,c3 as X,aK as D,ai as G,cC as H,aE as J,aF as W,z as Q,cJ as Y,aB as Z,bt as ee,aC as ae,h as oe,i as te,cT as se,bX as le,l as re,bP as de,T as ce,bc as ie}from"./index-4f878428.js";import{P as ne}from"./index-e5e4b474.js";import{L as ue}from"./index-fff081f3.js";import{S as pe}from"./index-645beb27.js";import{_ as ve}from"./index-f4da48a4.js";import{_ as me}from"./empty-ae586b6c.js";import{P as fe,u as he}from"./ProductTips-0aa56508.js";import{q as ge,a as Ce}from"./proposalList-8f2cf60a.js";import{P as ye}from"./index-2f65d128.js";import{C as ke}from"./index-583701c4.js";import{q as Pe}from"./trial-76e92b21.js";const[be,Le]=e("tabbar"),xe={route:Boolean,fixed:l,border:l,zIndex:r,placeholder:Boolean,activeColor:String,beforeChange:Function,inactiveColor:String,modelValue:d(0),safeAreaInsetBottom:{type:Boolean,default:null}},_e=Symbol(be);const we=p(a({name:be,props:xe,emits:["change","update:modelValue"],setup(e,{emit:a,slots:l}){const r=o(),{linkChildren:d}=t(_e),p=s(r,Le),v=()=>{var a;return null!=(a=e.safeAreaInsetBottom)?a:e.fixed},m=()=>{var a;const{fixed:o,zIndex:t,border:s}=e;return c("div",{ref:r,role:"tablist",style:i(t),class:[Le({fixed:o}),{[n]:s,"van-safe-area-bottom":v()}]},[null==(a=l.default)?void 0:a.call(l)])};return d({props:e,setActive:(o,t)=>{u(e.beforeChange,{args:[o],done(){a("update:modelValue",o),a("change",o),t()}})}}),()=>e.fixed&&e.placeholder?p(m):m()}})),[Ve,Ie]=e("tabbar-item");const Se=p(a({name:Ve,props:v({},m,{dot:Boolean,icon:String,name:r,badge:r,badgeProps:Object,iconPrefix:String}),emits:["click"],setup(e,{emit:a,slots:o}){const t=f(),s=h().proxy,{parent:l,index:r}=g(_e);if(!l)return;const d=C((()=>{var a;const{route:o,modelValue:t}=l.props;if(o&&"$route"in s){const{$route:a}=s,{to:o}=e,t=P(o)?o:{path:o};return!!a.matched.find((e=>{const a="path"in t&&t.path===e.path,o="name"in t&&t.name===e.name;return a||o}))}return(null!=(a=e.name)?a:r.value)===t})),i=o=>{var s;d.value||l.setActive(null!=(s=e.name)?s:r.value,t),a("click",o)},n=()=>o.icon?o.icon({active:d.value}):e.icon?c(b,{name:e.icon,classPrefix:e.iconPrefix},null):void 0;return()=>{var a;const{dot:t,badge:s}=e,{activeColor:r,inactiveColor:u}=l.props,p=d.value?r:u;return c("div",{role:"tab",class:Ie({active:d.value}),style:{color:p},tabindex:0,"aria-selected":d.value,onClick:i},[c(y,k({dot:t,class:Ie("icon"),content:s},e.badgeProps),{default:n}),c("div",{class:Ie("text")},[null==(a=o.default)?void 0:a.call(o,{active:d.value})])])}}}));const je={class:"search-wrap"},Me=a({name:"search"});var $e=I(a({...Me,props:{shape:null,modelValue:{default:""}},emits:["search"],setup(e,{emit:a}){const o=e,t=C((()=>o.modelValue)),s=()=>{a("search",t)};return(e,a)=>{const o=pe;return L(),x("div",je,[c(o,k({modelValue:_(t),"onUpdate:modelValue":a[0]||(a[0]=e=>w(t)?t.value=e:null),placeholder:"请输入",shape:"round",class:"search","clear-trigger":"always",clearable:""},e.$attrs,{"show-action":!!_(t),onSearch:s}),null,16,["modelValue","show-action"]),V(e.$slots,"default",{},void 0,!0)])}}}),[["__scopeId","data-v-59f31c82"]]);const Be={class:"com-product-item"},Oe={class:"content-wrap"},Ue={class:"product-image"},qe={class:"product-info"},Fe={class:"title"},Te={class:"description"},Ae={class:"tags"};var Ne=I(a({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const a=e,{productInfo:o}=S(a),t=j({checked:!1});return S(t),(a,t)=>{var s,l,r,d,i;const n=U;return L(),x("div",Be,[M("div",Oe,[M("div",Ue,[c(n,{src:(null==(s=_(o).showConfig)?void 0:s.fileThumbnailUrl)||(null==(l=_(o).showConfig)?void 0:l.fileUrl)},null,8,["src"])]),M("div",qe,[M("p",Fe,$(null==(r=_(o).showConfig)?void 0:r.title),1),M("p",Te,$(null==(d=_(o).showConfig)?void 0:d.text),1),M("p",Ae,[(L(!0),x(B,null,O(null==(i=_(o).showConfig)?void 0:i.tags,((e,a)=>(L(),x("span",{key:a,class:"tag"},$(e),1)))),128))])]),V(a.$slots,"checkedProduct",{},void 0,!0)]),c(fe,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-002f53ee"]]);const Re=["xlink:href"],ze=a({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const a=e,o=C((()=>`#icon-${a.name}`)),t=C((()=>a.name?`svg-icon icon-${a.name}`:"svg-icon"));return(a,s)=>(L(),x("svg",k({class:_(t)},a.$attrs,{style:{color:e.color}}),[M("use",{"xlink:href":_(o)},null,8,Re)],16))}});const Ke=e=>(J("data-v-88e3365a"),e=e(),W(),e),Ee={class:"com-tab-filter"},Xe={class:"article-mid"},De={class:"article-tag"},Ge=["onClick"],He=Ke((()=>M("span",null,null,-1))),Je={class:"popup-inner"},We=Ke((()=>M("div",{class:"popup-title"},"保险公司",-1))),Qe={class:"footer-button"};var Ye=I(a({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:a}){const t=e,{isPopShow:s,openPop:l,closePop:r}=function(e=!1){const a=o(e);return{isPopShow:a,openPop:e=>{e instanceof Function&&e(),a.value=!0},closePop:e=>{a.value=!1,e instanceof Function&&e()}}}(!1),d=j({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:n}=S(d),u=o(""),p=()=>{n.value=[]},v=()=>{var e;const{productCategoryId:o}=(null==(e=d.productCategoryList)?void 0:e[u.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:o}),r()};q((()=>{t.filter&&F().then((e=>{const{code:a,data:o}=e;"10000"===a&&(i.value=null==o?void 0:o.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),T((()=>{ge().then((e=>{const{code:a,data:o}=e||{};"10000"===a&&D(o)&&(d.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...o])}))}));const m=o();return q((()=>{m.value=document.querySelector(".page-proposal")})),(o,t)=>{const f=G,h=H;return L(),x("div",Ee,[M("div",Xe,[M("div",De,[(L(!0),x(B,null,O(_(d).productCategoryList,((e,o)=>(L(),x("div",{key:o,class:A(["tag-item",{checked:_(u)==o}]),onClick:t=>((e,o)=>{var t;u.value=o;const{productCategoryId:s}=(null==(t=d.productCategoryList)?void 0:t[u.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:s})})(null==e||e.productCategoryId,o)},[M("div",{class:A(["tag-out",{checked:_(u)==o}])},[M("div",{class:A(["tag-item-text",{checked:_(u)==o}])},$(e.productCategoryName),3)],2)],10,Ge)))),128))]),e.filter?(L(),x("div",{key:0,class:"filter",onClick:t[0]||(t[0]=(...e)=>_(l)&&_(l)(...e))},[He,M("div",{class:A(["text",{"has-select-condition":_(n).length>0}])},"筛选",2),c(ze,{name:"filter"})])):N("",!0),_(m)?(L(),R(h,{key:1,show:_(s),position:"right","close-on-click-overlay":"",class:"proposal-list-filter-popup-wrap",style:X(e.popupStyle),onClickOverlay:_(r)},{default:z((()=>[M("div",Je,[We,c(K,{modelValue:_(n),"onUpdate:modelValue":t[1]||(t[1]=e=>w(n)?n.value=e:null),options:_(i)},null,8,["modelValue","options"])]),M("div",Qe,[c(f,{plain:"",type:"primary",onClick:p},{default:z((()=>[E("重置")])),_:1}),c(f,{type:"primary",onClick:v},{default:z((()=>[E("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])):N("",!0)])])}}}),[["__scopeId","data-v-88e3365a"]]);const Ze={class:"com-trial-product-wrapper"},ea={class:"container"},aa=(e=>(J("data-v-49f70a68"),e=e(),W(),e))((()=>M("span",{class:"title"}," 已选产品 ",-1))),oa={class:"popup-body"},ta={class:"cell-title"},sa={class:"title"},la=a({name:"TrialProductPopup"});var ra=I(a({...la,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:a}){const t=e,s=o([]),l=o([]),r=o({isShow:t.isShow}),d=()=>{a("close")},i=()=>{l.value=[],a("checked",[])},n=e=>{var o,t,r;null==(r=null==(t=null==(o=null==s?void 0:s.value)?void 0:o[e])?void 0:t.toggle)||r.call(t),a("checked",l.value)};return Q((()=>t.isShow),(e=>{r.value.isShow=e})),Q(l,((e=[])=>{a("update:modalValue",e)}),{deep:!0,immediate:!0}),Q((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(a,o)=>{const t=Z,u=ee,p=ke,v=ae,m=H;return L(),x("div",Ze,[c(m,{show:_(r).isShow,"onUpdate:show":o[1]||(o[1]=e=>_(r).isShow=e),position:"bottom",onClose:d},{default:z((()=>[M("div",ea,[M("div",{class:"popup-header"},[M("span",{class:"clear-all",onClick:i}," 清空选项 "),aa,M("span",{class:"close",onClick:d})]),M("div",oa,[c(v,{modelValue:_(l),"onUpdate:modelValue":o[0]||(o[0]=e=>w(l)?l.value=e:null)},{default:z((()=>[c(p,{inset:""},{default:z((()=>[(L(!0),x(B,null,O(e.proposalList,(e=>(L(),R(u,{key:e.productCode,title:e.productName,onClick:a=>n(e.productCode)},{"right-icon":z((()=>{var a;return[c(t,{ref_for:!0,ref:a=>_(s)[e.productCode]=a,shape:"square","model-value":null==(a=_(l))?void 0:a.includes(e.productCode),name:e.productCode,onClick:Y((a=>n(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:z((()=>[M("div",ta,[M("div",sa,$(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const da={class:"page-proposal-list"},ca={class:"check-button"},ia={key:1,class:"van-sticky"},na={class:"add-plan"},ua={class:"has-select-product"},pa=(e=>(J("data-v-40eee3f9"),e=e(),W(),e))((()=>M("span",{class:"icon"},null,-1))),va=a({name:"ProposalList"});var ma=I(a({...va,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const a=he(),t=oe(),s=te(),{isCreateProposal:l}=s.query,r=se(),d=j({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],excludeMainRiskCode:[],firstLoading:!0}),{searchValue:i,tagLists:n,isOpen:u,loading:p,finished:v,refreshing:m,productList:f,selectProduct:h,insurerCodeList:g,showCategory:y,productTotal:k,showFooter:P}=S(d);le();const[b,V]=le(),I=o(1),U=()=>{const{excludeProductCodeList:e}=d;d.firstLoading&&ce.loading("加载中..."),Ce({title:i.value,insurerCodeList:g.value,productClass:I.value,showCategory:y.value,selectProductCodes:Array.isArray(e)?e:[],selectRiskCodes:d.excludeMainRiskCode||[],pageNum:1,pageSize:999}).then((e=>{const{code:a,data:o,total:t}=e;"10000"===a&&(f.value=o,k.value=t)})).finally((()=>{ce.clear(),d.firstLoading=!1}))},q=e=>{U()},F=e=>{const{selectInsureCode:a,selectCategory:o}=e;g.value=a,y.value=o,U()},A=()=>{m.value&&(f.value=[],m.value=!1),U(),p.value=!1,k.value===f.value.length&&(v.value=!0)},K=()=>{t.push({path:"historyProposalList"})};C((()=>{var e;const{birthday:o,gender:t}=(null==(e=a.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:o,gender:t}}));const X=C((()=>f.value.length>0)),D=({productCode:e})=>l?(d.productCode=e,d.selectProduct.includes(e)?(d.selectProduct=d.selectProduct.filter((a=>a!==e)),!1):void(async(e,o)=>{const{code:t,data:s,message:l}=await Pe({...a.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===t?(d.errorMsgMap[e]="","function"==typeof o&&o(!0)):d.errorMsgMap[e]=l})(e,(()=>{d.selectProduct.push(e)}))):(t.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),H=e=>{d.selectProduct=e,d.selectedProductList=d.selectedProductList.filter((a=>e.includes(a.productCode)))},J=()=>{const e=d.proposalList.filter((e=>d.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));a.setTrialData(e),a.setSelectedProduct(d.selectProduct),a.setSelectedProductList(d.selectedProductList),t.back()},W=()=>{v.value=!0,p.value=!0,A()};return T((()=>{d.excludeProductCodeList=a.$state.excludeProduct,d.excludeMainRiskCode=a.$state.excludeMainRiskCode})),(e,a)=>{const o=Se,t=we,s=$e,n=Z,u=ue,h=ne,g=G,C=re("ProPageWrap"),y=ie;return L(),R(y,{"theme-vars":_(r)},{default:z((()=>[c(C,{class:"page-proposal"},{default:z((()=>[c(s,{modelValue:_(i),"onUpdate:modelValue":a[1]||(a[1]=e=>w(i)?i.value=e:null),placeholder:"请输入计划书名称",onSearch:q},{default:z((()=>[c(Ye,{"filter-class":"filter-area",onOnSelectInsure:F}),c(t,{modelValue:_(I),"onUpdate:modelValue":a[0]||(a[0]=e=>w(I)?I.value=e:null),"active-color":"var(--van-primary-color)","inactive-color":"black",fixed:!1,onChange:U},{default:z((()=>[c(o,{name:1},{default:z((()=>[E("非组合计划书")])),_:1}),c(o,{name:4},{default:z((()=>[E("组合计划书")])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"]),_(X)||_(d).firstLoading?N("",!0):(L(),R(ve,{key:0,"empty-img":_(me),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),M("div",da,[c(h,{modelValue:_(m),"onUpdate:modelValue":a[3]||(a[3]=e=>w(m)?m.value=e:null),onRefresh:W},{default:z((()=>[c(u,{loading:_(p),"onUpdate:loading":a[2]||(a[2]=e=>w(p)?p.value=e:null),finished:_(v),"finished-text":_(X)?"- 已经到底了哦 -":"",onLoad:A},{default:z((()=>[(L(!0),x(B,null,O(_(f),(e=>(L(),R(Ne,{key:e.id,"product-info":e,"error-msg":_(d).errorMsgMap[e.productCode],onClick:a=>D(e)},de({_:2},[_(l)?{name:"checkedProduct",fn:z((()=>[M("div",ca,[(L(),R(n,{key:e.id,name:e.productCode,"model-value":_(d).selectProduct.includes(e.productCode),shape:"square",onChange:a=>((e,a)=>{e?d.selectedProductList.push(a):d.selectedProductList=d.selectedProductList.filter((e=>e.productCode!==a.productCode))})(a,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),_(l)&&_(P)?(L(),x("div",ia,[M("div",na,[M("p",{class:"has-select",onClick:a[4]||(a[4]=e=>_(V)(!_(b)))},[E(" 已选"),M("span",ua,$(_(d).selectProduct.length),1),E("款产品 "),pa]),c(g,{type:"primary",disabled:!_(d).selectProduct.length,onClick:J},{default:z((()=>[E("添加到计划书")])),_:1},8,["disabled"])])])):N("",!0),c(ra,{"modal-value":_(d).selectProduct,"proposal-list":_(d).selectedProductList,"is-show":_(b),onClose:a[5]||(a[5]=e=>_(V)(!1)),onChecked:H},null,8,["modal-value","proposal-list","is-show"])])),_:1}),_(l)?N("",!0):(L(),R(ye,{key:0,"button-image":_("/static/png/lishijihuashu-b6958e78.png"),onClick:K},null,8,["button-image"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-40eee3f9"]]);export{ma as default};
