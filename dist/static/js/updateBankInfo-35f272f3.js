import{_ as e,d as a,i as t,h as s,j as o,aR as n,l as r,o as d,c as i,u as l,p as u,q as c,f as p,a as m,b as f,w as v,v as I,aP as y,aZ as h,aC as g,d1 as P,aQ as j,bP as _,aI as b,cD as w,cE as C,cF as x}from"./index-6a9cf46c.js";import{P as N}from"./PolicyInfo-6c553e35.js";import{u as k}from"./useOrder-d313309a.js";import{p as A}from"./utils-91ecdfd9.js";import{g as B,m as E}from"./trial-41b6fd53.js";import{n as L}from"./nextStep-5fc4dcce.js";import"./utils-e3b5b413.js";import"./createProposal-e1f6da83.js";import"./trial-d6373768.js";import"./utils-64e52959.js";import"./infoCollection-974452d5.js";import"./core-90944064.js";const O={class:"bank-info-wrap"},$={class:"footer-button"},D=a({name:"updateBankInfo"});var T=e(a({...D,setup(e){const a=t(),D=s(),{orderNo:T,isShare:U,tenantId:G,nextPageCode:S}=a.query,q=k(),F=o({schema:[],config:[],formData:[]}),R=o(!!U),V=o(),z=o(),M=()=>{D.back()},J=()=>{V.value&&V.value.validate(!1).then((e=>{e&&(q.value.tenantOrderPayInfoList=z,U?(q.value.extInfo.buttonCode=y.UPDATE_BANK_INFO_HOLDER,L(q.value,((e,t)=>{t===h.JUMP_PAGE&&g(e.nextPageCode,a.query)}),a)):(q.value.extInfo.buttonCode=y.UPDATE_BANK_INFO_AGENT,L(q.value,((e,a)=>{a===h.JUMP_PAGE&&((e,a)=>{const{holder:t,insuredList:s}=q.value;let o={name:t.name,gender:`${w[t.gender]}士`};"insured"===e&&(o={name:null==s?void 0:s[0].name,gender:`${w[null==s?void 0:s[0].gender]}士`}),C({shareType:0,title:`${x[a].title}`,desc:x[a].desc.replace("{name}",`${o.name}${o.gender},`),url:`${window.location.href}&objectType=${e}&isShare=1&nextPageCode=updateBankInfo`.replace("/updateBankInfo","/phoneVerify"),imageUrl:"https://aquarius-v100-test.oss-cn-hangzhou.aliyuncs.com/MyPicture/asdad.png"})})("holder","pay")}),a)))}))};n((()=>{(async()=>{let e={};P({orderNo:T,tenantId:G}).then((({code:e,data:a})=>{"10000"===e&&(z.value=a.tenantOrderPayInfoList)}));const{code:a,data:t}=await B({orderNo:T,tenantId:G});"10000"===a&&(Object.assign(q.value,t,{extInfo:{...t.extInfo,buttonCode:y.SIGN,pageCode:j.SIGN}}),e=A(t.insuredList[0].productList)),E(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:t}=e,{payInfo:s}=_(t);F.value={...F.value,...s}}}))})()}));const K=o();return r((()=>{setTimeout((async()=>{K.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const t=b;return d(),i("div",O,[l(F).schema.length&&l(z)?(d(),u(N,{key:0,ref_key:"payInfoRef",ref:V,modelValue:l(z),"onUpdate:modelValue":a[0]||(a[0]=e=>c(z)?z.value=e:null),schema:l(F).schema,"is-view":l(R),"user-data":l(q)},null,8,["modelValue","schema","is-view","user-data"])):p("",!0),m("div",$,[f(t,{type:"primary",plain:"",onClick:M},{default:v((()=>[I("取消")])),_:1}),f(t,{type:"primary",onClick:J},{default:v((()=>[I("确认")])),_:1})])])}}}),[["__scopeId","data-v-796e2ef0"]]);export{T as default};
