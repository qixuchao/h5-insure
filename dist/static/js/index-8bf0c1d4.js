import{d as e,t as a,j as s,i as n,z as t,ao as i,k as l,a1 as o,ar as u,bd as r,c1 as d,ct as m,o as c,c as p,a as w,u as q,d4 as v,V,q as k,b as y,w as f,l as L,F as g,n as h,a6 as b,aE as _,a8 as R,e as x,_ as O,a2 as j,am as C,m as T,cC as $,g as A,h as D,O as I,T as U}from"./index-a3c15377.js";import{l as E}from"./product-596d65da.js";import{b as F}from"./index-7a6b9f7e.js";import{c as Q}from"./cloneDeep-5d541e55.js";import"./keysIn-131bbce9.js";import"./isObjectLike-a9798079.js";import"./_getTag-0507d0b1.js";import"./debounce-6981b306.js";import"./ProRenderFormWithCard.vue_vue_type_style_index_0_scoped_true_lang-42bf787b.js";import"./phoneVerify-0c603305.js";import"./merge-e7788e50.js";/* empty css              */import"./index-e90e719d.js";import"./useDicData-0f8b6ef2.js";const S={class:"com-question"},N={class:"question-item"},P={key:0,class:"question-desc"},Y={key:0,class:"question-desc"},z={key:0,class:"child"},B={key:1},M={key:0},W={key:4,class:"question-muti-blank"},G={key:0,class:"literal"},H=e({name:"Question"});var J=O(e({...H,props:{index:null,data:null,isView:{type:Boolean},name:null,modelValue:null},emits:["update:modelValue"],setup(e,{expose:O,emit:j}){const C=e,T=1,$=2,A=3,D=4,I=5,{index:U,data:E,parentAnswer:F}=a(C),Q=s((()=>void 0===C.index?C.data.title:`问题${C.index+1}. ${C.data.title}`)),H=s((()=>{if(v(E.value.questionType,I)){let e=-1;return E.value.optionList[0].value.replaceAll("_____","∝$blank∝").split("∝").map((a=>("$blank"===a&&(e+=1),{type:"$blank"===a?"variable":"literal",value:"$blank"===a?"":a,index:e})))}return[]})),J=n(C.modelValue),K=n();t((()=>C.modelValue),(e=>{J.value=e}),{deep:!0}),t((()=>J.value),(e=>{console.log(E.value.id,"变动了:",e),j("update:modelValue",e)}),{deep:!0,immediate:!0});const X=()=>{const e=[];return K.value&&K.value.length?K.value.forEach((a=>{console.log("child:",a.getData()),e.push(a.getData())})):[]};return O({getData:()=>({...J.value,childAnswerList:X()})}),(a,s)=>{const n=i,t=l("Question",!0),O=o,j=u,U=r,F=d,X=m("dompurify-html");return c(),p("div",S,[w("div",N,[q(E).questionDesc&&q(v)(q(E).questionDescPosition,1)?V((c(),p("div",P,null,512)),[[X,q(E).questionDesc]]):k("",!0),y(_,{title:q(Q)},{default:f((()=>[q(E).questionDesc&&q(v)(q(E).questionDescPosition,2)?V((c(),p("div",Y,null,512)),[[X,q(E).questionDesc]]):k("",!0),q(v)(q(E).questionType,T)||q(v)(q(E).questionType,A)?(c(),L(O,{key:1,name:`${C.name}.answer`,rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请选择"}]},{input:f((()=>[y(j,{modelValue:J.value.answer,"onUpdate:modelValue":s[1]||(s[1]=e=>J.value.answer=e)},{default:f((()=>[(c(!0),p(g,null,h(q(E).optionList,((a,i)=>(c(),p("div",{key:i,class:"option-row"},[y(n,{name:a.code},{default:f((()=>[R(x(a.value),1)])),_:2},1032,["name"]),q(v)(J.value.answer,a.code)?(c(),p("div",z,[(c(!0),p(g,null,h(a.detailList,((a,s)=>(c(),L(t,{key:a.id,ref_for:!0,ref_key:"childRef",ref:K,modelValue:J.value.childAnswerList[s].answerVO,"onUpdate:modelValue":e=>J.value.childAnswerList[s].answerVO=e,name:`${C.name}.childAnswerlist.${s}.answerVO`,data:a,"is-view":e.isView},null,8,["modelValue","onUpdate:modelValue","name","data","is-view"])))),128))])):k("",!0),q(v)(a.optionType,2)&&q(v)(J.value.answer,a.code)?(c(),p("div",B,[y(O,{modelValue:J.value.questionRemark,"onUpdate:modelValue":s[0]||(s[0]=e=>J.value.questionRemark=e),name:`${C.name}.questionRemark`,rows:"2",autosize:"",label:"",type:"textarea",maxlength:"100",placeholder:"请输入告知说明","show-word-limit":""},null,8,["modelValue","name"])])):k("",!0)])))),128))])),_:1},8,["modelValue"])])),_:1},8,["name","rules"])):k("",!0),q(E).questionType===$?(c(),L(O,{key:2,name:`${C.name}.answerList`,label:"",rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请选择"}]},{input:f((()=>[y(F,{modelValue:J.value.answerList,"onUpdate:modelValue":s[2]||(s[2]=e=>J.value.answerList=e)},{default:f((()=>[(c(!0),p(g,null,h(q(E).optionList,((e,a)=>{var s;return c(),p("div",{key:a,class:"option-row"},[y(U,{name:a,shape:"square"},{default:f((()=>[R(x(e.value),1)])),_:2},1032,["name"]),q(v)(e.optionType,2)&&(null==(s=J.value.answerList)?void 0:s.includes(e.code))?(c(),p("div",M,[y(O,{modelValue:J.value.questionRemarkList[a],"onUpdate:modelValue":e=>J.value.questionRemarkList[a]=e,rows:"2",autosize:"",label:"",type:"textarea",maxlength:"100",placeholder:"请输入","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])])):k("",!0)])})),128))])),_:1},8,["modelValue"])])),_:1},8,["name","rules"])):k("",!0),q(E).questionType===D?(c(),L(O,{key:3,modelValue:J.value.answer,"onUpdate:modelValue":s[3]||(s[3]=e=>J.value.answer=e),name:`${C.name}.answer`,placeholder:"请输入",maxlength:"100",rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请输入"}]},null,8,["modelValue","name","rules"])):k("",!0),q(E).questionType===I?(c(),p("div",W,[(c(!0),p(g,null,h(q(H),((e,a)=>(c(),p(g,{key:a},["literal"===e.type?(c(),p("span",G,x(e.value),1)):(c(),L(O,{key:1,modelValue:J.value.answerList[e.index],"onUpdate:modelValue":a=>J.value.answerList[e.index]=a,class:"custom-cell",name:`${C.name}.answerList.${e.index}`,placeholder:"请输入",maxlength:"100",rules:[{required:q(v)(q(E).mustFlag,q(b).YES),message:"请输入"}]},null,8,["modelValue","onUpdate:modelValue","name","rules"]))],64)))),128))])):k("",!0)])),_:1},8,["title"])])])}}}),[["__scopeId","data-v-4296a4f6"]]);const K={class:"que-title"},X=e({name:"Questionnaire"}),Z=e({...X,props:{data:null,isView:{type:Boolean},params:null},setup(e){const a=e,s=n([{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""}]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""},{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[{answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""}]},id:"",questionCode:""},{answerVO:{answer:"这里是单项填空的结果",answerList:[],questionRemark:"",questionRemarkList:[],childAnswerList:[]},id:"",questionCode:""}]),t=n([]),i=n(),l=()=>{const e={answerList:[],objectType:a.data.basicInfo.objectType||1,contentType:a.data.basicInfo.questionnaireType,questionnaireId:a.data.basicInfo.id,...a.params,imageList:t.value};var n;i.value.forEach(((s,n)=>{e.answerList.push({answerVO:s.getData(),id:a.data.questions[n].id,questionCode:a.data.questions[n].questionCode})})),console.log("请求参数：",s),(n=e,j({url:"/api/app/insure/insurance/saveMarketerNotices",method:"POST",data:n})).then((e=>{}))},u=n(),r=e=>{console.log("values:",e),l()};return(n,l)=>{const d=$,m=o,v=C;return c(),p(g,null,[w("div",K,x(a.data.basicInfo.questionnaireName),1),y(F,{ref_key:"formRef",ref:u,model:q(s),"input-align":"left","scroll-to-error":"","show-error-message":"",onSubmit:r},{default:f((()=>[1===a.data.basicInfo.questionnaireType?(c(),p(g,{key:0},[R("文本问卷")],64)):(c(!0),p(g,{key:1},h(a.data.questions,((a,n)=>(c(),L(J,{ref_for:!0,ref_key:"questionsRef",ref:i,key:a.id,modelValue:q(s)[n].answerVO,"onUpdate:modelValue":e=>q(s)[n].answerVO=e,name:`${n}.answerVO`,data:a,index:n,"is-view":e.isView},null,8,["modelValue","onUpdate:modelValue","name","data","index","is-view"])))),128)),y(_,{title:a.data.imageConfig.name},{default:f((()=>[y(m,{name:"imageList"},{input:f((()=>{var e;return[y(d,{modelValue:q(t),"onUpdate:modelValue":l[0]||(l[0]=e=>T(t)?t.value=e:null),"max-count":(null==(e=a.data.imageConfig)?void 0:e.maxNum)||10},null,8,["modelValue","max-count"])]})),_:1})])),_:1},8,["title"]),y(v,{round:"",type:"primary",block:"","native-type":"submit"},{default:f((()=>[R(" 提交 ")])),_:1})])),_:1},8,["model"])],64)}}}),ee=e({name:"QuestionPreview"}),ae=e({...ee,setup(e){A();const a=D(),{questionnaireId:s,id:t}=a.query,i={objectId:123,noticeType:1,orderNo:"2023083017475048217",tenantId:9991000011},l=n({basicInfo:{questionnaireName:""},questions:[],imageConfig:{showFlag:2,name:"",maxCount:1}});return I((()=>{U.loading("加载中..."),E({questionnaireId:s||t}).then((e=>{var a;const{code:s,data:n}=e;"10000"===s&&n.productQuestionnaireVOList.length>0?(l.value=(e=>{var a;const s=Q(e);return s.questions=e.questions.map((e=>({...e,answerVO:{answer:"",answerList:[],questionRemark:"",questionRemarkList:[]}}))),null!=(a=s.imageConfig).images||(a.images=[]),s})(null==(a=n.productQuestionnaireVOList)?void 0:a[0].questionnaireDetailResponseVO),document.title=l.value.basicInfo.title):U.error("获取问卷出错")})).finally((()=>{U.clear()}))})),(e,a)=>(c(),L(Z,{data:q(l),"is-view":"",params:i},null,8,["data"]))}});export{ae as default};
