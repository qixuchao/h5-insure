import{d as e,af as o,ag as a,i as t,h as s,r as n,j as i,aG as r,l,o as c,c as d,b as u,u as f,p,q as m,f as y,w as I,F as v,s as h,a as w,g as b,v as j,dF as g,bH as k,ak as C,bK as V,aS as q,aQ as x,T as P,c6 as _}from"./index-c51609f0.js";import{P as L,a as T}from"./PolicyInfo-febde2ed.js";import{g as O,m as E}from"./trial-65451a5d.js";import{n as R}from"./nextStep-cbd132c3.js";import{b as N,l as U}from"./product-ac4fb295.js";import{u as D}from"./useOrder-ce8543e9.js";import{P as Q}from"./index-7abb83a2.js";import{P as F}from"./index-0b2f1235.js";import{_ as M}from"./InsureInfo-701c8da6.js";import{p as S,d as $}from"./utils-6aca78ad.js";import{Q as A}from"./notice-33e6eedd.js";import{g as B}from"./utils-84030229.js";import{Q as G}from"./questionnaire-42dcb602.js";import{P as J}from"./constants-b39aa53b.js";import{T as z}from"./infoCollection-d6b918a5.js";import"./core-7fad25dc.js";import"./cloneDeep-4739f4a5.js";import"./util-aa40439c.js";import"./trial-c4d1a79a.js";const H={class:"long-info-preview"},K={class:"footer-button"},X=e({__name:"infoPreview",setup(e){const X=o((()=>a((()=>import("./index-06db35a1.js")),["static/js/index-06db35a1.js","static/css/index-fa4edf2a.css","static/js/index-c51609f0.js","static/css/index-839a5189.css","static/js/theme-94cf7d00.js","static/js/index-0b2f1235.js","static/css/index-bbfdd7ec.css","static/js/utils-84030229.js","static/js/infoCollection-d6b918a5.js","static/js/trial-c4d1a79a.js"]))),W=t(),Y=s(),Z=D(),{productCode:ee="",tenantId:oe,agentCode:ae="",agencyCode:te,saleChannelId:se,isShare:ne,orderNo:ie,extraInfo:re,insurerCode:le,objectType:ce="1",templateId:de,preview:ue,origin:fe}=W.query;let pe={};try{pe=JSON.parse(decodeURIComponent(re))}catch(_e){}const me=n({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),ye=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`;i({imgUrl:"",desc:"",title:"",link:ye});const Ie=i(),ve=i(),he=i(!1),we=i(0),be=i(!1),je=()=>{he.value=!1};i();const ge=()=>{de===z.FREE&&(Z.value.extInfo.buttonCode=g.faceVerify,Z.value.extInfo.pageCode="infoPreview",R(Z.value,((e,o)=>{o===x.JUMP_PAGE&&Y.push({path:J[e.nextPageCode],query:W.query})})))},ke=async()=>{de===z.FREE&&(Z.value.extInfo.buttonCode=g.free.faceVerify,Z.value.extInfo.pageCode="productInfo",R(Z.value,((e,o)=>{o===x.JUMP_PAGE&&P("认证成功")})))},Ce=i(),Ve=i(),qe=i([]),xe=async()=>{let e={};const{code:o,data:a}=await O({orderNo:ie,tenantId:oe});"10000"===o&&(Object.assign(Z.value,a),e=S(a.insuredList[0].productList),Ce.value=a,be.value=!0),(async e=>{let o=[];const{code:a,data:t}=await _({orderNo:ie,tenantId:oe});"10000"===a&&(o=t.productQuestionnaireVOList);const{code:s,data:n}=await U(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},a=e.filter((e=>e.businessType!==A.VISIT));me.customerQuestions=a.map((e=>{const{questionnaireDetailResponseVO:a,questionnaireId:t,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=a||{},{objectType:r,questionnaireType:l}=i||{};if(l===G.TEXT){const{content:e,textType:o}=(null==n?void 0:n[0])||{};return{content:e,contentType:B(`${o}`,e),questionnaireId:t,questionnaireName:s}}const c=(o||[]).find((e=>e.questionnaireId===t));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:t,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),N(e).then((({code:e,data:o})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:a}=$(o);qe.value=e.concat(a)}})),E(e).then((({data:e,code:o})=>{if("10000"===o){const{productDetailResList:o,productFactor:a}=e;Ve.value=a;const{payInfo:t,other:s}=k(a);me.payInfo={...me.payInfo,...t},me.policyInfo={...me.policyInfo,...s}}}))};r((()=>{xe()}));const Pe=i();return l((()=>{setTimeout((async()=>{Pe.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,o)=>{var a,t,s;const n=C,i=V,r=q;return c(),d("div",H,[u(n),u(M,{"product-data":null==(t=null==(a=f(Z).insuredList)?void 0:a[0])?void 0:t.productList},null,8,["product-data"]),(null==(s=Object.keys(f(Ve)||{}))?void 0:s.length)?(c(),p(Q,{key:0,ref_key:"personalInfoRef",ref:ve,modelValue:f(Ce),"onUpdate:modelValue":o[0]||(o[0]=e=>m(Ce)?Ce.value=e:null),"product-factor":f(Ve),"is-view":"","input-align":"left"},null,8,["modelValue","product-factor"])):y("",!0),f(me).payInfo.schema.length?(c(),p(f(L),{key:1,ref_key:"payInfoRef",ref:Ie,modelValue:f(Z).tenantOrderPayInfoList,"onUpdate:modelValue":o[1]||(o[1]=e=>f(Z).tenantOrderPayInfoList=e),schema:f(me).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),f(me).policyInfo.schema.length?(c(),p(f(T),{key:2,modelValue:f(Z).extInfo,"onUpdate:modelValue":o[2]||(o[2]=e=>f(Z).extInfo=e),schema:f(me).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),u(r,{title:"产品资料","show-line":!1,"show-icon":!1},{default:I((()=>[(c(!0),d(v,null,h(f(qe),((e,o)=>(c(),p(i,{key:o,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{we.value=e,he.value=!0})(o)},null,8,["title","onClick"])))),128))])),_:1}),w("div",K,["confirm"===f(fe)?(c(),p(F,{key:0,shadow:!1,onClick:ke},{default:I((()=>[b(e.$slots,"default",{},(()=>[j("确认")]))])),_:3})):(c(),p(F,{key:1,shadow:!1,onClick:ge},{default:I((()=>[b(e.$slots,"default",{},(()=>[j("领取保障并激活")]))])),_:3}))]),f(he)?(c(),p(f(X),{key:3,show:f(he),"onUpdate:show":o[3]||(o[3]=e=>m(he)?he.value=e:null),"content-list":[f(qe)[f(we)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:je},null,8,["show","content-list"])):y("",!0)])}}});export{X as default};
