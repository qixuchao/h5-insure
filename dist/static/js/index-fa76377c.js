import{aw as e,d as s,r as a,b_ as t,ap as o,bu as l,L as r,bv as c,e as d,aC as i,aE as u,bt as n,aI as p,V as v,b$ as m,aL as h,a6 as g,al as f,b as C,c as y,i as P,f as k,Q as L,M as b,N as w,ao as _,a2 as x,G as S,a5 as I,X as V,c0 as T,o as j,ac as M,h as $,g as D,w as U,c1 as N,Z as O,j as q,aZ as H,aP as B,B as F,bE as A,aj as E,ak as z,bM as Q,aT as Y,bO as Z,bA as G,bN as R,a as W,u as X,bQ as J,a9 as K,bz as ee,am as se,aU as ae,T as te}from"./index-779cecf9.js";import{L as oe}from"./index-3a318d89.js";import{S as le}from"./index-d4dfa395.js";import{P as re}from"./index-587a07dd.js";import{_ as ce}from"./empty-ae586b6c.js";import{P as de,u as ie}from"./ProductTips-099e7e6e.js";import{q as ue,a as ne}from"./proposalList-032c4f08.js";import{P as pe}from"./index-b9c3775d.js";import{c as ve}from"./trial-27028c91.js";import"./pdfh5-008ca364.js";const[me,he,ge]=e("pull-refresh"),fe=["pulling","loosing","success"];const Ce=h(s({name:me,props:{disabled:Boolean,modelValue:Boolean,headHeight:i(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:u,successDuration:i(500),animationDuration:i(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:s,slots:i}){let u;const h=a(),g=a(),f=t(h),C=o({status:"normal",distance:0,duration:0}),y=l(),P=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},k=()=>"loading"!==C.status&&"success"!==C.status&&!e.disabled,L=(a,t)=>{const o=+(e.pullDistance||e.headHeight);C.distance=a,C.status=t?"loading":0===a?"normal":a<o?"pulling":"loosing",s("change",{status:C.status,distance:a})},b=()=>{const{status:s}=C;return"normal"===s?"":e[`${s}Text`]||ge(s)},w=()=>{const{status:e,distance:s}=C;if(i[e])return i[e]({distance:s});const a=[];return fe.includes(e)&&a.push(d("div",{class:he("text")},[b()])),"loading"===e&&a.push(d(n,{class:he("loading")},{default:b})),a},_=e=>{u=0===m(f.value),u&&(C.duration=0,y.start(e))},x=e=>{k()&&_(e)},S=()=>{u&&y.deltaY.value&&k()&&(C.duration=+e.animationDuration,"loosing"===C.status?(L(+e.headHeight,!0),s("update:modelValue",!0),v((()=>s("refresh")))):L(0))};return r((()=>e.modelValue),(s=>{C.duration=+e.animationDuration,s?L(+e.headHeight,!0):i.success||e.successText?(C.status="success",setTimeout((()=>{L(0)}),+e.successDuration)):L(0,!1)})),c("touchmove",(s=>{if(k()){u||_(s);const{deltaY:a}=y;y.move(s),u&&a.value>=0&&y.isVertical()&&(p(s),L((s=>{const a=+(e.pullDistance||e.headHeight);return s>a&&(s=s<2*a?a+(s-a)/2:1.5*a+(s-2*a)/4),Math.round(s)})(a.value)))}}),{target:g}),()=>{var e;const s={transitionDuration:`${C.duration}ms`,transform:C.distance?`translate3d(0,${C.distance}px, 0)`:""};return d("div",{ref:h,class:he()},[d("div",{ref:g,class:he("track"),style:s,onTouchstartPassive:x,onTouchend:S,onTouchcancel:S},[d("div",{class:he("head"),style:P()},[w()]),null==(e=i.default)?void 0:e.call(i)])])}}}));const ye={class:"com-product-item"},Pe={class:"content-wrap"},ke={class:"product-image"},Le={class:"insure-name"},be={class:"product-info"},we={class:"title"},_e={class:"description"},xe={class:"tags"};var Se=g(s({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const s=e,{productInfo:a}=f(s),t=o({checked:!1});return f(t),(s,t)=>{var o,l,r,c,i;const u=x;return C(),y("div",ye,[P("div",Pe,[P("div",ke,[d(u,{src:(null==(o=k(a).showConfig)?void 0:o.fileThumbnailUrl)||(null==(l=k(a).showConfig)?void 0:l.fileUrl)},null,8,["src"]),P("p",Le,L((k(a).insurerName||"").substring(0,6)),1)]),P("div",be,[P("p",we,L(null==(r=k(a).showConfig)?void 0:r.title),1),P("p",_e,L(null==(c=k(a).showConfig)?void 0:c.text),1),P("p",xe,[(C(!0),y(b,null,w(null==(i=k(a).showConfig)?void 0:i.tags,((e,s)=>(C(),y("span",{key:s,class:"tag"},L(e),1)))),128))])]),_(s.$slots,"checkedProduct",{},void 0,!0)]),d(de,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-1346a7e2"]]);const Ie=["xlink:href"],Ve=s({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const s=e,a=S((()=>`#icon-${s.name}`)),t=S((()=>s.name?`svg-icon icon-${s.name}`:"svg-icon"));return(s,o)=>(C(),y("svg",I({class:k(t)},s.$attrs,{style:{color:e.color}}),[P("use",{"xlink:href":k(a)},null,8,Ie)],16))}});const Te=e=>(E("data-v-1d4256ac"),e=e(),z(),e),je={class:"com-tab-filter"},Me={class:"article-mid"},$e={class:"article-tag"},De=["onClick"],Ue=Te((()=>P("span",null,null,-1))),Ne={class:"popup-inner"},Oe=Te((()=>P("div",{class:"popup-title"},"保险公司",-1))),qe={class:"footer-button"};var He=g(s({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:s}){const{isPopShow:t,openPop:l,closePop:r}=function(e=!1){const s=a(e);return{isPopShow:s,openPop:e=>{e instanceof Function&&e(),s.value=!0},closePop:e=>{s.value=!1,e instanceof Function&&e()}}}(!1),c=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:u}=f(c),n=a(""),p=()=>{u.value=[]},v=()=>{var e;const{productCategoryId:a}=(null==(e=c.productCategoryList)?void 0:e[n.value])||{};s("onSelectInsure",{selectInsureCode:u.value,selectCategory:a}),r()};V((()=>{T().then((e=>{const{code:s,data:a}=e;"10000"===s&&(i.value=null==a?void 0:a.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),j((()=>{ue().then((e=>{const{code:s,data:a}=e||{};"10000"===s&&B(a)&&(c.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...a])}))}));const m=a();return V((()=>{m.value=document.querySelector(".page-proposal")})),(a,o)=>{const h=F,g=A;return C(),y("div",je,[P("div",Me,[P("div",$e,[(C(!0),y(b,null,w(k(c).productCategoryList,((e,a)=>(C(),y("div",{key:a,class:M(["tag-item",{checked:k(n)==a}]),onClick:t=>((e,a)=>{var t;n.value=a;const{productCategoryId:o}=(null==(t=c.productCategoryList)?void 0:t[n.value])||{};s("onSelectInsure",{selectInsureCode:u.value,selectCategory:o})})(null==e||e.productCategoryId,a)},[P("div",{class:M(["tag-out",{checked:k(n)==a}])},[P("div",{class:M(["tag-item-text",{checked:k(n)==a}])},L(e.productCategoryName),3)],2)],10,De)))),128))]),e.filter?(C(),y("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>k(l)&&k(l)(...e))},[Ue,P("div",{class:M(["text",{"has-select-condition":k(u).length>0}])},"筛选",2),d(Ve,{name:"filter"})])):$("",!0),k(m)?(C(),D(g,{key:1,show:k(t),position:"right","close-on-click-overlay":"",class:"proposal-list-filter-popup-wrap",style:H(e.popupStyle),onClickOverlay:k(r)},{default:U((()=>[P("div",Ne,[Oe,d(N,{modelValue:k(u),"onUpdate:modelValue":o[1]||(o[1]=e=>O(u)?u.value=e:null),options:k(i)},null,8,["modelValue","options"])]),P("div",qe,[d(h,{plain:"",type:"primary",onClick:p},{default:U((()=>[q("重置")])),_:1}),d(h,{type:"primary",onClick:v},{default:U((()=>[q("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])):$("",!0)])])}}}),[["__scopeId","data-v-1d4256ac"]]);const Be={class:"com-trial-product-wrapper"},Fe={class:"container"},Ae=(e=>(E("data-v-49f70a68"),e=e(),z(),e))((()=>P("span",{class:"title"}," 已选产品 ",-1))),Ee={class:"popup-body"},ze={class:"cell-title"},Qe={class:"title"},Ye=s({name:"TrialProductPopup"});var Ze=g(s({...Ye,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:s}){const t=e,o=a([]),l=a([]),c=a({isShow:t.isShow}),i=()=>{s("close")},u=()=>{l.value=[],s("checked",[])},n=e=>{var a,t,r;null==(r=null==(t=null==(a=null==o?void 0:o.value)?void 0:a[e])?void 0:t.toggle)||r.call(t),s("checked",l.value)};return r((()=>t.isShow),(e=>{c.value.isShow=e})),r(l,((e=[])=>{s("update:modalValue",e)}),{deep:!0,immediate:!0}),r((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(s,a)=>{const t=Q,r=Y,p=R,v=Z,m=A;return C(),y("div",Be,[d(m,{show:k(c).isShow,"onUpdate:show":a[1]||(a[1]=e=>k(c).isShow=e),position:"bottom",onClose:i},{default:U((()=>[P("div",Fe,[P("div",{class:"popup-header"},[P("span",{class:"clear-all",onClick:u}," 清空选项 "),Ae,P("span",{class:"close",onClick:i})]),P("div",Ee,[d(v,{modelValue:k(l),"onUpdate:modelValue":a[0]||(a[0]=e=>O(l)?l.value=e:null)},{default:U((()=>[d(p,{inset:""},{default:U((()=>[(C(!0),y(b,null,w(e.proposalList,(e=>(C(),D(r,{key:e.productCode,title:e.productName,onClick:s=>n(e.productCode)},{"right-icon":U((()=>{var s;return[d(t,{ref_for:!0,ref:s=>k(o)[e.productCode]=s,shape:"square","model-value":null==(s=k(l))?void 0:s.includes(e.productCode),name:e.productCode,onClick:G((s=>n(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:U((()=>[P("div",ze,[P("div",Qe,L(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const Ge={class:"search-wrap"},Re={class:"page-proposal-list"},We={class:"check-button"},Xe={key:1,class:"van-sticky"},Je={class:"add-plan"},Ke={class:"has-select-product"},es=(e=>(E("data-v-2f4c28b6"),e=e(),z(),e))((()=>P("span",{class:"icon"},null,-1))),ss=s({name:"ProposalList"});var as=g(s({...ss,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const s=ie(),a=W(),t=X(),{isCreateProposal:l}=t.query,r=J(),c=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],firstLoading:!0}),{searchValue:i,tagLists:u,isOpen:n,loading:p,finished:v,refreshing:m,productList:h,selectProduct:g,insurerCodeList:_,showCategory:x,productTotal:I,showFooter:V}=f(c);K();const[T,M]=K(),N=()=>{const{excludeProductCodeList:e}=c;c.firstLoading&&te.loading("加载中..."),ne({title:i.value,insurerCodeList:_.value,showCategory:x.value,excludeProductCodeList:Array.isArray(e)?e:[],pageNum:1,pageSize:999}).then((e=>{const{code:s,data:a,total:t}=e;"10000"===s&&(h.value=null==a?void 0:a.datas,I.value=t)})).finally((()=>{te.clear(),c.firstLoading=!1}))},H=e=>{N()},B=e=>{const{selectInsureCode:s,selectCategory:a}=e;_.value=s,x.value=a,N()},A=()=>{m.value&&(h.value=[],m.value=!1),N(),p.value=!1,I.value===h.value.length&&(v.value=!0)},E=()=>{a.push({path:"historyProposalList"})};S((()=>{var e;const{birthday:a,gender:t}=(null==(e=s.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:a,gender:t}}));const z=S((()=>h.value.length>0)),Y=({productCode:e})=>l?(c.productCode=e,c.selectProduct.includes(e)?(c.selectProduct=c.selectProduct.filter((s=>s!==e)),!1):void(async(e,a)=>{const{code:t,data:o,message:l}=await ve({...s.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===t?(c.errorMsgMap[e]="","function"==typeof a&&a(!0)):c.errorMsgMap[e]=l})(e,(()=>{c.selectProduct.push(e)}))):(a.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),Z=e=>{c.selectProduct=e,c.selectedProductList=c.selectedProductList.filter((s=>e.includes(s.productCode)))},G=()=>{const e=c.proposalList.filter((e=>c.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));s.setTrialData(e),s.setSelectedProduct(c.selectProduct),a.back()},R=()=>{v.value=!0,p.value=!0,A()};return j((()=>{c.excludeProductCodeList=s.$state.excludeProduct})),(e,s)=>{const a=le,t=Q,o=oe,u=Ce,g=F,f=ee("ProPageWrap"),_=ae;return C(),D(_,{"theme-vars":k(r)},{default:U((()=>[d(f,{class:"page-proposal"},{default:U((()=>[P("div",Ge,[d(a,{modelValue:k(i),"onUpdate:modelValue":s[0]||(s[0]=e=>O(i)?i.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:H},null,8,["modelValue"]),d(He,{filter:k(n),"onUpdate:filter":s[1]||(s[1]=e=>O(n)?n.value=e:null),"filter-class":"filter-area",onOnSelectInsure:B},null,8,["filter"])]),k(z)||k(c).firstLoading?$("",!0):(C(),D(re,{key:0,"empty-img":k(ce),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),P("div",Re,[d(u,{modelValue:k(m),"onUpdate:modelValue":s[3]||(s[3]=e=>O(m)?m.value=e:null),onRefresh:R},{default:U((()=>[d(o,{loading:k(p),"onUpdate:loading":s[2]||(s[2]=e=>O(p)?p.value=e:null),finished:k(v),"finished-text":k(z)?"- 已经到底了哦 -":"",onLoad:A},{default:U((()=>[(C(!0),y(b,null,w(k(h),(e=>(C(),D(Se,{key:e.id,"product-info":e,"error-msg":k(c).errorMsgMap[e.productCode],onClick:s=>Y(e)},se({_:2},[k(l)?{name:"checkedProduct",fn:U((()=>[P("div",We,[(C(),D(t,{key:e.id,name:e.productCode,"model-value":k(c).selectProduct.includes(e.productCode),shape:"square",onChange:s=>((e,s)=>{e?c.selectedProductList.push(s):c.selectedProductList=c.selectedProductList.filter((e=>e.productCode!==s.productCode))})(s,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),k(l)&&k(V)?(C(),y("div",Xe,[P("div",Je,[P("p",{class:"has-select",onClick:s[4]||(s[4]=e=>k(M)(!k(T)))},[q(" 已选"),P("span",Ke,L(k(c).selectProduct.length),1),q("款产品 "),es]),d(g,{type:"primary",disabled:!k(c).selectProduct.length,onClick:G},{default:U((()=>[q("添加到计划书")])),_:1},8,["disabled"])])])):$("",!0),d(Ze,{"modal-value":k(c).selectProduct,"proposal-list":k(c).selectedProductList,"is-show":k(T),onClose:s[5]||(s[5]=e=>k(M)(!1)),onChecked:Z},null,8,["modal-value","proposal-list","is-show"])])),_:1}),k(l)?$("",!0):(C(),D(pe,{key:0,"button-image":k("/static/png/lishijihuashu-b6958e78.png"),onClick:E},null,8,["button-image"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-2f4c28b6"]]);export{as as default};
