!function(){var e=document.createElement("style");e.innerHTML='@charset "UTF-8";.digit-container[data-v-93e01d68] .van-cell__value{display:flex;align-items:center;color:#343434;justify-content:flex-end}.digit-container[data-v-93e01d68] .van-switch{width:1.6rem;margin-left:.34667rem}.digit-container .digit-input[data-v-93e01d68]{flex:1;padding-right:.34667rem;border-right:.02667rem solid #f5f5f5}.digit-container .digit-input[data-v-93e01d68] .van-field{padding:0}.digit-container .digit-input[data-v-93e01d68] .van-field .van-cell__value{padding-right:.21333rem}.digit-container .digit-input[data-v-93e01d68] .van-field input{text-align:right}[data-v-93e01d68] .van-cell{font-size:.4rem;padding:.38667rem .4rem;color:var(--van-field-label-color)}[data-v-93e01d68] .van-cell .van-cell__value{color:#343434}[data-v-93e01d68] .active-line .van-cell__title{flex:0 0 auto}[data-v-93e01d68] .van-cell-group--inset{margin:0}[data-v-93e01d68] .van-icon{line-height:inherit}[data-v-93e01d68] .date-pick{flex:2}.add-apply[data-v-93e01d68]{overflow-y:auto;height:calc(100vh - 2rem)}.add-apply .apply-intro[data-v-93e01d68]{flex-wrap:wrap}.add-apply .apply-intro[data-v-93e01d68] .van-cell__title{width:100%}.add-apply .apply-intro[data-v-93e01d68] .van-cell__value.van-field__value{background:#f4f5f7;border-radius:.26667rem;margin-top:.4rem;padding:.32rem}.add-apply .apply-intro[data-v-93e01d68] .van-cell__value.van-field__value .van-field__word-limit{font-size:.4rem;font-weight:400;color:#b8b8b8}.add-apply .upload-container[data-v-93e01d68]{width:10rem;height:5.62667rem;box-shadow:inset -.05333rem -.14667rem .09333rem rgba(255,255,255,.28);backdrop-filter:blur(.02621rem);position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}.add-apply .upload-container .bg-img[data-v-93e01d68]{width:100%;height:100%;position:absolute;z-index:1}.add-apply .upload-container .has-upload-btn[data-v-93e01d68]{position:absolute;z-index:2;right:0px;top:1.2rem}.add-apply .upload-container .has-upload-btn .btn[data-v-93e01d68]{width:2.32rem;height:.70667rem;background:#000000;border-radius:1.33333rem 0px 0px 1.33333rem;opacity:.4;display:flex;align-items:center;justify-content:center}.add-apply .upload-container .has-upload-btn .btn .upload-label[data-v-93e01d68]{font-size:.42667rem;color:#fff;height:.45333rem;line-height:.37333rem;padding-right:.10667rem}.add-apply .upload-container .has-upload-btn .btn .upload-front[data-v-93e01d68]{font-size:.32rem;font-weight:400;color:#fff}.add-apply .upload-container .upload-btn[data-v-93e01d68]{position:absolute;z-index:2}.add-apply .upload-container .upload-btn .btn[data-v-93e01d68]{width:5.6rem;height:1.17333rem;background:#ffffff;border-radius:.58667rem;border:1px solid #ff5342;display:flex;align-items:center;justify-content:center;font-weight:500;color:#ff2b1f}.add-apply .upload-container .upload-btn .btn .upload-label[data-v-93e01d68]{font-size:.53333rem;height:.64rem;line-height:.53333rem}.add-apply .upload-container .upload-btn .btn .upload-front[data-v-93e01d68]{margin-left:.21333rem;font-size:.42667rem}.add-apply .upload-container .upload-btn .upload-title[data-v-93e01d68]{margin-top:.4rem;font-size:.32rem;font-weight:400;color:#ff2b1f;line-height:.44rem;text-align:center}.add-apply .label[data-v-93e01d68]{color:#616161}.add-apply .value[data-v-93e01d68]{color:#343434}.add-apply .line[data-v-93e01d68]{width:.53333rem;height:.53333rem;margin-right:.21333rem;vertical-align:text-top}.add-apply input[data-v-93e01d68]::placeholder{color:#bcbcbc}.add-apply .cell-val[data-v-93e01d68]{color:#bcbcbc;font-size:.4rem}.add-apply .copy[data-v-93e01d68]{width:.48rem;vertical-align:sub}.add-apply .star[data-v-93e01d68]{color:var(--van-primary-color)}.add-apply .f-select[data-v-93e01d68]{display:flex;align-items:center;justify-content:flex-end}.add-apply .f-select .m-box[data-v-93e01d68]{height:.8rem;width:2.10667rem;border-radius:.10667rem;font-size:.4rem;margin-left:.32rem;color:#bcbcbc;border:.02667rem solid #f5f5f5;display:flex;justify-content:center;align-items:center}.add-apply .f-select .m-box .cm-img[data-v-93e01d68]{width:.4rem;height:.4rem}.add-apply .active[data-v-93e01d68]{background:var(--van-button-primary-background-color);color:#fff!important}.footer[data-v-93e01d68]{width:100vw;height:2rem;background:#ffffff;padding:0px .4rem;box-shadow:0 -.02667rem .13333rem #f6f6f6;display:flex;align-items:center;justify-content:center}.footer .btn[data-v-93e01d68]{height:1.17333rem;width:100%;background:linear-gradient(90deg,#f70800 0%,#ff5003 100%);border-radius:.6rem;display:flex;align-items:center;justify-content:center}.footer .btn span[data-v-93e01d68]{font-size:.42667rem;font-weight:600;color:#fff;line-height:.6rem}\n',document.head.appendChild(e),System.register(["./vendor-legacy-f56233fa.js","./index-legacy-9604cbf9.js","./apply-legacy-723655ae.js","./imageSelect-legacy-a18d260b.js","./index-legacy-8fb2127d.js","./select-legacy-7de2a63e.js","./plugin-vue_export-helper-legacy-57eac467.js","./jsbridge-legacy-3f935966.js","./oss-legacy-418aa272.js","./index-legacy-4c8de798.js"],(function(e){"use strict";var a,t,l,i,n,s,o,r,d,c,p,u,m,v,f,g,y,h,b,k,_,w,x,T,S,D,C,I,j,V,F,O,U,z,E,Y;return{setters:[function(e){a=e.d,t=e.g,l=e.C,i=e.a0,n=e.Q,s=e.L,o=e.M,r=e.x,d=e.a4,c=e.m,p=e.y,u=e.z,m=e.n,v=e.j,f=e.G,g=e.F,y=e.a2,h=e.a3,b=e.r,k=e.a5,_=e.k,w=e.E,x=e.J,T=e.I,S=e.h,D=e.s,C=e.B,I=e.T},function(e){j=e.S,V=e.u},function(e){F=e.q,O=e.a},function(e){U=e.i},function(e){z=e._},function(e){E=e.a},function(e){Y=e._},function(){},function(){},function(){}],execute:function(){const N="2022-01-01",L=[{values:((e,t)=>{const l=[],i=e.split("-"),n=t.split("-"),s=new Date;s.setUTCFullYear(i[0],i[1]-1,i[2]);const o=new Date;o.setUTCFullYear(n[0],n[1]-1,n[2]);const r=s.getTime(),d=o.getTime();for(let c=r;c<=d;)l.push(`${a(c).format("YYYY年MM月DD日")} 周${["日","一","二","三","四","五","六"][+a(c).format("d")]}`),c+=864e5;return l})(N,"2030-12-31"),defaultIndex:+a().diff(a(N),"day"),className:"date-pick"},{values:(e=>{const a=[];for(let t=0;t<=e;)t<=9?a.push(`0${t}时`):a.push(`${t}时`),t+=1;return a})(23),defaultIndex:a().format("HH")},{values:(()=>{const e=[];for(let a=0;a<=60;)a<=9?e.push(`0${a}分`):e.push(`${a}分`),a+=5;return e})(),defaultIndex:0}],$=[{label:"线下活动",value:"offline_activity"},{label:"直播活动",value:"online_activity"},{label:"线上获客",value:"get_customer"}];const M=e=>(y("data-v-93e01d68"),e=e(),h(),e),B={class:"add-apply"},H={class:"upload-container"},J=["src"],R={key:0,class:"upload-btn"},q=[M((()=>p("span",{class:"upload-label"},"+",-1))),M((()=>p("span",{class:"upload-front"},"上传活动封面",-1)))],A=M((()=>p("div",{class:"upload-title"},"建议尺寸 16:9",-1))),G={key:1,class:"has-upload-btn"},Q=[M((()=>p("span",{class:"upload-label"},"+",-1))),M((()=>p("span",{class:"upload-front"},"上传封面",-1)))],K=M((()=>p("span",{class:"apply-title"},[C("活动方式"),p("span",{class:"star"},"*")],-1))),P={class:"f-select"},W=["onClick"],X=M((()=>p("span",null,[p("span",{class:"apply-title"},[C("活动类型"),p("span",{class:"star"},"*")])],-1))),Z={key:0},ee={key:1,class:"cell-val"},ae=M((()=>p("span",null,[p("span",{class:"apply-title"},[C("活动主题"),p("span",{class:"star"},"*")])],-1))),te=M((()=>p("span",{class:"apply-title"},[C("活动开始时间"),p("span",{class:"star"},"*")],-1))),le={key:0},ie={key:1,class:"cell-val"},ne=M((()=>p("span",{class:"apply-title"},[C("活动结束时间"),p("span",{class:"star"},"*")],-1))),se={key:0},oe={key:1,class:"cell-val"},re=M((()=>p("span",{class:"apply-title"},[C("报名开始时间"),p("span",{class:"star"},"*")],-1))),de={key:0},ce={key:1,class:"cell-val"},pe=M((()=>p("span",{class:"apply-title"},[C("报名截止时间"),p("span",{class:"star"},"*")],-1))),ue={key:0},me={key:1,class:"cell-val"},ve=M((()=>p("span",null,[p("span",{class:"apply-title"},[C("活动地址"),p("span",{class:"star"},"*")])],-1))),fe=M((()=>p("span",null,[p("span",{class:"apply-title"},[C("直播链接"),p("span",{class:"star"},"*")])],-1))),ge=M((()=>p("span",null,[p("span",{class:"apply-title"},[C("活动链接"),p("span",{class:"star"},"*")])],-1))),ye=M((()=>p("span",{class:"apply-title"},[C("报名项填写"),p("span",{class:"star"},"*")],-1))),he={key:0},be={key:1,class:"cell-val"},ke=M((()=>p("span",{class:"apply-title"},[C("限制报名人数"),p("span",{class:"star"},"*")],-1))),_e={key:0,class:"digit-input"},we=C("人"),xe=M((()=>p("span",{class:"apply-title"},[C("活动范围"),p("span",{class:"star"},"*")],-1))),Te={key:0},Se={key:1,class:"cell-val"},De={class:"footer"},Ce=[M((()=>p("span",null,"保存发布",-1)))];e("default",Y(t({setup(e){const t=new j({source:"localStorage"}),{getIconUrl:y}=V(),h=l(L),C=i();n();const Y=s({startDate:!1,endDate:!1,registrationStartTime:!1,registrationEndTime:!1}),N=l([]),M=l(!1),Ie=l(!1),je=l(!1),Ve=l([]),Fe=JSON.parse(sessionStorage.getItem("columnDTOS"))||[],Oe=JSON.parse(sessionStorage.getItem("applyInfo"))||{activityFormat:"offline_activity"};sessionStorage.removeItem("applyInfo"),sessionStorage.removeItem("columnDTOS");const Ue=s({...Oe,columnDTOS:Fe}),ze=l(!1),Ee=e=>{Y[e]=!0},Ye=()=>{U(1).then((e=>{if(Array.isArray(e)){const[a]=e;Ue.coverImage=a}}))};o((()=>{(async()=>{var e;const a=await F();var t,l;200===(null===(e=a.data)||void 0===e?void 0:e.status)&&(N.value=(null===(t=a.data)||void 0===t||null===(l=t.data)||void 0===l?void 0:l.map((e=>({name:e.itemName,value:e.itemCode}))))||[])})();const e=t.get("userInfo");"I"===(null==e?void 0:e.userType)||"O"===(null==e?void 0:e.userType)&&(null==e?void 0:e.agentLevel)<=60?Ie.value=!0:Ie.value=!1}));const Ne=()=>{sessionStorage.setItem("applyInfo",JSON.stringify(Ue)),Ue.columnDTOS.length>0&&sessionStorage.setItem("columnDTOS",JSON.stringify(Ue.columnDTOS)),C.push({path:"./applyItem"})},Le=e=>{setTimeout((()=>{e.target&&e.target.scrollIntoView()}),200)},$e=(e,t)=>{const[l,i,n]=t,s=[l.slice(0,-3),i,n].join("").replace(/年|月|日|时|分/g,"");Ue[e]=a(s).format("YYYY-MM-DD HH:mm"),Y[e]=!1},Me=l(0),Be=r((()=>{const e=Ue.columnDTOS.filter((e=>"Y"===e.isSelected));if(e.length>0){const{length:a}=e,t=e.slice(0,3).map((e=>e.label)).join(",");return a>3?`${t}...`:t}return""})),He=l(""),Je=e=>{Ue.activityType=e.value,He.value=e.name},Re=async()=>{if(!Ue.activityType)return I("活动类型不能为空");if(!Ue.topic)return I("活动主题不能为空");if(!Ue.startDate)return I("活动开始时间不能为空");if(!Ue.endDate)return I("活动开始结束不能为空");if(a(Ue.endDate).isBefore(a(Ue.startDate)))return I("活动开始时间不能晚于结束时间");if("get_customer"!==Ue.activityFormat){if(!Ue.registrationStartTime)return I("报名开始时间不能为空");if(!Ue.registrationEndTime)return I("报名结束时间不能为空");if(a(Ue.registrationEndTime).isBefore(a(Ue.registrationStartTime)))return I("报名开始时间不能晚于报名截止时间");if(a(Ue.endDate).isBefore(a(Ue.registrationStartTime)))return I("报名开始时间不能晚于活动结束时间");if(a(Ue.endDate).isBefore(a(Ue.registrationEndTime)))return I("报名截止时间不能晚于活动结束时间");if(M.value&&!Ue.registrationLimit)return I("限制报名人数不能为空");if(0===Ue.columnDTOS.length)return I("报名项填写不能为空");if(!Ue.address)return I("online_activity"===Ue.activityFormat?"活动地址不能为空":"直播链接不能为空")}else if(!Ue.address)return I("活动链接不能为空");if(0===Me.value)return I("活动范围不能为空");O({...Ue,columnDTOS:Ue.columnDTOS.map((e=>({...e,required:e.required?"Y":"N"}))),dispatchTarget:Ve.value}).then((e=>{200===e.data.status&&(I("创建成功！"),C.back())}))},qe=e=>{Ve.value=e.map((e=>({id:e.agencyId,name:e.agencyName,...e})))};return d(Ve,(async e=>{const a=[];e.forEach((e=>{const{id:t,memberCode:l,memberType:i}=e;a.push({memberCode:l||t,memberType:i})}));const{data:{data:t=0}}=await E({codeList:a});Me.value=t})),(e,a)=>{const t=b("van-cell"),l=b("van-field"),i=b("van-switch"),n=b("van-cell-group"),s=b("van-picker"),o=b("van-popup"),r=b("van-action-sheet"),d=k("resize");return _(),c(g,null,[p("div",B,[p("div",H,[p("img",{src:u(Ue).coverImage||u(y)("apply.bgImg"),alt:"",class:"bg-img"},null,8,J),u(Ue).coverImage?(_(),c("div",G,[p("div",{class:"btn",onClick:Ye},Q)])):(_(),c("div",R,[p("div",{class:"btn",onClick:Ye},q),A]))]),m(n,null,{default:v((()=>[m(t,{class:"active-line"},{title:v((()=>[K])),value:v((()=>[p("div",P,[(_(!0),c(g,null,w(u($),(e=>(_(),c("div",{key:e.value,class:x(["m-box",{active:u(Ue).activityFormat===e.value}]),onClick:a=>{return t=e.value,void(Ue.activityFormat=t);var t}},T(e.label),11,W)))),128))])])),_:1}),m(t,{"is-link":"","label-class":"label","input-align":"right",onClick:a[0]||(a[0]=e=>je.value=!0)},{title:v((()=>[X])),value:v((()=>[u(Ue).activityType?(_(),c("span",Z,T(He.value),1)):(_(),c("span",ee,"请选择"))])),_:1}),m(l,{modelValue:u(Ue).topic,"onUpdate:modelValue":a[1]||(a[1]=e=>u(Ue).topic=e),"label-class":"label","input-align":"right",placeholder:"请填写活动主题",maxlength:15},{label:v((()=>[ae])),_:1},8,["modelValue"]),m(t,{"is-link":"",onClick:a[2]||(a[2]=e=>Ee("startDate"))},{title:v((()=>[te])),value:v((()=>[u(Ue).startDate?(_(),c("span",le,T(u(Ue).startDate),1)):(_(),c("span",ie,"请选择"))])),_:1}),m(t,{"title-class":"label","is-link":"",onClick:a[3]||(a[3]=e=>Ee("endDate"))},{title:v((()=>[ne])),value:v((()=>[u(Ue).endDate?(_(),c("span",se,T(u(Ue).endDate),1)):(_(),c("span",oe,"请选择"))])),_:1}),"get_customer"!==u(Ue).activityFormat?(_(),S(t,{key:0,"title-class":"label","is-link":"",onClick:a[4]||(a[4]=e=>Ee("registrationStartTime"))},{title:v((()=>[re])),value:v((()=>[u(Ue).registrationStartTime?(_(),c("span",de,T(u(Ue).registrationStartTime),1)):(_(),c("span",ce,"请选择"))])),_:1})):D("",!0),"get_customer"!==u(Ue).activityFormat?(_(),S(t,{key:1,"title-class":"label","is-link":"",onClick:a[5]||(a[5]=e=>Ee("registrationEndTime"))},{title:v((()=>[pe])),value:v((()=>[u(Ue).registrationEndTime?(_(),c("span",ue,T(u(Ue).registrationEndTime),1)):(_(),c("span",me,"请选择"))])),_:1})):D("",!0),"offline_activity"===u(Ue).activityFormat?(_(),S(l,{key:2,modelValue:u(Ue).address,"onUpdate:modelValue":a[6]||(a[6]=e=>u(Ue).address=e),"label-class":"label","input-align":"right",maxlength:30,placeholder:"请输入活动地址"},{label:v((()=>[ve])),_:1},8,["modelValue"])):D("",!0),"online_activity"===u(Ue).activityFormat?(_(),S(l,{key:3,modelValue:u(Ue).address,"onUpdate:modelValue":a[7]||(a[7]=e=>u(Ue).address=e),"label-class":"label","input-align":"right",maxlength:100,placeholder:"请输入直播链接"},{label:v((()=>[fe])),_:1},8,["modelValue"])):D("",!0),"get_customer"===u(Ue).activityFormat?(_(),S(l,{key:4,modelValue:u(Ue).address,"onUpdate:modelValue":a[8]||(a[8]=e=>u(Ue).address=e),"label-class":"label","input-align":"right",maxlength:100,placeholder:"请输入活动链接"},{label:v((()=>[ge])),_:1},8,["modelValue"])):D("",!0),"get_customer"!==u(Ue).activityFormat?(_(),S(t,{key:5,"title-class":"label","is-link":"",onClick:Ne},{title:v((()=>[ye])),value:v((()=>[u(Ue).columnDTOS.length>0?(_(),c("span",he,T(u(Be)),1)):(_(),c("span",be,"请选择"))])),_:1})):D("",!0),"get_customer"!==u(Ue).activityFormat?(_(),S(t,{key:6,"title-class":"label",class:"digit-container"},{title:v((()=>[ke])),value:v((()=>[M.value?(_(),c("div",_e,[m(l,{modelValue:u(Ue).registrationLimit,"onUpdate:modelValue":a[9]||(a[9]=e=>u(Ue).registrationLimit=e),type:"digit",maxlength:4,"input-align":e.right,border:!1,placeholder:"请输入"},{extra:v((()=>[we])),_:1},8,["modelValue","input-align"])])):D("",!0),m(i,{modelValue:M.value,"onUpdate:modelValue":a[10]||(a[10]=e=>M.value=e)},null,8,["modelValue"])])),_:1})):D("",!0),Ie.value?(_(),S(t,{key:7,"title-class":"label","is-link":"",onClick:a[11]||(a[11]=e=>ze.value=!0)},{title:v((()=>[xe])),value:v((()=>[Me.value>0?(_(),c("span",Te,"已选"+T(Me.value)+"人",1)):(_(),c("span",Se,"请选择"))])),_:1})):D("",!0)])),_:1}),m(l,{modelValue:u(Ue).introduction,"onUpdate:modelValue":a[12]||(a[12]=e=>u(Ue).introduction=e),class:"apply-intro",type:"textarea",rows:"3",label:"活动介绍","show-word-limit":"",placeholder:"请输入活动介绍",maxlength:50,onFocus:Le},null,8,["modelValue"])]),m(o,{show:u(Y).startDate,"onUpdate:show":a[14]||(a[14]=e=>u(Y).startDate=e),position:"bottom",style:{height:"40%"}},{default:v((()=>[m(s,{ref:"pickerRef",title:"选择日期",class:"picker-lct",columns:h.value,onConfirm:a[13]||(a[13]=e=>$e("startDate",e))},null,8,["columns"])])),_:1},8,["show"]),m(o,{show:u(Y).endDate,"onUpdate:show":a[16]||(a[16]=e=>u(Y).endDate=e),position:"bottom",style:{height:"40%"}},{default:v((()=>[m(s,{ref:"pickerRef",title:"选择日期",class:"picker-lct",columns:h.value,onConfirm:a[15]||(a[15]=e=>$e("endDate",e))},null,8,["columns"])])),_:1},8,["show"]),m(o,{show:u(Y).registrationStartTime,"onUpdate:show":a[18]||(a[18]=e=>u(Y).registrationStartTime=e),position:"bottom",style:{height:"40%"}},{default:v((()=>[m(s,{ref:"pickerRef",title:"选择日期",class:"picker-lct",columns:h.value,onConfirm:a[17]||(a[17]=e=>$e("registrationStartTime",e))},null,8,["columns"])])),_:1},8,["show"]),m(o,{show:u(Y).registrationEndTime,"onUpdate:show":a[20]||(a[20]=e=>u(Y).registrationEndTime=e),position:"bottom",style:{height:"40%"}},{default:v((()=>[m(s,{ref:"pickerRef",title:"选择日期",class:"picker-lct",columns:h.value,onConfirm:a[19]||(a[19]=e=>$e("registrationEndTime",e))},null,8,["columns"])])),_:1},8,["show"]),m(z,{visible:ze.value,"onUpdate:visible":a[21]||(a[21]=e=>ze.value=e),mode:"multiple","select-value":Ve.value,onOnSubmit:qe},null,8,["visible","select-value"]),m(r,{show:je.value,"onUpdate:show":a[22]||(a[22]=e=>je.value=e),actions:N.value,"close-on-click-action":"","cancel-text":"取消",onSelect:Je,onCancel:a[23]||(a[23]=e=>je.value=!1)},null,8,["show","actions"]),f((_(),c("div",De,[p("div",{class:"btn",onClick:Re},Ce)])),[[d]])],64)}}}),[["__scopeId","data-v-93e01d68"]]))}}}))}();
