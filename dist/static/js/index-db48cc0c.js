import{h as j,aa as V,P as w,G as C,d as $,N as H,j as Q,r as c,k as r,m as h,n as p,s as _,p as P,H as S,M as z,B as D,F as M,A as E,L as J,E as N,T as A}from"./vendor-4d9de129.js";import{_ as W,a as b,E as X,g as K,A as Z,t as ee,n as te,N as se,b as oe}from"./index-6cd418a3.js";import{l as ne,g as ue}from"./inform-ed7c6ba0.js";import{s as ie}from"./useStorage-ba178c03.js";import{s as ae}from"./verify-0d2e7636.js";import{d as le,A as ce,e as re}from"./notice-a4a1c218.js";const pe={class:"date"},_e={class:"inform-file"},Ee={class:"tips"},fe=N(" \u60A8\u7684\u7B7E\u540D\u5C06\u88AB\u7528\u4E8E"),de=N("\u6587\u4EF6 "),ve={class:"footer-button"},Ce=N("\u4E0B\u4E00\u6B65"),Te=j({setup(ge){const k=V(),T=w(),{productCode:Be="MMBBSF",agentCode:L="65434444",tenantId:f="9991000007",agencyCode:me="3311222",insurerCode:g="zhongan",productCategory:x=1,templateId:U=1,orderNo:B="2022080217103534947"}=T.query,l=C(null),m=C(!1),q=$().format("YYYY-MM-DD"),d=C(""),y=C(),I=()=>{var t;(t=l.value)==null||t.clear()},o=H({noticeType:"",materialSource:"",noticeList:[],pageData:{}}),O=()=>{K({orderNo:B,saleUserId:L,tenantId:f}).then(({code:t,data:s})=>{t==="10000"&&(Object.assign(o.pageData,s),s.tenantOrderAttachmentList.forEach(n=>{n.category===Z.ELECTRIC_SIGN&&n.objectType===ee.AGENT&&l.value.setDataURL(n.fileBase64)}))})},R=t=>{const{id:s,objectType:n}=t,a={1:"pdf",2:"richText",3:"link"};ue({insurerCode:g,id:s,objectType:n,productCategory:x,orderNo:B,tenantId:f}).then(({code:i,data:e})=>{i==="10000"&&((e==null?void 0:e[0].questionType)===le?(d.value="question",y.value=e):((e==null?void 0:e[0].textType)===1&&(e==null?void 0:e[0].content.includes("png"))?d.value="picture":d.value=a[e==null?void 0:e[0].textType],y.value=e==null?void 0:e[0].content))})};Q(()=>{O(),ne({insurerCode:g,orderNo:B,productCategory:x,tenantId:f,noticeType:ce,objectType:re}).then(({code:t,data:s})=>{t==="10000"&&(o.noticeList=[...o.noticeList,...s])})});const Y=t=>{ie.set("questionData",t),k.push({path:"/healthNotice",query:{questionnaireType:t.questionnaireType,...T.query}})},G=()=>{var n,a;if(!(o.noticeList&&o.noticeList.every(i=>i.isDone===1))){A("\u8BF7\u5B8C\u6210\u6240\u6709\u544A\u77E5\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if((n=l.value)!=null&&n.isEmpty()){A("\u8BF7\u5B8C\u6210\u4EE3\u7406\u4EBA\u7B7E\u5B57\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if(!m.value){A("\u8BF7\u52FE\u9009\u540C\u610F\u7B7E\u540D");return}const s=(a=l.value)==null?void 0:a.save();ae("AGENT",s,o.pageData.id,f).then(i=>{i&&te({...o.pageData,extInfo:{...o.pageData.extInfo,templateId:U,pageCode:"salesNotice",buttonCode:se.salesNotice},venderCode:g}).then(({code:e,data:v})=>{e==="10000"&&v.pageAction.pageAction==="jumpToPage"&&k.push({path:oe[v.pageAction.data.nextPageCode],query:{...T.query}})})})};return(t,s)=>{const n=c("van-cell"),a=c("ProSign"),i=c("van-checkbox"),e=c("van-button"),v=c("ProPageWrap");return r(),h(v,{class:"page-salesman-inform"},{default:p(()=>[_(b,{title:"\u8425\u9500\u5458\u544A\u77E5\u4E66"},{default:p(()=>[(r(!0),P(M,null,S(D(o).noticeList,u=>(r(),h(n,{key:u.id,class:z({"is-active":u.isDone===2}),title:`\u300A${u.title}\u300B`,"is-link":"",value:`${u.isDone===1?"\u5DF2\u5B8C\u6210":"\u53BB\u5B8C\u6210"}`,onClick:F=>Y(u)},null,8,["class","title","value","onClick"]))),128))]),_:1}),_(b,{title:"\u8425\u9500\u5458\u7B7E\u5B57","show-divider":!1,"show-line":!1},{extra:p(()=>[E("div",{class:"resign",onClick:I},"\u91CD\u7B7E")]),default:p(()=>[_(a,{ref_key:"agentSignRef",ref:l,selector:"sign2"},null,512),E("div",pe,"\u7B7E\u540D\u65E5\u671F\uFF1A "+J(D(q)),1)]),_:1}),E("div",_e,[_(i,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=u=>m.value=u),shape:"square"},null,8,["modelValue"]),E("p",Ee,[fe,(r(!0),P(M,null,S(D(o).noticeList,(u,F)=>(r(),h(X,{key:F,class:"file",title:`\u300A${u.title}\u300B`,content:y.value,type:d.value,onClick:ye=>R(u)},null,8,["title","content","type","onClick"]))),128)),de])]),E("div",ve,[_(e,{type:"primary",block:"",onClick:G},{default:p(()=>[Ce]),_:1})])]),_:1})}}});var Fe=W(Te,[["__scopeId","data-v-1d1c7e90"]]);export{Fe as default};
