import{_ as e,d as s,a,r as i,J as o,E as t,cd as l,an as n,c as r,h as d,f as u,g as c,F as m,i as p,e as k,aE as v,G as f,w as I,k as h,y,A as g,j as V,n as b,t as O,a4 as C,bB as R,a7 as L,V as x,B as _,bE as S,bF as P,X as T,Y as w,b4 as F,a8 as j}from"./index-fe1081ea.js";import{l as D}from"./ProAddress.vue_vue_type_style_index_0_scoped_true_lang-17c4751e.js";import"./index-00743600.js";import{I as N}from"./index-87335a6d.js";import{c as E,t as q,_ as U}from"./index-680398f0.js";import{S as M}from"./index-e93a72d4.js";import{p as B,f as W}from"./trial-3d1cafe4.js";import{_ as z}from"./TrialButton-8b440933.js";import{_ as A}from"./index-b6409758.js";import{S as H,_ as $}from"./box-title-af90c241.js";import{_ as G}from"./index-4dd99f8a.js";import{T as J}from"./Table-a6d69ca9.js";import"./pdfh5-008ca364.js";import"./cloneDeep-aaa98338.js";import"./keysIn-b3061da8.js";import"./isObjectLike-d00d103b.js";import"./index-e40882f4.js";import"./empty-ae586b6c.js";import"./echarts-5af64754.js";var X=e(s({__name:"PersonalInfo",props:{productFactor:{default:()=>({})},modelValue:{default:()=>({})}},emits:["update:modelValue","trailChange"],setup(e,{expose:s,emit:v}){const f=e,{query:{insurerCode:I}={}}=a(),h=i(null),y=i(null),g=o({validated:!1,holder:{personVO:{},schema:[],trialFactorCodes:[],config:{occupation:{dictCode:E(I)}}},insured:{schema:[],trialFactorCodes:[],config:{occupation:{dictCode:E(I)}},insuredVOList:[{personVO:{}}]}}),V=t((()=>l(g.holder.schema)!==l(g.insured.schema))),b=()=>{var e,s;const a=null==(e=y.value)?void 0:e.map((e=>null==e?void 0:e.validate()));return Promise.all([null==(s=h.value)?void 0:s.validate(),...a])};return n((()=>f.productFactor),(()=>{const[e,s]=q(f.productFactor,!0);Object.assign(g.holder,e),Object.assign(g.insured,s)}),{deep:!0,immediate:!0}),n([()=>g.holder.personVO,()=>g.insured.insuredVOList],(()=>{const e={holder:g.holder.personVO,insuredVOList:g.insured.insuredVOList};v("update:modelValue",e),(()=>{const e=!!l(g.holder.trialFactorCodes)&&g.holder.trialFactorCodes.some((e=>{const s=g.holder.personVO[e];return D.exports.isNil(s)||""===s})),s=!!l(g.insured.trialFactorCodes)&&g.insured.trialFactorCodes.some((e=>g.insured.insuredVOList.some((s=>{const a=s.personVO[e];return D.exports.isNil(a)||""===a}))));return e||s})()||b().then((()=>{g.validated=!0,v("trailChange",e)})).catch((()=>{g.validated=!1}))}),{deep:!0}),s({validate:b}),(e,s)=>(r(),d(m,null,[u(c(U),{ref_key:"holderInfoRef",ref:h,title:c(V)?"":"投保人信息",class:"trail-personal-info",model:c(g).holder.personVO,schema:c(g).holder.schema,config:c(g).holder.config},null,8,["title","model","schema","config"]),(r(!0),d(m,null,p(c(g).insured.insuredVOList,((e,s)=>(r(),k(c(U),{ref_for:!0,ref_key:"insuredFormRef",ref:y,key:s,class:"trail-personal-info",title:c(V)?"":"被保人信息",model:e.personVO,schema:c(g).insured.schema,config:c(g).insured.config},null,8,["title","model","schema","config"])))),128))],64))}}),[["__scopeId","data-v-a2c06736"]]);const Y={key:0},Z={key:0,class:"risk2-field"};var K=e(s({__name:"index",props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0}},emits:["trialChange"],setup(e,{emit:s}){const a=e;console.log("pop data source = ",a.dataSource);const i=o({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[]}),t=e=>{const s=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&s.push({...e}),[]))),s},l=(e,o)=>{i.riskIsInsure[o].data=e;const t=[...i.disabledRiskInfo];a.dataSource.insureProductRiskVOList.forEach((e=>{if(1!==e.mainRiskFlag){const s=i.riskIsInsure[e.riskId];s.data&&Object.keys(s.data).length>0&&!s.isDisabled&&t.push(s.data)}})),s("trialChange",t)};return v((()=>{(()=>{i.riskIsInsure={},i.disabledRiskInfo=[];let e=null;a.dataSource.insureProductRiskVOList.forEach((s=>{const o=1!==s.mainRiskFlag?a.dataSource.productRiskRelationVOList.find((e=>e.collocationRiskId===s.riskId)):{};1===s.mainRiskFlag&&(e=s),i.riskIsInsure[s.riskId]={selected:"2",data:null,relation:o,isMust:!1}})),e&&a.dataSource.productRiskRelationVOList.filter((s=>s.riskId===e.riskId)).forEach((e=>{var s,o,l,n,r,d,u,c,m,p,k;if(2===e.collocationType){i.riskIsInsure[e.collocationRiskId].selected="1",i.riskIsInsure[e.collocationRiskId].isMust=!0;const v=a.dataSource.insureProductRiskVOList.find((s=>e.collocationRiskId===s.riskId));if(v&&1!==v.factorDisPlayFlag&&v.riskLiabilityInfoVOList.every((e=>1!==e.showFlag))){i.riskIsInsure[e.collocationRiskId].isDisabled=!0;const a={riskCategory:v.riskCategory,riskCode:v.riskCode,riskName:v.riskName,riskId:v.riskId,riskType:v.riskType,mainRiskId:v.mainRiskId,mainRiskCode:v.mainRiskCode,liabilityVOList:t(v)};a.chargePeriod=(null==(s=null==v?void 0:v.paymentPeriodValueList)?void 0:s.length)>0&&(null==v?void 0:v.paymentPeriodValueList[0].code),a.coveragePeriod=(null==(o=null==v?void 0:v.insurancePeriodValueList)?void 0:o.length)>0&&(null==v?void 0:v.insurancePeriodValueList[0].code),a.paymentFrequency=(null==(l=null==v?void 0:v.paymentFrequencyList)?void 0:l.length)>0&&(null==v?void 0:v.paymentFrequencyList[0].code);let f=0;1===v.amountPremiumConfigVO.displayType?f=(null==(n=null==v?void 0:v.amountPremiumConfigVO)?void 0:n.minStepValue)>0?null==(r=null==v?void 0:v.amountPremiumConfigVO)?void 0:r.minStepValue:0:3===v.amountPremiumConfigVO.displayType&&2===v.amountPremiumConfigVO.requireCopies?f=(null==(u=null==(d=null==v?void 0:v.amountPremiumConfigVO)?void 0:d.displayValues)?void 0:u.length)>0?null==(c=null==v?void 0:v.amountPremiumConfigVO)?void 0:c.displayValues[0].value:0:3===v.amountPremiumConfigVO.displayType&&1===v.amountPremiumConfigVO.requireCopies?(f=(null==(p=null==(m=null==v?void 0:v.amountPremiumConfigVO)?void 0:m.displayValues)?void 0:p.length)>0?null==(k=null==v?void 0:v.amountPremiumConfigVO)?void 0:k.displayValues[0].value:0,a.copy=v.amountPremiumConfigVO.minCopiesValue):2===v.amountPremiumConfigVO.displayType&&(a.copy=v.amountPremiumConfigVO.minCopiesValue),1===v.amountPremiumConfigVO.saleMethod?a.amount=f:a.premium=f,i.disabledRiskInfo.push(a)}}3===e.collocationType&&(i.riskIsInsure[e.collocationRiskId].selected="2",i.riskIsInsure[e.collocationRiskId].isMust=!0)}))})()})),f((()=>{i.loading=!0})),n((()=>i.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),(s,o)=>{const t=M,n=y;return r(!0),d(m,null,p(e.dataSource.insureProductRiskVOList,(s=>(r(),d(m,{key:s.riskCode},[(!e.showMainRisk&&1!==s.mainRiskFlag||e.showMainRisk)&&c(i).riskIsInsure[s.riskId].relation?(r(),d("div",Y,[u(n,{modelValue:c(i).riskIsInsure[s.riskId].selected,"onUpdate:modelValue":e=>c(i).riskIsInsure[s.riskId].selected=e,label:s.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:I((()=>[u(t,{modelValue:c(i).riskIsInsure[s.riskId].selected,"onUpdate:modelValue":e=>c(i).riskIsInsure[s.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"26px",disabled:c(i).riskIsInsure[s.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>{return o=e,t=s,a.dataSource.productRiskRelationVOList.forEach((e=>{1!==e.collocationType&&(t.riskId===e.riskId?(i.riskIsInsure[t.riskId]&&i.riskIsInsure[t.riskId].selected,2===e.collocationType&&i.riskIsInsure[e.collocationRiskId]&&(i.riskIsInsure[e.collocationRiskId].selected=o),3===e.collocationType&&i.riskIsInsure[e.collocationRiskId]&&(i.riskIsInsure[e.collocationRiskId].selected="1"===o?"2":"1")):t.riskId===e.collocationRiskId&&(3===e.collocationType&&i.riskIsInsure[e.riskId]&&(i.riskIsInsure[e.riskId].selected="1"===o?"2":"1"),2===e.collocationType&&i.riskIsInsure[e.riskId]&&(i.riskIsInsure[e.riskId].selected=o)))})),"2"===o&&l({},t.riskId),void console.log(i.riskIsInsure);var o,t}},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===c(i).riskIsInsure[s.riskId].selected?(r(),d("div",Z,[u(N,{modelValue:c(i).riskIsInsure[s.riskId].data,"onUpdate:modelValue":e=>c(i).riskIsInsure[s.riskId].data=e,"origin-data":s,"product-factor":e.dataSource.productFactor,onTrialChange:e=>l(e,s.riskId)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","onTrialChange"])])):h("",!0)])):h("",!0)],64)))),128)}}}),[["__scopeId","data-v-6d26f650"]]);const Q={class:"benefit-table"},ee=s({__name:"Table",props:{dataSource:null},setup(e){const s=e,a=t((()=>{const e=s.dataSource.headers.length,a=12*s.dataSource.headers.join("").length+20*s.dataSource.headers.length;return s.dataSource.headers.map(((s,i)=>{const o=a>320?12*s.length+20:Math.max(12*s.length+20,320/e);return console.log("totalWordWidth:",a,"titleWidth:",o,"word-width:",12*s.length+20),{title:s,key:`header_${i}`,fixed:i<2,minWidth:o}}))})),i=t((()=>s.dataSource.dataList.map((e=>{const s={};return e.forEach(((e,a)=>{s[`header_${a}`]=e})),s}))));return f((()=>{})),(e,s)=>(r(),d("div",Q,[u(J,{"top-height":400,columns:c(a),data:c(i),"is-clone":!0},null,8,["columns","data"])]))}});const se=e=>(T("data-v-6ce49ae0"),e=e(),w(),e),ae={key:0,class:"benefit-container"},ie={key:0,class:"benefit"},oe=se((()=>V("div",{class:"line"},null,-1))),te={class:"box-title box-title-chart"},le=se((()=>V("img",{class:"tl",src:$,alt:""},null,-1))),ne=se((()=>V("img",{class:"transform-z180 tr",src:$,alt:""},null,-1))),re={key:0},de={class:"box"},ue={class:"box-title"},ce=se((()=>V("img",{class:"tl",src:$,alt:""},null,-1))),me=se((()=>V("img",{class:"transform-z180 tr",src:$,alt:""},null,-1))),pe={class:"box-price"},ke={class:"text1"},ve={class:"text2"},fe={key:1},Ie={key:2,style:{width:"100%, minWidth: 338px"}},he={class:"slider"},ye={style:{flex:"1",margin:"0px 5px"}},ge={class:"custom-button"},Ve=se((()=>V("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),be={class:"btn-two"},Oe={key:1};var Ce=e(s({__name:"index",props:{dataSource:{default:()=>[{}]},showTypeList:{default:()=>["1"]}},setup(e){const s=e,a="1",o="2",t="3",l=i(0),v=i(0),f=i(0),y=i(),T=i(0),w=i(s.showTypeList[0]),F=i(),j=e=>{if(!(null==e?void 0:e.benefitRiskResultVOList))return;const s=null==e?void 0:e.benefitRiskResultVOList[l.value];v.value=s.ageBegin+1,T.value=s.ageBegin+1,f.value=s.ageEnd},D=()=>{var e,a,i,o,t;const n=null==(a=null==(e=s.dataSource)?void 0:e.benefitRiskResultVOList)?void 0:a[l.value];F.value=null==(o=null==(i=s.dataSource)?void 0:i.benefitRiskResultVOList)?void 0:o[l.value].benefitRiskTableResultVOList[0];const{a:r,year:d}=((e,s)=>{const a=[],i=[];for(let o=e,t=0;o<=s;o++,t++)a.push(o.toString()),i.push(t+1);return{a:a,year:i}})(v.value,f.value),u={index:r.indexOf(T.value.toString()),age:r,year:d,result:null==(t=null==n?void 0:n.benefitRiskItemResultVOList)?void 0:t[0]};y.value=u},N=()=>{T.value>f.value-1||(T.value+=1,D())},E=()=>{T.value>v.value&&(T.value-=1,D())},q=e=>{l.value=e.name,j(s.dataSource),D()};return n((()=>s.dataSource),(e=>{e&&(j(e),D())}),{deep:!0,immediate:!0}),n(T,(()=>{D()})),(i,n)=>{const j=x,D=H,U=_,M=S,B=P,W=A;return e.dataSource.benefitRiskResultVOList?(r(),d("div",ae,[u(B,{active:c(l),onClickTab:q},{default:I((()=>{var e;return[(r(!0),d(m,null,p(null==(e=s.dataSource)?void 0:e.benefitRiskResultVOList,((e,i)=>(r(),k(M,{key:i,name:i,title:e.riskName},{default:I((()=>{var e,x,_,S,P,q,M,B,W,z,A,H,$,J,X,Y;return[i==c(l)?(r(),d("div",ie,[oe,g(V("p",te,[le,b(" 保单年度"),V("span",null,O(null==(_=null==(e=c(y))?void 0:e.year)?void 0:_[null==(x=c(y))?void 0:x.index]),1),b("年度，被保人"),V("span",null,O(null==(q=null==(S=c(y))?void 0:S.age)?void 0:q[null==(P=c(y))?void 0:P.index]),1),b("岁时 "),ne],512),[[C,c(w)===o]]),c(w)===t?(r(),d("div",re,[V("div",de,[V("p",ue,[ce,b(" 保单年度"),V("span",null,O(null==(W=null==(M=c(y))?void 0:M.year)?void 0:W[null==(B=c(y))?void 0:B.index]),1),b("年度，被保人"),V("span",null,O(null==(H=null==(z=c(y))?void 0:z.age)?void 0:H[null==(A=c(y))?void 0:A.index]),1),b("岁时 "),me]),V("div",pe,[(r(!0),d(m,null,p(null==(J=null==($=c(y))?void 0:$.result)?void 0:J.headers,((e,s)=>{var a,i,o,t,l,n,u,m,p,k;return r(),d("div",{key:s,style:{width:"33%"}},[V("p",ke,O("0"==(null==(l=null==(t=null==(i=null==(a=c(y))?void 0:a.result)?void 0:i.dataList)?void 0:t[null==(o=c(y))?void 0:o.index])?void 0:l[s])?"0":c(R)(Number(null==(k=null==(p=null==(u=null==(n=c(y))?void 0:n.result)?void 0:u.dataList)?void 0:p[null==(m=c(y))?void 0:m.index])?void 0:k[s]))),1),V("p",ve,O(e)+"(元）",1)])})),128))])])])):h("",!0),c(w)===a?(r(),d("div",fe,[u(ee,{"data-source":c(F)},null,8,["data-source"])])):h("",!0),c(w)==o?(r(),d("div",Ie,[u(G,{min:c(v),max:c(f),current:c(T),data:null==(Y=null==(X=c(y))?void 0:X.result)?void 0:Y.benefitRiskItemList},null,8,["min","max","current","data"])])):h("",!0),V("div",he,[V("div",{class:"opt lf",onClick:E},[u(j,{name:"minus"})]),V("div",ye,[c(v)?(r(),k(D,{key:0,modelValue:c(T),"onUpdate:modelValue":n[0]||(n[0]=e=>L(T)?T.value=e:null),min:c(v),max:c(f),"bar-height":"8px"},{button:I((()=>[V("div",ge,O(c(T))+" 岁",1)])),_:1},8,["modelValue","min","max"])):h("",!0)]),V("div",{class:"opt rg",onClick:N},[u(j,{name:"plus"})])]),Ve,V("div",be,[s.showTypeList.includes(t)?(r(),k(U,{key:0,round:"",plain:c(w)!==t,type:"primary",class:"btn",onClick:n[1]||(n[1]=e=>w.value=t)},{default:I((()=>[b("图表展示")])),_:1},8,["plain"])):h("",!0),s.showTypeList.includes(o)?(r(),k(U,{key:1,round:"",plain:c(w)!==o,type:"primary",class:"btn",onClick:n[2]||(n[2]=e=>w.value=o)},{default:I((()=>[b("趋势展示")])),_:1},8,["plain"])):h("",!0),s.showTypeList.includes(a)?(r(),k(U,{key:2,round:"",plain:c(w)!==a,type:"primary",class:"btn",onClick:n[3]||(n[3]=e=>w.value=a)},{default:I((()=>[b("表格展示")])),_:1},8,["plain"])):h("",!0)])])):h("",!0)]})),_:2},1032,["name","title"])))),128))]})),_:1},8,["active"])])):(r(),d("div",Oe,[u(W,{title:"利益演示配置错误~","empty-class":"empty-select"})]))}}}),[["__scopeId","data-v-6ce49ae0"]]);const Re={class:"trial-button"},Le={class:"com-body"},xe={class:"header"},_e=(e=>(T("data-v-1012cdb0"),e=e(),w(),e))((()=>V("span",null,"算一算保费",-1))),Se={class:"container"};var Pe=e(s({__name:"index",props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:"",insurerCode:"",tenantId:""})}},setup(e,{expose:s}){const a=e,t=i(null);console.log("pop data source = ",a.dataSource);const l=o({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},riskVOList:[{}],mainRiskVO:{},ifPersonalInfoSuccess:!1,trialResult:"试算前请完善投保信息"}),p=()=>{var e;null==(e=t.value)||e.validate().then((()=>{console.log("---- validate success ----")})),l.loading=!1,l.show=!0},y=()=>{l.show=!1,l.loading=!1},g=i();i({tenantId:"9991000007",productCode:"BDFZCHUN",holder:{personVO:{extInfo:{},certType:"1",name:"春春",certNo:"320682199503303592",gender:"2",birthday:"1995-03-30",mobile:"13262279098",verificationCode:"123456"}},insuredVOList:[{insuredCode:"",relationToHolder:"1",personVO:{extInfo:{hasSocialInsurance:"1"},relationToHolder:"1",certType:"1",name:"春春",certNo:"320682199503303592",gender:"2",birthday:"1995-03-30",mobile:"13262279098",verificationCode:"123456",socialFlag:"1"},productPlanVOList:[{insurerCode:"zhongan",planCode:"",riskVOList:[{amount:"6000000",chargePeriod:"year_5",copy:1,coveragePeriod:"to_68",paymentFrequency:"2",riskCategory:4,riskCode:"CBE00CHUN",riskName:"(勿动)利益演示测试",riskId:10325,riskType:1}]}]}]});const O=()=>{var e,s;l.riskIsInsure={},null==(s=null==(e=null==a?void 0:a.dataSource)?void 0:e.insureProductRiskVOList)||s.forEach((e=>{const s=a.dataSource.productRiskRelationVOList.find((s=>s.collocationRiskId===e.riskId));l.riskIsInsure[e.riskCode]={selected:"2",data:null,relation:s}}))},C=D.exports.debounce((()=>{l.ifPersonalInfoSuccess&&(l.submitData.productCode=a.productInfo.productCode,l.submitData.tenantId=a.productInfo.tenantId,l.submitData.insuredVOList[0].productPlanVOList=[{insurerCode:a.productInfo.insurerCode,planCode:a.dataSource.planCode,riskVOList:l.riskVOList}],console.log(">>>数据构建<<<",l.submitData),l.trialResult="试算中...",B(l.submitData).then((e=>{l.trialResult=`${e.data.premium}元`})).finally((()=>{})),W(l.submitData).then((e=>{g.value=e.data})).finally((()=>{l.loading=!1})))}),300),R=e=>{const{holder:s,insuredVOList:a}=e;s&&(l.submitData.holder={personVO:s}),a&&a.length>0&&a.forEach(((e,s)=>{l.submitData.insuredVOList&&l.submitData.insuredVOList.length>s?l.submitData.insuredVOList[s].personVO=e.personVO:l.submitData.insuredVOList=[{personVO:e.personVO}]})),l.ifPersonalInfoSuccess=!0,console.log("投被保人的信息回传 ",l.submitData,e),C()},L=e=>{l.mainRiskVO=e,l.riskVOList.length>0&&(l.riskVOList[0]=e),console.log("标准险种的信息回传",e),C()},x=e=>{l.riskVOList=[l.mainRiskVO,...e],console.log("附加险列表数据回传",e),C()};return v((()=>{O()})),f((()=>{l.loading=!0})),n((()=>l.show),(e=>{e&&O()})),s({open:()=>{l.show=!0}}),n((()=>l.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),(s,a)=>{const i=_,o=F,n=j;return r(),d(m,null,[V("div",Re,[u(i,{type:"primary",onClick:a[0]||(a[0]=e=>c(l).show=!0)},{default:I((()=>[b("立即投保")])),_:1})]),u(n,{class:"com-trial-wrap",style:{height:"80%"},show:c(l).show,closeable:!1,onClose:y},{default:I((()=>[V("div",Le,[V("div",xe,[_e,u(o,{name:"cross",onClick:a[1]||(a[1]=e=>c(l).show=!1)})]),V("div",Se,[u(Ce,{"data-source":g.value},null,8,["data-source"]),e.dataSource.productFactor?(r(),k(c(X),{key:0,ref:"personalInfoRef",modelValue:c(l).userData,"onUpdate:modelValue":a[2]||(a[2]=e=>c(l).userData=e),"product-factor":e.dataSource.productFactor,onTrailChange:R},null,8,["modelValue","product-factor"])):h("",!0),u(N,{ref_key:"insureInfosRef",ref:t,"origin-data":e.dataSource.insureProductRiskVOList[0],"product-factor":e.dataSource.productFactor,onTrialChange:L},null,8,["origin-data","product-factor"]),u(K,{"data-source":e.dataSource,"show-main-risk":!1,onTrialChange:x},null,8,["data-source"])]),u(z,{"is-share":!1,premium:100,"loading-text":c(l).trialResult,"plan-code":"todo计划的code","payment-frequency":"guaranteeObj.paymentFrequency","tenant-product-detail":"tenantProductDetail",onClick:p},{default:I((()=>[b("立即投保")])),_:1},8,["loading-text","payment-frequency"])])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-1012cdb0"]]);export{Pe as default};
