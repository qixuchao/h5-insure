import{_ as e,d as a,a as s,r as i,J as t,E as o,cd as l,an as r,c as n,h as d,f as u,g as c,F as m,i as p,e as k,aE as f,G as v,w as I,k as h,y as g,A as V,j as y,n as b,t as O,a4 as C,bB as R,a7 as L,V as x,B as _,bE as S,bF as P,X as F,Y as T,b4 as j,a8 as w}from"./index-444bee7b.js";import{l as D}from"./ProAddress.vue_vue_type_style_index_0_scoped_true_lang-7bfb215c.js";import"./index-cff08ce5.js";import{I as N}from"./index-de2ade35.js";import{c as E,t as q,_ as U}from"./index-8d253aa4.js";import{S as M}from"./index-f7c9f5d4.js";import{p as B,f as W}from"./trial-4d2cd1a2.js";import{_ as z}from"./TrialButton-a52e8098.js";import{_ as A}from"./index-69012796.js";import{S as H,_ as $}from"./box-title-0955c3cf.js";import{_ as G}from"./index-fa43feea.js";import{T as J}from"./Table-1544a407.js";import"./pdfh5-008ca364.js";import"./cloneDeep-aaa98338.js";import"./keysIn-b3061da8.js";import"./isObjectLike-d00d103b.js";import"./index-2a48c3bb.js";import"./empty-ae586b6c.js";import"./echarts-5af64754.js";var X=e(a({__name:"PersonalInfo",props:{productFactor:{default:()=>({})},modelValue:{default:()=>({})}},emits:["update:modelValue","trailChange"],setup(e,{expose:a,emit:f}){const v=e,{query:{insurerCode:I}={}}=s(),h=i(null),g=i(null),V=t({validated:!1,holder:{personVO:{},schema:[],trialFactorCodes:[],config:{occupation:{dictCode:E(I)}}},insured:{schema:[],trialFactorCodes:[],config:{occupation:{dictCode:E(I)}},insuredVOList:[{personVO:{}}]}}),y=o((()=>l(V.holder.schema)!==l(V.insured.schema))),b=()=>{var e,a;const s=null==(e=g.value)?void 0:e.map((e=>null==e?void 0:e.validate()));return Promise.all([null==(a=h.value)?void 0:a.validate(),...s])};return r((()=>v.productFactor),(()=>{const[e,a]=q(v.productFactor,!0);Object.assign(V.holder,e),Object.assign(V.insured,a)}),{deep:!0,immediate:!0}),r([()=>V.holder.personVO,()=>V.insured.insuredVOList],(()=>{const e={holder:V.holder.personVO,insuredVOList:V.insured.insuredVOList};f("update:modelValue",e),(()=>{const e=!!l(V.holder.trialFactorCodes)&&V.holder.trialFactorCodes.some((e=>{const a=V.holder.personVO[e];return D.exports.isNil(a)||""===a})),a=!!l(V.insured.trialFactorCodes)&&V.insured.trialFactorCodes.some((e=>V.insured.insuredVOList.some((a=>{const s=a.personVO[e];return D.exports.isNil(s)||""===s}))));return e||a})()||b().then((()=>{V.validated=!0,f("trailChange",e)})).catch((()=>{V.validated=!1}))}),{deep:!0}),a({validate:b}),(e,a)=>(n(),d(m,null,[u(c(U),{ref_key:"holderInfoRef",ref:h,title:c(y)?"":"投保人信息",class:"trail-personal-info",model:c(V).holder.personVO,schema:c(V).holder.schema,config:c(V).holder.config},null,8,["title","model","schema","config"]),(n(!0),d(m,null,p(c(V).insured.insuredVOList,((e,a)=>(n(),k(c(U),{ref_for:!0,ref_key:"insuredFormRef",ref:g,key:a,class:"trail-personal-info",title:c(y)?"":"被保人信息",model:e.personVO,schema:c(V).insured.schema,config:c(V).insured.config},null,8,["title","model","schema","config"])))),128))],64))}}),[["__scopeId","data-v-a2c06736"]]);const Y={key:0},Z={key:0,class:"risk2-field"};var K=e(a({__name:"index",props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0}},emits:["trialChange"],setup(e,{emit:a}){const s=e;console.log("pop data source = ",s.dataSource);const i=t({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[]}),o=e=>{const a=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&a.push({...e}),[]))),a},l=(e,t)=>{i.riskIsInsure[t].data=e;const o=[...i.disabledRiskInfo];s.dataSource.insureProductRiskVOList.forEach((e=>{if(1!==e.mainRiskFlag){const a=i.riskIsInsure[e.riskId];a.data&&Object.keys(a.data).length>0&&!a.isDisabled&&o.push(a.data)}})),a("trialChange",o)};return f((()=>{(()=>{i.riskIsInsure={},i.disabledRiskInfo=[];let e=null;s.dataSource.insureProductRiskVOList.forEach((a=>{const t=1!==a.mainRiskFlag?s.dataSource.productRiskRelationVOList.find((e=>e.collocationRiskId===a.riskId)):{};1===a.mainRiskFlag&&(e=a),i.riskIsInsure[a.riskId]={selected:"2",data:null,relation:t,isMust:!1}})),e&&s.dataSource.productRiskRelationVOList.filter((a=>a.riskId===e.riskId)).forEach((e=>{var a,t,l,r,n,d,u,c,m,p,k;if(2===e.collocationType){i.riskIsInsure[e.collocationRiskId].selected="1",i.riskIsInsure[e.collocationRiskId].isMust=!0;const f=s.dataSource.insureProductRiskVOList.find((a=>e.collocationRiskId===a.riskId));if(f&&1!==f.factorDisPlayFlag&&f.riskLiabilityInfoVOList.every((e=>1!==e.showFlag))){i.riskIsInsure[e.collocationRiskId].isDisabled=!0;const s={riskCategory:f.riskCategory,riskCode:f.riskCode,riskName:f.riskName,riskId:f.riskId,riskType:f.riskType,mainRiskId:f.mainRiskId,mainRiskCode:f.mainRiskCode,liabilityVOList:o(f)};s.chargePeriod=(null==(a=null==f?void 0:f.paymentPeriodValueList)?void 0:a.length)>0&&(null==f?void 0:f.paymentPeriodValueList[0].code),s.coveragePeriod=(null==(t=null==f?void 0:f.insurancePeriodValueList)?void 0:t.length)>0&&(null==f?void 0:f.insurancePeriodValueList[0].code),s.paymentFrequency=(null==(l=null==f?void 0:f.paymentFrequencyList)?void 0:l.length)>0&&(null==f?void 0:f.paymentFrequencyList[0].code);let v=0;1===f.amountPremiumConfigVO.displayType?v=(null==(r=null==f?void 0:f.amountPremiumConfigVO)?void 0:r.minStepValue)>0?null==(n=null==f?void 0:f.amountPremiumConfigVO)?void 0:n.minStepValue:0:3===f.amountPremiumConfigVO.displayType&&2===f.amountPremiumConfigVO.requireCopies?v=(null==(u=null==(d=null==f?void 0:f.amountPremiumConfigVO)?void 0:d.displayValues)?void 0:u.length)>0?null==(c=null==f?void 0:f.amountPremiumConfigVO)?void 0:c.displayValues[0].value:0:3===f.amountPremiumConfigVO.displayType&&1===f.amountPremiumConfigVO.requireCopies?(v=(null==(p=null==(m=null==f?void 0:f.amountPremiumConfigVO)?void 0:m.displayValues)?void 0:p.length)>0?null==(k=null==f?void 0:f.amountPremiumConfigVO)?void 0:k.displayValues[0].value:0,s.copy=f.amountPremiumConfigVO.minCopiesValue):2===f.amountPremiumConfigVO.displayType&&(s.copy=f.amountPremiumConfigVO.minCopiesValue),1===f.amountPremiumConfigVO.saleMethod?s.amount=v:s.premium=v,i.disabledRiskInfo.push(s)}}3===e.collocationType&&(i.riskIsInsure[e.collocationRiskId].selected="2",i.riskIsInsure[e.collocationRiskId].isMust=!0)}))})()})),v((()=>{i.loading=!0})),r((()=>i.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),(a,t)=>{const o=M,r=g;return n(!0),d(m,null,p(e.dataSource.insureProductRiskVOList,(a=>(n(),d(m,{key:a.riskCode},[(!e.showMainRisk&&1!==a.mainRiskFlag||e.showMainRisk)&&c(i).riskIsInsure[a.riskId].relation?(n(),d("div",Y,[u(r,{modelValue:c(i).riskIsInsure[a.riskId].selected,"onUpdate:modelValue":e=>c(i).riskIsInsure[a.riskId].selected=e,label:a.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:I((()=>[u(o,{modelValue:c(i).riskIsInsure[a.riskId].selected,"onUpdate:modelValue":e=>c(i).riskIsInsure[a.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"26px",disabled:c(i).riskIsInsure[a.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>{return t=e,o=a,s.dataSource.productRiskRelationVOList.forEach((e=>{1!==e.collocationType&&(o.riskId===e.riskId?(i.riskIsInsure[o.riskId]&&i.riskIsInsure[o.riskId].selected,2===e.collocationType&&i.riskIsInsure[e.riskId]&&(i.riskIsInsure[e.riskId].selected=t),3===e.collocationType&&i.riskIsInsure[e.collocationRiskId]&&(i.riskIsInsure[e.collocationRiskId].selected="1"===t?"2":"1")):o.riskId===e.collocationRiskId&&3===e.collocationType&&i.riskIsInsure[e.riskId]&&(i.riskIsInsure[e.riskId].selected="1"===t?"2":"1"))})),"2"===t&&l({},o.riskId),void console.log(i.riskIsInsure);var t,o}},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===c(i).riskIsInsure[a.riskId].selected?(n(),d("div",Z,[u(N,{modelValue:c(i).riskIsInsure[a.riskId].data,"onUpdate:modelValue":e=>c(i).riskIsInsure[a.riskId].data=e,"origin-data":a,"product-factor":e.dataSource.productFactor,onTrialChange:e=>l(e,a.riskId)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","onTrialChange"])])):h("",!0)])):h("",!0)],64)))),128)}}}),[["__scopeId","data-v-665c45b8"]]);const Q={class:"benefit-table"},ee=a({__name:"Table",props:{dataSource:null},setup(e){const a=e,s=o((()=>{const e=a.dataSource.headers.length,s=12*a.dataSource.headers.join("").length+20*a.dataSource.headers.length;return a.dataSource.headers.map(((a,i)=>{const t=s>320?12*a.length+20:Math.max(12*a.length+20,320/e);return console.log("totalWordWidth:",s,"titleWidth:",t,"word-width:",12*a.length+20),{title:a,key:`header_${i}`,fixed:i<2,minWidth:t}}))})),i=o((()=>a.dataSource.dataList.map((e=>{const a={};return e.forEach(((e,s)=>{a[`header_${s}`]=e})),a}))));return v((()=>{})),(e,a)=>(n(),d("div",Q,[u(J,{"top-height":400,columns:c(s),data:c(i),"is-clone":!0},null,8,["columns","data"])]))}});const ae=e=>(F("data-v-018858fb"),e=e(),T(),e),se={key:0,class:"benefit-container"},ie={key:0,class:"benefit"},te=ae((()=>y("div",{class:"line"},null,-1))),oe={class:"box-title box-title-chart"},le=ae((()=>y("img",{class:"tl",src:$,alt:""},null,-1))),re=ae((()=>y("img",{class:"transform-z180 tr",src:$,alt:""},null,-1))),ne={key:0},de={class:"box"},ue={class:"box-title"},ce=ae((()=>y("img",{class:"tl",src:$,alt:""},null,-1))),me=ae((()=>y("img",{class:"transform-z180 tr",src:$,alt:""},null,-1))),pe={class:"box-price"},ke={class:"text1"},fe={class:"text2"},ve={key:1},Ie={key:2,style:{width:"100%, minWidth: 338px"}},he={class:"slider"},ge={style:{flex:"1",margin:"0px 5px"}},Ve={class:"custom-button"},ye=ae((()=>y("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),be={class:"btn-two"},Oe={key:1};var Ce=e(a({__name:"index",props:{dataSource:{default:()=>[{}]},showTypeList:{default:()=>["1"]}},setup(e){const a=e,s="1",t="2",o="3",l=i(0),f=i(0),v=i(0),g=i(),F=i(0),T=i("3"),j=i(),w=e=>{if(!(null==e?void 0:e.benefitRiskResultVOList))return;const a=null==e?void 0:e.benefitRiskResultVOList[l.value];f.value=a.ageBegin+1,F.value=a.ageBegin+1,v.value=a.ageEnd},D=()=>{var e,s,i,t,o;const r=null==(s=null==(e=a.dataSource)?void 0:e.benefitRiskResultVOList)?void 0:s[l.value];j.value=null==(t=null==(i=a.dataSource)?void 0:i.benefitRiskResultVOList)?void 0:t[l.value].benefitRiskTableResultVOList[0];const{a:n,year:d}=((e,a)=>{const s=[],i=[];for(let t=e,o=0;t<=a;t++,o++)s.push(t.toString()),i.push(o+1);return{a:s,year:i}})(f.value,v.value),u={index:n.indexOf(F.value.toString()),age:n,year:d,result:null==(o=null==r?void 0:r.benefitRiskItemResultVOList)?void 0:o[0]};g.value=u},N=()=>{F.value>v.value-1||(F.value+=1,D())},E=()=>{F.value>f.value&&(F.value-=1,D())},q=e=>{l.value=e.name,w(a.dataSource),D()};return r((()=>a.dataSource),(e=>{e&&(w(e),D())}),{deep:!0,immediate:!0}),r(F,(()=>{D()})),(i,r)=>{const w=x,D=H,U=_,M=S,B=P,W=A;return e.dataSource.benefitRiskResultVOList?(n(),d("div",se,[u(B,{active:c(l),onClickTab:q},{default:I((()=>{var e;return[(n(!0),d(m,null,p(null==(e=a.dataSource)?void 0:e.benefitRiskResultVOList,((e,a)=>(n(),k(M,{key:a,name:a,title:e.riskName},{default:I((()=>{var e,i,x,_,S,P,q,M,B,W,z,A,H,$,J,X;return[a==c(l)?(n(),d("div",ie,[te,V(y("p",oe,[le,b(" 保单年度"),y("span",null,O(null==(x=null==(e=c(g))?void 0:e.year)?void 0:x[null==(i=c(g))?void 0:i.index]),1),b("年度，被保人"),y("span",null,O(null==(P=null==(_=c(g))?void 0:_.age)?void 0:P[null==(S=c(g))?void 0:S.index]),1),b("岁时 "),re],512),[[C,c(T)===t]]),c(T)===o?(n(),d("div",ne,[y("div",de,[y("p",ue,[ce,b(" 保单年度"),y("span",null,O(null==(B=null==(q=c(g))?void 0:q.year)?void 0:B[null==(M=c(g))?void 0:M.index]),1),b("年度，被保人"),y("span",null,O(null==(A=null==(W=c(g))?void 0:W.age)?void 0:A[null==(z=c(g))?void 0:z.index]),1),b("岁时 "),me]),y("div",pe,[(n(!0),d(m,null,p(null==($=null==(H=c(g))?void 0:H.result)?void 0:$.headers,((e,a)=>{var s,i,t,o,l;return n(),d("div",{key:a,style:{width:"33%"}},[y("p",ke,O(c(R)(Number(null==(l=null==(o=null==(i=null==(s=c(g))?void 0:s.result)?void 0:i.dataList)?void 0:o[null==(t=c(g))?void 0:t.index])?void 0:l[a]))),1),y("p",fe,O(e)+"(元）",1)])})),128))])])])):h("",!0),c(T)===s?(n(),d("div",ve,[u(ee,{"data-source":c(j)},null,8,["data-source"])])):h("",!0),c(T)==t?(n(),d("div",Ie,[u(G,{min:c(f),max:c(v),current:c(F),data:null==(X=null==(J=c(g))?void 0:J.result)?void 0:X.benefitRiskItemList},null,8,["min","max","current","data"])])):h("",!0),y("div",he,[y("div",{class:"opt lf",onClick:E},[u(w,{name:"minus"})]),y("div",ge,[c(f)?(n(),k(D,{key:0,modelValue:c(F),"onUpdate:modelValue":r[0]||(r[0]=e=>L(F)?F.value=e:null),min:c(f),max:c(v),"bar-height":"8px"},{button:I((()=>[y("div",Ve,O(c(F))+" 岁",1)])),_:1},8,["modelValue","min","max"])):h("",!0)]),y("div",{class:"opt rg",onClick:N},[u(w,{name:"plus"})])]),ye,y("div",be,[u(U,{round:"",plain:c(T)!==o,type:"primary",class:"btn",onClick:r[1]||(r[1]=e=>T.value=o)},{default:I((()=>[b("图表展示")])),_:1},8,["plain"]),u(U,{round:"",plain:c(T)!==t,type:"primary",class:"btn",onClick:r[2]||(r[2]=e=>T.value=t)},{default:I((()=>[b("趋势展示")])),_:1},8,["plain"]),u(U,{round:"",plain:c(T)!==s,type:"primary",class:"btn",onClick:r[3]||(r[3]=e=>T.value=s)},{default:I((()=>[b("表格展示")])),_:1},8,["plain"])])])):h("",!0)]})),_:2},1032,["name","title"])))),128))]})),_:1},8,["active"])])):(n(),d("div",Oe,[u(W,{title:"利益演示配置错误~","empty-class":"empty-select"})]))}}}),[["__scopeId","data-v-018858fb"]]);const Re={class:"trial-button"},Le={class:"com-body"},xe={class:"header"},_e=(e=>(F("data-v-61039358"),e=e(),T(),e))((()=>y("span",null,"算一算保费",-1))),Se={class:"container"};var Pe=e(a({__name:"index",props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:"",insurerCode:"",tenantId:""})}},setup(e,{expose:a}){const s=e,o="试算中...",l=i(null);console.log("pop data source = ",s.dataSource);const p=t({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},riskVOList:[{}],mainRiskVO:{},ifPersonalInfoSuccess:!1,trialResult:o}),g=()=>{var e;null==(e=l.value)||e.validate().then((()=>{console.log("---- validate success ----")})),p.loading=!1,p.show=!0},V=()=>{p.show=!1,p.loading=!1},O=i();i({tenantId:"9991000007",productCode:"BDFZCHUN",holder:{personVO:{extInfo:{},certType:"1",name:"春春",certNo:"320682199503303592",gender:"2",birthday:"1995-03-30",mobile:"13262279098",verificationCode:"123456"}},insuredVOList:[{insuredCode:"",relationToHolder:"1",personVO:{extInfo:{hasSocialInsurance:"1"},relationToHolder:"1",certType:"1",name:"春春",certNo:"320682199503303592",gender:"2",birthday:"1995-03-30",mobile:"13262279098",verificationCode:"123456",socialFlag:"1"},productPlanVOList:[{insurerCode:"zhongan",planCode:"",riskVOList:[{amount:"6000000",chargePeriod:"year_5",copy:1,coveragePeriod:"to_68",paymentFrequency:"2",riskCategory:4,riskCode:"CBE00CHUN",riskName:"(勿动)利益演示测试",riskId:10325,riskType:1}]}]}]});const C=()=>{p.riskIsInsure={},s.dataSource.insureProductRiskVOList.forEach((e=>{const a=s.dataSource.productRiskRelationVOList.find((a=>a.collocationRiskId===e.riskId));p.riskIsInsure[e.riskCode]={selected:"2",data:null,relation:a}}))},R=D.exports.debounce((()=>{p.ifPersonalInfoSuccess&&(p.submitData.productCode=s.productInfo.productCode,p.submitData.tenantId=s.productInfo.tenantId,p.submitData.insuredVOList[0].productPlanVOList=[{insurerCode:s.productInfo.insurerCode,planCode:s.dataSource.planCode,riskVOList:p.riskVOList}],console.log(">>>数据构建<<<",p.submitData),p.trialResult=o,B(p.submitData).then((e=>{p.trialResult=`${e.data.premium}元`})).finally((()=>{})),W(p.submitData).then((e=>{O.value=e.data})).finally((()=>{p.loading=!1})))}),300),L=e=>{const{holder:a,insuredVOList:s}=e;a&&(p.submitData.holder={personVO:a}),s&&s.length>0&&s.forEach(((e,a)=>{p.submitData.insuredVOList&&p.submitData.insuredVOList.length>a?p.submitData.insuredVOList[a].personVO=e.personVO:p.submitData.insuredVOList=[{personVO:e.personVO}]})),p.ifPersonalInfoSuccess=!0,console.log("投被保人的信息回传 ",p.submitData,e),R()},x=e=>{p.mainRiskVO=e,p.riskVOList.length>0&&(p.riskVOList[0]=e),console.log("标准险种的信息回传",e),R()},S=e=>{p.riskVOList=[p.mainRiskVO,...e],console.log("附加险列表数据回传",e),R()};return f((()=>{C()})),v((()=>{p.loading=!0})),r((()=>p.show),(e=>{e&&C()})),a({open:()=>{p.show=!0}}),r((()=>p.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),(a,s)=>{const i=_,t=j,o=w;return n(),d(m,null,[y("div",Re,[u(i,{type:"primary",onClick:s[0]||(s[0]=e=>c(p).show=!0)},{default:I((()=>[b("立即投保")])),_:1})]),u(o,{class:"com-trial-wrap",style:{height:"620px"},show:c(p).show,closeable:!1,onClose:V},{default:I((()=>[y("div",Le,[y("div",xe,[_e,u(t,{name:"cross",onClick:s[1]||(s[1]=e=>c(p).show=!1)})]),y("div",Se,[u(Ce,{"data-source":O.value},null,8,["data-source"]),e.dataSource.productFactor?(n(),k(c(X),{key:0,ref:"personalInfoRef",modelValue:c(p).userData,"onUpdate:modelValue":s[2]||(s[2]=e=>c(p).userData=e),"product-factor":e.dataSource.productFactor,onTrailChange:L},null,8,["modelValue","product-factor"])):h("",!0),u(N,{ref_key:"insureInfosRef",ref:l,"origin-data":e.dataSource.insureProductRiskVOList[0],"product-factor":e.dataSource.productFactor,onTrialChange:x},null,8,["origin-data","product-factor"]),u(K,{"data-source":e.dataSource,"show-main-risk":!1,onTrialChange:S},null,8,["data-source"])]),u(z,{"is-share":!1,premium:100,"loading-text":c(p).trialResult,"plan-code":"todo计划的code","payment-frequency":"guaranteeObj.paymentFrequency","tenant-product-detail":"tenantProductDetail",onClick:g},{default:I((()=>[b("立即投保")])),_:1},8,["loading-text","payment-frequency"])])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-61039358"]]);export{Pe as default};
