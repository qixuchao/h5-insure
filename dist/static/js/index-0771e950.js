import{_ as e,d as t,a,r as n,y as r,a8 as o,z as l,b as d,c as i,e as u,w as s,f as c,i as v,t as p,l as m,j as f,a0 as O,a5 as I,L,M as C,T as V,a3 as y}from"./index-822014a5.js";import{d as h}from"./debounce-d5d15d2b.js";import{r as j,t as P}from"./utils-88e7b506.js";import{p as b}from"./product-cc3a8f9e.js";import{i as D,b as R,p as g}from"./trial-87fb91d9.js";import{_ as w,n as T}from"./nextStep-6c4d328c.js";import{u as k}from"./theme-40e4e415.js";import{P as x}from"./index-c75c324f.js";import"./pdfdist-c7cc8cdf.js";import"./infoCollection-73b0c4d8.js";import"./useStorage-fdcf6901.js";import"./trial-25451fc7.js";import"./relativeTime-d3ceefb6.js";import"./validator-5a13dc82.js";import"./useDicData-a1d9a339.js";import"./core-73b12cc5.js";import"./index-e5f4cc40.js";const Y=e=>(L("data-v-49382cd0"),e=e(),C(),e),B={class:"net-sale-wrap"},E={class:"part product-name"},N=Y((()=>v("span",null,null,-1))),H=Y((()=>v("span",null,null,-1))),_={class:"part"},F={class:"footer"};var $=e(t({setup(e){const t=k(),L=a(),{productCode:C="HTEJBX",tenantId:Y="9991000001",agentCode:$="",agencyCode:M,saleChannelId:S,extraInfo:z,preview:A}=L.query,U=n(),q=n(),J=n(),W=n(),G=n(),X=n({1:[],2:[],3:[]}),K=n({}),Q=n({}),Z=n();let ee={};try{ee=JSON.parse(decodeURIComponent(z))}catch(ue){}const te=n({agencyId:M,agentCode:$,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_underWrite",pageCode:"infoCollection",templateId:null==ee?void 0:ee.templateId,iseeBizNo:Z,extraInfo:ee},orderCategory:1,saleChannelId:S,tenantId:Y,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"1",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"xinao",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:Y}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),ae=r((()=>{var e,t;return((null==(t=null==(e=J.value)?void 0:e.productRelationPlanVOList)?void 0:t.length)||0)>1})),ne=n();o([()=>G.value,()=>W.value,()=>q.value],(()=>{var e,t;const{premium:a}=G.value||{};if(a)ne.value=a&&`￥${a}元`;else{const{tenantProductInsureVO:a}=W.value||{};let n={};n=(null==(e=null==a?void 0:a.planList)?void 0:e.length)?((null==a?void 0:a.planList)||[]).find((e=>e.planCode===q.value)):null==a?void 0:a.planInsureVO;const{paymentFrequencyValue:r,premiumUnit:o}=(null==(t=null==n?void 0:n.productPremiumVOList)?void 0:t[0])||{};ne.value=r&&`￥${r}${o||"元"}`}}),{deep:!0,immediate:!0});const re=r((()=>{var e,t,a,n,r;let o=[];return o=(null==(t=null==(e=J.value)?void 0:e.productRelationPlanVOList)?void 0:t.length)?(null==(n=null==(a=J.value)?void 0:a.productRelationPlanVOList.find((e=>e.planCode===q.value)))?void 0:n.productRiskVoList)||[]:(null==(r=J.value)?void 0:r.productRiskVoList)||[],o})),oe=r((()=>{var e,t,a;const n=re.value||[];return 1===((null==(a=null==(t=null==(e=null==n?void 0:n[0])?void 0:e.riskDetailVOList)?void 0:t[0])?void 0:a.insuranceStartType)||1)?`${O(new Date).format("YYYY-MM-DD")} 00:00:00`:`${O(new Date).add(1,"day").format("YYYY-MM-DD")} 00:00:00`})),le=r((()=>{var e,t;const a=re.value||[],{insuranceEndType:n,riskInsureLimitVO:r}=(null==(t=null==(e=null==a?void 0:a[0])?void 0:e.riskDetailVOList)?void 0:t[0])||{},{insurancePeriodValueList:o}=r||{},[l,d]=((null==o?void 0:o[0])||"").split("_");return 1===n?`${O(new Date).add(d||0,l).format("YYYY-MM-DD")} 23:59:59`:n?`${O(new Date).add(d,l).format("YYYY-MM-DD")} 00:00:00`:""})),de=async()=>{var e;te.value.venderCode=null==(e=J.value)?void 0:e.productBasicInfoVO.insurerCode,te.value.orderAmount=G.value.premium,te.value.orderRealAmount=G.value.premium,te.value.commencementTime=oe.value,te.value.expiryDate=le.value,te.value.extInfo.iseeBizNo=Z.value,te.value.tenantOrderInsuredList[0].planCode=q.value,T(((e={},t={},a={})=>{var n;const r={},o=(e=[])=>{(e||[]).forEach((e=>{var t;r[e.riskCode]=e,(null==(t=e.riskPremiumDetailVOList)?void 0:t.length)&&o(e.riskPremiumDetailVOList)}))};o(t.riskPremiumDetailVOList);const l={...a},d={tenantId:Y,riskList:(null==(n=K.value)?void 0:n[0].riskVOList)||[],riskPremium:r,productId:null==e?void 0:e.productBasicInfoVO.id};return l.tenantOrderHolder.certType=l.tenantOrderHolder.certType||y.CERT,l.tenantOrderInsuredList[0].certType=l.tenantOrderInsuredList[0].certType||y.CERT,l.tenantOrderInsuredList[0].tenantOrderProductList=[{premium:G.value.premium,productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,tenantOrderRiskList:P(d)}],l})(J.value,G.value,te.value),((e,t)=>{"jumpToPage"===t&&V("提交成功")}))},ie=async()=>{var e;null==(e=U.value)||e.validateForm().then((()=>{I.confirm({title:"分享",message:`即将向客户【${te.value.tenantOrderHolder.name}】发送投保确认信息,请确认是否继续？`}).then((()=>{A||de()}))}))};o([()=>te.value.tenantOrderHolder.gender,()=>te.value.tenantOrderHolder.name,()=>te.value.tenantOrderHolder.birthday,()=>{var e;return null==(e=te.value.tenantOrderInsuredList)?void 0:e[0].name},()=>{var e;return null==(e=te.value.tenantOrderInsuredList)?void 0:e[0].gender},()=>{var e;return null==(e=te.value.tenantOrderInsuredList)?void 0:e[0].birthday},()=>q.value],h((([e,t,a,n,r,o])=>{t&&n&&r&&o&&(A||(async(e,t,a)=>{var n;const r={holder:{personVO:{certType:1,...e.tenantOrderHolder}},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",personVO:{...e,certType:1},productPlanVOList:[{insurerCode:t.productBasicInfoVO.insurerCode,planCode:q.value||0,riskVOList:j(a)}]}))),productCode:t.productBasicInfoVO.productCode,tenantId:Y},{code:o}=await R(r);if("10000"===o){const{code:e,data:t}=await g(r);"10000"===e?(G.value=t,K.value=null==(n=r.insuredVOList[0])?void 0:n.productPlanVOList):G.value=null}})(te.value,J.value,re.value))}),500));return o((()=>q.value),(()=>{X.value&&(Q.value=X.value[q.value])})),l((()=>{b({productCode:C,withInsureInfo:!0,tenantId:Y}).then((({code:e,data:t})=>{var a;"10000"===e&&(W.value=t,document.title=(null==(a=t.tenantProductInsureVO)?void 0:a.productNam)||"")})),D({productCode:C}).then((({code:e,data:t})=>{var a;"10000"===e&&(J.value=t,X.value=t.planFactor,(null==(a=t.productRelationPlanVOList)?void 0:a.length)&&(q.value=t.productRelationPlanVOList[0].planCode),t.productFactor?Q.value=t.productFactor:t.planFactor&&(Q.value=t.planFactor[q.value]))})),setTimeout((async()=>{Z.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const n=d("ProRadioButton"),r=d("ProCard"),o=d("ProCell"),l=d("ProPageWrap"),O=d("van-config-provider");return i(),u(O,{"theme-vars":m(t)},{default:s((()=>[c(l,null,{default:s((()=>{var e,t;return[v("div",B,[v("div",E,p(null==(t=null==(e=J.value)?void 0:e.productBasicInfoVO)?void 0:t.productFullName),1),m(ae)?(i(),u(r,{key:0,"show-line":!1,title:"保障年期"},{default:s((()=>{var e;return[c(n,{modelValue:q.value,"onUpdate:modelValue":a[0]||(a[0]=e=>q.value=e),class:"radio-group",prop:{label:"planName",value:"planCode"},options:null==(e=J.value)?void 0:e.productRelationPlanVOList},null,8,["modelValue","options"])]})),_:1})):f("",!0),c(w,{ref_key:"formRef",ref:U,"title-collection":{HOLDER:"投保人",INSURER:"被保人",BENEFICIARY:"收益人"},"need-desensitize":"","form-info":te.value,"send-sms-code":()=>{},"input-align":"left","factor-object":Q.value},{holderName:s((()=>[N])),insurerName:s((()=>[H])),_:1},8,["form-info","send-sms-code","factor-object"]),v("div",_,[c(o,{title:"保费",content:ne.value},null,8,["content"]),c(o,{title:"保障期间",content:`${m(oe).split(" ")[0]}~${m(le).split(" ")[0]}`},null,8,["content"])]),v("div",F,[c(x,{shadow:!1,text:"分享用户确认投保",onClick:ie})])])]})),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-49382cd0"]]);export{$ as default};
