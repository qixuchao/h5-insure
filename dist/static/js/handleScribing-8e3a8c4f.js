import{d as e,r as a,G as t,b as l,c as s,i as n,U as i,a4 as r,a0 as c,$ as o,e as u,w as d,f as p,g as v,a6 as f,j as m,ag as g,T as b,af as h,bW as x,bX as y,B as k,a as _,u as w}from"./index-a248c81d.js";import{S as C}from"./index-fd39041b.js";import{s as S}from"./scribing-e982e686.js";const A={class:"com-handle-scribing"},V={class:"sign-container-wrap"},j={class:"scribing-text"},T={class:"sign-wrap"},q={class:"sign-list"},I={class:"operate-bar"},U={class:"btns"},$=e({name:"handleScribing"});var E=g(e({...$,props:{text:{default:""},modelValue:{default:()=>[]},signAccount:{default:2}},emits:["onSubmit","onCancel"],setup(e,{emit:g}){const _=e,w=a(0),S=a(),$=t((()=>{if(_.text&&_.text.length>=_.signAccount){const e=[];let a=0;for(let t=0;t<=_.text.length;t++)!t||t%_.signAccount||(a+=1),_.text[t]&&(e[a]?e[a]+=_.text[t]:e[a]=_.text[t]);return e}return[""]})),E=a([]);a("");const N=()=>{if(w.value===$.value.length-1)return;w.value,_.signAccount;$.value[w.value].length;let e="";$.value.forEach(((a,t)=>{t===w.value&&a.split("").forEach(((a,l)=>{E.value[t+l]||(e="请抄录当前页面文字")}))})),e?b({message:e,teleport:".com-handle-scribing"}):S.value&&(w.value+=1,S.value.swipeTo(w.value))},O=()=>{0!==w.value&&S.value&&(w.value-=1,S.value.swipeTo(w.value))},P=()=>{g("onCancel")},R=()=>{const e=E.value.map(((e,a)=>({position:a+1,content:_.text[a],image:e})));g("onSubmit",e)};return(e,a)=>{const t=h,g=x,b=y,_=k,B=C;return l(),s("div",A,[n("div",V,[n("p",j,[(l(!0),s(i,null,r(e.text,((a,t)=>(l(),s("span",{key:t,class:c(`text-item ${w.value*e.signAccount>t?"activity":""} `)},o(a),3)))),128))]),n("div",T,[u(b,{ref_key:"swipeRef",ref:S,loop:!1,"initial-swipe":0,"show-indicators":!1,vertical:"",touchable:!1},{default:d((()=>[(l(!0),s(i,null,r(p($),((a,c)=>(l(),v(g,{key:c},{default:d((()=>[n("div",q,[(l(!0),s(i,null,r(a,((a,n)=>(l(),s("div",{key:n+c+c,class:"sign-item"},[(l(),v(t,f({ref_for:!0,ref:"signRef",key:c+c+n,modelValue:E.value[c+c+n],"onUpdate:modelValue":e=>E.value[c+c+n]=e,placeholder:a},e.$attrs),null,16,["modelValue","onUpdate:modelValue","placeholder"]))])))),128))])])),_:2},1024)))),128))])),_:1},512)]),n("div",I,[n("div",U,[u(B,null,{default:d((()=>[u(_,{plain:"",hairline:"",type:"primary",class:"btn",onClick:O},{default:d((()=>[m("上一页")])),_:1}),u(_,{plain:"",hairline:"",type:"primary",class:"btn",onClick:N},{default:d((()=>[m("下一页")])),_:1}),u(_,{plain:"",hairline:"",type:"primary",class:"btn",onClick:P},{default:d((()=>[m("取消")])),_:1}),u(_,{type:"primary",class:"btn",onClick:R},{default:d((()=>[m("保存")])),_:1})])),_:1})])])])])}}}),[["__scopeId","data-v-11418f8c"]]);const N={class:"handle-scribing-wrap"},O=e({name:"handleScribingPage"}),P=e({...O,setup(e){const a=_(),t=w(),{orderNo:n,text:i,tenantId:r}=t.query,c=()=>{a.back()},o=e=>{S({orderNo:n,tenantId:r,riskTranscriptionList:e}).then((({code:e,data:l})=>{"10000"===e&&a.replace({path:"scribingPreview",query:t.query})}))};return(e,a)=>(l(),s("div",N,[u(E,{text:p(i),closeable:"","has-bg":"",onOnCancel:c,onOnSubmit:o},null,8,["text"])]))}});export{P as default};
