var Y=Object.defineProperty,B=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var R=(e,r,t)=>r in e?Y(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,h=(e,r)=>{for(var t in r||(r={}))q.call(r,t)&&R(e,t,r[t]);if(E)for(var t of E(r))w.call(r,t)&&R(e,t,r[t]);return e},T=(e,r)=>B(e,$(r));import{d as _}from"./vendor-17026bfd.js";import{I as J,f as K}from"./infoCollection-192ba138.js";import{b as z,a as X,R as P,h as b}from"./trial-9eb05d43.js";import{I as c,C as I,H as u,a2 as G}from"./index-3edccef1.js";const j=e=>{const{tenantId:r,riskList:t,riskPremium:i,productId:a}=e;return t.map(n=>{var d;return{tenantId:r,amountUnit:1,annuityDrawFrequency:n.annuityDrawDate,annuityDrawType:n.annuityDrawType,paymentFrequency:n.paymentFrequency,paymentPeriod:n.chargePeriod.split("_")[1],paymentPeriodType:z[n.chargePeriod.split("_")[0]],insurancePeriodType:X[n.coveragePeriod==="to_life"?"to_life":n.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+n.coveragePeriod.split("_")[1])?0:n.coveragePeriod.split("_")[1],riskCode:n.riskCode,riskType:n.riskType,extInfo:{riskId:n.riskId,copy:n.copy},initialPremium:(d=i[n.riskCode])==null?void 0:d.premium,liabilityDetails:n.liabilityVOList.map(l=>({liabilityCode:l.liabilityCode,liabilityName:l.liabilityName,refundMethod:l.liabilityAttributeValue})),productId:a,currantAmount:3e4,initAmount:3e4}})},C=(e,r,t=[],i=K.YEAR)=>{const a=e.filter(s=>{try{return s.extraInfo?JSON.parse(s.extraInfo).packageCode?!!t.includes(s.id):!0:!1}catch{return!1}}),n=a.find(s=>s.riskType===P.MAIN_RISK);return a.map(s=>{const{riskInsureLimitVO:d,riskCategory:l,id:o,riskType:p,riskName:y,riskCode:f,extraInfo:x,riskLiabilityInfoVOList:M,riskCalcMethodInfoVO:A}=s,{insurancePeriodType:Q,insurancePeriodValueList:N,paymentFrequencyList:Z,paymentPeriodValueList:g,paymentPeriodType:W,annuityDrawFrequencyList:O,annuityDrawValueList:L,insurancePeriodRule:H,paymentPeriodRule:F}=d,{fixedAmount:U,minCopy:v}=A,m={amount:U,riskCode:f,riskId:o,riskName:y,paymentFrequency:i,extraInfo:x,chargePeriod:g==null?void 0:g[0],annuityDrawDate:L==null?void 0:L[0],riskType:p,annuityDrawFrequency:O==null?void 0:O[0],copy:v,coveragePeriod:N==null?void 0:N[0],insuredCode:r==null?void 0:r.insurerCode,liabilityVOList:M.filter(k=>k.optionalFlag===1&&k.liabilityCode!=="FXG086"),riskCategory:l};return p===P.MAIN_RISK?m:(H===b.ONE_YEAR&&(m.coveragePeriod="year_1"),F===b.ONE_YEAR&&(m.chargePeriod="year_1"),T(h({},m),{mainRiskId:n==null?void 0:n.id,mainRiskCode:n==null?void 0:n.riskCode}))})},ae=e=>{var t,i,a;return{orderAmount:e.premium,tenantId:e.tenantId,venderCode:(t=e.detail)==null?void 0:t.insurerCode,applicationNo:e.applicationNo,policyNo:e.policyNo,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:e.orderCategory,orderStatus:e.orderStatus,orderTopStatus:e.orderTopStatus,tenantOrderHolder:{tenantId:e.tenantId,name:e.holder.name,certNo:e.holder.certNo,certType:I.CERT,mobile:e.holder.mobile,birthday:c(e.holder.certNo),gender:u(e.holder.certNo),extInfo:{hasSocialInsurance:e.holder.socialFlag}},extInfo:{extraInfo:{renewalDK:e.renewalDK,paymentMethod:e.paymentMethod,successJumpUrl:e.successJumpUrl},iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{tenantId:e.tenantId,relationToHolder:e.insured.relationToHolder,certNo:e.insured.certNo,certType:I.CERT,name:e.insured.name,birthday:c(e.insured.certNo),gender:u(e.insured.certNo),extInfo:{hasSocialInsurance:e.insured.socialFlag},tenantOrderProductList:[{tenantId:e.tenantId,productCode:(i=e.detail)==null?void 0:i.productCode,productName:(a=e.detail)==null?void 0:a.productName,premium:e.premium,tenantOrderRiskList:e.tenantOrderRiskList}]}]}},D=e=>{if(!e)return 0;const[r,t]=e.split("_");return r==="day"?parseInt(t,10):parseInt(t,10)*365},V=(e,r,t)=>{const i=D(e),a=D(r);return console.log(i,a,t),i<=t&&a>=t},se=e=>{const{riskCode:r,liabilityCode:t,age:i,sex:a}=e;return r==="7Y7"&&t==="FXG086"?a===G.FEMALE:!0},S=(e,r,t=i=>!0)=>{const i=_().diff(c(r),"day"),a=u(r),n=[];return e.forEach(s=>{const{riskDetailVOList:d}=s,l=d.map(o=>{const{maxHolderAge:p,minHolderAge:y}=o.riskInsureLimitVO;return V(y,p,i)?(o.riskLiabilityInfoVOList=o.riskLiabilityInfoVOList.filter(f=>t({riskCode:o.riskCode,liabilityCode:f.liabilityCode,age:i,sex:a})),o):null});n.push({riskDetailVOList:l.filter(o=>!!(o&&o.riskLiabilityInfoVOList.length>0))})}),n},oe=(e,r=!1,t=i=>!0)=>{var n,s,d;let i=[];if(r)i=C((s=(n=S(e.insureDetail.productRiskVoList,e.insured.certNo,t))==null?void 0:n[0])==null?void 0:s.riskDetailVOList,e.productDetail,[],e.paymentFrequency);else{const l=S(e.insureDetail.productRiskVoList,e.insured.certNo,t);console.log("result",l),i=l.map(o=>C(o.riskDetailVOList,e.productDetail,e.packageRiskIdList,e.paymentFrequency))}return{calcData:{holder:{personVO:{birthday:c(e.holder.certNo),certType:I.CERT,certNo:e.holder.certNo,gender:Number(u(e.holder.certNo)),mobile:e.holder.mobile,name:e.holder.name,socialFlag:e.holder.socialFlag}},insuredVOList:[{insuredCode:(d=e.productDetail)==null?void 0:d.insurerCode,relationToHolder:e.insured.relationToHolder,personVO:{birthday:c(e.insured.certNo),certType:I.CERT,certNo:e.insured.certNo,gender:Number(u(e.insured.certNo)),name:e.insured.name,socialFlag:e.insured.socialFlag},productPlanVOList:[{riskVOList:i.flat()}]}],productCode:e.productDetail.productCode,tenantId:e.tenantId},riskVOList:i.flat()}},de=e=>{var i;const{orderDetail:r}=e;return console.log(e,"slslsl"),{agencyId:r.agencyId,venderCode:r.venderCode,applicationNo:r.applicationNo,orderDataSource:r.orderDataSource,policyNo:r.policyNo,commencementTime:r.commencementTime,orderNo:r.orderNo,tenantId:e.tenantId,orderAmount:e.premium,extInfo:{extraInfo:T(h({},r.extInfo.extraInfo),{successJumpUrl:e.successJumpUrl}),iseeBizNo:e.iseeBizNo},tenantOrderHolder:{tenantId:r.tenantOrderHolder.tenantId,name:r.tenantOrderHolder.name,certType:r.tenantOrderHolder.certType,certNo:r.tenantOrderHolder.certNo,mobile:r.tenantOrderHolder.mobile,birthday:r.tenantOrderHolder.birthday,gender:r.tenantOrderHolder.gender},tenantOrderInsuredList:[{premium:e.premium,tenantId:r.tenantOrderInsuredList[0].tenantId,relationToHolder:r.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:r.tenantOrderInsuredList[0].insuredBeneficiaryType,name:r.tenantOrderInsuredList[0].name,hasSocialInsurance:r.tenantOrderInsuredList[0].hasSocialInsurance,certType:r.tenantOrderInsuredList[0].certType,certNo:r.tenantOrderInsuredList[0].certNo,mobile:r.tenantOrderInsuredList[0].mobile,birthday:r.tenantOrderInsuredList[0].birthday,gender:r.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:r.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:e.productDetail.productCode,productName:e.productDetail.productName,tenantOrderRiskList:j({tenantId:e.tenantId,riskList:C(e.insureDetail.productRiskVoList[0].riskDetailVOList,e.productDetail),riskPremium:{},productId:(i=e.productDetail)==null?void 0:i.id})}]}]}},le=e=>e&&e.length?e.filter(t=>t.value===J.INSURE).map(t=>t.productRiskVoList.map(i=>i.id)).flat():[],ce=(e,r)=>!e.productRiskVoList.some(i=>{const a=i.riskInsureLimitVO.minHolderAge,n=i.riskInsureLimitVO.maxHolderAge,s=_().diff(c(r),"day");return!V(a,n,s)}),ue=e=>{let r=(Math.round(parseFloat(e.toString())*100)/100).toString();const t=r.toString().split(".");return t.length===1?(r=`${r.toString()}.00`,r):t.length>1?(t[1].length<2&&(r=`${r.toString()}0`),r):e},pe=e=>{if(typeof e=="string"){const r=e==null?void 0:e.substring(1);return e==null?void 0:e.replace(r,"**")}return e},me=e=>e==null?void 0:e.replace(/(\d{3})\d*(\d{4})/,"$1****$2"),Ie=e=>e==null?void 0:e.replace(/^(.{6})(?:\d+)(.{2})$/,"$1**********$2"),ye=e=>/^\d{6}$/.test(e);export{ae as a,ue as b,ce as c,de as d,se as e,C as f,oe as g,Ie as i,me as m,pe as n,le as o,j as t,ye as v};
