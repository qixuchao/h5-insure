import{i as e,aa as t,P as a,r as n,A as r,$ as o,k as l,l as d,m as i,n as u,p as s,t as c,B as p,L as v,C as m,x as f,G as I,D as O,a5 as L,a6 as C}from"./vendor-87894311.js";import{d as V}from"./debounce-11332b2b.js";import{r as b,t as j}from"./utils-69f3424a.js";import{p as y}from"./product-54c4302a.js";import{i as P,b as h,p as R}from"./trial-fecf4a18.js";import{_ as g}from"./index-72ed6f4e.js";import{_ as w}from"./index-881f6d78.js";import{u as B}from"./theme-b9409b06.js";import{n as N}from"./nextStep-40210eb7.js";import"./useStorage-2847e8df.js";import"./infoCollection-2a6bd55e.js";import"./trial-1ceefc83.js";import"./relativeTime-89dc646e.js";import"./useDicData-333b2a5a.js";import"./core-b714fabf.js";import"./index-e648c3c5.js";const k=e=>(L("data-v-50954d44"),e=e(),C(),e),x={class:"net-sale-wrap"},E={class:"product-name"},_=k((()=>p("span",null,null,-1))),H=k((()=>p("span",null,null,-1))),T={class:"footer-button"},A=I("分享用户确认投保");var D=w(e({setup(e){const I=B();t();const L=a(),{productCode:C="HTEJBX",tenantId:w="9991000001",orderNo:k,agentCode:D="",saleChannelId:F,from:S}=L.query,U=n(),z=n(),q=n(),G=n(),W=n(),$=n({}),J=n({agencyId:D,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_underWrite",pageCode:"infoCollection",templateId:3,iseeBizNo:""},orderCategory:1,saleUserId:F,tenantId:w,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"xinao",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:w}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),X=r((()=>{var e,t;return!!(null==(t=null==(e=q.value)?void 0:e.productRelationPlanVOList)?void 0:t.length)})),Y=r((()=>{var e,t;let{premium:a}=W.value||{};if(!a){const{tenantProductInsureVO:n}=G.value||{};let r={};r=(null==(e=null==n?void 0:n.planList)?void 0:e.length)?null==n?void 0:n.planList.find((e=>e.plaCode===z.value)):null==n?void 0:n.planInsureVO;const{paymentFrequencyValue:o,premiumUnit:l}=(null==(t=null==r?void 0:r.productPremiumVOList)?void 0:t[0])||{};a=o+l}return a||""})),K=r((()=>{var e,t,a;let n=[];return n=X.value?(null==(t=null==(e=q.value)?void 0:e.productRelationPlanVOList.find((e=>e.planCode===z.value)))?void 0:t.productRiskVoList)||[]:(null==(a=q.value)?void 0:a.productRiskVoList)||[],n}));r((()=>{var e,t,a;null==(a=null==(t=null==(e=K.value)?void 0:e[0])?void 0:t.riskDetailVOList)||a[0]}));const M=async()=>{var e;J.value.venderCode=null==(e=q.value)?void 0:e.productBasicInfoVO.insurerCode,J.value.orderAmount=W.value.premium,J.value.orderRealAmount=W.value.premium,N(((e={},t={},a={})=>{var n;const r={...a},o={tenantId:w,riskList:(null==(n=r.tenantOrderInsuredList[0])?void 0:n.tenantOrderProductList[0].riskVOList)||[],riskPremium:t,productId:null==e?void 0:e.productBasicInfoVO.id};return r.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,tenantOrderRiskList:j(o)},r})(q.value,W.value,J.value),(()=>{}))},Q=async()=>{O.confirm({title:"分享",message:`即将向客户【${J.value.tenantOrderHolder.name}】发送投保确认信息,请确认是否继续？`}).then((()=>{M()}))};o([()=>J.value.tenantOrderHolder.gender,()=>J.value.tenantOrderHolder.birthday,()=>{var e;return null==(e=J.value.tenantOrderInsuredList)?void 0:e[0].gender},()=>{var e;return null==(e=J.value.tenantOrderInsuredList)?void 0:e[0].birthday},()=>z.value],V((([e,t,a,n])=>{e&&t&&a&&n&&(async(e,t,a)=>{var n;const r={holder:{personVO:e.tenantOrderHolder},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",personVO:e,productPlanVOList:[{insurerCode:t.productBasicInfoVO.insurerCode,planCode:z.value||0,riskVOList:b(a)}]})))},{code:o}=await h(r);if("10000"===o){const{code:e,data:t}=await R(r);W.value="10000"===e?t:null}J.value.tenantOrderInsuredList[0].tenantOrderProductList=null==(n=r.insuredVOList[0])?void 0:n.productPlanVOList})(J.value,q.value,K.value)}),500));return l((()=>{(async()=>{var e;const{code:t,data:a}=await y({productCode:C,withInsureInfo:!0,tenantId:w});"10000"===t&&(G.value=a,document.title=a.productFullName||"");const{code:n,data:r}=await P({productCode:C});"10000"===n&&(q.value=r,$.value=r.productFactor,(null==(e=null==r?void 0:r.productRelationPlanVOList)?void 0:e.length)&&(z.value=r.productRelationPlanVOList[0].planCode))})(),setTimeout((async()=>{window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const a=d("ProRadioButton"),n=d("ProCard"),r=d("ProCell"),o=d("van-button"),l=d("ProPageWrap"),O=d("van-config-provider");return i(),u(O,{"theme-vars":m(I)},{default:s((()=>[c(l,null,{default:s((()=>{var e,l;return[p("div",x,[p("div",E,v(null==(l=null==(e=q.value)?void 0:e.productBasicInfoVO)?void 0:l.productFullName),1),m(X)?(i(),u(n,{key:0,title:"保障年期"},{default:s((()=>{var e;return[c(a,{modelValue:z.value,"onUpdate:modelValue":t[0]||(t[0]=e=>z.value=e),class:"radio-group",prop:{label:"planName",value:"planCode"},options:null==(e=q.value)?void 0:e.productRelationPlanVOList},null,8,["modelValue","options"])]})),_:1})):f("",!0),c(g,{ref_key:"formRef",ref:U,"title-collection":{HOLDER:"投保人",INSURER:"被保人",BENEFICIARY:"收益人"},"form-info":J.value,"send-sms-code":()=>{},"input-align":"left","factor-object":$.value},{holderName:s((()=>[_])),insurerName:s((()=>[H])),_:1},8,["form-info","send-sms-code","factor-object"]),c(r,{title:"保费",content:m(Y)},null,8,["content"]),p("div",T,[c(o,{type:"primary",block:"",onClick:Q},{default:s((()=>[A])),_:1})])])]})),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-50954d44"]]);export{D as default};
