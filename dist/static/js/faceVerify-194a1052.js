import{_ as e,d as a,i as t,h as o,j as s,k as r,l as i,m as c,o as l,p as d,w as n,a as u,u as p,b as f,v as m,ar as v,aC as y,aD as b,cM as N,dC as h,cL as I}from"./index-282e95dd.js";import{g}from"./trial-cb6dee49.js";import{u as j}from"./useOrder-018a9d30.js";import{f as C}from"./face_img-b678980a.js";import{P as T}from"./constants-b39aa53b.js";const w="/baseInsurance/short/infoPreview";const _=e=>(y("data-v-3fc5d44d"),e=e(),b(),e),q={class:"page-phone-verify"},P=_((()=>u("div",{class:"title face-title"},"人脸识别",-1))),z={class:"face-verify-img"},U=["src"],x=_((()=>u("div",{class:"face-verify-tip"},[u("div",{class:"title"},"操作时请您配合"),u("ol",null,[u("li",null,"请调亮手机屏幕亮度，确保光线充足"),u("li",null,"请保持正脸对准屏幕，确保人脸完整清晰"),u("li",null,"请确保真实本人操作")])],-1))),L={class:"footer-button"};var k=e(a({__name:"faceVerify",setup(e){const a=j(),y=t(),b=o(),{agentCode:_,tenantId:k,nextPageCode:A,templateId:E,biz_id:S,orderNo:B,objectType:M,orderCode:O}=y.query,$=s({mobile:"",verifyCode:""});s();const D=s(),V=r((()=>Array.isArray(M)?`${null==M?void 0:M[0]}`.toLocaleUpperCase():`${M}`.toLocaleUpperCase())),W=()=>{g({orderNo:O||B,tenantId:k}).then((({code:e,data:t})=>{if("10000"===e){Object.assign(a.value,t);const{holder:e,insuredList:o}=t;if("holder"===M){const{name:a,certNo:t,certType:o,id:s,mobile:r}=e;$.value.mobile=r,D.value={userName:a,certiNo:t,certType:o,objectId:s}}else{const{name:e,certNo:a,certType:t,id:s,mobile:r}=(null==o?void 0:o[0])||{};$.value.mobile=r,D.value={userName:e,certiNo:a,certType:t,objectId:s}}S&&(()=>{const{objectId:e,certType:a}=D.value,t={bizId:S,certType:a,objectId:e,objectType:V.value,orderNo:B,tenantId:k};N(t).then((({code:e,data:a})=>{"10000"===e&&"SUCCESS"===a.status&&(delete y.query.biz_id,delete y.query.nextPageCode,E===h.free?b.push({path:T.infoPreview,query:y.query}):b.push({path:w,query:y.query}))}))})()}}))},F=()=>{(()=>{const{userName:e,certiNo:a,certType:t}=D.value,o={tenantId:k,faceAuthMode:"TENCENT",callbackUrl:window.location.href,bizNo:B,userName:e,certiNo:a,certType:t};I(o).then((({code:e,data:a})=>{"10000"===e&&(window.location.href=a.originalUrl)}))})()};i((()=>{W()}));const G=s();return i((()=>{setTimeout((async()=>{G.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const t=v,o=c("ProPageWrap");return l(),d(o,null,{default:n((()=>[u("div",q,[P,u("div",z,[u("img",{src:p(C),alt:""},null,8,U)]),x,u("div",L,[f(t,{type:"primary",class:"submit-btn",onClick:F},{default:n((()=>[m("开始验证")])),_:1})])])])),_:1})}}}),[["__scopeId","data-v-3fc5d44d"]]);export{k as default};
