var t=Object.defineProperty,s=(s,e,a)=>(((s,e,a)=>{e in s?t(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a})(s,"symbol"!=typeof e?e+"":e,a),a);import{i as e,P as a,r as i,k as r,D as n,l as o,m,n as c,p as l,s as u,B as h,t as d,G as p}from"./vendor-87894311.js";import{i as b,a as v,b as f}from"./core-b714fabf.js";import"./index-e648c3c5.js";import"./index-881f6d78.js";const y=()=>{};class T{constructor(t){s(this,"params"),s(this,"time",1e3),s(this,"total",0),s(this,"timer"),this.params=this.init(t)}init(t){const s={start:t.start||y,stop:t.stop||y,number:t.number?Math.abs(t.number):0,time:t.time?Math.abs(t.time):300};return this.time=t.time,s}run(){this.timer=setTimeout(this.runTime.bind(this),this.time)}stop(){clearTimeout(this.timer),this.params.stop()}runTime(){try{this.params.start()}finally{if(this.params.number>0){if(this.total>=this.params.number)return this.params.stop(),void clearTimeout(this.timer);this.total||(this.total=1),this.total+=1}clearTimeout(this.timer)}this.timer=setTimeout(this.runTime.bind(this),this.time)}}const g={key:0,class:"result-view"},w={class:"content-box"},x=h("div",{class:"content"},"开通成功，正在为您生成保单...",-1),k=h("div",{class:"tip"},"请勿返回或退出",-1),j={key:1,class:"sign-view"},I={class:"content-box"},N=h("div",{class:"content"},"您已选择按月支付，请开通自动续费",-1),P=h("div",{class:"tip"},"确保您的保障按月生效",-1),B=p(" 前往微信开通 "),_=e({setup(t){const s=a().query,e=i(!1),p=async()=>{v(s)};let y;var _;return _={start:()=>{f({tenantId:s.tenantId,orderNo:s.orderNo}).then((t=>{const{code:e,data:a}=t;"10000"===e&&1==+a.status&&(y.stop(),window.location.href=`/baseInsurance/orderDetail?orderNo=${s.businessTradeNo||s.orderNo}&tenantId=${s.tenantId}`)})).catch()},stop:()=>{},time:1e3,number:10},y=new T(_),r((async()=>{1==+s.from_wxpay?(e.value=!0,y.run()):b&&n.alert({title:"去微信开通按月缴费",confirmButtonText:"好的，我知道了"}).then((()=>{v(s)}))})),(t,s)=>{const a=o("van-icon"),i=o("VanButton"),r=o("ProPageWrap");return m(),c(r,{"main-class":"page-sign-pay"},{default:l((()=>[e.value?(m(),u("div",g,[h("div",w,[d(a,{name:"checked",class:"large-icon"}),x,k])])):(m(),u("div",j,[h("div",I,[d(a,{name:"wechat-pay",class:"large-icon"}),N,P]),d(i,{size:"large",block:"",class:"btn-go-wx",onClick:p},{default:l((()=>[B])),_:1})]))])),_:1})}}});export{_ as default};
