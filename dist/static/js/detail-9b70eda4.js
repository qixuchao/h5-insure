import{h as e,r as t,x as a,k as l,l as n,y as o,z as i,A as r,s,Q as u,n as d,F as c,C as v,N as p,a8 as f,j as m,Z as I,m as y,I as C,E as b,T as h,a3 as j,a4 as w}from"./vendor-c1388e64.js";import{u as x}from"./theme-bc16780d.js";import{g as _,a as g,i as O}from"./trial-f17b85d9.js";import{_ as E,n as L}from"./nextStep-dcdceeec.js";import{s as N}from"./verify-d571b8e4.js";import{p as k}from"./product-e4700504.js";import{O as P,a as T}from"./order-47e0a45f.js";import{u as R,s as S}from"./core-e73d74ed.js";import{P as V}from"./index-416a7797.js";import{_ as A}from"./index-658f9c45.js";import"./infoCollection-876f3f1f.js";import"./relativeTime-9363d9e3.js";import"./useDicData-011a853e.js";import"./index-f2e553bf.js";const U={class:"sign-wrap"},H=["src"],B=v("点击签字"),D={class:"popup-body"},F={class:"sign-container-wrap"},z={class:"operate-bar"},G=i("span",null,"请投保人正楷签署您的签名:",-1),Y=v("返回"),q=v("重写"),J=v("确定签字"),Q=e({props:{option:{default:{}},modelValue:{default:""}},emits:["update:modelValue"],setup(e,{emit:v}){const p=t(!1),f=t(),m=a((()=>{let e="";return f.value&&(e=f.value.save()),e})),I=()=>{p.value=!0},y=()=>{p.value=!1},C=()=>{var e,t;null==(t=null==(e=f.value)?void 0:e.clear)||t.call(e)},b=()=>{v("update:modelValue",m.value),p.value=!1};return(e,t)=>{const a=l("van-button"),v=l("ProSign"),h=l("van-popup");return n(),o(c,null,[i("div",U,[r(m)?(n(),o("img",{key:0,class:"previewSign",src:r(m),alt:""},null,8,H)):s("",!0),u(a,{type:"primary",size:"small",onClick:I},{default:d((()=>[B])),_:1})]),u(h,{show:p.value,"onUpdate:show":t[0]||(t[0]=e=>p.value=e),position:"bottom",style:{height:"100%"}},{default:d((()=>[i("div",D,[i("div",F,[u(v,{ref_key:"signRef",ref:f},null,512),i("div",z,[G,u(a,{type:"default",onClick:y},{default:d((()=>[Y])),_:1}),u(a,{type:"default",onClick:C},{default:d((()=>[q])),_:1}),u(a,{type:"default",disabled:!r(m),onClick:b},{default:d((()=>[J])),_:1},8,["disabled"])])])])])),_:1},8,["show"])],64)}}});const W={class:"net-sale-detail-wrap"},X={class:"part"},Z={class:"product-name"},$={class:"part"},K={class:"part"},M={class:"part"},ee={class:"sign-cell"},te=(e=>(j("data-v-3cf15eaa"),e=e(),w(),e))((()=>i("div",{class:"sign-label"},"签名",-1))),ae={class:"footer-button"},le={class:"footer"};var ne=A(e({setup(e){const a=x(),v=p();f();const{orderNo:j="2022113021181894998",tenantId:w="9991000001",productCode:A="HTEJBX"}=v.query;t();const U=t({}),H=t({commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_airSignature",pageCode:"infoCollection",templateId:3,iseeBizNo:""},orderCategory:1,tenantId:w,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:w}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),B=t(!1),D=t({}),F=t(),z=t(),G=t(""),Y=t(""),q=t({}),J=async()=>{G.value?(await N("HOLDER",G.value,H.value.id,`${w}`),L(H.value)):h("请先签字")};return R(),m((()=>{(async()=>{const{code:e,data:t}=await O({productCode:A,tenantId:w});"10000"===e&&(F.value=t,U.value=t.productFactor)})(),(async()=>{const{data:e,code:t}=await k({productCode:A,tenantId:w,withInsureInfo:!0});"10000"===t&&(z.value=e)})(),(async()=>{var e;const{code:t,data:a}=await _({orderNo:j,tenantId:w});if("10000"===t&&(a.extInfo.buttonCode="EVENT_NETSALE_airSignature",H.value=a,Y.value=null==(e=a.tenantOrderInsuredList[0])?void 0:e.planCode,a.orderStatus===T.PAYING)){H.value.extInfo.redirectUrl="";const{code:e,data:t}=await g(H.value);"10000"===e&&S(t.paymentUrl)}})()})),I([()=>Y.value,()=>z.value],(()=>{var e,t,a;Y.value&&(q.value=(null==(a=((null==(t=null==(e=z.value)?void 0:e.tenantProductInsureVO)?void 0:t.planList)||[]).find((e=>e.planCode===Y.value)))?void 0:a.attachmentVOList)||[])}),{deep:!0,immediate:!0}),(e,t)=>{const v=l("ProCell"),p=l("ProCard"),f=l("van-cell"),m=l("ProPageWrap"),I=l("ProFilePreview"),h=l("ProPopup"),j=l("van-config-provider");return n(),y(j,{"theme-vars":r(a)},{default:d((()=>{var e;return[u(m,null,{default:d((()=>[i("div",W,[H.value.id?(n(),y(p,{key:0,"show-line":!1,title:"投保信息"},{default:d((()=>{var e,t,a,l,n,o;return[i("div",X,[i("div",Z,C(null==(e=F.value)?void 0:e.productBasicInfoVO.productFullName),1)]),i("div",$,[u(v,{title:"保费",content:H.value.orderAmount},null,8,["content"]),u(v,{title:"保险期限",content:null==(t=H.value.tenantOrderInsuredList[0])?void 0:t.planName},null,8,["content"]),u(v,{title:"起保日期",content:H.value.commencementTime},null,8,["content"]),u(v,{title:"终保日期",content:H.value.expiryDate},null,8,["content"]),u(v,{title:"保单状态",content:r(P)[H.value.orderStatus]},null,8,["content"])]),i("div",K,[u(v,{title:"订单编号",content:H.value.orderNo},null,8,["content"]),u(v,{title:"销售人名称",content:""}),u(v,{title:"房屋地址",content:null==(l=null==(a=H.value.tenantOrderHolder)?void 0:a.extInfo)?void 0:l.familyAddress},null,8,["content"]),u(v,{title:"燃气编号",content:null==(o=null==(n=H.value.tenantOrderInsuredList)?void 0:n[0])?void 0:o.extInfo.subjectRelatedUserId},null,8,["content"])])]})),_:1})):s("",!0),u(E,{ref:"formRef","title-collection":{HOLDER:"投保人信息",INSURER:"被保人信息",BENEFICIARY:"受益人"},"is-view":!0,"form-info":H.value,"factor-object":U.value,"input-align":"right"},null,8,["form-info","factor-object"]),u(p,{title:"阅读条款合同"},{default:d((()=>[i("div",M,[(n(!0),o(c,null,b(Object.keys(q.value),((e,t)=>(n(),y(f,{key:t,title:e,"is-link":"",onClick:t=>{return a=e,l=q.value[e],B.value=!0,void(D.value={title:a,fileContent:null==l?void 0:l[0]});var a,l}},null,8,["title","onClick"])))),128))])])),_:1}),u(p,{title:"客户签名"},{default:d((()=>[i("div",ee,[te,u(Q,{modelValue:G.value,"onUpdate:modelValue":t[0]||(t[0]=e=>G.value=e)},null,8,["modelValue"])])])),_:1}),i("div",ae,[u(V,{text:"提交",onClick:J})])])])),_:1}),u(h,{show:B.value,"onUpdate:show":t[2]||(t[2]=e=>B.value=e),class:"pre-notice-wrap",title:null==(e=D.value)?void 0:e.title,position:"bottom",style:{height:"600px"}},{default:d((()=>{var e,a;return[u(I,{content:null==(a=null==(e=D.value)?void 0:e.fileContent)?void 0:a.attachmentUri,type:"richText"},null,8,["content"]),i("div",le,[u(V,{shadow:!1,text:"关闭",onClick:t[1]||(t[1]=e=>B.value=!1)})])]})),_:1},8,["show","title"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-3cf15eaa"]]);export{ne as default};
