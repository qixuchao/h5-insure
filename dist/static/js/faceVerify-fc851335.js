import{_ as e,d as a,i as t,h as o,j as s,k as r,l,m as i,o as c,p as n,w as d,a as u,u as m,q as f,f as p,b as v,v as b,aN as y,ar as h,aC as g,aD as C,cM as j,dG as N,aQ as I,cL as x}from"./index-317fe516.js";import{g as T}from"./trial-aa1d6cf6.js";import{u as w}from"./useOrder-c2fee243.js";import{f as P}from"./face_img-b678980a.js";import{P as _}from"./constants-a91dacd0.js";import{P as q}from"./constants-b39aa53b.js";import{n as U}from"./nextStep-a99ccab9.js";import{T as A}from"./infoCollection-73b145a3.js";import E from"./index-6278a3b4.js";import"./core-5b4c0234.js";const z=e=>(g("data-v-557dc197"),e=e(),C(),e),V={class:"page-phone-verify"},k=z((()=>u("div",{class:"title face-title"},"人脸识别",-1))),L={class:"face-verify-img"},M=["src"],S=z((()=>u("div",{class:"face-verify-tip"},[u("div",{class:"title"},"操作时请您配合"),u("ol",null,[u("li",null,"请调亮手机屏幕亮度，确保光线充足"),u("li",null,"请保持正脸对准屏幕，确保人脸完整清晰"),u("li",null,"请确保真实本人操作")])],-1))),B={class:"attachment"},F={class:"footer-button"};var G=e(a({__name:"faceVerify",setup(e){const a=w(),g=t(),C=o(),{agentCode:z,tenantId:G,nextPageCode:J,templateId:O,biz_id:$,orderNo:D,objectType:Q,orderCode:R}=g.query,W=s({mobile:"",verifyCode:""});s();const H=s(),K=s(),X=s([{attachmentName:"隐私政策"}]),Y=r((()=>Array.isArray(Q)?`${null==Q?void 0:Q[0]}`.toLocaleUpperCase():`${Q}`.toLocaleUpperCase())),Z=()=>{T({orderNo:R||D,tenantId:G}).then((({code:e,data:t})=>{if("10000"===e){Object.assign(a.value,t);const{holder:e,insuredList:o}=t;if("holder"===Q){const{name:a,certNo:t,certType:o,id:s,mobile:r}=e;W.value.mobile=r,H.value={userName:a,certiNo:t,certType:o,objectId:s}}else{const{name:e,certNo:a,certType:t,id:s,mobile:r}=(null==o?void 0:o[0])||{};W.value.mobile=r,H.value={userName:e,certiNo:a,certType:t,objectId:s}}$&&(()=>{const{objectId:e,certType:t}=H.value,o={bizId:$,certType:t,objectId:e,objectType:Y.value,orderNo:D,tenantId:G};j(o).then((({code:e,data:t})=>{"10000"===e&&"SUCCESS"===t.status&&(delete g.query.biz_id,delete g.query.nextPageCode,O===A.FREE?(a.value.extInfo.buttonCode=N.free.faceVerify,a.value.extInfo.pageCode="faceAuth",U(a.value,((e,a)=>{a===I.JUMP_PAGE&&C.push({path:q[e.nextPageCode],query:g.query})}))):(a.value.extInfo.buttonCode=N.short.faceVerify,a.value.extInfo.pageCode="faceAuth",U(a.value,((e,a)=>{a===I.JUMP_PAGE&&C.push({path:_[e.nextPageCode],query:g.query})}))))}))})()}}))},ee=()=>{K.value?(()=>{const{userName:e,certiNo:a,certType:t}=H.value,o={tenantId:G,faceAuthMode:"TENCENT",callbackUrl:window.location.href,bizNo:D,userName:e,certiNo:a,certType:t};x(o).then((({code:e,data:a})=>{"10000"===e&&(window.location.href=a.originalUrl)}))})():y.alert({message:"请先同意隐私政策",confirmButtonText:"我知道了"})};l((()=>{Z()}));const ae=s();return l((()=>{setTimeout((async()=>{ae.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const t=h,o=i("ProPageWrap");return c(),n(o,null,{default:d((()=>{var o;return[u("div",V,[k,u("div",L,[u("img",{src:m(P),alt:""},null,8,M)]),S,u("div",B,[(null==(o=m(X))?void 0:o.length)?(c(),n(E,{key:0,modelValue:m(K),"onUpdate:modelValue":a[0]||(a[0]=e=>f(K)?K.value=e:null),"attachment-list":m(X),"has-bg-color":!1,"is-show-radio":"","pre-text":"本人同意利安人寿采集本人人脸信息，用于向国家法规许可的验证机构进行本人身份验证。本人已仔细阅读并知晓","suffix-text":"，并同意授权。",onPreviewFile:a[1]||(a[1]=a=>e.previewFile(a))},null,8,["modelValue","attachment-list"])):p("",!0)]),u("div",F,[v(t,{type:"primary",class:"submit-btn",onClick:ee},{default:d((()=>[b("开始验证")])),_:1})])])]})),_:1})}}}),[["__scopeId","data-v-557dc197"]]);export{G as default};
