import{aG as e,d as s,r as a,bX as t,z as o,bl as l,R as r,bm as c,i as n,aL as i,aN as d,bk as u,aR as p,$ as h,bY as v,aU as m,G as g,an as f,c as C,A as y,f as k,g as b,E as P,U as L,V as w,k as x,h as _,a6 as V,L as S,a9 as I,a1 as T,bZ as j,o as M,F as U,w as D,b_ as $,a2 as q,j as N,bu as B,aA as F,B as H,bB as O,al as A,am as R,bJ as Y,aC as z,bL as G,e as E,bv as J,bK as K,ab as W,a as X,u as Z,bq as Q,b as ee,ao as se}from"./index-7c427e78.js";import{L as ae}from"./index-a09b3712.js";import{S as te}from"./index-d7d37250.js";import{P as oe}from"./index-cd09236c.js";import{e as le}from"./empty-c926d8ec.js";import{q as re,a as ce}from"./proposalList-f00c4878.js";import{u as ne}from"./createProposal-0de6d913.js";import{P as ie}from"./index-2f1fcc85.js";import{a as de}from"./trial-ba45f3de.js";import"./pdfh5-008ca364.js";const[ue,pe,he]=e("pull-refresh"),ve=["pulling","loosing","success"];const me=m(s({name:ue,props:{disabled:Boolean,modelValue:Boolean,headHeight:i(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:d,successDuration:i(500),animationDuration:i(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:s,slots:i}){let d;const m=a(),g=a(),f=t(m),C=o({status:"normal",distance:0,duration:0}),y=l(),k=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},b=()=>"loading"!==C.status&&"success"!==C.status&&!e.disabled,P=(a,t)=>{const o=+(e.pullDistance||e.headHeight);C.distance=a,C.status=t?"loading":0===a?"normal":a<o?"pulling":"loosing",s("change",{status:C.status,distance:a})},L=()=>{const{status:s}=C;return"normal"===s?"":e[`${s}Text`]||he(s)},w=()=>{const{status:e,distance:s}=C;if(i[e])return i[e]({distance:s});const a=[];return ve.includes(e)&&a.push(n("div",{class:pe("text")},[L()])),"loading"===e&&a.push(n(u,{class:pe("loading")},{default:L})),a},x=e=>{d=0===v(f.value),d&&(C.duration=0,y.start(e))},_=e=>{b()&&x(e)},V=()=>{d&&y.deltaY.value&&b()&&(C.duration=+e.animationDuration,"loosing"===C.status?(P(+e.headHeight,!0),s("update:modelValue",!0),h((()=>s("refresh")))):P(0))};return r((()=>e.modelValue),(s=>{C.duration=+e.animationDuration,s?P(+e.headHeight,!0):i.success||e.successText?(C.status="success",setTimeout((()=>{P(0)}),+e.successDuration)):P(0,!1)})),c("touchmove",(s=>{if(b()){d||x(s);const{deltaY:a}=y;y.move(s),d&&a.value>=0&&y.isVertical()&&(p(s),P((s=>{const a=+(e.pullDistance||e.headHeight);return s>a&&(s=s<2*a?a+(s-a)/2:1.5*a+(s-2*a)/4),Math.round(s)})(a.value)))}}),{target:g}),()=>{var e;const s={transitionDuration:`${C.duration}ms`,transform:C.distance?`translate3d(0,${C.distance}px, 0)`:""};return n("div",{ref:m,class:pe()},[n("div",{ref:g,class:pe("track"),style:s,onTouchstartPassive:_,onTouchend:V,onTouchcancel:V},[n("div",{class:pe("head"),style:k()},[w()]),null==(e=i.default)?void 0:e.call(i)])])}}}));const ge={class:"com-product-item"},fe={class:"content-wrap"},Ce={class:"product-image"},ye={class:"insure-name"},ke={class:"product-info"},be={class:"title"},Pe={class:"description"},Le={class:"tags"},we={key:0,class:"product-tips"};var xe=g(s({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:null},setup(e){const s=e,{productInfo:a}=f(s),t=o({checked:!1});return f(t),(s,t)=>{var o,l,r,c;const i=V;return C(),y("div",ge,[k("div",fe,[k("div",Ce,[n(i,{src:null==(o=b(a).showConfig)?void 0:o.fileUrl},null,8,["src"]),k("p",ye,P((b(a).insurerName||"").substring(0,6)),1)]),k("div",ke,[k("p",be,P(null==(l=b(a).showConfig)?void 0:l.title),1),k("p",Pe,P(null==(r=b(a).showConfig)?void 0:r.text),1),k("p",Le,[(C(!0),y(L,null,w(null==(c=b(a).showConfig)?void 0:c.tags,((e,s)=>(C(),y("span",{key:s,class:"tag"},P(e),1)))),128))])]),x(s.$slots,"checkedProduct",{},void 0,!0)]),e.errorMsg?(C(),y("span",we,P(e.errorMsg),1)):_("",!0)])}}}),[["__scopeId","data-v-001656b6"]]);const _e=["xlink:href"],Ve=s({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const s=e,a=S((()=>`#icon-${s.name}`)),t=S((()=>s.name?`svg-icon icon-${s.name}`:"svg-icon"));return(s,o)=>(C(),y("svg",I({class:b(t)},s.$attrs,{style:{color:e.color}}),[k("use",{"xlink:href":b(a)},null,8,_e)],16))}});const Se=e=>(A("data-v-72eaf171"),e=e(),R(),e),Ie={class:"com-tab-filter"},Te={class:"article-mid"},je={class:"article-tag"},Me=["onClick"],Ue=Se((()=>k("span",null,null,-1))),De={class:"popup-inner"},$e=Se((()=>k("div",{class:"popup-title"},"保险公司",-1))),qe={class:"footer-button"};var Ne=g(s({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:s}){const{isPopShow:t,openPop:l,closePop:r}=function(e=!1){const s=a(e);return{isPopShow:s,openPop:e=>{e instanceof Function&&e(),s.value=!0},closePop:e=>{s.value=!1,e instanceof Function&&e()}}}(!1),c=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:d}=f(c),u=a(""),p=()=>{d.value=[]},h=()=>{s("onSelectInsure",{selectInsureCode:d.value,selectCategory:u.value}),r()};return T((()=>{j().then((e=>{const{code:s,data:a}=e;"10000"===s&&(i.value=null==a?void 0:a.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),M((()=>{re().then((e=>{const{code:s,data:a}=e||{};"10000"===s&&F(a)&&(c.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...a])}))})),(a,o)=>{const v=H,m=O;return C(),y("div",Ie,[k("div",Te,[k("div",je,[(C(!0),y(L,null,w(b(c).productCategoryList,((e,a)=>(C(),y("div",{key:a,class:U(["tag-item",{checked:b(u)==a}]),onClick:t=>((e,a)=>{u.value=a,s("onSelectInsure",{selectInsureCode:d.value,selectCategory:u.value})})(null==e||e.productCategoryId,a)},[k("div",{class:U(["tag-out",{checked:b(u)==a}])},[k("div",{class:U(["tag-item-text",{checked:b(u)==a}])},P(e.productCategoryName),3)],2)],10,Me)))),128))]),e.filter?(C(),y("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>b(l)&&b(l)(...e))},[Ue,k("div",{class:U(["text",{"has-select-condition":b(d).length>0}])},"筛选",2),n(Ve,{name:"filter"})])):_("",!0),n(m,{show:b(t),position:"right","close-on-click-overlay":"",style:B(e.popupStyle||{width:"322px",height:"100%",padding:"0 15px"}),onClickOverlay:b(r)},{default:D((()=>[k("div",De,[$e,n($,{modelValue:b(d),"onUpdate:modelValue":o[1]||(o[1]=e=>q(d)?d.value=e:null),options:b(i)},null,8,["modelValue","options"])]),k("div",qe,[n(v,{plain:"",type:"primary",onClick:p},{default:D((()=>[N("重置")])),_:1}),n(v,{type:"primary",onClick:h},{default:D((()=>[N("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])])])}}}),[["__scopeId","data-v-72eaf171"]]);const Be={class:"com-trial-product-wrapper"},Fe={class:"container"},He=(e=>(A("data-v-73270e0c"),e=e(),R(),e))((()=>k("span",{class:"title"}," 已选产品 ",-1))),Oe={class:"popup-body"},Ae={class:"cell-title"},Re={class:"title"},Ye=s({name:"TrialProductPopup"});var ze=g(s({...Ye,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:s}){const t=e,o=a([]),l=a([]),c=a({isShow:t.isShow}),i=()=>{s("close")},d=()=>{l.value=[],s("checked",[])},u=e=>{var a,t,r;null==(r=null==(t=null==(a=null==o?void 0:o.value)?void 0:a[e])?void 0:t.toggle)||r.call(t),s("checked",l.value)};return r((()=>t.isShow),(e=>{c.value.isShow=e})),r((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(s,a)=>{const t=Y,r=z,p=K,h=G,v=O;return C(),y("div",Be,[n(v,{show:b(c).isShow,"onUpdate:show":a[1]||(a[1]=e=>b(c).isShow=e),position:"bottom",onClose:i},{default:D((()=>[k("div",Fe,[k("div",{class:"popup-header"},[k("span",{class:"clear-all",onClick:d}," 清空选项 "),He,k("span",{class:"close",onClick:i})]),k("div",Oe,[n(h,{modelValue:b(l),"onUpdate:modelValue":a[0]||(a[0]=e=>q(l)?l.value=e:null)},{default:D((()=>[n(p,{inset:""},{default:D((()=>[(C(!0),y(L,null,w(e.proposalList,(e=>(C(),E(r,{key:e.productCode,title:e.productName,onClick:s=>u(e.productCode)},{"right-icon":D((()=>[n(t,{ref_for:!0,ref:s=>b(o)[e.productCode]=s,shape:"square",name:e.productCode,onClick:J((s=>u(e.productCode)),["stop"])},null,8,["name","onClick"])])),title:D((()=>[k("div",Ae,[k("div",Re,P(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-73270e0c"]]);const Ge={class:"search-wrap"},Ee={class:"page-proposal-list"},Je={class:"check-button"},Ke={key:1,class:"van-sticky"},We={class:"add-plan"},Xe={class:"has-select-product"},Ze=(e=>(A("data-v-44eb9902"),e=e(),R(),e))((()=>k("span",{class:"icon"},null,-1))),Qe=s({name:"ProposalList"});var es=g(s({...Qe,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const s=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[]}),{searchValue:t,tagLists:l,isOpen:r,loading:c,finished:i,refreshing:d,productList:u,selectProduct:p,insurerCodeList:h,showCategory:v,productTotal:m,showFooter:g}=f(s);W();const[x,V]=W(),I=ne(),j=X(),M=Z(),{isCreateProposal:U,productCode:$}=M.query;a(U?"repeatAdd":"add");const B=()=>{ce({title:t.value,insurerCodeList:h.value,showCategory:v.value,excludeProductCodeList:s.excludeProductCodeList,pageNum:1,pageSize:999}).then((e=>{const{code:s,data:a,total:t}=e;"10000"===s&&(u.value=null==a?void 0:a.datas,m.value=t)}))},F=e=>{B()},O=e=>{const{selectInsureCode:s,selectCategory:a}=e;h.value=s,v.value=a,B()},A=()=>{d.value&&(u.value=[],d.value=!1),B(),c.value=!1,m.value===u.value.length&&(i.value=!0)},R=()=>{j.push({path:"historyProposalList"})};S((()=>{var e;const{birthday:s,gender:a}=(null==(e=I.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:s,gender:a}}));const z=S((()=>u.value.length>0)),G=S((()=>u.value.filter((e=>s.selectProduct.includes(e.productCode))))),J=({productCode:e})=>{U||j.push({path:"/proposal/createProposal",query:{productCode:e}}),s.productCode=e,s.selectProduct.includes(e)?s.selectProduct=s.selectProduct.filter((s=>s!==e)):(async(e,a)=>{const{code:t,data:o,message:l}=await de({calcProductFactorList:[{productCode:e}]});"10000"===t?(s.errorMsgMap[e]="","function"==typeof a&&a(!0)):s.errorMsgMap[e]=l})(e,(()=>{s.selectProduct.push(e)}))},K=e=>{s.selectProduct=e},re=()=>{const e=s.proposalList.filter((e=>s.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));I.setTrialData(e),j.replace({path:"/proposal/createProposal",query:{productCode:$,selectProduct:s.selectProduct}})},ue=()=>{i.value=!0,c.value=!0,A()};return Q((()=>{const{productCodeList:e=[]}=Z().query;s.selectProduct=[],s.excludeProductCodeList=e,ue()})),T((()=>{})),(e,a)=>{const o=te,l=Y,h=ae,v=me,m=H,f=ee("ProPageWrap");return C(),y(L,null,[n(f,{class:"page-proposal"},{default:D((()=>[k("div",Ge,[n(o,{modelValue:b(t),"onUpdate:modelValue":a[0]||(a[0]=e=>q(t)?t.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:F},null,8,["modelValue"]),n(Ne,{filter:b(r),"onUpdate:filter":a[1]||(a[1]=e=>q(r)?r.value=e:null),"filter-class":"filter-area",onOnSelectInsure:O},null,8,["filter"])]),b(z)?_("",!0):(C(),E(oe,{key:0,"empty-img":b(le),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),k("div",Ee,[n(v,{modelValue:b(d),"onUpdate:modelValue":a[3]||(a[3]=e=>q(d)?d.value=e:null),onRefresh:ue},{default:D((()=>[n(h,{loading:b(c),"onUpdate:loading":a[2]||(a[2]=e=>q(c)?c.value=e:null),finished:b(i),"finished-text":b(z)?"- 已经到底了哦 -":"",onLoad:A},{default:D((()=>[(C(!0),y(L,null,w(b(u),(e=>(C(),E(xe,{key:e.id,"product-info":e,"error-msg":b(s).errorMsgMap[e.productCode],onClick:s=>J(e)},se({_:2},[b(U)?{name:"checkedProduct",fn:D((()=>[k("div",Je,[n(l,{name:e.productCode,"model-value":b(p).includes(e.productCode),shape:"square"},null,8,["name","model-value"])])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),b(U)&&b(g)?(C(),y("div",Ke,[k("div",We,[k("p",{class:"has-select",onClick:a[4]||(a[4]=e=>b(V)(!b(x)))},[N(" 已选"),k("span",Xe,P(b(p).length),1),N("款产品 "),Ze]),n(m,{type:"primary",disabled:!b(p).length,onClick:re},{default:D((()=>[N("添加计划书")])),_:1},8,["disabled"])])])):_("",!0),n(ze,{modelValue:b(p),"onUpdate:modelValue":a[5]||(a[5]=e=>q(p)?p.value=e:null),"proposal-list":b(G),"is-show":b(x),onClose:a[6]||(a[6]=e=>b(V)(!1)),onChecked:K},null,8,["modelValue","proposal-list","is-show"])])),_:1}),b(U)?_("",!0):(C(),E(ie,{key:0,"button-image":b("/static/png/lishijihuashu-b6958e78.png"),onClick:R},null,8,["button-image"]))],64)}}}),[["__scopeId","data-v-44eb9902"]]);export{es as default};
