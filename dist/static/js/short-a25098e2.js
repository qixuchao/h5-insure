import{d as xe,h as Z,r as I,$ as Q,A as F,R as Pe,k as z,ag as be,m as n,s,B as o,F as q,C as t,H as K,M as oe,L,x as B,n as J,G as de,t as g,p as H,I as Te,a5 as fe,a6 as _e,Z as Be,_ as st,N as Ce,U as lt,T as it,aa as rt,P as ut,l as ct,j as dt,D as pt}from"./vendor-902054a7.js";import{_ as ee,e as Ae,i as me,a7 as mt,C as he,I as Re,K as vt,a1 as ft}from"./index-119d3d1b.js";import{C as ye,k as le,l as re,m as _t,S as we,R as Ee,g as yt}from"./infoCollection-38f1bb04.js";import{i as ht,n as Se,p as Pt,g as Ct}from"./trial-4f6d7812.js";import{p as It}from"./product-82161a47.js";import{o as Me,r as Dt,t as gt}from"./utils-adfd1f2b.js";import{t as qe,u as Ot}from"./theme-fdbb0f53.js";import{B as $e}from"./index-fc6ced02.js";import{P as Vt}from"./index-d3e7ac0c.js";import{L as kt}from"./loading-1c9c1d7b.js";import{_ as Ft,a as Lt}from"./index-2cf87c30.js";import{u as wt}from"./useDicData-1e94cf5b.js";import{P as Et}from"./index-dd1b45c1.js";import{_ as St}from"./index-3b947fcf.js";import"./useStorage-601cda4c.js";import"./trial-a74a8f2e.js";import"./check-detail-c292a89b.js";import"./relativeTime-cdc592a9.js";const ve=(d,O="YYYY-MM-DD")=>xe(d).format(O),ie=(d,O=0,i="day",l="YYYY-MM-DD")=>xe(d).add(O,i).format(l);const $t=d=>(fe("data-v-9a094e48"),d=d(),_e(),d),Nt={class:"guarantee-list"},xt=$t(()=>o("span",null,"\u4FDD\u969C\u8BA1\u5212",-1)),bt={key:0,class:"picture-payment-content"},Tt=["onClick"],Bt=["src"],At=["src"],Rt={key:1,class:"plan-list"},Mt=["onClick"],qt={key:2,class:"feerate-view"},Ut={class:"guarantee-detail"},Yt={key:0,class:"plan-list"},Ht=["onClick"],jt={key:1},Gt={class:"extinfo-info-list"},zt={class:"content"},Wt=Z({props:{dataSource:{type:Object,default:()=>{}},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:5},activePlanCode:{type:String,default:""},isMultiplePlan:{type:Boolean,default:!1}},emits:["update-active-plan"],setup(d,{emit:O}){var a;const i=d,l=I((a=i.dataSource)==null?void 0:a.planList),m=I(i.activePlanCode);Q([()=>i.dataSource,()=>i.activePlanCode],()=>{var e;i.isMultiplePlan&&(l.value=(e=i.dataSource)==null?void 0:e.planList)},{immediate:!0});const V=I([]),y=I([]),r=I(),A=F(()=>i.isMultiplePlan?i.dataSource.planList.map(e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null).filter(e=>!!e):[]);Q([()=>i.dataSource,()=>i.activePlanCode],()=>{var e,c,P,w;if(m.value=i.activePlanCode,!i.isMultiplePlan)V.value=(e=i.dataSource)==null?void 0:e.planInsureVO.guaranteeItemVOS,y.value=(c=i.dataSource)==null?void 0:c.planInsureVO.extInfoVOList,r.value=(P=i.dataSource)==null?void 0:P.planInsureVO.productPremiumVOList[0];else if(l.value&&l.value.length>0){let M=0;const te=l.value.findIndex(E=>E.planCode===m.value);te>-1&&(M=te),V.value=l.value[M].guaranteeItemVOS,y.value=l.value[M].extInfoVOList,r.value=(w=l.value[M])==null?void 0:w.productPremiumVOList[0]}},{immediate:!0,deep:!0});const $=F(()=>{var e;return((e=i.dataSource)==null?void 0:e.rateUri)||""}),v=F(()=>!!(r.value&&r.value.paymentFrequencyValue&&r.value.premiumUnit&&!!$)),[_,N]=Pe(!1),R=F(()=>{var e;return!V.value||!((e=V.value)!=null&&e.length)?!1:V.value.length>i.count?i.isShowClose?!0:!_.value:!1}),j=()=>{N()},G=F(()=>{var e;return!V.value||!((e=V.value)!=null&&e.length)?[]:V.value.length<=i.count||_.value?V.value:V.value.slice(0,i.count)}),U=e=>{m.value=e,O("update-active-plan",e)},b=I(!1),x=()=>{b.value=!0},p=()=>{Me({fileType:"pdf",feeFileUri:$.value})};return(e,c)=>{var te,E;const P=z("ProCell"),w=z("ProPopup"),M=be("dompurify-html");return n(),s(q,null,[o("div",Nt,[o("div",{class:"header"},[xt,o("span",{onClick:x},"\u67E5\u770B\u8BE6\u60C5")]),d.isMultiplePlan?(n(),s(q,{key:0},[t(A).length>0?(n(),s("div",bt,[(n(!0),s(q,null,K(t(A),C=>(n(),s("div",{key:C.planCode,class:oe("picture-payment-item"),onClick:W=>U(C.planCode)},[m.value==C.planCode?(n(),s("img",{key:0,src:C.selectedPic},null,8,Bt)):(n(),s("img",{key:1,src:C.unSelectedPic},null,8,At))],8,Tt))),128))])):(n(),s("div",Rt,[(n(!0),s(q,null,K(l.value,(C,W)=>(n(),s("div",{key:`${C.planCode}_${W}`,class:oe(`plan-list-item ${C.planCode===m.value?"plan-list-item-active":""}`),onClick:ne=>U(C.planCode)},[o("span",null,L(C.planName),1)],10,Mt))),128))]))],64)):B("",!0),(n(!0),s(q,null,K(t(G),(C,W)=>(n(),J(P,{key:W,class:"guarantee-item",title:C.title,content:C.desc,border:!1},null,8,["title","content"]))),128)),t(R)?(n(),s("div",{key:1,class:"show-more",onClick:j},[de(L(t(_)?"\u6536\u8D77":"\u67E5\u770B\u66F4\u591A")+" ",1),g(Ae,{name:"down",class:oe(["icon",{showMore:t(_)}])},null,8,["class"])])):B("",!0),t(v)?(n(),s("div",qt,[o("span",null,L(`${((te=r.value)==null?void 0:te.paymentFrequencyValue)||""}${((E=r.value)==null?void 0:E.premiumUnit)||""}`),1),t($)?(n(),s("span",{key:0,onClick:p},"\u67E5\u770B\u4FDD\u8D39")):B("",!0)])):B("",!0)]),g(me),g(w,{show:b.value,"onUpdate:show":c[0]||(c[0]=C=>b.value=C),title:"\u4FDD\u969C\u8BE6\u60C5",class:"guarantee-popup"},{default:H(()=>[o("div",Ut,[d.isMultiplePlan?(n(),s("div",Yt,[(n(!0),s(q,null,K(l.value,(C,W)=>(n(),s("div",{key:`${C.planCode}_${W}`,class:oe(`plan-list-item ${C.planCode===m.value?"plan-list-item-active":""}`),onClick:ne=>U(C.planCode)},[o("span",null,L(C.planName),1)],10,Ht))),128))])):B("",!0),y.value&&y.value.length>0?(n(),s("div",jt,[o("div",Gt,[(n(!0),s(q,null,K(y.value,(C,W)=>(n(),J(P,{key:W,title:C.name,content:C.description,border:!1,size:"small"},null,8,["title","content"]))),128))]),g(me)])):B("",!0),(n(!0),s(q,null,K(V.value,(C,W)=>(n(),s("div",{key:W,class:"guarantee-item"},[g(P,{title:C.title,content:C.desc,border:!1,size:"small"},null,8,["title","content"]),Te(o("div",zt,null,512),[[M,C.content]])]))),128))])]),_:1},8,["show"])],64)}}});var Qt=ee(Wt,[["__scopeId","data-v-9a094e48"]]);const Kt={class:"com-custom-card"},Jt={class:"title"},Xt=Z({props:{title:{type:String,required:!0}},setup(d){return(O,i)=>(n(),s("div",Kt,[o("div",Jt,L(d.title),1),o("div",null,[Be(O.$slots,"default",{},void 0,!0)])]))}});var Ne=ee(Xt,[["__scopeId","data-v-059c21ee"]]);const Zt={class:"question"},en={class:"title"},tn=Z({props:{name:{type:String,default:""},question:{type:String,default:""},answer:{type:String,default:""}},setup(d){return(O,i)=>{const l=z("ProSvg"),m=z("van-collapse-item");return n(),J(m,{name:d.name,class:"com-question-item"},{title:H(()=>[o("div",Zt,[g(l,{name:"question"}),o("div",en,L(d.question),1)])]),default:H(()=>[de(" "+L(d.answer),1)]),_:1},8,["name"])}}});var nn=ee(tn,[["__scopeId","data-v-0d7ea124"]]);const an={class:"com-question"},on=Z({props:{list:{type:Array,default:()=>[]}},setup(d){const O=d,[i,l]=Pe(!1),m=I([]),V=()=>{l()},y=F(()=>O.list.length<=4||i.value?O.list:O.list.slice(0,4));return(r,A)=>{const $=z("van-collapse");return n(),s("div",an,[g($,{modelValue:m.value,"onUpdate:modelValue":A[0]||(A[0]=v=>m.value=v)},{default:H(()=>[(n(!0),s(q,null,K(t(y),(v,_)=>(n(),J(nn,{key:_,name:_.toString(),question:v.title,answer:v.desc},null,8,["name","question","answer"]))),128))]),_:1},8,["modelValue"]),d.list.length>4?(n(),s("div",{key:0,class:"show-more",onClick:V},[de(L(t(i)?"\u6536\u8D77":"\u5C55\u5F00")+" ",1),g(Ae,{name:"down",class:oe(["icon",{showMore:t(i)}])},null,8,["class"])])):B("",!0)])}}});var sn=ee(on,[["__scopeId","data-v-1b7e97e9"]]);const ln={class:"spec"},rn=["src"],un={key:1,class:"spec"},cn=["src"],dn=Z({props:{isCheck:{type:Boolean,default:!1},url:{type:String,default:""},detail:{type:Object,default:()=>{}}},setup(d,{expose:O}){const i=d,l=I(),m=I([{title:"\u4EA7\u54C1\u4EAE\u70B9",slotName:"tab1"},{title:"\u7406\u8D54\u8BF4\u660E",slotName:"tab2"},{title:"\u6211\u8981\u6295\u4FDD",slotName:"tab3"}]),V=F(()=>{var v,_,N,R;return((_=(v=i.detail)==null?void 0:v.tenantProductInsureVO)==null?void 0:_.spec)&&((R=(N=i.detail)==null?void 0:N.tenantProductInsureVO)==null?void 0:R.spec.length)>0}),y=F(()=>{var _,N,R,j,G,U,b,x,p,a,e,c,P,w;const v=(N=(_=i.detail)==null?void 0:_.tenantProductInsureVO)==null?void 0:N.settlementProcessVO.settlementProcessType;return!!(v===ye.WORD&&((G=(j=(R=i.detail)==null?void 0:R.tenantProductInsureVO)==null?void 0:j.settlementProcessVO)==null?void 0:G.settlementProcessList)&&((x=(b=(U=i.detail)==null?void 0:U.tenantProductInsureVO)==null?void 0:b.settlementProcessVO)==null?void 0:x.settlementProcessList.length)>0||v===ye.IMAGE&&((e=(a=(p=i.detail)==null?void 0:p.tenantProductInsureVO)==null?void 0:a.settlementProcessVO)==null?void 0:e.settlementProcessPicList)&&((w=(P=(c=i.detail)==null?void 0:c.tenantProductInsureVO)==null?void 0:P.settlementProcessVO)==null?void 0:w.settlementProcessPicList.length)>0)}),r=F(()=>{var v,_,N,R;return((_=(v=i.detail)==null?void 0:v.tenantProductInsureVO)==null?void 0:_.questionList)&&((R=(N=i.detail)==null?void 0:N.tenantProductInsureVO)==null?void 0:R.questionList.length)>0}),A=F(()=>{let v=[...m.value];return V.value||(v=v.filter(_=>_.slotName!=="tab1")),!y.value&&!r.value&&(v=v.filter(_=>_.slotName!=="tab2")),v});return O({handleClickTab:()=>{var v;return(v=l.value)==null?void 0:v.handleClickTab}}),(v,_)=>(n(),J(mt,{ref_key:"scrollRef",ref:l,class:"tabs",list:t(A),sticky:"",scrollspy:""},st({tab3:H(()=>[Be(v.$slots,"form",{},void 0,!0)]),_:2},[t(V)?{name:"tab1",fn:H(()=>{var N,R;return[o("div",ln,[(n(!0),s(q,null,K(((R=(N=i.detail)==null?void 0:N.tenantProductInsureVO)==null?void 0:R.spec)||[],(j,G)=>(n(),s("img",{key:G,src:j,class:"detail-img"},null,8,rn))),128)),g(me)])]})}:void 0,t(y)||t(r)?{name:"tab2",fn:H(()=>{var N,R,j,G,U;return[t(y)?(n(),s(q,{key:0},[((R=(N=i.detail)==null?void 0:N.tenantProductInsureVO)==null?void 0:R.settlementProcessVO.settlementProcessType)===t(ye).WORD?(n(),J(Ne,{key:0,title:"\u7406\u8D54\u6D41\u7A0B"},{default:H(()=>{var b,x,p;return[g(Vt,{list:(p=(x=(b=i.detail)==null?void 0:b.tenantProductInsureVO)==null?void 0:x.settlementProcessVO)==null?void 0:p.settlementProcessList},null,8,["list"])]}),_:1})):(n(),s("div",un,[(n(!0),s(q,null,K(((U=(G=(j=i.detail)==null?void 0:j.tenantProductInsureVO)==null?void 0:G.settlementProcessVO)==null?void 0:U.settlementProcessPicList)||[],(b,x)=>(n(),s("img",{key:x,src:b,class:"detail-img"},null,8,cn))),128))])),g(me)],64)):B("",!0),t(r)?(n(),s(q,{key:1},[g(Ne,{title:"\u5E38\u89C1\u95EE\u9898"},{default:H(()=>{var b,x;return[g(sn,{list:(x=(b=i.detail)==null?void 0:b.tenantProductInsureVO)==null?void 0:x.questionList},null,8,["list"])]}),_:1}),g(me)],64)):B("",!0)]})}:void 0]),1032,["list"]))}});var pn=ee(dn,[["__scopeId","data-v-4383aeea"]]);const mn=d=>(fe("data-v-ead4d7ae"),d=d(),_e(),d),vn={key:0,class:"page-waiting"},fn=["src"],_n=mn(()=>o("div",{class:"tips"},[o("p",null,"\u652F\u4ED8\u6210\u529F\uFF0C\u627F\u4FDD\u4E2D...")],-1)),yn=Z({props:{isShow:{type:Boolean,default:()=>{}}},setup(d){const O=d;return Q(()=>O.isShow,i=>{i?document.body.style.overflow="hidden":document.body.style.overflow="inherit"}),(i,l)=>O.isShow?(n(),s("div",vn,[o("img",{class:"loading",src:t(kt)},null,8,fn),_n])):B("",!0)}});var hn=ee(yn,[["__scopeId","data-v-ead4d7ae"]]);const Ie=d=>(fe("data-v-1a769194"),d=d(),_e(),d),Pn={class:"com-period-cell"},Cn={key:0,class:"custom-cell check-btn-cell"},In=Ie(()=>o("div",{class:"cell-label"},"\u4FDD\u969C\u671F\u95F4",-1)),Dn={class:"cell-content"},gn=Ie(()=>o("div",{class:"cell-label"},"\u751F\u6548\u65E5\u671F",-1)),On={class:"cell-content"},Vn={key:2,class:"custom-cell common-cell"},kn=Ie(()=>o("div",{class:"cell-label"},"\u4FDD\u969C\u671F\u9650",-1)),Fn={class:"cell-content"},Ln=Z({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(d,{expose:O,emit:i}){const l=d;I({});const m=(p,a)=>p==="year"?`${a}\u5E74`:p==="month"?`${a}\u6708`:p==="day"?`${a}\u65E5`:a,V=I(new Date),y=wt("RISK_INSURANCE_PERIOD"),r=Ce({formInfo:l.formInfo});Q(()=>r.formInfo.insuranceStartDate,p=>{p&&typeof p=="string"&&(V.value=new Date(p))});const A=I(),$=I([]);Q([()=>l.insureDetail,()=>r.formInfo.activePlanCode],()=>{var p;if(r.formInfo.insurancePeriodValue="",r.formInfo.insuranceStartDate="",r.formInfo.insuranceEndDate="",l.insureDetail)if(l.insureDetail.productRelationPlanVOList&&l.insureDetail.productRelationPlanVOList.length>0){let a=0;const e=l.insureDetail.productRelationPlanVOList.findIndex(w=>w.planCode===r.formInfo.activePlanCode);e>-1&&(a=e);const P=(((p=l.insureDetail.productRelationPlanVOList[a])==null?void 0:p.productRiskVoList[0].riskDetailVOList)||[]).find(w=>w.riskType===1);P&&(A.value=P)}else{const e=(l.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find(c=>c.riskType===1);e&&(A.value=e)}},{deep:!0,immediate:!0}),Q([()=>A.value,()=>y.value],()=>{$.value=[],Array.isArray(y.value)&&y.value.length>1&&A.value&&($.value=(A.value.riskInsureLimitVO.insurancePeriodValueList||[]).map(p=>{const a=y.value.find(e=>e.value===p);return a?{label:a.name,value:a.value}:null}).filter(p=>!!p)),$.value.length>0&&(r.formInfo.insurancePeriodValue=$.value[0].value)},{deep:!0,immediate:!0});const v=F(()=>{var p,a;return(p=A.value)!=null&&p.riskInsureLimitVO.guaranteeStartDate?String((a=A.value)==null?void 0:a.riskInsureLimitVO.guaranteeStartDate):le.CURRENT_DAY}),[_,N]=Pe(!1),R=()=>{N(!0)},j=new Date(ie(new Date,1,"day")),G=F(()=>{var p;if(v.value===le.CUSTOM_DAY){const a=(p=A.value)==null?void 0:p.riskInsureLimitVO.maxInsuranceDay;if(!a)return new Date;const e=ie(new Date,Number(a),"day");return new Date(e)}return new Date}),U=p=>{r.formInfo.insuranceStartDate=`${ve(p)} 00:00:00`,N(!1)},b=()=>{N(!1)},x=F(()=>{if(v.value===le.CUSTOM_DAY||!r.formInfo.insurancePeriodValue)return"";const[p,a]=r.formInfo.insurancePeriodValue.split("_");if(p!=="to"){let e=ve(new Date);if(v.value===le.NEXT_DAY)return e=ie(new Date,1,"day"),"";const c=ie(e,Number(a)-1,p);return`${e} - ${c}`}return r.formInfo.insured.certNo,""});return Q([()=>v.value,()=>x.value,()=>r.formInfo.insurancePeriodValue,()=>r.formInfo.insuranceStartDate],()=>{const[p,a]=r.formInfo.insurancePeriodValue.split("_");r.formInfo.insuranceStartDate||(v.value===le.CUSTOM_DAY?r.formInfo.insuranceStartDate=`${ie(new Date,1,"day")} 00:00:00`:v.value===le.NEXT_DAY?r.formInfo.insuranceStartDate=`${ie(new Date,1,"day")} 00:00:00`:r.formInfo.insuranceStartDate=`${ve(new Date)} 23:59:59`),p!=="to"?r.formInfo.insuranceEndDate=`${ie(r.formInfo.insuranceStartDate,Number(a)-1,p)} 23:59:59`:(r.formInfo.tenantOrderInsuredList[0].birthday,r.formInfo.tenantOrderInsuredList[0].certType===he.CERT&&r.formInfo.tenantOrderInsuredList[0].certNo&&Re(r.formInfo.tenantOrderInsuredList[0].certNo)&&vt(r.formInfo.tenantOrderInsuredList[0].certNo),a==="single"&&(r.formInfo.insuranceEndDate="9999-99-99 23:59:59"),r.formInfo.insuranceEndDate=`${ie(r.formInfo.insuranceStartDate,Number(a)-1,p)} 23:59:59`)},{immediate:!0}),O({}),(p,a)=>{const e=z("ProRadioButton"),c=z("van-config-provider"),P=z("van-datetime-picker"),w=z("ProPopup");return n(),s(q,null,[g(c,{"theme-vars":t(qe)},{default:H(()=>[o("div",Pn,[$.value.length>1?(n(),s("div",Cn,[In,o("div",Dn,[g(e,{modelValue:t(r).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=M=>t(r).formInfo.insurancePeriodValue=M),options:$.value},null,8,["modelValue","options"])])])):B("",!0),t(v)===t(le).CUSTOM_DAY?(n(),s("div",{key:1,class:"custom-cell common-cell",onClick:R},[gn,o("div",On,L(t(r).formInfo.insuranceStartDate),1)])):B("",!0),t(v)!==t(le).CUSTOM_DAY?(n(),s("div",Vn,[kn,o("div",Fn,L(t(x)),1)])):B("",!0)])]),_:1},8,["theme-vars"]),g(w,{show:t(_),"onUpdate:show":a[2]||(a[2]=M=>lt(_)?_.value=M:null),height:40,closeable:!1},{default:H(()=>[g(P,{modelValue:V.value,"onUpdate:modelValue":a[1]||(a[1]=M=>V.value=M),type:"date",title:"\u9009\u62E9\u5E74\u6708","min-date":t(j),"max-date":t(G),formatter:m,onConfirm:U,onCancel:b},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"])],64)}}});var wn=ee(Ln,[["__scopeId","data-v-1a769194"]]);const pe=d=>(fe("data-v-3c8e6e76"),d=d(),_e(),d),En={class:"com-payment-type"},Sn={class:"title"},$n={key:0,class:"picture-payment-content"},Nn=["onClick"],xn=["src"],bn=["src"],Tn={key:1,class:"custom-cell check-btn-cell"},Bn=pe(()=>o("div",{class:"cell-label"},"\u4FDD\u969C\u65B9\u6848",-1)),An={class:"cell-content"},Rn={key:0,class:"picture-payment-content"},Mn=["onClick"],qn=["src"],Un=["src"],Yn={key:1,class:"default-payment-content"},Hn=pe(()=>o("div",{class:"pay-method"},[o("span",{class:"method"},L("\u6309\u6708\u4EA4\u8D39")),o("span",{class:"acount"},L("\u517112\u671F"))],-1)),jn=[Hn],Gn=pe(()=>o("div",null,[o("div",{class:"tip"},[o("span",null,L("\u6BD4\u6309\u6708\u652F\u4ED8\u6700\u9AD8\u7701")),de(),o("span",null,"16%")]),o("div",{class:"triangle"}),o("div",{class:"pay-method"},[o("span",{class:"method"},L("\u4E00\u6B21\u4EA4\u6E05")),o("span",{class:"acount"},L("\u6BD4\u6708\u4EA4\u4FDD\u8D39\u7701\u6700\u9AD82014\u5143"))])],-1)),zn=[Gn],Wn={key:2,class:"custom-cell check-btn-cell"},Qn=pe(()=>o("div",{class:"cell-label"},"\u4EA4\u8D39\u65B9\u5F0F",-1)),Kn={class:"cell-content"},Jn={class:"custom-cell common-cell"},Xn=pe(()=>o("div",{class:"cell-label"},"\u5B9E\u4ED8\u4FDD\u8D39",-1)),Zn={class:"cell-content actual-premium"},ea={key:0,class:"feerate-explain"},ta={class:"content"},na=pe(()=>o("div",{class:"triangle-top"},null,-1)),aa=Z({props:{showConfig:{type:Object,default:()=>{}},formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premium:{type:[Number||null],default:null}},emits:["onReset","onUpdate","onVerify"],setup(d,{expose:O,emit:i}){const l=d;I({});const m=Ce({formInfo:l.formInfo}),V=I([]),y=I(),r=I(),A=F(()=>{var e;return String((e=y.value)==null?void 0:e.paymentFrequencyFlag)==="1"}),$=F(()=>{var e;return(e=r.value)==null?void 0:e.productPremiumVOList.find(c=>c.paymentFrequency===m.formInfo.paymentFrequency)}),v=F(()=>l.premium&&$.value?`${l.premium}${$.value.premiumUnit||""}`:$.value?`${$.value.paymentFrequencyValue||""}${$.value.premiumUnit||""}`:""),_=F(()=>{if(r){const{premiumExplain:e,premiumExplainViewName:c,premiumExplainUri:P}=r.value||{};return{premiumExplain:e,premiumExplainUri:P,premiumExplainViewName:c}}return null});Q(()=>l.configDetail,()=>{var e;l.isMultiplePlan&&l.configDetail&&(V.value=(e=l.configDetail.tenantProductInsureVO)==null?void 0:e.planList)},{immediate:!0,deep:!0}),Q([()=>l.configDetail,()=>l.isMultiplePlan,()=>m.formInfo.activePlanCode],()=>{if(l.configDetail)if(l.isMultiplePlan){let e=0;const c=l.configDetail.tenantProductInsureVO.planList.findIndex(P=>P.planCode===m.formInfo.activePlanCode);c>-1&&(e=c),y.value=l.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,r.value=l.configDetail.tenantProductInsureVO.planList[e]}else y.value=l.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,r.value=l.configDetail.tenantProductInsureVO.planInsureVO},{deep:!0,immediate:!0});const N=F(()=>{var e;return y.value&&y.value.paymentFrequency?(((e=y.value.paymentFrequency)==null?void 0:e.split(","))||[]).length>1:!1}),R=F(()=>{var e;if(y.value){const c=((e=y.value.paymentFrequency)==null?void 0:e.split(","))||[];if(c.length===1)return m.formInfo.paymentFrequency=y.value.paymentFrequency,!1;if(c.length===2&&c.filter(P=>![re.SINGLE,re.MONTH].includes(P)).length<1)return!0}return!1}),j=F(()=>{var e;return y.value?(e=y.value.paymentFrequencyList||[])==null?void 0:e.map(c=>({...c,paymentFrequency:c.skinValue})):[]}),G=F(()=>j.value.length>0),U=F(()=>l.isMultiplePlan?l.configDetail.tenantProductInsureVO.planList.map(e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null).filter(e=>!!e):[]),b=F(()=>{var e,c;if(y.value){const P=((e=y.value.paymentFrequency)==null?void 0:e.split(","))||[];return P.length===1&&(console.log("paymentFrequencyList======",P),m.formInfo.paymentFrequency=P[0]),(c=P||[])==null?void 0:c.map(w=>({label:_t[w],value:w}))}return[]}),x=e=>{console.log("type",e),m.formInfo.paymentFrequency=e},p=e=>{m.formInfo.activePlanCode=e},a=()=>{var e,c;if(!((e=_.value)!=null&&e.premiumExplainUri)){it("\u65E0\u8D39\u7387\u6587\u4EF6\uFF01");return}Me({fileType:"pdf",fileUri:(c=_.value)==null?void 0:c.premiumExplainUri})};return O({}),(e,c)=>{const P=z("ProRadioButton"),w=z("templat"),M=z("ProDivider"),te=z("van-config-provider");return n(),J(te,{"theme-vars":t(qe)},{default:H(()=>[o("div",En,[o("div",Sn,L(t(N)?"\u4EA4\u8D39\u65B9\u5F0F":"\u4FDD\u969C\u8BA1\u5212"),1),d.isMultiplePlan?(n(),s(q,{key:0},[t(U).length>0?(n(),s("div",$n,[(n(!0),s(q,null,K(t(U),E=>(n(),s("div",{key:E.planCode,class:oe("picture-payment-item"),onClick:C=>p(E.planCode)},[t(m).formInfo.activePlanCode==E.planCode?(n(),s("img",{key:0,src:E.selectedPic},null,8,xn)):(n(),s("img",{key:1,src:E.unSelectedPic},null,8,bn))],8,Nn))),128))])):(n(),s("div",Tn,[Bn,o("div",An,[g(P,{modelValue:t(m).formInfo.activePlanCode,"onUpdate:modelValue":c[0]||(c[0]=E=>t(m).formInfo.activePlanCode=E),options:V.value,prop:{value:"planCode",label:"planName"}},null,8,["modelValue","options"])])]))],64)):B("",!0),t(A)?(n(),J(w,{key:1},{default:H(()=>[t(G)?(n(),s("div",Rn,[(n(!0),s(q,null,K(t(j),E=>(n(),s("div",{key:E.paymentFrequency,class:oe("picture-payment-item"),onClick:C=>x(E.paymentFrequency)},[t(m).formInfo.paymentFrequency==E.paymentFrequency?(n(),s("img",{key:0,src:E.selectedPic},null,8,qn)):(n(),s("img",{key:1,src:E.unSelectedPic},null,8,Un))],8,Mn))),128))])):t(R)?(n(),s("div",Yn,[o("div",{class:oe(`com-payment-type-item ${t(m).formInfo.paymentFrequency==t(re).MONTH?"active":""}`),onClick:c[1]||(c[1]=E=>x(t(re).MONTH))},jn,2),o("div",{class:oe(`com-payment-type-item ${t(m).formInfo.paymentFrequency==t(re).SINGLE?"active":""}`),onClick:c[2]||(c[2]=E=>x(t(re).SINGLE))},zn,2)])):t(b).length>1?(n(),s("div",Wn,[Qn,o("div",Kn,[g(P,{modelValue:t(m).formInfo.paymentFrequency,"onUpdate:modelValue":c[3]||(c[3]=E=>t(m).formInfo.paymentFrequency=E),options:t(b)},null,8,["modelValue","options"])])])):B("",!0)]),_:1})):B("",!0),g(wn,{"form-info":t(m).formInfo,"insure-detail":d.insureDetail,"config-detail":d.configDetail},null,8,["form-info","insure-detail","config-detail"]),t($)&&t($).premiumUnit?(n(),s(q,{key:2},[o("div",Jn,[Xn,o("div",Zn,L(t(v)),1)]),t(_)&&t(_).premiumExplain&&t(_).premiumExplainViewName?(n(),s("div",ea,[o("div",ta,[na,o("div",null,[o("span",null,L(t(_).premiumExplain||""),1),o("span",{class:"file-name",onClick:a},"\u300A"+L(t(_).premiumExplainViewName||"")+"\u300B",1)])])])):B("",!0)],64)):B("",!0)]),g(M)]),_:1},8,["theme-vars"])}}});var oa=ee(aa,[["__scopeId","data-v-3c8e6e76"]]);const sa={class:"inscribedContent-content"},la={class:"content"},ia=Z({props:{inscribedContent:{type:String,default:""}},setup(d){const O=d,i=I();return Q(()=>O.inscribedContent,l=>{l?i.value=l.replaceAll(`
`,"<br />"):i.value=""},{immediate:!0,deep:!0}),(l,m)=>{const V=be("dompurify-html");return n(),s("div",sa,[Te(o("div",la,null,512),[[V,i.value]])])}}});var ra=ee(ia,[["__scopeId","data-v-702b2de2"]]);const ua={class:"com-attachment-list"},ca=["onClick"],da=Z({props:{preText:{type:String,default:""},attachementList:{type:Object,default:()=>{}}},emits:["preview-file"],setup(d,{emit:O}){const i=l=>{O("preview-file",l)};return(l,m)=>(n(),s("div",ua,[o("span",null,L(d.preText),1),(n(!0),s(q,null,K(d.attachementList||[],(V,y)=>(n(),s("span",{key:y,class:"attachment-item",onClick:r=>i(y)}," \u300A"+L(V.attachmentName)+"\u300B ",9,ca))),128))]))}});var pa=ee(da,[["__scopeId","data-v-17da129e"]]);const ma={class:"page-internet-product-detail"},va={class:"info"},fa={class:"footer-area"},_a={class:"price"},ya=de(" \u603B\u4FDD\u8D39"),ha=de(L("\u7ACB\u5373\u6295\u4FDD")),Pa=Z({setup(d){var Ve,ke;const O=Ot();rt();const i=ut(),{productCode:l="BWYL2021",tenantId:m,orderNo:V,phoneNo:y,agentCode:r="",saleChannelId:A,paymentMethod:$,certNo:v,name:_,templateId:N,pageCode:R,from:j,extraInfo:G,insurerCode:U}=i.query;let b={};try{b=JSON.parse(decodeURIComponent(G))}catch{}const x=I(),p=I(),a=I(),e=I(),c=I(),P=I(!1),w=I(!1),M=I(!1),te=I(0),E=I(!1);I(!1);let C="";const W=I(!0),ne=Ce({holder:{certNo:v,certType:he.CERT,mobile:y,name:_,socialFlag:we.HAS},insured:{certNo:v,certType:he.CERT,name:_,socialFlag:we.HAS,relationToHolder:Ee.SELF},paymentMethod:$,renewalDK:"Y",packageProductList:[],mobileSmsCode:"",activePlanCode:"",paymentFrequency:re.MONTH,insurancePeriodValue:"",commencementTime:ve(new Date)}),S=I({tenantId:m,agencyId:r,orderCategory:1,saleUserId:A,saleChannelId:A,venderCode:U,insuranceStartDate:null,insuranceEndDate:null,activePlanCode:"",paymentFrequency:re.MONTH,insurancePeriodValue:"",commencementTime:"",tenantOrderHolder:{extInfo:{},socialFlag:"1"},tenantOrderInsuredList:[{socialFlag:"1",relationToHolder:Ee.SELF,extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{tenantId:m,productCode:(Ve=a.value)==null?void 0:Ve.productCode,productName:(ke=a.value)==null?void 0:ke.productName,premium:c.value||0}]}],extInfo:{buttonCode:"EVENT_SHORT_saveOrder",successJumpUrl:"",pageCode:"productInfo",...b},operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),ae=F(()=>{var u,h,D,f,k,T;return a.value?!!(((h=(u=a.value)==null?void 0:u.tenantProductInsureVO)==null?void 0:h.planList)&&Array.isArray((f=(D=a.value)==null?void 0:D.tenantProductInsureVO)==null?void 0:f.planList)&&((T=(k=a.value)==null?void 0:k.tenantProductInsureVO)==null?void 0:T.planList.length)>0):!1}),Ue=F(()=>{var u,h,D;if(ae.value){if(S.value.activePlanCode)return((u=e.value)==null?void 0:u.planFactor[S.value.activePlanCode])||{}}else if((h=e.value)!=null&&h.productFactor)return(D=e.value)==null?void 0:D.productFactor;return{}});Q(()=>ae.value,()=>{var u,h;ae.value&&(S.value.activePlanCode=(h=(u=a.value)==null?void 0:u.tenantProductInsureVO)==null?void 0:h.planList[0].planCode)},{immediate:!0});const De=F(()=>{var u,h,D;return ae.value?((h=(u=e.value)==null?void 0:u.productRelationPlanVOList.find(f=>f.planCode===S.value.activePlanCode))==null?void 0:h.productRiskVoList)||[]:((D=e.value)==null?void 0:D.productRiskVoList)||[]}),Ye=u=>{S.value.activePlanCode=u},He=F(()=>[]),ue=I();Q([()=>ae.value,()=>S.value.activePlanCode,()=>a.value],()=>{var D,f;let u={};if(console.log("isMultiplePlan",ae.value),ae.value){const k=(D=a.value)==null?void 0:D.tenantProductInsureVO.planList.find(T=>T.planCode===(S.value.activePlanCode||""));k&&(u=k==null?void 0:k.attachmentVOList)}else console.log("detail.value?.tenantProductInsureVO.planInsureVO",a.value),u=(f=a.value)==null?void 0:f.tenantProductInsureVO.planInsureVO.attachmentVOList;if(!u){ue.value=[];return}const h={2:"richText",3:"link"};ue.value=Object.keys(u).map(k=>(u[k].forEach(T=>{if(T.attachmentType==="1"){const Y=T.attachmentUri.split("?"),X=Y[0].substr(Y[0].lastIndexOf(".")+1);console.log("type",X),X==="pdf"?T.attachmentType="pdf":T.attachmentType="picture"}else T.attachmentType=h[T.attachmentType]}),{attachmentName:k,attachmentList:u[k]}))},{immediate:!0});const je=()=>{console.log("detailScrollRef.value",p.value),p.value.handleClickTab()("tab3")},Ge=()=>{const{holder:{certNo:u,mobile:h,name:D,socialFlag:f},insured:{certNo:k,name:T,socialFlag:Y,relationToHolder:X},paymentMethod:ce}=ne;return!!(Re(k)&&!!Y)},ze=(u={},h={},D={})=>{var T,Y;const f={...D};console.log("currentOrderDetail==========",(T=f.tenantOrderInsuredList[0])==null?void 0:T.tenantOrderProductList[0].riskVOList);const k={tenantId:m,riskList:((Y=f.tenantOrderInsuredList[0])==null?void 0:Y.tenantOrderProductList[0].riskVOList)||[],riskPremium:h,productId:u==null?void 0:u.productBasicInfoVO.id};return f.extInfo.iseeBizNo=C,f.commencementTime=f.insuranceStartDate,f.expiryDate=f.insuranceEndDate,f.tenantOrderInsuredList=f.tenantOrderInsuredList.map(X=>({...X,planCode:S.value.activePlanCode?S.value.activePlanCode:null})),f.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:u.productBasicInfoVO.productCode,productName:u.productBasicInfoVO.productName,planCode:S.value.activePlanCode?S.value.activePlanCode:null,tenantOrderRiskList:gt(k)},f},We=async u=>{const{code:h,data:D}=await Ct({orderNo:u,tenantId:m});if(h==="10000"){D.extInfo={...D.extInfo,buttonCode:"EVENT_SHORT_underWrite"};const{code:f,data:k}=await Se(D);f==="10000"&&console.log("res=====",k),Object.assign(S.value,D)}},Qe=async u=>{var f,k,T,Y;const{code:h,data:D}=await Se(ze(e.value,{},S.value));console.log("data",D),(k=(f=D.pageAction)==null?void 0:f.data)!=null&&k.orderNo&&(console.log("23233322332"),await We((Y=(T=D.pageAction)==null?void 0:T.data)==null?void 0:Y.orderNo))},Ke=async()=>{},Je=u=>{te.value=u,M.value=!0},Xe=async(u,h,D)=>{var X,ce;const f=Dt(D).map(se=>({...se,paymentFrequency:u.paymentFrequency,insurancePeriodValue:u.insurancePeriodValue}));console.log("orderDetail.value.activePlanCode",S.value.activePlanCode);const k={tenantId:m,productCode:(X=a.value)==null?void 0:X.productCode,insuranceStartDate:u.insuranceStartDate,insuranceEndDate:u.insuranceEndDate,commencementTime:u.insuranceStartDate,expiryDate:u.insuranceEndDate,holder:{personVO:u.tenantOrderHolder},insuredVOList:u.tenantOrderInsuredList.map(se=>({insuredCode:"",relationToHolder:se.relationToHolder,personVO:se,productPlanVOList:[{insurerCode:h.productBasicInfoVO.insurerCode,planCode:S.value.activePlanCode?S.value.activePlanCode:null,riskVOList:f}]}))},{code:T,data:Y}=await Pt(k);S.value.tenantOrderInsuredList[0].tenantOrderProductList=(ce=k.insuredVOList[0])==null?void 0:ce.productPlanVOList,S.value.orderAmount=Y.premium,S.value.orderRealAmount=Y.premium},ge=async()=>{try{console.log("currentRiskInfo.value",De.value),await Xe(S.value,e.value,De.value),Qe({})}catch{}},Ze=u=>{u==="allFalse"?(w.value=!1,P.value=!0,ge()):pt.confirm({message:"\u60A8\u5F53\u524D\u7684\u5065\u5EB7\u72B6\u51B5\u4E0D\u7B26\u5408\u8BE5\u4EA7\u54C1",confirmButtonText:"\u786E\u5B9A"}).then(()=>{window.history.back()}).catch(()=>{var h;(h=x.value)==null||h.reEditForm(),P.value=!1})},Oe=()=>{var u;(u=x.value)==null||u.reEditForm(),P.value=!1},et=()=>{w.value=!1,Oe()},tt=()=>{M.value=!1,Oe()},nt=()=>{M.value=!1,w.value=!0};Q([()=>ne.insured.certNo,()=>ne.insured.socialFlag,()=>ne.packageProductList,()=>ne.paymentFrequency],ct.exports.debounce(()=>{ne.insured.certNo&&ne.insured.socialFlag&&Ge()&&Ke()},500),{deep:!0,immediate:!0});const at=async()=>{const u=It({productCode:l,withInsureInfo:!0,tenantId:m}),h=ht({productCode:l});await Promise.all([u,h]).then(([D,f])=>{var k;D.code==="10000"&&(a.value={...D.data},document.title=((k=D.data)==null?void 0:k.productFullName)||""),f.code==="10000"&&(e.value=f.data)})};return dt(()=>{at(),setTimeout(async()=>{C=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(u,h)=>{const D=z("van-config-provider");return n(),s(q,null,[g(D,{"theme-vars":t(O)},{default:H(()=>{var f,k,T,Y,X,ce,se,Fe,Le;return[o("div",ma,[o("div",va,[g($e,{url:(k=(f=a.value)==null?void 0:f.tenantProductInsureVO)==null?void 0:k.banner[0]},null,8,["url"]),(Y=(T=a.value)==null?void 0:T.tenantProductInsureVO)!=null&&Y.bannerMove?(n(),J($e,{key:0,url:(ce=(X=a.value)==null?void 0:X.tenantProductInsureVO)==null?void 0:ce.bannerMove[0],onClick:je},null,8,["url"])):B("",!0)]),g(Qt,{"show-service-config":"","data-source":(se=a.value)==null?void 0:se.tenantProductInsureVO,"is-multiple-plan":t(ae),"active-plan-code":S.value.activePlanCode,onUpdateActivePlan:Ye},null,8,["data-source","is-multiple-plan","active-plan-code"]),g(pn,{ref_key:"detailScrollRef",ref:p,detail:a.value},{form:H(()=>[g(St,{ref_key:"formRef",ref:x,"title-collection":{HOLDER:"\u672C\u4EBA\u4FE1\u606F\uFF08\u6295\u4FDD\u4EBA\uFF09",INSURER:"\u4E3A\u8C01\u6295\u4FDD\uFF08\u88AB\u4FDD\u4EBA\uFF09"},"form-info":S.value,"send-sms-code":()=>{},"factor-object":t(Ue)||{}},null,8,["form-info","send-sms-code","factor-object"]),g(oa,{"form-info":S.value,"insure-detail":e.value,"config-detail":a.value,"is-multiple-plan":t(ae),"risk-info-period-list":u.riskInfoPeriodList,premium:c.value},null,8,["form-info","insure-detail","config-detail","is-multiple-plan","risk-info-period-list","premium"])]),_:1},8,["detail"]),(Fe=a.value)!=null&&Fe.tenantProductInsureVO.inscribedContent?(n(),J(ra,{key:0,"inscribed-content":(Le=a.value)==null?void 0:Le.tenantProductInsureVO.inscribedContent},null,8,["inscribed-content"])):B("",!0),ue.value&&ue.value.length>1?(n(),J(pa,{key:1,"attachement-list":ue.value,"pre-text":"\u8BF7\u9605\u8BFB",onPreviewFile:h[0]||(h[0]=ot=>Je(ot))},null,8,["attachement-list"])):B("",!0),o("div",fa,[o("div",_a,[ya,o("span",null,L(c.value?"\uFFE5":"")+L(t(ft)(c.value))+" "+L(c.value?S.value.paymentFrequency==t(yt).YEAR?"\u5143/\u5E74":"\u5143/\u6708":""),1)]),g(Et,{shadow:!1,"theme-vars":t(O),class:"right",text:"\u7ACB\u5373\u6295\u4FDD",onClick:ge},{default:H(()=>[ha]),_:1},8,["theme-vars"])])])]}),_:1},8,["theme-vars"]),g(Ft,{show:w.value,"onUpdate:show":h[1]||(h[1]=f=>w.value=f),"content-list":t(He),"active-index":0,onOnConfirmHealth:Ze,onOnCloseHealth:et},null,8,["show","content-list"]),M.value?(n(),J(Lt,{key:0,show:M.value,"onUpdate:show":h[2]||(h[2]=f=>M.value=f),"content-list":ue.value,"is-only-view":W.value,"active-index":te.value,text:W.value?"\u5173\u95ED":"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9","force-read-cound":0,"on-close-file-preview":"",onSubmit:nt,onOnCloseFilePreview:tt},null,8,["show","content-list","is-only-view","active-index","text"])):B("",!0),g(hn,{"is-show":E.value},null,8,["is-show"])],64)}}});var Aa=ee(Pa,[["__scopeId","data-v-a0f684ac"]]);export{Aa as default};
