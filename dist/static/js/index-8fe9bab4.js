import{_ as t,d as e,dk as a,i as n,h as i,j as o,r as s,k as l,l as r,bC as d,cq as c,o as u,p as m,w as p,a as v,u as f,c as h,v as I,e as y,b,f as L,s as j,F as g,ai as O,q as k,bg as N,d9 as w,dI as A,a_ as T,ei as q,T as V,b2 as C,bo as x,bp as D,c8 as _,bO as P}from"./index-95a350f1.js";import{C as R}from"./index-030ae212.js";import{_ as Q}from"./index-7cf0c912.js";import{c as U}from"./order-cdfe5faf.js";import{m as E}from"./trial-9cae0763.js";import"./infoCollection-53154635.js";import"./core-df64eccf.js";import{I as S}from"./infoItem-26a5a4be.js";import{I as F}from"./insuranceNotificationInformation-130cc736.js";import{a as B,P as G}from"./PolicyInfo-7c696e84.js";import{l as H,b as M}from"./product-b8c02dbb.js";import{Q as X}from"./questionnaire-42dcb602.js";import{P as Y}from"./index-57c89ff3.js";import{Q as $}from"./notice-bd053fa5.js";import{g as z}from"./utils-4e96fd74.js";import{O as J}from"./OperateBtn-de18de39.js";import{t as K}from"./format-31cde443.js";import{C as W}from"./index-655df618.js";import"./cloneDeep-8c43540d.js";import"./util-bbf0d1a3.js";import"./trial-e55382d3.js";const Z=t=>(x("data-v-453e957e"),t=t(),D(),t),tt={class:"page-order-detail"},et=Z((()=>v("div",{class:"card-item-name"},"订单进度",-1))),at={class:"card-item-icon"},nt={class:"card card-list"},it={class:"card-list-title"},ot={class:"card card-list"},st={class:"card-list-head"},lt=Z((()=>v("div",{class:"card-list-title"},"险种信息",-1))),rt={class:"card-list-premium"},dt={class:"card"},ct={class:"card"},ut=Z((()=>v("div",{class:"tenantOrderAttachmentList-title"},"投保人资料",-1))),mt={class:"tenantOrderAttachmentList-img"},pt=["src"],vt=Z((()=>v("div",{class:"tenantOrderAttachmentList-title"},"被保险人资料",-1))),ft={class:"tenantOrderAttachmentList-img"},ht=["src"],It=Z((()=>v("div",{class:"tenantOrderAttachmentList-title"},"受益人资料",-1))),yt={class:"tenantOrderAttachmentList-img"},bt=["src"],Lt=Z((()=>v("div",{class:"tenantOrderAttachmentList-title"},"监护人资料",-1))),jt={class:"tenantOrderAttachmentList-img"},gt=["src"],Ot=Z((()=>v("div",{class:"tenantOrderAttachmentList-title"},"银行卡信息",-1))),kt={class:"tenantOrderAttachmentList-img"},Nt=["src"],wt={class:"card"},At={class:"card"},Tt={class:"footer-button"};var qt=t(e({__name:"index",setup(t){const e=a(),x=n();i();const D=o();o([]);const Z=o([]),qt=[{title:"险种名称",dataIndex:"riskName",width:200},{title:"保险金额/份数",dataIndex:"initialAmount",width:180,render:(t,e)=>w[t.riskCode]||K(t.initialAmount/(t.copy||1))},{title:"保险期间",dataIndex:"coveragePeriodDesc",width:180},{title:"交费期间",dataIndex:"chargePeriodDesc",width:180},{title:"首年保费",dataIndex:"initialPremium",width:180,render:(t,e)=>K(t.initialPremium)}],Vt=s({customerQuestions:[],payInfo:{schema:[],config:[],formData:[]},policyInfo:{schema:[],config:[],formData:{}}}),{query:{orderNo:Ct,agentCode:xt,tenantId:Dt}}=x,_t=l((()=>{var t,e;return"cancel"!==(null==(t=D.value)?void 0:t.orderStatus)&&(null==(e=D.value)?void 0:e.periodType)===A.long})),Pt=()=>{T("orderTrajectory",{orderNo:Ct,orderId:D.value.id,tenantId:Dt})},Rt=o(!1),Qt=o(),Ut=o([]),Et=l((()=>t=>{const{tenantOrderAttachmentList:e}=D.value;return(null==e?void 0:e.length)?e.filter((e=>e.objectType===t)):[]})),St=o(),Ft=(t=!0)=>{q({orderNo:Ct,agentCode:xt,tenantId:Dt}).then((({code:e,data:a})=>{if("10000"===e){if(D.value=a,!t)return;St.value=a,D.value.tenantOrderPayInfoList=a.tenantOrderPayInfoList||[];const e=Object.keys(D.value.productCodeList).map((t=>({productCode:t,mergeRiskReqList:D.value.productCodeList[t]})));M(n={productList:e}).then((({data:t,code:e})=>{var a,n;"10000"===e&&(Ut.value=null==(n=null==(a=t.riskMaterialList)?void 0:a[0])?void 0:n.productMaterialList)})),E(n).then((({data:t,code:e})=>{if("10000"===e){const{productDetailResList:e,productFactor:a}=t;Qt.value=a;const{payInfo:n,other:i}=P(a);Vt.payInfo={...Vt.payInfo,...n},Vt.policyInfo={...Vt.policyInfo,...i}}})),(async t=>{let e=[];const{code:a,data:n}=await _({orderNo:Ct,tenantId:Dt});"10000"===a&&(e=n.productQuestionnaireVOList);const{code:i,data:o}=await H(t);if("10000"===i){const{productQuestionnaireVOList:t}=o||{},a=t.filter((t=>t.businessType!==$.VISIT));Vt.customerQuestions=a.map((t=>{const{questionnaireDetailResponseVO:a,questionnaireId:n,questionnaireName:i,objectType:o}=t||{},{questions:s,basicInfo:l}=a||{},{objectType:r,questionnaireType:d}=l||{};if(d===X.TEXT){const{content:t,textType:e}=(null==s?void 0:s[0])||{};return{content:t,contentType:z(`${e}`,t),questionnaireId:n,objectType:o,questionnaireName:i}}const c=(e||[]).find((t=>t.questionnaireId===n&&t.objectType===o));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:n,objectType:o,questionnaireName:i}}))}})({productCodeList:Object.keys(D.value.productCodeList)})}var n}))},Bt=()=>{U({orderNo:Ct,tenantId:Dt,cancelFlag:1}).then((({code:t,data:e})=>{"10000"===t&&(V("撤单成功"),setTimeout((()=>Ft(!1)),500))}))};return r((()=>{Ft()})),(t,a)=>{const n=C,i=Q,o=R,s=W,l=d,r=c("loading");return u(),m(l,{"theme-vars":f(e)},{default:p((()=>{var t,e,l,d,c,w,A,T,q,V,C;return[v("div",tt,[f(_t)?(u(),h("div",{key:0,class:"card card-head",onClick:Pt},[et,v("div",at,[I(y(null==(t=f(D))?void 0:t.orderStepDesc)+" ",1),b(n,{name:"arrow-right"})])])):L("",!0),v("div",nt,[v("p",it,y(null==(e=f(D))?void 0:e.productName),1),b(S,{label:"订单号",content:null==(l=f(D))?void 0:l.orderNo,line:"","is-copy":"","min-width":"other"},null,8,["content"]),b(S,{label:"投/保单号",line:"","min-width":"other"},{content:p((()=>{var t,e,a,n;return[(u(!0),h(g,null,j((null==(e=null==(t=f(D))?void 0:t.policyNoList)?void 0:e.length)?null==(a=f(D))?void 0:a.policyNoList:null==(n=f(D))?void 0:n.applicationNoList,(t=>(u(),m(S,{key:t,content:t,line:"","is-copy":"","min-width":"other"},null,8,["content"])))),128))]})),_:1}),b(S,{label:"创建时间",content:null==(d=f(D))?void 0:d.orderDate,line:"","min-width":"other"},null,8,["content"]),b(S,{label:"投保时间",content:null==(c=f(D))?void 0:c.applicationCreateDate,line:"","min-width":"other"},null,8,["content"]),b(S,{label:"投保保费",content:f(K)(null==(w=f(D))?void 0:w.orderAmount),line:"","min-width":"other"},null,8,["content"]),b(S,{label:"承保保费",content:f(K)(null==(A=f(D))?void 0:A.orderAmount),line:"","min-width":"other"},null,8,["content"])]),v("div",ot,[v("div",st,[lt,v("div",rt,[I(" 首年保费："),v("span",null,y(f(K)(null==(T=f(D))?void 0:T.orderAmount)),1)])]),(null==(V=null==(q=f(D))?void 0:q.riskList)?void 0:V.length)>0?(u(),m(i,{key:0,columns:qt,class:"table","data-source":null==(C=f(D))?void 0:C.riskList},null,8,["data-source"])):L("",!0)]),v("div",dt,[f(Vt).policyInfo.schema.length?(u(),m(f(B),{key:0,modelValue:f(D).extInfo,"onUpdate:modelValue":a[0]||(a[0]=t=>f(D).extInfo=t),schema:f(Vt).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):L("",!0)]),v("div",ct,[b(s,{modelValue:f(Z),"onUpdate:modelValue":a[1]||(a[1]=t=>k(Z)?Z.value=t:null)},{default:p((()=>[b(o,{title:"影像信息",name:"1"},{default:p((()=>[ut,v("div",mt,[(u(!0),h(g,null,j(f(Et)(f(O).HOLDER),((t,e)=>(u(),h("div",{key:e,class:"attachment-item"},[v("img",{src:t.uri,alt:""},null,8,pt)])))),128))]),vt,v("div",ft,[(u(!0),h(g,null,j(f(Et)(f(O).INSURED),((t,e)=>(u(),h("div",{key:e,class:"attachment-item"},[v("img",{src:t.uri,alt:""},null,8,ht)])))),128))]),It,v("div",yt,[(u(!0),h(g,null,j(f(Et)(f(O).BENEFICIARY),((t,e)=>(u(),h("div",{key:e,class:"attachment-item"},[v("img",{src:t.uri,alt:""},null,8,bt)])))),128))]),Lt,v("div",jt,[(u(!0),h(g,null,j(f(Et)(f(O).GUARDIAN),((t,e)=>(u(),h("div",{key:e,class:"attachment-item"},[v("img",{src:t.uri,alt:""},null,8,gt)])))),128))]),Ot,v("div",kt,[(u(!0),h(g,null,j(f(Et)(f(O).INIT_SIGN),((t,e)=>(u(),h("div",{key:e,class:"attachment-item"},[v("img",{src:t.uri,alt:""},null,8,Nt)])))),128))])])),_:1})])),_:1},8,["modelValue"])]),v("div",wt,[b(F,{title:"投保告知信息",data:f(Vt).customerQuestions||[]},null,8,["data"])]),v("div",At,[f(Qt)?(u(),m(Y,{key:0,ref:"personalInfoRef",modelValue:f(St),"onUpdate:modelValue":a[2]||(a[2]=t=>k(St)?St.value=t:null),"product-factor":f(Qt),"is-view":""},null,8,["modelValue","product-factor"])):L("",!0)]),f(Vt).payInfo.schema.length?(u(),m(f(G),{key:1,ref:"payInfoRef",modelValue:f(D).tenantOrderPayInfoList,"onUpdate:modelValue":a[3]||(a[3]=t=>f(D).tenantOrderPayInfoList=t),schema:f(Vt).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):L("",!0),N((u(),h("div",Tt,[b(J,{detail:f(D),onHandleCancel:Bt},null,8,["detail"])])),[[r,f(Rt)]])])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-453e957e"]]);export{qt as default};
