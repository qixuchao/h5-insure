import{l as e,a,P as l}from"./index-f0aa7b29.js";import{d as i,z as s,o as t,a1 as n,R as o,c as r,A as u,V as d,U as c,g as p,i as v,w as m,h as f,k,G as I,aN as y,r as b,e as L,f as h,aO as g,aP as V,aZ as R,aT as C,L as x,a_ as P,a$ as O,F as T,E as w,b0 as S,aR as D,am as _,an as F,ah as E,j as M,aB as N,b1 as A,a3 as Y,ab as U,B as $,b2 as j,b3 as B,u as X,a as q,$ as K,n as Q,av as H,T as W,P as z,p as G}from"./index-76583929.js";import{_ as J}from"./index-16940450.js";/* empty css              */import{S as Z}from"./index-a104d48a.js";import{P as ee}from"./index-440a61d7.js";import{S as ae,_ as le}from"./box-title-63ca7cf0.js";import{_ as ie}from"./index-e5ac54d3.js";import{_ as se}from"./empty-ae586b6c.js";import{R as te}from"./trial-dde4fd05.js";import{u as ne,b as oe,p as re,q as ue,c as de}from"./trial-4e556909.js";import{u as ce}from"./useOrder-034dab72.js";import{t as pe}from"./utils-5b010db1.js";import{P as ve,B as me}from"./constants-7afb7c3d.js";import{n as fe}from"./nextStep-e1072bb8.js";const ke={key:0},Ie={key:0,class:"risk2-field"},ye=i({name:"ProductRiskList"});var be=I(i({...ye,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(e,{emit:a}){const l=e,i=s({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),I=e=>{const a=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&a.push({...e}),[]))),a},b=(e,s,t)=>{var n;i.riskIsInsure[s].data=e;const o=[...i.disabledRiskInfo];null==(n=l.dataSource.insureProductRiskVOList)||n.forEach((e=>{if(1!==e.mainRiskFlag){const a=i.riskIsInsure[e.riskId];a.data&&Object.keys(a.data).length>0&&"1"===a.selected&&o.push(a.data)}})),a("trialChange",o,t)},L=(e,a)=>{var s;null==(s=l.dataSource.productRiskRelationVOList)||s.forEach((l=>{1!==l.collocationType&&(a.riskId===l.riskId?(i.riskIsInsure[a.riskId]&&i.riskIsInsure[a.riskId].selected,2===l.collocationType&&i.riskIsInsure[l.collocationRiskId]&&(i.riskIsInsure[l.collocationRiskId].selected=e),3===l.collocationType&&i.riskIsInsure[l.collocationRiskId]&&"1"===e&&(i.riskIsInsure[l.collocationRiskId].selected="1"===e?"2":"1")):a.riskId===l.collocationRiskId&&(3===l.collocationType&&"1"===e&&i.riskIsInsure[l.riskId]&&(i.riskIsInsure[l.riskId].selected="1"===e?"2":"1"),2===l.collocationType&&i.riskIsInsure[l.riskId]&&(i.riskIsInsure[l.riskId].selected=e)))})),"2"===e?b({},a.riskId):(e=>{var a,l,i,s,t,n,o,r,u,d,c,p;if(1!==(null==e?void 0:e.factorDisPlayFlag)){const v=null==(a=null==e?void 0:e.productRiskInsureLimitVO)?void 0:a.amountPremiumConfigVO,m={riskCategory:e.riskCategory,riskCode:e.riskCode,riskName:e.riskName,riskId:e.riskId,riskType:e.riskType,mainRiskId:e.mainRiskId,mainRiskCode:e.mainRiskCode,liabilityList:I(e)};m.chargePeriod=(null==(i=null==(l=null==e?void 0:e.productRiskInsureLimitVO)?void 0:l.paymentPeriodValueList)?void 0:i.length)>0&&(null==(s=null==e?void 0:e.productRiskInsureLimitVO)?void 0:s.paymentPeriodValueList[0].code)||null,m.coveragePeriod=(null==(n=null==(t=null==e?void 0:e.productRiskInsureLimitVO)?void 0:t.insurancePeriodValueList)?void 0:n.length)>0&&(null==(o=null==e?void 0:e.productRiskInsureLimitVO)?void 0:o.insurancePeriodValueList[0].code)||null,m.paymentFrequency=(null==(u=null==(r=null==e?void 0:e.productRiskInsureLimitVO)?void 0:r.paymentFrequencyList)?void 0:u.length)>0&&(null==(d=null==e?void 0:e.productRiskInsureLimitVO)?void 0:d.paymentFrequencyList[0].code)||null;let f=0;1===v.displayType?f=(null==v?void 0:v.minStepValue)>0?null==v?void 0:v.minStepValue:0:3===v.displayType&&2===v.requireCopies?f=(null==(c=null==v?void 0:v.displayValues)?void 0:c.length)>0?null==v?void 0:v.displayValues[0].value:0:3===v.displayType&&1===v.requireCopies?(f=(null==(p=null==v?void 0:v.displayValues)?void 0:p.length)>0?null==v?void 0:v.displayValues[0].value:0,m.copy=v.minCopiesValue):2===v.displayType?m.copy=v.minCopiesValue:f=0,1===v.saleMethod?m.initialAmount=f:m.initialPremium=f,b(m,e.riskId)}})(a)};return t((()=>{(()=>{var e,a;i.disabledRiskInfo=[];let s=null;if(null==(e=l.dataSource.insureProductRiskVOList)||e.forEach((e=>{var a;const t=1!==e.mainRiskFlag?null==(a=l.dataSource.productRiskRelationVOList)?void 0:a.find((a=>a.collocationRiskId===e.riskId)):{};1===e.mainRiskFlag&&(s=e),i.riskIsInsure[e.riskId]?(i.riskIsInsure[e.riskId].data=null,i.riskIsInsure[e.riskId].relation=t,i.riskIsInsure[e.riskId].isMust=!1):i.riskIsInsure[e.riskId]={selected:"2",data:null,relation:t,isMust:!1}})),s){const e=null==(a=l.dataSource.productRiskRelationVOList)?void 0:a.filter((e=>e.riskId===s.riskId));if(!e)return;null==e||e.forEach((e=>{var a,s,t,n,o,r,u,d,c,p,v,m,f,k,y;if(2===e.collocationType){i.riskIsInsure[e.collocationRiskId].selected="1",i.riskIsInsure[e.collocationRiskId].isMust=!0;const L=null==(a=l.dataSource.insureProductRiskVOList)?void 0:a.find((a=>e.collocationRiskId===a.riskId));if(L&&1!==L.factorDisPlayFlag&&(null==(s=null==L?void 0:L.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO)){const a=null==(t=L.riskLiabilityInfoVOList)?void 0:t.every((e=>1!==e.showFlag)),l=null==(n=null==L?void 0:L.productRiskInsureLimitVO)?void 0:n.amountPremiumConfigVO;if(a){i.riskIsInsure[e.collocationRiskId].isDisabled=!0;const a={riskCategory:L.riskCategory,riskCode:L.riskCode,riskName:L.riskName,riskId:L.riskId,riskType:L.riskType,mainRiskId:L.mainRiskId,mainRiskCode:L.mainRiskCode,liabilityList:I(L)};a.chargePeriod=(null==(r=null==(o=null==L?void 0:L.productRiskInsureLimitVO)?void 0:o.paymentPeriodValueList)?void 0:r.length)>0&&(null==(u=null==L?void 0:L.productRiskInsureLimitVO)?void 0:u.paymentPeriodValueList[0].code)||null,a.coveragePeriod=(null==(c=null==(d=null==L?void 0:L.productRiskInsureLimitVO)?void 0:d.insurancePeriodValueList)?void 0:c.length)>0&&(null==(p=null==L?void 0:L.productRiskInsureLimitVO)?void 0:p.insurancePeriodValueList[0].code)||null,a.paymentFrequency=(null==(m=null==(v=null==L?void 0:L.productRiskInsureLimitVO)?void 0:v.paymentFrequencyList)?void 0:m.length)>0&&(null==(f=null==L?void 0:L.productRiskInsureLimitVO)?void 0:f.paymentFrequencyList[0].code)||null;let s=0;1===l.displayType?s=(null==l?void 0:l.minStepValue)>0?null==l?void 0:l.minStepValue:0:3===l.displayType&&2===l.requireCopies?s=(null==(k=null==l?void 0:l.displayValues)?void 0:k.length)>0?null==l?void 0:l.displayValues[0].value:0:3===l.displayType&&1===l.requireCopies?(s=(null==(y=null==l?void 0:l.displayValues)?void 0:y.length)>0?null==l?void 0:l.displayValues[0].value:0,a.copy=l.minCopiesValue):2===l.displayType&&(a.copy=l.minCopiesValue),1===l.saleMethod?a.initialAmount=s:a.initialPremium=s,i.disabledRiskInfo.push(a),b(a,L.riskId)}}}3===e.collocationType&&(i.riskIsInsure[e.collocationRiskId].selected="2",i.riskIsInsure[e.collocationRiskId].isMust=!0)}))}})()})),n((()=>{i.loading=!0})),o((()=>i.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>l.defaultValue),(e=>{(null==e?void 0:e.length)>0&&e.forEach((e=>{i.risksDefaultValue[e.riskCode]=e,i.riskIsInsure[e.riskId]?(i.riskIsInsure[e.riskId].selected="1",b(e,e.riskId)):i.riskIsInsure[e.riskId]={selected:"1",isMust:!1}}))}),{deep:!0,immediate:!0}),(a,l)=>{const s=Z,t=y;return r(!0),u(c,null,d(e.dataSource.insureProductRiskVOList,(l=>{var n,o;return r(),u(c,{key:l.riskCode},[(!e.showMainRisk&&1!==l.mainRiskFlag||e.showMainRisk)&&(null==(o=null==(n=p(i).riskIsInsure)?void 0:n[l.riskId])?void 0:o.relation)?(r(),u("div",ke,[v(t,{modelValue:p(i).riskIsInsure[l.riskId].selected,"onUpdate:modelValue":e=>p(i).riskIsInsure[l.riskId].selected=e,label:l.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:m((()=>[v(s,{modelValue:p(i).riskIsInsure[l.riskId].selected,"onUpdate:modelValue":e=>p(i).riskIsInsure[l.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"0.74rem",disabled:p(i).riskIsInsure[l.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>L(e,l)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===p(i).riskIsInsure[l.riskId].selected?(r(),u("div",Ie,[v(J,{modelValue:p(i).riskIsInsure[l.riskId].data,"onUpdate:modelValue":e=>p(i).riskIsInsure[l.riskId].data=e,"origin-data":l,"product-factor":e.dataSource.productFactor,"default-value":p(i).risksDefaultValue[l.riskCode],onTrialChange:(e,a)=>b(e,l.riskId,a)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):f("",!0),1===l.exemptFlag&&"1"===p(i).riskIsInsure[l.riskId].selected?k(a.$slots,"holderForm",{key:1},void 0,!0):f("",!0)])):f("",!0)],64)})),128)}}}),[["__scopeId","data-v-04703dac"]]);const Le={class:"pro-radio-wrap"},he=i({name:"PlanSelect"}),ge=i({...he,props:{planList:{default:()=>[]},defaultPlan:{default:()=>{}}},emits:["planChange"],setup(e,{emit:a}){const l=e,i=b("");let s=!1;return n((()=>{l.defaultPlan&&(s=!0,i.value=l.defaultPlan.planCode)})),o((()=>i),(e=>{s||a("planChange",i.value),s&&(s=!1)}),{deep:!0,immediate:!0}),(a,s)=>{const t=g,n=V;return e.planList.length>0?(r(),L(n,{key:0,modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),label:"保障计划",name:"planCode",class:"risk-select-field"},{input:m((()=>[h("div",Le,[v(t,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=e=>i.value=e),options:l.planList.map((e=>({label:e.planName,value:e.planCode})))},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):f("",!0)}}});var Ve=I(i({__name:"ScrollWrap",props:{moduleValue:{type:Number,default:0},scrollX:{type:Boolean,default:!1},scrollY:{type:Boolean,default:!1}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:a}){const l=e,i=s({offsetX:0,offsetY:0,startX:0,startY:0}),t=b(null),d=b(null),{width:c,height:v}=R(t),{width:m,height:f}=R(d),I=C("PRO_TABLE_KEY"),y=x((()=>{const e=c.value>m.value+4;return a("update:needFixed",e),e})),L=x((()=>v.value>f.value+4)),{direction:h}=P(t,{passive:!1,onSwipeStart(e){const{clientX:a,clientY:l}=e.touches[0];i.startX=a,i.startY=l},onSwipe(e){const{clientX:a,clientY:l}=e.touches[0];if(["LEFT","RIGHT"].includes(h.value)){const e=i.offsetX-(i.startX-a);e>-c.value+m.value&&e<0&&(i.offsetX=e,I.state.offsetX=i.offsetX),i.startX=a}if(["UP","DOWN"].includes(h.value)){const e=i.offsetY-(i.startY-l);e>-v.value+f.value&&e<0&&(i.offsetY=e,I.state.offsetY=i.offsetY),i.startY=l}},onSwipeEnd(e){}}),g=x((()=>l.scrollX||l.scrollY?`transform: translate(${l.scrollX?`${i.offsetX}px`:0},${l.scrollY?`${i.offsetY}px`:0} );`:""));return o((()=>null==I?void 0:I.state),(()=>{const{offsetX:e,offsetY:a}=(null==I?void 0:I.state)||{};y.value&&(i.offsetX=e),L.value&&(i.offsetY=a)}),{deep:!0,immediate:!0}),n((()=>{var e;d.value=null==(e=t.value)?void 0:e.parentElement})),(e,a)=>(r(),u("div",{ref_key:"swiperEl",ref:t,class:"scroll-wrap",style:O(p(g))},[k(e.$slots,"default",{},void 0,!0)],4))}}),[["__scopeId","data-v-0ba94815"]]);const Re={class:"pro-com-table-wrap"},Ce={ref:"tableHeadRef",class:"com-table"},xe={class:"com-table-head"},Pe={class:"com-table-row"},Oe={ref:"tableBodyRef",class:"com-table"},Te={class:"com-table-head"},we={class:"com-table-row"},Se={class:"com-table-body"};var De=I(i({__name:"Table",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},translateY:{type:Number,default:0}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:a}){const l=e=>{a("update:needFixed",e)};return(a,i)=>(r(),u("div",Re,[v(Ve,{ref:"tableScroll",class:"pro-table-head","scroll-x":"","onUpdate:needFixed":l},{default:m((()=>[h("table",Ce,[h("thead",xe,[h("tr",Pe,[(r(!0),u(c,null,d(e.columns,((e,a)=>(r(),u("th",{key:a,class:T(["table-cell",`table-cell-${a}`]),style:O({minWidth:`${e.width||80}px`})},w(e.title),7)))),128))])])],512)])),_:1},512),v(Ve,{ref:"tableScroll",class:"pro-table-body","scroll-y":"","scroll-x":""},{default:m((()=>[h("table",Oe,[h("thead",Te,[h("tr",we,[(r(!0),u(c,null,d(e.columns,((e,a)=>(r(),u("th",{key:a,class:T(["table-cell",`table-cell-${a}`]),style:O({minWidth:`${e.width||80}px`})},w(e.title),7)))),128))])]),h("tbody",Se,[(r(!0),u(c,null,d(e.data,((a,l)=>(r(),u("tr",{key:l,class:"com-table-row"},[(r(!0),u(c,null,d(e.columns,((e,i)=>(r(),u("td",{key:i,class:T(["table-cell"])},[h("span",null,w(e.render?e.render(a,l):a[e.key]),1)])))),128))])))),128))])],512)])),_:1},512)]))}}),[["__scopeId","data-v-f37eb4be"]]);const _e=e=>(_("data-v-0cf962f9"),e=e(),F(),e),Fe={key:0,class:"pro-table-wrap"},Ee={key:1,class:"no-data-wrap"},Me=[_e((()=>h("img",{src:se,alt:"暂无数据"},null,-1))),_e((()=>h("span",null,"暂无数据～",-1)))];var Ne=I(i({__name:"ProTable",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},setup(e){const a=e;b(null),b(null);const l=s({translateY:0,translateX:0,offsetX:0,offsetY:0,needFixed:!1});S("PRO_TABLE_KEY",{state:l});const i=x((()=>D(a.columns)?a.columns.filter((e=>e.fixed)):[])),t=e=>{l.needFixed=e};return(a,s)=>e.data&&e.data.length?(r(),u("div",Fe,[v(De,{"translate-y":p(l).translateY,"onUpdate:translateY":s[0]||(s[0]=e=>p(l).translateY=e),columns:e.columns,data:e.data,"onUpdate:needFixed":t},null,8,["translate-y","columns","data"]),p(l).needFixed?(r(),L(De,{key:0,"translate-y":p(l).translateY,"onUpdate:translateY":s[1]||(s[1]=e=>p(l).translateY=e),class:"pro-table-fixed",style:{width:"160px"},columns:p(i),data:e.data},null,8,["translate-y","columns","data"])):f("",!0)])):(r(),u("div",Ee,Me))}}),[["__scopeId","data-v-0cf962f9"]]);const Ae={class:"benefit-table"},Ye=i({__name:"BenefitTable",props:{dataSource:null},setup(e){const a=e,l=x((()=>D(a.dataSource.headers)?a.dataSource.headers.map(((e,a)=>({title:e,key:`header_${a}`,fixed:a<2}))):[])),i=x((()=>D(a.dataSource.dataList)?a.dataSource.dataList.map((e=>{const a={};return e.forEach(((e,l)=>{a[`header_${l}`]=e})),a})):[]));return(e,a)=>(r(),u("div",Ae,[v(Ne,{columns:p(l),data:p(i),"is-clone":!0},null,8,["columns","data"])]))}});const Ue=e=>(_("data-v-5e4dfbe9"),e=e(),F(),e),$e={key:0,class:"benefit-container"},je={key:0,class:"benefit"},Be=Ue((()=>h("div",{class:"line"},null,-1))),Xe={class:"box-title box-title-chart"},qe=Ue((()=>h("img",{class:"tl",src:le,alt:""},null,-1))),Ke=Ue((()=>h("img",{class:"transform-z180 tr",src:le,alt:""},null,-1))),Qe={key:0},He={class:"box"},We={class:"box-title"},ze=Ue((()=>h("img",{class:"tl",src:le,alt:""},null,-1))),Ge=Ue((()=>h("img",{class:"transform-z180 tr",src:le,alt:""},null,-1))),Je={class:"box-price"},Ze={class:"text1"},ea={class:"text2"},aa={key:1},la={key:2,style:{width:"100%, minWidth: 338px"}},ia={class:"slider"},sa={style:{flex:"1",margin:"0px 5px"}},ta={class:"custom-button"},na=Ue((()=>h("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),oa={class:"btn-two"},ra={key:1,class:"benefit-container"},ua={key:0},da={class:"benefit"},ca=Ue((()=>h("div",{class:"line"},null,-1))),pa=Ue((()=>h("div",null,[h("div",{class:"box"},[h("p",{class:"box-title"},[h("img",{class:"tl",src:le,alt:""}),M(" 保单年度"),h("span",null,"-"),M("年度，被保人"),h("span",null,"-"),M("岁时 "),h("img",{class:"transform-z180 tr",src:le,alt:""})]),h("div",{class:"box-price"})])],-1))),va={class:"slider"},ma={class:"opt lf"},fa={style:{flex:"1",margin:"0px 5px"}},ka=Ue((()=>h("div",{class:"custom-button"},"0 岁",-1))),Ia={class:"opt rg"},ya=Ue((()=>h("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),ba={class:"btn-two"},La={key:1,class:"empty-box"},ha=i({name:"Benefit"});var ga=I(i({...ha,props:{dataSource:{default:()=>({showTypeList:["1"]})},productInfo:{default:()=>null}},setup(e){var a;const l=e,i="1",s="2",t="3",n=b(0),k=b(0),I=b(0),y=b(),g=b(0),V=b(null==(a=l.dataSource.showTypeList)?void 0:a[0]),R=b(),C=e=>{if(!(null==e?void 0:e.benefitRiskResultVOList))return;const a=null==e?void 0:e.benefitRiskResultVOList[n.value];k.value=a.ageBegin+1,g.value=a.ageBegin+1,I.value=a.ageEnd},x=()=>{var e,a,i,s,t,o;const r=null==(a=null==(e=l.dataSource)?void 0:e.benefitRiskResultVOList)?void 0:a[n.value];R.value=null==(t=null==(s=null==(i=l.dataSource)?void 0:i.benefitRiskResultVOList)?void 0:s[n.value].benefitRiskTableResultVOList)?void 0:t[0];const{a:u,year:d}=((e,a)=>{const l=[],i=[];for(let s=e,t=0;s<=a;s++,t++)l.push(s.toString()),i.push(t+1);return{a:l,year:i}})(k.value,I.value),c={index:u.indexOf(g.value.toString()),age:u,year:d,result:null==(o=null==r?void 0:r.benefitRiskItemResultVOList)?void 0:o[0]};y.value=c},P=()=>{g.value>I.value-1||(g.value+=1,x())},O=()=>{g.value>k.value&&(g.value-=1,x())},T=e=>{n.value=e.name,C(l.dataSource),x()};return o((()=>l.dataSource),(e=>{var a;e&&(C(e),x(),V.value=null==(a=e.showTypeList)?void 0:a[0])}),{deep:!0,immediate:!0}),o(g,(()=>{x()})),(a,o)=>{var b;const C=U,x=ae,S=$,D=j,_=B,F=ee;return(null==(b=e.dataSource)?void 0:b.benefitRiskResultVOList)?(r(),u("div",$e,[v(_,{active:p(n),onClickTab:T},{default:m((()=>{var e;return[(r(!0),u(c,null,d(null==(e=l.dataSource)?void 0:e.benefitRiskResultVOList,((e,a)=>(r(),L(D,{key:a,name:a,title:e.riskName},{default:m((()=>{var e,b,T,D,_,F,U,$,j,B,X,q,K,Q,H,W;return[a==p(n)?(r(),u("div",je,[Be,E(h("p",Xe,[qe,M(" 保单年度"),h("span",null,w(null==(T=null==(e=p(y))?void 0:e.year)?void 0:T[null==(b=p(y))?void 0:b.index]),1),M("年度，被保人"),h("span",null,w(null==(F=null==(D=p(y))?void 0:D.age)?void 0:F[null==(_=p(y))?void 0:_.index]),1),M("岁时 "),Ke],512),[[N,p(V)===s]]),p(V)===i?(r(),u("div",Qe,[h("div",He,[h("p",We,[ze,M(" 保单年度"),h("span",null,w(null==(j=null==(U=p(y))?void 0:U.year)?void 0:j[null==($=p(y))?void 0:$.index]),1),M("年度，被保人"),h("span",null,w(null==(q=null==(B=p(y))?void 0:B.age)?void 0:q[null==(X=p(y))?void 0:X.index]),1),M("岁时 "),Ge]),h("div",Je,[(r(!0),u(c,null,d(null==(Q=null==(K=p(y))?void 0:K.result)?void 0:Q.headers,((e,a)=>{var l,i,s,t,n,o,d,c,v,m;return r(),u("div",{key:a,style:{width:"33%"}},[h("p",Ze,w(("0"==(null==(n=null==(t=null==(i=null==(l=p(y))?void 0:l.result)?void 0:i.dataList)?void 0:t[null==(s=p(y))?void 0:s.index])?void 0:n[a])?"0":p(A)(Number(null==(m=null==(v=null==(d=null==(o=p(y))?void 0:o.result)?void 0:d.dataList)?void 0:v[null==(c=p(y))?void 0:c.index])?void 0:m[a])))||"0"),1),h("p",ea,w(e)+"(元）",1)])})),128))])])])):f("",!0),p(V)===t?(r(),u("div",aa,[v(Ye,{"data-source":p(R)},null,8,["data-source"])])):f("",!0),p(V)==s?(r(),u("div",la,[v(ie,{min:p(k),max:p(I),current:p(g),data:null==(W=null==(H=p(y))?void 0:H.result)?void 0:W.benefitRiskItemList},null,8,["min","max","current","data"])])):f("",!0),p(V)!=t?(r(),u(c,{key:3},[h("div",ia,[h("div",{class:"opt lf",onClick:O},[v(C,{name:"minus"})]),h("div",sa,[p(k)?(r(),L(x,{key:0,modelValue:p(g),"onUpdate:modelValue":o[0]||(o[0]=e=>Y(g)?g.value=e:null),min:p(k),max:p(I),"bar-height":"8px"},{button:m((()=>[h("div",ta,w(p(g))+" 岁",1)])),_:1},8,["modelValue","min","max"])):f("",!0)]),h("div",{class:"opt rg",onClick:P},[v(C,{name:"plus"})])]),na],64)):f("",!0),h("div",oa,[l.dataSource.showTypeList.includes(i)?(r(),L(S,{key:0,round:"",plain:p(V)!==i,type:"primary",class:"btn",onClick:o[1]||(o[1]=e=>V.value=i)},{default:m((()=>[M("图表展示")])),_:1},8,["plain"])):f("",!0),l.dataSource.showTypeList.includes(s)?(r(),L(S,{key:1,round:"",plain:p(V)!==s,type:"primary",class:"btn",onClick:o[2]||(o[2]=e=>V.value=s)},{default:m((()=>[M("趋势展示")])),_:1},8,["plain"])):f("",!0),l.dataSource.showTypeList.includes(t)?(r(),L(S,{key:2,round:"",plain:p(V)!==t,type:"primary",class:"btn",onClick:o[3]||(o[3]=e=>V.value=t)},{default:m((()=>[M("表格展示")])),_:1},8,["plain"])):f("",!0)])])):f("",!0)]})),_:2},1032,["name","title"])))),128))]})),_:1},8,["active"])])):(r(),u("div",ra,[l.productInfo?(r(),u("div",ua,[v(_,{active:p(n),onClickTab:T},{default:m((()=>[(r(),L(D,{key:1,name:1,title:e.productInfo.insureProductRiskVOList[0].riskName},{default:m((()=>[h("div",da,[ca,pa,h("div",va,[h("div",ma,[v(C,{name:"minus"})]),h("div",fa,[v(x,{modelValue:p(g),"onUpdate:modelValue":o[4]||(o[4]=e=>Y(g)?g.value=e:null),min:0,max:80,"bar-height":"8px",disabled:""},{button:m((()=>[ka])),_:1},8,["modelValue"])]),h("div",Ia,[v(C,{name:"plus"})])]),ya,h("div",ba,[v(S,{round:"",plain:!0,type:"primary",class:"btn",disabled:""},{default:m((()=>[M("图表展示")])),_:1}),v(S,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:m((()=>[M("趋势展示")])),_:1}),v(S,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:m((()=>[M("表格展示")])),_:1})])])])),_:1},8,["title"]))])),_:1},8,["active"])])):(r(),u("div",La,[v(F,{title:"试算结果正在计算中...","empty-class":"empty-select"})]))]))}}}),[["__scopeId","data-v-5e4dfbe9"]]);const Va={key:0,class:"head-warning-wrap"},Ra=h("div",{class:"warning-icon"},[h("span",null,"!")],-1),Ca={class:"warning-text"},xa=i({name:"HeadWaring"}),Pa=i({...xa,props:{labels:{default:()=>[]}},setup:e=>(a,l)=>e.labels.length>0?(r(),u("div",Va,[Ra,h("div",Ca,[(r(!0),u(c,null,d(e.labels,(e=>(r(),u("span",{key:e},w(e),1)))),128))])])):f("",!0)}),Oa=(a,l,i)=>{const s=a,{holder:t}=i,n=i.insuredList[0],o=(l||"").split("_");if(o.length<2)return l;if(e.exports.isNaN(Number(o[1])))return l;if(o[1]-=1,1===s.exemptFlag){if("to"===o[0]){let e=0;1===s.exemptType?(null==t?void 0:t.birthday)&&(e=parseInt(""+((new Date).getTime()-new Date(t.birthday).getTime())/31536e6,10)):2===s.exemptType&&(null==n?void 0:n.birthday)&&(e=parseInt(""+(+(new Date).getTime()-new Date(n.birthday).getTime())/31536e6,10)),o[1]=+o[1]-e}o[0]="year"}return o.join("_")},Ta=(e,a)=>{const l=[],i={};return null==e||e.forEach((e=>{i[e.riskId]=e})),null==a||a.forEach((e=>{var a,s,t,n;const{collocationType:o,collocationRiskId:r,riskId:u}=e;switch(o){case 2:{const e=null==(a=i[u])?void 0:a.riskName,t=null==(s=i[r])?void 0:s.riskName;l.push(`${e} 和 ${t} 必须同时投保`);break}case 3:{const e=null==(t=i[u])?void 0:t.riskName,a=null==(n=i[r])?void 0:n.riskName;l.push(`${e} 和 ${a} 不能同时投保`);break}}})),l};const wa={class:"com-body"},Sa={class:"trial-body"},Da={class:"container"},_a=(e=>(_("data-v-20e13acb"),e=e(),F(),e))((()=>h("div",{class:"empty"},null,-1))),Fa=i({name:"TrialBody"});var Ea=I(i({...Fa,props:{dataSource:{default:()=>[]},productInfo:{default:()=>({productCode:"",productName:"",insurerCode:"",tenantId:"",planList:[]})},tenantProductDetail:{default:()=>({})},hideBenefit:{type:Boolean,default:!1},hidePopupButton:{type:Boolean,default:!1},title:{default:"算一算保费"},defaultData:{default:null},isTrial:{type:Boolean,default:!1}},emits:["trialStart","trialEnd"],setup(i,{expose:d,emit:c}){const I=i,y=b(null),g=X();q();const{tenantId:V,templateId:R,preview:C}=g.query,P=b(),O=s({loading:!1,show:!1,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},riskList:[{}],mainRiskVO:{},ifPersonalInfoSuccess:!1,trialMsg:"",trialResultPremium:0,trialResult:{initialPremium:0,initialAmount:0},isAniShow:!1,defaultValue:null,isAutoChange:!1,planIndex:0,isSkipFirstTrial:!1,hadSkipFirstTrial:!1,isQuerying:!1,currentPlanCode:""}),T=ce();b();const w=b(),S=b(I.dataSource),_=b([]),F=e=>{const{holder:a,insuredList:l}=e||{};a&&(O.submitData.holder=a),l&&l.length>0&&l.forEach(((e,a)=>{var l;O.submitData.insuredList&&O.submitData.insuredList.length>a?O.submitData.insuredList[a]=e:((null==(l=O.submitData)?void 0:l.insuredList)||(O.submitData.insuredList=[]),O.submitData.insuredList.push(e))}))},E=x((()=>I.productInfo.planList&&I.productInfo.planList.length>2)),M=(e,a)=>{if(e){const l=["birthday","age","gender","id"];a.includes("occupationCodeList")&&l.push("occupationClass"),Object.keys(e).forEach((i=>{[...a,...l].includes(i)||(e[i]=null)}))}},N=(e,a=(e=>!0))=>D(e)?e.filter(a).map((e=>e.code)):[],A=()=>{console.log("--current plan = ",S.value),console.log("---current submit = ",O.submitData);const a=e.exports.cloneDeep(O.submitData);if(!E.value)return a;const{1:l,2:i,3:s}=S.value.productFactor||{};if(a.holder&&M(a.holder,N(l)),a.insuredList){const e=["productList","beneficiaryList"],l=N(i,(e=>"2"!==String(e.subModuleType))),t=N(i,(e=>"2"===String(e.subModuleType))),n=D(t),o=N(s),r=D(o);a.insuredList.forEach(((a,i)=>{var s,u;M(a,[...i>=1&&n?t:l,...e,...r?["insuredBeneficiaryType"]:[]]),(null==(s=a.beneficiaryList)?void 0:s.length)>0&&(r?a.beneficiaryList.forEach((e=>M(e,o))):a.beneficiaryList.length=0),a.planCode=S.value.planCode;const d=(null==(u=a.productList[0])?void 0:u.riskList)||[],c=S.value.insureProductRiskVOList||[];if(d&&c){const e=d.filter((e=>null!==c.find((a=>a.riskCode===e.riskCode))));a.productList[0].riskList=e}}))}return a},Y=b(),U=b({}),$=["annuityDrawDate","coveragePeriod","chargePeriod","paymentFrequency"],j=e=>{var a,i,s,t,n,o;if(null==(i=null==(a=null==e?void 0:e.data)?void 0:a[0])?void 0:i.productRiskDyInsureFactorVOList){const a=[];if(null==(s=S.value)||s.insureProductRiskVOList.forEach((i=>{var s,t;const n=null==(t=null==(s=null==e?void 0:e.data)?void 0:s[0])?void 0:t.productRiskDyInsureFactorVOList.find((e=>e.riskCode===i.riskCode));if(n){i.productRiskInsureLimitVO={...i.productRiskInsureLimitVO,...n};const e=O.riskList.find((e=>e.riskCode===i.riskCode));let s=!1;l.forEach((a=>{if($.indexOf(a.valueKey)>=0){const l=i.productRiskInsureLimitVO[a.configKey];if(l&&e){const i=l.find((l=>l.code===e[a.valueKey]));if(i&&2===i.useFlag){const i=l.find((e=>1===e.defaultFlag));e[a.valueKey]=i.code,s=!0}}}})),s&&a.push({...e,...n,riskCode:i.riskCode})}})),a.length>0&&(null==(o=null==(n=null==(t=O.defaultValue)?void 0:t.insuredList)?void 0:n[0])?void 0:o.productList))return a.forEach((e=>{var a,l,i;O.defaultValue.insuredList[0].productList=null==(i=null==(l=null==(a=O.defaultValue)?void 0:a.insuredList)?void 0:l[0])?void 0:i.productList.map((a=>(a.riskList=null==a?void 0:a.riskList.map((a=>(a.riskCode===e.riskCode&&(a=e),a))),a)))})),!1}return!0},B=async(e,a=!0)=>{O.trialMsg="试算中...",O.trialResultPremium=0,O.loading=!0,c("trialStart");let l=!1;if(a){const{code:a}=await ne(e);l="10000"===a}!l&&a||(O.isQuerying=!0,I.hideBenefit||oe(e).then((e=>{e.data&&e.code===H&&(U.value=e.data)})).finally((()=>{O.loading=!1})),re(e).then((a=>{var l,i;if(a.data&&a.code===H){(null==(l=null==a?void 0:a.data)?void 0:l.errorInfo)&&W(`${null==(i=null==a?void 0:a.data)?void 0:i.errorInfo}`),O.trialMsg="",O.trialResultPremium=a.data.initialPremium,O.trialResult=a.data;const s={};a.data.riskPremiumDetailVOList&&a.data.riskPremiumDetailVOList.length&&a.data.riskPremiumDetailVOList.forEach((e=>{s[e.riskCode]={initialAmount:e.initialAmount,initialPremium:e.initialPremium}})),Y.value=s,c("trialEnd",a.data,e)}})).finally((()=>{O.loading=!1,O.isQuerying=!1})))},Z=e.exports.debounce((async()=>{console.log(">>>>>调用试算<<<<<",O.ifPersonalInfoSuccess,P.value.canTrail());const{productCode:e,productName:a}=I.productInfo||{};if(O.ifPersonalInfoSuccess||P.value.canTrail()){O.submitData.productCode=e,O.submitData.productName=a,O.submitData.tenantId=I.productInfo.tenantId,O.riskList=O.riskList.map((e=>(e=>{var a,i,s,t;const n=null==(a=S.value.insureProductRiskVOList)?void 0:a.find((a=>e.riskId===a.riskId));if(n&&1!==n.mainRiskFlag){const a=null==(s=null==(i=S.value)?void 0:i.productRiskRelationVOList)?void 0:s.filter((e=>{var a;if(e.collocationRiskId===n.riskId&&3!==e.collocationType){const l=null==(a=S.value.insureProductRiskVOList)?void 0:a.find((a=>e.riskId===a.riskId));if(l&&l.riskType===te.MAIN_RISK)return!0}return!1})),o=a.length>0?a[0]:null;if(o){const a=null==(t=O.riskList)?void 0:t.find((e=>e.riskId===o.riskId));l.forEach((l=>{l.ruleKey&&n.productRiskInsureLimitVO&&a&&(1===n.productRiskInsureLimitVO[l.ruleKey]&&(e[l.valueKey]=a[l.valueKey]),3===n.productRiskInsureLimitVO[l.ruleKey]&&(1!==n.exemptFlag?e[l.valueKey]=Oa(n,a[l.valueKey],O.submitData):e[l.valueKey]=Oa(n,a[l.ruleValueKey],O.submitData)))}))}}return e})(e))),O.submitData.insuredList&&O.submitData.insuredList.forEach((l=>{l.productList=[{productCode:e,productName:a,riskList:O.riskList}]}));const i=A();console.log(">>>数据构建<<<",i),await B(i)}}),300),ee=async e=>{var a;const{insuredList:l,isFirstInsuredChange:i}=e;if(F(e),O.ifPersonalInfoSuccess=!0,i){console.log("处理第一被保人修改的dy变化"),O.isQuerying=!0;const e=await ue({calcProductFactorList:[{planCode:S.value.planCode,productCode:I.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:null==(a=S.value.insureProductRiskVOList)?void 0:a[0]}]}],...l[0]});if(O.isQuerying=!1,!j(e))return}console.log("投被保人的信息回传 ",e),Z()},ae=async(a,l)=>{var i,s,t,n;if(l){const o=e.exports.cloneDeep(a);delete o.insurancePeriodValueList,delete o.paymentFrequencyList,delete o.paymentPeriodValueList;if($.indexOf(l.key)>=0&&`${l.oldValue}`!=`${l.newValue}`){const e={};switch(l.key){case"annuityDrawDate":e.changeType=3;break;case"coveragePeriod":e.changeType=2;break;case"chargePeriod":e.changeType=1}const r=null==(s=null==(i=O.submitData)?void 0:i.insuredList)?void 0:s[0],u=null==(n=null==(t=S.value)?void 0:t.insureProductRiskVOList)?void 0:n.find((e=>e.riskCode===a.riskCode));if(!O.isAutoChange){O.isQuerying=!0;const l=await ue({calcProductFactorList:[{planCode:S.value.planCode,productCode:I.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:u,insureRiskEditReqVO:{riskId:a.riskId,riskCode:a.riskCode,...o,...e}}]}],...r});O.isQuerying=!1;const i=j(l);return i||(O.isAutoChange=!0),i}O.isAutoChange=!1}}return!0},le=async(e,a)=>{O.mainRiskVO=e;await ae(e,a)&&(O.riskList.length>0&&(O.riskList[0]=e),console.log("标准险种的信息回传",e),Z())},ie=async(e,a)=>{if(O.riskList=[O.mainRiskVO,...e],console.log("附加险列表数据回传",e),a){const l=e.find((e=>e.riskCode===a.riskCode));if(!(await ae(l,a)))return}Z()},se=e=>{var a,l,i,s;O.userData=e,O.defaultValue=e;const t=(null==(a=e.insuredList)?void 0:a[0].productList.findIndex((e=>e.planCode===S.value.planCode)))||0;O.planIndex=-1===t?0:t,O.riskList=(null==(s=null==(i=null==(l=null==e?void 0:e.insuredList)?void 0:l[0].productList)?void 0:i[O.planIndex])?void 0:s.riskList)||[],B(e,!0)},ke=async e=>{var a;if(I.defaultData){const e=I.defaultData.find((e=>e.productCode===I.productInfo.productCode))||I.defaultData[0];se(e),F(null==(a=I.defaultData)?void 0:a[0])}else _.value.push(S.value.planCode),await(async()=>{var e;const a=await de({calcProductFactorList:[{planCode:S.value.planCode,productCode:I.productInfo.productCode}]});if(a.data){const l=a.data.find((e=>e.productCode===I.productInfo.productCode))||a.data[0];se(l),F(null==(e=a.data)?void 0:e[0])}})()},Ie=async e=>{var a,l;const i=I.productInfo.planList.findIndex((a=>a.planCode===e)),s=(null==(l=null==(a=O.defaultValue)?void 0:a.insuredList)?void 0:l[0].productList.findIndex((a=>a.planCode===e)))||0,t=i>=0?I.productInfo.planList[i]:null;t&&(O.currentPlanCode=e,S.value=t,O.planIndex=s>=0?s:0,O.defaultValue.insuredList[0].productList[O.planIndex].riskList=O.riskList,_.value.findIndex((a=>a===e))<0&&_.value.push(e))};t((()=>{var e,a;O.select={},O.list=[],O.userData={},O.riskIsInsure={},O.submitData={},O.riskList=[{}],O.mainRiskVO={},O.ifPersonalInfoSuccess=!1,O.trialMsg="",O.trialResultPremium=0,O.riskIsInsure={},null==(a=null==(e=S.value)?void 0:e.insureProductRiskVOList)||a.forEach((e=>{var a;const l=null==(a=S.value.productRiskRelationVOList)?void 0:a.find((a=>a.collocationRiskId===e.riskId));l&&(O.riskIsInsure[e.riskCode]={selected:"2",data:null,relation:l})}))})),n((()=>{S.value=I.dataSource,O.loading=!0,O.show=!0,O.isAniShow=!0,O.isSkipFirstTrial=!0,O.hadSkipFirstTrial=!1,K((()=>{ke()}))}));return d({getTrialSuccessFlag:()=>O.trialResultPremium>0,validate:()=>P.value.validate(!1),validateTrialFields:()=>P.value.validateTrialFields(),validateHolder:e=>{var a;return null==(a=P.value)?void 0:a.validateHolder(e)},getUserData:()=>({...O.userData}),onShare:e=>{var a;O.trialResultPremium&&(null==(a=y.value)||a.validate().then((()=>{Object.assign(T.value,{extInfo:{...T.value.extInfo,buttonCode:me.TRIAL_PREMIUM,pageCode:ve.TRIAL_PREMIUM,templateId:R}});const a=pe(I.productInfo,Y.value,T.value);fe(a,((a,l)=>{l===z.JUMP_PAGE&&(w.value.link=`${window.location.href}&isShare=1&orderNo=${a.orderNo}`,e())})),console.log("---- validate success ----")})))},onNext:()=>{var e;C?Q(ve.TRIAL_PREMIUM,g.query):O.trialResultPremium&&(null==(e=y.value)||e.validate().then((()=>{Object.assign(T.value,{extInfo:{...T.value.extInfo,buttonCode:me.TRIAL_PREMIUM,pageCode:ve.TRIAL_PREMIUM,templateId:R}}),console.log("dealMixData()",A());const e=pe(A(),O.trialResult,T.value);fe(e,((e,a)=>{a===z.JUMP_PAGE&&G(e.nextPageCode,{...g.query,orderNo:e.orderNo})})),console.log("---- validate success ----")})),O.loading=!1,O.show=!0,O.isAniShow=!0)},dealMixData:A}),o((()=>O.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>O.userData),(e=>{if(e){const{holder:a,insuredList:l}=e||{};Object.assign(O.submitData,{holder:a,insuredList:l})}}),{deep:!0}),o((()=>I.dataSource),(e=>{S.value=e}),{deep:!0,immediate:!0}),(e,l)=>{var s,t,n,o,d,c,I,b;return r(),u("div",wa,[k(e.$slots,"trialHead",{},void 0,!0),h("div",Sa,[v(Pa,{labels:p(Ta)((null==(s=S.value)?void 0:s.insureProductRiskVOList)||[],S.value.productRiskRelationVOList)},null,8,["labels"]),h("div",Da,[!i.hideBenefit&&(null==(t=U.value)?void 0:t.benefitRiskResultVOList)?(r(),L(ga,{key:0,class:"benefit-wrap","data-source":U.value,"product-info":S.value,"show-type-list":U.value.showTypList},null,8,["data-source","product-info","show-type-list"])):f("",!0),p(E)?(r(),L(ge,{key:1,"plan-list":i.productInfo.planList,"default-plan":S.value,onPlanChange:Ie},null,8,["plan-list","default-plan"])):f("",!0),S.value.productFactor?(r(),L(p(a),{ref_key:"personalInfoRef",ref:P,key:S.value.planCode,modelValue:p(O).userData,"onUpdate:modelValue":l[0]||(l[0]=e=>p(O).userData=e),"is-trial":i.isTrial,"product-factor":S.value.productFactor,"multi-insured-config":null==(n=S.value)?void 0:n.multiInsuredConfigVO,onTrailChange:ee},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):f("",!0),(r(),L(J,{ref_key:"insureInfosRef",ref:y,key:S.value.planCode,"origin-data":null==(o=S.value.insureProductRiskVOList)?void 0:o[0],"product-factor":S.value.productFactor,"default-value":p(O).defaultValue?null==(c=null==(d=p(O).defaultValue)?void 0:d.insuredList[0].productList[p(O).planIndex])?void 0:c.riskList[0]:null,"trial-result":p(O).trialResult,onTrialChange:le},null,8,["origin-data","product-factor","default-value","trial-result"])),S.value.insureProductRiskVOList?(r(),L(be,{key:S.value.planCode,"data-source":S.value,"show-main-risk":!1,"default-value":p(O).defaultValue?null==(b=null==(I=p(O).defaultValue)?void 0:I.insuredList[0].productList[p(O).planIndex])?void 0:b.riskList:[],onTrialChange:ie},{holderForm:m((()=>{var e;return[i.isTrial&&i.dataSource.productFactor?(r(),L(p(a),{key:0,ref_key:"personalInfoRef",ref:P,modelValue:p(O).userData,"onUpdate:modelValue":l[1]||(l[1]=e=>p(O).userData=e),"is-trial":i.isTrial,"is-only-holder":!0,"product-factor":i.dataSource.productFactor,"multi-insured-config":null==(e=i.dataSource)?void 0:e.multiInsuredConfigVO,onTrailChange:ee},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):f("",!0)]})),_:1},8,["data-source","default-value"])):f("",!0),_a])]),k(e.$slots,"trialBtn",{trialData:p(O).submitData,riskPremium:p(O).trialResult,loading:p(O).isQuerying,personalInfoRef:P.value},void 0,!0)])}}}),[["__scopeId","data-v-20e13acb"]]);export{Ea as T};
