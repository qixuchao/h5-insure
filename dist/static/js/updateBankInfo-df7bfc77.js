import{_ as e,d as a,j as t,i as s,h as o,bc as n,l as r,o as i,c as d,u as l,p as u,q as c,f,a as p,b as m,w as v,v as y,e as b,ba as I,bk as g,a_ as h,d5 as j,aY as P,bb as _,bO as w,b3 as N,cF as k,cI as x,cH as C,c5 as O}from"./index-e6143c1d.js";import{P as $}from"./PolicyInfo-fcb5ad2f.js";import{u as L}from"./useOrder-0232d2e5.js";import{p as T}from"./utils-eeddb3d5.js";import{g as A,m as B}from"./trial-781aadbd.js";import{n as E}from"./nextStep-dd004c66.js";import"./cloneDeep-595f514e.js";import"./utils-d06fedb3.js";import"./createProposal-8e30ae00.js";import"./trial-21f46215.js";import"./utils-539f5f32.js";import"./infoCollection-df935142.js";import"./core-8db61146.js";const D={class:"bank-info-wrap"},U={class:"footer-button"},q=a({name:"updateBankInfo"});var G=e(a({...q,setup(e){const a=t(!1),q=s(),G=o(),{orderNo:S,isShare:V,tenantId:F,nextPageCode:z}=q.query,M=L(),R=t({schema:[],config:[],formData:[]}),H=t(!!V),J=t(),K=t(),Y=()=>{G.back()},Q=()=>{J.value&&J.value.validate(!1).then((e=>{e&&(a.value=!0,M.value.tenantOrderPayInfoList=K,V?(M.value.extInfo.buttonCode=I.UPDATE_BANK_INFO_HOLDER,E(M.value,((e,a)=>{a===g.JUMP_PAGE&&h(e.nextPageCode,q.query)}),q).finally((()=>{a.value=!1}))):(M.value.extInfo.buttonCode=I.UPDATE_BANK_INFO_AGENT,E(M.value,((e,a)=>{a===g.JUMP_PAGE&&((e,a)=>{var t;const{holder:s,insuredList:o}=M.value;let n={name:s.name,gender:`${k[s.gender]}士`};"insured"===e&&(n={name:null==o?void 0:o[0].name,gender:`${k[null==o?void 0:o[0].gender]}士`});const r={...q.query,objectType:e,isShare:1,nextPageCode:"updateBankInfo"};x({shareType:0,title:`${C[a].title}`,desc:C[a].desc.replace("{name}",`${n.name}${n.gender}`),url:`${null==(t=window.location.href.split("?"))?void 0:t[0]}?${O.stringify(r)}`.replace("/updateBankInfo","/phoneVerify"),imageUrl:"https://aquarius-v100-test.oss-cn-hangzhou.aliyuncs.com/MyPicture/asdad.png"})})("holder","pay")}),q).finally((()=>{a.value=!1}))))}))};n((()=>{(async()=>{let e={};j({orderNo:S,tenantId:F}).then((({code:e,data:a})=>{if("10000"===e){K.value=a.tenantOrderPayInfoList;const e=[];a.tenantOrderPayInfoList.forEach(((a,t)=>{`${a.paymentType}`==`${P.NO}`&&(e[t]={paymentType:{isView:!0}})})),R.value.config=e}}));const{code:a,data:t}=await A({orderNo:S,tenantId:F});"10000"===a&&(Object.assign(M.value,t,{extInfo:{...t.extInfo,buttonCode:I.SIGN,pageCode:_.SIGN}}),e=T(t.insuredList[0].productList)),B(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:t}=e,{payInfo:s}=w(t);R.value={...R.value,...s}}}))})()}));const W=t();return r((()=>{setTimeout((async()=>{W.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const s=N;return i(),d("div",D,[l(R).schema.length&&l(K)?(i(),u($,{key:0,ref_key:"payInfoRef",ref:J,modelValue:l(K),"onUpdate:modelValue":t[0]||(t[0]=e=>c(K)?K.value=e:null),schema:l(R).schema,config:l(R).config,"is-view":l(H),"user-data":l(M)},null,8,["modelValue","schema","config","is-view","user-data"])):f("",!0),p("div",U,[m(s,{type:"primary",plain:"",onClick:Y},{default:v((()=>[y("取消")])),_:1}),m(s,{disabled:l(a),type:"primary",onClick:Q},{default:v((()=>[y(b(l(V)?"确认":"分享给客户确认"),1)])),_:1},8,["disabled"])])])}}}),[["__scopeId","data-v-127bf9a1"]]);export{G as default};
