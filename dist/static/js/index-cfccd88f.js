import{z as a,d as e,t as s,r as t,aB as l,a as o,I as r,a4 as i,b as d,Y as n,w as p,e as u,i as c,ad as m,f as v,c as h,W as f,X as y,x as g,g as x,bE as _,Z as P,D as k,T as j,B as b}from"./index-3300826d.js";import{L as C}from"./index-f7353bd4.js";import{S as I}from"./index-67e047c7.js";import{Z as L}from"./index-34a98020.js";import{e as V}from"./empty-c926d8ec.js";import{P as $}from"./index-9f7740a0.js";import{d as w,h as S}from"./proposalList-0af9a542.js";import"./pdfh5-008ca364.js";const B={class:"proposal-content"},N={class:"title"},U={class:"premium"},q={class:"operate-btn"};var z=a(e({__name:"index",setup(a){const e=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:a=>(a=>{const e=a,[s,t]=e.split("_");return"to_life"===e?"保终身":`${t}${{year:"年",month:"月",day:"天",to:"岁"}[s]}`})(null==a?void 0:a.coveragePeriod)},{title:"缴费期间",dataIndex:"chargePeriod",width:110,render:a=>(a=>{const e=a,[s,t]=e.split("_"),l={year:"年交",month:"月交",day:"天",to:"岁"};return"single"===e?"趸缴":"to"===l[s]?`交至${t}岁`:`${t}${l[s]}`})(null==a?void 0:a.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:a=>{return(e=null==a?void 0:a.premium)?String(e).replace(/\B(?=(\d{3})+$)/g,","):"";var e}}],z=s({historyList:[],searchValue:""}),T=t(!1),W=t(!1),Z=t(1),{historyList:D,searchValue:E}=l(z),O=o(),R=()=>{S({name:E.value,pageNum:Z.value,pageSize:20,relationUserType:2}).then((a=>{const{code:e,data:s}=a;"10000"===e&&(1===Z.value?D.value=s.datas||[]:D.value=D.value.concat(s.datas),Z.value+=1,T.value=!1,W.value=D.value.length>=s.total)}))},X=()=>{R()},Y=r((()=>D.value.length>0)),A=a=>{E.value=a,Z.value=1,R()};return(a,s)=>{const t=I,l=b,o=C,r=i("ProPageWrap");return d(),n(r,{class:"page-history-proposal"},{default:p((()=>[u(t,{modelValue:c(E),"onUpdate:modelValue":s[0]||(s[0]=a=>m(E)?E.value=a:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:A},null,8,["modelValue"]),v("div",B,[u(o,{loading:c(T),"onUpdate:loading":s[1]||(s[1]=a=>m(T)?T.value=a:null),finished:c(W),"finished-text":c(Y)?"- 没有更多了 -":"",onLoad:X},{default:p((()=>[(d(!0),h(f,null,y(c(D),(a=>(d(),h("div",{key:a.id,class:"proposal-item"},[v("div",N,g(a.proposalName)+"计划书",1),v("p",U,[x(" 保费："),v("span",null,"¥"+g(c(_)(a.totalPremium)),1)]),u($,{columns:e,class:"table","data-source":a.proposalProductRiskVOList},null,8,["data-source"]),v("div",q,[u(l,{plain:"",round:"",type:"primary",class:"del-btn",onClick:e=>{return s=a.id,void k.confirm({message:"是否确定删除计划书？"}).then((()=>{w(s).then((a=>{const{code:e}=a;"10000"===e&&(j.success("删除成功"),Z.value=1,R())}))})).catch((()=>{}));var s}},{default:p((()=>[x("删除")])),_:2},1032,["onClick"]),u(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void O.push({path:"/proposal/createProposal",query:{id:s}});var s}},{default:p((()=>[x("编辑")])),_:2},1032,["onClick"]),u(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void O.push({path:"compositionProposal",query:{id:s}});var s}},{default:p((()=>[x("预览")])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),c(Y)?P("",!0):(d(),n(L,{key:0,"empty-img":c(V),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})}}}),[["__scopeId","data-v-36b7a1a3"]]);export{z as default};
