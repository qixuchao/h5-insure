import{aX as e,d as s,r as t,bT as a,A as o,bt as l,V as r,bu as d,e as i,bh as c,aY as u,a$ as n,bm as p,W as v,bU as h,b0 as m,aA as g,b as f,c as C,i as y,f as P,E as k,$ as b,a7 as L,k as w,G as x,bV as _,L as S,a9 as V,Z as I,bW as T,o as $,F as j,h as M,w as D,bX as U,a0 as F,j as q,b9 as H,an as N,B as O,ai as B,aS as A,aT as z,g as E,aa as W,bE as Y,bq as G,bF as X,bG as R,a as Z,u as J,bI as K,aF as Q,a3 as ee,au as se,bs as te,T as ae}from"./index-41b5f8f6.js";import{L as oe}from"./index-35c6acbc.js";import{S as le}from"./index-cdf948bc.js";import{P as re}from"./index-ff4077c8.js";import{_ as de}from"./empty-ae586b6c.js";import{P as ie,u as ce}from"./ProductTips-421bc69e.js";import{q as ue,a as ne}from"./proposalList-378e5b83.js";import{P as pe}from"./index-ac91e23f.js";import{a as ve}from"./trial-360e39fb.js";const[he,me,ge]=e("pull-refresh"),fe=["pulling","loosing","success"];const Ce=m(s({name:he,props:{disabled:Boolean,modelValue:Boolean,headHeight:c(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:u,successDuration:c(500),animationDuration:c(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:s,slots:c}){let u;const m=t(),g=t(),f=a(m),C=o({status:"normal",distance:0,duration:0}),y=l(),P=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},k=()=>"loading"!==C.status&&"success"!==C.status&&!e.disabled,b=(t,a)=>{const o=+(e.pullDistance||e.headHeight);C.distance=t,C.status=a?"loading":0===t?"normal":t<o?"pulling":"loosing",s("change",{status:C.status,distance:t})},L=()=>{const{status:s}=C;return"normal"===s?"":e[`${s}Text`]||ge(s)},w=()=>{const{status:e,distance:s}=C;if(c[e])return c[e]({distance:s});const t=[];return fe.includes(e)&&t.push(i("div",{class:me("text")},[L()])),"loading"===e&&t.push(i(n,{class:me("loading")},{default:L})),t},x=e=>{u=0===h(f.value),u&&(C.duration=0,y.start(e))},_=e=>{k()&&x(e)},S=()=>{u&&y.deltaY.value&&k()&&(C.duration=+e.animationDuration,"loosing"===C.status?(b(+e.headHeight,!0),s("update:modelValue",!0),v((()=>s("refresh")))):b(0))};return r((()=>e.modelValue),(s=>{C.duration=+e.animationDuration,s?b(+e.headHeight,!0):c.success||e.successText?(C.status="success",setTimeout((()=>{b(0)}),+e.successDuration)):b(0,!1)})),d("touchmove",(s=>{if(k()){u||x(s);const{deltaY:t}=y;y.move(s),u&&t.value>=0&&y.isVertical()&&(p(s),b((s=>{const t=+(e.pullDistance||e.headHeight);return s>t&&(s=s<2*t?t+(s-t)/2:1.5*t+(s-2*t)/4),Math.round(s)})(t.value)))}}),{target:g}),()=>{var e;const s={transitionDuration:`${C.duration}ms`,transform:C.distance?`translate3d(0,${C.distance}px, 0)`:""};return i("div",{ref:m,class:me()},[i("div",{ref:g,class:me("track"),style:s,onTouchstartPassive:_,onTouchend:S,onTouchcancel:S},[i("div",{class:me("head"),style:P()},[w()]),null==(e=c.default)?void 0:e.call(c)])])}}}));const ye={class:"com-product-item"},Pe={class:"content-wrap"},ke={class:"product-image"},be={class:"insure-name"},Le={class:"product-info"},we={class:"title"},xe={class:"description"},_e={class:"tags"};var Se=x(s({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const s=e,{productInfo:t}=g(s),a=o({checked:!1});return g(a),(e,s)=>{var a,o,l,r,d;const c=_;return f(),C("div",ye,[y("div",Pe,[y("div",ke,[i(c,{src:(null==(a=P(t).showConfig)?void 0:a.fileThumbnailUrl)||(null==(o=P(t).showConfig)?void 0:o.fileUrl)},null,8,["src"]),y("p",be,k((P(t).insurerName||"").substring(0,6)),1)]),y("div",Le,[y("p",we,k(null==(l=P(t).showConfig)?void 0:l.title),1),y("p",xe,k(null==(r=P(t).showConfig)?void 0:r.text),1),y("p",_e,[(f(!0),C(b,null,L(null==(d=P(t).showConfig)?void 0:d.tags,((e,s)=>(f(),C("span",{key:s,class:"tag"},k(e),1)))),128))])]),w(e.$slots,"checkedProduct",{},void 0,!0)]),i(ie,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-d0dbf77c"]]);const Ve=["xlink:href"],Ie=s({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const s=e,t=S((()=>`#icon-${s.name}`)),a=S((()=>s.name?`svg-icon icon-${s.name}`:"svg-icon"));return(s,o)=>(f(),C("svg",V({class:P(a)},s.$attrs,{style:{color:e.color}}),[y("use",{"xlink:href":P(t)},null,8,Ve)],16))}});const Te=e=>(A("data-v-d36af93a"),e=e(),z(),e),$e={class:"com-tab-filter"},je={class:"article-mid"},Me={class:"article-tag"},De=["onClick"],Ue=Te((()=>y("span",null,null,-1))),Fe={class:"popup-inner"},qe=Te((()=>y("div",{class:"popup-title"},"保险公司",-1))),He={class:"footer-button"};var Ne=x(s({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:s}){const{isPopShow:a,openPop:l,closePop:r}=function(e=!1){const s=t(e);return{isPopShow:s,openPop:e=>{e instanceof Function&&e(),s.value=!0},closePop:e=>{s.value=!1,e instanceof Function&&e()}}}(!1),d=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:c,checkedInsure:u}=g(d),n=t(""),p=()=>{u.value=[]},v=()=>{var e;const{productCategoryId:t}=(null==(e=d.productCategoryList)?void 0:e[n.value])||{};s("onSelectInsure",{selectInsureCode:u.value,selectCategory:t}),r()};return I((()=>{T().then((e=>{const{code:s,data:t}=e;"10000"===s&&(c.value=null==t?void 0:t.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),$((()=>{ue().then((e=>{const{code:s,data:t}=e||{};"10000"===s&&N(t)&&(d.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...t])}))})),(t,o)=>{const h=O,m=B;return f(),C("div",$e,[y("div",je,[y("div",Me,[(f(!0),C(b,null,L(P(d).productCategoryList,((e,t)=>(f(),C("div",{key:t,class:j(["tag-item",{checked:P(n)==t}]),onClick:a=>((e,t)=>{var a;n.value=t;const{productCategoryId:o}=(null==(a=d.productCategoryList)?void 0:a[n.value])||{};s("onSelectInsure",{selectInsureCode:u.value,selectCategory:o})})(null==e||e.productCategoryId,t)},[y("div",{class:j(["tag-out",{checked:P(n)==t}])},[y("div",{class:j(["tag-item-text",{checked:P(n)==t}])},k(e.productCategoryName),3)],2)],10,De)))),128))]),e.filter?(f(),C("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>P(l)&&P(l)(...e))},[Ue,y("div",{class:j(["text",{"has-select-condition":P(u).length>0}])},"筛选",2),i(Ie,{name:"filter"})])):M("",!0),i(m,{show:P(a),position:"right","close-on-click-overlay":"",teleport:"body",class:"proposal-list-filter-popup-wrap","overlay-style":{"z-index":5e3},style:H(e.popupStyle||{width:"322px",height:"100%",padding:"0 15px","z-index":5e3}),onClickOverlay:P(r)},{default:D((()=>[y("div",Fe,[qe,i(U,{modelValue:P(u),"onUpdate:modelValue":o[1]||(o[1]=e=>F(u)?u.value=e:null),options:P(c)},null,8,["modelValue","options"])]),y("div",He,[i(h,{plain:"",type:"primary",onClick:p},{default:D((()=>[q("重置")])),_:1}),i(h,{type:"primary",onClick:v},{default:D((()=>[q("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])])])}}}),[["__scopeId","data-v-d36af93a"]]);const Oe={class:"com-trial-product-wrapper"},Be={class:"container"},Ae=(e=>(A("data-v-49f70a68"),e=e(),z(),e))((()=>y("span",{class:"title"}," 已选产品 ",-1))),ze={class:"popup-body"},Ee={class:"cell-title"},We={class:"title"},Ye=s({name:"TrialProductPopup"});var Ge=x(s({...Ye,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:s}){const a=e,o=t([]),l=t([]),d=t({isShow:a.isShow}),c=()=>{s("close")},u=()=>{l.value=[],s("checked",[])},n=e=>{var t,a,r;null==(r=null==(a=null==(t=null==o?void 0:o.value)?void 0:t[e])?void 0:a.toggle)||r.call(a),s("checked",l.value)};return r((()=>a.isShow),(e=>{d.value.isShow=e})),r(l,((e=[])=>{s("update:modalValue",e)}),{deep:!0,immediate:!0}),r((()=>a.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(e,s)=>{const t=Y,a=G,r=X,p=R,v=B;return f(),C("div",Oe,[i(v,{show:P(d).isShow,"onUpdate:show":s[1]||(s[1]=e=>P(d).isShow=e),position:"bottom",onClose:c},{default:D((()=>[y("div",Be,[y("div",{class:"popup-header"},[y("span",{class:"clear-all",onClick:u}," 清空选项 "),Ae,y("span",{class:"close",onClick:c})]),y("div",ze,[i(p,{modelValue:P(l),"onUpdate:modelValue":s[0]||(s[0]=e=>F(l)?l.value=e:null)},{default:D((()=>[i(r,{inset:""},{default:D((()=>[(f(!0),C(b,null,L(e.proposalList,(e=>(f(),E(a,{key:e.productCode,title:e.productName,onClick:s=>n(e.productCode)},{"right-icon":D((()=>{var s;return[i(t,{ref_for:!0,ref:s=>P(o)[e.productCode]=s,shape:"square","model-value":null==(s=P(l))?void 0:s.includes(e.productCode),name:e.productCode,onClick:W((s=>n(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:D((()=>[y("div",Ee,[y("div",We,k(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const Xe={class:"search-wrap"},Re={class:"page-proposal-list"},Ze={class:"check-button"},Je={key:1,class:"van-sticky"},Ke={class:"add-plan"},Qe={class:"has-select-product"},es=(e=>(A("data-v-1360502a"),e=e(),z(),e))((()=>y("span",{class:"icon"},null,-1))),ss=s({name:"ProposalList"});var ts=x(s({...ss,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const s=ce(),t=Z(),a=J(),{isCreateProposal:l}=a.query,r=K(),d=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],firstLoading:!0}),{searchValue:c,tagLists:u,isOpen:n,loading:p,finished:v,refreshing:h,productList:m,selectProduct:w,insurerCodeList:x,showCategory:_,productTotal:V,showFooter:I}=g(d);Q();const[T,j]=Q(),U=()=>{const{excludeProductCodeList:e}=d;d.firstLoading&&ae.loading("加载中..."),ne({title:c.value,insurerCodeList:x.value,showCategory:_.value,excludeProductCodeList:Array.isArray(e)?e:[],pageNum:1,pageSize:999}).then((e=>{const{code:s,data:t,total:a}=e;"10000"===s&&(m.value=null==t?void 0:t.datas,V.value=a)})).finally((()=>{ae.clear(),d.firstLoading=!1}))},H=e=>{U()},N=e=>{const{selectInsureCode:s,selectCategory:t}=e;x.value=s,_.value=t,U()},B=()=>{h.value&&(m.value=[],h.value=!1),U(),p.value=!1,V.value===m.value.length&&(v.value=!0)},A=()=>{t.push({path:"historyProposalList"})};S((()=>{var e;const{birthday:t,gender:a}=(null==(e=s.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:t,gender:a}}));const z=S((()=>m.value.length>0)),W=({productCode:e})=>l?(d.productCode=e,d.selectProduct.includes(e)?(d.selectProduct=d.selectProduct.filter((s=>s!==e)),!1):void(async(e,t)=>{const{code:a,data:o,message:l}=await ve({...s.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===a?(d.errorMsgMap[e]="","function"==typeof t&&t(!0)):d.errorMsgMap[e]=l})(e,(()=>{d.selectProduct.push(e)}))):(t.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),G=e=>{d.selectProduct=e,d.selectedProductList=d.selectedProductList.filter((s=>e.includes(s.productCode)))},X=()=>{const e=d.proposalList.filter((e=>d.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));s.setTrialData(e),s.setSelectedProduct(d.selectProduct),s.setSelectedProductList(d.selectedProductList),t.back()},R=()=>{v.value=!0,p.value=!0,B()};return $((()=>{d.excludeProductCodeList=s.$state.excludeProduct})),(e,s)=>{const t=le,a=Y,o=oe,u=Ce,g=O,w=ee("ProPageWrap"),x=te;return f(),E(x,{"theme-vars":P(r)},{default:D((()=>[i(w,{class:"page-proposal"},{default:D((()=>[y("div",Xe,[i(t,{modelValue:P(c),"onUpdate:modelValue":s[0]||(s[0]=e=>F(c)?c.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:H},null,8,["modelValue"]),i(Ne,{filter:P(n),"onUpdate:filter":s[1]||(s[1]=e=>F(n)?n.value=e:null),"filter-class":"filter-area",onOnSelectInsure:N},null,8,["filter"])]),P(z)||P(d).firstLoading?M("",!0):(f(),E(re,{key:0,"empty-img":P(de),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),y("div",Re,[i(u,{modelValue:P(h),"onUpdate:modelValue":s[3]||(s[3]=e=>F(h)?h.value=e:null),onRefresh:R},{default:D((()=>[i(o,{loading:P(p),"onUpdate:loading":s[2]||(s[2]=e=>F(p)?p.value=e:null),finished:P(v),"finished-text":P(z)?"- 已经到底了哦 -":"",onLoad:B},{default:D((()=>[(f(!0),C(b,null,L(P(m),(e=>(f(),E(Se,{key:e.id,"product-info":e,"error-msg":P(d).errorMsgMap[e.productCode],onClick:s=>W(e)},se({_:2},[P(l)?{name:"checkedProduct",fn:D((()=>[y("div",Ze,[(f(),E(a,{key:e.id,name:e.productCode,"model-value":P(d).selectProduct.includes(e.productCode),shape:"square",onChange:s=>((e,s)=>{e?d.selectedProductList.push(s):d.selectedProductList=d.selectedProductList.filter((e=>e.productCode!==s.productCode))})(s,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),P(l)&&P(I)?(f(),C("div",Je,[y("div",Ke,[y("p",{class:"has-select",onClick:s[4]||(s[4]=e=>P(j)(!P(T)))},[q(" 已选"),y("span",Qe,k(P(d).selectProduct.length),1),q("款产品 "),es]),i(g,{type:"primary",disabled:!P(d).selectProduct.length,onClick:X},{default:D((()=>[q("添加计划书")])),_:1},8,["disabled"])])])):M("",!0),i(Ge,{"modal-value":P(d).selectProduct,"proposal-list":P(d).selectedProductList,"is-show":P(T),onClose:s[5]||(s[5]=e=>P(j)(!1)),onChecked:G},null,8,["modal-value","proposal-list","is-show"])])),_:1}),P(l)?M("",!0):(f(),E(pe,{key:0,"button-image":P("/static/png/lishijihuashu-b6958e78.png"),onClick:A},null,8,["button-image"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-1360502a"]]);export{ts as default};
