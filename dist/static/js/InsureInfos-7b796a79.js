import{d as e,r as a,j as l,k as i,O as t,B as u,o,c as n,b as s,w as d,a as r,u as m,m as c,e as v,f as y,F as p,_ as V,b8 as b,b9 as k,q as f,aF as g,ba as h,bb as L,aC as C,aD as D,a6 as I,bc as A,l as x,V as S,W as O}from"./index-bfdeed22.js";import{o as F}from"./index-de590a0b.js";import{c as K}from"./cloneDeep-755637cb.js";import{S as w,g as P}from"./index-7ccf88e4.js";import{a as _,b as U}from"./infoCollection-0e99d990.js";import"./index-a27cc2fe.js";import{f as R}from"./trial-8da1b678.js";import{L as N}from"./product-7bbf9c44.js";const T={key:0},j={class:"custom-field"},E={key:1,class:"flex-field"},$={class:"pro-radio-wrap"},Y={key:2},J={class:"pro-radio-wrap"},M={class:"custom-field"},q={key:1},B={key:3},G={class:"custom-field"},X={key:1},z={class:"custom-field"},H={key:0},W={key:1},Q={key:4},Z=e({name:"BaoeBaofei"});var ee=V(e({...Z,props:{originData:{default:()=>({})},modelValue:{default:()=>({})},defaultValue:{default:()=>({})},trialResult:{default:0}},emits:["update:modelValue","trialChange"],setup(e,{emit:V}){const f=e,g=a({hadSetDefault:!1}),h=l(),L=l(),C=l(0),D=()=>2===h.value.saleMethod?{label:"保费",key:"unitPremium"}:{label:"保额",key:"unitAmount"},I=()=>{switch(`${h.value.displayUnit}`){case _.YUAN:return"元";case _.MONTH_SALARY:return"倍月薪";case _.MILLION:return"万元";case _.COPY:return"份"}return""},A=i((()=>2===h.value.saleMethod?{label:"保费",key:"unitPremium"}:{label:"保额",key:"unitAmount"})),x=(...e)=>{if(1===C.value){const e=L.value[A.value.key],a=f.originData.minStepValue,l=f.originData.maxStepValue,i=f.originData.stepValue;if(+e>=+l)L.value[A.value.key]=l;else if(+e<=+a)L.value[A.value.key]=a;else{const l=+e-+a,t=Math.floor(l/+i);l%+i!=0&&(L.value[A.value.key]=+a+t*+i)}}return!0},S=i((()=>{if(h.value.displayValues){const e=D().key;return 1!==h.value.displayValues.length||L.value.riskCode||(L.value[e]=h.value.displayValues[0].code),h.value.displayValues.map((e=>({label:e.value,value:e.code})))}return[]})),O=()=>{};return t((()=>{})),u((()=>h),(e=>{(()=>{const{displayType:e,requireCopies:a,displayValues:l,initialAmount:i,copiesAmount:t,minCopiesValue:u,maxCopiesValue:o}=h.value,n=D().key,s=!L.value.riskCode;`${e}`===U.STEP?C.value=1:`${e}`===U.FIXED&&2===a?(C.value=2,l.length>=1&&s&&!L.value[n]&&(L.value[n]=l[0].code||l[0].value)):`${e}`===U.FIXED&&1===a?(C.value=3,u===o&&s&&!L.value.copy&&(L.value.copy=u),l.length>=1&&s&&!L.value[n]&&(L.value[n]=l[0].code||l[0].value)):`${e}`===U.COPY&&(C.value=4,u===o&&s&&!L.value.copy&&(L.value.copy=u),s&&!i&&(L.value.unitAmount=t))})()}),{deep:!0}),u((()=>f.defaultValue),(e=>{(null==e?void 0:e.riskCode)&&!g.hadSetDefault&&(g.hadSetDefault=!0,L.value={...L.value,unitAmount:e.unitAmount,unitPremium:e.unitPremium,copy:e.copy})}),{deep:!0,immediate:!0}),u((()=>f.originData),(e=>{h.value=e}),{immediate:!0,deep:!0}),u((()=>f.modelValue),(e=>{L.value=e}),{deep:!0,immediate:!0}),u((()=>L.value),(e=>{(()=>{if(1===C.value){const e=L.value[A.value.key],a=f.originData.minStepValue,l=f.originData.maxStepValue,i=f.originData.stepValue;if(+e>+l)return!1;if(+e<+a)return!1;if((+e-+a)%+i!=0)return!1}return!0})()&&(V("update:modelValue",e),V("trialChange",e))}),{deep:!0,immediate:!0}),(e,a)=>{const l=w,i=b,t=k;return o(),n(p,null,[1===C.value?(o(),n("div",T,[s(i,{label:`基本${m(A).label}`,name:m(A).key,class:"risk-select-field"},{input:d((()=>[r("div",j,[s(l,{modelValue:L.value[m(A).key],"onUpdate:modelValue":a[0]||(a[0]=e=>L.value[m(A).key]=e),"input-width":"80px","default-value":e.originData.minStepValue,min:e.originData.minStepValue,step:e.originData.stepValue,max:e.originData.maxStepValue,theme:"round",onBlur:x},null,8,["modelValue","default-value","min","step","max"])])])),_:1},8,["label","name"])])):2===C.value?(o(),n("div",E,[s(i,{modelValue:L.value[m(A).key],"onUpdate:modelValue":a[2]||(a[2]=e=>L.value[m(A).key]=e),label:`基本${m(A).label}`,name:m(A).key,class:"risk-select-field"},{input:d((()=>[r("div",$,[s(t,{modelValue:L.value[m(A).key],"onUpdate:modelValue":a[1]||(a[1]=e=>L.value[m(A).key]=e),options:m(S),onclick:O},null,8,["modelValue","options"])])])),_:1},8,["modelValue","label","name"])])):3===C.value?(o(),n("div",Y,[s(i,{modelValue:L.value[m(A).key],"onUpdate:modelValue":a[4]||(a[4]=e=>L.value[m(A).key]=e),label:`基本${m(A).label}`,name:m(A).key,class:"risk-select-field"},{input:d((()=>[r("div",J,[s(t,{modelValue:L.value[m(A).key],"onUpdate:modelValue":a[3]||(a[3]=e=>L.value[m(A).key]=e),options:m(S),onclick:O},null,8,["modelValue","options"])])])),_:1},8,["modelValue","label","name"]),r("div",null,[s(i,{modelValue:L.value.copy,"onUpdate:modelValue":a[6]||(a[6]=e=>L.value.copy=e),label:"份数",name:"copy",class:"risk-select-field"},{input:d((()=>[r("div",M,[e.originData.minCopiesValue!==e.originData.maxCopiesValue?(o(),c(l,{key:0,modelValue:L.value.copy,"onUpdate:modelValue":a[5]||(a[5]=e=>L.value.copy=e),"input-width":"80px","default-value":e.originData.minCopiesValue,min:e.originData.minCopiesValue||1,step:1,max:e.originData.maxCopiesValue,theme:"round"},null,8,["modelValue","default-value","min","max"])):(o(),n("span",q,v(e.originData.minCopiesValue),1))])])),_:1},8,["modelValue"])])])):4===C.value?(o(),n("div",B,[s(i,{modelValue:L.value.copy,"onUpdate:modelValue":a[8]||(a[8]=e=>L.value.copy=e),label:"份数",name:"copy",class:"risk-select-field"},{input:d((()=>[r("div",G,[e.originData.minCopiesValue!==e.originData.maxCopiesValue?(o(),c(l,{key:0,modelValue:L.value.copy,"onUpdate:modelValue":a[7]||(a[7]=e=>L.value.copy=e),"input-width":"64px","default-value":e.originData.minCopiesValue,min:e.originData.minCopiesValue||1,step:1,max:e.originData.maxCopiesValue,theme:"round"},null,8,["modelValue","default-value","min","max"])):(o(),n("span",X,v(e.originData.minCopiesValue),1))])])),_:1},8,["modelValue"]),s(i,{label:m(A).label,name:"copyAmount",class:"risk-select-field"},{input:d((()=>[r("div",z,[e.originData.minCopiesValue!==e.originData.maxCopiesValue?(o(),n("span",H,v(+e.originData.copiesAmount*+L.value.copy+I()),1)):(o(),n("span",W,v(+e.originData.minCopiesValue*+e.originData.copiesAmount+I()),1))])])),_:1},8,["label"])])):y("",!0),2===h.value.saleMethod&&e.trialResult>0?(o(),n("div",Q,[s(i,{label:"保额",class:"risk-select-field"},{input:d((()=>[r("span",null,v(e.trialResult),1)])),_:1})])):y("",!0)],64)}}}),[["__scopeId","data-v-1ca00c86"]]);const ae=[{name:"年金领取期间",type:"checkbox",configKey:["annuityDrawValueList"],valueKey:"annuityDrawDate"},{name:"领取频率",type:"checkbox",configKey:["annuityDrawFrequencyList"],valueKey:"annuityDrawFrequency"},{name:"交费方式",type:"checkbox",configKey:["paymentFrequencyList"],valueKey:"paymentFrequency",ruleKey:"paymentTypeRule"},{name:"交费期间",type:"checkbox",configKey:["paymentPeriodValueList"],valueKey:"chargePeriod",ruleKey:"paymentPeriodRule",ruleValueKey:"chargePeriod"},{name:"保障期间",type:"checkbox",configKey:["insurancePeriodValueList"],valueKey:"coveragePeriod",ruleKey:"insurancePeriodRule",ruleValueKey:"chargePeriod"}];const le={class:"pro-radio-wrap"},ie=e({name:"ProductKeys"});var te=V(e({...ie,props:{originData:{default:()=>({})},modelValue:{default:()=>({})},riskInfo:{default:()=>({})},defaultValue:{default:()=>({})},useData:{default:()=>({})}},emits:["trialChange","inputChange"],setup(e,{emit:a}){const v=e,V=l(v.originData),g=l(v.modelValue);l(1);const h=i((()=>e=>{const a=P(v.originData,e),l=P(v.defaultValue,e);return(a||[]).map((e=>{const a=l?l.find((a=>a.code===e.code)):null;return{label:e.value,value:e.code,disabled:!!(null==a?void 0:a.useFlag)&&1!==a.useFlag}}))})),L=()=>{ae.forEach((e=>{const a=P(v.originData,e.configKey);"checkbox"===e.type&&a&&a.length>0&&!g.value.riskCode&&(g.value[e.valueKey]=a[0].code)}))};return t((()=>{L()})),u((()=>v.defaultValue),(e=>{(null==e?void 0:e.riskCode)&&(g.value=JSON.parse(JSON.stringify(e)))}),{deep:!0,immediate:!0}),u((()=>v.modelValue),(e=>{Object.assign(g.value,e)}),{deep:!0,immediate:!0}),u((()=>V.value),(e=>{L()}),{deep:!0,immediate:!0}),u((()=>JSON.stringify(g.value)),((e,l)=>{const i=e&&JSON.parse(e)||{};console.log("---v new = ",i);const t=l&&JSON.parse(l)||{};let u=null;ae.forEach((e=>{i[e.valueKey]&&t[e.valueKey]&&i[e.valueKey]!==t[e.valueKey]&&(u||(u={key:e.valueKey,oldValue:t[e.valueKey],newValue:i[e.valueKey],riskCode:v.riskInfo.riskCode}))})),e&&a("trialChange",JSON.parse(e),u)}),{deep:!0,immediate:!0}),(e,a)=>{const l=k,i=b;return o(!0),n(p,null,f(m(ae),(a=>(o(),n(p,null,[m(P)(e.originData,a.configKey)?(o(),n("div",{key:e.riskInfo.riskCode+"_"+a.name},["checkbox"===a.type?(o(),c(i,{key:0,modelValue:g.value[a.valueKey],"onUpdate:modelValue":e=>g.value[a.valueKey]=e,label:a.name,name:a.valueKey,class:"risk-select-field"},{input:d((()=>[r("div",le,[s(l,{modelValue:g.value[a.valueKey],"onUpdate:modelValue":[e=>g.value[a.valueKey]=e,e=>((e,a)=>{console.log("-------change",e,a)})(e,a.valueKey)],options:m(h)(a.configKey)},null,8,["modelValue","onUpdate:modelValue","options"])])])),_:2},1032,["modelValue","onUpdate:modelValue","label","name"])):y("",!0)])):y("",!0)],64)))),256)}}}),[["__scopeId","data-v-080652a0"]]);const ue={class:"com-risk-liabilityinfo"},oe={class:"item-wrap"},ne={key:0},se=(e=>(C("data-v-7cfce85f"),e=e(),D(),e))((()=>r("div",{class:"cell-content"},null,-1))),de=e({name:"riskLiabilityInfo"});var re=V(e({...de,props:{dataSource:{default:()=>({})},modelValue:{default:()=>({})},dataSourceFolmulate:{default:()=>({})},params:{default:()=>({amountUnit:"",basicsAmount:"",basicsPremium:"",riskId:""})},defaultValue:{default:()=>({})}},emits:["trialChange"],setup(e,{emit:a}){const v=e,V=l({formInfo:v.dataSource,isCheckList:[],checkValueList:[],liabilityList:[],signLiabilityClick:[]}),C=(e,a)=>{V.value.signLiabilityClick.push({item:e,index:a})},D=(e,a)=>{const{riskLiabilityInfoVOList:l,riskLiabilityCollocationVOList:i}=v.dataSource,t=l[e].liabilityId,u=(i||[]).find((e=>e.relatedLiabilityId===t||e.collocationLiabilityId===t))||{};let o=null;u.collocationLiabilityId===t?(o=u.relatedLiabilityId,u.collocationType===N.YI_LAI&&(o=u.collocationLiabilityId)):o=u.collocationLiabilityId;const n=l.findIndex((e=>e.liabilityId===o));((e,a,l)=>{V.value.isCheckList[e]===`${I.YES}`?l===N.BANG_DING||l===N.YI_LAI?V.value.isCheckList[a]="1":V.value.isCheckList[a]="2":l===N.BANG_DING?V.value.isCheckList[a]="2":l===N.YI_LAI&&(V.value.isCheckList[a]=e!==a?"3":"2")})(e,n,u.collocationType),a(l[n],n,!0)},A=(e,a,l)=>{var i,t;const u=((null==(i=V.value)?void 0:i.liabilityList)||[]).map((e=>e.key)),o=0===(null==e?void 0:e.liabilityAttributeValueList.length)&&0===(null==e?void 0:e.formula.length),n=V.value.isCheckList[a];o&&-1===u.indexOf(a)&&n&&V.value.liabilityList.push({liabilityValue:e,key:a,isSwitchOn:V.value.isCheckList[a]}),"1"===n?C(e,a):V.value.signLiabilityClick.splice(a,1),-1!==u.indexOf(a)&&((null==(t=V.value)?void 0:t.liabilityList)||[]).forEach((e=>{e.key===a&&(e.isSwitchOn=V.value.isCheckList[a])})),l||D(a,A)},x=(e,a)=>{const l=e.liabilityAttributeValueList.filter((e=>e.displayValue===V.value.checkValueList[a])),i=JSON.parse(JSON.stringify(l))[0]||e.liabilityAttributeValueList[0],t={...e,liabilityValue:i};V.value.liabilityList.length>0&&Object.keys(V.value.checkValueList).indexOf(a)&&(V.value.liabilityList=V.value.liabilityList.filter((e=>e.key!==a))),V.value.checkValueList[a]=i.displayValue,V.value.liabilityList.push({liabilityValue:t,key:a,isSwitchOn:"1"})},S=i((()=>K(v.dataSourceFolmulate))),O=(e,a,l)=>{1===l?V.value.liabilityList.push({liabilityValue:{...e,liabilityValue:null==e?void 0:e.liabilityAttributeValueList[0]},key:a,isSwitchOn:"1"}):V.value.liabilityList.push({liabilityValue:{...e,liabilityValue:null==e?void 0:e.liabilityAttributeValueList[0]},key:a,isSwitchOn:"2"})};u((()=>S.value),((e,a)=>{var l,i,t;const u=null==(l=v.dataSourceFolmulate)?void 0:l.initialAmount,o=null==(i=v.dataSourceFolmulate)?void 0:i.initialPremium,n={amountUnit:v.params.amountUnit,basicsAmount:u,basicsPremium:o,riskId:v.params.riskId};((null==(t=null==v?void 0:v.dataSource)?void 0:t.riskLiabilityInfoVOList)||[]).map((async l=>{if(l.formula.length>0&&(u||o)&&((null==e?void 0:e.initialAmount)!==(null==a?void 0:a.initialAmount)||(null==e?void 0:e.initialPremium)!==(null==a?void 0:a.initialPremium))){const{code:e,data:a}=await R({...n,riskLiabilities:[l]});if("10000"===e){if(l.liabilityAttributeValueList=a[0].formulaResult,V.value.signLiabilityClick.length>0){const e=V.value.signLiabilityClick.find((e=>e.item.liabilityCode===l.liabilityCode));e&&x(e.item,e.index)}return{...l,liabilityAttributeValueList:a[0]}}return l}}))}),{deep:!0,immediate:!0}),u((()=>V.value.liabilityList),g((e=>{const l=V.value.liabilityList.filter((e=>"1"===e.isSwitchOn)).map((e=>({...e.liabilityValue})));a("trialChange",l)}),300),{deep:!0,immediate:!0}),t((()=>{var e;console.log("----mounted"),((null==(e=null==v?void 0:v.dataSource)?void 0:e.riskLiabilityInfoVOList)||[]).map(((e,a)=>{const l=e.liabilityAttributeValueList.length>0&&0===e.formula.length&&e.liabilityAttributeValueList[0].displayValue;return V.value.checkValueList[a]||(V.value.checkValueList[a]=l),1!=+e.showFlag&&V.value.liabilityList.push({liabilityValue:e,key:a,isSwitchOn:"1"}),1==+e.showFlag&&(1===e.attributeFlag&&2===e.insureFlag&&0===e.formula.length&&O(e,a,1),1===e.attributeFlag&&1===e.insureFlag&&0===e.formula.length&&O(e,a,2),2===e.attributeFlag&&1===(null==e?void 0:e.liabilityAttributeValueList.length)&&2===e.insureFlag&&O(e,a,1),2===e.attributeFlag&&1===(null==e?void 0:e.liabilityAttributeValueList.length)&&1===e.insureFlag&&O(e,a,2)),null}))}));const F=l([]);return u((()=>v.dataSource.riskLiabilityInfoVOList),g((e=>{F.value=(e||[]).map((e=>{const a=(v.dataSource.riskLiabilityCollocationVOList||[]).find((a=>a.collocationLiabilityId===e.liabilityId));return{...e,relation:null==a?void 0:a.collocationType}}))}),300),{deep:!0,immediate:!0}),u((()=>v.defaultValue),g((e=>{var a;(null==e?void 0:e.riskCode)&&e.liabilityList&&(V.value.signLiabilityClick=[],((null==(a=null==v?void 0:v.dataSource)?void 0:a.riskLiabilityInfoVOList)||[]).forEach(((a,l)=>{var i;const t=null==e?void 0:e.liabilityList.find((e=>e.liabilityCode===a.liabilityCode));t&&(V.value.isCheckList[l]="1",V.value.checkValueList[l]=null==(i=null==t?void 0:t.liabilityValue)?void 0:i.displayValue,1==+a.showFlag&&2==+a.optionalFlag?A(a,l):C(a,l))})))}),300),{deep:!0,immediate:!0}),(e,a)=>{const l=h,i=b,t=L;return o(),c(t,null,{default:d((()=>[r("div",ue,[r("div",oe,[(o(!0),n(p,null,f(m(F),((e,a)=>(o(),n("div",{key:a},[1!=+e.showFlag||2===e.attributeFlag&&1===(null==e?void 0:e.liabilityAttributeValueList.length)&&2===e.insureFlag?y("",!0):(o(),n("div",ne,[(m(V).isCheckList[a]?"3"!==m(V).isCheckList[a]:e.relation!==m(N).YI_LAI)?(o(),c(i,{key:0,label:`${e.liabilityName}`,"label-width":"44%",name:"insuredRelation",class:"riskliab-select-field"},{input:d((()=>[1==+e.insureFlag?(o(),c(l,{key:0,modelValue:m(V).isCheckList[a],"onUpdate:modelValue":e=>m(V).isCheckList[a]=e,"active-value":"1","inactive-value":"2",size:"0.68rem",onClick:l=>A(e,a)},null,8,["modelValue","onUpdate:modelValue","onClick"])):y("",!0)])),_:2},1032,["label"])):y("",!0),1==+m(V).isCheckList[a]&&1===e.attributeFlag||1===e.attributeFlag&&2===e.insureFlag?(o(),c(i,{key:1,label:e.liabilityAttributeTypeDesc,"label-width":"44%",name:"insuredRelation",class:"riskliab-select-field-children"},{input:d((()=>[s(k,{modelValue:m(V).checkValueList[a],"onUpdate:modelValue":e=>m(V).checkValueList[a]=e,prop:{label:"displayValue",value:"displayValue"},options:(e.formula.length,e.liabilityAttributeValueList),"is-simply":!0,onClick:l=>x(e,a)},null,8,["modelValue","onUpdate:modelValue","options","onClick"])])),_:2},1032,["label"])):y("",!0)]))])))),128))])]),se])),_:1})}}}),[["__scopeId","data-v-7cfce85f"]]);const me=e({name:"InsureInfos"}),ce=e({...me,props:{originData:{default:()=>({})},modelValue:{default:()=>({})},defaultValue:{default:()=>({})},trialResult:{default:0}},emits:["trialChange"],setup(e,{expose:i,emit:n}){const r=e,v=l(null),y=l({}),p=l({}),V=a({personalInfo:{},basicsAmount:"",basicsPremium:"",defaultValues:r.defaultValue,changeData:null,sValues:y.value});A("premium"),p.value=A("enumList")||{},t((()=>{}));const b=e=>{r.originData.mainRiskFlag,y.value.riskCategory=r.originData.riskCategory,y.value.riskCode=r.originData.riskCode,y.value.riskId=r.originData.riskId,y.value.riskType=r.originData.riskType,y.value.riskName=r.originData.riskName,y.value.riskType=r.originData.riskType,y.value.mainRiskCode=r.originData.mainRiskCode,y.value.mainRiskId=r.originData.mainRiskId,y.value.exemptFlag=r.originData.exemptFlag,e?n("trialChange",y.value,e):n("trialChange",y.value)},k=(e,a)=>{a?y.value[a.key]=a.newValue:F(e).forEach((a=>{y.value[a]=e[a]})),b(a)},f=e=>{var a,l,i;1==+(null==(i=null==(l=null==(a=r.originData)?void 0:a.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO)?void 0:i.saleMethod)?V.basicsAmount=null==e?void 0:e.initialAmount:V.basicsAmount=null==e?void 0:e.initialPremium,F(e).forEach((a=>{y.value[a]=e[a]})),b()},g=e=>{y.value.liabilityList=e,b()};return u((()=>r.defaultValue),(e=>{e&&(console.log("--default change ",e),V.defaultValues=K(e),y.value={...e})}),{deep:!0,immediate:!0}),u((()=>y.value),(e=>{V.sValues=e}),{deep:!0,immediate:!0}),i({validate:async()=>{var e;await(null==(e=v.value)?void 0:e.validate())}}),(e,a)=>{const l=x("dev");return S((o(),c(l,null,{default:d((()=>{var a,l,i,t,u;return[s(m(ee),{"v-model":m(V).sValues,"origin-data":null==(l=null==(a=e.originData)?void 0:a.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO,"default-value":m(V).defaultValues,"trial-result":e.trialResult,onTrialChange:f},null,8,["v-model","origin-data","default-value","trial-result"]),s(m(te),{"v-model":m(V).sValues,"use-data":m(V).sValues,"origin-data":e.originData.productRiskInsureLimitVO,"risk-info":e.originData,"default-value":m(V).defaultValues,onTrialChange:k},null,8,["v-model","use-data","origin-data","risk-info","default-value"]),s(m(re),{"data-source-folmulate":m(y),"data-source":e.originData,params:{amountUnit:null==(t=null==(i=e.originData)?void 0:i.productRiskInsureLimitVO)?void 0:t.amountPremiumConfigVO.displayUnit,basicsAmount:m(V).basicsAmount,basicsPremium:m(V).basicsPremium,riskId:null==(u=e.originData)?void 0:u.riskId},"default-value":m(V).defaultValues,onTrialChange:g},null,8,["data-source-folmulate","data-source","params","default-value"])]})),_:1},512)),[[O,e.originData.exemptFlag===m(I).NO]])}}});export{ce as _};
