!function(){var e=document.createElement("style");e.innerHTML='.free-card .page-info-wrapper .com-card-wrap .header.showLine{display:none}.free-card .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell{background:#f6f6f6;border-radius:.21333rem;margin-bottom:.32rem;min-height:1.17333rem;padding:0 .42667rem;display:flex;align-items:center}.free-card .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell .van-field__label{width:1.82667rem;margin-top:0;margin-bottom:0;padding-right:.13333rem}.free-card .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell .van-cell__value .van-field__body{width:100%}.free-card .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell:after{border-bottom:0}.free-card .page-info-wrapper .com-card-wrap .van-cell:after{border-bottom:0}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-field__label{width:1.76rem;margin-top:0;margin-bottom:0;padding-right:.13333rem}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body{width:100%}.free-card .page-info-wrapper .com-card-wrap .van-cell.relation-holder{padding-right:0;padding-left:0}.free-card .page-info-wrapper .com-card-wrap .van-cell.relation-holder:before{content:" ";margin-top:.13333rem;width:.10667rem;height:.48rem;background:var(--van-primary-color);margin-right:.21333rem;border-radius:0px .12rem .12rem 0px}.free-card .page-info-wrapper .com-card-wrap .van-cell.relation-holder .van-cell__title{margin-top:.10667rem}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap{width:100%}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap .radio-btn{display:flex;justify-content:flex-start}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap .radio-btn .btn-wrapper{margin:0}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap .radio-btn .btn-wrapper .com-check-btn{min-width:1.33333rem;border-radius:.53333rem!important;margin:0 .10667rem .13333rem 0}.free-card .page-info-wrapper .com-card-wrap .van-cell .van-cell:after{border-bottom:0}.free-card[data-v-1ca348ab]{padding:0 .42667rem;background:linear-gradient(var(--4c27741b),var(--4c27743a))}.free-card .container[data-v-1ca348ab]{padding:.61333rem .53333rem .26667rem;background:#ffffff;text-align:center;border-radius:.53333rem}.free-card .container .title[data-v-1ca348ab]{height:.44rem;margin-bottom:.53333rem;display:flex;align-items:center;justify-content:center}.free-card .container .title .svg-icon[data-v-1ca348ab]{font-size:1.12rem;color:var(--van-primary-color)}.free-card .container .title span[data-v-1ca348ab]{font-size:.42667rem;font-family:PingFangSC-Semibold,PingFang SC;font-weight:600;color:#333;line-height:.42667rem;margin:0 .29333rem}.free-card .container .title img[data-v-1ca348ab]{height:.4rem}.free-card .container .holder-form[data-v-1ca348ab]{height:4.66667rem}.page-free-product-detail[data-v-9e9ab874]{background:var(--42df68bd);padding-bottom:3.14667rem}.page-free-product-detail .inscribedContent-content[data-v-9e9ab874]{background-color:transparent}.page-free-product-detail .submit-btn[data-v-9e9ab874]{margin-top:.4rem}.page-free-product-detail .product-desc[data-v-9e9ab874]{margin-top:.42667rem}.page-free-product-detail .product-desc img[data-v-9e9ab874]{width:100%}.page-free-product-detail .page-free-footer[data-v-9e9ab874]{position:fixed;width:100%;bottom:0;padding:0 .93333rem .93333rem;box-sizing:border-box}\n',document.head.appendChild(e),System.register(["./index-legacy-f6186c79.js","./product-legacy-ab198082.js","./trial-legacy-c82fa601.js","./phoneVerify-legacy-23be493c.js","./index-legacy-96da8e1b.js","./nextStep-legacy-3950ebb1.js","./trial-legacy-71cf4847.js","./utils-legacy-b0278eb0.js","./theme-legacy-14f266cb.js","./index-legacy-22386261.js","./index-legacy-d64fe8b2.js","./pdfdist-legacy-3ac4c460.js","./logo-legacy-553bc5c2.js","./core-legacy-d21bc5e7.js","./index-legacy-6167ce30.js","./useStorage-legacy-4567831e.js","./infoCollection-legacy-ce2a7594.js","./relativeTime-legacy-e88ead08.js","./validator-legacy-5e43cc69.js","./useDicData-legacy-c93d5753.js"],(function(e,t){"use strict";var r,a,n,o,i,d,l,c,s,u,p,f,m,w,v,g,b,y,h,I,_,O,x,C,D,V,j,F,T,P,k,L,N,A,H,S,Y,E,M,B,R,$,z,U,J,q,G,W;return{setters:[function(e){r=e._,a=e.d,n=e.aY,o=e.r,i=e.z,d=e.a7,l=e.b,c=e.c,s=e.g,u=e.i,p=e.f,f=e.t,m=e.e,w=e.l,v=e.a8,g=e.aZ,b=e.u,y=e.a,h=e.x,I=e.y,_=e.a_,O=e.a2,x=e.a$,C=e.w,D=e.j,V=e.h,j=e.F,F=e.b0,T=e.T,P=e.b1,k=e.$},function(e){L=e.p,N=e.g},function(e){A=e.i,H=e.t},function(e){S=e.a,Y=e.s,E=e.c},function(e){M=e.u,B=e.B,R=e.P},function(e){$=e.n},function(e){z=e.j},function(e){U=e.v,J=e.f},function(e){q=e.u},function(e){G=e.default},function(e){W=e.default},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){},function(){}],execute:function(){const X={class:"free-card"},Z={class:"container"},K={class:"title"},Q=a({props:{colors:{type:Array,default:()=>["#CDDFFE","#F1F7FE"]},detail:{type:Object,default:()=>{}},isFirst:{type:Boolean,default:!0},insureDetail:{type:Object,default:()=>{}},previewMode:{type:Boolean,default:!1}},setup(e,{expose:t}){const r=e;n((e=>({"4c27741b":r.colors[0],"4c27743a":r.colors[1]})));const a=o(),g=i({factorObj:{1:[{attributeValues:null,code:"mobile",datasource:null,defaultValue:null,displayType:null,factorId:null,factorScript:null,hasDefaultValue:1,id:8249,isDisplay:1,isHidden:1,isMustInput:1,isReadOnly:null,moduleType:1,placeholder:null,planCode:null,position:null,productCode:"lin23323",productId:null,title:"手机号"},{attributeValues:null,code:"verificationCode",datasource:null,defaultValue:null,displayType:null,factorId:null,factorScript:null,hasDefaultValue:1,id:8249,isDisplay:1,isHidden:1,isMustInput:1,isReadOnly:null,moduleType:1,placeholder:null,planCode:null,position:null,productCode:"lin23323",productId:null,title:"验证码"}],2:[],3:[]},isFirst:!0}),b=async({mobile:e,type:t},n)=>{if(a.value){if(r.previewMode)return void n?.();a.value?.validateForm(`${t}_mobile`).then((async()=>{const t=r.isFirst?S:Y,a=await t(e),{code:o,data:i}=a;"10000"===o&&n?.()}))}};return d((()=>r.isFirst),(()=>{r.isFirst||(g.factorObj=r.insureDetail?.productFactor)})),t({validateForm:()=>new Promise(((e,t)=>{a.value.validateForm().then((t=>{e(!0)})).catch((()=>{t()}))}))}),(t,r)=>{const n=l("ProSvg");return c(),s("div",X,[u("div",Z,[u("div",K,[p(n,{name:"free-arrow"}),u("span",null,f(e.isFirst?"凭手机号 免费领取":"最后一步 填写信息"),1),p(n,{name:"free-arrow"})]),(c(),m(W,{ref_key:"formRef",ref:a,key:e.isFirst?1:2,"send-sms-code":b,"need-desensitize":"","form-info":e.detail,"factor-object":w(g).factorObj},null,8,["form-info","factor-object"])),v(t.$slots,"default",{},void 0,!0)])])}}});var ee=r(Q,[["__scopeId","data-v-1ca348ab"]]);const te={class:"page-free-product-detail"},re={class:"product-desc"},ae={key:1,class:"page-free-footer"};e("default",r(a({setup(e){n((e=>({"42df68bd":w(fe).colors[1]})));const r=g((()=>F((()=>t.import("./index-legacy-6b90b18d.js")),void 0))),a=g((()=>F((()=>t.import("./index-legacy-e685d764.js")),void 0))),f=g((()=>F((()=>t.import("./index-legacy-33aaadcd.js")),void 0))),v=q(),S=b(),Y=y(),{productCode:W="",agencyCode:X="",tenantId:Z="",saleUserId:K="",saleChannelId:Q="",extraInfo:ne,preview:oe}=Y.query;let ie={};try{ie=JSON.parse(decodeURIComponent(ne))}catch(_e){}const{openId:de,indirectCode:le="",agentCode:ce}=ie,se=o(),ue=o(),pe=o(),fe=i({colors:["#fff"],detail:{},order:{tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}},relationList:{},banner:"",productDesc:[],newAuth:!0,isValidateCode:!1,insureDetail:{},loading:!0,isSelfInsure:!0,showBtn:!1,activeIndex:0,showFilePreview:!1,isOnlyView:!0}),me=o();de&&M({openId:de},(e=>{fe.relationList=e}));const we=h((()=>!!oe)),ve=()=>{const e=fe.insureDetail.productRiskVoList||[],{insuranceEndType:t,riskInsureLimitVO:r}=e?.[0]?.riskDetailVOList?.[0]||{},{insurancePeriodValueList:a}=r||{},[n,o]=(a?.[0]||"").split("_");return 1===t?`${k(new Date).add(o||0,n).format("YYYY-MM-DD")} 23:59:59`:t?`${k(new Date).add(o,n).format("YYYY-MM-DD")} 00:00:00`:""},ge=async()=>{fe.loading=!0;const e=L({productCode:W,withInsureInfo:!0,tenantId:Z}),t=A({productCode:W}),r=N({openId:de});await Promise.all([e,t,r]).then((([e,t,r])=>{if("10000"===e.code){fe.detail=e.data,fe.banner=fe.detail.tenantProductInsureVO?.banner[0];const{colorEnd:t,colorStart:r}=fe.detail.tenantProductInsureVO?.backgroundInsureVO||{};fe.colors=[r,t],fe.productDesc=fe.detail.tenantProductInsureVO.spec||[],document.title=fe.detail?.tenantProductInsureVO?.productName||""}if("10000"===t.code&&(fe.insureDetail=t.data,fe.insureDetail.productFactor[1].forEach((e=>{"verificationCode"===e.code&&1===e.isDisplay&&(fe.isValidateCode=!0)})),fe.insureDetail.productFactor[2]=fe.insureDetail.productFactor?.[2].map((e=>("relationToHolder"===e.code&&1===e.isDisplay&&(e.title="被保人",fe.order.tenantOrderInsuredList[0].relationToHolder=e.attributeValueList?.[0]?.code||""),e)))),"10000"===r.code&&(fe.newAuth=!r.data,fe.isSelfInsure=!!r.data,r.data)){const e=r.data;fe.order.tenantOrderHolder={certNo:e?.certiNo,extInfo:{},mobile:e?.mobile,name:e?.name}}(()=>{let e={};if(e=fe.detail.tenantProductInsureVO.planInsureVO?.attachmentVOList||[],!e)return void(me.value=[]);const t={2:"richText",3:"link"};me.value=Object.keys(e).map((r=>(e[r].forEach((e=>{if("1"===e.attachmentType){const t=e.attachmentUri.split("?"),r=t[0].substr(t[0].lastIndexOf(".")+1);e.attachmentType="pdf"===r?"pdf":"picture"}else e.attachmentType=t[e.attachmentType]})),{attachmentName:r,attachmentList:e[r]})))||[]})(),fe.loading=!1}))},be=async()=>{let e={loginType:"2",openId:de,thirdUserType:"XINAO_WECHAT",indirectCode:le};try{if(fe.newAuth?(e.loginName=fe.order.tenantOrderHolder.mobile,e.password=fe.order.tenantOrderHolder.verificationCode):e=J({order:fe.order,tenantId:Z,extraInfo:ie,commencementTime:1===((fe.insureDetail.productRiskVoList||[])?.[0]?.riskDetailVOList?.[0]?.insuranceStartType||1)?`${k(new Date).format("YYYY-MM-DD")} 00:00:00`:`${k(new Date).add(1,"day").format("YYYY-MM-DD")} 00:00:00`,expiryDate:ve(),detail:fe.detail,insureDetail:fe.insureDetail,iseeBizNo:se.value,agentCode:ce,agencyCode:X,saleUserId:K,templateId:ie?.templateId,saleChannelId:Q,pageCode:"infoCollection",buttonCode:"EVENT_FREE_multiIssuePolicy"}),fe.newAuth)if(we.value)fe.newAuth=!1;else{const{code:t,data:r}=await H(e);"10000"===t&&(fe.newAuth=!1)}else $(e,((e,t)=>{t===P.JUMP_PAGE&&e.orderNo&&S.push(`/baseInsurance/orderDetail?from=free&tenantId=${Z}&orderNo=${e.orderNo}`)}))}catch(t){}},ye=async()=>await(async()=>{if(we.value)return!0;await pe.value.validateForm();const e=fe.order.tenantOrderHolder?.verificationCode;if((fe.isValidateCode||fe.newAuth)&&(!e||!U(e)))return T({message:"请输入正确的验证码"}),!1;if(fe.newAuth||!fe.isValidateCode)return!0;const{code:t,data:r}=await E(fe.order.tenantOrderHolder.mobile,e);return!!r})()?(fe.newAuth||0===me.value.length?be():(fe.isOnlyView=!1,fe.showFilePreview=!0),!1):null,he=()=>{fe.showFilePreview=!1,fe.isOnlyView=!0},Ie=()=>{fe.showFilePreview=!1,fe.isOnlyView=!0,be()};return I((()=>{ge(),setTimeout((async()=>{se.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),d((()=>fe.order.tenantOrderInsuredList[0]),(e=>{if(_(fe.relationList)||fe.newAuth)return null;const t=fe.relationList[e.relationToHolder]||[];if(1===t.length)if(z.SELF!==e.relationToHolder){const{certNo:e,name:r,mobile:a,certType:n}=fe.order.tenantOrderInsuredList[0];fe.order.tenantOrderInsuredList[0].certNo=e||t[0].cert[0].certNo,fe.order.tenantOrderInsuredList[0].name=r||t[0].cert[0].certName,fe.order.tenantOrderInsuredList[0].mobile=a||t[0].contact[0].contactNo,fe.order.tenantOrderInsuredList[0].certType=n||t[0].cert[0].certType||O.CERT}else if(fe.isSelfInsure){fe.isSelfInsure=!1;const{certNo:e,name:r,mobile:a,certType:n}=fe.order.tenantOrderHolder;fe.order.tenantOrderHolder.certNo=e||t[0].cert[0].certNo,fe.order.tenantOrderHolder.name=r||t[0].cert[0].certName,fe.order.tenantOrderHolder.mobile=a||t[0].contact[0].contactNo,fe.order.tenantOrderHolder[0].certType=n||t[0].cert[0].certType||O.CERT}return!1}),{immediate:!0,deep:!0}),x(ue,(([{isIntersecting:e}],t)=>{fe.showBtn=!e})),(e,t)=>{const n=l("van-image"),o=l("van-config-provider");return c(),m(o,{"theme-vars":w(v)},{default:C((()=>[u("div",te,[p(B,{url:w(fe).banner},null,8,["url"]),p(ee,{ref_key:"formRef",ref:pe,"is-first":w(fe).newAuth,"insure-detail":w(fe).insureDetail,detail:w(fe).order,colors:w(fe).colors,"preview-mode":w(we)},{default:C((()=>[p(G,{ref_key:"root",ref:ue,class:"submit-btn",disabled:!w(fe).newAuth&&w(we),"is-gradient":!1,text:w(fe).newAuth?"立即领取":"激活保障",onClick:ye},null,8,["disabled","text"]),!w(fe).newAuth&&me.value&&me.value.length>0?(c(),m(w(a),{key:0,"attachement-list":me.value,"has-bg-color":!1,"pre-text":"请阅读",onPreviewFile:t[0]||(t[0]=e=>(e=>{fe.isOnlyView=!0,fe.activeIndex=e,fe.showFilePreview=!0})(e))},null,8,["attachement-list"])):D("",!0)])),_:1},8,["is-first","insure-detail","detail","colors","preview-mode"]),u("div",re,[(c(!0),s(j,null,V(w(fe).productDesc,((e,t)=>(c(),m(n,{key:t,width:"100%","lazy-load":"",src:e,class:""},null,8,["src"])))),128))]),w(fe).detail?.tenantProductInsureVO?.inscribedContent?(c(),m(w(r),{key:0,"inscribed-content":w(fe).detail?.tenantProductInsureVO?.inscribedContent},null,8,["inscribed-content"])):D("",!0),w(fe).showBtn?(c(),s("footer",ae,[p(G,{disabled:!w(fe).newAuth&&w(we),"is-gradient":!1,text:w(fe).newAuth?"立即领取":"激活保障",onClick:ye},null,8,["disabled","text"])])):D("",!0)]),w(fe).showFilePreview&&0!==me.value.length?(c(),m(w(f),{key:0,show:w(fe).showFilePreview,"onUpdate:show":t[1]||(t[1]=e=>w(fe).showFilePreview=e),"content-list":me.value,"is-only-view":w(fe).isOnlyView,"active-index":w(fe).activeIndex,text:w(fe).isOnlyView?"关闭":"我已逐页阅读上述内容并同意","force-read-cound":0,"on-close-file-preview":"",onSubmit:Ie,onOnCloseFilePreview:he},null,8,["show","content-list","is-only-view","active-index","text"])):D("",!0),w(fe).loading?D("",!0):(c(),m(R,{key:1,"product-detail":w(fe).detail},null,8,["product-detail"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-9e9ab874"]]))}}}))}();
