import{d as e,i as a,bq as l,j as o,k as s,l as t,o as i,p as d,w as c,a as u,e as r,b as n,u as p,q as v,c as C,F as k,s as R,v as m,_ as f,T as y,z as h,br as b,bs as I,A as L,au as T,bo as _,bp as w}from"./index-8e0def42.js";import{d as S,e as g}from"./trial-23d7bced.js";import{R as V}from"./trial-cbe19304.js";const q={class:"popup-container"},K={class:"popup-header"},N={class:"title"},j=(e=>(_("data-v-6241eb10"),e=e(),w(),e))((()=>u("p",{class:"tip"},"已为您挑选出以下险种",-1))),A={class:"search"},P={key:0,class:"risk-list"},E=e({name:"riskSelect"});var M=f(e({...E,props:{type:{default:2},show:{type:Boolean,default:!1},title:{},insuredList:{default:()=>[]},mainRiskCode:{default:""},selectList:{default:()=>[]},currentProductCode:{default:""},productClass:{default:""}},emits:["cancel","confirm"],setup(e,{emit:f}){const _=e,w=a(),{insurerCode:E}=w.query,M=f,U=l(),x=o([]),D=o([]),F=o([]),$=o(),z=s((()=>_.show)),B=()=>{M("cancel")},G=()=>{var e;if(!(null==(e=x.value)?void 0:e.length))return void y(`暂未添加任何${_.type===V.MAIN_RISK?"主":"附加"}险`);let a=[];a=_.type===V.RIDER_RISK?x.value:D.value.filter((e=>x.value.includes(e.productCode))).map((e=>({productCode:e.productCode,mergeRiskReqList:(e.mainRiskCollocationList||[]).map((e=>({riskCode:e.collocationRiskCode,riskType:e.mainRiskCode?2:1,mainRiskCode:e.mainRiskCode})))}))),M("confirm",a)},H=async()=>{var e;const a={insuredList:_.insuredList,mainRiskCode:_.mainRiskCode,insurerCode:E,productCategory:"",keyword:$.value,selectProductCodes:[],selectRiskCodes:[],filterFlag:(null==(e=_.selectList)?void 0:e.length)?1:2,productClass:_.productClass,branchType:U["branch-type"]};if(a.selectProductCodes=_.selectList.map((e=>(e.productCode===_.currentProductCode&&a.selectRiskCodes.push(...e.mergeRiskReqList.map((e=>e.riskCode))),e.productCode))),_.type===V.MAIN_RISK){const{code:e,data:l}=await S(a);"10000"===e&&(D.value=l)}else{const{code:e,data:l}=await g(a);"10000"===e&&(D.value=l.riskInfoList,F.value=l.collocationInfoResList)}};return t((()=>{H()})),(e,a)=>{const l=h,o=b,s=I,t=L,f=T;return i(),d(f,{show:p(z),"onUpdate:show":a[2]||(a[2]=e=>v(z)?z.value=e:null),class:"popup-risk-select",closeable:!1},{default:c((()=>{var f;return[u("div",q,[u("div",K,[u("span",{class:"clear-all",onClick:B}," 取消 "),u("span",N,r(e.title),1),u("span",{class:"close",onClick:G},"确认")]),j,u("div",A,[n(l,{modelValue:p($),"onUpdate:modelValue":a[0]||(a[0]=e=>v($)?$.value=e:null),placeholder:"请输入产品名称进行搜索",onSearch:H},null,8,["modelValue"])]),(null==(f=p(D))?void 0:f.length)?(i(),C("div",P,[n(s,{modelValue:p(x),"onUpdate:modelValue":a[1]||(a[1]=e=>v(x)?x.value=e:null)},{default:c((()=>[(i(!0),C(k,null,R(p(D),(e=>(i(),d(o,{key:e.riskCode||e.productCode,name:e.riskCode||e.productCode,onClick:()=>{return a=e.riskCode,_.type===V.RIDER_RISK&&(F.value||[]).forEach((e=>{x.value.includes(a)?a===e.relatedRiskCode?(2===e.collocationType&&x.value.push(e.collocationRiskCode),3===e.collocationType&&(x.value.push(a),x.value=x.value.filter((a=>a!==e.collocationRiskCode)))):a===e.collocationRiskCode&&(2===e.collocationType&&x.value.push(e.relatedRiskCode),3===e.collocationType&&(x.value=x.value.filter((a=>a!==e.relatedRiskCode)))):a===e.relatedRiskCode?(2===e.collocationType&&(x.value=x.value.filter((a=>a!==e.collocationRiskCode))),3===e.collocationType&&(x.value.push(a),x.value=x.value.filter((a=>a!==e.collocationRiskCode)))):a===e.collocationRiskCode&&(2===e.collocationType&&(x.value=x.value.filter((a=>a!==e.relatedRiskCode))),3===e.collocationType&&(x.value=x.value.filter((a=>a!==e.relatedRiskCode))))})),void(x.value=[...new Set(x.value)]);var a}},{default:c((()=>[m(r(e.riskName||e.productName),1)])),_:2},1032,["name","onClick"])))),128))])),_:1},8,["modelValue"])])):(i(),d(t,{key:1,title:`暂无关联${e.type===p(V).MAIN_RISK?"主":"附加"}险、请选择其他险种`},null,8,["title"]))])]})),_:1},8,["show"])}}}),[["__scopeId","data-v-6241eb10"]]);export{M as default};
