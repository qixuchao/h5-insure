import{ref as e,reactive as n,watch as o,computed as t}from"vue";import{h as r,x as a,C as u,aR as l,e as i,_ as c}from"./index-d66a20d8.js";import{c as m,d as s}from"./infoCollection-e6a8a0ee.js";import"./trial-b3f7bf73.js";import"./pdfh5-e588f83d.js";const d=(e,n="YYYY-MM-DD")=>r(e).format(n),v=(e,n=0,o="day",t="YYYY-MM-DD")=>r(e).add(n,o).format(t),f=(e,n=0,o="day",t="YYYY-MM-DD")=>r(e).subtract(n,o).format(t);const p=e=>(vue.pushScopeId("data-v-1de4c6a6"),e=e(),vue.popScopeId(),e),I={class:"com-period-cell"},D={key:0,class:"period-custom-cell period-check-btn-cell"},k=p((()=>vue.createElementVNode("div",{class:"period-cell-label"},"保障期间",-1))),V={class:"period-cell-content"},y=p((()=>vue.createElementVNode("div",{class:"period-cell-label"},"生效日期",-1))),N={class:"period-cell-content period-custom-cell-content"},E=p((()=>vue.createElementVNode("div",{class:"period-cell-label"},"保障期限",-1))),C={class:"period-cell-content period-custom-cell-content"},Y={key:2,class:"period-custom-cell period-common-cell"},g=p((()=>vue.createElementVNode("div",{class:"period-cell-label"},"保障期限",-1))),S={class:"period-cell-content"},b=p((()=>vue.createElementVNode("div",{class:"picker-custom-title"},"保险开始生效日期",-1))),h=vue.defineComponent({name:"insurancePeriodCell"});var B=c(vue.defineComponent({...h,props:{formInfo:{default:()=>({})},riskInfo:{default:()=>({})}},emits:["onReset","onUpdate","onVerify"],setup(c,{expose:p,emit:h}){const B=c;e({});const w=(e,n)=>"year"===e?`${n}年`:"month"===e?`${n}月`:"day"===e?`${n}日`:n,x=e(new Date),L=n({formInfo:B.formInfo}),M=e(!0);e([]),o((()=>L.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(x.value=new Date(e))}));const P=t((()=>{var e;const{insurancePeriodValueList:n=[]}=(null==(e=B.riskInfo)?void 0:e.productRiskInsureLimitVO)||{};return n.length?(L.formInfo.coveragePeriod||(L.formInfo.coveragePeriod=n[0].code),n):[]})),$=t((()=>{var e;const{insuranceStartType:n}=(null==(e=B.riskInfo)?void 0:e.productRiskInsureLimitVO)||{};return n||1})),O=t((()=>{var e;const{insuranceEndType:n}=(null==(e=B.riskInfo)?void 0:e.productRiskInsureLimitVO)||{};return n||1})),[T,R]=a(!1),U=()=>{M.value&&R(!0)},_=t((()=>{var e,n;if(`${$.value}`===m.CUSTOM_DAY){const o=null==(n=null==(e=B.riskInfo)?void 0:e.productRiskInsureLimitVO)?void 0:n.insuranceStartTime;if(o&&o.indexOf(",")){const[e,n]=o.split(",");return new Date(v(new Date,Number(e),"day"))}}return new Date(v(new Date,1,"day"))})),F=t((()=>{var e,n;if(`${$.value}`===m.CUSTOM_DAY){const o=null==(n=null==(e=B.riskInfo)?void 0:e.productRiskInsureLimitVO)?void 0:n.insuranceStartTime;if(!o)return new Date;if(o.indexOf(",")){const[e,n]=o.split(",");return new Date(v(new Date,Number(n),"day"))}const t=v(new Date,Number(o),"day");return new Date(t)}return new Date})),q=e=>{L.formInfo.insuranceStartDate=`${d(e)} 00:00:00`,R(!1)},A=()=>{R(!1)};return o((()=>B.riskInfo),(()=>{const{productRiskInsureLimitVO:e}=B.riskInfo||{};if(e){const{insurancePeriodValueList:n,paymentFrequencyList:o=[]}=e||{};P.value=n}}),{deep:!0,immediate:!0}),o([()=>$.value,()=>L.formInfo.coveragePeriod,()=>L.formInfo.insuranceStartDate,()=>B.riskInfo],(()=>{var e,n;if(!L.formInfo.coveragePeriod)return;const[o,t]=L.formInfo.coveragePeriod.split("_");if(!L.formInfo.insuranceStartDate)if(`${$.value}`===m.CUSTOM_DAY){const o=null==(n=null==(e=B.riskInfo)?void 0:e.productRiskInsureLimitVO)?void 0:n.insuranceStartTime;if(o)if(o.indexOf(",")){const[e,n]=o.split(",");L.formInfo.insuranceStartDate=`${v(new Date,Number(e),"day")} 00:00:00`,console.log("start",e,n),M.value=e!==n}else L.formInfo.insuranceStartDate=`${v(new Date,o,"day")} 00:00:00`;else L.formInfo.insuranceStartDate=`${v(new Date,1,"day")} 00:00:00`}else`${$.value}`===m.NEXT_DAY?L.formInfo.insuranceStartDate=`${v(new Date,1,"day")} 00:00:00`:L.formInfo.insuranceStartDate=`${d(new Date)} 00:00:00`;if("to"!==o)f(L.formInfo.insuranceStartDate,1,"day"),`${O.value}`===s.CURRENT_DAY?L.formInfo.insuranceEndDate=`${r(L.formInfo.insuranceStartDate).add(Number(t),o).subtract(1,"day").format("YYYY-MM-DD")} 23:59:59`:L.formInfo.insuranceEndDate=`${v(L.formInfo.insuranceStartDate,Number(t),o)} 00:00:00`;else{let e=L.formInfo.tenantOrderInsuredList[0].birthday;L.formInfo.tenantOrderInsuredList[0].certType===u.CERT&&L.formInfo.tenantOrderInsuredList[0].certNo&&l(L.formInfo.tenantOrderInsuredList[0].certNo)&&(e=i(L.formInfo.tenantOrderInsuredList[0].certNo));const n=`${f(e,1,"day")} 00:00:00`;"single"===t&&(L.formInfo.insuranceEndDate="9999-99-99 23:59:59"),`${O.value}`===s.CURRENT_DAY?L.formInfo.insuranceEndDate=`${v(n,Number(t),o)} 23:59:59`:L.formInfo.insuranceEndDate=`${v(e,Number(t),o)} 00:00:00`}}),{immediate:!0,deep:!0}),p({}),(e,n)=>{const o=vue.resolveComponent("ProRadioButton"),t=vue.resolveComponent("ProSvg"),r=vue.resolveComponent("VanButton"),a=vue.resolveComponent("van-datetime-picker"),u=vue.resolveComponent("ProPopup");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createElementVNode("div",I,[vue.unref(P).length>1?(vue.openBlock(),vue.createElementBlock("div",D,[k,vue.createElementVNode("div",V,[vue.createVNode(o,{modelValue:vue.unref(L).formInfo.coveragePeriod,"onUpdate:modelValue":n[0]||(n[0]=e=>vue.unref(L).formInfo.coveragePeriod=e),prop:{label:"value",value:"code"},options:vue.unref(P)},null,8,["modelValue","options"])])])):vue.createCommentVNode("",!0),vue.unref($)+""===vue.unref(m).CUSTOM_DAY?(vue.openBlock(),vue.createElementBlock("div",{key:1,class:"period-custom-cell period-common-cell",onClick:U},[vue.unref(M)?(vue.openBlock(),vue.createElementBlock(vue.Fragment,{key:0},[y,vue.createElementVNode("div",N,[vue.createElementVNode("span",null,vue.toDisplayString(vue.unref(L).formInfo.insuranceStartDate?vue.unref(d)(vue.unref(L).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),vue.createVNode(t,{class:"custom--arrow-right",name:"arrow-right"})])],64)):(vue.openBlock(),vue.createElementBlock(vue.Fragment,{key:1},[E,vue.createElementVNode("div",C,[vue.createElementVNode("span",null,vue.toDisplayString(vue.unref(L).formInfo.insuranceStartDate?vue.unref(d)(vue.unref(L).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+vue.toDisplayString(vue.unref(L).formInfo.insuranceEndDate?vue.unref(d)(vue.unref(L).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])],64))])):vue.createCommentVNode("",!0),vue.unref($)+""!==vue.unref(m).CUSTOM_DAY?(vue.openBlock(),vue.createElementBlock("div",Y,[g,vue.createElementVNode("div",S,vue.toDisplayString(vue.unref(L).formInfo.insuranceStartDate?vue.unref(d)(vue.unref(L).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+vue.toDisplayString(vue.unref(L).formInfo.insuranceEndDate?vue.unref(d)(vue.unref(L).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):vue.createCommentVNode("",!0)]),vue.createVNode(u,{show:vue.unref(T),"onUpdate:show":n[3]||(n[3]=e=>vue.isRef(T)?T.value=e:null),height:340,closeable:!0},{default:vue.withCtx((()=>[vue.createVNode(a,{modelValue:vue.unref(x),"onUpdate:modelValue":n[2]||(n[2]=e=>vue.isRef(x)?x.value=e:null),type:"date",title:"保险开始生效日期","min-date":vue.unref(_),"max-date":vue.unref(F),formatter:w,"visible-item-count":5,class:"custom-date-picker",onConfirm:q,onCancel:A},{cancel:vue.withCtx((()=>[])),title:vue.withCtx((()=>[b])),confirm:vue.withCtx((()=>[vue.createVNode(r,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:n[1]||(n[1]=e=>T.value=!1)},{default:vue.withCtx((()=>[vue.createTextVNode("确 定")])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-1de4c6a6"]]);const w=e=>(vue.pushScopeId("data-v-58cbb30d"),e=e(),vue.popScopeId(),e),x={class:"com-payment-type"},L={class:"title"},M={key:0,class:"custom-cell check-btn-cell"},P=w((()=>vue.createElementVNode("div",{class:"cell-label"},"保障方案",-1))),$={class:"cell-content"},O={key:1,class:"custom-cell check-btn-cell"},T=w((()=>vue.createElementVNode("div",{class:"cell-label"},"交费方式",-1))),R={class:"cell-content"},U={key:2,class:"custom-cell check-btn-cell"},_=w((()=>vue.createElementVNode("div",{class:"cell-label"},"交费期间",-1))),F={class:"cell-content"},q={key:3,class:"custom-cell common-cell"},A=w((()=>vue.createElementVNode("div",{class:"cell-label"},"实付保费",-1))),j={key:0,class:"cell-content actual-premium"},H={class:"cell-content actual-premium"},X={key:0,class:"actual-premium actual-premium-month-tip"},z=vue.defineComponent({name:"paymentType"});var G=c(vue.defineComponent({...z,props:{formInfo:{default:()=>({})},riskInfo:{default:()=>({})},tenantProductDetail:{default:()=>({})},planList:{default:()=>[]}},setup(r){const a=r;e({});const u=n({formInfo:a.formInfo}),l=e(),i=e(),c=e([]),m=e([]),s=t((()=>{var e;return!!(null==(e=a.planList)?void 0:e.length)})),d=t((()=>{var e,n;if(null==(e=a.premiumInfo)?void 0:e.premiumLoadingText)return a.premiumInfo.premiumLoadingText;if(a.tenantProductDetail.length){const e=((null==a?void 0:a.tenantProductDetail)||[]).find((e=>e.planCode===u.formInfo.planCode||!e.planCode))||{},{premium:o,minActualUnit:t}=(e.data||[]).find((e=>e.paymentFrequency===u.formInfo.paymentFrequency))||{};return(null==(n=a.premiumInfo)?void 0:n.premium)?`${a.premiumInfo.premium||""}${t}`:o}return""})),v=t((()=>{if(i){const{premiumExplain:e,premiumExplainViewName:n,premiumExplainUri:o}=i.value||{};return{premiumExplain:e,premiumExplainUri:o,premiumExplainViewName:n}}return null}));t((()=>v.value&&v.value.premiumExplain&&v.value.premiumExplainViewName));const f=t((()=>{var e;if(l.value&&l.value.paymentFrequency){return((null==(e=l.value.paymentFrequency)?void 0:e.split(","))||[]).length>1}return!1}));return o((()=>a.riskInfo),(()=>{var e,n;const{productRiskInsureLimitVO:o}=a.riskInfo||{};if(o){const{paymentFrequencyList:t=[],paymentPeriodValueList:r}=o||{};u.formInfo.paymentFrequency=null==(e=null==t?void 0:t[0])?void 0:e.code,u.formInfo.chargePeriod=null==(n=null==r?void 0:r[0])?void 0:n.code,c.value=r,m.value=t}}),{deep:!0,immediate:!0}),(e,n)=>{var o;const t=vue.resolveComponent("ProRadioButton"),r=vue.resolveComponent("ProDivider");return vue.openBlock(),vue.createElementBlock(vue.Fragment,null,[vue.createElementVNode("div",x,[vue.createElementVNode("div",L,vue.toDisplayString(vue.unref(f)?"交费方式":"保障计划"),1),vue.unref(s)?(vue.openBlock(),vue.createElementBlock("div",M,[P,vue.createElementVNode("div",$,[vue.createVNode(t,{modelValue:vue.unref(u).formInfo.planCode,"onUpdate:modelValue":n[0]||(n[0]=e=>vue.unref(u).formInfo.planCode=e),options:e.planList,prop:{value:"planCode",label:"planName"}},null,8,["modelValue","options"])])])):vue.createCommentVNode("",!0),vue.unref(m).length>1?(vue.openBlock(),vue.createElementBlock("div",O,[T,vue.createElementVNode("div",R,[vue.createVNode(t,{modelValue:vue.unref(u).formInfo.paymentFrequency,"onUpdate:modelValue":n[1]||(n[1]=e=>vue.unref(u).formInfo.paymentFrequency=e),prop:{label:"value",value:"code"},options:vue.unref(m)},null,8,["modelValue","options"])])])):vue.createCommentVNode("",!0),vue.unref(c).length>1?(vue.openBlock(),vue.createElementBlock("div",U,[_,vue.createElementVNode("div",F,[vue.createVNode(t,{modelValue:vue.unref(u).formInfo.chargePeriod,"onUpdate:modelValue":n[2]||(n[2]=e=>vue.unref(u).formInfo.chargePeriod=e),prop:{label:"value",value:"code"},options:vue.unref(c)},null,8,["modelValue","options"])])])):vue.createCommentVNode("",!0),vue.createVNode(B,{"form-info":vue.unref(u).formInfo,"risk-info":e.riskInfo},null,8,["form-info","risk-info"]),vue.unref(d)?(vue.openBlock(),vue.createElementBlock("div",q,[A,(null==(o=a.premiumInfo)?void 0:o.premiumLoadingText)?(vue.openBlock(),vue.createElementBlock("div",j,vue.toDisplayString(vue.unref(d)),1)):(vue.openBlock(),vue.createElementBlock(vue.Fragment,{key:1},[vue.createElementVNode("div",H,vue.toDisplayString(vue.unref(d)),1),"5"===vue.unref(u).formInfo.paymentFrequency?(vue.openBlock(),vue.createElementBlock("div",X," 共12期 ")):vue.createCommentVNode("",!0)],64))])):vue.createCommentVNode("",!0)]),vue.createVNode(r)],64)}}}),[["__scopeId","data-v-58cbb30d"]]);export{G as default};
