import{E as a,d as e,r as s,u as r,a0 as t,b as o,c as l,e as n,w as d,f as u,z as c,g as i,ab as p,a1 as v,bA as m,A as I,i as f,j as b,m as C,T as h,B as N,ag as j,ah as O}from"./index-9a68c862.js";import{s as T,c as _}from"./phoneVerify-64e96c08.js";import{c as y}from"./format-12461bbc.js";import{O as g}from"./order-88b05ca1.js";import{p as E}from"./pageJump-f4b5883f.js";import{u as A}from"./useOrder-ca3d0169.js";import"./pdfh5-008ca364.js";const P={class:"page-phone-verify"},S=(a=>(j("data-v-a498a32c"),a=a(),O(),a))((()=>u("div",{class:"title"},"通过投保人手机号验证后，可进行投保信息填写",-1))),q={class:"phone"},w={class:"input-wrapper"};var D=a(e({__name:"phoneVerify",setup(a){const e=A(),j=s(""),O=s(""),D=s(0);let F;const V=r(),{agentCode:k,tenantId:x,templateId:U,productCode:W,insurerCode:z,orderNo:B}=V.query,G=()=>{T(j.value).then((({code:a})=>{"10000"===a&&(D.value=60,F=setInterval((()=>{D.value-=1,D.value<=0&&clearInterval(F)}),1e3))}))},H=()=>{_(j.value,O.value).then((({code:a,data:s})=>{"10000"===a&&s?(h.success("验证成功"),e.value.orderStatus===g.PROCESSING?E("infoCollection",V.query):[g.WAIT_IDENTIFICATION,g.IDENTIFICATION_COMPLETE,g.IN_IDENTIFICATION].includes(e.value.orderStatus)&&E("infoPreview",V.query)):h.fail("验证失败")}))};return t((()=>{C({orderNo:B,saleUserId:k,tenantId:x}).then((({code:a,data:s})=>{var r;"10000"===a&&(Object.assign(e.value,s),j.value=null==(r=null==s?void 0:s.tenantOrderHolder)?void 0:r.mobile)}))})),(a,e)=>{const s=N,r=o("ProPageWrap");return l(),n(r,null,{default:d((()=>[u("div",P,[S,u("div",q,c(i(y)(i(j)||"")),1),u("div",w,[p(u("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>v(O)?O.value=a:null),placeholder:"请输入验证码",class:"input"},null,512),[[m,i(O)]]),u("div",{class:I(["btn",{second:i(D)}]),onClick:G},c(i(D)?`${i(D)}s`:"发送验证码"),3)]),f(s,{type:"primary",class:"submit-btn",onClick:H},{default:d((()=>[b("下一步")])),_:1})])])),_:1})}}}),[["__scopeId","data-v-a498a32c"]]);export{D as default};
