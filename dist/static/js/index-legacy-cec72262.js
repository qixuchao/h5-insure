!function(){var e=document.createElement("style");e.innerHTML='.com-product-risk-wrapper .popup-container[data-v-65cbf84c]{background-color:var(--zaui-global-bg, #f2f5fc)}.com-product-risk-wrapper .popup-container .popup-title[data-v-65cbf84c]{height:1.38667rem;display:flex;align-items:center;justify-content:center;padding:0 .85333rem;font-size:.45333rem;font-weight:600;background-color:#fff}.com-product-risk-wrapper .part-card[data-v-65cbf84c]{background-color:#fff}.com-product-risk-wrapper .part-card[data-v-65cbf84c] .body{padding:0}.com-product-risk-wrapper .risk-content[data-v-65cbf84c] .van-collapse-item__title--expanded{padding:0 .4rem 0 0;display:flex;align-items:center}.com-product-risk-wrapper .risk-content[data-v-65cbf84c] .van-collapse-item__content{padding:0}.com-product-risk-wrapper .plan-risk[data-v-65cbf84c] .van-tabs__line{display:none}.com-product-risk-wrapper .footer-bar[data-v-65cbf84c]{position:fixed;width:100%;bottom:0;left:0;background-color:#fff;height:2rem;padding:.4rem;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #efeff4}.com-product-risk-wrapper .footer-bar .trial-result[data-v-65cbf84c]{width:5.86667rem;color:var(--zaui-price, #ff5840);font-size:.32rem;font-weight:600}.com-product-risk-wrapper .footer-bar .trial-result .result-num[data-v-65cbf84c]{font-size:.61333rem;font-weight:500;margin-left:.17333rem}.com-product-risk-wrapper .footer-bar .trial-operate button[data-v-65cbf84c]{width:3.73333rem}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip[data-v-65cbf84c]{position:absolute;z-index:122;height:.56rem;border-radius:1.33333rem;background-color:var(--zaui-price, #ff5840);font-size:.34667rem;font-family:PingFangSC-Regular,PingFang SC,sans-serif;font-weight:400;color:#fff;line-height:.49333rem;padding:.04rem .28rem .02667rem .26667rem;right:.4rem;top:-.56rem;display:flex;align-items:center}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip .close-icon[data-v-65cbf84c]{margin-left:.17333rem}.com-product-risk-wrapper .footer-bar .trial-operate .retrial-tip[data-v-65cbf84c]:after{content:" ";position:absolute;z-index:11;width:0;height:0;border:.13333rem solid transparent;border-top:.13333rem solid #ff5840;border-right:.13333rem solid #ff5840;right:.49333rem;bottom:-.26667rem}\n',document.head.appendChild(e),System.register(["./vendor-legacy-fb41266f.js","./index-legacy-4f95cd86.js","./trial-legacy-33639017.js","./index-legacy-b141db4b.js"],(function(e){"use strict";var r,t,a,i,o,s,n,d,c,l,p,u,f,m,g,k,b,h,v,y,O,V,w,L,I,P;return{setters:[function(e){r=e.a,t=e.i,a=e.r,i=e.N,o=e.a7,s=e.A,n=e.$,d=e.o,c=e.l,l=e.m,p=e.s,u=e.t,f=e.p,m=e.B,g=e.C,k=e.n,b=e.x,h=e.G,v=e.a5,y=e.a6},function(e){O=e.P,V=e.a},function(e){w=e.i,L=e.p},function(e){I=e._,P=e.G}],execute:function(){e("u",r({id:"createProposal",state:()=>({proposalInfo:{},trialData:[],excludeProduct:[],proposalId:0}),actions:{setProposalInfo(e){this.$state.proposalInfo=e},setTrialData(e){this.$state.trialData=e},setExcludeProduct(e){this.$state.excludeProduct=e}}}));const R={class:"com-product-risk-wrapper"},C={class:"popup-container"},D=(e=>(v("data-v-65cbf84c"),e=e(),y(),e))((()=>m("div",{class:"popup-title"},"请选择保障方案",-1))),_={class:"risk-trial-wrapper"},x={class:"risk-content"},j={key:0,class:"risk"},F={class:"footer-bar"},B=h("确定"),S=t({props:{isShow:{type:Boolean,default:!1},type:{default:"add"},productId:{default:0},riskType:{default:1},formInfo:{default:{}},productData:{default:()=>({})},holder:{default:()=>({})},insured:{default:()=>({})},riderRisk:{default:()=>[]},currentRisk:{default:()=>[]}},emits:["close","finished"],setup(e,{emit:r}){const t=e,h=a({personVO:{occupationCodeList:[],...t.holder}}),v=a({insuredCode:"",personVO:{occupationCodeList:(t.insured?.proposalInsuredProductList||[]).find((e=>e.productId===t.productData.productBasicInfoVO.id))?.occupationCodeList||[],...t.insured}}),y=a({}),I=a({}),S=a({}),T=a({}),A=a({}),N=i({currentPlan:"0",isShow:t.isShow,riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,enumList:{},ageRange:[],collapseName:["1"],type:t.type});o("premium",A.value),o("source",{type:N.type,origin:"proposal",showRiskList:t.currentRisk});const E=s((()=>{let e="";if(N.riskData?.[0]){const r=N.riskData[0],t=(r?.requiredRiderRiskVOList||[]).map((e=>e.riskName));t.length&&(e=`特殊提示: ${r.riskName}和${t.join("、")}必须同时投保`)}return e})),z=()=>{const e=JSON.parse(JSON.stringify(y.value[N.currentPlan])),t=Object.values(e).find((e=>1===e.riskType)),a=Object.values(e).map((e=>{const r=e;return((e,r)=>{const t=e;if("3"===t.chargePeriod){const e=(r.chargePeriod||"").split("_");if(e[1]-=1,1===t.exemptFlag){if("to"===e[0]){let r=0;1===t.exemptType?h.value.personVO?.birthday&&(r=parseInt(""+(+new Date-new Date(h.value.personVO?.birthday))/31536e6,10)):2===t.exemptType&&v.value.personVO?.birthday&&(r=parseInt(""+(+new Date-new Date(v.value.personVO?.birthday))/31536e6,10)),e[1]=e[1]-r}e[0]="year",t.coveragePeriod=e.join("_")}t.chargePeriod=e.join("_")}})(r,t),r.liabilityVOList=(r.liabilityVOList||[]).filter((e=>1===e.optionalFlag||e.liabilityAttributeValue&&"-1"!==e.liabilityAttributeValue)).map((e=>{const r=e;return"0"===r.liabilityAttributeValue&&(r.liabilityAttributeValue=""),r})),r})),i={holder:h.value,productCode:N.riskBaseInfo.productCode,insuredVOList:[{...v.value,productPlanVOList:[{planCode:N.currentPlan||"",insurerCode:N.riskBaseInfo?.insurerCode,riskVOList:a}]}]};L({...i}).then((({code:e,data:t})=>{if("10000"===e){N.retrialTip=!1,N.trialResult=t,N.canTrial=!1;const e={},a=(r=[])=>{(r||[]).forEach((r=>{e[r.riskCode]=r,r.riskPremiumDetailVOList?.length&&a(r.riskPremiumDetailVOList)}))};a(t.riskPremiumDetailVOList),Object.assign(A.value,e),r("finished",((e,r)=>{const t=(e.insuredVOList[0].productPlanVOList[0].riskVOList||[]).map((e=>({...e,premium:r[e.riskCode].premium,amount:r[e.riskCode].amount})));return{proposalHolder:{...e.holder?.personVO},proposalInsuredList:[{...e.insuredVOList[0].personVO,dateRange:{min:S.value?.ageRangeObj?.minAge,max:S.value?.ageRangeObj?.maxAge},proposalInsuredProductList:[{productId:N.riskBaseInfo.id,productName:N.riskBaseInfo.productName,dateRange:{min:S.value?.ageRangeObj?.minAge,max:S.value?.ageRangeObj?.maxAge},occupationCodeList:e.insuredVOList[0].personVO.occupationCodeList,proposalProductRiskList:t}]}]}})(i,e))}else N.retrialTip=!0}))},$=()=>{Promise.all([I.value?.validateForm?.(),S.value?.validateForm?.(),T.value?.validate()]).then((()=>{z()}))},M=()=>{r("close")},G=e=>{N.holderFactor=e.holderFactorList,N.insuredFactor=e.insuredFactorList,N.ageRange=e.ageRange};return n([()=>y.value,()=>h.value,()=>v.value],(e=>{e&&!N.canTrial&&(N.canTrial=!0,N.retrialTip=!0)}),{deep:!0}),n((()=>t.isShow),(e=>{N.isShow=e}),{immediate:!0}),n((()=>t.productId),(e=>{e&&w({productId:t.productId,source:2}).then((({code:e,data:r})=>{"10000"===e&&(N.riskBaseInfo=r.productBasicInfoVO,(r.productRiskVoList[0].riskDetailVOList||[]).forEach(((e,r)=>{0===r&&(N.currentPlan=e.planCode||"0"),Object.assign(y.value,{[e.planCode||r]:{}})})),N.riskData=r.productRiskVoList[0].riskDetailVOList||[],N.riskPlanData=r.productRelationPlanVOList||[])})).finally((()=>{}))}),{immediate:!0}),n((()=>t.formInfo),((e={})=>{if("add"!==t.type&&"repeatAdd"!==t.type){const r={};e.proposalProductRiskList.forEach((e=>{r[e.riskId]=e})),Object.assign(y.value,{0:r})}}),{deep:!0,immediate:!0}),n((()=>t.productData),(e=>{"add"!==t.type&&"repeatAdd"!==t.type&&(N.riskBaseInfo=e.productBasicInfoVO,N.riskData=e.productRiskVoList?.[0].riskDetailVOList||[])}),{deep:!0,immediate:!0}),n((()=>t.type),(e=>{N.type=e})),d((()=>{P({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then((({code:e,data:r})=>{if("10000"===e){const e={};r.forEach((r=>{e[r.dictCode]=r.dictItemList})),N.enumList=e}}))})),(e,r)=>{const t=c("ProMessage"),a=c("ProCard"),i=c("VanForm"),o=c("VanButton"),s=c("VanPopup");return l(),p("div",R,[u(s,{show:g(N).isShow,"onUpdate:show":r[0]||(r[0]=e=>g(N).isShow=e),round:"",position:"bottom",closeable:"",style:{height:"80%"},onClose:M},{default:f((()=>[m("div",C,[D,g(E)?(l(),k(t,{key:0,content:g(E)},null,8,["content"])):b("",!0),m("div",_,[g(N).holderFactor.length?(l(),k(a,{key:0,title:"投保人",class:"part-card"},{default:f((()=>[u(O,{ref_key:"holderRef",ref:I,"insured-code":g(N).riskBaseInfo?.insurerCode,"form-info":h.value.personVO,"factor-list":g(N).holderFactor,"age-range":g(N).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])),_:1})):b("",!0),g(N).insuredFactor.length?(l(),k(a,{key:1,title:"被保人",class:"part-card"},{default:f((()=>[u(O,{ref_key:"insuredRef",ref:S,"insured-code":g(N).riskBaseInfo?.insurerCode,"form-info":v.value.personVO,"factor-list":g(N).insuredFactor,"age-range":g(N).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])),_:1})):b("",!0),m("div",x,[u(a,{title:"投保方案",class:"part-card"},{default:f((()=>[g(N).riskData.length?(l(),p("div",j,[u(i,{ref_key:"riskFormRef",ref:T,"input-align":"right","error-message-align":"right"},{default:f((()=>[u(V,{"risk-info":y.value[0],enums:g(N).enumList,"origin-data":g(N).riskData,"pick-factor":G},null,8,["risk-info","enums","origin-data"])])),_:1},512)])):b("",!0)])),_:1})])]),m("div",F,[u(o,{block:"",type:"primary",onClick:$},{default:f((()=>[B])),_:1})])])])),_:1},8,["show"])])}}});e("P",I(S,[["__scopeId","data-v-65cbf84c"]]))}}}))}();
