import{d as e,aV as a,aW as l,h as n,i,j as t,k as o,E as s,aY as d,M as r,aZ as u,l as c,o as v,c as p,u as _,b as m,F as I,a as f,p as b,f as C,w as y,v as O,q as L,a_ as g,y as j,a$ as h,aX as k}from"./index-d5aa8500.js";import{i as E,q as T,s as P}from"./trial-9021f5bb.js";import{a as w,b as A}from"./product-6c0a2011.js";import{_ as x}from"./TrialButton-e2c35bf8.js";import{q as S}from"./createProposal-b562c1ef.js";import{u as N}from"./useOrder-69ef262e.js";import{p as R,d as V}from"./utils-f0223d9d.js";import{g as B,t as D,c as F}from"./util-83b9bdb2.js";import{c as U}from"./cloneDeep-da64ab08.js";import"./index-533ca087.js";import"./format-31cde443.js";import"./utils-04abdf82.js";import"./trial-083471a5.js";import"./PolicyInfo-6b070d03.js";import"./utils-aaa68cff.js";import"./infoCollection-cb7bbc6c.js";const q={key:0},M={key:1,class:"page-internet-product-detail","data-skeleton-root":"LONG"},G={class:"info"},H={key:1,class:"preview-placeholder"},z=f("br",null,null,-1),W=f("div",{id:"insureButton"},null,-1),X=f("span",null,null,-1),Y=f("div",{id:"xinaoDialog"},null,-1),$=e({name:"InsuranceLong"}),J=e({...$,setup(e){const $=a((()=>l((()=>import("./index-2dab216c.js")),["static/js/index-2dab216c.js","static/css/index-c23f272e.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css"]))),J=a((()=>l((()=>import("./index-3e005772.js")),["static/js/index-3e005772.js","static/css/index-79104747.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css","static/js/infoCollection-cb7bbc6c.js"]))),Z=a((()=>l((()=>import("./index-170971f1.js")),["static/js/index-170971f1.js","static/css/index-491cbbd3.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css"])));a((()=>l((()=>import("./index-5b34bb10.js")),["static/js/index-5b34bb10.js","static/css/index-50785b3e.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css","static/js/cloneDeep-da64ab08.js","static/js/TrialButton-e2c35bf8.js","static/css/TrialButton-dea42d8e.css","static/js/index-533ca087.js","static/css/index-bbfdd7ec.css","static/js/format-31cde443.js","static/js/useOrder-69ef262e.js","static/js/utils-04abdf82.js","static/js/createProposal-b562c1ef.js","static/js/trial-083471a5.js","static/js/PolicyInfo-6b070d03.js","static/css/PolicyInfo-8aa982e6.css"])));const K=a((()=>l((()=>import("./index-57b4c4f0.js")),["static/js/index-57b4c4f0.js","static/css/index-ebb5282b.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css"]))),Q=a((()=>l((()=>import("./Video-cfd18812.js")),["static/js/Video-cfd18812.js","static/css/Video-20262b6f.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css"]))),ee=a((()=>l((()=>import("./index-fb6017d4.js")),["static/js/index-fb6017d4.js","static/css/index-2acebd53.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css","static/js/index-de2bbbbb.js","static/css/index-f9ad8602.css","static/js/index-f204ee3c.js","static/js/utils-aaa68cff.js","static/js/infoCollection-cb7bbc6c.js","static/js/trial-083471a5.js"]))),ae=a((()=>l((()=>import("./index-9e372738.js")),["static/js/index-9e372738.js","static/css/index-3515e551.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css","static/js/product-6c0a2011.js","static/js/useThread-637a02aa.js"]))),le=a((()=>l((()=>import("./index-a281a2c9.js")),["static/js/index-a281a2c9.js","static/css/index-fa4edf2a.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css","static/js/theme-94cf7d00.js","static/js/index-533ca087.js","static/css/index-bbfdd7ec.css","static/js/utils-aaa68cff.js","static/js/infoCollection-cb7bbc6c.js","static/js/trial-083471a5.js"]))),ne=a((()=>l((()=>import("./index-91c9761e.js")),["static/js/index-91c9761e.js","static/css/index-eabeb59f.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css"]))),ie=a((()=>l((()=>import("./index-19a481b8.js")),["static/js/index-19a481b8.js","static/css/index-4822eb94.css","static/js/index-d5aa8500.js","static/css/index-53ee4d9d.css"]))),te=n(),oe=i(),{productCode:se="",tenantId:de,agentCode:re="",agencyCode:ue,saleChannelId:ce,proposalId:ve,proposalInsuredId:pe,extraInfo:_e,orderNo:me,insurerCode:Ie,preview:fe,trialPreview:be}=oe.query;let Ce={};try{Ce=JSON.parse(decodeURIComponent(_e))}catch($e){}const{openId:ye,saTenantId:Oe=""}=Ce;t();const Le=t(),ge=t(),je=t(!1),he=t({}),ke=t({}),Ee=t(!1),Te=t(0),Pe=t(!1);t({});const we=t(!0);t(!0);const Ae=t(!0),xe=t(""),Se=t({}),Ne=t({}),Re=t([]),Ve=t({imgUrl:"",desc:"",title:"",link:`${window.location.href}&isShare=1`,isShare:!1}),Be=t({});o((()=>!!fe||!!be));const De=o((()=>!!be));t();const Fe=()=>{g("premiumTrial",oe.query)},Ue=N(),qe=t(!1);s((()=>Be.value.planCode),(e=>{Se.value=(ke.value.productPlanInsureVOList||[]).find((a=>a.planCode===e))}));const Me=()=>{Le.value.handleClickTab()("insureButton")};t(""),t(0);const Ge=e=>{Se.value=(ke.value.productPlanInsureVOList||[]).find((a=>a.planCode===e))},He=()=>{Ee.value=!1,we.value=!0},ze=()=>{Ee.value=!1,we.value=!0},We=t([]),Xe=async()=>{var e,a,l;const{code:n,data:i}=await T({calcProductFactorList:[{productCode:se}]});if("10000"===n){const n=B(),t=n?D(n,[]):{};Object.assign(Ue.value,i,{insuredList:[{...null==(e=i.insuredList)?void 0:e[0],...t}]});(e=>{A(e).then((({code:e,data:a})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:l}=V(a);We.value=e.concat(l)}}))})(R(null==(l=null==(a=i.insuredList)?void 0:a[0])?void 0:l.productList))}},Ye=async()=>{var e;const a=["id","relationToHolder","beneficiaryList","guardian","insuredBeneficiaryType"];Ue.value.extInfo&&(Ue.value.extInfo.iseeBizNo=xe.value);const l=U(Ue.value);l.insuredList[0].relationToHolder=1,Object.keys(null==(e=l.insuredList)?void 0:e[0]).reduce(((e,n)=>{var i,t,o,s;return!a.includes(n)&&(null==(t=null==(i=l.insuredList)?void 0:i[0])?void 0:t[n])&&(e[n]=null==(s=null==(o=l.insuredList)?void 0:o[0])?void 0:s[n]),e}),l.holder),console.log("orderDetailCopy",l,Ue.value);const{code:n,data:i}=await P(l);"10000"===n&&(F(),te.push({path:j.questionNotice,query:{...oe.query,orderNo:i}}))};return s((()=>Se.value),(()=>{const{planCode:e,oilPackageProductVOList:a,insureProductRiskVOList:l}=Se.value;Be.value.planCode=e,Ne.value=(l||[]).find((e=>e.mainRiskFlag===d.YES))}),{deep:!0,immediate:!0}),r((()=>{u(ge,(([{isIntersecting:e}],a)=>{je.value=!0}))})),c((()=>{Ae.value=!0,ve||Xe(),(async()=>{!De.value&&w({productCode:se}).then((({data:e,code:a})=>{if("10000"===a){he.value=e;const{wxShareConfig:a,showWXShare:l,title:n,desc:i,image:t}=(null==e?void 0:e.PRODUCT_LIST)||{};l?Object.assign(Ve.value,{...a,imgUrl:a.image,isShare:l}):Object.assign(Ve.value,{title:n,desc:i,imgUrl:t,isShare:l})}})),me||ve||(qe.value=!0),ve&&S({id:ve,tenantId:Oe||de}).then((({code:e,data:a})=>{if("10000"===e){const{holder:e,insuredList:l}=a,n=(se||"").split(",");Object.assign(Ue.value,{renewFlag:"",holder:e,tenantId:de,proposalId:ve,insuredList:(l||[]).filter((e=>e.id===+pe)).map((e=>({...e,relationToHolder:null,productList:e.productList.filter((e=>n.includes(e.productCode)))})))}),qe.value=!0}})),await E({productCode:se,isTenant:!1}).then((({data:e,code:a})=>{var l;"10000"===a&&(je.value=!0,Pe.value=!0,ke.value=e,Se.value=null==(l=e.productPlanInsureVOList)?void 0:l[0],Re.value=(e.productPlanInsureVOList||[]).filter((e=>e.planCode)).map((e=>({planName:e.planName,planCode:e.planCode}))))})),Ae.value=!1})(),setTimeout((async()=>{xe.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{var l,n,i,t,o,s,d,r,u,c,g,j,E,T,P,w,A,S,N,R;const V=h,B=k;return v(),p(I,null,[_(Ae)?(v(),p("div",q)):(v(),p("div",M,[m(V),_(De)?(v(),p("div",H,[O("当前页面仅用于保费试算预览"),z,O("不展示其他产品相关配置信息")])):(v(),p(I,{key:0},[f("div",G,[1==(null==(n=null==(l=_(he))?void 0:l.BASIC_INFO)?void 0:n.bannerType)&&(null==(t=null==(i=_(he))?void 0:i.BASIC_INFO)?void 0:t.banner.length)?(v(),b(_(Z),{key:0,"data-skeleton-type":"img",images:null==(s=null==(o=_(he))?void 0:o.BASIC_INFO)?void 0:s.banner},null,8,["images"])):C("",!0),2==(null==(r=null==(d=_(he))?void 0:d.BASIC_INFO)?void 0:r.bannerType)&&(null==(c=null==(u=_(he))?void 0:u.BASIC_INFO)?void 0:c.video.length)?(v(),b(_(Q),{key:1,"data-skeleton-type":"img",src:null==(g=_(he))?void 0:g.BASIC_INFO.video[0]},null,8,["src"])):C("",!0),(null==(T=null==(E=null==(j=_(he))?void 0:j.BASIC_INFO)?void 0:E.bannerMove)?void 0:T.length)?(v(),b(_(Z),{key:2,url:null==(A=null==(w=null==(P=_(he))?void 0:P.BASIC_INFO)?void 0:w.bannerMove)?void 0:A[0],onClick:Me},null,8,["url"])):C("",!0),f("div",{ref_key:"observeRef",ref:ge},null,512)]),m(_($),{"data-source":null==(S=_(he))?void 0:S.BASIC_INFO},null,8,["data-source"]),(null==(N=_(he))?void 0:N.GUARANTEE)?(v(),b(_(ee),{key:0,"show-service-config":"","data-source":_(he),"plan-list":_(Re),onUpdateActivePlan:Ge},null,8,["data-source","plan-list"])):C("",!0),f("div",{class:"trial-text-btn",onClick:Fe},"算一算保费"),m(_(K),{"data-source":null==(R=_(he))?void 0:R.ISSUE_CONDITION},null,8,["data-source"]),m(_(J),{ref_key:"detailScrollRef",ref:Le,"data-source":_(he)},null,8,["data-source"]),m(B,null,{default:y((()=>{var e,a,l;return[(null==(e=_(he).SIGNATURE)?void 0:e.inscribedContent)?(v(),b(_(ne),{key:0,"inscribed-content":null==(l=null==(a=_(he))?void 0:a.SIGNATURE)?void 0:l.inscribedContent},null,8,["inscribed-content"])):C("",!0)]})),_:1}),m(B,null,{default:y((()=>{var e;return[(null==(e=_(We))?void 0:e.length)?(v(),b(_(ie),{key:0,"attachment-list":_(We),"pre-text":"请阅读",onPreviewFile:a[0]||(a[0]=e=>(e=>{Te.value=e,Ee.value=!0})(e))},null,8,["attachment-list"])):C("",!0)]})),_:1})],64)),W,m(x,{onHandleClick:Ye},{label:y((()=>[X])),_:1})])),m(B,null,{default:y((()=>[_(Pe)&&!_(De)?(v(),b(_(ae),{key:0,"product-detail":_(he)},null,8,["product-detail"])):C("",!0)])),_:1}),Y,m(B,null,{default:y((()=>[_(Ee)?(v(),b(_(le),{key:0,show:_(Ee),"onUpdate:show":a[1]||(a[1]=e=>L(Ee)?Ee.value=e:null),"content-list":_(we)?_(We):[],"is-only-view":_(we),"active-index":_(Te),text:_(we)?"关闭":"我已逐页阅读并确认告知内容","force-read-cound":0,onSubmit:He,onOnCloseFilePreviewByMask:ze},null,8,["show","content-list","is-only-view","active-index","text"])):C("",!0)])),_:1})],64)}}});export{J as default};
