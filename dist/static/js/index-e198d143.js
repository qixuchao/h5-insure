import{aw as e,d as i,r as a,E as l,ay as o,b9 as t,an as n,ax as r,f as s,A as u,a4 as d,a_ as m,b2 as c,ba as p,aW as f,az as v,bb as y,bc as g,b3 as k,bd as b,be as V,bf as I,bg as h,aC as L,_ as D,J as C,o as O,c as R,h as x,w as A,j as P,g as w,a7 as _,F as T,i as M,e as F,l as U,t as N,n as q,v as S,C as E,q as Y,x as $,B as j,b0 as B,X as G,Y as H,S as z,bh as K,ad as W,k as J,aM as X,aF as Q,y as Z,m as ee,b6 as ie,bi as ae,bj as le,G as oe,bk as te,W as ne,V as re,aE as se,b5 as ue,ap as de,aj as me,aG as ce}from"./index-6df31081.js";import{S as pe,d as fe,e as ve,f as ye,A as ge,g as ke,L as be,h as Ve}from"./trial-2f4f2d6f.js";import{u as Ie}from"./useDicData-ae09936f.js";const[he,Le]=e("stepper"),De=(e,i)=>String(e)===String(i);const Ce=L(i({name:he,props:{min:p(1),max:p(1/0),name:p(""),step:p(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:f,showMinus:f,showInput:f,longPress:f,allowEmpty:Boolean,modelValue:v,inputWidth:v,buttonSize:v,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:p(1),decimalLength:v},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:i}){const p=i=>{const{min:a,max:l,allowEmpty:o,decimalLength:t}=e;return o&&""===i||(i=""===(i=y(String(i),!e.integer))?0:+i,i=Number.isNaN(i)?+a:i,i=Math.max(Math.min(+l,i),+a),g(t)&&(i=i.toFixed(+t))),i};let f;const v=a(),L=a((()=>{var a;const l=null!=(a=e.modelValue)?a:e.defaultValue,o=p(l);return De(o,e.modelValue)||i("update:modelValue",o),o})()),D=l((()=>e.disabled||e.disableMinus||L.value<=+e.min)),C=l((()=>e.disabled||e.disablePlus||L.value>=+e.max)),O=l((()=>({width:o(e.inputWidth),height:o(e.buttonSize)}))),R=l((()=>t(e.buttonSize))),x=i=>{e.beforeChange?I(e.beforeChange,{args:[i],done(){L.value=i}}):L.value=i},A=()=>{if("plus"===f&&C.value||"minus"===f&&D.value)return void i("overlimit",f);const a="minus"===f?-e.step:+e.step,l=p(h(+L.value,a));x(l),i(f)},P=i=>{const a=i.target,{value:l}=a,{decimalLength:o}=e;let t=y(String(l),!e.integer);if(g(o)&&t.includes(".")){const e=t.split(".");t=`${e[0]}.${e[1].slice(0,+o)}`}e.beforeChange?a.value=String(L.value):De(l,t)||(a.value=t);const n=t===String(+t);x(n?+t:t)},w=a=>{var l;e.disableInput?null==(l=v.value)||l.blur():i("focus",a)},_=e=>{const a=e.target,l=p(a.value);a.value=String(l),L.value=l,k((()=>{i("blur",e),b()}))};let T,M;const F=()=>{M=setTimeout((()=>{A(),F()}),200)},U=i=>{e.longPress&&(clearTimeout(M),T&&V(i))},N=i=>{e.disableInput&&V(i)},q=i=>({onClick:e=>{V(e),f=i,A()},onTouchstartPassive:()=>{f=i,e.longPress&&(T=!1,clearTimeout(M),M=setTimeout((()=>{T=!0,A(),F()}),600))},onTouchend:U,onTouchcancel:U});return n((()=>[e.max,e.min,e.integer,e.decimalLength]),(()=>{const e=p(L.value);De(e,L.value)||(L.value=e)})),n((()=>e.modelValue),(e=>{De(e,L.value)||(L.value=p(e))})),n(L,(a=>{i("update:modelValue",a),i("change",a,{name:e.name})})),r((()=>e.modelValue)),()=>s("div",{role:"group",class:Le([e.theme])},[u(s("button",m({type:"button",style:R.value,class:[Le("minus",{disabled:D.value}),{[c]:!D.value}],"aria-disabled":D.value||void 0},q("minus")),null),[[d,e.showMinus]]),u(s("input",{ref:v,type:e.integer?"tel":"text",role:"spinbutton",class:Le("input"),value:L.value,style:O.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":L.value,onBlur:_,onInput:P,onFocus:w,onMousedown:N},null),[[d,e.showInput]]),u(s("button",m({type:"button",style:R.value,class:[Le("plus",{disabled:C.value}),{[c]:!C.value}],"aria-disabled":C.value||void 0},q("plus")),null),[[d,e.showPlus]])])}}));const Oe={class:"com-risk-list-wrapper"},Re=(e=>(G("data-v-7d3c3028"),e=e(),H(),e))((()=>P("div",{class:"popup-title"},"选择附加险",-1))),xe={class:"risk-list"},Ae={class:"cell-title"},Pe={class:"title"},we={class:"footer-button"};var _e=D(i({__name:"index",props:{riskList:{default:()=>[]},show:{type:Boolean,default:!1},collocationList:{default:()=>[]},disabled:{default:()=>[]},modelValue:{default:()=>[]}},emits:["finished","close","update:modelValue"],setup(e,{emit:i}){const l=e,o=a([]),t=a([]),r=a([...l.disabled]),u=C({show:l.show,currentChecked:[...l.modelValue]}),d=e=>{var i,a,t;if(r.value.includes(e))return;((e,i)=>{if(!l.collocationList.length)return i?void(u.currentChecked=[]):void u.currentChecked.push(e);let a=u.currentChecked,o=r.value;i?(l.collocationList.forEach((i=>{e===i.riskId&&(2===i.collocationType?a=a.filter((a=>a!==i.collocationRiskId||a!==e)):3===i.collocationType?(a=a.filter((i=>i!==e)),o=o.filter((e=>e!==i.collocationRiskId))):a=a.filter((i=>i!==e)))})),u.currentChecked=a,r.value=o):(l.collocationList.forEach((l=>{e===l.riskId&&(i||(2===l.collocationType?a.push(l.collocationRiskId):3===l.collocationType&&o.push(l.collocationRiskId),a.push(e)))})),u.currentChecked.push(...a),r.value=o)})(e,u.currentChecked.includes(e)),null==(t=null==(a=null==(i=null==o?void 0:o.value)?void 0:i[e])?void 0:a.toggle)||t.call(a)},m=()=>{i("close")},c=()=>{const e=l.riskList.filter((e=>u.currentChecked.includes(e.id)));i("update:modelValue",[...new Set(t.value)]),i("finished",e,r.value),i("close")};return O((()=>{o.value=[]})),n((()=>u.currentChecked),(e=>{t.value=e}),{deep:!0,immediate:!0}),n((()=>l.modelValue),(e=>{t.value=e||[],r.value.push(...e||[])}),{deep:!0,immediate:!0}),(i,a)=>{const l=S,n=E,p=Y,f=$,v=j,y=B;return R(),x("div",Oe,[s(y,{show:w(u).show,"onUpdate:show":a[1]||(a[1]=e=>w(u).show=e),title:"选择附加险","show-footer":"",round:"",position:"bottom",closeable:"",onClose:m},{default:A((()=>[Re,P("div",xe,[s(f,{modelValue:w(t),"onUpdate:modelValue":a[0]||(a[0]=e=>_(t)?t.value=e:null)},{default:A((()=>[s(p,{inset:""},{default:A((()=>[(R(!0),x(T,null,M(e.riskList,(e=>(R(),F(n,{key:e.id,title:e.riskName,disabled:w(r).includes(e.id),onClick:i=>d(e.id)},{"right-icon":A((()=>[s(l,{ref_for:!0,ref:i=>w(o)[e.id]=i,shape:"square",disabled:w(r).includes(e.id),name:e.id,onClick:U((i=>d(e.id)),["stop"])},null,8,["disabled","name","onClick"])])),title:A((()=>[P("div",Ae,[P("div",Pe,N(e.riskName),1)])])),_:2},1032,["title","disabled","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])]),P("div",we,[s(v,{type:"primary",disabled:!w(u).currentChecked.length,block:"",onClick:c},{default:A((()=>[q("确认")])),_:1},8,["disabled"])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-7d3c3028"]]);const Te={class:"com-personal-info-wrapper"},Me={class:"pro-radio-wrap"},Fe={class:"pro-radio-wrap"};var Ue=D(i({__name:"index",props:{formInfo:{default:()=>({})},insuredCode:{default:""},factorList:{default:()=>[]},ageRange:{default:()=>[]}},setup(e,{expose:i}){var o,t;const n=e,r=Ie(`${null==(t=null==(o=n.insuredCode)?void 0:o.toLocaleUpperCase)?void 0:t.call(o)}_OCCUPATION`),[u,d]=z(),m=a(),c=K("source")||{},p=C({formInfo:n.formInfo,occupationalText:"",occupationCodeList:[]}),f=l((()=>{const e=(e=>{const i=e||[];for(let a=0,l=i.length;a<l;a++)for(let e=a+1;e<l;e++){const l=i[a].split("_"),o=i[e].split("_"),t=i[a];l[0]===o[0]?l>o&&(i[a]=i[e],i[e]=t):"age"===l[0]&&(i[a]=i[e],i[e]=t)}return i})(null==n?void 0:n.ageRange),i=(e="")=>[+e.split("_")[1],e.split("_")[0]],a=i(e[0]),l=i(e[e.length-1]),o=W().subtract(a[0],"age"===a[1]?"year":"day").format("YYYY-MM-DD");let t=W().subtract(l[0],"age"===l[1]?"year":"day").format("YYYY-MM-DD");return W(t).subtract(1,"year").isBefore(o)&&(t=W(t).subtract(1,"year").add(1,"day").format("YYYY-MM-DD")),{minAge:new Date(t),maxAge:new Date(o)}}));return i({validateForm:()=>new Promise(((e,i)=>{var a;null==(a=m.value)||a.validate().then((()=>{e("")}),(e=>{var a;null==(a=m.value)||a.scrollToField(null==e?void 0:e[0].name),i()}))})),ageRangeObj:f.value}),(i,a)=>{const l=Z,o=ee,t=ie,n=ae,v=B;return R(),x("div",Te,[s(t,{ref_key:"formRef",ref:m,"input-align":"right","error-message-align":"right"},{default:A((()=>["proposal"===w(c).type&&("add"===w(c).type||"repeatAdd"===w(c).type)||"proposal"!==w(c).type&&(e.factorList.includes("APPLICANT.AGE")||e.factorList.includes("AGE")||e.factorList.includes("DAY")||e.factorList.includes("APPLICANT.DAY"))?(R(),F(l,{key:0,modelValue:w(p).formInfo.birthday,"onUpdate:modelValue":a[0]||(a[0]=e=>w(p).formInfo.birthday=e),rules:[{required:!0,message:"请选择出生日期"}],name:"birth",label:"出生日期",class:"isLink",readonly:"","is-link":"",formatter:e=>e?w(W)(e).format("YYYY-MM-DD"):e,placeholder:"请选择",onClick:a[1]||(a[1]=e=>w(d)(!0))},null,8,["modelValue","formatter"])):J("",!0),"proposal"===w(c).type&&("add"===w(c).type||"repeatAdd"===w(c).type)||"proposal"!==w(c).type&&(e.factorList.includes("APPLICANT.GENDER")||e.factorList.includes("GENDER"))?(R(),F(l,{key:1,modelValue:w(p).formInfo.gender,"onUpdate:modelValue":a[3]||(a[3]=e=>w(p).formInfo.gender=e),name:"gender",label:"性别",rules:[{required:!0,message:"请选择性别"}]},{input:A((()=>[P("div",Me,[s(o,{modelValue:w(p).formInfo.gender,"onUpdate:modelValue":a[2]||(a[2]=e=>w(p).formInfo.gender=e),options:w(X)},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):J("",!0),e.factorList.includes("SOCIAL_INS")||e.factorList.includes("APPLICANT.SOCIAL_INS")?(R(),F(l,{key:2,modelValue:w(p).formInfo.socialFlag,"onUpdate:modelValue":a[5]||(a[5]=e=>w(p).formInfo.socialFlag=e),name:"socialFlag",label:"社保",rules:[{required:!0,message:"请选择社保"}]},{input:A((()=>[P("div",Fe,[s(o,{modelValue:w(p).formInfo.socialFlag,"onUpdate:modelValue":a[4]||(a[4]=e=>w(p).formInfo.socialFlag=e),options:w(pe)},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):J("",!0),e.factorList.includes("OCCUPATION_CATEGORY")||e.factorList.includes("APPLICANT.OCCUPATION_CATEGORY")?(R(),F(Q,{key:3,modelValue:w(p).formInfo.occupationCodeList[0],"onUpdate:modelValue":a[6]||(a[6]=e=>w(p).formInfo.occupationCodeList[0]=e),field0:w(p).formInfo.occupationCodeList[0],"onUpdate:field0":a[7]||(a[7]=e=>w(p).formInfo.occupationCodeList[0]=e),field1:w(p).formInfo.occupationCodeList[1],"onUpdate:field1":a[8]||(a[8]=e=>w(p).formInfo.occupationCodeList[1]=e),field2:w(p).formInfo.occupationCodeList[2],"onUpdate:field2":a[9]||(a[9]=e=>w(p).formInfo.occupationCodeList[2]=e),required:"",name:"occupationCodeList",label:"职业类型","data-source":w(r),mapping:{label:"value",value:"code",children:"children"},"show-full-value":"","need-key":"name"},null,8,["modelValue","field0","field1","field2","data-source"])):J("",!0)])),_:1},512),s(v,{show:w(u),"onUpdate:show":a[12]||(a[12]=e=>_(u)?u.value=e:null),position:"bottom"},{default:A((()=>[s(n,{type:"date","min-date":w(f).minAge,"max-date":w(f).maxAge,onConfirm:a[10]||(a[10]=e=>{w(p).formInfo.birthday=w(W)(e).format("YYYY-MM-DD"),w(d)(!1)}),onCancel:a[11]||(a[11]=e=>w(d)(!1))},null,8,["min-date","max-date"])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-b6a7c104"]]);const Ne={class:"risk-responsibility"},qe={class:"title"},Se={class:"content"};var Ee=D(i({__name:"index",props:{modelValue:Boolean,title:{type:String,default:""},minHeight:{type:[Number,String],default:80},maxHeight:{type:[Number,String],default:200}},emits:["update:modelValue"],setup(e,{emit:i}){const o=e;le();const t=a();oe((()=>{t.value=o.modelValue}));const n=l((()=>t.value?`${o.maxHeight}px`:`${o.minHeight}px`)),r=()=>{t.value=!t.value,i("update:modelValue",t.value)};return(i,a)=>{const l=re;return R(),x("div",Ne,[P("div",qe,N(e.title),1),P("div",{class:"responsibility-content",style:ne({height:w(n)})},[P("div",Se,[te(i.$slots,"default",{},void 0,!0)]),P("div",{class:"show-button",onClick:r},[P("span",null,N(w(t)?"收起":"展开"),1),s(l,{style:{width:"20px",height:"20px"},name:w(t)?"arrow-up":"arrow-down"},null,8,["name"])])],4)])}}}),[["__scopeId","data-v-27faf794"]]);const Ye={class:"com-risk-card-wrapper part-card"},$e={class:"custom-field"},je={class:"field-tip"},Be={class:"custom-field"},Ge={class:"field-tip"},He={class:"custom-field"},ze={class:"field-tip"},Ke={class:"pro-radio-wrap"},We={class:"pro-radio-wrap"},Je={class:"pro-radio-wrap"},Xe={class:"pro-radio-wrap"},Qe={class:"pro-radio-wrap"},Ze={key:0},ei={key:1,class:"pro-radio-wrap"},ii={key:9,class:"liab-desc"};var ai=D(i({__name:"index",props:{originData:{default:()=>({})},formInfo:{default:()=>({})},mainRiskData:{default:()=>({})},mainRiskInfo:{default:()=>({})},index:{default:0},removeRisk:{type:Function,default:()=>{}},removeRiskList:{default:()=>[]},enums:{default:()=>({})}},setup(e){const i=e,o=a({}),t=K("premium")||{};o.value=K("enumList")||{};const r=a({chargePeriod:{disabled:!1,prevent:!1},coveragePeriod:{disabled:!1,prevent:!1},paymentFrequency:{disabled:!1,prevent:!1}}),u=C({formInfo:i.formInfo}),d=e=>"boolean"!=typeof e&&!e||(!(!Array.isArray(e)||e.length)||"[object Object]"==={}.toString.call(e)&&Object.keys(e).length),m=(e,i,a={})=>{let l=i;return Array.isArray(i)||(l=[`${l}`]),(e||[]).filter((e=>l.includes(`${e.value}`)||l.includes(e.value)))},c=l((()=>{var e,a,l,o,t,n,r,s;return 1===(null==(e=i.originData)?void 0:e.riskType)?m(i.enums.RISK_INSURANCE_PERIOD,(null==(a=i.originData.riskInsureLimitVO)?void 0:a.insurancePeriodValueList)||[]):2===(null==(l=i.originData)?void 0:l.periodType)?m([{value:"year_1",name:"1年"}],["year_1"]):1===(null==(o=i.originData)?void 0:o.exemptFlag)?m(fe,[`${null==(n=null==(t=null==i?void 0:i.originData)?void 0:t.riskInsureLimitVO)?void 0:n.insurancePeriodRule}`]):m(null==(r=i.enums)?void 0:r.RISK_INSURANCE_PERIOD,(null==(s=i.mainRiskData.riskInsureLimitVO)?void 0:s.insurancePeriodValueList)||[])})),p=l((()=>{var e,a,l,o,t,n,r,s;return 1===(null==(e=i.originData)?void 0:e.riskType)?m(null==(a=null==i?void 0:i.enums)?void 0:a.RISK_PAYMENT_PERIOD,(null==(l=i.originData.riskInsureLimitVO)?void 0:l.paymentPeriodValueList)||[]):1===(null==(o=i.originData)?void 0:o.exemptFlag)?m(ve,[`${null==(n=null==(t=null==i?void 0:i.originData)?void 0:t.riskInsureLimitVO)?void 0:n.paymentPeriodRule}`]):2===(null==(r=i.originData)?void 0:r.periodType)?m([{value:"year_1",name:"1年交"}],["year_1"]):m(i.enums.RISK_PAYMENT_PERIOD,(null==(s=i.mainRiskData.riskInsureLimitVO)?void 0:s.paymentPeriodValueList)||[])})),f=l((()=>{var e,a,l,o,t;return 1===(null==(e=i.originData)?void 0:e.riskType)?m(ye,(null==(a=i.originData.riskInsureLimitVO)?void 0:a.paymentFrequencyList)||[]):1===(null==(l=i.originData.riskInsureLimitVO)?void 0:l.paymentTypeRule)?m(ye,(null==(o=i.mainRiskData.riskInsureLimitVO)?void 0:o.paymentFrequencyList)||[]):m(ye,(null==(t=i.mainRiskData.riskInsureLimitVO)?void 0:t.paymentFrequencyList)||[])})),v=l((()=>{var e,a;let l=0,o=0;return((null==(a=null==(e=i.originData)?void 0:e.riskCalcMethodInfoVO)?void 0:a.paymentMethodLimitList)||[]).forEach(((e,i)=>{0===i&&(l=e.minAmount,o=e.maxAmount),l>e.minAmount&&(l=e.minAmount),o<e.maxAmount&&(o=e.maxAmount)})),u.formInfo.amount=u.formInfo.amount||l,{min:l,max:o||1/0}})),y=l((()=>{var e,a;let l=0,o=0;return((null==(a=null==(e=i.originData)?void 0:e.riskCalcMethodInfoVO)?void 0:a.paymentMethodLimitList)||[]).forEach(((e,i)=>{0===i&&(l=e.minPremium,o=e.maxPremium),l>e.minPremium&&(l=e.minPremium),o<e.maxPremium&&(o=e.maxPremium)})),u.formInfo.premium=u.formInfo.premium||l,{min:l,max:o||1/0}})),g=l((()=>{var e,a,l,o;const t=(null==(a=null==(e=i.originData)?void 0:e.riskCalcMethodInfoVO)?void 0:a.minCopy)||1,n=null==(o=null==(l=i.originData)?void 0:l.riskCalcMethodInfoVO)?void 0:o.maxCopy;return u.formInfo.copy=`${u.formInfo.copy||t||1}`,{min:t,max:n}})),k=(e,a,l)=>{var o,t;const n=(null==(t=null==(o=i.originData)?void 0:o.riskCalcMethodInfoVO)?void 0:t.increaseDecreaseNum)||1;if("sumInsured"===l){if(v.value.max&&+e>v.value.max)return`金额最大${v.value.max}元`;if(+e<v.value.min)return`金额最小${v.value.min}元`}else{if(y.value.max&&+e>y.value.max)return`金额最大${y.value.max}元`;if(+e<y.value.min)return`金额最小${y.value.min}元`}return+e%n==0?"":`金额必须是${n}的倍数`},b=e=>{var i;const a=((null==(i=u.formInfo)?void 0:i.liabilityVOList)||[]).find((i=>i.liabilityCode===e.liabilityCode));return a?a.liabilityAttributeValue?a.liabilityAttributeValue:1!==e.optionalFlag?"0":"-1":""};return se((()=>{var e,a,l,o;const t={riskType:i.originData.riskType,riskId:i.originData.id,riskName:i.originData.riskName,riskCode:i.originData.riskCode,amount:u.formInfo.amount,mainRiskCode:1!==i.originData.riskType?null==(e=i.mainRiskData)?void 0:e.riskCode:void 0,mainRiskId:1!==i.originData.riskType?null==(a=i.mainRiskData)?void 0:a.id:void 0,exemptFlag:i.originData.exemptFlag,exemptType:i.originData.exemptType,riskCategory:i.originData.riskCategory,liabilityVOList:(i.originData.riskLiabilityInfoVOList||[]).map((e=>({...e,liabilityAttributeCode:e.liabilityAttributeType,liabilityCode:e.liabilityCode,liabilityRateType:e.liabilityRateType,liabilityAttributeValue:b(e)})))};[1].includes((null==(l=i.originData.riskCalcMethodInfoVO)?void 0:l.saleMethod)||0)&&1!==(null==(o=i.originData)?void 0:o.exemptFlag)||!i.originData.riskCalcMethodInfoVO.fixedAmount||(t.amount=i.originData.riskCalcMethodInfoVO.fixedAmount),Object.assign(u.formInfo,t)})),n((()=>{var e;return null==(e=u.formInfo)?void 0:e.paymentFrequency}),((e=0)=>{var a,l,o;[3].includes((null==(a=i.originData.riskCalcMethodInfoVO)?void 0:a.saleMethod)||0)&&((null==(o=null==(l=i.originData)?void 0:l.riskCalcMethodInfoVO)?void 0:o.paymentMethodLimitList)||[]).forEach((i=>{+i.paymentFrequency==+e&&Object.assign(u.formInfo,{amount:i.perCopyAmount,premium:i.perCopyPremium})})),1==+e&&"single"!==u.formInfo.chargePeriod&&(u.formInfo.chargePeriod="single")})),n((()=>{var e;return null==(e=u.formInfo)?void 0:e.copy}),(e=>{var a,l;4===(null==(a=i.originData.riskCalcMethodInfoVO)?void 0:a.saleMethod)&&(u.formInfo.amount=null==(l=i.originData.riskCalcMethodInfoVO)?void 0:l.fixedAmount)})),n((()=>{var e;return null==(e=u.formInfo)?void 0:e.chargePeriod}),(e=>{"single"===e&&1!=+(u.formInfo.paymentFrequency||0)&&(u.formInfo.paymentFrequency=1)})),n((()=>null==i?void 0:i.mainRiskInfo),(e=>{var a,l,o,t,n,s;e&&2===i.originData.riskType&&(1===(null==(l=null==(a=i.originData)?void 0:a.riskInsureLimitVO)?void 0:l.insurancePeriodRule)&&(e.coveragePeriod?r.value.coveragePeriod.disabled=!0:r.value.coveragePeriod.prevent=!0,u.formInfo.coveragePeriod=e.coveragePeriod||""),1===(null==(t=null==(o=i.originData)?void 0:o.riskInsureLimitVO)?void 0:t.paymentPeriodRule)&&(e.chargePeriod?r.value.chargePeriod.disabled=!0:r.value.chargePeriod.prevent=!0,u.formInfo.chargePeriod=e.chargePeriod||""),1===(null==(s=null==(n=i.originData)?void 0:n.riskInsureLimitVO)?void 0:s.paymentTypeRule)&&(e.paymentFrequency?r.value.paymentFrequency.disabled=!0:r.value.paymentFrequency.prevent=!0,u.formInfo.paymentFrequency=e.paymentFrequency||0))}),{immediate:!0,deep:!0}),(i,a)=>{var l,o,n,b,V,I,h,L,D,C,O,_,U,q,S,E,Y,$,j,B,G,H,z,K,W,X,Q,ie,ae,le;const oe=re,te=ue,ne=Ce,se=Z,me=ee,ce=de;return R(),x("div",Ye,[s(te,{"risk-type":e.originData.riskType,title:e.originData.riskName},{default:A((()=>[e.removeRiskList.includes(e.originData.id)?(R(),x("div",{key:0,class:"delete-risk",onClick:a[0]||(a[0]=i=>e.removeRisk(e.originData.id))},[s(oe,{name:"img-lajitong",color:"#0d6efe"})])):J("",!0)])),_:1},8,["risk-type","title"]),1===(null==(l=e.originData.riskCalcMethodInfoVO)?void 0:l.saleMethod)&&2===e.originData.exemptFlag?(R(),F(se,{key:0,modelValue:w(u).formInfo.amount,"onUpdate:modelValue":a[2]||(a[2]=e=>w(u).formInfo.amount=e),label:"保额",name:"amount",rules:[{required:!0,message:"请填写"},{trigger:"onChange",validator:(...e)=>k(...e,"sumInsured")}]},{input:A((()=>{var i,l;return[P("div",$e,[s(ne,{modelValue:w(u).formInfo.amount,"onUpdate:modelValue":a[1]||(a[1]=e=>w(u).formInfo.amount=e),"input-width":"64px",min:w(v).min,step:(null==(i=e.originData.riskCalcMethodInfoVO)?void 0:i.increaseDecreaseNum)||1,max:w(v).max},null,8,["modelValue","min","step","max"]),P("span",je,N(`金额最低${w(v).min}元，为${(null==(l=e.originData.riskCalcMethodInfoVO)?void 0:l.increaseDecreaseNum)||1}的倍数`),1)])]})),_:1},8,["modelValue","rules"])):J("",!0),2===(null==(n=null==(o=e.originData)?void 0:o.riskCalcMethodInfoVO)?void 0:n.saleMethod)?(R(),F(se,{key:1,modelValue:w(u).formInfo.premium,"onUpdate:modelValue":a[4]||(a[4]=e=>w(u).formInfo.premium=e),label:"保费",name:"premium",rules:[{required:!0,message:"请填写"},{trigger:"onChange",validator:(...e)=>k(...e,"premium")}]},{input:A((()=>{var i,l,o,t;return[P("div",Be,[s(ne,{modelValue:w(u).formInfo.premium,"onUpdate:modelValue":a[3]||(a[3]=e=>w(u).formInfo.premium=e),step:(null==(l=null==(i=e.originData)?void 0:i.riskCalcMethodInfoVO)?void 0:l.increaseDecreaseNum)||1,min:w(y).min,"input-width":"64px",max:w(y).max},null,8,["modelValue","step","min","max"]),P("span",Ge,N(`金额最低${w(y).min}元，为${(null==(t=null==(o=e.originData)?void 0:o.riskCalcMethodInfoVO)?void 0:t.increaseDecreaseNum)||1}的倍数`),1)])]})),_:1},8,["modelValue","rules"])):J("",!0),3===(null==(V=null==(b=e.originData)?void 0:b.riskCalcMethodInfoVO)?void 0:V.saleMethod)||4===(null==(h=null==(I=e.originData)?void 0:I.riskCalcMethodInfoVO)?void 0:h.saleMethod)&&((null==(D=null==(L=e.originData)?void 0:L.riskCalcMethodInfoVO)?void 0:D.minCopy)||(null==(O=null==(C=e.originData)?void 0:C.riskCalcMethodInfoVO)?void 0:O.maxCopy))?(R(),F(se,{key:2,modelValue:w(u).formInfo.copy,"onUpdate:modelValue":a[6]||(a[6]=e=>w(u).formInfo.copy=e),label:"投保份数",name:"copy",rules:[{required:!0,message:"请填写"}]},{input:A((()=>[P("div",He,[s(ne,{modelValue:w(u).formInfo.copy,"onUpdate:modelValue":a[5]||(a[5]=e=>w(u).formInfo.copy=e),step:1,min:w(g).min,max:w(g).max},null,8,["modelValue","min","max"]),P("span",ze,N(`${w(g).min}份起购，最多购买${w(g).max}份`),1)])])),_:1},8,["modelValue"])):J("",!0),[1].includes((null==(_=e.originData.riskCalcMethodInfoVO)?void 0:_.saleMethod)||0)&&1!==(null==(U=e.originData)?void 0:U.exemptFlag)||!e.originData.riskCalcMethodInfoVO.fixedAmount&&!(null==(S=w(t))?void 0:S[null==(q=e.originData)?void 0:q.riskCode])?J("",!0):(R(),F(se,{key:3,label:"保额"},{input:A((()=>{var i,a,l,o;return[P("div",null,N((null==(i=e.originData.riskCalcMethodInfoVO)?void 0:i.fixedAmount)||(null==(o=null==(l=w(t))?void 0:l[null==(a=e.originData)?void 0:a.riskCode])?void 0:o.amount)),1)]})),_:1})),d(null==(Y=null==(E=e.originData)?void 0:E.riskInsureLimitVO)?void 0:Y.insurancePeriodValueList)&&d(null==(j=null==($=e.originData)?void 0:$.riskInsureLimitVO)?void 0:j.insurancePeriodRule)?J("",!0):(R(),F(ce,{key:4,modelValue:w(u).formInfo.coveragePeriod,"onUpdate:modelValue":a[8]||(a[8]=e=>w(u).formInfo.coveragePeriod=e),label:"保障期间",name:"coveragePeriod",rules:[{required:!0,message:"请选择保障期间"}]},{input:A((()=>[P("div",Ke,[s(me,{modelValue:w(u).formInfo.coveragePeriod,"onUpdate:modelValue":a[7]||(a[7]=e=>w(u).formInfo.coveragePeriod=e),disabled:w(r).coveragePeriod.disabled,prevent:w(r).coveragePeriod.prevent?"请先选择主险保障期间":"",options:w(c),prop:{label:"name",value:"value"}},null,8,["modelValue","disabled","prevent","options"])])])),_:1},8,["modelValue"])),d(null==(G=null==(B=e.originData)?void 0:B.riskInsureLimitVO)?void 0:G.paymentPeriodValueList)&&d(null==(z=null==(H=e.originData)?void 0:H.riskInsureLimitVO)?void 0:z.paymentPeriodRule)?J("",!0):(R(),F(ce,{key:5,modelValue:w(u).formInfo.chargePeriod,"onUpdate:modelValue":a[10]||(a[10]=e=>w(u).formInfo.chargePeriod=e),label:"交费期间",name:"chargePeriod",rules:[{required:!0,message:"请选择交费期间"}]},{input:A((()=>[P("div",We,[s(me,{modelValue:w(u).formInfo.chargePeriod,"onUpdate:modelValue":a[9]||(a[9]=e=>w(u).formInfo.chargePeriod=e),disabled:w(r).chargePeriod.disabled,prevent:w(r).chargePeriod.prevent?"请先选择主险交费期间":"",options:w(p),prop:{label:"name",value:"value"}},null,8,["modelValue","disabled","prevent","options"])])])),_:1},8,["modelValue"])),d(null==(K=e.originData.riskInsureLimitVO)?void 0:K.paymentFrequencyList)&&d(null==(W=e.originData.riskInsureLimitVO)?void 0:W.paymentPeriodRule)?J("",!0):(R(),F(ce,{key:6,modelValue:w(u).formInfo.paymentFrequency,"onUpdate:modelValue":a[12]||(a[12]=e=>w(u).formInfo.paymentFrequency=e),label:"交费方式",name:"paymentFrequency",rules:[{required:!0,message:"请选择交费方式"}]},{input:A((()=>[P("div",Je,[s(me,{modelValue:w(u).formInfo.paymentFrequency,"onUpdate:modelValue":a[11]||(a[11]=e=>w(u).formInfo.paymentFrequency=e),disabled:w(r).paymentFrequency.disabled,prevent:w(r).paymentFrequency.prevent?"请先选择主险交费方式":"",options:w(f)},null,8,["modelValue","disabled","prevent","options"])])])),_:1},8,["modelValue"])),d(null==(Q=null==(X=e.originData)?void 0:X.riskInsureLimitVO)?void 0:Q.annuityDrawValueList)?J("",!0):(R(),F(ce,{key:7,modelValue:w(u).formInfo.annuityDrawDate,"onUpdate:modelValue":a[14]||(a[14]=e=>w(u).formInfo.annuityDrawDate=e),label:"领取时间",name:"annuityDrawDate"},{input:A((()=>{var i;return[P("div",Xe,[s(me,{modelValue:w(u).formInfo.annuityDrawDate,"onUpdate:modelValue":a[13]||(a[13]=e=>w(u).formInfo.annuityDrawDate=e),options:m(w(ge),(null==(i=e.originData.riskInsureLimitVO)?void 0:i.annuityDrawValueList)||[])},null,8,["modelValue","options"])])]})),_:1},8,["modelValue"])),d(null==(ae=null==(ie=e.originData)?void 0:ie.riskInsureLimitVO)?void 0:ae.annuityDrawFrequencyList)?J("",!0):(R(),F(ce,{key:8,modelValue:w(u).formInfo.annuityDrawType,"onUpdate:modelValue":a[16]||(a[16]=e=>w(u).formInfo.annuityDrawType=e),label:"领取方式",name:"annuityDrawType"},{input:A((()=>{var i;return[P("div",Qe,[s(me,{modelValue:w(u).formInfo.annuityDrawType,"onUpdate:modelValue":a[15]||(a[15]=e=>w(u).formInfo.annuityDrawType=e),options:m(w(ke),(null==(i=e.originData.riskInsureLimitVO)?void 0:i.annuityDrawFrequencyList)||[])},null,8,["modelValue","options"])])]})),_:1},8,["modelValue"])),(R(!0),x(T,null,M(e.originData.riskLiabilityInfoVOList||[],((i,a)=>(R(),x(T,{key:a},[1!==i.optionalFlag||d(i.liabilityAttributeValueList)?J("",!0):(R(),F(se,{key:0,modelValue:w(u).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>w(u).formInfo.liabilityVOList[a].liabilityAttributeValue=e,label:i.liabilityName,name:"liabilityAttributeValue",rules:[{required:i.liabilityAttributeValue,message:`请选择${i.liabilityName}`}]},{input:A((()=>{var l,o;return[P("div",null,[d(i.liabilityAttributeValueList)?(R(),x("span",Ze,"50万")):(R(),x("div",ei,[s(me,{modelValue:w(u).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>w(u).formInfo.liabilityVOList[a].liabilityAttributeValue=e,options:m(w(be),null==(o=null==(l=e.originData.riskLiabilityInfoVOList)?void 0:l[a])?void 0:o.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"])]))])]})),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])),1!==i.optionalFlag?(R(),F(se,{key:1,modelValue:w(u).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>w(u).formInfo.liabilityVOList[a].liabilityAttributeValue=e,label:i.liabilityName,name:"liabilityAttributeValue"},{input:A((()=>{var l,o;return[P("div",null,[d(i.liabilityAttributeValueList)?(R(),F(me,{key:0,modelValue:w(u).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>w(u).formInfo.liabilityVOList[a].liabilityAttributeValue=e,options:w(Ve)},null,8,["modelValue","onUpdate:modelValue","options"])):(R(),F(me,{key:1,modelValue:w(u).formInfo.liabilityVOList[a].liabilityAttributeValue,"onUpdate:modelValue":e=>w(u).formInfo.liabilityVOList[a].liabilityAttributeValue=e,options:m(w(be),null==(o=null==(l=e.originData.riskLiabilityInfoVOList)?void 0:l[a])?void 0:o.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]})),_:2},1032,["modelValue","onUpdate:modelValue","label"])):J("",!0)],64)))),128)),(null==(le=e.originData)?void 0:le.relationDesc)?(R(),x("div",ii,[s(Ee,{title:"责任投保说明"},{default:A((()=>[P("div",null,N(e.originData.relationDesc),1)])),_:1})])):J("",!0)])}}}),[["__scopeId","data-v-3b9c2786"]]);const li={class:"risk-list-wrapper"},oi={key:0,class:"add-rider-risk"},ti={class:"left-part"},ni=(e=>(G("data-v-4b309d85"),e=e(),H(),e))((()=>P("span",{class:"btn-plus"},"+",-1)));var ri=D(i({__name:"index",props:{riskInfo:{default:()=>({})},originData:{default:()=>[]},pickFactor:{type:Function,default:()=>{}},enums:{default:()=>{}}},setup(e){const i=e,l=K("source")||{},[o,t]=z(!1);a(null),a(null);const r=C({mainRiskInfo:i.riskInfo,riskInfo:i.riskInfo,requiredRiderRiskData:[],mainRiskData:{},riderRiskList:[],checkedList:[],relationListNum:0,disabledList:[],currentRiskList:[]}),u=(e,i)=>{r.currentRiskList=r.currentRiskList.concat(e),r.disabledList=i},d=e=>{me.confirm({message:"确定要删除附加险么？",confirmButtonText:"删除"}).then((()=>{var i;const a=[e];((null==(i=r.mainRiskData)?void 0:i.collocationVOList)||[]).forEach((i=>{e!==i.riskId||2!==i.collocationType&&3!==i.collocationType||a.push(i.collocationRiskId)})),r.checkedList=r.checkedList.filter((e=>!a.includes(e))),r.currentRiskList=r.currentRiskList.filter((e=>!a.includes(e.id)||(Object.assign(r.riskInfo,{[e.id]:void 0}),!1))),r.disabledList=r.disabledList.filter((e=>!a.includes(e)))})).catch((()=>{}))},m=(e,i)=>{var a,l;const o=((null==(l=null==(a=r.riskInfo)?void 0:a[i])?void 0:l.liabilityVOList)||[]).find((i=>i.liabilityCode===e.liabilityCode));return o?o.liabilityAttributeValue?o.liabilityAttributeValue:1!==e.optionalFlag?"0":"-1":""};return n((()=>r.currentRiskList),(e=>{const a=[r.mainRiskData,...e];let l=[],o=[];const t=[];a.forEach(((e,i)=>{var a,n,r;const s=(null==(a=null==e?void 0:e.riskCalcMethodInfoVO)?void 0:a.riskFactorRelationList)||[];l=l.concat(s.filter((e=>"insured"===e.factorObject)).map((e=>e.factorCode))),o=o.concat(s.filter((e=>"holder"===e.factorObject)).map((e=>e.factorCode))),t.push(null==(n=null==e?void 0:e.riskInsureLimitVO)?void 0:n.minHolderAge,null==(r=null==e?void 0:e.riskInsureLimitVO)?void 0:r.maxHolderAge)})),(e||[]).forEach((e=>{var a,l;const o={riskType:e.riskType,riskId:e.id,riskCode:e.riskCode,riskName:e.riskName,mainRiskCode:1!==e.riskType?null==(a=r.mainRiskData)?void 0:a.riskCode:void 0,mainRiskId:1!==e.riskType?null==(l=r.mainRiskData)?void 0:l.id:void 0,riskCategory:e.riskCategory,exemptFlag:i.originData.exemptFlag,exemptType:i.originData.exemptType,liabilityVOList:(e.riskLiabilityInfoVOList||[]).map((i=>({...i,liabilityAttributeCode:i.liabilityAttributeType,liabilityCode:i.liabilityCode,liabilityRateType:i.liabilityRateType,liabilityAttributeValue:m(i,e.id)})))};r.riskInfo[e.id]||Object.assign(r.riskInfo,{[e.id]:o})})),i.pickFactor({insuredFactorList:[...new Set(l)],holderFactorList:[...new Set(o)],ageRange:t})}),{deep:!0,immediate:!0}),n((()=>i.riskInfo),(e=>{r.mainRiskInfo=Object.values(e||{}).find((e=>1===(null==e?void 0:e.riskType)))||{}}),{deep:!0,immediate:!0}),n((()=>i.originData),(e=>{let i=[];const a=[];"proposal"===l.origin&&"add"!==l.type&&"repeatAdd"!==l.type?((e||[]).forEach((e=>{1===e.riskType&&(r.mainRiskData=e),i.push(e)})),i=i.filter((e=>l.showRiskList.includes(e.id)))):(e||[]).forEach((e=>{1===e.riskType?(r.mainRiskData=e,i.push(e)):2===e.collocationType?i.push(e):a.push(e)})),r.riderRiskList=a,r.currentRiskList=i}),{deep:!0,immediate:!0}),(i,a)=>{var n,m,c;const p=ce;return R(),x("div",li,[(R(!0),x(T,null,M(w(r).currentRiskList,((i,a)=>(R(),F(ai,{key:i.id,"form-info":w(r).riskInfo[i.id],index:a,enums:e.enums,"main-risk-data":w(r).mainRiskData,"main-risk-info":w(r).mainRiskInfo,"origin-data":i,"remove-risk":d,"remove-risk-list":w(r).checkedList},null,8,["form-info","index","enums","main-risk-data","main-risk-info","origin-data","remove-risk-list"])))),128)),(null==(n=w(r).riderRiskList)?void 0:n.length)-(null==(m=w(r).checkedList)?void 0:m.length)&&"proposal"!==w(l).origin?(R(),x("div",oi,[P("span",ti,N(`共有${w(r).riderRiskList.length-w(r).checkedList.length}款附加险可以添加`),1),s(p,{activated:"",class:"btn-rider-risk",onClick:a[0]||(a[0]=e=>w(t)(!0))},{default:A((()=>[ni,q(" 附加险")])),_:1})])):J("",!0),w(o)?(R(),F(_e,{key:1,modelValue:w(r).checkedList,"onUpdate:modelValue":a[1]||(a[1]=e=>w(r).checkedList=e),show:w(o),disabled:w(r).disabledList,"risk-list":w(r).riderRiskList,"collocation-list":(null==(c=w(r).mainRiskData)?void 0:c.collocationVOList)||[],onFinished:u,onClose:a[2]||(a[2]=e=>w(t)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):J("",!0)])}}}),[["__scopeId","data-v-4b309d85"]]);export{Ue as P,_e as R,ri as a};
