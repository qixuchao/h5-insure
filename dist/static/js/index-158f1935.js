import{u as D,t as O}from"./theme-fdbb0f53.js";import{P as T}from"./index-35bad872.js";import{o as M}from"./utils-fa410f53.js";import{h as I,r as f,A as k,$ as R,k as c,m as l,n as m,p as y,t as b,x as L,B as _,C as s,s as x,F as G,H as j,L as q,G as S}from"./vendor-902054a7.js";const z={key:0,class:"item"},J={key:1,class:"attachment-list"},K=["onClick"],Q={class:"attachment-list-item-name"},W={class:"attachment-list-item-icon"},X={class:"footer"},ie=I({props:{show:{type:Boolean,default:!1},contentList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0},text:{type:String,default:""},beforeReadOverText:{type:String,default:"\u540C\u610F\uFF0C\u4E0B\u4E00\u6761"},forceReadCound:{type:Number,default:0},isOnlyView:{type:Boolean,default:!1}},emits:["update:show","submit","onCloseFilePreview"],setup(w,{emit:v}){const t=w,p=D(),d=f(t.show),r=f(t.contentList.map((e,o)=>({...e,disabled:!0,readDisabled:!0}))),a=f(t.activeIndex),h=f(0),C=f(null),i=k(()=>{var e,o;return(o=(e=r.value)==null?void 0:e[a.value])==null?void 0:o.attachmentList}),n=k(()=>{var e;return(e=r.value[a.value])==null?void 0:e.readDisabled}),$=k(()=>a.value>=t.forceReadCound-1||h.value>=t.forceReadCound?!1:h.value<t.forceReadCound?a.value!==t.forceReadCound-1:!1),F=e=>{const o={fileType:e.attachmentType,fileUri:e.attachmentUri};M(o)},P=()=>{a.value+=1},B=()=>{if(t.isOnlyView){v("update:show",!1);return}v("update:show",!1),v("submit")};R(()=>t,()=>{d.value=t.show,a.value=t.activeIndex},{deep:!0,immediate:!0});const N=e=>{e&&Math.floor(e.target.scrollHeight-e.target.scrollTop)===e.target.clientHeight&&r.value[a.value].readDisabled&&(r.value[a.value].disabled=!1,r.value[a.value].readDisabled=!1,r.value[a.value+1].disabled=!1,h.value+=1)};return R(()=>a.value,()=>{t.show&&(h.value>=t.forceReadCound&&r.value.forEach(e=>{e.disabled=!1,e.readDisabled=!1}),C.value&&(C.value.scrollTop=0))},{immediate:!0}),(e,o)=>{const V=c("ProTab"),U=c("ProFilePreview"),A=c("ProSvg"),E=c("van-config-provider"),H=c("ProPopup");return l(),m(H,{show:d.value,"onUpdate:show":o[1]||(o[1]=u=>d.value=u),class:"file-preview-popup-wrap",closeable:!1,onClose:o[2]||(o[2]=u=>v("onCloseFilePreview"))},{default:y(()=>[b(E,{"theme-vars":s(p),class:"custom-provider"},{default:y(()=>[d.value?(l(),m(V,{key:0,active:a.value,"onUpdate:active":o[0]||(o[0]=u=>a.value=u),list:r.value.map((u,g)=>({title:u.attachmentName,disabled:g==a.value?!1:u.disabled||!1,slotName:`guarantee-${g}`})),class:"tab"},null,8,["active","list"])):L("",!0),_("div",{ref_key:"previewRef",ref:C,class:"list",onScroll:N},[s(i).length===1?(l(),x("div",z,[(l(),m(U,{key:s(i)[0].attachmentName,content:s(i)[0].attachmentUri,type:s(i)[0].attachmentType,"forbid-click":!0},null,8,["content","type"]))])):(l(),x("div",J,[(l(!0),x(G,null,j(s(i),(u,g)=>(l(),x("div",{key:g,class:"attachment-list-item",onClick:oe=>F(u)},[_("div",Q,q(u.attachmentName),1),_("div",W,[b(A,{name:"arrow-right"})])],8,K))),128))]))],544),_("div",X,[s($)?(l(),m(T,{key:0,shadow:!1,"theme-vars":s(p),disabled:s(n),class:"right",text:`${w.beforeReadOverText}(${a.value+1}/${w.forceReadCound})`,onClick:P},null,8,["theme-vars","disabled","text"])):(l(),m(T,{key:1,disabled:s(n),shadow:!1,"theme-vars":s(p),text:t.text,onClick:B},null,8,["disabled","theme-vars","text"]))])]),_:1},8,["theme-vars"])]),_:1},8,["show"])}}});const Y={class:"list"},Z={class:"item"},ee={class:"footer"},te=S("\u90E8\u5206\u4E3A\u662F"),ae=S("\u5168\u90E8\u4E3A\u5426"),ue=I({props:{show:{type:Boolean,default:!0},activeIndex:{default:0},contentList:{default:()=>[]}},emits:["update:show","onConfirmHealth","onCloseHealth"],setup(w,{emit:v}){const t=w,p=f(t.show),d=f(t.activeIndex),r=k(()=>{var i;return(i=t.contentList[d.value])==null?void 0:i.attachmentUri}),a=f(!0),h=i=>{a.value=!1,v("update:show",!1),v("onConfirmHealth",i)},C=()=>{a.value&&v("onCloseHealth")};return R(()=>t,()=>{p.value=t.show,d.value=t.activeIndex},{deep:!0,immediate:!0}),(i,n)=>{const $=c("ProTab"),F=c("ProFilePreview"),P=c("VanButton"),B=c("van-config-provider"),N=c("ProPopup");return l(),m(N,{show:p.value,"onUpdate:show":n[3]||(n[3]=e=>p.value=e),height:80,class:"health-notice-preview-popup-wrap",closeable:!1,onClose:n[4]||(n[4]=e=>C())},{default:y(()=>[b(B,{"theme-vars":s(O),class:"custom-provider"},{default:y(()=>[p.value?(l(),m($,{key:0,active:d.value,"onUpdate:active":n[0]||(n[0]=e=>d.value=e),list:w.contentList.map((e,o)=>({title:e.attachmentName,slotName:`guarantee-${o}`})),class:"tab"},null,8,["active","list"])):L("",!0),_("div",Y,[_("div",Z,[(l(),m(F,{key:s(r),content:s(r),type:"pdf"},null,8,["content"]))])]),_("div",ee,[b(P,{type:"primary",block:"",round:"",onClick:n[1]||(n[1]=e=>h("N"))},{default:y(()=>[te]),_:1}),b(P,{type:"primary",plain:"",block:"",round:"",onClick:n[2]||(n[2]=e=>h("allFalse"))},{default:y(()=>[ae]),_:1})])]),_:1},8,["theme-vars"])]),_:1},8,["show"])}}});export{ue as _,ie as a};
