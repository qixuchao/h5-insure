import{d as e,af as o,ag as a,i as t,h as s,r as n,j as i,aG as r,l,o as c,c as d,b as u,u as p,p as f,q as m,f as y,w as I,F as h,s as v,a as w,g as j,v as b,dG as g,T as k,bH as q,ak as C,bK as V,aS as x,aQ as L,c6 as T}from"./index-360b56eb.js";import{P as _,a as P}from"./PolicyInfo-1304983f.js";import{g as O,m as R}from"./trial-b136fa5d.js";import{n as E}from"./nextStep-fd25e82e.js";import{b as N,l as D}from"./product-45521aa7.js";import{u as Q}from"./useOrder-95386886.js";import{P as U}from"./index-4e66836d.js";import{P as F}from"./index-15ac2f40.js";import{_ as S}from"./InsureInfo-00b7c2a1.js";import{p as $,d as M}from"./utils-0927e652.js";import{Q as A}from"./notice-33e6eedd.js";import{g as B}from"./utils-f6c279ce.js";import{Q as G}from"./questionnaire-42dcb602.js";import{P as z}from"./constants-b39aa53b.js";import{T as J}from"./infoCollection-4da27e16.js";import"./core-04b25f0e.js";import"./cloneDeep-cc4d1a60.js";import"./util-602c1444.js";import"./trial-75ba1e51.js";const H={class:"long-info-preview"},K={class:"footer-button"},W=e({__name:"infoPreview",setup(e){const W=o((()=>a((()=>import("./index-748d3486.js")),["static/js/index-748d3486.js","static/css/index-fa4edf2a.css","static/js/index-360b56eb.js","static/css/index-839a5189.css","static/js/theme-94cf7d00.js","static/js/index-15ac2f40.js","static/css/index-bbfdd7ec.css","static/js/utils-f6c279ce.js","static/js/infoCollection-4da27e16.js","static/js/trial-75ba1e51.js"]))),X=t(),Y=s(),Z=Q(),{productCode:ee="",tenantId:oe,agentCode:ae="",agencyCode:te,saleChannelId:se,isShare:ne,orderNo:ie,extraInfo:re,insurerCode:le,objectType:ce="1",templateId:de,preview:ue,origin:pe}=X.query;let fe={};try{fe=JSON.parse(decodeURIComponent(re))}catch(Te){}const me=n({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),ye=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`;i({imgUrl:"",desc:"",title:"",link:ye});const Ie=i(),he=i(),ve=i(!1),we=i(0),je=i(!1),be=()=>{ve.value=!1};i();const ge=()=>{de===J.FREE&&(Z.value.extInfo.buttonCode=g.free.underWriteAndIssue,Z.value.extInfo.pageCode="productInfo",E(Z.value,((e,o)=>{o===L.JUMP_PAGE&&Y.push({path:z[e.nextPageCode],query:X.query})})))},ke=async()=>{de===J.FREE&&k("被保人已完成认证")},qe=i(),Ce=i(),Ve=i([]),xe=async()=>{let e={};const{code:o,data:a}=await O({orderNo:ie,tenantId:oe});"10000"===o&&(Object.assign(Z.value,a),e=$(a.insuredList[0].productList),qe.value=a,je.value=!0),(async e=>{let o=[];const{code:a,data:t}=await T({orderNo:ie,tenantId:oe});"10000"===a&&(o=t.productQuestionnaireVOList);const{code:s,data:n}=await D(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},a=e.filter((e=>e.businessType!==A.VISIT));me.customerQuestions=a.map((e=>{const{questionnaireDetailResponseVO:a,questionnaireId:t,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=a||{},{objectType:r,questionnaireType:l}=i||{};if(l===G.TEXT){const{content:e,textType:o}=(null==n?void 0:n[0])||{};return{content:e,contentType:B(`${o}`,e),questionnaireId:t,questionnaireName:s}}const c=(o||[]).find((e=>e.questionnaireId===t));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:t,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),N(e).then((({code:e,data:o})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:a}=M(o);Ve.value=e.concat(a)}})),R(e).then((({data:e,code:o})=>{if("10000"===o){const{productDetailResList:o,productFactor:a}=e;Ce.value=a;const{payInfo:t,other:s}=q(a);me.payInfo={...me.payInfo,...t},me.policyInfo={...me.policyInfo,...s}}}))};r((()=>{xe()}));const Le=i();return l((()=>{setTimeout((async()=>{Le.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,o)=>{var a,t,s;const n=C,i=V,r=x;return c(),d("div",H,[u(n),u(S,{"product-data":null==(t=null==(a=p(Z).insuredList)?void 0:a[0])?void 0:t.productList},null,8,["product-data"]),(null==(s=Object.keys(p(Ce)||{}))?void 0:s.length)?(c(),f(U,{key:0,ref_key:"personalInfoRef",ref:he,modelValue:p(qe),"onUpdate:modelValue":o[0]||(o[0]=e=>m(qe)?qe.value=e:null),"product-factor":p(Ce),"is-view":"","input-align":"left"},null,8,["modelValue","product-factor"])):y("",!0),p(me).payInfo.schema.length?(c(),f(p(_),{key:1,ref_key:"payInfoRef",ref:Ie,modelValue:p(Z).tenantOrderPayInfoList,"onUpdate:modelValue":o[1]||(o[1]=e=>p(Z).tenantOrderPayInfoList=e),schema:p(me).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),p(me).policyInfo.schema.length?(c(),f(p(P),{key:2,modelValue:p(Z).extInfo,"onUpdate:modelValue":o[2]||(o[2]=e=>p(Z).extInfo=e),schema:p(me).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),u(r,{title:"产品资料","show-line":!1,"show-icon":!1},{default:I((()=>[(c(!0),d(h,null,v(p(Ve),((e,o)=>(c(),f(i,{key:o,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{we.value=e,ve.value=!0})(o)},null,8,["title","onClick"])))),128))])),_:1}),w("div",K,["confirm"!==p(pe)?(c(),f(F,{key:0,shadow:!1,onClick:ke},{default:I((()=>[j(e.$slots,"default",{},(()=>[b("确认")]))])),_:3})):(c(),f(F,{key:1,shadow:!1,onClick:ge},{default:I((()=>[j(e.$slots,"default",{},(()=>[b("领取保障并激活")]))])),_:3}))]),p(ve)?(c(),f(p(W),{key:3,show:p(ve),"onUpdate:show":o[3]||(o[3]=e=>m(ve)?ve.value=e:null),"content-list":[p(Ve)[p(we)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:be},null,8,["show","content-list"])):y("",!0)])}}});export{W as default};
