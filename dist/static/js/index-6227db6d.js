import{n as e,o as n,m as a,p as t}from"./infoCollection-ccadc0c6.js";import{$ as l,_ as i,d as r,r as o,z as u,a7 as s,x as c,G as m,a2 as d,aq as f,as as p,b as v,c as y,g as I,f as D,w as g,i as P,l as V,j as k,t as C,ay as O,F as b,n as Y,K as E,L,e as S,h,B as x,T as F}from"./index-1ae7243e.js";import{u as q}from"./useDicData-d458a698.js";import{k as N}from"./trial-23019837.js";import{o as T}from"./utils-25aa3af5.js";import"./pdfdist-29dd12d8.js";import"./useStorage-c20632eb.js";const _=(e,n="YYYY-MM-DD")=>l(e).format(n),M=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).add(n,a).format(t),R=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).subtract(n,a).format(t);const U=e=>(E("data-v-866646be"),e=e(),L(),e),w={class:"com-period-cell"},$={key:0,class:"period-custom-cell period-check-btn-cell"},j=U((()=>P("div",{class:"period-cell-label"},"保障期间",-1))),A={class:"period-cell-content"},B=U((()=>P("div",{class:"period-cell-label"},"生效日期",-1))),G={class:"period-cell-content period-custom-cell-content"},H={key:2,class:"period-custom-cell period-common-cell"},K=U((()=>P("div",{class:"period-cell-label"},"保障期限",-1))),z={class:"period-cell-content"},X=U((()=>P("div",{class:"picker-custom-title"},"保险开始生效日期",-1))),J=Y("确 定");var Q=i(r({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(a,{expose:t,emit:l}){const i=a;o({});const r=(e,n)=>"year"===e?`${n}年`:"month"===e?`${n}月`:"day"===e?`${n}日`:n,Y=o(new Date),E=q("RISK_INSURANCE_PERIOD"),L=u({formInfo:i.formInfo});s((()=>L.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(Y.value=new Date(e))}));const S=o(),h=o([]);s([()=>i.insureDetail,()=>L.formInfo.activePlanCode],(()=>{var e;if(L.formInfo.insuranceStartDate="",L.formInfo.insuranceEndDate="",L.formInfo.commencementTime="",i.insureDetail)if(i.insureDetail.productRelationPlanVOList&&i.insureDetail.productRelationPlanVOList.length>0){let n=0;const a=i.insureDetail.productRelationPlanVOList.findIndex((e=>e.planCode===L.formInfo.activePlanCode));a>-1&&(n=a);const t=((null==(e=i.insureDetail.productRelationPlanVOList[n])?void 0:e.productRiskVoList[0].riskDetailVOList)||[]).find((e=>1===e.riskType));t&&(S.value=t)}else{const e=(i.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find((e=>1===e.riskType));e&&(S.value=e)}}),{deep:!0,immediate:!0}),s([()=>S.value,()=>E.value],(()=>{h.value=[],Array.isArray(E.value)&&E.value.length>1&&S.value&&(h.value=(S.value.riskInsureLimitVO.insurancePeriodValueList||[]).map((e=>{const n=E.value.find((n=>n.value===e));return n?{label:n.name,value:n.value}:null})).filter((e=>!!e))),h.value.length>0?h.value.findIndex((e=>e.value===L.formInfo.insurancePeriodValue))<0&&(L.formInfo.insurancePeriodValue=h.value[0].value):L.formInfo.insurancePeriodValue=N.YEAR_1}),{deep:!0,immediate:!0});const x=c((()=>{var n,a;return(null==(n=S.value)?void 0:n.insuranceStartType)?String(null==(a=S.value)?void 0:a.insuranceStartType):e.CURRENT_DAY})),F=c((()=>{var e,a;return(null==(e=S.value)?void 0:e.insuranceEndType)?String(null==(a=S.value)?void 0:a.insuranceEndType):n.CURRENT_DAY})),[T,U]=m(!1),Q=()=>{U(!0)},W=new Date(M(new Date,1,"day")),Z=c((()=>{var n;if(x.value===e.CUSTOM_DAY){const e=null==(n=S.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(!e)return new Date;const a=M(new Date,Number(e),"day");return new Date(a)}return new Date})),ee=e=>{L.formInfo.insuranceStartDate=`${_(e)} 00:00:00`,U(!1)},ne=()=>{U(!1)};return s([()=>x.value,()=>L.formInfo.insurancePeriodValue,()=>L.formInfo.insuranceStartDate,()=>S.value],(()=>{if(!L.formInfo.insurancePeriodValue)return;const[a,t]=L.formInfo.insurancePeriodValue.split("_");if(L.formInfo.insuranceStartDate||(x.value===e.CUSTOM_DAY||x.value===e.NEXT_DAY?L.formInfo.insuranceStartDate=`${M(new Date,1,"day")} 00:00:00`:L.formInfo.insuranceStartDate=`${_(new Date)} 00:00:00`),"to"!==a){const e=`${R(L.formInfo.insuranceStartDate,1,"day")} 00:00:00`;F.value===n.CURRENT_DAY?L.formInfo.insuranceEndDate=`${M(e,Number(t),a)} 23:59:59`:L.formInfo.insuranceEndDate=`${M(L.formInfo.insuranceStartDate,Number(t),a)} 00:00:00`}else{let e=L.formInfo.tenantOrderInsuredList[0].birthday;L.formInfo.tenantOrderInsuredList[0].certType===d.CERT&&L.formInfo.tenantOrderInsuredList[0].certNo&&f(L.formInfo.tenantOrderInsuredList[0].certNo)&&(e=p(L.formInfo.tenantOrderInsuredList[0].certNo));const l=`${R(e,1,"day")} 00:00:00`;"single"===t&&(L.formInfo.insuranceEndDate="9999-99-99 23:59:59"),F.value===n.CURRENT_DAY?L.formInfo.insuranceEndDate=`${M(l,Number(t),a)} 23:59:59`:L.formInfo.insuranceEndDate=`${M(e,Number(t),a)} 00:00:00`}}),{immediate:!0}),t({}),(n,a)=>{const t=v("ProRadioButton"),l=v("ProSvg"),i=v("van-config-provider"),o=v("VanButton"),u=v("van-datetime-picker"),s=v("ProPopup");return y(),I(b,null,[D(i,null,{default:g((()=>[P("div",w,[h.value.length>1?(y(),I("div",$,[j,P("div",A,[D(t,{modelValue:V(L).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=e=>V(L).formInfo.insurancePeriodValue=e),options:h.value},null,8,["modelValue","options"])])])):k("",!0),V(x)===V(e).CUSTOM_DAY?(y(),I("div",{key:1,class:"period-custom-cell period-common-cell",onClick:Q},[B,P("div",G,[P("span",null,C(V(L).formInfo.insuranceStartDate?V(_)(V(L).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),D(l,{class:"custom--arrow-right",name:"arrow-right"})])])):k("",!0),V(x)!==V(e).CUSTOM_DAY?(y(),I("div",H,[K,P("div",z,C(V(L).formInfo.insuranceStartDate?V(_)(V(L).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+C(V(L).formInfo.insuranceEndDate?V(_)(V(L).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):k("",!0)])])),_:1}),D(s,{show:V(T),"onUpdate:show":a[3]||(a[3]=e=>O(T)?T.value=e:null),height:"340",closeable:!0},{default:g((()=>[D(u,{modelValue:Y.value,"onUpdate:modelValue":a[2]||(a[2]=e=>Y.value=e),type:"date",title:"保险开始生效日期","min-date":V(W),"max-date":V(Z),formatter:r,"visible-item-count":5,class:"custom-date-picker",onConfirm:ee,onCancel:ne},{cancel:g((()=>[])),title:g((()=>[X])),confirm:g((()=>[D(o,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:a[1]||(a[1]=e=>T.value=!1)},{default:g((()=>[J])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-866646be"]]);const W=e=>(E("data-v-1defc39e"),e=e(),L(),e),Z={class:"com-payment-type"},ee={class:"title"},ne={key:0,class:"picture-payment-content"},ae=["onClick"],te=["src"],le=["src"],ie={key:1,class:"custom-cell check-btn-cell"},re=W((()=>P("div",{class:"cell-label"},"保障方案",-1))),oe={class:"cell-content"},ue={key:0,class:"picture-payment-content"},se=["onClick"],ce=["src"],me=["src"],de={key:1,class:"custom-cell check-btn-cell"},fe=W((()=>P("div",{class:"cell-label"},"交费方式",-1))),pe={class:"cell-content"},ve={class:"custom-cell common-cell"},ye=W((()=>P("div",{class:"cell-label"},"实付保费",-1))),Ie={key:0,class:"cell-content actual-premium"},De={class:"cell-content actual-premium"},ge={key:0,class:"actual-premium actual-premium-month-tip"},Pe={key:0,class:"feerate-explain"},Ve={class:"content"},ke=W((()=>P("div",{class:"triangle-top"},null,-1)));var Ce=i(r({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premiumInfo:{type:Object,default:()=>{}}},emits:["update-active-plan"],setup(e,{expose:n,emit:l}){const i=e;o({});const r=u({formInfo:i.formInfo}),m=o([]),d=o(),f=o(),p=c((()=>{var e;return"1"===String(null==(e=d.value)?void 0:e.paymentFrequencyFlag)}));c((()=>{var e;return null==(e=f.value)?void 0:e.productPremiumVOList.find((e=>e.paymentFrequency===r.formInfo.paymentFrequency))}));const O=c((()=>i.premiumInfo.premiumLoadingText?i.premiumInfo.premiumLoadingText:i.premiumInfo.premium?`${i.premiumInfo.premium||""}${i.premiumInfo.actualUnit||"元"}`:`${i.premiumInfo.minPremiun||""}${i.premiumInfo.unit||""}`)),Y=c((()=>{if(f){const{premiumExplain:e,premiumExplainViewName:n,premiumExplainUri:a}=f.value||{};return{premiumExplain:e,premiumExplainUri:a,premiumExplainViewName:n}}return null})),E=c((()=>Y.value&&Y.value.premiumExplain&&Y.value.premiumExplainViewName));s((()=>i.configDetail),(()=>{var e;i.isMultiplePlan&&i.configDetail&&(m.value=null==(e=i.configDetail.tenantProductInsureVO)?void 0:e.planList)}),{immediate:!0,deep:!0}),s([()=>i.configDetail,()=>i.isMultiplePlan,()=>r.formInfo.activePlanCode],(()=>{if(i.configDetail)if(i.isMultiplePlan){let e=0;const n=i.configDetail.tenantProductInsureVO.planList.findIndex((e=>e.planCode===r.formInfo.activePlanCode));n>-1&&(e=n),d.value=i.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,f.value=i.configDetail.tenantProductInsureVO.planList[e]}else d.value=i.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,f.value=i.configDetail.tenantProductInsureVO.planInsureVO}),{deep:!0,immediate:!0});const L=c((()=>{var e;if(d.value&&d.value.paymentFrequency){return((null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[]).length>1}return!1}));s((()=>d.value),(()=>{var e;if(d.value){const n=(null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[];if(1===n.length)return void(r.formInfo.paymentFrequency=d.value.paymentFrequency);if(2===n.length&&n.filter((e=>![a.SINGLE,a.MONTH].includes(e))).length<1)return void(r.formInfo.paymentFrequency||(r.formInfo.paymentFrequency=a.SINGLE));n.length>1&&!r.formInfo.paymentFrequency&&(r.formInfo.paymentFrequency=null==n?void 0:n[0])}}),{immediate:!0,deep:!0});const q=c((()=>{var e;return d.value?null==(e=d.value.paymentFrequencyList||[])?void 0:e.map((e=>({...e,paymentFrequency:e.skinValue}))):[]})),N=c((()=>q.value.length>0)),_=c((()=>i.isMultiplePlan?i.configDetail.tenantProductInsureVO.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[])),M=c((()=>{var e,n;if(d.value){const a=(null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[];return 1===a.length&&(r.formInfo.paymentFrequency=a[0]),null==(n=a||[])?void 0:n.map((e=>({label:t[e],value:e})))}return[]})),R=e=>{r.formInfo.activePlanCode=e},U=()=>{var e,n;(null==(e=Y.value)?void 0:e.premiumExplainUri)?T({fileType:"pdf",fileUri:null==(n=Y.value)?void 0:n.premiumExplainUri}):F("无费率文件！")};return n({}),(n,a)=>{const t=v("ProRadioButton"),l=v("templat"),o=v("ProDivider"),u=v("van-config-provider");return y(),S(u,null,{default:g((()=>[P("div",Z,[P("div",ee,C(V(L)?"交费方式":"保障计划"),1),e.isMultiplePlan?(y(),I(b,{key:0},[V(_).length>0?(y(),I("div",ne,[(y(!0),I(b,null,h(V(_),(e=>(y(),I("div",{key:e.planCode,class:x("picture-payment-item"),onClick:n=>R(e.planCode)},[V(r).formInfo.activePlanCode==e.planCode?(y(),I("img",{key:0,src:e.selectedPic},null,8,te)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,le))],8,ae)))),128))])):(y(),I("div",ie,[re,P("div",oe,[D(t,{modelValue:V(r).formInfo.activePlanCode,"onUpdate:modelValue":a[0]||(a[0]=e=>V(r).formInfo.activePlanCode=e),options:m.value,prop:{value:"planCode",label:"planName"},onChange:R},null,8,["modelValue","options"])])]))],64)):k("",!0),V(p)?(y(),S(l,{key:1},{default:g((()=>[V(N)&&V(q).length>1?(y(),I("div",ue,[(y(!0),I(b,null,h(V(q),(e=>(y(),I("div",{key:e.paymentFrequency,class:x("picture-payment-item"),onClick:n=>{return a=e.paymentFrequency,void(r.formInfo.paymentFrequency=a);var a}},[V(r).formInfo.paymentFrequency==e.paymentFrequency?(y(),I("img",{key:0,src:e.selectedPic},null,8,ce)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,me))],8,se)))),128))])):V(M).length>1?(y(),I("div",de,[fe,P("div",pe,[D(t,{modelValue:V(r).formInfo.paymentFrequency,"onUpdate:modelValue":a[1]||(a[1]=e=>V(r).formInfo.paymentFrequency=e),options:V(M)},null,8,["modelValue","options"])])])):k("",!0)])),_:1})):k("",!0),D(Q,{"form-info":V(r).formInfo,"insure-detail":e.insureDetail,"config-detail":e.configDetail},null,8,["form-info","insure-detail","config-detail"]),V(O)&&V(E)?(y(),I(b,{key:2},[P("div",ve,[ye,i.premiumInfo.premiumLoadingText?(y(),I("div",Ie,C(V(O)),1)):(y(),I(b,{key:1},[P("div",De,C(V(O)),1),"5"===V(r).formInfo.paymentFrequency?(y(),I("div",ge," 共12期 ")):k("",!0)],64))]),V(E)?(y(),I("div",Pe,[P("div",Ve,[ke,P("div",null,[P("span",null,C(V(Y).premiumExplain||""),1),P("span",{class:"file-name",onClick:U},"《"+C(V(Y).premiumExplainViewName||"")+"》",1)])])])):k("",!0)],64)):k("",!0)]),D(o)])),_:1})}}}),[["__scopeId","data-v-1defc39e"]]);export{Ce as default};
