var Y=Object.defineProperty,B=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var R=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var D=(e,r,t)=>r in e?Y(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,h=(e,r)=>{for(var t in r||(r={}))q.call(r,t)&&D(e,t,r[t]);if(R)for(var t of R(r))w.call(r,t)&&D(e,t,r[t]);return e},T=(e,r)=>B(e,$(r));import{d as V}from"./vendor-505c98f2.js";import{I as J,f as K}from"./infoCollection-192ba138.js";import{b as z,a as j,R as P,h as E}from"./trial-e1718f24.js";import{I as l,C as y,H as u}from"./index-19eae3bb.js";const G=e=>{const{tenantId:r,riskList:t,riskPremium:i,productId:a}=e;return t.map(n=>{var o;return{tenantId:r,amountUnit:1,annuityDrawFrequency:n.annuityDrawDate,annuityDrawType:n.annuityDrawType,paymentFrequency:n.paymentFrequency,paymentPeriod:n.chargePeriod.split("_")[1],paymentPeriodType:z[n.chargePeriod.split("_")[0]],insurancePeriodType:j[n.coveragePeriod==="to_life"?"to_life":n.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+n.coveragePeriod.split("_")[1])?0:n.coveragePeriod.split("_")[1],riskCode:n.riskCode,riskType:n.riskType,extInfo:{riskId:n.riskId,copy:n.copy},initialPremium:(o=i[n.riskCode])==null?void 0:o.premium,liabilityDetails:n.liabilityVOList.map(d=>({liabilityCode:d.liabilityCode,liabilityName:d.liabilityName,refundMethod:d.liabilityAttributeValue})),productId:a,currantAmount:3e4,initAmount:3e4}})},C=(e,r,t=[],i=K.YEAR)=>{const a=e.filter(s=>{try{return s.extraInfo?JSON.parse(s.extraInfo).packageCode?!!t.includes(s.id):!0:!1}catch{return!1}}),n=a.find(s=>s.riskType===P.MAIN_RISK);return a.map(s=>{const{riskInsureLimitVO:o,riskCategory:d,id:c,riskType:p,riskName:I,riskCode:N,extraInfo:x,riskLiabilityInfoVOList:H,riskCalcMethodInfoVO:A}=s,{insurancePeriodType:Q,insurancePeriodValueList:f,paymentFrequencyList:X,paymentPeriodValueList:g,paymentPeriodType:W,annuityDrawFrequencyList:O,annuityDrawValueList:L,insurancePeriodRule:M,paymentPeriodRule:U}=o,{fixedAmount:F,minCopy:v}=A,m={amount:F,riskCode:N,riskId:c,riskName:I,paymentFrequency:i,extraInfo:x,chargePeriod:g==null?void 0:g[0],annuityDrawDate:L==null?void 0:L[0],riskType:p,annuityDrawFrequency:O==null?void 0:O[0],copy:v,coveragePeriod:f==null?void 0:f[0],insuredCode:r==null?void 0:r.insurerCode,liabilityVOList:H.filter(k=>k.optionalFlag===1&&k.liabilityCode!=="FXG086"),riskCategory:d};return p===P.MAIN_RISK?m:(M===E.ONE_YEAR&&(m.coveragePeriod="year_1"),U===E.ONE_YEAR&&(m.chargePeriod="year_1"),T(h({},m),{mainRiskId:n==null?void 0:n.id,mainRiskCode:n==null?void 0:n.riskCode}))})},ie=e=>{var t,i,a;return{orderAmount:e.premium,tenantId:e.tenantId,venderCode:(t=e.detail)==null?void 0:t.insurerCode,applicationNo:e.applicationNo,policyNo:e.policyNo,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:e.orderCategory,orderStatus:e.orderStatus,orderTopStatus:e.orderTopStatus,tenantOrderHolder:{tenantId:e.tenantId,name:e.holder.name,certNo:e.holder.certNo,certType:y.CERT,mobile:e.holder.mobile,birthday:l(e.holder.certNo),gender:u(e.holder.certNo),extInfo:{hasSocialInsurance:e.holder.socialFlag}},extInfo:{extraInfo:{renewalDK:e.renewalDK,paymentMethod:e.paymentMethod,successJumpUrl:e.successJumpUrl},iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{tenantId:e.tenantId,relationToHolder:e.insured.relationToHolder,certNo:e.insured.certNo,certType:y.CERT,name:e.insured.name,birthday:l(e.insured.certNo),gender:u(e.insured.certNo),extInfo:{hasSocialInsurance:e.insured.socialFlag},tenantOrderProductList:[{tenantId:e.tenantId,productCode:(i=e.detail)==null?void 0:i.productCode,productName:(a=e.detail)==null?void 0:a.productName,premium:e.premium,tenantOrderRiskList:e.tenantOrderRiskList}]}]}},b=e=>{if(!e)return 0;const[r,t]=e.split("_");return r==="day"?parseInt(t,10):parseInt(t,10)*365},_=(e,r,t)=>{const i=b(e),a=b(r);return console.log(i,a,t),i<=t&&a>=t},S=(e,r,t=i=>!0)=>{const i=V().diff(l(r),"day"),a=u(r),n=[];return e.forEach(s=>{const{riskDetailVOList:o}=s,d=o.map(c=>{const{maxHolderAge:p,minHolderAge:I}=c.riskInsureLimitVO;return _(I,p,i)?(c.riskLiabilityInfoVOList=c.riskLiabilityInfoVOList.filter(N=>t({riskCode:c.riskCode,liabilityCode:N.liabilityCode,age:i,sex:a})),c):null});n.push({riskDetailVOList:d.filter(c=>c)})}),n},ae=(e,r=!1,t=i=>!0)=>{var n,s,o;let i=[];return r?(console.log(S(e.insureDetail.productRiskVoList,e.insured.certNo,t),"slsl==000",e.insureDetail.productRiskVoList[0].riskDetailVOList),i=C((s=(n=S(e.insureDetail.productRiskVoList,e.insured.certNo,t))==null?void 0:n[0])==null?void 0:s.riskDetailVOList,e.productDetail,[],e.paymentFrequency)):i=e.insureDetail.productRiskVoList.map(d=>C(d.riskDetailVOList,e.productDetail,e.packageRiskIdList,e.paymentFrequency)),{calcData:{holder:{personVO:{birthday:l(e.holder.certNo),certType:y.CERT,certNo:e.holder.certNo,gender:Number(u(e.holder.certNo)),mobile:e.holder.mobile,name:e.holder.name,socialFlag:e.holder.socialFlag}},insuredVOList:[{insuredCode:(o=e.productDetail)==null?void 0:o.insurerCode,relationToHolder:e.insured.relationToHolder,personVO:{birthday:l(e.insured.certNo),certType:y.CERT,certNo:e.insured.certNo,gender:Number(u(e.insured.certNo)),name:e.insured.name,socialFlag:e.insured.socialFlag},productPlanVOList:[{riskVOList:i.flat()}]}],productCode:e.productDetail.productCode,tenantId:e.tenantId},riskVOList:i.flat()}},se=e=>{var i;const{orderDetail:r}=e;return console.log(e,"slslsl"),{agencyId:r.agencyId,venderCode:r.venderCode,applicationNo:r.applicationNo,orderDataSource:r.orderDataSource,policyNo:r.policyNo,commencementTime:r.commencementTime,orderNo:r.orderNo,tenantId:e.tenantId,orderAmount:e.premium,extInfo:{extraInfo:T(h({},r.extInfo.extraInfo),{successJumpUrl:e.successJumpUrl}),iseeBizNo:e.iseeBizNo},tenantOrderHolder:{tenantId:r.tenantOrderHolder.tenantId,name:r.tenantOrderHolder.name,certType:r.tenantOrderHolder.certType,certNo:r.tenantOrderHolder.certNo,mobile:r.tenantOrderHolder.mobile,birthday:r.tenantOrderHolder.birthday,gender:r.tenantOrderHolder.gender},tenantOrderInsuredList:[{premium:e.premium,tenantId:r.tenantOrderInsuredList[0].tenantId,relationToHolder:r.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:r.tenantOrderInsuredList[0].insuredBeneficiaryType,name:r.tenantOrderInsuredList[0].name,hasSocialInsurance:r.tenantOrderInsuredList[0].hasSocialInsurance,certType:r.tenantOrderInsuredList[0].certType,certNo:r.tenantOrderInsuredList[0].certNo,mobile:r.tenantOrderInsuredList[0].mobile,birthday:r.tenantOrderInsuredList[0].birthday,gender:r.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:r.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:e.productDetail.productCode,productName:e.productDetail.productName,tenantOrderRiskList:G({tenantId:e.tenantId,riskList:C(e.insureDetail.productRiskVoList[0].riskDetailVOList,e.productDetail),riskPremium:{},productId:(i=e.productDetail)==null?void 0:i.id})}]}]}},oe=e=>e&&e.length?e.filter(t=>t.value===J.INSURE).map(t=>t.productRiskVoList.map(i=>i.id)).flat():[],de=(e,r)=>!e.productRiskVoList.some(i=>{const a=i.riskInsureLimitVO.minHolderAge,n=i.riskInsureLimitVO.maxHolderAge,s=V().diff(l(r),"day");return!_(a,n,s)}),ce=e=>{let r=(Math.round(parseFloat(e.toString())*100)/100).toString();const t=r.toString().split(".");return t.length===1?(r=`${r.toString()}.00`,r):t.length>1?(t[1].length<2&&(r=`${r.toString()}0`),r):e},le=e=>{if(typeof e=="string"){const r=e==null?void 0:e.substring(1);return e==null?void 0:e.replace(r,"**")}return e},ue=e=>e==null?void 0:e.replace(/(\d{3})\d*(\d{4})/,"$1****$2"),pe=e=>e==null?void 0:e.replace(/^(.{6})(?:\d+)(.{2})$/,"$1**********$2"),me=e=>/^\d{6}$/.test(e);export{ie as a,ce as b,de as c,se as d,C as e,ae as g,pe as i,ue as m,le as n,oe as o,G as t,me as v};
