import{g as G,E as N,M as K,aa as Te,_ as M,r as P,j as g,n as _,p as C,m as F,z as v,F as S,G as W,k as R,ab as xe,J as q,A as e,C as Ae,a4 as Re,a5 as Oe,Q as Ee,a7 as j,y as w,d as Y,t as E,R as _e,o as Ue,D as Be}from"./vendor-f5ae78f6.js";import{S as Me,d as Ne,e as $e,f as Q,A as we,g as qe,L as he,h as Ye}from"./trial-6afdb4f7.js";import{_ as H,K as Se,R as je}from"./index-adc8d77f.js";import{u as Ge}from"./useDicData-a972b983.js";const Ke=u=>(Re("data-v-7d3c3028"),u=u(),Oe(),u),He={class:"com-risk-list-wrapper"},Qe=Ke(()=>v("div",{class:"popup-title"},"\u9009\u62E9\u9644\u52A0\u9669",-1)),We={class:"risk-list"},ze={class:"cell-title"},Je={class:"title"},Xe={class:"footer-button"},Ze=Ae("\u786E\u8BA4"),ei=G({props:{riskList:{default:()=>[]},show:{type:Boolean,default:!1},collocationList:{default:()=>[]},disabled:{default:()=>[]},modelValue:{default:()=>[]}},emits:["finished","close","update:modelValue"],setup(u,{emit:n}){const h=u,x=N([]),b=N([]),i=N([...h.disabled]),V=K({show:h.show,currentChecked:[...h.modelValue]}),D=(p,s)=>{if(!h.collocationList.length){if(s){V.currentChecked=[];return}V.currentChecked.push(p);return}let I=V.currentChecked,c=i.value;s?(h.collocationList.forEach(a=>{p===a.riskId&&(a.collocationType===2?I=I.filter(t=>t!==a.collocationRiskId||t!==p):a.collocationType===3?(I=I.filter(t=>t!==p),c=c.filter(t=>t!==a.collocationRiskId)):I=I.filter(t=>t!==p))}),V.currentChecked=I,i.value=c):(h.collocationList.forEach(a=>{p===a.riskId&&(s||(a.collocationType===2?I.push(a.collocationRiskId):a.collocationType===3&&c.push(a.collocationRiskId),I.push(p)))}),V.currentChecked.push(...I),i.value=c)},k=p=>{var I,c,a;if(i.value.includes(p))return;const s=V.currentChecked.includes(p);D(p,s),(a=(c=(I=x==null?void 0:x.value)==null?void 0:I[p])==null?void 0:c.toggle)==null||a.call(c)},A=()=>{n("close")},y=()=>{const p=h.riskList.filter(s=>V.currentChecked.includes(s.id));n("update:modelValue",[...new Set(b.value)]),n("finished",p,i.value),n("close")};return Te(()=>{x.value=[]}),M(()=>V.currentChecked,p=>{b.value=p},{deep:!0,immediate:!0}),M(()=>h.modelValue,p=>{b.value=p||[],i.value.push(...p||[])},{deep:!0,immediate:!0}),(p,s)=>{const I=P("van-checkbox"),c=P("VanCell"),a=P("van-cell-group"),t=P("van-checkbox-group"),o=P("VanButton"),d=P("VanPopup");return g(),_("div",He,[C(d,{show:e(V).show,"onUpdate:show":s[1]||(s[1]=r=>e(V).show=r),title:"\u9009\u62E9\u9644\u52A0\u9669","show-footer":"",round:"",position:"bottom",closeable:"",onClose:A},{default:F(()=>[Qe,v("div",We,[C(t,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=r=>b.value=r)},{default:F(()=>[C(a,{inset:""},{default:F(()=>[(g(!0),_(S,null,W(u.riskList,r=>(g(),R(c,{key:r.id,title:r.riskName,disabled:i.value.includes(r.id),onClick:l=>k(r.id)},{"right-icon":F(()=>[C(I,{ref_for:!0,ref:l=>x.value[r.id]=l,shape:"square",disabled:i.value.includes(r.id),name:r.id,onClick:xe(l=>k(r.id),["stop"])},null,8,["disabled","name","onClick"])]),title:F(()=>[v("div",ze,[v("div",Je,q(r.riskName),1)])]),_:2},1032,["title","disabled","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])]),v("div",Xe,[C(o,{type:"primary",disabled:!e(V).currentChecked.length,block:"",onClick:y},{default:F(()=>[Ze]),_:1},8,["disabled"])])]),_:1},8,["show"])])}}});var ii=H(ei,[["__scopeId","data-v-7d3c3028"]]);const ti={class:"com-personal-info-wrapper"},oi={class:"pro-radio-wrap"},ai={class:"pro-radio-wrap"},ni=G({props:{formInfo:{default:()=>({})},insuredCode:{default:""},factorList:{default:()=>[]},ageRange:{default:()=>[]}},setup(u,{expose:n}){var s,I;const h=u,x=Ge(`${(I=(s=h.insuredCode)==null?void 0:s.toLocaleUpperCase)==null?void 0:I.call(s)}_OCCUPATION`),[b,i]=Ee(),V=N(),D=j("source")||{},k=K({formInfo:h.formInfo,occupationalText:"",occupationCodeList:[]}),A=()=>new Promise((c,a)=>{var t;(t=V.value)==null||t.validate().then(()=>{c("")},o=>{var d;(d=V.value)==null||d.scrollToField(o==null?void 0:o[0].name),a()})}),y=c=>{const a=c||[];for(let t=0;t<a.length;t++)for(let o=t+1;o<a.length;o++){const d=a[t].split("_"),r=a[o].split("_"),l=a[t];d[0]===r[0]?d>r&&(a[t]=a[o],a[o]=l):d[0]==="age"&&(a[t]=a[o],a[o]=l)}return a},p=w(()=>{const c=y(h==null?void 0:h.ageRange),a=(l="")=>{const m=+l.split("_")[1],O=l.split("_")[0];return[m,O]},t=a(c[0]),o=a(c[c.length-1]),d=Y().subtract(t[0],t[1]==="age"?"year":"day").format("YYYY-MM-DD");let r=Y().subtract(o[0],o[1]==="age"?"year":"day").format("YYYY-MM-DD");return Y(r).subtract(1,"year").isBefore(d)&&(r=Y(r).subtract(1,"year").add(1,"day").format("YYYY-MM-DD")),{minAge:new Date(r),maxAge:new Date(d)}});return n({validateForm:A,ageRangeObj:p.value}),(c,a)=>{const t=P("VanField"),o=P("ProRadioButton"),d=P("VanForm"),r=P("van-datetime-picker"),l=P("van-popup");return g(),_("div",ti,[C(d,{ref_key:"formRef",ref:V,"input-align":"right","error-message-align":"right"},{default:F(()=>[e(D).type==="proposal"&&(e(D).type==="add"||e(D).type==="repeatAdd")||e(D).type!=="proposal"&&(u.factorList.includes("APPLICANT.AGE")||u.factorList.includes("AGE")||u.factorList.includes("DAY")||u.factorList.includes("APPLICANT.DAY"))?(g(),R(t,{key:0,modelValue:e(k).formInfo.birthday,"onUpdate:modelValue":a[0]||(a[0]=m=>e(k).formInfo.birthday=m),rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u51FA\u751F\u65E5\u671F"}],name:"birth",label:"\u51FA\u751F\u65E5\u671F",class:"isLink",readonly:"","is-link":"",formatter:m=>m&&e(Y)(m).format("YYYY-MM-DD"),placeholder:"\u8BF7\u9009\u62E9",onClick:a[1]||(a[1]=m=>e(i)(!0))},null,8,["modelValue","formatter"])):E("",!0),e(D).type==="proposal"&&(e(D).type==="add"||e(D).type==="repeatAdd")||e(D).type!=="proposal"&&(u.factorList.includes("APPLICANT.GENDER")||u.factorList.includes("GENDER"))?(g(),R(t,{key:1,modelValue:e(k).formInfo.gender,"onUpdate:modelValue":a[3]||(a[3]=m=>e(k).formInfo.gender=m),name:"gender",label:"\u6027\u522B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6027\u522B"}]},{input:F(()=>[v("div",oi,[C(o,{modelValue:e(k).formInfo.gender,"onUpdate:modelValue":a[2]||(a[2]=m=>e(k).formInfo.gender=m),options:e(Se)},null,8,["modelValue","options"])])]),_:1},8,["modelValue"])):E("",!0),u.factorList.includes("SOCIAL_INS")||u.factorList.includes("APPLICANT.SOCIAL_INS")?(g(),R(t,{key:2,modelValue:e(k).formInfo.socialFlag,"onUpdate:modelValue":a[5]||(a[5]=m=>e(k).formInfo.socialFlag=m),name:"socialFlag",label:"\u793E\u4FDD",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u793E\u4FDD"}]},{input:F(()=>[v("div",ai,[C(o,{modelValue:e(k).formInfo.socialFlag,"onUpdate:modelValue":a[4]||(a[4]=m=>e(k).formInfo.socialFlag=m),options:e(Me)},null,8,["modelValue","options"])])]),_:1},8,["modelValue"])):E("",!0),u.factorList.includes("OCCUPATION_CATEGORY")||u.factorList.includes("APPLICANT.OCCUPATION_CATEGORY")?(g(),R(je,{key:3,modelValue:e(k).formInfo.occupationCodeList[0],"onUpdate:modelValue":a[6]||(a[6]=m=>e(k).formInfo.occupationCodeList[0]=m),field0:e(k).formInfo.occupationCodeList[0],"onUpdate:field0":a[7]||(a[7]=m=>e(k).formInfo.occupationCodeList[0]=m),field1:e(k).formInfo.occupationCodeList[1],"onUpdate:field1":a[8]||(a[8]=m=>e(k).formInfo.occupationCodeList[1]=m),field2:e(k).formInfo.occupationCodeList[2],"onUpdate:field2":a[9]||(a[9]=m=>e(k).formInfo.occupationCodeList[2]=m),required:"",name:"occupationCodeList",label:"\u804C\u4E1A\u7C7B\u578B","data-source":e(x),mapping:{label:"value",value:"code",children:"children"},"show-full-value":"","need-key":"name"},null,8,["modelValue","field0","field1","field2","data-source"])):E("",!0)]),_:1},512),C(l,{show:e(b),"onUpdate:show":a[12]||(a[12]=m=>_e(b)?b.value=m:null),position:"bottom"},{default:F(()=>[C(r,{type:"date","min-date":e(p).minAge,"max-date":e(p).maxAge,onConfirm:a[10]||(a[10]=m=>{e(k).formInfo.birthday=e(Y)(m).format("YYYY-MM-DD"),e(i)(!1)}),onCancel:a[11]||(a[11]=m=>e(i)(!1))},null,8,["min-date","max-date"])]),_:1},8,["show"])])}}});var _i=H(ni,[["__scopeId","data-v-81fcd45e"]]);const ri={class:"com-risk-card-wrapper part-card"},ui={class:"custom-field"},li={class:"field-tip"},si={class:"custom-field"},di={class:"field-tip"},mi={class:"custom-field"},fi={class:"field-tip"},ci={class:"pro-radio-wrap"},pi={class:"pro-radio-wrap"},yi={class:"pro-radio-wrap"},gi={class:"pro-radio-wrap"},Ii={class:"pro-radio-wrap"},Vi={key:0},Di={key:1,class:"pro-radio-wrap"},ki={key:9,class:"liab-desc"},Li=G({props:{originData:{default:()=>({})},formInfo:{default:()=>({})},mainRiskData:{default:()=>({})},mainRiskInfo:{default:()=>({})},index:{default:0},removeRisk:{type:Function,default:()=>{}},removeRiskList:{default:()=>[]},enums:{default:()=>({})}},setup(u){const n=u,h=N({}),x=j("premium")||{};h.value=j("enumList")||{};const b=N({chargePeriod:{disabled:!1,prevent:!1},coveragePeriod:{disabled:!1,prevent:!1},paymentFrequency:{disabled:!1,prevent:!1}}),i=K({formInfo:n.formInfo}),V=t=>typeof t!="boolean"&&!t||Array.isArray(t)&&!t.length?!0:{}.toString.call(t)==="[object Object]"?Object.keys(t).length:!1,D=(t,o,d={})=>{let r=o;return Array.isArray(o)||(r=[`${r}`]),(t||[]).filter(l=>r.includes(`${l.value}`)||r.includes(l.value))},k=w(()=>{var t,o,d,r,l,m,O,U;return((t=n.originData)==null?void 0:t.riskType)===1?D(n.enums.RISK_INSURANCE_PERIOD,((o=n.originData.riskInsureLimitVO)==null?void 0:o.insurancePeriodValueList)||[]):((d=n.originData)==null?void 0:d.periodType)===2?D([{value:"year_1",name:"1\u5E74"}],["year_1"]):((r=n.originData)==null?void 0:r.exemptFlag)===1?D(Ne,[`${(m=(l=n==null?void 0:n.originData)==null?void 0:l.riskInsureLimitVO)==null?void 0:m.insurancePeriodRule}`]):D((O=n.enums)==null?void 0:O.RISK_INSURANCE_PERIOD,((U=n.mainRiskData.riskInsureLimitVO)==null?void 0:U.insurancePeriodValueList)||[])}),A=w(()=>{var t,o,d,r,l,m,O,U;return((t=n.originData)==null?void 0:t.riskType)===1?D((o=n==null?void 0:n.enums)==null?void 0:o.RISK_PAYMENT_PERIOD,((d=n.originData.riskInsureLimitVO)==null?void 0:d.paymentPeriodValueList)||[]):((r=n.originData)==null?void 0:r.exemptFlag)===1?D($e,[`${(m=(l=n==null?void 0:n.originData)==null?void 0:l.riskInsureLimitVO)==null?void 0:m.paymentPeriodRule}`]):((O=n.originData)==null?void 0:O.periodType)===2?D([{value:"year_1",name:"1\u5E74\u4EA4"}],["year_1"]):D(n.enums.RISK_PAYMENT_PERIOD,((U=n.mainRiskData.riskInsureLimitVO)==null?void 0:U.paymentPeriodValueList)||[])}),y=w(()=>{var t,o,d,r,l;return((t=n.originData)==null?void 0:t.riskType)===1?D(Q,((o=n.originData.riskInsureLimitVO)==null?void 0:o.paymentFrequencyList)||[]):((d=n.originData.riskInsureLimitVO)==null?void 0:d.paymentTypeRule)===1?D(Q,((r=n.mainRiskData.riskInsureLimitVO)==null?void 0:r.paymentFrequencyList)||[]):D(Q,((l=n.mainRiskData.riskInsureLimitVO)==null?void 0:l.paymentFrequencyList)||[])}),p=w(()=>{var d,r;let t=0,o=0;return(((r=(d=n.originData)==null?void 0:d.riskCalcMethodInfoVO)==null?void 0:r.paymentMethodLimitList)||[]).forEach((l,m)=>{m===0&&(t=l.minAmount,o=l.maxAmount),t>l.minAmount&&(t=l.minAmount),o<l.maxAmount&&(o=l.maxAmount)}),i.formInfo.amount=i.formInfo.amount||t,{min:t,max:o||1/0}}),s=w(()=>{var d,r;let t=0,o=0;return(((r=(d=n.originData)==null?void 0:d.riskCalcMethodInfoVO)==null?void 0:r.paymentMethodLimitList)||[]).forEach((l,m)=>{m===0&&(t=l.minPremium,o=l.maxPremium),t>l.minPremium&&(t=l.minPremium),o<l.maxPremium&&(o=l.maxPremium)}),i.formInfo.premium=i.formInfo.premium||t,{min:t,max:o||1/0}}),I=w(()=>{var d,r,l,m;const t=((r=(d=n.originData)==null?void 0:d.riskCalcMethodInfoVO)==null?void 0:r.minCopy)||1,o=(m=(l=n.originData)==null?void 0:l.riskCalcMethodInfoVO)==null?void 0:m.maxCopy;return i.formInfo.copy=`${i.formInfo.copy||t||1}`,{min:t,max:o}}),c=(t,o,d)=>{var l,m;const r=((m=(l=n.originData)==null?void 0:l.riskCalcMethodInfoVO)==null?void 0:m.increaseDecreaseNum)||1;if(d==="sumInsured"){if(p.value.max&&+t>p.value.max)return`\u91D1\u989D\u6700\u5927${p.value.max}\u5143`;if(+t<p.value.min)return`\u91D1\u989D\u6700\u5C0F${p.value.min}\u5143`}else{if(s.value.max&&+t>s.value.max)return`\u91D1\u989D\u6700\u5927${s.value.max}\u5143`;if(+t<s.value.min)return`\u91D1\u989D\u6700\u5C0F${s.value.min}\u5143`}return+t%r===0?"":`\u91D1\u989D\u5FC5\u987B\u662F${r}\u7684\u500D\u6570`},a=t=>{var d;const o=(((d=i.formInfo)==null?void 0:d.liabilityVOList)||[]).find(r=>r.liabilityCode===t.liabilityCode);return o?o.liabilityAttributeValue?o.liabilityAttributeValue:t.optionalFlag!==1?"0":"-1":""};return Ue(()=>{var o,d;const t={riskType:n.originData.riskType,riskId:n.originData.id,riskName:n.originData.riskName,riskCode:n.originData.riskCode,mainRiskCode:n.originData.riskType!==1?(o=n.mainRiskData)==null?void 0:o.riskCode:void 0,mainRiskId:n.originData.riskType!==1?(d=n.mainRiskData)==null?void 0:d.id:void 0,exemptFlag:n.originData.exemptFlag,exemptType:n.originData.exemptType,riskCategory:n.originData.riskCategory,liabilityVOList:(n.originData.riskLiabilityInfoVOList||[]).map(r=>({...r,liabilityAttributeCode:r.liabilityAttributeType,liabilityCode:r.liabilityCode,liabilityRateType:r.liabilityRateType,liabilityAttributeValue:a(r)}))};Object.assign(i.formInfo,t)}),M(()=>{var t;return(t=i.formInfo)==null?void 0:t.paymentFrequency},(t=0)=>{var o,d,r;[3].includes(((o=n.originData.riskCalcMethodInfoVO)==null?void 0:o.saleMethod)||0)&&(((r=(d=n.originData)==null?void 0:d.riskCalcMethodInfoVO)==null?void 0:r.paymentMethodLimitList)||[]).forEach(l=>{+l.paymentFrequency==+t&&Object.assign(i.formInfo,{amount:l.perCopyAmount,premium:l.perCopyPremium})}),+t==1&&i.formInfo.chargePeriod!=="single"&&(i.formInfo.chargePeriod="single")}),M(()=>{var t;return(t=i.formInfo)==null?void 0:t.copy},t=>{var o,d;((o=n.originData.riskCalcMethodInfoVO)==null?void 0:o.saleMethod)===4&&(i.formInfo.amount=(d=n.originData.riskCalcMethodInfoVO)==null?void 0:d.fixedAmount)}),M(()=>{var t;return(t=i.formInfo)==null?void 0:t.chargePeriod},t=>{t==="single"&&+(i.formInfo.paymentFrequency||0)!=1&&(i.formInfo.paymentFrequency=1)}),M(()=>i.formInfo,()=>{console.log("state.formInfo",i.formInfo)},{deep:!0,immediate:!0}),M(()=>n==null?void 0:n.mainRiskInfo,t=>{var o,d,r,l,m,O;t&&n.originData.riskType===2&&(((d=(o=n.originData)==null?void 0:o.riskInsureLimitVO)==null?void 0:d.insurancePeriodRule)===1&&(t.coveragePeriod?b.value.coveragePeriod.disabled=!0:b.value.coveragePeriod.prevent=!0,i.formInfo.coveragePeriod=t.coveragePeriod||""),((l=(r=n.originData)==null?void 0:r.riskInsureLimitVO)==null?void 0:l.paymentPeriodRule)===1&&(t.chargePeriod?b.value.chargePeriod.disabled=!0:b.value.chargePeriod.prevent=!0,i.formInfo.chargePeriod=t.chargePeriod||""),((O=(m=n.originData)==null?void 0:m.riskInsureLimitVO)==null?void 0:O.paymentTypeRule)===1&&(t.paymentFrequency?b.value.paymentFrequency.disabled=!0:b.value.paymentFrequency.prevent=!0,i.formInfo.paymentFrequency=t.paymentFrequency||0))},{immediate:!0,deep:!0}),(t,o)=>{var z,J,X,Z,ee,ie,te,oe,ae,ne,re,ue,le,se,de,me,fe,ce,pe,ye,ge,Ie,Ve,De,ke,Le,be,ve,Fe,Ce;const d=P("ProSvg"),r=P("ProTitle"),l=P("VanStepper"),m=P("VanField"),O=P("ProRadioButton"),U=P("ProField"),Pe=P("ProExpand");return g(),_("div",ri,[C(r,{"risk-type":u.originData.riskType,title:u.originData.riskName},{default:F(()=>[u.removeRiskList.includes(u.originData.id)?(g(),_("div",{key:0,class:"delete-risk",onClick:o[0]||(o[0]=f=>u.removeRisk(u.originData.id))},[C(d,{name:"img-lajitong",color:"#0d6efe"})])):E("",!0)]),_:1},8,["risk-type","title"]),((z=u.originData.riskCalcMethodInfoVO)==null?void 0:z.saleMethod)===1&&u.originData.exemptFlag===2?(g(),R(m,{key:0,modelValue:e(i).formInfo.amount,"onUpdate:modelValue":o[2]||(o[2]=f=>e(i).formInfo.amount=f),label:"\u4FDD\u989D",name:"amount",rules:[{required:!0,message:"\u8BF7\u586B\u5199"},{trigger:"onChange",validator:(...f)=>c(...f,"sumInsured")}]},{input:F(()=>{var f,L;return[v("div",ui,[C(l,{modelValue:e(i).formInfo.amount,"onUpdate:modelValue":o[1]||(o[1]=T=>e(i).formInfo.amount=T),"input-width":"64px",min:e(p).min,step:((f=u.originData.riskCalcMethodInfoVO)==null?void 0:f.increaseDecreaseNum)||1,max:e(p).max},null,8,["modelValue","min","step","max"]),v("span",li,q(`\u91D1\u989D\u6700\u4F4E${e(p).min}\u5143\uFF0C\u4E3A${((L=u.originData.riskCalcMethodInfoVO)==null?void 0:L.increaseDecreaseNum)||1}\u7684\u500D\u6570`),1)])]}),_:1},8,["modelValue","rules"])):E("",!0),((X=(J=u.originData)==null?void 0:J.riskCalcMethodInfoVO)==null?void 0:X.saleMethod)===2?(g(),R(m,{key:1,modelValue:e(i).formInfo.premium,"onUpdate:modelValue":o[4]||(o[4]=f=>e(i).formInfo.premium=f),label:"\u4FDD\u8D39",name:"premium",rules:[{required:!0,message:"\u8BF7\u586B\u5199"},{trigger:"onChange",validator:(...f)=>c(...f,"premium")}]},{input:F(()=>{var f,L,T,B;return[v("div",si,[C(l,{modelValue:e(i).formInfo.premium,"onUpdate:modelValue":o[3]||(o[3]=$=>e(i).formInfo.premium=$),step:((L=(f=u.originData)==null?void 0:f.riskCalcMethodInfoVO)==null?void 0:L.increaseDecreaseNum)||1,min:e(s).min,"input-width":"64px",max:e(s).max},null,8,["modelValue","step","min","max"]),v("span",di,q(`\u91D1\u989D\u6700\u4F4E${e(s).min}\u5143\uFF0C\u4E3A${((B=(T=u.originData)==null?void 0:T.riskCalcMethodInfoVO)==null?void 0:B.increaseDecreaseNum)||1}\u7684\u500D\u6570`),1)])]}),_:1},8,["modelValue","rules"])):E("",!0),((ee=(Z=u.originData)==null?void 0:Z.riskCalcMethodInfoVO)==null?void 0:ee.saleMethod)===3||((te=(ie=u.originData)==null?void 0:ie.riskCalcMethodInfoVO)==null?void 0:te.saleMethod)===4&&(((ae=(oe=u.originData)==null?void 0:oe.riskCalcMethodInfoVO)==null?void 0:ae.minCopy)||((re=(ne=u.originData)==null?void 0:ne.riskCalcMethodInfoVO)==null?void 0:re.maxCopy))?(g(),R(m,{key:2,modelValue:e(i).formInfo.copy,"onUpdate:modelValue":o[6]||(o[6]=f=>e(i).formInfo.copy=f),label:"\u6295\u4FDD\u4EFD\u6570",name:"copy",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:F(()=>[v("div",mi,[C(l,{modelValue:e(i).formInfo.copy,"onUpdate:modelValue":o[5]||(o[5]=f=>e(i).formInfo.copy=f),step:1,min:e(I).min,max:e(I).max},null,8,["modelValue","min","max"]),v("span",fi,q(`${e(I).min}\u4EFD\u8D77\u8D2D\uFF0C\u6700\u591A\u8D2D\u4E70${e(I).max}\u4EFD`),1)])]),_:1},8,["modelValue"])):E("",!0),(![1].includes(((ue=u.originData.riskCalcMethodInfoVO)==null?void 0:ue.saleMethod)||0)||((le=u.originData)==null?void 0:le.exemptFlag)===1)&&(u.originData.riskCalcMethodInfoVO.fixedAmount||((de=e(x))==null?void 0:de[(se=u.originData)==null?void 0:se.riskCode]))?(g(),R(m,{key:3,label:"\u4FDD\u989D"},{input:F(()=>{var f,L,T,B;return[v("div",null,q(((f=u.originData.riskCalcMethodInfoVO)==null?void 0:f.fixedAmount)||((B=(T=e(x))==null?void 0:T[(L=u.originData)==null?void 0:L.riskCode])==null?void 0:B.amount)),1)]}),_:1})):E("",!0),!V((fe=(me=u.originData)==null?void 0:me.riskInsureLimitVO)==null?void 0:fe.insurancePeriodValueList)||!V((pe=(ce=u.originData)==null?void 0:ce.riskInsureLimitVO)==null?void 0:pe.insurancePeriodRule)?(g(),R(U,{key:4,modelValue:e(i).formInfo.coveragePeriod,"onUpdate:modelValue":o[8]||(o[8]=f=>e(i).formInfo.coveragePeriod=f),label:"\u4FDD\u969C\u671F\u95F4",name:"coveragePeriod",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4FDD\u969C\u671F\u95F4"}]},{input:F(()=>[v("div",ci,[C(O,{modelValue:e(i).formInfo.coveragePeriod,"onUpdate:modelValue":o[7]||(o[7]=f=>e(i).formInfo.coveragePeriod=f),disabled:b.value.coveragePeriod.disabled,prevent:b.value.coveragePeriod.prevent?"\u8BF7\u5148\u9009\u62E9\u4E3B\u9669\u4FDD\u969C\u671F\u95F4":"",options:e(k),prop:{label:"name",value:"value"}},null,8,["modelValue","disabled","prevent","options"])])]),_:1},8,["modelValue"])):E("",!0),!V((ge=(ye=u.originData)==null?void 0:ye.riskInsureLimitVO)==null?void 0:ge.paymentPeriodValueList)||!V((Ve=(Ie=u.originData)==null?void 0:Ie.riskInsureLimitVO)==null?void 0:Ve.paymentPeriodRule)?(g(),R(U,{key:5,modelValue:e(i).formInfo.chargePeriod,"onUpdate:modelValue":o[10]||(o[10]=f=>e(i).formInfo.chargePeriod=f),label:"\u4EA4\u8D39\u671F\u95F4",name:"chargePeriod",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4EA4\u8D39\u671F\u95F4"}]},{input:F(()=>[v("div",pi,[C(O,{modelValue:e(i).formInfo.chargePeriod,"onUpdate:modelValue":o[9]||(o[9]=f=>e(i).formInfo.chargePeriod=f),disabled:b.value.chargePeriod.disabled,prevent:b.value.chargePeriod.prevent?"\u8BF7\u5148\u9009\u62E9\u4E3B\u9669\u4EA4\u8D39\u671F\u95F4":"",options:e(A),prop:{label:"name",value:"value"}},null,8,["modelValue","disabled","prevent","options"])])]),_:1},8,["modelValue"])):E("",!0),!V((De=u.originData.riskInsureLimitVO)==null?void 0:De.paymentFrequencyList)||!V((ke=u.originData.riskInsureLimitVO)==null?void 0:ke.paymentPeriodRule)?(g(),R(U,{key:6,modelValue:e(i).formInfo.paymentFrequency,"onUpdate:modelValue":o[12]||(o[12]=f=>e(i).formInfo.paymentFrequency=f),label:"\u4EA4\u8D39\u65B9\u5F0F",name:"paymentFrequency",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u4EA4\u8D39\u65B9\u5F0F"}]},{input:F(()=>[v("div",yi,[C(O,{modelValue:e(i).formInfo.paymentFrequency,"onUpdate:modelValue":o[11]||(o[11]=f=>e(i).formInfo.paymentFrequency=f),disabled:b.value.paymentFrequency.disabled,prevent:b.value.paymentFrequency.prevent?"\u8BF7\u5148\u9009\u62E9\u4E3B\u9669\u4EA4\u8D39\u65B9\u5F0F":"",options:e(y)},null,8,["modelValue","disabled","prevent","options"])])]),_:1},8,["modelValue"])):E("",!0),V((be=(Le=u.originData)==null?void 0:Le.riskInsureLimitVO)==null?void 0:be.annuityDrawValueList)?E("",!0):(g(),R(U,{key:7,modelValue:e(i).formInfo.annuityDrawDate,"onUpdate:modelValue":o[14]||(o[14]=f=>e(i).formInfo.annuityDrawDate=f),label:"\u9886\u53D6\u65F6\u95F4",name:"annuityDrawDate"},{input:F(()=>{var f;return[v("div",gi,[C(O,{modelValue:e(i).formInfo.annuityDrawDate,"onUpdate:modelValue":o[13]||(o[13]=L=>e(i).formInfo.annuityDrawDate=L),options:D(e(we),((f=u.originData.riskInsureLimitVO)==null?void 0:f.annuityDrawValueList)||[])},null,8,["modelValue","options"])])]}),_:1},8,["modelValue"])),V((Fe=(ve=u.originData)==null?void 0:ve.riskInsureLimitVO)==null?void 0:Fe.annuityDrawFrequencyList)?E("",!0):(g(),R(U,{key:8,modelValue:e(i).formInfo.annuityDrawType,"onUpdate:modelValue":o[16]||(o[16]=f=>e(i).formInfo.annuityDrawType=f),label:"\u9886\u53D6\u65B9\u5F0F",name:"annuityDrawType"},{input:F(()=>{var f;return[v("div",Ii,[C(O,{modelValue:e(i).formInfo.annuityDrawType,"onUpdate:modelValue":o[15]||(o[15]=L=>e(i).formInfo.annuityDrawType=L),options:D(e(qe),((f=u.originData.riskInsureLimitVO)==null?void 0:f.annuityDrawFrequencyList)||[])},null,8,["modelValue","options"])])]}),_:1},8,["modelValue"])),(g(!0),_(S,null,W(u.originData.riskLiabilityInfoVOList||[],(f,L)=>(g(),_(S,{key:L},[f.optionalFlag===1&&!V(f.liabilityAttributeValueList)?(g(),R(m,{key:0,modelValue:e(i).formInfo.liabilityVOList[L].liabilityAttributeValue,"onUpdate:modelValue":T=>e(i).formInfo.liabilityVOList[L].liabilityAttributeValue=T,label:f.liabilityName,name:"liabilityAttributeValue",rules:[{required:f.liabilityAttributeValue,message:`\u8BF7\u9009\u62E9${f.liabilityName}`}]},{input:F(()=>{var T,B;return[v("div",null,[V(f.liabilityAttributeValueList)?(g(),_("span",Vi,"50\u4E07")):(g(),_("div",Di,[C(O,{modelValue:e(i).formInfo.liabilityVOList[L].liabilityAttributeValue,"onUpdate:modelValue":$=>e(i).formInfo.liabilityVOList[L].liabilityAttributeValue=$,options:D(e(he),(B=(T=u.originData.riskLiabilityInfoVOList)==null?void 0:T[L])==null?void 0:B.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"])]))])]}),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):E("",!0),f.optionalFlag!==1?(g(),R(m,{key:1,modelValue:e(i).formInfo.liabilityVOList[L].liabilityAttributeValue,"onUpdate:modelValue":T=>e(i).formInfo.liabilityVOList[L].liabilityAttributeValue=T,label:f.liabilityName,name:"liabilityAttributeValue"},{input:F(()=>{var T,B;return[v("div",null,[V(f.liabilityAttributeValueList)?(g(),R(O,{key:0,modelValue:e(i).formInfo.liabilityVOList[L].liabilityAttributeValue,"onUpdate:modelValue":$=>e(i).formInfo.liabilityVOList[L].liabilityAttributeValue=$,options:e(Ye)},null,8,["modelValue","onUpdate:modelValue","options"])):(g(),R(O,{key:1,modelValue:e(i).formInfo.liabilityVOList[L].liabilityAttributeValue,"onUpdate:modelValue":$=>e(i).formInfo.liabilityVOList[L].liabilityAttributeValue=$,options:D(e(he),(B=(T=u.originData.riskLiabilityInfoVOList)==null?void 0:T[L])==null?void 0:B.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]}),_:2},1032,["modelValue","onUpdate:modelValue","label"])):E("",!0)],64))),128)),(Ce=u.originData)!=null&&Ce.relationDesc?(g(),_("div",ki,[C(Pe,{title:"\u8D23\u4EFB\u6295\u4FDD\u8BF4\u660E"},{default:F(()=>[v("div",null,q(u.originData.relationDesc),1)]),_:1})])):E("",!0)])}}});var bi=H(Li,[["__scopeId","data-v-4a954db9"]]);const vi=u=>(Re("data-v-4b309d85"),u=u(),Oe(),u),Fi={class:"risk-list-wrapper"},Ci={key:0,class:"add-rider-risk"},hi={class:"left-part"},Ai=vi(()=>v("span",{class:"btn-plus"},"+",-1)),Ri=Ae(" \u9644\u52A0\u9669"),Oi=G({props:{riskInfo:{default:()=>({})},originData:{default:()=>[]},pickFactor:{type:Function,default:()=>{}},enums:{default:()=>{}}},setup(u){const n=u,h=j("source")||{},[x,b]=Ee(!1);N(null),N(null);const i=K({mainRiskInfo:n.riskInfo,riskInfo:n.riskInfo,requiredRiderRiskData:[],mainRiskData:{},riderRiskList:[],checkedList:[],relationListNum:0,disabledList:[],currentRiskList:[]}),V=(A,y)=>{i.currentRiskList=i.currentRiskList.concat(A),i.disabledList=y},D=A=>{Be.confirm({message:"\u786E\u5B9A\u8981\u5220\u9664\u9644\u52A0\u9669\u4E48\uFF1F",confirmButtonText:"\u5220\u9664"}).then(()=>{var p;const y=[A];(((p=i.mainRiskData)==null?void 0:p.collocationVOList)||[]).forEach(s=>{A===s.riskId&&(s.collocationType===2||s.collocationType===3)&&y.push(s.collocationRiskId)}),i.checkedList=i.checkedList.filter(s=>!y.includes(s)),i.currentRiskList=i.currentRiskList.filter(s=>y.includes(s.id)?(Object.assign(i.riskInfo,{[s.id]:void 0}),!1):!0),i.disabledList=i.disabledList.filter(s=>!y.includes(s))}).catch(()=>{})},k=(A,y)=>{var s,I;const p=(((I=(s=i.riskInfo)==null?void 0:s[y])==null?void 0:I.liabilityVOList)||[]).find(c=>c.liabilityCode===A.liabilityCode);return p?p.liabilityAttributeValue?p.liabilityAttributeValue:A.optionalFlag!==1?"0":"-1":""};return M(()=>i.currentRiskList,A=>{const y=[i.mainRiskData,...A];let p=[],s=[];const I=[];y.forEach((c,a)=>{var o,d,r;const t=((o=c==null?void 0:c.riskCalcMethodInfoVO)==null?void 0:o.riskFactorRelationList)||[];p=p.concat(t.filter(l=>l.factorObject==="insured").map(l=>l.factorCode)),s=s.concat(t.filter(l=>l.factorObject==="holder").map(l=>l.factorCode)),I.push((d=c==null?void 0:c.riskInsureLimitVO)==null?void 0:d.minHolderAge,(r=c==null?void 0:c.riskInsureLimitVO)==null?void 0:r.maxHolderAge)}),(A||[]).forEach(c=>{var t,o;const a={riskType:c.riskType,riskId:c.id,riskCode:c.riskCode,riskName:c.riskName,mainRiskCode:c.riskType!==1?(t=i.mainRiskData)==null?void 0:t.riskCode:void 0,mainRiskId:c.riskType!==1?(o=i.mainRiskData)==null?void 0:o.id:void 0,riskCategory:c.riskCategory,exemptFlag:n.originData.exemptFlag,exemptType:n.originData.exemptType,liabilityVOList:(c.riskLiabilityInfoVOList||[]).map(d=>({...d,liabilityAttributeCode:d.liabilityAttributeType,liabilityCode:d.liabilityCode,liabilityRateType:d.liabilityRateType,liabilityAttributeValue:k(d,c.id)}))};i.riskInfo[c.id]||Object.assign(i.riskInfo,{[c.id]:a})}),n.pickFactor({insuredFactorList:[...new Set(p)],holderFactorList:[...new Set(s)],ageRange:I})},{deep:!0,immediate:!0}),M(()=>n.riskInfo,A=>{i.mainRiskInfo=Object.values(A||{}).find(y=>(y==null?void 0:y.riskType)===1)||{}},{deep:!0,immediate:!0}),M(()=>n.originData,A=>{let y=[];const p=[];h.origin==="proposal"&&!(h.type==="add"||h.type==="repeatAdd")?((A||[]).forEach(s=>{s.riskType===1&&(i.mainRiskData=s),y.push(s)}),y=y.filter(s=>h.showRiskList.includes(s.id))):(A||[]).forEach(s=>{s.riskType===1?(i.mainRiskData=s,y.push(s)):s.collocationType===2?y.push(s):p.push(s)}),i.riderRiskList=p,i.currentRiskList=y},{deep:!0,immediate:!0}),(A,y)=>{var s,I,c;const p=P("ProCheckButton");return g(),_("div",Fi,[(g(!0),_(S,null,W(e(i).currentRiskList,(a,t)=>(g(),R(bi,{key:a.id,"form-info":e(i).riskInfo[a.id],index:t,enums:u.enums,"main-risk-data":e(i).mainRiskData,"main-risk-info":e(i).mainRiskInfo,"origin-data":a,"remove-risk":D,"remove-risk-list":e(i).checkedList},null,8,["form-info","index","enums","main-risk-data","main-risk-info","origin-data","remove-risk-list"]))),128)),((s=e(i).riderRiskList)==null?void 0:s.length)-((I=e(i).checkedList)==null?void 0:I.length)&&e(h).origin!=="proposal"?(g(),_("div",Ci,[v("span",hi,q(`\u5171\u6709${e(i).riderRiskList.length-e(i).checkedList.length}\u6B3E\u9644\u52A0\u9669\u53EF\u4EE5\u6DFB\u52A0`),1),C(p,{activated:"",class:"btn-rider-risk",onClick:y[0]||(y[0]=a=>e(b)(!0))},{default:F(()=>[Ai,Ri]),_:1})])):E("",!0),e(x)?(g(),R(ii,{key:1,modelValue:e(i).checkedList,"onUpdate:modelValue":y[1]||(y[1]=a=>e(i).checkedList=a),show:e(x),disabled:e(i).disabledList,"risk-list":e(i).riderRiskList,"collocation-list":((c=e(i).mainRiskData)==null?void 0:c.collocationVOList)||[],onFinished:V,onClose:y[2]||(y[2]=a=>e(b)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):E("",!0)])}}});var Ui=H(Oi,[["__scopeId","data-v-4b309d85"]]);export{_i as P,ii as R,Ui as a};
