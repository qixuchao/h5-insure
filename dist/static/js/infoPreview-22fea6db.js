import{_ as e,d as a,aV as t,aW as o,i as s,h as n,y as i,r as l,j as r,ce as d,E as c,T as u,bc as m,l as p,o as f,c as y,b as v,u as b,p as h,q as I,f as j,a as w,w as V,F as x,s as g,aY as k,b0 as q,a8 as T,d5 as _,b1 as L,g as S,v as C,b4 as P,bk as N,bj as E,bb as O,bO as U,a$ as R,bR as D,ar as Q,b2 as F,d6 as A,bo as $,bp as B,c8 as M}from"./index-77635e62.js";import{P as z,a as Y}from"./PolicyInfo-f1d4c955.js";import{g as J,m as W}from"./trial-5feeae43.js";import{n as G}from"./nextStep-c1e85e24.js";import{b as X,l as H}from"./product-16d84463.js";import{u as K}from"./useOrder-60b82cc5.js";import{P as Z}from"./index-4338da5f.js";import{P as ee}from"./index-c4ffa17f.js";import{_ as ae}from"./InsureInfo-ce4b7be7.js";import{p as te,d as oe}from"./utils-0e649b81.js";import{I as se}from"./insuranceNotificationInformation-4839b31a.js";import{Q as ne}from"./notice-cd025dbe.js";import{P as ie,g as le}from"./utils-58e6060b.js";import{Q as re}from"./questionnaire-42dcb602.js";import de from"./index-130419eb.js";import{p as ce}from"./policy-e45b602a.js";import"./cloneDeep-2b4ffd3a.js";import"./core-b31883b1.js";import"./utils-b4ad0790.js";import"./createProposal-d9962e78.js";import"./trial-24b05458.js";import"./infoCollection-74be3c70.js";import"./util-4b5aa255.js";import"./format-31cde443.js";import"./index-3d26599c.js";import"./index-42b496dd.js";const ue=e=>($("data-v-d017b8f8"),e=e(),B(),e),me={class:"long-info-preview"},pe={class:"insurance-notification-information card"},fe=ue((()=>w("span",null,"，并通过上述内容和销售人员的说明理解保险条款及退保损失、保险单现金价值、理赔要求、保险责任是否有等待期、免赔额、犹豫期等关键信息，本人同意遵守。",-1))),ye=ue((()=>w("br",null,null,-1))),ve=ue((()=>w("span",{class:"extra-text"},[C("本人已认真阅读并知晓"),w("span",{style:{color:"var(--van-primary-color)"}},"《隐私政策》"),C("，并同意授权。")],-1))),be={class:"footer-btn"},he=ue((()=>w("span",null,"分享",-1)));var Ie=e(a({__name:"infoPreview",setup(e){const a=t((()=>o((()=>import("./index-f420f23a.js")),["static/js/index-f420f23a.js","static/css/index-fa4edf2a.css","static/js/index-77635e62.js","static/css/index-3b6067d0.css","static/js/theme-94cf7d00.js","static/js/index-c4ffa17f.js","static/css/index-bbfdd7ec.css","static/js/utils-58e6060b.js","static/js/infoCollection-74be3c70.js","static/js/trial-24b05458.js"]))),$=s(),B=n(),ue=K(),Ie={holder:i.holderSign,insured:i.insuredSign,agent:i.agentSign},{productCode:je="",tenantId:we,agentCode:Ve="",agencyCode:xe,saleChannelId:ge,isShare:ke,orderNo:qe,extraInfo:Te,insurerCode:_e,objectType:Le="1",preview:Se}=$.query;let Ce={};try{Ce=JSON.parse(decodeURIComponent(Te))}catch(oa){}const Pe=l({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),Ne=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`,Ee=r({imgUrl:"",desc:"",title:"",link:Ne}),Oe=r(),Ue=r(),Re=r(!1),De=r(!1),Qe=r(0),Fe=r(!1),Ae=r(!1),$e=r(!1),[Be,Me]=d(!1),ze=r([]),Ye=()=>{Ae.value=!0},Je=e=>{ze.value.forEach(((a,t)=>{e===t&&(a.readStatus=k.YES)}))},We=()=>{De.value=!1},Ge=({file:e,type:a},t)=>{P.set(ie,{fileUri:e,fileType:a}),B.push({path:"/template/filePreview",query:{fileId:e.id}}),t()},Xe=r(),He=()=>{G(ue.value,((e,a)=>{a===N.JUMP_PAGE&&Xe.value.handleShare()}))},Ke=async()=>{Se?E(O.INFO_PREVIEW,$.query):Re.value?Ae.value?$e.value?B.push({path:Ie[Le],query:$.query}):u("请您确认已阅读并同意以上内容"):u("请您完成文档阅读"):u("请您确认已如实履行健康告知义务")};c((()=>$e.value),(()=>{$e.value&&(Ae.value||u("请您确认已阅读并同意以上内容"))}),{immediate:!0,deep:!0});const Ze=r(),ea=r(),aa=async()=>{let e={};const{code:a,data:t}=await J({orderNo:qe,tenantId:we});"10000"===a&&(Object.assign(ue.value,t),e=te(t.insuredList[0].productList),Ze.value=t,Fe.value=!0),(async e=>{let a=[];const{code:t,data:o}=await M({orderNo:qe,tenantId:we});"10000"===t&&(a=o.productQuestionnaireVOList);const{code:s,data:n}=await H(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},t=e.filter((e=>e.businessType!==ne.VISIT));Pe.customerQuestions=t.map((e=>{const{questionnaireDetailResponseVO:t,questionnaireId:o,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=t||{},{objectType:l,questionnaireType:r}=i||{};if(r===re.TEXT){const{content:a,textType:t}=(null==n?void 0:n[0])||{};return{content:a,contentType:le(`${t}`,a),questionnaireId:o,questionnaireName:s,objectType:e.objectType}}const d=(a||[]).find((e=>e.questionnaireId===o));return{...t,contentType:"question",...null==d?void 0:d.questionnaireDetailResponseVO,questionnaireId:o,objectType:e.objectType,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),X(e).then((({code:e,data:a})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:t}=oe(a),o={attachmentList:[{materialContent:ce,materialName:"隐私政策",materialSource:"pdf"}],attachmentName:"隐私政策"};ze.value=e.concat(t).concat([o]),Pe.fileList=ze.value.map((e=>({tabName:e.attachmentName,isExpand:!0,readStatus:2,files:e.attachmentList.map((e=>({name:e.materialName,file:e.materialContent,type:e.materialSource,mustRead:!0})))})))}})),W(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:t}=e;ea.value=t;const{payInfo:o,other:s}=U(t);Pe.payInfo={...Pe.payInfo,...o},Pe.policyInfo={...Pe.policyInfo,...s}}}))};m((()=>{aa()}));const ta=r();return p((()=>{setTimeout((async()=>{ta.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{var o,s,n,i;const l=R,r=D,d=Q,c=F,u=A;return f(),y("div",me,[v(l),v(ae,{"product-data":null==(s=null==(o=b(ue).insuredList)?void 0:o[0])?void 0:s.productList},null,8,["product-data"]),(null==(n=Object.keys(b(ea)||{}))?void 0:n.length)?(f(),h(Z,{key:0,ref_key:"personalInfoRef",ref:Ue,modelValue:b(Ze),"onUpdate:modelValue":t[0]||(t[0]=e=>I(Ze)?Ze.value=e:null),"product-factor":b(ea),"is-view":""},null,8,["modelValue","product-factor"])):j("",!0),b(Pe).payInfo.schema.length?(f(),h(b(z),{key:1,ref_key:"payInfoRef",ref:Oe,modelValue:b(ue).tenantOrderPayInfoList,"onUpdate:modelValue":t[1]||(t[1]=e=>b(ue).tenantOrderPayInfoList=e),schema:b(Pe).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):j("",!0),b(Pe).policyInfo.schema.length?(f(),h(b(Y),{key:2,modelValue:b(ue).extInfo,"onUpdate:modelValue":t[2]||(t[2]=e=>b(ue).extInfo=e),schema:b(Pe).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):j("",!0),w("div",pe,[v(se,{modelValue:b(Re),"onUpdate:modelValue":t[3]||(t[3]=e=>I(Re)?Re.value=e:null),title:"投保告知信息",data:b(Pe).customerQuestions||[],"display-status":""},null,8,["modelValue","data"])]),v(d,{title:"授权与须知","show-line":!1,"show-icon":!1,class:"material-read-card"},{default:V((()=>[(f(!0),y(x,null,g(b(ze),((e,a)=>(f(),h(r,{key:a,"is-link":"",value:e.readStatus===b(k).YES?"已读":"未读",title:e.attachmentName,onClick:e=>(e=>{Qe.value=e,Me(!0)})(a)},null,8,["value","title","onClick"])))),128))])),_:1}),(null==(i=b(ze))?void 0:i.length)?(f(),h(de,{key:3,modelValue:b($e),"onUpdate:modelValue":t[4]||(t[4]=e=>I($e)?$e.value=e:null),"attachment-list":b(ze),"has-bg-color":!1,"is-show-radio":"","is-view":"","pre-text":"本人已认真阅读",onPreviewFile:t[5]||(t[5]=()=>De.value=!0)},{suffixText:V((()=>[fe,ye,ve])),_:1},8,["modelValue","attachment-list"])):j("",!0),w("div",be,[!b(ke)&&b(Ee).isShare&&b(q)()?(f(),h(L,T({key:0},b(Ee),{class:"share-btn",onClick:_(He,["stop"])}),{default:V((()=>[v(c,{name:"share-icon","font-size":"24px",color:"#AEAEAE"}),he])),_:1},16)):j("",!0),v(ee,{shadow:!1,onClick:Ke},{default:V((()=>[S(e.$slots,"default",{},(()=>[C("下一步")]),!0)])),_:3})]),b(De)?(f(),h(b(a),{key:4,show:b(De),"onUpdate:show":t[6]||(t[6]=e=>I(De)?De.value=e:null),"content-list":[b(ze)[b(Qe)]],"is-only-view":"","active-index":0,text:"我已阅读","force-read-cound":0,onOnCloseFilePreviewByMask:We},null,8,["show","content-list"])):j("",!0),b(Be)?(f(),h(u,{key:5,modelValue:b(Be),"onUpdate:modelValue":t[7]||(t[7]=e=>I(Be)?Be.value=e:null),closeable:!1,"active-index":b(Qe),"data-source":b(Pe).fileList,"ok-text":"我已阅读，已充分理解，并会遵守相关要求",onClickBtn:Ge,onSubmit:Ye,onUpdateFileStatus:Je},null,8,["modelValue","active-index","data-source"])):j("",!0)])}}}),[["__scopeId","data-v-d017b8f8"]]);export{Ie as default};
