import{l as e,R as a}from"./index-c3240e77.js";import{aA as l,d as u,r as i,K as o,aB as n,aC as t,Q as s,aD as r,i as d,ab as m,an as v,aw as p,aE as c,aF as y,aG as g,aH as V,aI as f,aJ as k,Z as b,aK as h,aL as D,aM as C,aN as x,aO as K,E as I,a0 as w,c as S,y as P,w as _,f as L,g as T,e as U,z as O,h as R,aP as M,ay as A,az as F,U as N,R as B,x as E,aQ as $}from"./index-3d1ea118.js";import{b as z}from"./infoCollection-74fdccb4.js";const[J,j]=l("stepper"),q=(e,a)=>String(e)===String(a);const Y=K(u({name:J,props:{min:y(1),max:y(1/0),name:y(""),step:y(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:g,showMinus:g,showInput:g,longPress:g,allowEmpty:Boolean,modelValue:V,inputWidth:V,buttonSize:V,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:y(1),decimalLength:V},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:a}){const l=a=>{const{min:l,max:u,allowEmpty:i,decimalLength:o}=e;return i&&""===a||(a=""===(a=f(String(a),!e.integer))?0:+a,a=Number.isNaN(a)?+l:a,a=Math.max(Math.min(+u,a),+l),k(o)&&(a=a.toFixed(+o))),a};let u;const y=i(),g=i((()=>{var u;const i=null!=(u=e.modelValue)?u:e.defaultValue,o=l(i);return q(o,e.modelValue)||a("update:modelValue",o),o})()),V=o((()=>e.disabled||e.disableMinus||g.value<=+e.min)),K=o((()=>e.disabled||e.disablePlus||g.value>=+e.max)),I=o((()=>({width:n(e.inputWidth),height:n(e.buttonSize)}))),w=o((()=>t(e.buttonSize))),S=a=>{e.beforeChange?C(e.beforeChange,{args:[a],done(){g.value=a}}):g.value=a},P=()=>{if("plus"===u&&K.value||"minus"===u&&V.value)return void a("overlimit",u);const i="minus"===u?-e.step:+e.step,o=l(x(+g.value,i));S(o),a(u)},_=a=>{const l=a.target,{value:u}=l,{decimalLength:i}=e;let o=f(String(u),!e.integer);if(k(i)&&o.includes(".")){const e=o.split(".");o=`${e[0]}.${e[1].slice(0,+i)}`}e.beforeChange?l.value=String(g.value):q(u,o)||(l.value=o);const n=o===String(+o);S(n?+o:o)},L=l=>{var u;e.disableInput?null==(u=y.value)||u.blur():a("focus",l)},T=e=>{const u=e.target,i=l(u.value);u.value=String(i),g.value=i,b((()=>{a("blur",e),h()}))};let U,O;const R=()=>{O=setTimeout((()=>{P(),R()}),200)},M=a=>{e.longPress&&(clearTimeout(O),U&&D(a))},A=a=>{e.disableInput&&D(a)},F=a=>({onClick:e=>{D(e),u=a,P()},onTouchstartPassive:()=>{u=a,e.longPress&&(U=!1,clearTimeout(O),O=setTimeout((()=>{U=!0,P(),R()}),600))},onTouchend:M,onTouchcancel:M});return s((()=>[e.max,e.min,e.integer,e.decimalLength]),(()=>{const e=l(g.value);q(e,g.value)||(g.value=e)})),s((()=>e.modelValue),(e=>{q(e,g.value)||(g.value=l(e))})),s(g,(l=>{a("update:modelValue",l),a("change",l,{name:e.name})})),r((()=>e.modelValue)),()=>d("div",{role:"group",class:j([e.theme])},[m(d("button",p({type:"button",style:w.value,class:[j("minus",{disabled:V.value}),{[c]:!V.value}],"aria-disabled":V.value||void 0},F("minus")),null),[[v,e.showMinus]]),m(d("input",{ref:y,type:e.integer?"tel":"text",role:"spinbutton",class:j("input"),value:g.value,style:I.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":g.value,onBlur:T,onInput:_,onFocus:L,onMousedown:A},null),[[v,e.showInput]]),m(d("button",p({type:"button",style:w.value,class:[j("plus",{disabled:K.value}),{[c]:!K.value}],"aria-disabled":K.value||void 0},F("plus")),null),[[v,e.showPlus]])])}})),H={key:0},Q={class:"custom-field"},W={key:1,class:"flex-field"},G={class:"pro-radio-wrap"},Z={key:2},X={class:"pro-radio-wrap"},ee={class:"custom-field"},ae={key:1},le={key:3},ue={class:"custom-field"},ie={key:1},oe={class:"custom-field"},ne={key:0},te={key:1};var se=I(u({__name:"index",props:{originData:{default:()=>({})},modelValue:{default:()=>({})},defalutValue:{default:()=>({})}},emits:["update:modelValue","trialChange"],setup(a,{emit:l}){const u=a,n=i(u.originData),t=i(u.modelValue),r=i(1),m=()=>2===n.value.saleMethod?{label:"保费",key:"premium"}:{label:"保额",key:"amount"},v=()=>{switch(`${n.value.displayUnit}`){case z.YUAN:return"元";case z.MONTH_SALARY:return"倍月薪";case z.MILLION:return"万元";case z.COPY:return"份"}return""},p=o((()=>2===n.value.saleMethod?{label:"保费",key:"premium"}:{label:"保额",key:"amount"})),c=(...e)=>{if(1===r.value){const e=t.value[p.value.key],a=u.originData.minStepValue,l=u.originData.maxStepValue,i=u.originData.stepValue;if(+e>=+l)t.value[p.value.key]=l;else if(+e<=+a)t.value[p.value.key]=a;else{const l=+e-+a,u=Math.floor(l/+i);l%+i!=0&&(t.value[p.value.key]=+a+u*+i)}}return!0},y=()=>{const{displayType:e,requireCopies:a}=n.value,l=m().key,u=!t.value.riskCode;1===e?r.value=1:3===e&&2===a?(r.value=2,n.value.displayValues.length>=1&&u&&!t.value[l]&&(t.value[l]=n.value.displayValues[0].code||n.value.displayValues[0].value)):3===e&&1===a?(r.value=3,n.value.minCopiesValue===n.value.maxCopiesValue&&u&&!t.value.copy&&(t.value.copy=n.value.minCopiesValue),n.value.displayValues.length>=1&&u&&!t.value[l]&&(t.value[l]=n.value.displayValues[0].code||n.value.displayValues[0].value)):2===e&&(r.value=4,n.value.minCopiesValue===n.value.maxCopiesValue&&u&&!t.value.copy&&(t.value.copy=n.value.minCopiesValue),u&&!t.value.amount&&(t.value.amount=n.value.copiesAmount))},g=o((()=>{if(n.value.displayValues){const e=m().key;return 1!==n.value.displayValues.length||t.value.riskCode||(t.value[e]=n.value.displayValues[0].code),n.value.displayValues.map((e=>({label:e.value,value:e.code})))}return[]})),V=()=>{};return w((()=>{y(),l("update:modelValue",t.value)})),s((()=>n),(e=>{y()}),{deep:!0}),s((()=>u.defalutValue),(a=>{(null==a?void 0:a.riskCode)&&(t.value=e.exports.cloneDeep(u.defalutValue))}),{deep:!0,immediate:!0}),s((()=>t.value),(e=>{(()=>{if(1===r.value){const e=t.value[p.value.key],a=u.originData.minStepValue,l=u.originData.maxStepValue,i=u.originData.stepValue;if(+e>+l)return!1;if(+e<+a)return!1;if((+e-+a)%+i!=0)return!1}return!0})()&&(l("update:modelValue",e),l("trialChange",e))}),{deep:!0,immediate:!0}),(e,l)=>{const u=Y,i=M,o=A,n=F;return 1===r.value?(S(),P("div",H,[d(i,{label:`基本${T(p).label}`,name:T(p).key,class:"risk-select-field"},{input:_((()=>[L("div",Q,[d(u,{modelValue:t.value[T(p).key],"onUpdate:modelValue":l[0]||(l[0]=e=>t.value[T(p).key]=e),"input-width":"80px","default-value":a.originData.minStepValue,min:a.originData.minStepValue,step:a.originData.stepValue,max:a.originData.maxStepValue,onBlur:c},null,8,["modelValue","default-value","min","step","max"])])])),_:1},8,["label","name"])])):2===r.value?(S(),P("div",W,[d(n,{modelValue:t.value[T(p).key],"onUpdate:modelValue":l[2]||(l[2]=e=>t.value[T(p).key]=e),label:`基本${T(p).label}`,name:T(p).key,class:"risk-select-field"},{input:_((()=>[L("div",G,[d(o,{modelValue:t.value[T(p).key],"onUpdate:modelValue":l[1]||(l[1]=e=>t.value[T(p).key]=e),options:T(g),onclick:V},null,8,["modelValue","options"])])])),_:1},8,["modelValue","label","name"])])):3===r.value?(S(),P("div",Z,[d(n,{modelValue:t.value[T(p).key],"onUpdate:modelValue":l[4]||(l[4]=e=>t.value[T(p).key]=e),label:`基本${T(p).label}`,name:T(p).key,class:"risk-select-field"},{input:_((()=>[L("div",X,[d(o,{modelValue:t.value[T(p).key],"onUpdate:modelValue":l[3]||(l[3]=e=>t.value[T(p).key]=e),options:T(g),onclick:V},null,8,["modelValue","options"])])])),_:1},8,["modelValue","label","name"]),L("div",null,[d(i,{modelValue:t.value.copy,"onUpdate:modelValue":l[6]||(l[6]=e=>t.value.copy=e),label:"份数",name:"copy",class:"risk-select-field"},{input:_((()=>[L("div",ee,[a.originData.minCopiesValue!==a.originData.maxCopiesValue?(S(),U(u,{key:0,modelValue:t.value.copy,"onUpdate:modelValue":l[5]||(l[5]=e=>t.value.copy=e),"input-width":"80px","default-value":a.originData.minCopiesValue,min:a.originData.minCopiesValue||1,step:1,max:a.originData.maxCopiesValue},null,8,["modelValue","default-value","min","max"])):(S(),P("span",ae,O(a.originData.minCopiesValue),1))])])),_:1},8,["modelValue"])])])):4===r.value?(S(),P("div",le,[d(i,{modelValue:t.value.copy,"onUpdate:modelValue":l[8]||(l[8]=e=>t.value.copy=e),label:"份数",name:"copy",class:"risk-select-field"},{input:_((()=>[L("div",ue,[a.originData.minCopiesValue!==a.originData.maxCopiesValue?(S(),U(u,{key:0,modelValue:t.value.copy,"onUpdate:modelValue":l[7]||(l[7]=e=>t.value.copy=e),"input-width":"64px","default-value":a.originData.minCopiesValue,min:a.originData.minCopiesValue||1,step:1,max:a.originData.maxCopiesValue},null,8,["modelValue","default-value","min","max"])):(S(),P("span",ie,O(a.originData.minCopiesValue),1))])])),_:1},8,["modelValue"]),d(i,{label:T(p).label,name:"copyAmount",class:"risk-select-field"},{input:_((()=>[L("div",oe,[a.originData.minCopiesValue!==a.originData.maxCopiesValue?(S(),P("span",ne,O(+a.originData.copiesAmount*+t.value.copy+v()),1)):(S(),P("span",te,O(+a.originData.minCopiesValue*+a.originData.copiesAmount+v()),1))])])),_:1},8,["label"])])):R("",!0)}}}),[["__scopeId","data-v-ef6d4920"]]);const re=[{name:"年金领取期间",type:"checkbox",configKey:["annuityDrawValueList"],valueKey:"annuityDrawDate"},{name:"领取频率",type:"checkbox",configKey:["annuityDrawFrequencyList"],valueKey:"annuityDrawType"},{name:"交费方式",type:"checkbox",configKey:["paymentFrequencyList"],valueKey:"paymentFrequency",ruleKey:"paymentTypeRule"},{name:"交费期间",type:"checkbox",configKey:["paymentPeriodValueList"],valueKey:"chargePeriod",ruleKey:"paymentPeriodRule"},{name:"保障期间",type:"checkbox",configKey:["insurancePeriodValueList"],valueKey:"coveragePeriod",ruleKey:"insurancePeriodRule"}],de={class:"pro-radio-wrap"};var me=I(u({__name:"index",props:{originData:{default:()=>({})},modelValue:{default:()=>({})},riskInfo:{default:()=>({})},defaultValue:{default:()=>({})}},emits:["trialChange","inputChange"],setup(a,{emit:l}){const u=a,o=i(u.originData),n=i(u.modelValue);i(1);const t=a=>{const l=e.exports.get(u.originData,a),i=e.exports.get(u.originData,a);return l.map((e=>{const a=i?i.find((a=>a.code===e.code)):null;return{label:e.value,value:e.code,disabled:!(!a||null===a.useFlag||void 0===a.useFlag)&&1!==a.useFlag}}))},r=()=>{re.forEach((a=>{const l=e.exports.get(u.originData,a.configKey);"checkbox"===a.type&&l&&l.length>0&&!n.value.riskCode&&(n.value[a.valueKey]=l[0].code)}))};return w((()=>{r()})),s((()=>u.defaultValue),(e=>{(null==e?void 0:e.riskCode)&&(n.value=e)}),{deep:!0,immediate:!0}),s((()=>o.value),(e=>{r()}),{deep:!0,immediate:!0}),s((()=>JSON.stringify(n.value)),((e,a)=>{const i=e&&JSON.parse(e)||{},o=a&&JSON.parse(a)||{};let n=null;re.forEach((e=>{i[e.valueKey]&&o[e.valueKey]&&i[e.valueKey]!==o[e.valueKey]&&(n||(n={key:e.valueKey,oldValue:o[e.valueKey],newValue:i[e.valueKey],riskCode:u.riskInfo.riskCode}))})),e&&l("trialChange",JSON.parse(e),n)}),{deep:!0,immediate:!0}),(l,u)=>{const i=A,o=F;return S(!0),P(B,null,N(T(re),(l=>(S(),P(B,null,[T(e.exports.get)(a.originData,l.configKey)&&(1===a.riskInfo.mainRiskFlag||l.ruleKey&&2===T(e.exports.get)(a.originData,l.ruleKey)||!l.ruleKey)?(S(),P("div",{key:a.riskInfo.riskCode+"_"+l.name},["checkbox"===l.type?(S(),U(o,{key:0,modelValue:n.value[l.valueKey],"onUpdate:modelValue":e=>n.value[l.valueKey]=e,label:l.name,name:l.valueKey,class:"risk-select-field"},{input:_((()=>[L("div",de,[d(i,{modelValue:n.value[l.valueKey],"onUpdate:modelValue":[e=>n.value[l.valueKey]=e,e=>((e,a)=>{console.log("-------change",e,a)})(e,l.valueKey)],options:t(l.configKey)},null,8,["modelValue","onUpdate:modelValue","options"])])])),_:2},1032,["modelValue","onUpdate:modelValue","label","name"])):R("",!0)])):R("",!0)],64)))),256)}}}),[["__scopeId","data-v-18462dcc"]]);function ve(e){return Object.keys(e)}var pe=I(u({__name:"index",props:{originData:{default:()=>({})},modelValue:{default:()=>({})},defaultValue:{default:()=>({})}},emits:["trialChange"],setup(l,{expose:u,emit:o}){const n=l,t=E({personalInfo:{},basicsAmount:"",basicsPremium:"",defaultValues:n.defaultValue,changeData:null}),r=i(null),m=i({}),v=i({});$("premium"),v.value=$("enumList")||{},console.log("-------origin data",n.originData),w((()=>{}));const p=e.exports.debounce((e=>{n.originData.mainRiskFlag,m.value.riskCategory=n.originData.riskCategory,m.value.riskCode=n.originData.riskCode,m.value.riskId=n.originData.riskId,m.value.riskType=n.originData.riskType,m.value.riskName=n.originData.riskName,m.value.riskType=n.originData.riskType,m.value.mainRiskCode=n.originData.mainRiskCode,m.value.mainRiskId=n.originData.mainRiskId,e?o("trialChange",m.value,e):o("trialChange",m.value)}),300),c=(e,a)=>{ve(e).forEach((a=>{m.value[a]=e[a]})),p(a)},y=e=>{var a,l;1==+(null==(l=null==(a=n.originData)?void 0:a.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO.saleMethod)?t.basicsAmount=null==e?void 0:e.amount:t.basicsAmount=null==e?void 0:e.premium,ve(e).forEach((a=>{m.value[a]=e[a]})),p()},g=e=>{m.value.liabilityVOList=e,p()};return s((()=>n.defaultValue),(e=>{e&&e&&(t.defaultValues=e)}),{deep:!0,immediate:!0}),u({validate:async()=>{var e;await(null==(e=r.value)?void 0:e.validate())}}),(e,u)=>{var i,o,n,s,r,v;return 1===(null==(i=l.originData)?void 0:i.factorDisPlayFlag)?(S(),P(B,{key:0},[d(T(se),{"v-model":T(m),"origin-data":null==(n=null==(o=l.originData)?void 0:o.productRiskInsureLimitVO)?void 0:n.amountPremiumConfigVO,"defalut-value":T(t).defaultValues,onTrialChange:y},null,8,["v-model","origin-data","defalut-value"]),d(T(me),{"v-model":T(m),"origin-data":l.originData.productRiskInsureLimitVO,"risk-info":l.originData,"default-value":T(t).defaultValues,onTrialChange:c},null,8,["v-model","origin-data","risk-info","default-value"]),d(T(a),{"data-source-folmulate":T(m),"data-source":l.originData,params:{amountUnit:null==(r=null==(s=l.originData)?void 0:s.productRiskInsureLimitVO)?void 0:r.amountPremiumConfigVO.displayUnit,basicsAmount:T(t).basicsAmount,basicsPremium:T(t).basicsPremium,riskId:null==(v=l.originData)?void 0:v.riskId},onTrialChange:g},null,8,["data-source-folmulate","data-source","params"])],64)):R("",!0)}}}),[["__scopeId","data-v-245f364e"]]);export{pe as I,re as P,Y as S};
