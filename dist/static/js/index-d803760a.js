var te=Object.defineProperty,ue=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var J=(s,o,t)=>o in s?te(s,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[o]=t,M=(s,o)=>{for(var t in o||(o={}))ae.call(o,t)&&J(s,t,o[t]);if(G)for(var t of G(o))se.call(o,t)&&J(s,t,o[t]);return s},U=(s,o)=>ue(s,oe(o));import{h as T,G as m,N as R,$ as ne,r as h,k as F,m as N,n as A,s as C,B as a,A as u,L as le,M as q,T as O,p as H,v as W,a5 as re,a6 as ce,P as ie,aa as de,j as me,H as pe,F as _e,E as j}from"./vendor-d6b13173.js";import{R as ve}from"./infoCollection-b0426750.js";import{s as fe,c as Fe}from"./phoneVerify-be4d5533.js";import{v as K,a as he,b as Ce}from"./validator-ebd71d12.js";import{F as P,g as Be}from"./utils-7311f686.js";import{G as De,_ as be}from"./index-ab09c1f5.js";import{g as Ee,m as ge,i as ye}from"./trial-afc6f615.js";import{p as Ie}from"./product-6604886f.js";import{t as ke}from"./theme-eeb93d73.js";import{c as we}from"./close-df102554.js";import{_ as Ve}from"./index-e91c7436.js";import"./trial-ed8aab88.js";const xe=T({props:{isCheck:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>{}}},emits:["on-verify"],setup(s,{emit:o}){var L;const t=s,n=m({}),r=m(!1),k=30,i=m(0),B=m("\u83B7\u53D6\u9A8C\u8BC1\u7801"),l=R({mobile:(L=t.userInfo)==null?void 0:L.mobile,smsCode:""}),D=e=>K(e)?!0:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7",g=()=>{if(i.value>0)return;i.value=k;const e=()=>{B.value=`${i.value}s`,i.value-=1};e();const c=setInterval(()=>{i.value===0?(B.value="\u83B7\u53D6\u9A8C\u8BC1\u7801",i.value=0,clearInterval(c)):e()},1e3)},_=async()=>{i.value>0||n==null||n.value.validate("mobile").then(async()=>{const e=await fe(l.mobile),{code:c,data:w}=e;c==="10000"&&(r.value=!0,O({message:"\u77ED\u4FE1\u53D1\u9001\u6210\u529F\uFF0C\u8BF7\u67E5\u6536"}),g())})},y=async()=>{const e=await Fe(l.mobile,l.smsCode),{data:c}=e;c&&o("on-verify",l)},v=async()=>{n==null||n.value.validate().then(async()=>{y()})};return ne(()=>l,()=>{K(l.mobile)&&he(l.smsCode)&&r.value&&y()},{deep:!0,immediate:!0}),(e,c)=>{const w=h("van-field"),S=h("van-cell-group"),$=h("VanForm");return F(),N($,{ref_key:"formRef",ref:n,"label-width":"80"},{default:A(()=>[C(S,null,{default:A(()=>[C(w,{modelValue:a(l).mobile,"onUpdate:modelValue":c[0]||(c[0]=V=>a(l).mobile=V),name:"mobile",label:"\u624B\u673A\u53F7",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",maxlength:a(P).MOBILE,rules:[{validator:D}]},null,8,["modelValue","maxlength","rules"]),C(w,{modelValue:a(l).smsCode,"onUpdate:modelValue":c[1]||(c[1]=V=>a(l).smsCode=V),type:"digit",name:"smsCode",label:"\u9A8C\u8BC1\u7801",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",maxlength:a(P).SMS_CODE},{button:A(()=>[u("div",{class:q(["sms-code",{"count-down":i.value>0}]),onClick:_},le(B.value),3)]),_:1},8,["modelValue","maxlength"])]),_:1}),u("div",{class:q([{"check-submit":t.isCheck},{submit:!t.isCheck}]),onClick:v},null,2)]),_:1},512)}}}),Ne=T({props:{isCheck:{type:Boolean,default:!1},userInfo:{type:Object,default:()=>{}}},emits:["on-submit"],setup(s,{emit:o}){const t=s,n=m({}),r=R({name:t.userInfo.name,certNo:t.userInfo.certNo}),k=l=>De(r.certNo)?!0:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u8BC1\u4EF6\u53F7",i=l=>Ce(l)?!0:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u59D3\u540D",B=()=>{n==null||n.value.validate().then(async l=>{o("on-submit",r)})};return(l,D)=>{const g=h("van-field"),_=h("van-cell-group"),y=h("VanForm");return F(),N(y,{ref_key:"formRef",ref:n,"label-width":"80"},{default:A(()=>[C(_,null,{default:A(()=>[C(g,{modelValue:a(r).name,"onUpdate:modelValue":D[0]||(D[0]=v=>a(r).name=v),name:"name",label:"\u59D3\u540D",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D",maxlength:a(P).NAME,rules:[{validator:i}]},null,8,["modelValue","maxlength","rules"]),C(g,{modelValue:a(r).certNo,"onUpdate:modelValue":D[1]||(D[1]=v=>a(r).certNo=v),name:"certNo",label:"\u8EAB\u4EFD\u8BC1",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u53F7",maxlength:a(P).ID_CARD,rules:[{validator:k}]},null,8,["modelValue","maxlength","rules"])]),_:1}),u("div",{class:q([{"check-submit":t.isCheck},{submit:!t.isCheck}]),onClick:B},null,2)]),_:1},512)}}});var Ae="/static/assets/title-step1.97cb9efa.png",Se="/static/assets/title-step2.258af5e9.png";const X=s=>(re("data-v-a6bc1804"),s=s(),ce(),s),Oe={key:0,class:"pro-modal"},Le=X(()=>u("div",{class:"pro-overlay"},null,-1)),Pe={class:"pro-modal-wrapper"},Te=X(()=>u("div",{class:"pro-modal-content"},[u("p",null,"\u606D\u559C\u60A8"),u("p",null,"\u9886\u53D6\u6210\u529F")],-1)),$e=["src"],Me=T({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(s,{emit:o}){const t=s,n=()=>{o("on-close")};return(r,k)=>t.isShow?(F(),H("div",Oe,[Le,u("div",Pe,[u("div",{class:"pro-modal-body"},[Te,u("div",{class:"pro-modal-btn",onClick:n},"\u6211\u77E5\u9053\u4E86")]),u("div",{class:"pro-modal-close",onClick:n},[u("img",{src:a(we)},null,8,$e)])])])):W("",!0)}});var Ue=be(Me,[["__scopeId","data-v-a6bc1804"]]);const qe={class:"page-activity-invite"},He=["src"],Re={class:"container"},je={class:"main-form"},ze={class:"title"},Ge=["src"],Je={class:"agree"},Ke={class:"check-wrap"},We=j(" \u6211\u5DF2\u9605\u8BFB\u5E76\u540C\u610F "),Xe={key:2,class:"tips"},Ye=j(" \u4EA7\u54C1\u4ECB\u7ECD\u9875\u9762\u4EC5\u4F9B\u53C2\u8003\uFF0C\u5177\u4F53\u8D23\u4EFB\u63CF\u8FBE\u4EE5\u4FDD\u9669\u5408\u540C\u4E3A\u51C6\uFF0C\u8D23\u4EFB\u5185\u4E0D\u9650\u533B\u4FDD\u76EE\u5F55\u8303\u56F4\uFF0C\u5C31\u533B\u5C11\u8D1F\u62C5\u4F17\u5B89\u4FDD\u9669\u6700\u8FD1\u5B63\u5EA6\u4F9B\u4ED8\u80FD\u529B\u7B26\u5408\u76D1\u7BA1\u8981\u6C42\uFF0C\u8BE6\u60C5\u8BF7\u53C2\u89C1\u4F17\u5B89\u4FDD\u9669\u5B98\u7F51 ("),Qe=u("a",{href:"https://www.zhongan.com"},"www.zhongan.com",-1),Ze=j("\uFF09\u507F\u4ED8\u80FD\u529B\u4FE1\u606F\u62AB\u9732\u8BE5\u4FDD\u9669\u4EA7\u54C1\u7531\u4F17\u5B89\u5728\u7EBF\u8D22\u4EA7\u4FDD\u9669\u80A1\u4EFD\u6709\u9650\u516C\u53F8\u627F\u4FDD\u5E76\u8D1F\u8D23\u7406\u8D54\u3002 "),et=[Ye,Qe,Ze],_t=T({setup(s){const o=ie(),t=de(),{productCode:n="7X9",tenantId:r="",phoneNo:k,saleChannelId:i,agentCode:B="",paymentMethod:l,from:D}=o.query,g=m(!0),_=D==="check",y=m(!1),v=m(!1),L=m(0),e=R({title:Ae,attachmentList:[{attachmentName:"",attachmentUri:""}],userInfo:{mobile:k,certNo:"",name:""},agree:!1}),c=m(),w=m(),S=m(!1),$=async p=>{var I,E;e.userInfo.mobile=p.mobile;const d=await Ee({holderPhone:e.userInfo.mobile,productCode:n,tenantId:r}),{code:b,data:f}=d;b==="10000"&&(e.userInfo.name=(I=f.tenantOrderHolder)==null?void 0:I.name,e.userInfo.certNo=(E=f.tenantOrderHolder)==null?void 0:E.certNo),e.title=Se,g.value=!1},V=async p=>{if(e.userInfo.certNo=p==null?void 0:p.certNo,e.userInfo.name=p==null?void 0:p.name,_&&!y.value){v.value=!0;return}if(!e.agree){O("\u8BF7\u52FE\u9009\u534F\u8BAE");return}try{O({message:"\u9886\u53D6\u4E2D...",forbidClick:!0,loadingType:"spinner"});const d=Be({tenantId:r,detail:c.value,insureDetail:w.value,saleChannelId:i,saleUserId:B,holder:e.userInfo,insured:U(M({},e.userInfo),{relationToHolder:ve.SELF}),paymentMethod:l,renewalDK:"",successJumpUrl:"",premium:0,orderStatus:"",orderTopStatus:"",tenantOrderRiskList:[]}),b=await ge(d),{code:f}=b;if(f==="10000"){if(_){O.clear(),S.value=!0;return}t.push({path:"/chuangxin/baigebao/productDetail",query:U(M({},o.query),{tenantId:r,phoneNo:e.userInfo.mobile,certNo:e.userInfo.certNo,name:e.userInfo.name,productCode:"BWYL2021",agentCode:B})})}}catch(d){console.log(d),O.clear()}},Y=()=>{y.value=!0,V()},Q=()=>{S.value=!1},Z=async()=>{const p=Ie({productCode:n,withInsureInfo:!0,tenantId:r}),d=ye({productCode:n});Promise.all([p,d]).then(([b,f])=>{var I,E;b.code==="10000"&&(c.value=b.data,e.attachmentList=((E=(I=c.value)==null?void 0:I.tenantProductInsureVO)==null?void 0:E.attachmentVOList)||[]),f.code==="10000"&&(w.value=f.data)})};return me(()=>{Z()}),(p,d)=>{const b=h("van-checkbox"),f=h("ProPDFviewer"),I=h("van-config-provider");return F(),N(I,{"theme-vars":a(ke)},{default:A(()=>{var E,z;return[u("div",qe,[u("img",{src:(z=(E=c.value)==null?void 0:E.tenantProductInsureVO)==null?void 0:z.banner[0],class:"banner"},null,8,He),u("div",Re,[u("div",je,[u("div",ze,[u("img",{src:a(e).title},null,8,Ge)]),g.value?(F(),N(xe,{key:0,"is-check":_,"user-info":a(e).userInfo,onOnVerify:$},null,8,["user-info"])):(F(),N(Ne,{key:1,"is-check":_,"user-info":a(e).userInfo,onOnSubmit:V},null,8,["user-info"])),u("div",Je,[u("div",Ke,[C(b,{modelValue:a(e).agree,"onUpdate:modelValue":d[0]||(d[0]=x=>a(e).agree=x),name:"agree",shape:"square"},null,8,["modelValue"])]),u("div",null,[We,(F(!0),H(_e,null,pe(a(e).attachmentList||[],(x,ee)=>(F(),N(f,{key:ee,class:"file-name",title:`\u300A${x.attachmentName}\u300B`,content:x.attachmentUri,type:"pdf"},null,8,["title","content"]))),128))])]),_?(F(),H("div",Xe,et)):W("",!0)])])]),C(Ue,{"is-show":S.value,onOnClose:Q},null,8,["is-show"]),C(Ve,{show:v.value,"onUpdate:show":d[1]||(d[1]=x=>v.value=x),"content-list":a(e).attachmentList,"active-index":L.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9",onSubmit:Y},null,8,["show","content-list","active-index"])]}),_:1},8,["theme-vars"])}}});export{_t as default};
