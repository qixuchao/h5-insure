import{G as a,d as e,r as s,u as r,a1 as t,b as l,c as o,e as n,w as d,f as u,E as c,g as i,ag as p,a2 as v,bD as I,F as f,i as m,j as b,m as h,T as C,bE as N,p as T,B as _,al as y,am as E}from"./index-3a3796c5.js";import{s as O,c as j}from"./phoneVerify-0d3e28a4.js";import{c as g}from"./format-12461bbc.js";import{u as S}from"./useOrder-cb6cb898.js";import"./pdfh5-008ca364.js";const P={class:"page-phone-verify"},A=(a=>(y("data-v-8f57f24c"),a=a(),E(),a))((()=>u("div",{class:"title"},"通过投保人手机号验证后，可进行投保信息填写",-1))),D={class:"phone"},F={class:"input-wrapper"};var q=a(e({__name:"phoneVerify",setup(a){const e=S(),y=s(""),E=s(""),q=s(0);let w;const V=r(),{agentCode:k,tenantId:x,templateId:G,productCode:U,insurerCode:W,orderNo:B}=V.query,H=()=>{O(y.value).then((({code:a})=>{"10000"===a&&(q.value=60,w=setInterval((()=>{q.value-=1,q.value<=0&&clearInterval(w)}),1e3))}))},L=()=>{j(y.value,E.value).then((({code:a,data:s})=>{"10000"===a&&s?(C.success("验证成功"),e.value.orderStatus===N.PROCESSING?T("infoCollection",{...V.query,isShare:1}):[N.WAIT_IDENTIFICATION,N.IDENTIFICATION_COMPLETE,N.IN_IDENTIFICATION].includes(e.value.orderStatus)&&T("infoPreview",{...V.query,isShare:1})):C.fail("验证失败")}))};return t((()=>{h({orderNo:B,saleUserId:k,tenantId:x}).then((({code:a,data:s})=>{var r;"10000"===a&&(Object.assign(e.value,s),y.value=null==(r=null==s?void 0:s.tenantOrderHolder)?void 0:r.mobile)}))})),(a,e)=>{const s=_,r=l("ProPageWrap");return o(),n(r,null,{default:d((()=>[u("div",P,[A,u("div",D,c(i(g)(i(y)||"")),1),u("div",F,[p(u("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>v(E)?E.value=a:null),placeholder:"请输入验证码",class:"input"},null,512),[[I,i(E)]]),u("div",{class:f(["btn",{second:i(q)}]),onClick:H},c(i(q)?`${i(q)}s`:"发送验证码"),3)]),m(s,{type:"primary",class:"submit-btn",onClick:L},{default:d((()=>[b("下一步")])),_:1})])])),_:1})}}}),[["__scopeId","data-v-8f57f24c"]]);export{q as default};
