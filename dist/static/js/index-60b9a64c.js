var Ze=Object.defineProperty,ze=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var Ue=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var $e=(l,i,k)=>i in l?Ze(l,i,{enumerable:!0,configurable:!0,writable:!0,value:k}):l[i]=k,N=(l,i)=>{for(var k in i||(i={}))Ke.call(i,k)&&$e(l,k,i[k]);if(Ue)for(var k of Ue(i))et.call(i,k)&&$e(l,k,i[k]);return l},Z=(l,i)=>ze(l,Je(i));import{g as S,L as Y,o as K,a1 as U,r as O,k as V,m as P,n as b,j as v,y as B,z as t,a2 as oe,a3 as ne,a4 as ie,C as w,x as M,d as ae,h as E,s as h,I as z,a5 as tt,a6 as at,F as ee,E as te,a7 as it,a8 as ot,B as j,D as nt,Q as lt,a9 as ut}from"./vendor-fffad6b1.js";import{P as x,a as rt}from"./index-faa3513b.js";import{b as le,S as ue,_ as J,P as Ne}from"./index-376965a3.js";const st=[{label:"\u7537",value:"1"},{label:"\u5973",value:"2"}],dt=[{label:"\u6709",value:"1"},{label:"\u65E0",value:"2"}],mt=[{value:1,label:"\u7B2C5\u4E2A\u4FDD\u5355\u5468\u5E74\u65E5"},{value:2,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8455\u5468\u5C81"},{value:3,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8460\u5468\u5C81"},{value:4,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8465\u5468\u5C81"},{value:5,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8470\u5468\u5C81"},{value:6,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8475\u5468\u5C81"}],ct=[{value:1,label:"\u5E74\u9886"},{value:2,label:"\u6708\u9886"}],Me=[{label:"\u8DB8\u4EA4",value:"1"},{label:"\u5E74\u4EA4",value:"2"},{label:"\u534A\u5E74\u4EA4",value:"3"},{label:"\u5B63\u4EA4",value:"4"},{label:"\u6708\u4EA4",value:"5"}],Se=[{label:"\u8DB8\u4EA4",value:"single"},{label:"1\u5E74\u4EA4",value:"year_1"},{label:"5\u5E74\u4EA4",value:"year_5"},{label:"10\u5E74\u4EA4",value:"year_10"},{label:"15\u5E74\u4EA4",value:"year_15"},{label:"20\u5E74\u4EA4",value:"year_20"},{label:"25\u5E74\u4EA4",value:"year_25"},{label:"30\u5E74\u4EA4",value:"year_30"},{label:"35\u5E74\u4EA4",value:"year_35"}],Ye=[{label:"7\u5929",value:"day_7"},{label:"14\u5929",value:"day_14"},{label:"30\u5929",value:"day_30"},{label:"1\u5E74",value:"year_1"},{label:"3\u5E74",value:"year_3"},{label:"5\u5E74",value:"year_5"},{label:"10\u5E74",value:"year_10"},{label:"15\u5E74",value:"year_15"},{label:"20\u5E74",value:"year_20"},{label:"25\u5E74",value:"year_25"},{label:"30\u5E74",value:"year_30"},{label:"35\u5E74",value:"year_35"},{label:"\u7EC8\u8EAB",value:"to_life"}],ft=[{label:"\u540C\u4E3B\u9669\u671F\u95F4\u51CF1",value:"3"},{label:"\u65E0\u9650\u5236",value:"2"}],je=[{label:"\u8FD4\u4FDD\u989D",value:"1"},{label:"\u8FD4\u4FDD\u8D39",value:"2"}],pt=[{label:"\u6295\u4FDD",value:"0"},{label:"\u4E0D\u6295\u4FDD",value:"-1"}],yt=(l={})=>le.post("/api/gateway/system/dict/v2/queryDictInfo",l);new ue({source:"sessionStorage"});const Ge=new ue({source:"localStorage"});new ue({source:"cookie"});const Vt=l=>(oe("data-v-1e1e74de"),l=l(),ne(),l),kt={class:"com-occupational-wrapper"},gt=Vt(()=>B("div",{class:"popup-title"},"\u9009\u62E9\u804C\u4E1A",-1)),Dt={class:"popup-content"},bt=S({props:{modelValue:{type:Array,required:!0,default:()=>[]},insuredCode:{type:String,required:!0,default:""},show:{type:Boolean,required:!0,default:!1}},emits:["finish","close","update:modelValue"],setup(l,{emit:i}){const k=l,o=Y({show:k.show,options:[],currentValue:""}),d=()=>{i("close")},L=({value:g,selectedOptions:n})=>{console.log(g,n);const c=(n||[]).map(p=>p.value).join("/");i("update:modelValue",g),i("finish",c),d()},C=g=>{const n=g,c=p=>{p.forEach(a=>{const e=a;e.children.length?c(e.children):e.children=null})};return c(n),n},R=()=>{var c,p;const g=`${(p=(c=k.insurerCode)==null?void 0:c.toLocaleUpperCase)==null?void 0:p.call(c)}_OCCUPATION`,n=Ge.get("occupational")||{};if(n[g]){o.options=n[g];return}yt({dictCodeList:[g]}).then(({code:a,data:e})=>{var u;if(a==="10000"){const s=C(((u=e==null?void 0:e[0])==null?void 0:u.dictItemList)||[]);o.options=s,n[g]=s,Ge.set("occupational",n)}})};return K(()=>{R()}),U(()=>k.modelValue,g=>{},{deep:!0,immediate:!0}),(g,n)=>{const c=O("van-cascader"),p=O("VanPopup");return V(),P("div",kt,[b(p,{show:t(o).show,"onUpdate:show":n[1]||(n[1]=a=>t(o).show=a),"show-footer":"",position:"bottom",closeable:"",onClose:d},{default:v(()=>[gt,B("div",Dt,[b(c,{modelValue:t(o).currentValue,"onUpdate:modelValue":n[0]||(n[0]=a=>t(o).currentValue=a),title:"\u8BF7\u9009\u62E9\u804C\u4E1A","show-header":!1,placeholder:"\u8BF7\u9009\u62E9",options:t(o).options,"active-color":"#0d6efe","field-names":{text:"value",value:"code",children:"children"},onFinish:L},null,8,["modelValue","options"])])]),_:1},8,["show"])])}}});var It=J(bt,[["__scopeId","data-v-1e1e74de"]]);const vt={class:"com-personal-info-wrapper"},He=S({props:{formInfo:{type:Object,required:!0,default:()=>{}},insuredCode:{type:String,required:!0,default:""},factorList:{type:Array,required:!0,default:()=>[]},ageRange:{type:Array,required:!0,default:()=>[]}},setup(l,{expose:i}){const k=l,[o,d]=ie(),[L,C]=ie(),R=w(),g=Y({formInfo:k==null?void 0:k.formInfo,occupationalText:""}),n=a=>{g.occupationalText=a},c=()=>{C(!1)},p=()=>new Promise((a,e)=>{R==null||R.value.validate().then(()=>{a("")},()=>{e()})});return M(()=>{const a=(m="")=>{const f=+m.split("_")[1],D=m.split("_")[0];return[f,D]},e=a((k==null?void 0:k.ageRange)[1]),u=a((k==null?void 0:k.ageRange)[0]),s=new Date(ae().subtract(e[0],e[1])),r=new Date(ae().subtract(u[0],u[1]));return console.log("minAge",s,r),{minAge:s,maxAge:r}}),i({validateForm:p}),(a,e)=>{const u=O("VanField"),s=O("VanForm"),r=O("van-datetime-picker"),m=O("van-popup");return V(),P("div",vt,[b(s,{ref_key:"formRef",ref:R,"input-align":"right","error-message-align":"right"},{default:v(()=>[l.factorList.includes("APPLICANT.AGE")||l.factorList.includes("AGE")?(V(),E(u,{key:0,modelValue:t(g).formInfo.birthday,"onUpdate:modelValue":e[0]||(e[0]=f=>t(g).formInfo.birthday=f),rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],name:"birth",label:"\u51FA\u751F\u65E5\u671F","is-link":"",placeholder:"\u8BF7\u9009\u62E9",onClick:e[1]||(e[1]=f=>t(d)(!0))},null,8,["modelValue"])):h("",!0),l.factorList.includes("APPLICANT.GENDER")||l.factorList.includes("GENDER")?(V(),E(u,{key:1,modelValue:t(g).formInfo.gender,"onUpdate:modelValue":e[3]||(e[3]=f=>t(g).formInfo.gender=f),name:"gender",label:"\u6027\u522B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[b(x,{modelValue:t(g).formInfo.gender,"onUpdate:modelValue":e[2]||(e[2]=f=>t(g).formInfo.gender=f),options:t(st)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):h("",!0),l.factorList.includes("SOCIAL_INS")?(V(),E(u,{key:2,modelValue:t(g).formInfo.socialSecurity,"onUpdate:modelValue":e[5]||(e[5]=f=>t(g).formInfo.socialSecurity=f),name:"socialSecurity",label:"\u793E\u4FDD",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[b(x,{modelValue:t(g).formInfo.socialSecurity,"onUpdate:modelValue":e[4]||(e[4]=f=>t(g).formInfo.socialSecurity=f),options:t(dt)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):h("",!0),l.factorList.includes("OCCUPATION_CATEGORY")?(V(),E(u,{key:3,modelValue:t(g).formInfo.occupationalClass,"onUpdate:modelValue":e[6]||(e[6]=f=>t(g).formInfo.occupationalClass=f),rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],name:"occupationalClass",label:"\u804C\u4E1A\u7C7B\u578B","is-link":"",placeholder:"\u8BF7\u9009\u62E9",onClick:e[7]||(e[7]=f=>t(C)(!0))},{input:v(()=>[B("div",null,z(t(g).occupationalText),1)]),_:1},8,["modelValue"])):h("",!0)]),_:1},512),b(m,{show:t(o),"onUpdate:show":e[10]||(e[10]=f=>tt(o)?o.value=f:null),position:"bottom"},{default:v(()=>[b(r,{type:"date","min-date":new Date("1900-01-01"),"max-date":new Date,onConfirm:e[8]||(e[8]=f=>{t(g).formInfo.birthday=t(ae)(f).format("YYYY-MM-DD"),t(d)(!1)}),onCancel:e[9]||(e[9]=f=>t(d)(!1))},null,8,["min-date","max-date"])]),_:1},8,["show"]),t(L)?(V(),E(It,{key:0,modelValue:t(g).formInfo.occupationalClass,"onUpdate:modelValue":e[11]||(e[11]=f=>t(g).formInfo.occupationalClass=f),show:t(L),"insured-code":"insuredCode",onFinish:n,onClose:c},null,8,["modelValue","show"])):h("",!0)])}}});const Xe=l=>(oe("data-v-cc1825f8"),l=l(),ne(),l),Lt={class:"com-risk-card-wrapper part-card"},_t=Xe(()=>B("div",{class:"delete-risk"},null,-1)),Et={key:0},Ct={key:9,class:"liab-desc"},ht=Xe(()=>B("div",{class:"title"},"\u8D23\u4EFB\u6295\u4FDD\u8BF4\u660E",-1)),Ft=S({props:{originData:{type:Object,required:!0,default:()=>{}},formInfo:{type:Object,required:!0,default:()=>{}},mainRiskData:{type:Object,default:()=>{}},mainRiskInfo:{type:Object,required:!1,default:()=>{}},index:{type:[Number,String],default:0,required:!0},removeRisk:{type:Function,default:()=>{}},ageRange:{type:Array,required:!0,default:()=>["",""]}},setup(l){const i=l,k=at("premium")||{},o=Y({formInfo:i.formInfo}),d=a=>typeof a!="boolean"&&!a||Array.isArray(a)&&!a.length?!0:{}.toString.call(a)==="object Object"?Object.keys(a).length:!1,L=(a,e)=>{let u=e;return Array.isArray(e)||(u=[`${u}`]),(a||[]).filter(s=>u.includes(`${s.value}`)||u.includes(s.value))},C=M(()=>{var a,e,u,s,r,m;return((a=i.originData)==null?void 0:a.riskType)===1?L(Ye,(u=(e=i==null?void 0:i.originData)==null?void 0:e.riskInsureLimitVO)==null?void 0:u.insurancePeriodValueList):((s=i.originData)==null?void 0:s.periodType)===2?L([{value:"year_1",label:"1\u5E74"}],["year_1"]):L(Ye,(m=(r=i==null?void 0:i.mainRiskData)==null?void 0:r.riskInsureLimitVO)==null?void 0:m.insurancePeriodValueList)}),R=M(()=>{var a,e,u,s,r,m,f,D,_;return((a=i.originData)==null?void 0:a.riskType)===1?L(Se,(u=(e=i==null?void 0:i.originData)==null?void 0:e.riskInsureLimitVO)==null?void 0:u.paymentPeriodValueList):((s=i.originData)==null?void 0:s.exemptFlag)===1?L(ft,(m=(r=i==null?void 0:i.originData)==null?void 0:r.riskInsureLimitVO)==null?void 0:m.paymentPeriodRule):((f=i.originData)==null?void 0:f.periodType)===2?L([{value:"year_1",label:"1\u5E74\u4EA4"}],["year_1"]):L(Se,(_=(D=i==null?void 0:i.mainRiskData)==null?void 0:D.riskInsureLimitVO)==null?void 0:_.paymentPeriodValueList)}),g=M(()=>{var a,e,u,s,r;return((a=i.originData)==null?void 0:a.riskType)===1?L(Me,(u=(e=i==null?void 0:i.originData)==null?void 0:e.riskInsureLimitVO)==null?void 0:u.paymentFrequencyList):L(Me,(r=(s=i==null?void 0:i.mainRiskData)==null?void 0:s.riskInsureLimitVO)==null?void 0:r.paymentFrequencyList)}),n=M(()=>{var u,s;let a=0,e=0;return(((s=(u=i.originData)==null?void 0:u.riskCalcMethodInfoVO)==null?void 0:s.paymentMethodLimitList)||[]).forEach((r,m)=>{m===0&&(a=r.minAmount,e=r.maxAmount),a>r.minAmount&&(a=r.minAmount),e<r.maxAmount&&(e=r.maxAmount)}),o.formInfo.sumInsured=a,{min:a,max:e}}),c=M(()=>{var u,s;let a=0,e=0;return(((s=(u=i.originData)==null?void 0:u.riskCalcMethodInfoVO)==null?void 0:s.paymentMethodLimitList)||[]).forEach((r,m)=>{m===0&&(a=r.minPremium,e=r.maxPremium),a>r.minPremium&&(a=r.minPremium),e<r.maxPremium&&(e=r.maxPremium)}),o.formInfo.premium=a,{min:a,max:e}}),p=M(()=>{var u,s,r,m;const a=((s=(u=i.originData)==null?void 0:u.riskCalcMethodInfoVO)==null?void 0:s.minCopy)||1,e=(m=(r=i.originData)==null?void 0:r.riskCalcMethodInfoVO)==null?void 0:m.maxCopy;return o.formInfo.copy=a,{min:a,max:e}});return K(()=>{var e,u;const a={riskType:i.originData.riskType,riskId:i.originData.id,riskCode:i.originData.riskCode,mainRiskCode:(e=i==null?void 0:i.mainRiskData)==null?void 0:e.riskCode,mainRiskId:(u=i==null?void 0:i.mainRiskData)==null?void 0:u.id,riskCategory:i.originData.riskCategory,liabilityVOList:(i.originData.riskLiabilityInfoVOList||[]).map(s=>({liabilityAttributeCode:s.liabilityAttributeType,liabilityCode:s.liabilityCode,liabilityId:s.id,liabilityRateType:s.liabilityRateType}))};Object.assign(o==null?void 0:o.formInfo,a)}),U(()=>{var a;return(a=o.formInfo)==null?void 0:a.paymentFrequency},a=>{var e,u,s,r;[3,4].includes((u=(e=i.originData)==null?void 0:e.riskCalcMethodInfoVO)==null?void 0:u.saleMethod)&&(((r=(s=i.originData)==null?void 0:s.riskCalcMethodInfoVO)==null?void 0:r.paymentMethodLimitList)||[]).forEach(m=>{+m.paymentFrequency==+a&&Object.assign(o.formInfo,{sumInsured:m.perCopyAmount,premium:m.perCopyPremium})})}),U(()=>i==null?void 0:i.mainRiskInfo,a=>{var e,u,s,r,m,f;a&&i.originData.riskType===2&&(((u=(e=i.originData)==null?void 0:e.riskInsureLimitVO)==null?void 0:u.insurancePeriodRule)===1&&(o.formInfo.coverageYear=a.coverageYear),((r=(s=i.originData)==null?void 0:s.riskInsureLimitVO)==null?void 0:r.paymentPeriodRule)===1&&(o.formInfo.paymentYear=a.paymentYear),((f=(m=i.originData)==null?void 0:m.riskInsureLimitVO)==null?void 0:f.paymentTypeRule)===1&&(o.formInfo.paymentFrequency=a.paymentFrequency))},{immediate:!0,deep:!0}),(a,e)=>{var f,D,_,T,F,$,G,H,q,re,se,de,me,ce,fe,pe,ye,Ve,ke,ge,De,be,Ie,ve,Le,_e,Ee,Ce,he,Fe,Oe,Ae,Re,Be,Te,Pe,we,qe,xe;const u=O("ProTitle"),s=O("RiskName"),r=O("VanStepper"),m=O("VanField");return V(),P("div",Lt,[b(u,{"risk-type":(f=l.originData)==null?void 0:f.riskType,title:(D=l.originData)==null?void 0:D.riskName},{default:v(()=>[_t]),_:1},8,["risk-type","title"]),b(s,{"risk-type":(_=l.originData)==null?void 0:_.riskType,name:(T=l.originData)==null?void 0:T.riskName,onClick:e[0]||(e[0]=y=>{var I;return l.removeRisk((I=l.originData)==null?void 0:I.id)})},null,8,["risk-type","name"]),(($=(F=l.originData)==null?void 0:F.riskCalcMethodInfoVO)==null?void 0:$.saleMethod)===1?(V(),E(m,{key:0,modelValue:t(o).formInfo.sumInsured,"onUpdate:modelValue":e[2]||(e[2]=y=>t(o).formInfo.sumInsured=y),label:"\u4FDD\u989D",name:"sumInsured",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:v(()=>{var y,I;return[b(r,{modelValue:t(o).formInfo.sumInsured,"onUpdate:modelValue":e[1]||(e[1]=A=>t(o).formInfo.sumInsured=A),min:t(n).min,step:((I=(y=l.originData)==null?void 0:y.riskCalcMethodInfoVO)==null?void 0:I.increaseDecreaseNum)||1,max:t(n).max},null,8,["modelValue","min","step","max"])]}),_:1},8,["modelValue"])):h("",!0),((H=(G=l.originData)==null?void 0:G.riskCalcMethodInfoVO)==null?void 0:H.saleMethod)===2?(V(),E(m,{key:1,modelValue:t(o).formInfo.premium,"onUpdate:modelValue":e[4]||(e[4]=y=>t(o).formInfo.premium=y),label:"\u4FDD\u8D39",name:"premium",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:v(()=>{var y,I;return[b(r,{modelValue:t(o).formInfo.premium,"onUpdate:modelValue":e[3]||(e[3]=A=>t(o).formInfo.premium=A),step:((I=(y=l.originData)==null?void 0:y.riskCalcMethodInfoVO)==null?void 0:I.increaseDecreaseNum)||1,min:t(c).min,max:t(c).max},null,8,["modelValue","step","min","max"])]}),_:1},8,["modelValue"])):h("",!0),((re=(q=l.originData)==null?void 0:q.riskCalcMethodInfoVO)==null?void 0:re.saleMethod)===3||((de=(se=l.originData)==null?void 0:se.riskCalcMethodInfoVO)==null?void 0:de.saleMethod)===4&&(((ce=(me=l.originData)==null?void 0:me.riskCalcMethodInfoVO)==null?void 0:ce.minCopy)||((pe=(fe=l.originData)==null?void 0:fe.riskCalcMethodInfoVO)==null?void 0:pe.maxCopy))?(V(),E(m,{key:2,modelValue:t(o).formInfo.copy,"onUpdate:modelValue":e[6]||(e[6]=y=>t(o).formInfo.copy=y),label:"\u6295\u4FDD\u4EFD\u6570",name:"copy",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:v(()=>[b(r,{modelValue:t(o).formInfo.copy,"onUpdate:modelValue":e[5]||(e[5]=y=>t(o).formInfo.copy=y),step:1,min:t(p).min,max:t(p).max},null,8,["modelValue","min","max"])]),_:1},8,["modelValue"])):h("",!0),((Ve=(ye=l.originData)==null?void 0:ye.riskCalcMethodInfoVO)==null?void 0:Ve.saleMethod)!==1&&((ge=t(k))==null?void 0:ge[(ke=l.originData)==null?void 0:ke.riskCode])?(V(),E(m,{key:3,label:"\u4FDD\u989D"},{input:v(()=>{var y,I,A;return[B("div",null,z((A=(I=t(k))==null?void 0:I[(y=l.originData)==null?void 0:y.riskCode])==null?void 0:A.amount),1)]}),_:1})):h("",!0),!d((be=(De=l.originData)==null?void 0:De.riskInsureLimitVO)==null?void 0:be.insurancePeriodValueList)||!d((ve=(Ie=l.originData)==null?void 0:Ie.riskInsureLimitVO)==null?void 0:ve.insurancePeriodRule)?(V(),E(m,{key:4,modelValue:t(o).formInfo.coverageYear,"onUpdate:modelValue":e[8]||(e[8]=y=>t(o).formInfo.coverageYear=y),label:"\u4FDD\u969C\u671F\u95F4",name:"coverageYear",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[b(x,{modelValue:t(o).formInfo.coverageYear,"onUpdate:modelValue":e[7]||(e[7]=y=>t(o).formInfo.coverageYear=y),options:t(C)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):h("",!0),!d((_e=(Le=l.originData)==null?void 0:Le.riskInsureLimitVO)==null?void 0:_e.paymentPeriodValueList)||!d((Ce=(Ee=l.originData)==null?void 0:Ee.riskInsureLimitVO)==null?void 0:Ce.paymentPeriodRule)?(V(),E(m,{key:5,modelValue:t(o).formInfo.paymentYear,"onUpdate:modelValue":e[10]||(e[10]=y=>t(o).formInfo.paymentYear=y),label:"\u4EA4\u8D39\u671F\u95F4",name:"paymentYear",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[b(x,{modelValue:t(o).formInfo.paymentYear,"onUpdate:modelValue":e[9]||(e[9]=y=>t(o).formInfo.paymentYear=y),options:t(R)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):h("",!0),!d((Fe=(he=l.originData)==null?void 0:he.riskInsureLimitVO)==null?void 0:Fe.paymentFrequencyList)||!d((Ae=(Oe=l.originData)==null?void 0:Oe.riskInsureLimitVO)==null?void 0:Ae.paymentTypeRule)?(V(),E(m,{key:6,modelValue:t(o).formInfo.paymentFrequency,"onUpdate:modelValue":e[12]||(e[12]=y=>t(o).formInfo.paymentFrequency=y),label:"\u4EA4\u8D39\u65B9\u5F0F",name:"paymentFrequency",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[b(x,{modelValue:t(o).formInfo.paymentFrequency,"onUpdate:modelValue":e[11]||(e[11]=y=>t(o).formInfo.paymentFrequency=y),options:t(g)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):h("",!0),d((Be=(Re=l.originData)==null?void 0:Re.riskInsureLimitVO)==null?void 0:Be.annuityDrawTypeList)?h("",!0):(V(),E(m,{key:7,modelValue:t(o).formInfo.annuityDrawDate,"onUpdate:modelValue":e[14]||(e[14]=y=>t(o).formInfo.annuityDrawDate=y),label:"\u9886\u53D6\u65F6\u95F4",name:"annuityDrawDate",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>{var y,I;return[b(x,{modelValue:t(o).formInfo.annuityDrawDate,"onUpdate:modelValue":e[13]||(e[13]=A=>t(o).formInfo.annuityDrawDate=A),options:L(t(mt),(I=(y=l.originData)==null?void 0:y.riskInsureLimitVO)==null?void 0:I.annuityDrawTypeList)},null,8,["modelValue","options"])]}),_:1},8,["modelValue"])),d((Pe=(Te=l.originData)==null?void 0:Te.riskInsureLimitVO)==null?void 0:Pe.annuityDrawFrequencyList)?h("",!0):(V(),E(m,{key:8,modelValue:t(o).formInfo.annuityDrawType,"onUpdate:modelValue":e[16]||(e[16]=y=>t(o).formInfo.annuityDrawType=y),label:"\u9886\u53D6\u65B9\u5F0F",name:"annuityDrawType",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>{var y,I;return[b(x,{modelValue:t(o).formInfo.annuityDrawType,"onUpdate:modelValue":e[15]||(e[15]=A=>t(o).formInfo.annuityDrawType=A),options:L(t(ct),(I=(y=l.originData)==null?void 0:y.riskInsureLimitVO)==null?void 0:I.annuityDrawFrequencyList)},null,8,["modelValue","options"])]}),_:1},8,["modelValue"])),(V(!0),P(ee,null,te(((we=l.originData)==null?void 0:we.riskLiabilityInfoVOList)||[],(y,I)=>(V(),P("div",{key:I},[y.optionalFlag===1?(V(),E(m,{key:0,modelValue:t(o).formInfo.liabilityVOList[I].liabilityAttributeValue,"onUpdate:modelValue":A=>t(o).formInfo.liabilityVOList[I].liabilityAttributeValue=A,label:y.liabilityName,name:"liabilityAttributeValue",rules:[{required:y.liabilityAttributeValue,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>{var A,W,Q;return[B("div",null,[d(y.liabilityAttributeValueList)?(V(),P("span",Et,"50\u4E07")):(V(),E(x,{key:1,modelValue:t(o).formInfo.liabilityVOList[I].liabilityAttributeValue,"onUpdate:modelValue":X=>t(o).formInfo.liabilityVOList[I].liabilityAttributeValue=X,options:L(t(je),(Q=(W=(A=l.originData)==null?void 0:A.riskLiabilityInfoVOList)==null?void 0:W[I])==null?void 0:Q.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]}),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):(V(),E(m,{key:1,modelValue:t(o).formInfo.liabilityVOList[I].liabilityAttributeValue,"onUpdate:modelValue":A=>t(o).formInfo.liabilityVOList[I].liabilityAttributeValue=A,label:y.liabilityName,name:"liabilityAttributeValue"},{input:v(()=>{var A,W,Q;return[B("div",null,[d(y.liabilityAttributeValueList)?(V(),E(x,{key:0,modelValue:t(o).formInfo.liabilityVOList[I].liabilityAttributeValue,"onUpdate:modelValue":X=>t(o).formInfo.liabilityVOList[I].liabilityAttributeValue=X,options:t(pt)},null,8,["modelValue","onUpdate:modelValue","options"])):(V(),E(x,{key:1,modelValue:t(o).formInfo.liabilityVOList[I].liabilityAttributeValue,"onUpdate:modelValue":X=>t(o).formInfo.liabilityVOList[I].liabilityAttributeValue=X,options:L(t(je),(Q=(W=(A=l.originData)==null?void 0:A.riskLiabilityInfoVOList)==null?void 0:W[I])==null?void 0:Q.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]}),_:2},1032,["modelValue","onUpdate:modelValue","label"]))]))),128)),((qe=l.originData)==null?void 0:qe.relationDesc)?(V(),P("div",Ct,[ht,B("div",null,z((xe=l.originData)==null?void 0:xe.relationDesc),1)])):h("",!0)])}}});var We=J(Ft,[["__scopeId","data-v-cc1825f8"]]);const Ot=l=>(oe("data-v-24ac5988"),l=l(),ne(),l),At={class:"com-risk-list-wrapper"},Rt=Ot(()=>B("div",{class:"popup-title"},"\u9009\u62E9\u9644\u52A0\u9669",-1)),Bt={class:"risk-list"},Tt={class:"footer-bar"},Pt=j("\u786E\u8BA4"),wt=S({props:{riskList:{type:Array,required:!0,default:()=>[]},show:{type:Boolean,required:!0,default:!1},collocationList:{type:Array,default:()=>[]},disabled:{type:Array,required:!0,default:()=>[]},modelValue:{type:Array,required:!0,default:()=>[]}},emits:["finished","close","update:modelValue"],setup(l,{emit:i}){const k=l,o=w([]),d=w([]),L=w(k.disabled),C=Y({show:k.show,currentChecked:[]}),R=(p,a)=>{if(!k.collocationList.length){if(a){C.currentChecked=[];return}C.currentChecked.push(p);return}k.collocationList.forEach(e=>{p===e.riskId&&(a?e.collocationType===1?C.currentChecked=C.currentChecked.filter(u=>!(u===e.collocationRiskId||u===p)):e.collocationType===3&&L.value.filter(u=>u!==e.collocationRiskId):e.collocationType===1?C.currentChecked.push(e.collocationRiskId,p):e.collocationType===3&&L.value.push(e.collocationRiskId))})},g=p=>{var e,u,s;const a=C.currentChecked.includes(p);console.log("status",a),R(p,a),(s=(u=(e=o==null?void 0:o.value)==null?void 0:e[p])==null?void 0:u.toggle)==null||s.call(u)},n=()=>{i("close")},c=()=>{const p=k.riskList.filter(a=>C.currentChecked.includes(a.id));i("update:modelValue",d),i("finished",p),i("close")};return it(()=>{o.value=[]}),U(()=>k.modelValue,p=>{d.value=p,L.value=p},{deep:!0,immediate:!0}),(p,a)=>{const e=O("van-checkbox"),u=O("VanCell"),s=O("van-cell-group"),r=O("van-checkbox-group"),m=O("VanButton"),f=O("VanPopup");return V(),P("div",At,[b(f,{show:t(C).show,"onUpdate:show":a[2]||(a[2]=D=>t(C).show=D),title:"\u9009\u62E9\u9644\u52A0\u9669","show-footer":"",position:"bottom",closeable:"",onClose:n},{default:v(()=>[Rt,B("div",Bt,[b(r,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=D=>d.value=D)},{default:v(()=>[b(s,{inset:""},{default:v(()=>[(V(!0),P(ee,null,te(l.riskList,D=>(V(),E(u,{key:D.id,title:D.riskName,onClick:_=>g(D.id)},{"right-icon":v(()=>[b(e,{ref_for:!0,ref:_=>o.value[D.id]=_,disabled:L.value.includes(D.id),shape:"square",name:D.id,onClick:a[0]||(a[0]=ot(()=>{},["stop"]))},null,8,["disabled","name"])]),_:2},1032,["title","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])]),B("div",Tt,[b(m,{type:"primary",disabled:!t(C).currentChecked.length,block:"",onClick:c},{default:v(()=>[Pt]),_:1},8,["disabled"])])]),_:1},8,["show"])])}}});var qt=J(wt,[["__scopeId","data-v-24ac5988"]]);const xt={class:"risk-list-wrapper"},Ut={key:0,class:"add-rider-risk"},$t={class:"left-part"},Nt=j("+ \u9644\u52A0\u9669"),Mt=S({props:{riskInfo:{type:Object,required:!0,default:()=>{}},originData:{type:Object,required:!0,default:()=>{}},pickFactor:{type:Function,required:!0,default:()=>{}}},setup(l){var g;const i=l,[k,o]=ie(!1);w(null),w(null);const d=Y({mainRiskInfo:i.riskInfo,riderRiskInfo:(g=i.riskInfo)==null?void 0:g.riderRiskVOList,requiredRiderRiskData:[],mainRiskData:{},riderRiskList:[],checkedList:[],relationListNum:0,disabledList:[]}),L=(n,c)=>{(n||[]).forEach(p=>{Object.assign(d.riderRiskInfo,{[p.id]:{}})}),d.disabledList=c,d.requiredRiderRiskData=d.requiredRiderRiskData.concat(n)},C=n=>{var p;const c=[n];(((p=d.mainRiskData)==null?void 0:p.collocationVOList)||[]).forEach(a=>{n===a.riskId&&a.collocationType===1&&c.push(a.collocationRiskId)}),nt.confirm({message:"\u786E\u5B9A\u8981\u5220\u9664\u9644\u52A0\u9669\u4E48\uFF1F"}).then(()=>{d.requiredRiderRiskData=d.requiredRiderRiskData.filter(a=>!c.includes(a.id)),Object.assign(d.riderRiskInfo,{[n]:void 0})}).catch(()=>{})},R=(n,c)=>{const p=n.split("_"),a=c.split("_");return p[0]===a[0]?+p[1]>+a[1]?[c,n]:[n,c]:p[0]==="age"?[n,c]:[c,n]};return K(()=>{d.requiredRiderRiskData}),U(()=>d.mainRiskInfo,n=>{},{deep:!0,immediate:!0}),U(()=>d.riderRiskInfo,()=>{},{deep:!0,immediate:!0}),U(()=>d.requiredRiderRiskData,n=>{const c=[d.mainRiskData,...n];let p=[],a=[],e=[];c.forEach((u,s)=>{var m,f,D,_,T;const r=((m=u==null?void 0:u.riskCalcMethodInfoVO)==null?void 0:m.riskFactorRelationList)||[];if(p=p.concat(r.filter(F=>F.factorObject==="insured").map(F=>F.factorCode)),a=a.concat(r.filter(F=>F.factorObject==="holder").map(F=>F.factorCode)),s===0)e[0]=((f=u==null?void 0:u.riskInsureLimitVO)==null?void 0:f.minHolderAge)||"",e[1]=(D=u==null?void 0:u.riskInsureLimitVO)==null?void 0:D.maxHolderAge;else{const F=R(e[0],(_=u==null?void 0:u.riskInsureLimitVO)==null?void 0:_.minHolderAge)[0],$=R(e[1],(T=u==null?void 0:u.riskInsureLimitVO)==null?void 0:T.maxHolderAge)[1];e=[F,$]}}),(n||[]).forEach(u=>{Object.assign(d.riderRiskInfo,{[u.id]:{}})}),i.pickFactor({insuredFactorList:[...new Set(p)],holderFactorList:[...new Set(a)],ageRange:e})},{deep:!0,immediate:!0}),U(()=>i.originData,n=>{(n||[]).forEach(c=>{c.riskType===1?(d.mainRiskData=c,d.requiredRiderRiskData=(c==null?void 0:c.requiredRiderRiskVOList)||[],d.riderRiskList=c==null?void 0:c.optionalRiderRiskVOList):d.riderRiskList.push(c)})},{deep:!0,immediate:!0}),U(()=>i.riskInfo,()=>{},{immediate:!0,deep:!0}),(n,c)=>{var p,a,e,u,s;return V(),P("div",xt,[b(We,{"form-info":t(d).mainRiskInfo,"origin-data":t(d).mainRiskData},null,8,["form-info","origin-data"]),(V(!0),P(ee,null,te(t(d).requiredRiderRiskData,(r,m)=>(V(),E(We,{key:r.id,"form-info":t(d).riderRiskInfo[r.id],index:m,"main-risk-data":t(d).mainRiskData,"main-risk-info":t(d).mainRiskInfo,"origin-data":r,"remove-risk":C},null,8,["form-info","index","main-risk-data","main-risk-info","origin-data"]))),128)),((a=(p=t(d))==null?void 0:p.riderRiskList)==null?void 0:a.length)-((u=(e=t(d))==null?void 0:e.checkedList)==null?void 0:u.length)?(V(),P("div",Ut,[B("span",$t,z(`\u5171\u6709${t(d).riderRiskList.length-t(d).checkedList.length}\u6B3E\u9644\u52A0\u9669\u53EF\u4EE5\u6DFB\u52A0`),1),b(rt,{activied:"",onClick:c[0]||(c[0]=r=>t(o)(!0))},{default:v(()=>[Nt]),_:1})])):h("",!0),t(k)?(V(),E(qt,{key:1,modelValue:t(d).checkedList,"onUpdate:modelValue":c[1]||(c[1]=r=>t(d).checkedList=r),show:t(k),disabled:t(d).disabledList,"risk-list":t(d).riderRiskList,"collocation-list":((s=t(d).mainRiskData)==null?void 0:s.collocationVOList)||[],onFinished:L,onClose:c[2]||(c[2]=r=>t(o)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):h("",!0)])}}});var Qe=J(Mt,[["__scopeId","data-v-7d19d870"]]);const St=(l={})=>le.get(`/api/product/insureProductDetail/${l==null?void 0:l.productId}`,l),Yt=(l={})=>le.post("/api/insurance/premiumCalc",l);const jt={key:0,class:"part-card"},Gt={key:1,class:"part-card"},Ht={class:"risk-content"},Wt={key:0,class:"risk"},Qt={key:1,class:"plan-risk"},Xt={class:"footer-bar"},Zt={class:"trial-result"},zt={class:"result-num"},Jt=j(" \u5143\u8D77 "),Kt={class:"trial-operate"},ea={key:0,class:"retrial-tip"},ta=j(" \u6761\u4EF6\u66F4\u6539\u540E\uFF0C\u9700\u8981\u91CD\u65B0\u8BD5\u7B97 "),aa=j("\u53BB\u8BD5\u7B97"),ia=j("\u7ACB\u5373\u6295\u4FDD"),oa=S({setup(l){const{id:i=115}=lt().query,k=w({personVO:{}}),o=w({insuredCode:"",personVO:{}}),d=w({}),L=w({}),C=w({}),R=w({}),g=w({});ut("premium",g.value);const n=Y({currentPlan:"",riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,ageRange:[]}),c=()=>{n.retrialTip=!1},p=()=>{var f;const s=Object.values(d.value[n.currentPlan].riderRiskVOList).map(D=>{const _=D;if(_.paymentYear==="3"){const T=(d.value[n.currentPlan].paymentYear||"").split("_");T[1]&&(T[1]-=1),_.paymentYear=T.join("_")}return _.liabilityVOList=_.liabilityVOList.filter(T=>!["-1"].includes(T.liabilityAttributeValue)).map(T=>{const F=T;return F.liabilityAttributeValue==="0"&&(F.liabilityAttributeValue=""),F}),_}),r=N({},d.value[n.currentPlan]);r.liabilityVOList=r.liabilityVOList.filter(D=>!["-1"].includes(D.liabilityAttributeValue)).map(D=>{const _=D;return _.liabilityAttributeValue==="0"&&(_.liabilityAttributeValue=""),_});const m={holder:{personVO:Z(N({},k.value.personVO),{birthday:k.value.personVO.birthday&&`${k.value.personVO.birthday} 00:00:00`})},productCode:(f=n==null?void 0:n.riskBaseInfo)==null?void 0:f.productCode,insuredVOList:[Z(N({},o.value),{personVO:Z(N({},o.value.personVO),{birthday:o.value.personVO.birthday&&`${o.value.personVO.birthday} 00:00:00`}),productPlanVOList:[{planCode:n.currentPlan||"",riskVOList:[Z(N({},r),{riderRiskVOList:s})]}]})]};Yt(N({},m)).then(({code:D,data:_})=>{if(D==="10000"){n.trialResult=_,n.canTrial=!1;const T={};(_.riskPremiumDetailVOList||[]).forEach(F=>{T[F.riskCode]=F}),Object.assign(g.value,T),console.log(g.value)}})},a=()=>{var s,r,m,f,D;Promise.all([(r=(s=L==null?void 0:L.value)==null?void 0:s.validateForm)==null?void 0:r.call(s),(f=(m=C==null?void 0:C.value)==null?void 0:m.validateForm)==null?void 0:f.call(m),(D=R==null?void 0:R.value)==null?void 0:D.validate()]).then(()=>{p()})},e=()=>{St({productId:i}).then(({code:s,data:r})=>{s==="10000"&&(n.riskBaseInfo=r==null?void 0:r.productBasicInfoVO,((r==null?void 0:r.productRelationPlanVOList)||(r==null?void 0:r.riskDetailVOList)||[]).forEach((m,f)=>{f===0&&(n.currentPlan=m.planCode||0),Object.assign(d.value,{[m.planCode||f]:{liabilityVOList:[],riderRiskVOList:{}}})}),n.riskData=(r==null?void 0:r.riskDetailVOList)||[],n.riskPlanData=(r==null?void 0:r.productRelationPlanVOList)||[])}).finally(()=>{})},u=s=>{n.holderFactor=s.holderFactorList,n.insuredFactor=s.insuredFactorList,n.ageRange=s.ageRange};return U([()=>d.value,()=>k.value,()=>o.value],s=>{s&&!n.canTrial&&(n.canTrial=!0,n.retrialTip=!0)},{deep:!0}),K(()=>{e()}),(s,r)=>{const m=O("VanForm"),f=O("VanTab"),D=O("VanTabs"),_=O("VanButton"),T=O("ZaPageWrap");return V(),E(T,{class:"page-trial-wrapper"},{default:v(()=>{var F,$,G,H;return[t(n).holderFactor.length?(V(),P("div",jt,[b(Ne,{title:"\u6295\u4FDD\u4EBA"}),b(He,{ref_key:"holderRef",ref:L,"insured-code":(F=t(n).riskBaseInfo)==null?void 0:F.insuredCode,"form-info":k.value.personVO,"factor-list":t(n).holderFactor,"age-range":t(n).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):h("",!0),t(n).insuredFactor.length?(V(),P("div",Gt,[b(Ne,{title:"\u88AB\u4FDD\u4EBA"}),b(He,{ref_key:"insuredRef",ref:C,"insured-code":($=t(n).riskBaseInfo)==null?void 0:$.insuredCode,"form-info":o.value.personVO,"factor-list":t(n).insuredFactor,"age-range":t(n).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):h("",!0),B("div",Ht,[t(n).riskData.length?(V(),P("div",Wt,[b(m,{ref_key:"riskFormRef",ref:R,"input-align":"right","error-message-align":"right"},{default:v(()=>[b(Qe,{"risk-info":d.value[0],"origin-data":t(n).riskData,"pick-factor":u},null,8,["risk-info","origin-data"])]),_:1},512)])):h("",!0),t(n).riskPlanData.length?(V(),P("div",Qt,[b(m,{ref_key:"riskFormRef",ref:R,"input-align":"right","error-message-align":"right"},{default:v(()=>[b(D,{modelValue:t(n).currentPlan,"onUpdate:modelValue":r[0]||(r[0]=q=>t(n).currentPlan=q)},{default:v(()=>[(V(!0),P(ee,null,te(t(n).riskPlanData,q=>(V(),E(f,{key:q.planCode,name:q.planCode,title:q.planName},{default:v(()=>[q.planCode===t(n).currentPlan?(V(),E(Qe,{key:0,"risk-info":d.value[q.planCode],"origin-data":q.riskDetailVOList,"pick-factor":u},null,8,["risk-info","origin-data"])):h("",!0)]),_:2},1032,["name","title"]))),128))]),_:1},8,["modelValue"])]),_:1},512)])):h("",!0)]),B("div",Xt,[B("span",Zt,[B("span",zt,z((((H=(G=t(n))==null?void 0:G.trialResult)==null?void 0:H.premium)||0).toLocaleString()),1),Jt]),B("div",Kt,[t(n).retrialTip?(V(),P("div",ea,[ta,B("span",{class:"close-icon",onClick:c},"X")])):h("",!0),t(n).canTrial?(V(),E(_,{key:1,type:"primary",onClick:a},{default:v(()=>[aa]),_:1})):(V(),E(_,{key:2,type:"primary",onClick:a},{default:v(()=>[ia]),_:1}))])])]}),_:1})}}});var sa=J(oa,[["__scopeId","data-v-5c35ab58"]]);export{sa as default};
