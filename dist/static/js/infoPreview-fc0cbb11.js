import{d as e,af as o,ag as t,i as a,h as s,r as n,j as i,aG as r,l,o as c,c as d,b as u,u as f,p,q as m,f as y,w as I,F as h,s as v,a as w,g as j,v as b,dG as g,T as k,bH as q,ak as C,bK as V,aS as x,aQ as L,c6 as T}from"./index-2c0dec77.js";import{P as _,a as P}from"./PolicyInfo-cd38c34c.js";import{g as O,m as R}from"./trial-18eda6f9.js";import{n as E}from"./nextStep-bdf7f7f2.js";import{b as N,l as D}from"./product-72573ec7.js";import{u as Q}from"./useOrder-64019b9e.js";import{P as U}from"./index-48fbd326.js";import{P as F}from"./index-ecf7c580.js";import{_ as S}from"./InsureInfo-e165b320.js";import{p as $,d as M}from"./utils-eb2e7d7e.js";import{Q as A}from"./notice-33e6eedd.js";import{g as B}from"./utils-35fc1808.js";import{Q as G}from"./questionnaire-42dcb602.js";import{P as z}from"./constants-b39aa53b.js";import{T as J}from"./infoCollection-857c8d53.js";import"./core-77f56f78.js";import"./cloneDeep-35f5a9b8.js";import"./util-eea2f3ad.js";import"./trial-f0fde32b.js";const H={class:"long-info-preview"},K={class:"footer-button"},W=e({__name:"infoPreview",setup(e){const W=o((()=>t((()=>import("./index-9f376873.js")),["static/js/index-9f376873.js","static/css/index-fa4edf2a.css","static/js/index-2c0dec77.js","static/css/index-839a5189.css","static/js/theme-94cf7d00.js","static/js/index-ecf7c580.js","static/css/index-bbfdd7ec.css","static/js/utils-35fc1808.js","static/js/infoCollection-857c8d53.js","static/js/trial-f0fde32b.js"]))),X=a(),Y=s(),Z=Q(),{productCode:ee="",tenantId:oe,agentCode:te="",agencyCode:ae,saleChannelId:se,isShare:ne,orderNo:ie,extraInfo:re,insurerCode:le,objectType:ce="1",templateId:de,preview:ue,origin:fe}=X.query;let pe={};try{pe=JSON.parse(decodeURIComponent(re))}catch(Te){}const me=n({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),ye=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`;i({imgUrl:"",desc:"",title:"",link:ye});const Ie=i(),he=i(),ve=i(!1),we=i(0),je=i(!1),be=()=>{ve.value=!1};i();const ge=()=>{de===J.FREE&&(Z.value.extInfo.buttonCode=g.free.underWriteAndIssue,Z.value.extInfo.pageCode="productInfo",E(Z.value,((e,o)=>{o===L.JUMP_PAGE&&Y.push({path:z[e.nextPageCode],query:X.query})})))},ke=async()=>{de===J.FREE&&k("被保人已完成认证")},qe=i(),Ce=i(),Ve=i([]),xe=async()=>{let e={};const{code:o,data:t}=await O({orderNo:ie,tenantId:oe});"10000"===o&&(Object.assign(Z.value,t),e=$(t.insuredList[0].productList),qe.value=t,je.value=!0),(async e=>{let o=[];const{code:t,data:a}=await T({orderNo:ie,tenantId:oe});"10000"===t&&(o=a.productQuestionnaireVOList);const{code:s,data:n}=await D(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},t=e.filter((e=>e.businessType!==A.VISIT));me.customerQuestions=t.map((e=>{const{questionnaireDetailResponseVO:t,questionnaireId:a,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=t||{},{objectType:r,questionnaireType:l}=i||{};if(l===G.TEXT){const{content:e,textType:o}=(null==n?void 0:n[0])||{};return{content:e,contentType:B(`${o}`,e),questionnaireId:a,questionnaireName:s}}const c=(o||[]).find((e=>e.questionnaireId===a));return{...t,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:a,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),N(e).then((({code:e,data:o})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:t}=M(o);Ve.value=e.concat(t)}})),R(e).then((({data:e,code:o})=>{if("10000"===o){const{productDetailResList:o,productFactor:t}=e;Ce.value=t;const{payInfo:a,other:s}=q(t);me.payInfo={...me.payInfo,...a},me.policyInfo={...me.policyInfo,...s}}}))};r((()=>{xe()}));const Le=i();return l((()=>{setTimeout((async()=>{Le.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,o)=>{var t,a,s;const n=C,i=V,r=x;return c(),d("div",H,[u(n),u(S,{"product-data":null==(a=null==(t=f(Z).insuredList)?void 0:t[0])?void 0:a.productList},null,8,["product-data"]),(null==(s=Object.keys(f(Ce)||{}))?void 0:s.length)?(c(),p(U,{key:0,ref_key:"personalInfoRef",ref:he,modelValue:f(qe),"onUpdate:modelValue":o[0]||(o[0]=e=>m(qe)?qe.value=e:null),"product-factor":f(Ce),"is-view":"","input-align":"left"},null,8,["modelValue","product-factor"])):y("",!0),f(me).payInfo.schema.length?(c(),p(f(_),{key:1,ref_key:"payInfoRef",ref:Ie,modelValue:f(Z).tenantOrderPayInfoList,"onUpdate:modelValue":o[1]||(o[1]=e=>f(Z).tenantOrderPayInfoList=e),schema:f(me).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),f(me).policyInfo.schema.length?(c(),p(f(P),{key:2,modelValue:f(Z).extInfo,"onUpdate:modelValue":o[2]||(o[2]=e=>f(Z).extInfo=e),schema:f(me).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):y("",!0),u(r,{title:"产品资料","show-line":!1,"show-icon":!1},{default:I((()=>[(c(!0),d(h,null,v(f(Ve),((e,o)=>(c(),p(i,{key:o,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{we.value=e,ve.value=!0})(o)},null,8,["title","onClick"])))),128))])),_:1}),w("div",K,["confirm"!==f(fe)?(c(),p(F,{key:0,shadow:!1,onClick:ke},{default:I((()=>[j(e.$slots,"default",{},(()=>[b("确认")]))])),_:3})):(c(),p(F,{key:1,shadow:!1,onClick:ge},{default:I((()=>[j(e.$slots,"default",{},(()=>[b("领取保障并激活")]))])),_:3}))]),f(ve)?(c(),p(f(W),{key:3,show:f(ve),"onUpdate:show":o[3]||(o[3]=e=>m(ve)?ve.value=e:null),"content-list":[f(Ve)[f(we)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:be},null,8,["show","content-list"])):y("",!0)])}}});export{W as default};
