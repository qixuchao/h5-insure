import{g as Y,Q as P,a0 as W,C as u,L as Z,M as G,h as x,j as g,r as C,k as d,y as e,I as n,B as p,z as o,m as f,E as A,F as $,G as B,H as k,n as N,J as H,s as J}from"./vendor-e9263418.js";import{e as Q}from"./article-20e0fb3d.js";import{u as K,S as X}from"./index-b8742a0a.js";import{_ as ee}from"./index-e4c11be9.js";import{_ as se}from"./index-654379f5.js";const te={class:"share-list-item-left"},ae={class:"share-left-title"},le={class:"share-left-bottom"},oe={class:"share-visitor"},ie=p("\u4EBA\u6765\u8BBF "),ne={class:"share-tag-out"},ce={class:"share-tag-text"},re={class:"shenglvhao"},ue=e("div",{class:"shenglvhao-item"},null,-1),de=e("div",{class:"shenglvhao-item"},null,-1),he=e("div",{class:"shenglvhao-item"},null,-1),ve=[ue,de,he],_e=["src"],me={class:"visitors-list"},ge=["onClick"],fe={class:"item-left"},pe=["src"],ye={class:"left-text"},Ce={class:"name"},Be={class:"visit-time"},ke=p(" \u7D2F\u8BA1\u8BBF\u95EE"),Ne=p("\u6B21 "),De={class:"item-right"},Ie={class:"item-right-text"},be=["src"],Se=e("div",null,null,-1),Ae=Y({setup(Ee){const{getIconUrl:U}=K(),D=P(),y=W(),q=new X({source:"localStorage"}),h=u(!1),v=u(!1),c=u(!1),_=u(0),r=u(!1),i=u({}),s=Z([]),I=()=>{var t;h.value&&(s.splice(0,s.length),h.value=!1),_.value+=1,_.value===1&&(r.value=!0),Q({queryBean:{articleId:(t=i.value)==null?void 0:t.articleId},pageNum:_.value,pageSize:10}).then(l=>{console.log(l),(l.data.data===null||l.data.data.list===null||l.data.data.list.length<10||l.data.data.list.length===0)&&(v.value=!0,c.value=!1),s.push(...l.data.data.list),c.value=!1,r.value=!1}).catch(l=>{c.value=!1,v.value=!0,console.log(l),r.value=!1})},b=()=>{v.value=!1,c.value=!0,_.value=0,I()},O=t=>{t.relatedCustomerId?(console.log("\u6211\u5DF2\u7ECF\u5173\u8054\u4E86"),y.push({name:"customerDetail",query:{agentCustomerId:t.relatedCustomerId,customerType:t.relatedCustomerType},hash:"#1"})):(console.log("\u6211\u6CA1\u6709\u5173\u8054\u4E86"),y.push({path:"/visitorDetail",query:{shareId:t.shareId,tenantId:t.tenantId,visitId:t.id}}))},j=()=>{var t;y.push({path:"./articleDetail",query:{articleId:i.value.articleId,flag:"Y",isInnerEntry:"Y",isOuterUrl:((t=i.value)==null?void 0:t.articleType)==="02"?"Y":"N"}})};return G(()=>{const t=q.get("myShareArticleDetailInfo")||{};Object.keys(D.params)>0?i.value=D.params:i.value=t,s.splice(0,s.length),b()}),(t,l)=>{const z=C("van-list"),M=C("van-pull-refresh"),R=C("ZaPageWrap");return d(),x(R,{id:"outer","main-class":"page-myShare"},{default:g(()=>{var S,E,w,L,V,F,T;return[e("div",{class:"share-list-item",onClick:j},[e("div",te,[e("div",ae,n(i.value.title||""),1),e("div",le,[e("div",oe,[p(n((o(s)&&o(s).length>0&&((S=o(s)[0])==null?void 0:S.wechatNickname.length)>4?`${(E=o(s)[0])==null?void 0:E.wechatNickname.slice(0,4)}..`:(w=o(s)[0])==null?void 0:w.wechatNickname)||"")+" "+n(o(s).length>1?"\u7B49":""),1),e("span",null,n(o(s).length||0),1),ie]),e("div",ne,[(d(!0),f($,null,A(((V=(L=i.value)==null?void 0:L.labelCategory)==null?void 0:V.infoLabelDTOList.slice(0,2))||[],(a,m)=>(d(),f("div",{key:`${m}`,class:"share-tag-item"},[e("div",ce,n(a.labelName&&a.labelName.length>4?`${a.labelName.slice(0,4)}..`:a.labelName||""),1)]))),128)),B(e("div",re,ve,512),[[k,((T=(F=i.value)==null?void 0:F.labelCategory)==null?void 0:T.infoLabelDTOList.length)>2]])])])]),e("img",{src:i.value.coverImage,alt:"",class:"share-article-image"},null,8,_e)]),e("div",me,[B(e("div",null,[N(M,{modelValue:h.value,"onUpdate:modelValue":l[1]||(l[1]=a=>h.value=a),onRefresh:b},{default:g(()=>[N(z,{loading:c.value,"onUpdate:loading":l[0]||(l[0]=a=>c.value=a),finished:v.value,onLoad:I},{finished:g(()=>[Se]),default:g(()=>[(d(!0),f($,null,A(o(s),(a,m)=>(d(),f("div",{key:m,class:H(["visitor-item",{lastone:m===o(s).length-1}]),onClick:we=>O(a)},[e("div",fe,[e("img",{src:a.wechatImageUrl||"",alt:"",class:"head-img"},null,8,pe),e("div",ye,[e("div",Ce,n(a.wechatNickname),1),e("div",Be,[ke,e("span",null,n(a.visitContentCount||0),1),Ne])])]),e("div",De,[e("div",Ie,n(a.visitDateTimeStr||""),1),e("img",{src:o(U)("article.rightImg"),alt:"",class:"right-icon"},null,8,be)])],10,ge))),128))]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])],512),[[k,o(s).length!==0&&!r.value]]),B(e("div",null,[N(ee,{title:"\u6682\u65E0\u8BBF\u5BA2",class:"empty-class"})],512),[[k,o(s).length===0&&!r.value]])]),r.value?(d(),x(se,{key:0,vertical:!0})):J("",!0)]}),_:1})}}});export{Ae as default};
