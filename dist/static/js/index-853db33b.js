import{_ as e,d as t,g as a,o as s,c as o,a as l,e as d,u as n,da as r,b as i,al as c,a8 as u,dx as p,w as m,aw as v,c1 as g,l as y,q as f,aA as I,T as b,a9 as C,an as h,at as N,au as k,dy as _,co as D,h as S,i as Y,j as x,z as U,O as T,b7 as L,m as j,d9 as P,n as w,F as A}from"./index-2b9d0680.js";import{_ as B}from"./index-1ffcabbf.js";import{L as E}from"./index-68d5492f.js";import{d as G,g as W}from"./order-28d75c11.js";import{I as q}from"./infoItem-bce61f83.js";import"./empty-ae586b6c.js";const R={class:"com-order-item"},H={class:"header"},M={class:"product-name"},O={class:"status"},z={class:"info"},F={class:"info-bottom"},X=(e=>(N("data-v-1c14f236"),e=e(),k(),e))((()=>l("div",{style:{width:"25%"}},[l("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),Z={class:"footer"},J={class:"fee"},K={class:"money"},Q={key:0,class:"buttons"},V={key:1,class:"buttons"},$={key:2,class:"buttons"};var ee=e(t({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:t}){const N=e,k=a(),D=()=>{I.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{G(N.detail.id,N.detail.orderStatus).then((e=>{const{code:a,data:s}=e;"10000"===a&&(b.success("删除成功"),t("afterDelete"))}))}))},S=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderTopStatus:c}=N.detail;if((p.PENDING===c||p.PAYING===c)&&[_.ZXYS,_.BWYL,_.BWYLUP].includes(e)){const a={[_.ZXYS]:"/internet/productDetail/package",[_.BWYL]:"/internet/productDetail",[_.BWYLUP]:"/internet/guaranteeUpgrade"};return k.push({path:a[e],query:{productCode:e,saleChannelId:i,agentCode:s,tenantId:l,agencyCode:r,orderNo:t}}),!0}return!1},Y=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r}=N.detail;S()||k.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyCode:r}})};return(t,a)=>{const I=h;return s(),o("div",R,[l("div",H,[l("div",M,d(e.detail.productName),1),l("div",O,d(n(r)[e.detail.orderStatus]),1)]),l("div",z,[i(q,{label:"订单号",content:e.detail.policyHolder,line:"","is-copy":""},null,8,["content"]),i(q,{label:"投保单号",content:e.detail.applicationNo,line:"","is-copy":""},null,8,["content"]),i(q,{label:"保单号",content:e.detail.policyNo,line:"","is-copy":""},null,8,["content"]),l("div",F,[l("div",null,[i(q,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),i(q,{label:"被保人",content:e.detail.insuredName,line:""},null,8,["content"]),i(q,{label:"创建时间",content:n(c)(e.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss"),line:""},null,8,["content"])]),X])]),l("div",Z,[l("div",J,[u(" 保费："),l("span",K,"￥"+d(e.detail.premium),1)]),e.detail.orderTopStatus===n(p).PENDING?(s(),o("div",Q,[i(I,{class:"button",onClick:v(D,["stop"])},{default:m((()=>[u("删除")])),_:1},8,["onClick"]),n(g).UNDERWRITING_FAILED!==e.detail.orderStatus?(s(),y(I,{key:0,class:"button primary",onClick:a[0]||(a[0]=v((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderStatus:c,abbreviation:u}=N.detail;S()||C("orderDetail",{orderNo:t,agentCode:s,tenantId:l,abbreviation:u,productCategory:n})})()),["stop"]))},{default:m((()=>[u("去处理")])),_:1})):f("",!0)])):f("",!0),e.detail.orderTopStatus===n(p).PAYING?(s(),o("div",V,[i(I,{class:"button primary",onClick:v(Y,["stop"])},{default:m((()=>[u("去支付")])),_:1},8,["onClick"])])):f("",!0),e.detail.orderTopStatus===n(p).TIMEOUT?(s(),o("div",$,[i(I,{class:"button",onClick:v(D,["stop"])},{default:m((()=>[u("删除")])),_:1},8,["onClick"])])):f("",!0)])])}}}),[["__scopeId","data-v-1c14f236"]]);const te={class:"page-order"},ae={key:0,class:"order-head"},se={class:"order-head-num"},oe={style:{"margin-left":"27px"},class:"order-head-num"},le={style:{"margin-left":"36px"},class:"order-head-num"},de={key:2,class:"empty-box"},ne=(e=>(N("data-v-7ae44c57"),e=e(),k(),e))((()=>l("div",{class:"footer"},[l("img",{src:"/static/png/logo-b728275d.png",alt:"",style:{width:"100%",height:"128px"}})],-1)));var re=e(t({__name:"index",setup(e){const t=D();a();const r=S().query,c=Y({"-1":1,0:2,1:3,2:4}[r.type]||0),p=Y(1),v=Y(!1),g=Y(!1),I=Y([]),h=Y(0),N=Y(0),k=Y(0),_=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],G=x((()=>(I.value=[],_[c.value].status))),q=()=>{b.loading({message:"加载中...",forbidClick:!0}),v.value=!0,W({condition:{orderTopStatus:G.value},pageSize:10,pageNum:p.value}).then((e=>{var t;v.value=!1;const{code:a,data:s}=e;"10000"===a&&s&&(1===p.value?(I.value=s.datas[0].applicationResList||[],h.value=s.datas[0].invalidNum,N.value=s.datas[0].totalNum,k.value=s.datas[0].validNum):I.value=[...I.value,...(null==(t=s.datas[0])?void 0:t.applicationResList)||[]]),g.value=!s||I.value.length>=(null==s?void 0:s.total)})).then((()=>{b.clear()}))},R=()=>{p.value+=1,q()},H=()=>{p.value=1,q()};return U(G,(()=>{p.value=1,q()})),T((()=>{q()})),(e,a)=>{const r=E,p=B,b=L;return s(),y(b,{"theme-vars":n(t)},{default:m((()=>[l("div",te,[i(P,{active:n(c),"onUpdate:active":a[0]||(a[0]=e=>j(c)?c.value=e:null),list:_,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),n(I).length?(s(),o("div",ae,[u(" 共 "),l("span",se,d(n(N)),1),u(" 张保单 "),l("span",oe,d(n(k)),1),u(" 张有效 "),l("span",le,d(n(h)),1),u(" 张失效 ")])):f("",!0),n(I).length?(s(),y(r,{key:1,class:"body",loading:n(v),finished:n(g),onLoad:R},{default:m((()=>[(s(!0),o(A,null,w(n(I),((e,t)=>(s(),y(ee,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n}=e;C("orderDetail",{orderNo:t,agentCode:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n})})(e),onAfterDelete:H},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])):(s(),o("div",de,[i(p,{title:"暂无投保单","empty-class":"empty-select"})])),ne])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-7ae44c57"]]);export{re as default};
