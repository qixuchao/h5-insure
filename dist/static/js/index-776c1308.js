import{g as k,j as b,n as W,z as s,J as G,A as v,t as re,a4 as le,a5 as ie,a9 as ue,O as ce,E as i,h as de,r as F,k as pe,m as K,p as m,T as f}from"./vendor-f5ae78f6.js";import{i as me}from"./infoCollection-192ba138.js";import{_ as P,a1 as ve}from"./index-adc8d77f.js";import{c as _e}from"./close-df102554.js";import{_ as fe}from"./index-cc940a5d.js";import{a as Ie}from"./order-26db6dbf.js";import{d as he,i as ge,g as De,s as Ce,e as we,E as ye}from"./trial-28c6568e.js";import{t as Ue}from"./theme-725d52fb.js";import{n as xe,i as $e,m as Oe,d as Se,b as Be,t as Ee,j as Ne,e as Y,f as Fe}from"./utils-cdbe4955.js";import{p as ke}from"./product-dda87332.js";import"./utils-b6782348.js";import"./trial-6afdb4f7.js";const be={class:"com-field-info"},Pe={class:"title"},Re={class:"desc"},Le=k({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup(u){return(_,I)=>(b(),W("div",be,[s("div",Pe,G(u.title),1),s("div",Re,G(u.desc),1)]))}});var x=P(Le,[["__scopeId","data-v-642d46bc"]]);const Q=u=>(le("data-v-4725f4c3"),u=u(),ie(),u),Ve={key:0,class:"pro-modal"},qe=Q(()=>s("div",{class:"pro-overlay"},null,-1)),Ae={class:"pro-modal-wrapper"},Me=Q(()=>s("div",{class:"pro-modal-content"},[s("p",null,"\u606D\u559C\u60A8"),s("p",null,"\u4FDD\u969C\u5347\u7EA7\u6210\u529F")],-1)),Te=["src"],ze=k({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(u,{emit:_}){const I=u,h=()=>{_("on-close")},n=()=>{_("on-confirm")};return(R,y)=>I.isShow?(b(),W("div",Ve,[qe,s("div",Ae,[s("div",{class:"pro-modal-body"},[Me,s("div",{class:"pro-modal-btn",onClick:n},"\u6211\u77E5\u9053\u4E86")]),s("div",{class:"pro-modal-close",onClick:h},[s("img",{src:v(_e)},null,8,Te)])])])):re("",!0)}});var He=P(ze,[["__scopeId","data-v-4725f4c3"]]);const Je={class:"page-activity-upgrade"},je=["src"],Ge={class:"container"},Ke={class:"main-form"},Ye=k({setup(u){const _=ue(),I=ce(),{productCode:h="BWYL2022",tenantId:n,orderNo:R,agentCode:y="",from:X}=I.query;console.log("upload--route.query",I.query);const d=i(),g=i(),t=i(),D=i(),$=i(),U=i(),L=i(!1),O=X==="check",S=i(!1),Z=i(0),B=i("");let E="";const ee=()=>{L.value=!1},te=async()=>{var r,c,p,C,w;const a=Be({tenantId:n,applicationNo:t.value.applicationNo,policyNo:t.value.policyNo,saleUserId:y,saleChannelId:t.value.saleChannelId,orderStatus:Ie.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:d.value,insureDetail:g.value,paymentMethod:(c=(r=t.value.extInfo)==null?void 0:r.extraInfo)==null?void 0:c.paymentMethod,renewalDK:(C=(p=t.value.extInfo)==null?void 0:p.extraInfo)==null?void 0:C.renewalDK,iseeBizNo:E,successJumpUrl:"",premium:D.value,holder:{...t.value.tenantOrderHolder,socialFlag:t.value.tenantOrderHolder.extInfo.hasSocialInsurance},insured:{...t.value.tenantOrderInsuredList[0],socialFlag:t.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance},tenantOrderRiskList:Ee({tenantId:n,riskList:Ne(g.value.productRiskVoList[0].riskDetailVOList,d.value),riskPremium:{},productId:(w=d.value)==null?void 0:w.id})}),e=await Ce(a),{code:l,data:o}=e;return l==="10000"?o.data:""},V=a=>`${ve}/pay?orderNo=${a}&saleUserId=${y}&tenantId=${n}`,q=()=>{_.replace(`/pay?orderNo=${B.value}&saleUserId=${y}&tenantId=${n}`)},ae=async()=>{try{const a=Y({tenantId:n,premium:D.value,orderDetail:t.value,productDetail:d.value,insureDetail:g.value,successJumpUrl:""},Fe),e=await we(a),{code:l,data:o}=e;l==="10000"&&(D.value=o.installmentPremium,U.value=o.signUrl),f.clear()}catch(a){console.log(a)}},oe=async a=>{const e=Y({tenantId:n,premium:D.value,orderDetail:t.value,productDetail:d.value,insureDetail:g.value,successJumpUrl:V(a),iseeBizNo:E}),l=await ye({orderNo:a,...e}),{code:o,data:r}=l;o==="10000"&&(O?_.replace(`/internet/orderDetail?orderNo=${a}&productCode=${h}&tenantId=${n}`):(f.clear(),q()))},A=async a=>{try{f.loading({forbidClick:!0,message:"\u5347\u7EA7\u4E2D",duration:15*1e3});const e=await te(),l=await he({tenantId:n,applicationNo:t.value.applicationNo});if(B.value=e,console.log(B.value,"orderNoUp.value===",e),U.value){if(O){const o=encodeURIComponent(encodeURIComponent(V(e))),r=`${U.value}&successUrl=${o}`;window.location.href=r}else{const o=encodeURIComponent(encodeURIComponent(window.location.href)),r=`${U.value}&failUrl=${o}`;window.location.href=r}f.clear()}else oe(e)}catch(e){console.log(e),f.clear()}},se=async a=>{O?S.value=!0:A()},ne=()=>{f.loading({forbidClick:!0,duration:20*1e3,message:"\u8BD5\u7B97\u4E2D"});const a=ke({productCode:h,withInsureInfo:!0,tenantId:n}),e=ge({productCode:h}),l=De({orderNo:R,tenantId:n});Promise.all([a,e,l]).then(([o,r,c])=>{var p;o.code==="10000"&&(d.value=o.data,document.title=((p=o.data)==null?void 0:p.productFullName)||""),r.code==="10000"&&(g.value=r.data),c.code==="10000"&&(t.value=c.data,$.value=c.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),ae()})};return de(()=>{ne(),setTimeout(async()=>{E=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(a,e)=>{const l=F("ProRadioButton"),o=F("ProField"),r=F("van-config-provider");return b(),pe(r,{"theme-vars":v(Ue)},{default:K(()=>{var c,p,C,w,M,T,z,H,J,j;return[s("div",Je,[s("img",{src:(p=(c=d.value)==null?void 0:c.tenantProductInsureVO)==null?void 0:p.banner[0],class:"banner"},null,8,je),s("div",Ge,[s("div",Ke,[m(x,{title:"\u59D3\u540D",desc:v(xe)((w=(C=t.value)==null?void 0:C.tenantOrderInsuredList)==null?void 0:w[0].name)},null,8,["desc"]),m(x,{title:"\u8BC1\u4EF6\u53F7\u7801",desc:v($e)((T=(M=t.value)==null?void 0:M.tenantOrderInsuredList)==null?void 0:T[0].certNo)},null,8,["desc"]),m(x,{title:"\u624B\u673A\u53F7\u7801",desc:v(Oe)((H=(z=t.value)==null?void 0:z.tenantOrderHolder)==null?void 0:H.mobile)},null,8,["desc"]),m(x,{title:"\u6BCF\u6708\u4FDD\u8D39",desc:`${v(Se)(D.value||0)}\u5143 / \u6BCF\u6708`},null,8,["desc"]),m(o,{label:"\u6709\u65E0\u793E\u4FDD",name:"name",required:"",placeholder:"\u8BF7\u9009\u62E9"},{input:K(()=>[m(l,{modelValue:$.value,"onUpdate:modelValue":e[0]||(e[0]=N=>$.value=N),disabled:!0,options:v(me)},null,8,["modelValue","options"])]),_:1}),s("div",{class:"submit",onClick:se})])]),m(He,{"is-show":L.value,onOnConfirm:q,onOnClose:ee},null,8,["is-show"])]),m(fe,{show:S.value,"onUpdate:show":e[1]||(e[1]=N=>S.value=N),"content-list":(j=(J=d.value)==null?void 0:J.tenantProductInsureVO)==null?void 0:j.attachmentVOList,"active-index":Z.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9",onSubmit:A},null,8,["show","content-list","active-index"])]}),_:1},8,["theme-vars"])}}});var it=P(Ye,[["__scopeId","data-v-093c5cfd"]]);export{it as default};
