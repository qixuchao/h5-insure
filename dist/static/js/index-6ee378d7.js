import{n as e,o as n,m as a,p as t}from"./infoCollection-afeffebd.js";import{$ as l,_ as i,d as r,r as o,z as u,a8 as s,x as c,G as m,a3 as d,am as f,ao as p,b as v,c as y,g as I,f as D,w as V,i as g,l as P,j as k,t as O,e as C,au as b,F as Y,n as L,K as x,L as S,h as E,B as h,T as w}from"./index-8e56e59a.js";import{l as F}from"./trial-977d6da5.js";import{h as N,o as T}from"./utils-708b7ef9.js";import"./pdfh5-e5c0db2a.js";import"./useStorage-5eb9ff61.js";const q=(e,n="YYYY-MM-DD")=>l(e).format(n),M=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).add(n,a).format(t),_=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).subtract(n,a).format(t);const U=e=>(x("data-v-49331618"),e=e(),S(),e),$={class:"com-period-cell"},R={key:0,class:"period-custom-cell period-check-btn-cell"},j=U((()=>g("div",{class:"period-cell-label"},"保障期间",-1))),A={class:"period-cell-content"},B=U((()=>g("div",{class:"period-cell-label"},"生效日期",-1))),G={class:"period-cell-content period-custom-cell-content"},H={key:2,class:"period-custom-cell period-common-cell"},z=U((()=>g("div",{class:"period-cell-label"},"保障期限",-1))),K={class:"period-cell-content"},X=U((()=>g("div",{class:"picker-custom-title"},"保险开始生效日期",-1))),J=L("确 定");var Q=i(r({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(a,{expose:t,emit:l}){const i=a;o({});const r=(e,n)=>"year"===e?`${n}年`:"month"===e?`${n}月`:"day"===e?`${n}日`:n,L=o(new Date),x=u({formInfo:i.formInfo}),S=o(!0);s((()=>x.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(L.value=new Date(e))}));const E=o(),h=o([]);s([()=>i.insureDetail,()=>x.formInfo.activePlanCode],(()=>{var e;if(x.formInfo.insuranceStartDate="",x.formInfo.insuranceEndDate="",x.formInfo.commencementTime="",i.insureDetail)if(i.insureDetail.productRelationPlanVOList&&i.insureDetail.productRelationPlanVOList.length>0){let n=0;const a=i.insureDetail.productRelationPlanVOList.findIndex((e=>e.planCode===x.formInfo.activePlanCode));a>-1&&(n=a);const t=((null==(e=i.insureDetail.productRelationPlanVOList[n])?void 0:e.productRiskVoList[0].riskDetailVOList)||[]).find((e=>1===e.riskType));t&&(E.value=t)}else{const e=(i.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find((e=>1===e.riskType));e&&(E.value=e)}}),{deep:!0,immediate:!0}),s((()=>E.value),(()=>{var e,n;h.value=[],h.value=N((null==(n=null==(e=E.value)?void 0:e.riskInsureLimitVO)?void 0:n.insurancePeriodValueList)||[]),h.value.length>0?h.value.findIndex((e=>e.value===x.formInfo.insurancePeriodValue))<0&&(x.formInfo.insurancePeriodValue=h.value[0].value):x.formInfo.insurancePeriodValue=F.YEAR_1}),{deep:!0,immediate:!0});const w=c((()=>{var n,a;return(null==(n=E.value)?void 0:n.insuranceStartType)?String(null==(a=E.value)?void 0:a.insuranceStartType):e.CURRENT_DAY})),T=c((()=>{var e,a;return(null==(e=E.value)?void 0:e.insuranceEndType)?String(null==(a=E.value)?void 0:a.insuranceEndType):n.CURRENT_DAY})),[U,Q]=m(!1),W=()=>{S.value&&Q(!0)},Z=c((()=>{var n;if(w.value===e.CUSTOM_DAY){const e=null==(n=E.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(e&&e.indexOf(",")){const[n,a]=e.split(",");return new Date(M(new Date,Number(n),"day"))}}return new Date(M(new Date,1,"day"))})),ee=c((()=>{var n;if(w.value===e.CUSTOM_DAY){const e=null==(n=E.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(!e)return new Date;if(e.indexOf(",")){const[n,a]=e.split(",");return new Date(M(new Date,Number(a),"day"))}const a=M(new Date,Number(e),"day");return new Date(a)}return new Date})),ne=e=>{x.formInfo.insuranceStartDate=`${q(e)} 00:00:00`,Q(!1)},ae=()=>{Q(!1)};return s([()=>w.value,()=>x.formInfo.insurancePeriodValue,()=>x.formInfo.insuranceStartDate,()=>E.value],(()=>{var a;if(!x.formInfo.insurancePeriodValue)return;const[t,l]=x.formInfo.insurancePeriodValue.split("_");if(!x.formInfo.insuranceStartDate)if(w.value===e.CUSTOM_DAY){const e=null==(a=E.value)?void 0:a.riskInsureLimitVO.maxInsuranceDay;if(e)if(e.indexOf(",")){const[n,a]=e.split(",");x.formInfo.insuranceStartDate=`${M(new Date,Number(n),"day")} 00:00:00`,S.value=n!==a}else x.formInfo.insuranceStartDate=`${M(new Date,e,"day")} 00:00:00`;else x.formInfo.insuranceStartDate=`${M(new Date,1,"day")} 00:00:00`}else w.value===e.NEXT_DAY?x.formInfo.insuranceStartDate=`${M(new Date,1,"day")} 00:00:00`:x.formInfo.insuranceStartDate=`${q(new Date)} 00:00:00`;if("to"!==t){const e=`${_(x.formInfo.insuranceStartDate,1,"day")} 00:00:00`;T.value===n.CURRENT_DAY?x.formInfo.insuranceEndDate=`${M(e,Number(l),t)} 23:59:59`:x.formInfo.insuranceEndDate=`${M(x.formInfo.insuranceStartDate,Number(l),t)} 00:00:00`}else{let e=x.formInfo.tenantOrderInsuredList[0].birthday;x.formInfo.tenantOrderInsuredList[0].certType===d.CERT&&x.formInfo.tenantOrderInsuredList[0].certNo&&f(x.formInfo.tenantOrderInsuredList[0].certNo)&&(e=p(x.formInfo.tenantOrderInsuredList[0].certNo));const a=`${_(e,1,"day")} 00:00:00`;"single"===l&&(x.formInfo.insuranceEndDate="9999-99-99 23:59:59"),T.value===n.CURRENT_DAY?x.formInfo.insuranceEndDate=`${M(a,Number(l),t)} 23:59:59`:x.formInfo.insuranceEndDate=`${M(e,Number(l),t)} 00:00:00`}}),{immediate:!0}),t({}),(n,a)=>{const t=v("ProRadioButton"),l=v("ProSvg"),i=v("van-config-provider"),o=v("VanButton"),u=v("van-datetime-picker"),s=v("ProPopup");return y(),I(Y,null,[D(i,null,{default:V((()=>[g("div",$,[h.value.length>1?(y(),I("div",R,[j,g("div",A,[D(t,{modelValue:P(x).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=e=>P(x).formInfo.insurancePeriodValue=e),options:h.value},null,8,["modelValue","options"])])])):k("",!0),P(w)===P(e).CUSTOM_DAY?(y(),I("div",{key:1,class:"period-custom-cell period-common-cell",onClick:W},[B,g("div",G,[g("span",null,O(P(x).formInfo.insuranceStartDate?P(q)(P(x).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),S.value?(y(),C(l,{key:0,class:"custom--arrow-right",name:"arrow-right"})):k("",!0)])])):k("",!0),P(w)!==P(e).CUSTOM_DAY?(y(),I("div",H,[z,g("div",K,O(P(x).formInfo.insuranceStartDate?P(q)(P(x).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+O(P(x).formInfo.insuranceEndDate?P(q)(P(x).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):k("",!0)])])),_:1}),D(s,{show:P(U),"onUpdate:show":a[3]||(a[3]=e=>b(U)?U.value=e:null),height:"340",closeable:!0},{default:V((()=>[D(u,{modelValue:L.value,"onUpdate:modelValue":a[2]||(a[2]=e=>L.value=e),type:"date",title:"保险开始生效日期","min-date":P(Z),"max-date":P(ee),formatter:r,"visible-item-count":5,class:"custom-date-picker",onConfirm:ne,onCancel:ae},{cancel:V((()=>[])),title:V((()=>[X])),confirm:V((()=>[D(o,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:a[1]||(a[1]=e=>U.value=!1)},{default:V((()=>[J])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-49331618"]]);const W=e=>(x("data-v-1defc39e"),e=e(),S(),e),Z={class:"com-payment-type"},ee={class:"title"},ne={key:0,class:"picture-payment-content"},ae=["onClick"],te=["src"],le=["src"],ie={key:1,class:"custom-cell check-btn-cell"},re=W((()=>g("div",{class:"cell-label"},"保障方案",-1))),oe={class:"cell-content"},ue={key:0,class:"picture-payment-content"},se=["onClick"],ce=["src"],me=["src"],de={key:1,class:"custom-cell check-btn-cell"},fe=W((()=>g("div",{class:"cell-label"},"交费方式",-1))),pe={class:"cell-content"},ve={class:"custom-cell common-cell"},ye=W((()=>g("div",{class:"cell-label"},"实付保费",-1))),Ie={key:0,class:"cell-content actual-premium"},De={class:"cell-content actual-premium"},Ve={key:0,class:"actual-premium actual-premium-month-tip"},ge={key:0,class:"feerate-explain"},Pe={class:"content"},ke=W((()=>g("div",{class:"triangle-top"},null,-1)));var Oe=i(r({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premiumInfo:{type:Object,default:()=>{}}},emits:["update-active-plan"],setup(e,{expose:n,emit:l}){const i=e;o({});const r=u({formInfo:i.formInfo}),m=o([]),d=o(),f=o(),p=c((()=>{var e;return"1"===String(null==(e=d.value)?void 0:e.paymentFrequencyFlag)}));c((()=>{var e;return null==(e=f.value)?void 0:e.productPremiumVOList.find((e=>e.paymentFrequency===r.formInfo.paymentFrequency))}));const b=c((()=>i.premiumInfo.premiumLoadingText?i.premiumInfo.premiumLoadingText:i.premiumInfo.premium?`${i.premiumInfo.premium||""}${i.premiumInfo.actualUnit||"元"}`:`${i.premiumInfo.minPremiun||""}${i.premiumInfo.unit||""}`)),L=c((()=>{if(f){const{premiumExplain:e,premiumExplainViewName:n,premiumExplainUri:a}=f.value||{};return{premiumExplain:e,premiumExplainUri:a,premiumExplainViewName:n}}return null})),x=c((()=>L.value&&L.value.premiumExplain&&L.value.premiumExplainViewName));s((()=>i.configDetail),(()=>{var e;i.isMultiplePlan&&i.configDetail&&(m.value=null==(e=i.configDetail.tenantProductInsureVO)?void 0:e.planList)}),{immediate:!0,deep:!0}),s([()=>i.configDetail,()=>i.isMultiplePlan,()=>r.formInfo.activePlanCode],(()=>{if(i.configDetail)if(i.isMultiplePlan){let e=0;const n=i.configDetail.tenantProductInsureVO.planList.findIndex((e=>e.planCode===r.formInfo.activePlanCode));n>-1&&(e=n),d.value=i.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,f.value=i.configDetail.tenantProductInsureVO.planList[e]}else d.value=i.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,f.value=i.configDetail.tenantProductInsureVO.planInsureVO}),{deep:!0,immediate:!0});const S=c((()=>{var e;if(d.value&&d.value.paymentFrequency){return((null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[]).length>1}return!1}));s((()=>d.value),(()=>{var e;if(d.value){const n=(null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[];if(1===n.length)return void(r.formInfo.paymentFrequency=d.value.paymentFrequency);if(2===n.length&&n.filter((e=>![a.SINGLE,a.MONTH].includes(e))).length<1)return void(r.formInfo.paymentFrequency||(r.formInfo.paymentFrequency=a.SINGLE));n.length>1&&!r.formInfo.paymentFrequency&&(r.formInfo.paymentFrequency=null==n?void 0:n[0])}}),{immediate:!0,deep:!0});const F=c((()=>{var e;return d.value?null==(e=d.value.paymentFrequencyList||[])?void 0:e.map((e=>({...e,paymentFrequency:e.skinValue}))):[]})),N=c((()=>F.value.length>0)),q=c((()=>i.isMultiplePlan?i.configDetail.tenantProductInsureVO.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[])),M=c((()=>{var e,n;if(d.value){const a=(null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[];return 1===a.length&&(r.formInfo.paymentFrequency=a[0]),null==(n=a||[])?void 0:n.map((e=>({label:t[e],value:e})))}return[]})),_=e=>{r.formInfo.activePlanCode=e},U=()=>{var e,n;(null==(e=L.value)?void 0:e.premiumExplainUri)?T({fileType:"pdf",fileUri:null==(n=L.value)?void 0:n.premiumExplainUri}):w("无费率文件！")};return n({}),(n,a)=>{const t=v("ProRadioButton"),l=v("templat"),o=v("ProDivider"),u=v("van-config-provider");return y(),C(u,null,{default:V((()=>[g("div",Z,[g("div",ee,O(P(S)?"交费方式":"保障计划"),1),e.isMultiplePlan?(y(),I(Y,{key:0},[P(q).length>0?(y(),I("div",ne,[(y(!0),I(Y,null,E(P(q),(e=>(y(),I("div",{key:e.planCode,class:h("picture-payment-item"),onClick:n=>_(e.planCode)},[P(r).formInfo.activePlanCode==e.planCode?(y(),I("img",{key:0,src:e.selectedPic},null,8,te)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,le))],8,ae)))),128))])):(y(),I("div",ie,[re,g("div",oe,[D(t,{modelValue:P(r).formInfo.activePlanCode,"onUpdate:modelValue":a[0]||(a[0]=e=>P(r).formInfo.activePlanCode=e),options:m.value,prop:{value:"planCode",label:"planName"},onChange:_},null,8,["modelValue","options"])])]))],64)):k("",!0),P(p)?(y(),C(l,{key:1},{default:V((()=>[P(N)&&P(F).length>1?(y(),I("div",ue,[(y(!0),I(Y,null,E(P(F),(e=>(y(),I("div",{key:e.paymentFrequency,class:h("picture-payment-item"),onClick:n=>{return a=e.paymentFrequency,void(r.formInfo.paymentFrequency=a);var a}},[P(r).formInfo.paymentFrequency==e.paymentFrequency?(y(),I("img",{key:0,src:e.selectedPic},null,8,ce)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,me))],8,se)))),128))])):P(M).length>1?(y(),I("div",de,[fe,g("div",pe,[D(t,{modelValue:P(r).formInfo.paymentFrequency,"onUpdate:modelValue":a[1]||(a[1]=e=>P(r).formInfo.paymentFrequency=e),options:P(M)},null,8,["modelValue","options"])])])):k("",!0)])),_:1})):k("",!0),D(Q,{"form-info":P(r).formInfo,"insure-detail":e.insureDetail,"config-detail":e.configDetail},null,8,["form-info","insure-detail","config-detail"]),P(b)&&P(x)?(y(),I(Y,{key:2},[g("div",ve,[ye,i.premiumInfo.premiumLoadingText?(y(),I("div",Ie,O(P(b)),1)):(y(),I(Y,{key:1},[g("div",De,O(P(b)),1),"5"===P(r).formInfo.paymentFrequency?(y(),I("div",Ve," 共12期 ")):k("",!0)],64))]),P(x)?(y(),I("div",ge,[g("div",Pe,[ke,g("div",null,[g("span",null,O(P(L).premiumExplain||""),1),g("span",{class:"file-name",onClick:U},"《"+O(P(L).premiumExplainViewName||"")+"》",1)])])])):k("",!0)],64)):k("",!0)]),D(o)])),_:1})}}}),[["__scopeId","data-v-1defc39e"]]);export{Oe as default};
