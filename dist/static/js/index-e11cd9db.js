import{g as E,E as d,O as I,h as b,r as p,j as x,k as P,m as _,z as n,J as v,A as T,H as k,ap as N,L as w,p as O,a4 as q,a5 as R,C as U,T as m}from"./vendor-17026bfd.js";import{r as h,_ as V,g as M,p as C}from"./index-b8dc485b.js";import{c as z}from"./format-99418f69.js";import{a as H}from"./order-b675ac95.js";const J=e=>h({url:"/api/app/insure/insurance/sendSmsCodeToC",method:"POST",params:{mobile:e}}),W=(e,s)=>h({url:"/api/app/insure/insurance/checkSmsCode",method:"POST",params:{mobile:e,smsCode:s}});const j=e=>(q("data-v-05d52b52"),e=e(),R(),e),G={class:"page-phone-verify"},L=j(()=>n("div",{class:"title"},"\u901A\u8FC7\u6295\u4FDD\u4EBA\u624B\u673A\u53F7\u9A8C\u8BC1\u540E\uFF0C\u53EF\u8FDB\u884C\u6295\u4FDD\u4FE1\u606F\u9884",-1)),$={class:"phone"},K={class:"input-wrapper"},Q=U("\u4E0B\u4E00\u6B65"),X=E({setup(e){const s=d(""),c=d(""),t=d(0);let i;const l=I(),{agentCode:f,tenantId:B,templateId:Y,productCode:Z,insurerCode:ee,orderNo:D}=l.query,F=()=>{i=setInterval(()=>{t.value-=1,t.value<=0&&clearInterval(i)},1e3)},S=()=>{M({orderNo:D,saleUserId:f,tenantId:B}).then(a=>{var r;const{code:o,data:u}=a;o==="10000"&&(u.orderStatus!==H.PENDING?C("paymentResult",l.query):s.value=(r=u==null?void 0:u.tenantOrderHolder)==null?void 0:r.mobile)})},g=()=>{J(s.value).then(({code:a})=>{a==="10000"&&(t.value=60,F())})},y=()=>{W(s.value,c.value).then(({code:a,data:o})=>{a==="10000"&&o?(m.success("\u9A8C\u8BC1\u6210\u529F"),C("infoPreview",l.query)):m.fail("\u9A8C\u8BC1\u5931\u8D25")})};return b(()=>{S()}),(a,o)=>{const u=p("van-button"),r=p("ProPageWrap");return x(),P(r,null,{default:_(()=>[n("div",G,[L,n("div",$,v(T(z)(s.value)),1),n("div",K,[k(n("input",{"onUpdate:modelValue":o[0]||(o[0]=A=>c.value=A),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",class:"input"},null,512),[[N,c.value]]),n("div",{class:w(["btn",{second:t.value}]),onClick:g},v(t.value?`${t.value}s`:"\u53D1\u9001\u9A8C\u8BC1\u7801"),3)]),O(u,{type:"primary",class:"submit-btn",onClick:y},{default:_(()=>[Q]),_:1})])]),_:1})}}});var ue=V(X,[["__scopeId","data-v-05d52b52"]]);export{ue as default};
