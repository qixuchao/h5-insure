var J=Object.defineProperty,Q=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var L=(u,t,s)=>t in u?J(u,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[t]=s,_=(u,t)=>{for(var s in t||(t={}))W.call(t,s)&&L(u,s,t[s]);if(b)for(var s of b(t))X.call(t,s)&&L(u,s,t[s]);return u},N=(u,t)=>Q(u,H(t));import{g as K,a9 as Z,O as ee,E as m,d as te,M as se,h as oe,r as E,j as f,k,m as v,p as C,n as O,G as U,L as ne,A as x,F as q,z as g,J as ue,C as P,T as F}from"./vendor-ec22d003.js";import{_ as ie,a as I,D as ae,g as le,A as ce,s as re,n as pe,N as _e,b as Ee}from"./index-83689ef1.js";import{l as fe,g as ve}from"./inform-22365124.js";import{s as Ce}from"./useStorage-9f547d59.js";import{s as ge}from"./verify-ef930a86.js";import{d as Te,A as de,e as Be}from"./notice-8f6df5db.js";const me={class:"date"},ye={class:"inform-file"},he={class:"tips"},De=P(" \u60A8\u7684\u7B7E\u540D\u5C06\u88AB\u7528\u4E8E"),Ae=P("\u6587\u4EF6 "),Ne={class:"footer-button"},ke=P("\u4E0B\u4E00\u6B65"),xe=K({setup(u){const t=Z(),s=ee(),{productCode:Fe="MMBBSF",agentCode:R="65434444",tenantId:T="9991000007",agencyCode:Pe="3311222",insurerCode:y="zhongan",productCategory:S=1,templateId:Y=1,orderNo:h="2022080217103534947"}=s.query,p=m(null),D=m(!1),G=te().format("YYYY-MM-DD"),d=m(""),A=m(),j=()=>{var o;(o=p.value)==null||o.clear()},i=se({noticeType:"",materialSource:"",noticeList:[],pageData:{}}),V=()=>{le({orderNo:h,saleUserId:R,tenantId:T}).then(({code:o,data:n})=>{o==="10000"&&(Object.assign(i.pageData,n),n.tenantOrderAttachmentList.forEach(a=>{a.category===ce.ELECTRIC_SIGN&&a.objectType===re.AGENT&&p.value.setDataURL(a.fileBase64)}))})},w=o=>{console.log(o);const{id:n,objectType:a}=o,r={1:"pdf",2:"richText",3:"link"};ve({insurerCode:y,id:n,objectType:a,productCategory:S,orderNo:h,tenantId:T}).then(({code:c,data:e})=>{c==="10000"&&(console.log(e),(e==null?void 0:e[0].questionType)===Te?(d.value="question",A.value=e):((e==null?void 0:e[0].textType)===1&&(e==null?void 0:e[0].content.includes("png"))?d.value="picture":d.value=r[e==null?void 0:e[0].textType],A.value=e==null?void 0:e[0].content))})};oe(()=>{V(),fe({insurerCode:y,orderNo:h,productCategory:S,tenantId:T,noticeType:de,objectType:Be}).then(({code:o,data:n})=>{o==="10000"&&(i.noticeList=[...i.noticeList,...n])})});const $=o=>{Ce.set("questionData",o),t.push({path:"/healthNotice",query:_({questionnaireType:o.questionnaireType},s.query)})},z=()=>{var a,r;if(!(i.noticeList&&i.noticeList.every(c=>c.isDone===1))){F("\u8BF7\u5B8C\u6210\u6240\u6709\u544A\u77E5\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if((a=p.value)==null?void 0:a.isEmpty()){F("\u8BF7\u5B8C\u6210\u4EE3\u7406\u4EBA\u7B7E\u5B57\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if(!D.value){F("\u8BF7\u52FE\u9009\u540C\u610F\u7B7E\u540D");return}const n=(r=p.value)==null?void 0:r.save();ge("AGENT",n,i.pageData.id,T).then(c=>{c&&pe(N(_({},i.pageData),{extInfo:N(_({},i.pageData.extInfo),{templateId:Y,pageCode:"salesNotice",buttonCode:_e.salesNotice}),venderCode:y})).then(({code:e,data:B})=>{e==="10000"&&B.pageAction.pageAction==="jumpToPage"&&t.push({path:Ee[B.pageAction.data.nextPageCode],query:_({},s.query)})})})};return(o,n)=>{const a=E("van-cell"),r=E("ProSign"),c=E("van-checkbox"),e=E("van-button"),B=E("ProPageWrap");return f(),k(B,{class:"page-salesman-inform"},{default:v(()=>[C(I,{title:"\u8425\u9500\u5458\u544A\u77E5\u4E66"},{default:v(()=>[(f(!0),O(q,null,U(x(i).noticeList,l=>(f(),k(a,{key:l.id,class:ne({"is-active":l.isDone===2}),title:`\u300A${l.title}\u300B`,"is-link":"",value:`${l.isDone===1?"\u5DF2\u5B8C\u6210":"\u53BB\u5B8C\u6210"}`,onClick:M=>$(l)},null,8,["class","title","value","onClick"]))),128))]),_:1}),C(I,{title:"\u8425\u9500\u5458\u7B7E\u5B57","show-divider":!1,"show-line":!1},{extra:v(()=>[g("div",{class:"resign",onClick:j},"\u91CD\u7B7E")]),default:v(()=>[C(r,{ref_key:"agentSignRef",ref:p,selector:"sign2"},null,512),g("div",me,"\u7B7E\u540D\u65E5\u671F\uFF1A "+ue(x(G)),1)]),_:1}),g("div",ye,[C(c,{modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=l=>D.value=l),shape:"square"},null,8,["modelValue"]),g("p",he,[De,(f(!0),O(q,null,U(x(i).noticeList,(l,M)=>(f(),k(ae,{key:M,class:"file",title:`\u300A${l.title}\u300B`,content:A.value,type:d.value,onClick:Se=>w(l)},null,8,["title","content","type","onClick"]))),128)),Ae])]),g("div",Ne,[C(e,{type:"primary",block:"",onClick:z},{default:v(()=>[ke]),_:1})])]),_:1})}}});var Re=ie(xe,[["__scopeId","data-v-7211b3c3"]]);export{Re as default};
