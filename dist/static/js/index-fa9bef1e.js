var Q=Object.defineProperty,z=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var L=(u,t,s)=>t in u?Q(u,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[t]=s,_=(u,t)=>{for(var s in t||(t={}))W.call(t,s)&&L(u,s,t[s]);if(q)for(var s of q(t))X.call(t,s)&&L(u,s,t[s]);return u},N=(u,t)=>z(u,J(t));import{h as K,aa as Z,P as ee,G as m,d as te,N as se,j as oe,r as E,k as f,m as k,n as v,s as g,p as b,H as I,M as ne,B as x,F as R,A as d,L as ue,E as P,T as F}from"./vendor-d6b13173.js";import{_ as ie,a as U,B as ae,g as le,A as ce,q as re,n as pe,b as _e}from"./index-af0a8990.js";import{l as Ee,g as fe}from"./inform-1d58cd0f.js";import{s as ve}from"./useStorage-a4ecdb1e.js";import{s as ge}from"./verify-19a91779.js";import{d as de,A as Ce,e as Be}from"./notice-8f6df5db.js";const Te={class:"date"},me={class:"inform-file"},ye={class:"tips"},he=P(" \u60A8\u7684\u7B7E\u540D\u5C06\u88AB\u7528\u4E8E"),Ae=P("\u6587\u4EF6 "),De={class:"footer-button"},Ne=P("\u4E0B\u4E00\u6B65"),ke=K({setup(u){const t=Z(),s=ee(),{productCode:xe="MMBBSF",agentCode:O="65434444",tenantId:C="9991000007",agencyCode:Fe="3311222",insurerCode:y="zhongan",productCategory:S=1,templateId:Y=1,orderNo:h="2022080217103534947"}=s.query,p=m(null),A=m(!1),G=te().format("YYYY-MM-DD"),B=m(""),D=m(),j=()=>{var o;(o=p.value)==null||o.clear()},i=se({noticeType:"",materialSource:"",noticeList:[],pageData:{}}),V=()=>{le({orderNo:h,saleUserId:O,tenantId:C}).then(({code:o,data:n})=>{o==="10000"&&(Object.assign(i.pageData,n),n.tenantOrderAttachmentList.forEach(a=>{a.category===ce.ELECTRIC_SIGN&&a.objectType===re.AGENT&&p.value.setDataURL(a.fileBase64)}))})},w=o=>{console.log(o);const{id:n,objectType:a}=o,r={1:"pdf",2:"richText",3:"link"};fe({insurerCode:y,id:n,objectType:a,productCategory:S,orderNo:h,tenantId:C}).then(({code:c,data:e})=>{c==="10000"&&(console.log(e),(e==null?void 0:e[0].questionType)===de?(B.value="question",D.value=e):((e==null?void 0:e[0].textType)===1&&(e==null?void 0:e[0].content.includes("png"))?B.value="picture":B.value=r[e==null?void 0:e[0].textType],D.value=e==null?void 0:e[0].content))})};oe(()=>{V(),Ee({insurerCode:y,orderNo:h,productCategory:S,tenantId:C,noticeType:Ce,objectType:Be}).then(({code:o,data:n})=>{o==="10000"&&(i.noticeList=[...i.noticeList,...n])})});const $=o=>{ve.set("questionData",o),t.push({path:"/healthNotice",query:_({questionnaireType:o.questionnaireType},s.query)})},H=()=>{var a,r;if(!(i.noticeList&&i.noticeList.every(c=>c.isDone===1))){F("\u8BF7\u5B8C\u6210\u6240\u6709\u544A\u77E5\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if((a=p.value)==null?void 0:a.isEmpty()){F("\u8BF7\u5B8C\u6210\u4EE3\u7406\u4EBA\u7B7E\u5B57\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if(!A.value){F("\u8BF7\u52FE\u9009\u540C\u610F\u7B7E\u540D");return}const n=(r=p.value)==null?void 0:r.save();ge("AGENT",n,i.pageData.id,C).then(c=>{c&&pe(N(_({},i.pageData),{extInfo:N(_({},i.pageData.extInfo),{templateId:Y,pageCode:"salesNotice"}),venderCode:y})).then(({code:e,data:T})=>{e==="10000"&&T.pageAction.pageAction==="jumpToPage"&&t.push({path:_e[T.pageAction.data.nextPageCode],query:_({},s.query)})})})};return(o,n)=>{const a=E("van-cell"),r=E("ProSign"),c=E("van-checkbox"),e=E("van-button"),T=E("ProPageWrap");return f(),k(T,{class:"page-salesman-inform"},{default:v(()=>[g(U,{title:"\u8425\u9500\u5458\u544A\u77E5\u4E66"},{default:v(()=>[(f(!0),b(R,null,I(x(i).noticeList,l=>(f(),k(a,{key:l.id,class:ne({"is-active":l.isDone===2}),title:`\u300A${l.title}\u300B`,"is-link":"",value:`${l.isDone===1?"\u5DF2\u5B8C\u6210":"\u53BB\u5B8C\u6210"}`,onClick:M=>$(l)},null,8,["class","title","value","onClick"]))),128))]),_:1}),g(U,{title:"\u8425\u9500\u5458\u7B7E\u5B57","show-divider":!1,"show-line":!1},{extra:v(()=>[d("div",{class:"resign",onClick:j},"\u91CD\u7B7E")]),default:v(()=>[g(r,{ref_key:"agentSignRef",ref:p,selector:"sign2"},null,512),d("div",Te,"\u7B7E\u540D\u65E5\u671F\uFF1A "+ue(x(G)),1)]),_:1}),d("div",me,[g(c,{modelValue:A.value,"onUpdate:modelValue":n[0]||(n[0]=l=>A.value=l),shape:"square"},null,8,["modelValue"]),d("p",ye,[he,(f(!0),b(R,null,I(x(i).noticeList,(l,M)=>(f(),k(ae,{key:M,class:"file",title:`\u300A${l.title}\u300B`,content:D.value,type:B.value,onClick:Pe=>w(l)},null,8,["title","content","type","onClick"]))),128)),Ae])]),d("div",De,[g(e,{type:"primary",block:"",onClick:H},{default:v(()=>[Ne]),_:1})])]),_:1})}}});var Ue=ie(ke,[["__scopeId","data-v-0166f588"]]);export{Ue as default};
