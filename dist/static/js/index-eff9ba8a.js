import{_ as e,d as t,di as a,i as n,h as i,j as o,r as s,k as l,l as r,bC as d,cq as c,o as u,p as m,w as p,a as v,u as f,c as h,v as y,e as I,b,f as L,s as j,F as g,ai as O,q as k,bg as N,dG as w,a_ as A,eg as T,T as q,b2 as V,bo as x,bp as C,c8 as D,bO as _}from"./index-8e0def42.js";import{C as P}from"./index-7224d547.js";import{_ as R}from"./index-c4308ca3.js";import{c as Q}from"./order-acdfedcd.js";import{m as U}from"./trial-23d7bced.js";import"./infoCollection-66cf23e6.js";import"./core-ccd0632a.js";import{I as E}from"./infoItem-ff1efd06.js";import{I as S}from"./insuranceNotificationInformation-e56a086a.js";import{a as F,P as G}from"./PolicyInfo-c3e25cff.js";import{l as B,b as H}from"./product-2e508871.js";import{Q as M}from"./questionnaire-42dcb602.js";import{P as X}from"./index-5aed678f.js";import{Q as Y}from"./notice-be58d319.js";import{g as $}from"./utils-d38ecabe.js";import{O as z}from"./OperateBtn-e4c0a3fc.js";import{t as J}from"./format-31cde443.js";import{C as K}from"./index-470f1c80.js";import"./cloneDeep-5d7aea4b.js";import"./util-8937eef7.js";import"./trial-cbe19304.js";const W=e=>(x("data-v-0d2e93e2"),e=e(),C(),e),Z={class:"page-order-detail"},ee=W((()=>v("div",{class:"card-item-name"},"订单进度",-1))),te={class:"card-item-icon"},ae={class:"card card-list"},ne={class:"card-list-title"},ie={class:"card card-list"},oe={class:"card-list-head"},se=W((()=>v("div",{class:"card-list-title"},"险种信息",-1))),le={class:"card-list-premium"},re={class:"card"},de={class:"card"},ce=W((()=>v("div",{class:"tenantOrderAttachmentList-title"},"投保人资料",-1))),ue={class:"tenantOrderAttachmentList-img"},me=["src"],pe=W((()=>v("div",{class:"tenantOrderAttachmentList-title"},"被保险人资料",-1))),ve={class:"tenantOrderAttachmentList-img"},fe=["src"],he=W((()=>v("div",{class:"tenantOrderAttachmentList-title"},"受益人资料",-1))),ye={class:"tenantOrderAttachmentList-img"},Ie=["src"],be=W((()=>v("div",{class:"tenantOrderAttachmentList-title"},"监护人资料",-1))),Le={class:"tenantOrderAttachmentList-img"},je=["src"],ge=W((()=>v("div",{class:"tenantOrderAttachmentList-title"},"银行卡信息",-1))),Oe={class:"tenantOrderAttachmentList-img"},ke=["src"],Ne={class:"card"},we={class:"card"},Ae={class:"footer-button"};var Te=e(t({__name:"index",setup(e){const t=a(),x=n();i();const C=o();o([]);const W=o([]),Te=[{title:"险种名称",dataIndex:"riskName",width:200},{title:"保险金额/份数",dataIndex:"initialAmount",width:180,render:(e,t)=>J(e.initialAmount/(e.copy||1))},{title:"保险期间",dataIndex:"coveragePeriodDesc",width:180},{title:"交费期间",dataIndex:"chargePeriodDesc",width:180},{title:"首年保费",dataIndex:"initialPremium",width:180,render:(e,t)=>J(e.initialPremium)}],qe=s({customerQuestions:[],payInfo:{schema:[],config:[],formData:[]},policyInfo:{schema:[],config:[],formData:{}}}),{query:{orderNo:Ve,agentCode:xe,tenantId:Ce}}=x,De=l((()=>{var e,t;return"cancel"!==(null==(e=C.value)?void 0:e.orderStatus)&&(null==(t=C.value)?void 0:t.periodType)===w.long})),_e=()=>{A("orderTrajectory",{orderNo:Ve,orderId:C.value.id,tenantId:Ce})},Pe=o(!1),Re=o(),Qe=o([]),Ue=l((()=>e=>{const{tenantOrderAttachmentList:t}=C.value;return(null==t?void 0:t.length)?t.filter((t=>t.objectType===e)):[]})),Ee=o(),Se=(e=!0)=>{T({orderNo:Ve,agentCode:xe,tenantId:Ce}).then((({code:t,data:a})=>{if("10000"===t){if(C.value=a,!e)return;Ee.value=a,C.value.tenantOrderPayInfoList=a.tenantOrderPayInfoList||[];const t=Object.keys(C.value.productCodeList).map((e=>({productCode:e,mergeRiskReqList:C.value.productCodeList[e]})));H(n={productList:t}).then((({data:e,code:t})=>{var a,n;"10000"===t&&(Qe.value=null==(n=null==(a=e.riskMaterialList)?void 0:a[0])?void 0:n.productMaterialList)})),U(n).then((({data:e,code:t})=>{if("10000"===t){const{productDetailResList:t,productFactor:a}=e;Re.value=a;const{payInfo:n,other:i}=_(a);qe.payInfo={...qe.payInfo,...n},qe.policyInfo={...qe.policyInfo,...i}}})),(async e=>{let t=[];const{code:a,data:n}=await D({orderNo:Ve,tenantId:Ce});"10000"===a&&(t=n.productQuestionnaireVOList);const{code:i,data:o}=await B(e);if("10000"===i){const{productQuestionnaireVOList:e}=o||{},a=e.filter((e=>e.businessType!==Y.VISIT));qe.customerQuestions=a.map((e=>{const{questionnaireDetailResponseVO:a,questionnaireId:n,questionnaireName:i,objectType:o}=e||{},{questions:s,basicInfo:l}=a||{},{objectType:r,questionnaireType:d}=l||{};if(d===M.TEXT){const{content:e,textType:t}=(null==s?void 0:s[0])||{};return{content:e,contentType:$(`${t}`,e),questionnaireId:n,objectType:o,questionnaireName:i}}const c=(t||[]).find((e=>e.questionnaireId===n&&e.objectType===o));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:n,objectType:o,questionnaireName:i}}))}})({productCodeList:Object.keys(C.value.productCodeList)})}var n}))},Fe=()=>{Q({orderNo:Ve,tenantId:Ce,cancelFlag:1}).then((({code:e,data:t})=>{"10000"===e&&(q("撤单成功"),setTimeout((()=>Se(!1)),500))}))};return r((()=>{Se()})),(e,a)=>{const n=V,i=R,o=P,s=K,l=d,r=c("loading");return u(),m(l,{"theme-vars":f(t)},{default:p((()=>{var e,t,l,d,c,w,A,T,q,V,x;return[v("div",Z,[f(De)?(u(),h("div",{key:0,class:"card card-head",onClick:_e},[ee,v("div",te,[y(I(null==(e=f(C))?void 0:e.orderStepDesc)+" ",1),b(n,{name:"arrow-right"})])])):L("",!0),v("div",ae,[v("p",ne,I(null==(t=f(C))?void 0:t.productName),1),b(E,{label:"订单号",content:null==(l=f(C))?void 0:l.orderNo,line:"","is-copy":"","min-width":"other"},null,8,["content"]),b(E,{label:"投/保单号",line:"","min-width":"other"},{content:p((()=>{var e,t,a,n;return[(u(!0),h(g,null,j((null==(t=null==(e=f(C))?void 0:e.policyNoList)?void 0:t.length)?null==(a=f(C))?void 0:a.policyNoList:null==(n=f(C))?void 0:n.applicationNoList,(e=>(u(),m(E,{key:e,content:e,line:"","is-copy":"","min-width":"other"},null,8,["content"])))),128))]})),_:1}),b(E,{label:"创建时间",content:null==(d=f(C))?void 0:d.orderDate,line:"","min-width":"other"},null,8,["content"]),b(E,{label:"投保时间",content:null==(c=f(C))?void 0:c.applicationCreateDate,line:"","min-width":"other"},null,8,["content"]),b(E,{label:"投保保费",content:f(J)(null==(w=f(C))?void 0:w.orderAmount),line:"","min-width":"other"},null,8,["content"]),b(E,{label:"承保保费",content:f(J)(null==(A=f(C))?void 0:A.orderAmount),line:"","min-width":"other"},null,8,["content"])]),v("div",ie,[v("div",oe,[se,v("div",le,[y(" 首年保费："),v("span",null,I(f(J)(null==(T=f(C))?void 0:T.orderAmount)),1)])]),(null==(V=null==(q=f(C))?void 0:q.riskList)?void 0:V.length)>0?(u(),m(i,{key:0,columns:Te,class:"table","data-source":null==(x=f(C))?void 0:x.riskList},null,8,["data-source"])):L("",!0)]),v("div",re,[f(qe).policyInfo.schema.length?(u(),m(f(F),{key:0,modelValue:f(C).extInfo,"onUpdate:modelValue":a[0]||(a[0]=e=>f(C).extInfo=e),schema:f(qe).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):L("",!0)]),v("div",de,[b(s,{modelValue:f(W),"onUpdate:modelValue":a[1]||(a[1]=e=>k(W)?W.value=e:null)},{default:p((()=>[b(o,{title:"影像信息",name:"1"},{default:p((()=>[ce,v("div",ue,[(u(!0),h(g,null,j(f(Ue)(f(O).HOLDER),((e,t)=>(u(),h("div",{key:t,class:"attachment-item"},[v("img",{src:e.uri,alt:""},null,8,me)])))),128))]),pe,v("div",ve,[(u(!0),h(g,null,j(f(Ue)(f(O).INSURED),((e,t)=>(u(),h("div",{key:t,class:"attachment-item"},[v("img",{src:e.uri,alt:""},null,8,fe)])))),128))]),he,v("div",ye,[(u(!0),h(g,null,j(f(Ue)(f(O).BENEFICIARY),((e,t)=>(u(),h("div",{key:t,class:"attachment-item"},[v("img",{src:e.uri,alt:""},null,8,Ie)])))),128))]),be,v("div",Le,[(u(!0),h(g,null,j(f(Ue)(f(O).GUARDIAN),((e,t)=>(u(),h("div",{key:t,class:"attachment-item"},[v("img",{src:e.uri,alt:""},null,8,je)])))),128))]),ge,v("div",Oe,[(u(!0),h(g,null,j(f(Ue)(f(O).INIT_SIGN),((e,t)=>(u(),h("div",{key:t,class:"attachment-item"},[v("img",{src:e.uri,alt:""},null,8,ke)])))),128))])])),_:1})])),_:1},8,["modelValue"])]),v("div",Ne,[b(S,{title:"投保告知信息",data:f(qe).customerQuestions||[]},null,8,["data"])]),v("div",we,[f(Re)?(u(),m(X,{key:0,ref:"personalInfoRef",modelValue:f(Ee),"onUpdate:modelValue":a[2]||(a[2]=e=>k(Ee)?Ee.value=e:null),"product-factor":f(Re),"is-view":""},null,8,["modelValue","product-factor"])):L("",!0)]),f(qe).payInfo.schema.length?(u(),m(f(G),{key:1,ref:"payInfoRef",modelValue:f(C).tenantOrderPayInfoList,"onUpdate:modelValue":a[3]||(a[3]=e=>f(C).tenantOrderPayInfoList=e),schema:f(qe).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):L("",!0),N((u(),h("div",Ae,[b(z,{detail:f(C),onHandleCancel:Fe},null,8,["detail"])])),[[r,f(Pe)]])])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-0d2e93e2"]]);export{Te as default};
