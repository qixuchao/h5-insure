import{G as a,d as e,z as s,r as t,ao as l,a as o,L as i,b as r,c as d,e as n,w as p,i as u,g as c,a3 as m,f as v,A as h,U as f,V as y,E as g,j as b,b1 as x,h as P,D as j,T as k,B as _}from"./index-cfc9ba08.js";import{L}from"./index-57f223ed.js";import{S as V}from"./index-4bb045b2.js";import{P as C}from"./index-21f4ae49.js";import{_ as I}from"./empty-ae586b6c.js";import{P as w}from"./index-71a4d028.js";import{d as U,h as N}from"./proposalList-ba99a088.js";import{a as S,b as q,t as z}from"./format-b5e9d8b9.js";import"./pdfh5-008ca364.js";const T={class:"proposal-content"},A={class:"title"},B={class:"premium"},D={class:"operate-btn"};var E=a(e({__name:"index",setup(a){const e=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:a=>S(null==a?void 0:a.coveragePeriod)},{title:"交费期间",dataIndex:"chargePeriod",width:110,render:a=>q(null==a?void 0:a.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:a=>z(null==a?void 0:a.initialPremium)}],E=s({historyList:[],searchValue:""}),G=t(!1),O=t(!1),R=t(1),{historyList:W,searchValue:F}=l(E),H=o(),J=()=>{N({name:F.value,pageNum:R.value,pageSize:20,relationUserType:2}).then((a=>{const{code:e,data:s}=a;"10000"===e&&(1===R.value?W.value=s.datas||[]:W.value=W.value.concat(s.datas),G.value=!1,R.value+=1,O.value=W.value.length>=s.total)}))},K=()=>{J()},M=i((()=>W.value.length>0)),Q=a=>{F.value=a,R.value=1,J()};return(a,s)=>{const t=V,l=_,o=L,i=r("ProPageWrap");return d(),n(i,{class:"page-history-proposal"},{default:p((()=>[u(t,{modelValue:c(F),"onUpdate:modelValue":s[0]||(s[0]=a=>m(F)?F.value=a:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:Q},null,8,["modelValue"]),v("div",T,[u(o,{loading:c(G),"onUpdate:loading":s[1]||(s[1]=a=>m(G)?G.value=a:null),finished:c(O),"finished-text":c(M)?"- 没有更多了 -":"",onLoad:K},{default:p((()=>[(d(!0),h(f,null,y(c(W),(a=>(d(),h("div",{key:a.id,class:"proposal-item"},[v("div",A,g(a.proposalName),1),v("p",B,[b(" 保费："),v("span",null,"¥"+g(c(x)(a.totalPremium)),1)]),u(w,{columns:e,class:"table","data-source":a.proposalProductRiskVOList},null,8,["data-source"]),v("div",D,[u(l,{plain:"",round:"",type:"primary",class:"del-btn",onClick:e=>{return s=a.id,void j.confirm({message:"是否确定删除计划书？"}).then((()=>{U(s).then((a=>{const{code:e}=a;"10000"===e&&(k.success("删除成功"),R.value=1,J())}))})).catch((()=>{}));var s}},{default:p((()=>[b("删除")])),_:2},1032,["onClick"]),u(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void H.push({path:"/proposal/createProposal",query:{id:s}});var s}},{default:p((()=>[b("编辑")])),_:2},1032,["onClick"]),u(l,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void H.push({path:"compositionProposal",query:{id:s}});var s}},{default:p((()=>[b("预览")])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),c(M)||c(G)?P("",!0):(d(),n(C,{key:0,"empty-img":c(I),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})}}}),[["__scopeId","data-v-77a00a23"]]);export{E as default};
