import{a8 as z,g as A,Q as R,a0 as V,C as I,M as Y,h as L,j as p,r as f,k as H,n as c,y,z as d,a2 as X,a3 as M,B as P,T as v}from"./vendor-e9263418.js";import{g as j,u as T,a as U,m as N}from"./businessCard-3a9ed3c6.js";import{u as B}from"./useCheckBack-f80d3d5c.js";import{_ as O}from"./plugin-vue_export-helper-46f75680.js";import"./index-b8742a0a.js";var S={exports:{}};(function(g,D){(function(b,w){g.exports=w()})(z,function(){function b(r,a){a===void 0&&(a={});var t=a.insertAt;if(!(!r||typeof document=="undefined")){var i=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",t==="top"&&i.firstChild?i.insertBefore(e,i.firstChild):i.appendChild(e),e.styleSheet?e.styleSheet.cssText=r:e.appendChild(document.createTextNode(r))}}var w=".clipic-body{background:#1c1c1c;position:fixed;width:100%;height:100%;top:0;left:0;-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);-webkit-transition:.4s;-o-transition:.4s;transition:.4s;-webkit-touch-callout:none;-webkit-user-select:none;z-index:99;overflow:hidden}.clipic-body,.clipic-body *{-webkit-box-sizing:border-box;box-sizing:border-box}.clipic-operation-bar{display:-webkit-box;display:-ms-flexbox;display:flex;color:#f2f2f2;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;position:absolute;width:100%;bottom:0;left:0}.clipic-operation-bar [role=button]{padding:15px 20px;font-size:1em}.clipic-frame{background:#f2f2f2;position:absolute;left:50%;top:30px;transform:translateX(-50%);transition:.3s}.clipic-frame img{-webkit-touch-callout:none;pointer-events:none}.clipic-frame-show{overflow:hidden}.clipic-cancel{color:#e04c4c}.clipic-reset{color:#3680fd}.clipic-confirm{color:#23c667}.clipic-layer{position:fixed;width:100%;height:100%;top:0;left:0;background:rgba(0,0,0,.8);pointer-events:none;transform:translateZ(0)}";b(w);var o=`
    <div class="clipic-frame" id="clipicFrame1"><img id="clipicImg1"></div>
    <div class="clipic-layer"></div>
    <div class="clipic-frame clipic-frame-show" id="clipicFrame2"><img id="clipicImg2"></div>
    <div class="clipic-operation-bar">
      <div class="clipic-cancel" id="clipicCancel" role="button">\u53D6\u6D88</div>
      <div class="clipic-reset" id="clipicReset" role="button">\u91CD\u7F6E</div>
      <div class="clipic-confirm" id="clipicConfirm" role="button">\u5B8C\u6210</div>
    </div>
  `,x=function(r,a){if(!(r instanceof a))throw new TypeError("Cannot call a class as a function")},k=function(){function r(a,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(a,e.key,e)}}return function(a,t,i){return t&&r(a.prototype,t),i&&r(a,i),a}}(),F=function(){function r(){x(this,r),this.default={width:500,height:500,src:"",encode:"base64",type:"jpeg",name:"clipic",quality:.9,buttonText:["\u53D6\u6D88","\u91CD\u7F6E","\u5B8C\u6210"]},this.init(),this.clipic=this.getId("clipic"),this.img1=this.getId("clipicImg1"),this.img2=this.getId("clipicImg2"),this.frame1=this.getId("clipicFrame1"),this.frame2=this.getId("clipicFrame2"),this.cancelBtn=this.getId("clipicCancel"),this.resetBtn=this.getId("clipicReset"),this.confirmBtn=this.getId("clipicConfirm"),this.reset=this.reset.bind(this),this.done=this.done.bind(this),this.cancel=this.cancel.bind(this)}return k(r,[{key:"init",value:function(){this.getId("clipic")||this.createHtml()}},{key:"getId",value:function(t){return document.getElementById(t)}},{key:"createHtml",value:function(){var t=document.createElement("div");t.className="clipic-body",t.setAttribute("id","clipic"),t.innerHTML=o,document.body.appendChild(t)}},{key:"getImage",value:function(){var t=this,i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.scale=1,this.rotate=0,this.translateX=0,this.translateY=0;var e=JSON.parse(JSON.stringify(this.default));this.options=Object.assign(e,i),this.cancelBtn.innerHTML=this.options.buttonText[0],this.resetBtn.innerHTML=this.options.buttonText[1],this.confirmBtn.innerHTML=this.options.buttonText[2],this.img1.src=this.options.src,this.img2.src=this.options.src;var n=new Image;n.onload=function(){t.originW=t.img2.width,t.originH=t.img2.height,t.options.ratio?(t.options.width=t.img2.width,t.options.height=t.img2.width/t.options.ratio):t.options.ratio=t.options.width/t.options.height,t.originRatio=t.originW/t.originH,t.initSize(),t.clipic.style.transform="translate(0, 0)",setTimeout(function(){t.options.ratio>t.originRatio?(t.img1.style.width=t.frame2.clientWidth+"px",t.img2.style.width=t.frame2.clientWidth+"px"):(t.img1.style.height=t.frame2.clientHeight+"px",t.img2.style.height=t.frame2.clientHeight+"px")},300),t.setTransform(),t.cancelBtn.addEventListener("click",t.cancel),t.resetBtn.addEventListener("click",t.reset),t.confirmBtn.addEventListener("click",t.done),t.clipic.addEventListener("touchmove",function(s){if(s.preventDefault(),s.touches.length>1){t.setScale(s.touches[0],s.touches[1]),t.setRotate(s.touches[0],s.touches[1]);return}t.setTranslate(s.touches[0])}),t.clipic.addEventListener("touchend",function(s){t.distance=null,t.angle=null,t.moveX=null,t.moveY=null})},n.src=this.options.src}},{key:"initSize",value:function(){var t=document.documentElement||document.body,i=t.clientWidth-60,e=t.clientHeight-80;this.frame1.style.width=i+"px",this.frame1.style.height=i/this.options.ratio+"px",this.frame2.style.width=i+"px",this.frame2.style.height=i/this.options.ratio+"px",i/this.options.ratio>e&&(this.frame1.style.height=e+"px",this.frame1.style.width=e*this.options.ratio+"px",this.frame2.style.height=e+"px",this.frame2.style.width=e*this.options.ratio+"px")}},{key:"setScale",value:function(t,i){var e=Math.abs(t.clientX-i.clientX),n=Math.abs(t.clientY-i.clientY),s=Math.sqrt(e*e+n*n);this.distance&&(this.scale+=(s-this.distance)/this.img2.clientWidth,this.setTransform()),this.distance=s}},{key:"setRotate",value:function(t,i){var e=t.clientX-i.clientX,n=t.clientY-i.clientY,s=Math.atan2(n,e)*180/Math.PI;this.angle&&(this.rotate+=s-this.angle,this.setTransform()),this.angle=s}},{key:"setTranslate",value:function(t){var i=t.clientX,e=t.clientY;this.moveX&&(this.translateX+=i-this.moveX),this.moveY&&(this.translateY+=e-this.moveY),this.moveX=i,this.moveY=e,this.setTransform()}},{key:"setTransform",value:function(){var t="translate("+this.translateX+"px, "+this.translateY+"px) scale("+this.scale+") rotate("+this.rotate+"deg)";this.img1.style.transform=t,this.img2.style.transform=t}},{key:"cancel",value:function(t){var i=this;this.clipic.style.transform="translate(0, 100%)",setTimeout(function(){i.img1.style="",i.img1.src="",i.img2.style="",i.img2.src=""},400),this.options.onCancel&&t!=="done"&&this.options.onCancel(),this.cancelBtn.removeEventListener("click",this.cancel),this.resetBtn.removeEventListener("click",this.reset),this.confirmBtn.removeEventListener("click",this.done,!0)}},{key:"reset",value:function(){var t=this;this.scale=1,this.rotate=0,this.translateX=0,this.translateY=0,this.img1.style.transition="0.3s",this.img2.style.transition="0.3s",this.setTransform(),setTimeout(function(){t.img1.style.transition="",t.img2.style.transition=""},300)}},{key:"done",value:function(){var t=this,i=this.options.width/this.frame2.clientWidth,e=document.createElement("canvas");e.width=this.options.width,e.height=this.options.height;var n=e.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height);var s=void 0,u=void 0;this.options.ratio>this.originRatio?(s=this.options.width,u=this.originH/(this.originW/this.options.width)):(u=this.options.height,s=this.originW/(this.originH/this.options.height));var h={x:s/2,y:u/2};if(n.translate(this.translateX*i,this.translateY*i),this.rotate!==0&&(n.translate(h.x,h.y),n.rotate(this.rotate*Math.PI/180),n.translate(-h.x,-h.y)),this.scale!==1&&(n.translate(h.x*(1-this.scale),h.y*(1-this.scale)),n.scale(this.scale,this.scale)),n.drawImage(this.img2,0,0,s,u),this.options.onDone)switch(this.options.encode){case"base64":this.options.onDone(e.toDataURL("image/"+this.options.type,this.options.quality));break;case"blob":e.toBlob(function(m){t.options.onDone(m)},"image/"+this.options.type);break;case"file":e.toBlob(function(m){var l=new window.File([m],t.options.name,{type:"image/"+t.options.type});t.options.onDone(l)},"image/"+this.options.type);break;default:this.options.onDone(e.toDataURL("image/"+this.options.type,this.options.quality));break}this.cancel("done")}}]),r}();return F})})(S);var W=S.exports;const E=g=>(X("data-v-0d506285"),g=g(),M(),g),q=E(()=>y("span",{class:"label-person"},"\u4E2A\u4EBA\u5F62\u8C61\u7167",-1)),Z=E(()=>y("span",{class:"star"},"*",-1)),Q=["src"],J=E(()=>y("span",{class:"label"},"\u5FAE\u4FE1\u4E8C\u7EF4\u7801",-1)),G=["src"],K={class:"card-info-btn"},$=P(" \u4FDD\u5B58 "),tt=A({setup(g){R();const D=V(),b=new W,w=I(!1);I("");const o=I({});B(o);const x=a=>{if(!(a.type==="image/jpg"||a.type==="image/jpeg"||a.type==="image/png"))return v("\u8BF7\u4E0A\u4F20 image \u683C\u5F0F\u56FE\u7247"),!1;if(!(a.size/1024/1024<5))return v("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 5M"),!1;const e=new FileReader;e.readAsDataURL(a),e.onload=n=>{var s;b.getImage({width:800,height:800,src:(s=n==null?void 0:n.target)==null?void 0:s.result,onDone:async u=>{console.log("base64",u);const h=await T({fileBase64:u}),{status:m,data:l}=h.data,C=await U({key:l}),{data:_}=C.data;console.log("dataUrl",_),o.value.imagePhotoUrl=_.fileOriginalUrl}})}},k=async()=>{const a=await j({}),{status:t,data:i}=a.data;o.value=i,t===200&&(o.value=i,B(o))},F=a=>{if(!(a.type==="image/jpg"||a.type==="image/jpeg"||a.type==="image/png"))return v("\u8BF7\u4E0A\u4F20 image \u683C\u5F0F\u56FE\u7247"),!1;if(!(a.size/1024/1024<5))return v("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 5M"),!1;const e=new FileReader;e.readAsDataURL(a),e.onload=n=>{var s;b.getImage({width:500,height:400,src:(s=n==null?void 0:n.target)==null?void 0:s.result,onDone:async u=>{console.log("base64",u);const h=await T({fileBase64:u}),{status:m,data:l}=h.data,C=await U({key:l}),{data:_}=C.data;console.log("dataUrl",_),o.value.wechatQrCodeUrl=_.fileOriginalUrl}})}},r=async()=>{if(!o.value.imagePhotoUrl)v("\u8BF7\u5148\u4E0A\u4F20\u4E2A\u4EBA\u5F62\u8C61\u7167");else{const a=await N({personalPhoto:o.value.imagePhotoUrl,wechatNo:o.value.wechatNumber,qrCode:o.value.wechatQrCodeUrl}),{status:t}=a.data;t===200&&(v("\u4FDD\u5B58\u6210\u529F\uFF01"),w.value=!1,B(),D.back())}};return Y(k),(a,t)=>{const i=f("ZaSvg"),e=f("van-uploader"),n=f("van-cell"),s=f("van-field"),u=f("van-cell-group"),h=f("van-button"),m=f("ZaPageWrap");return H(),L(m,{"main-class":"page-card-info"},{default:p(()=>[c(u,{inset:"","custom-class":"card-person-cell"},{default:p(()=>[c(n,{label:"\u5EFA\u8BAE\u5C3A\u5BF8800*800",class:"card-info-person"},{title:p(()=>[q,Z]),default:p(()=>[c(e,{"result-type":a.file,"max-count":1,"before-read":x,"max-size":5*1024*1024,"preview-size":"44",onOversize:a.onOversize},{default:p(()=>[y("img",{src:d(o).imagePhotoUrl,alt:"",class:"info-img info-img-avata"},null,8,Q),c(i,{name:"right_arrow",class:"arrow-icon-card"})]),_:1},8,["result-type","onOversize"])]),_:1}),c(s,{modelValue:d(o).name,"onUpdate:modelValue":t[0]||(t[0]=l=>d(o).name=l),name:"name",label:"\u59D3\u540D",placeholder:"","input-align":"right",disabled:""},null,8,["modelValue"]),c(s,{modelValue:d(o).mobile,"onUpdate:modelValue":t[1]||(t[1]=l=>d(o).mobile=l),name:"mobile",label:"\u624B\u673A\u53F7\u7801","input-align":"right",placeholder:"",disabled:""},null,8,["modelValue"]),c(s,{modelValue:d(o).company,"onUpdate:modelValue":t[2]||(t[2]=l=>d(o).company=l),name:"company",label:"\u6240\u5728\u516C\u53F8",placeholder:"","input-align":"right",disabled:""},null,8,["modelValue"]),c(s,{modelValue:d(o).companyPosition,"onUpdate:modelValue":t[3]||(t[3]=l=>d(o).companyPosition=l),name:"companyPosition",label:"\u516C\u53F8\u804C\u4F4D","input-align":"right",placeholder:"",disabled:""},null,8,["modelValue"]),c(s,{modelValue:d(o).wechatNumber,"onUpdate:modelValue":t[4]||(t[4]=l=>d(o).wechatNumber=l),name:"wechatNumber",label:"\u5FAE\u4FE1\u53F7","input-align":"right",placeholder:"",center:""},null,8,["modelValue"]),c(n,{class:"card-info-person"},{title:p(()=>[J]),default:p(()=>[c(e,{"before-read":F},{default:p(()=>[y("img",{src:d(o).wechatQrCodeUrl,alt:"",class:"info-img"},null,8,G),c(i,{name:"right_arrow",class:"arrow-icon-card"})]),_:1})]),_:1})]),_:1}),y("div",K,[c(h,{round:"",block:"",class:"btn",type:"primary",onClick:r},{default:p(()=>[$]),_:1})])]),_:1})}}});var ot=O(tt,[["__scopeId","data-v-0d506285"]]);export{ot as default};
