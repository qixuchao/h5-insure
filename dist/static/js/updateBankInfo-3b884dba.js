import{_ as e,d as a,j as t,i as s,h as o,bc as n,l as r,o as i,c as d,u as l,p as c,q as u,f as p,a as f,b as m,w as v,v as y,ba as b,bk as g,a_ as I,d4 as h,aY as j,bb as P,bO as _,b3 as w,cE as N,cH as k,cG as x,c5 as C}from"./index-d3f9fc28.js";import{P as O}from"./PolicyInfo-bee3f88f.js";import{u as $}from"./useOrder-d193ce0d.js";import{p as E}from"./utils-78748ddc.js";import{g as L,m as T}from"./trial-c58bb7da.js";import{n as A}from"./nextStep-4e91a9b4.js";import"./cloneDeep-66e92211.js";import"./utils-cc08f6dd.js";import"./createProposal-aafa0128.js";import"./trial-7691e47a.js";import"./utils-d7484c67.js";import"./infoCollection-9abada6b.js";import"./core-898274a1.js";const B={class:"bank-info-wrap"},D={class:"footer-button"},G=a({name:"updateBankInfo"});var U=e(a({...G,setup(e){const a=t(!1),G=s(),U=o(),{orderNo:q,isShare:S,tenantId:V,nextPageCode:z}=G.query,F=$(),M=t({schema:[],config:[],formData:[]}),R=t(!!S),H=t(),J=t(),K=()=>{U.back()},Y=()=>{H.value&&H.value.validate(!1).then((e=>{e&&(a.value=!0,F.value.tenantOrderPayInfoList=J,S?(F.value.extInfo.buttonCode=b.UPDATE_BANK_INFO_HOLDER,A(F.value,((e,a)=>{a===g.JUMP_PAGE&&I(e.nextPageCode,G.query)}),G).finally((()=>{a.value=!1}))):(F.value.extInfo.buttonCode=b.UPDATE_BANK_INFO_AGENT,A(F.value,((e,a)=>{a===g.JUMP_PAGE&&((e,a)=>{var t;const{holder:s,insuredList:o}=F.value;let n={name:s.name,gender:`${N[s.gender]}士`};"insured"===e&&(n={name:null==o?void 0:o[0].name,gender:`${N[null==o?void 0:o[0].gender]}士`});const r={...G.query,objectType:e,isShare:1,nextPageCode:"updateBankInfo"};k({shareType:0,title:`${x[a].title}`,desc:x[a].desc.replace("{name}",`${n.name}${n.gender}`),url:`${null==(t=window.location.href.split("?"))?void 0:t[0]}?${C.stringify(r)}`.replace("/updateBankInfo","/phoneVerify"),imageUrl:"https://aquarius-v100-test.oss-cn-hangzhou.aliyuncs.com/MyPicture/asdad.png"})})("holder","pay")}),G).finally((()=>{a.value=!1}))))}))};n((()=>{(async()=>{let e={};h({orderNo:q,tenantId:V}).then((({code:e,data:a})=>{if("10000"===e){J.value=a.tenantOrderPayInfoList;const e=[];a.tenantOrderPayInfoList.forEach(((a,t)=>{`${a.paymentType}`==`${j.NO}`&&(e[t]={paymentType:{isView:!0}})})),M.value.config=e}}));const{code:a,data:t}=await L({orderNo:q,tenantId:V});"10000"===a&&(Object.assign(F.value,t,{extInfo:{...t.extInfo,buttonCode:b.SIGN,pageCode:P.SIGN}}),e=E(t.insuredList[0].productList)),T(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:t}=e,{payInfo:s}=_(t);M.value={...M.value,...s}}}))})()}));const Q=t();return r((()=>{setTimeout((async()=>{Q.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const s=w;return i(),d("div",B,[l(M).schema.length&&l(J)?(i(),c(O,{key:0,ref_key:"payInfoRef",ref:H,modelValue:l(J),"onUpdate:modelValue":t[0]||(t[0]=e=>u(J)?J.value=e:null),schema:l(M).schema,config:l(M).config,"is-view":l(R),"user-data":l(F)},null,8,["modelValue","schema","config","is-view","user-data"])):p("",!0),f("div",D,[m(s,{type:"primary",plain:"",onClick:K},{default:v((()=>[y("取消")])),_:1}),m(s,{disabled:l(a),type:"primary",onClick:Y},{default:v((()=>[y("确认")])),_:1},8,["disabled"])])])}}}),[["__scopeId","data-v-5b7b3078"]]);export{U as default};
