import{aw as e,d as s,r as t,bZ as a,z as o,br as l,R as r,bs as d,i as c,aC as i,aE as u,bq as n,aI as p,$ as v,b_ as h,aL as m,G as g,an as f,c as C,A as y,f as P,g as k,E as b,U as L,V as w,k as x,a6 as _,L as I,a9 as S,a1 as V,b$ as T,o as j,F as $,h as M,w as U,c0 as D,a2 as F,j as N,bA as O,aQ as q,B,bF as H,al as A,am as z,bN as E,aU as R,bP as Y,e as G,bB as Q,bO as W,a as Z,u as J,ac as K,b as X,ao as ee}from"./index-0871b571.js";import{L as se}from"./index-34fad8d8.js";import{S as te}from"./index-a0b272cd.js";import{P as ae}from"./index-db371648.js";import{e as oe}from"./empty-c926d8ec.js";import{P as le,u as re}from"./ProductTips-d2b9b756.js";import{q as de,a as ce}from"./proposalList-666ab8ff.js";import{P as ie}from"./index-c0f291c2.js";import{c as ue}from"./trial-6805e8f6.js";import"./pdfh5-008ca364.js";const[ne,pe,ve]=e("pull-refresh"),he=["pulling","loosing","success"];const me=m(s({name:ne,props:{disabled:Boolean,modelValue:Boolean,headHeight:i(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:u,successDuration:i(500),animationDuration:i(300)},emits:["change","refresh","update:modelValue"],setup(e,{emit:s,slots:i}){let u;const m=t(),g=t(),f=a(m),C=o({status:"normal",distance:0,duration:0}),y=l(),P=()=>{if(50!==e.headHeight)return{height:`${e.headHeight}px`}},k=()=>"loading"!==C.status&&"success"!==C.status&&!e.disabled,b=(t,a)=>{const o=+(e.pullDistance||e.headHeight);C.distance=t,C.status=a?"loading":0===t?"normal":t<o?"pulling":"loosing",s("change",{status:C.status,distance:t})},L=()=>{const{status:s}=C;return"normal"===s?"":e[`${s}Text`]||ve(s)},w=()=>{const{status:e,distance:s}=C;if(i[e])return i[e]({distance:s});const t=[];return he.includes(e)&&t.push(c("div",{class:pe("text")},[L()])),"loading"===e&&t.push(c(n,{class:pe("loading")},{default:L})),t},x=e=>{u=0===h(f.value),u&&(C.duration=0,y.start(e))},_=e=>{k()&&x(e)},I=()=>{u&&y.deltaY.value&&k()&&(C.duration=+e.animationDuration,"loosing"===C.status?(b(+e.headHeight,!0),s("update:modelValue",!0),v((()=>s("refresh")))):b(0))};return r((()=>e.modelValue),(s=>{C.duration=+e.animationDuration,s?b(+e.headHeight,!0):i.success||e.successText?(C.status="success",setTimeout((()=>{b(0)}),+e.successDuration)):b(0,!1)})),d("touchmove",(s=>{if(k()){u||x(s);const{deltaY:t}=y;y.move(s),u&&t.value>=0&&y.isVertical()&&(p(s),b((s=>{const t=+(e.pullDistance||e.headHeight);return s>t&&(s=s<2*t?t+(s-t)/2:1.5*t+(s-2*t)/4),Math.round(s)})(t.value)))}}),{target:g}),()=>{var e;const s={transitionDuration:`${C.duration}ms`,transform:C.distance?`translate3d(0,${C.distance}px, 0)`:""};return c("div",{ref:m,class:pe()},[c("div",{ref:g,class:pe("track"),style:s,onTouchstartPassive:_,onTouchend:I,onTouchcancel:I},[c("div",{class:pe("head"),style:P()},[w()]),null==(e=i.default)?void 0:e.call(i)])])}}}));const ge={class:"com-product-item"},fe={class:"content-wrap"},Ce={class:"product-image"},ye={class:"insure-name"},Pe={class:"product-info"},ke={class:"title"},be={class:"description"},Le={class:"tags"};var we=g(s({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const s=e,{productInfo:t}=f(s),a=o({checked:!1});return f(a),(s,a)=>{var o,l,r,d,i;const u=_;return C(),y("div",ge,[P("div",fe,[P("div",Ce,[c(u,{src:(null==(o=k(t).showConfig)?void 0:o.fileThumbnailUrl)||(null==(l=k(t).showConfig)?void 0:l.fileUrl)},null,8,["src"]),P("p",ye,b((k(t).insurerName||"").substring(0,6)),1)]),P("div",Pe,[P("p",ke,b(null==(r=k(t).showConfig)?void 0:r.title),1),P("p",be,b(null==(d=k(t).showConfig)?void 0:d.text),1),P("p",Le,[(C(!0),y(L,null,w(null==(i=k(t).showConfig)?void 0:i.tags,((e,s)=>(C(),y("span",{key:s,class:"tag"},b(e),1)))),128))])]),x(s.$slots,"checkedProduct",{},void 0,!0)]),c(le,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-d0dbf77c"]]);const xe=["xlink:href"],_e=s({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const s=e,t=I((()=>`#icon-${s.name}`)),a=I((()=>s.name?`svg-icon icon-${s.name}`:"svg-icon"));return(s,o)=>(C(),y("svg",S({class:k(a)},s.$attrs,{style:{color:e.color}}),[P("use",{"xlink:href":k(t)},null,8,xe)],16))}});const Ie=e=>(A("data-v-d36af93a"),e=e(),z(),e),Se={class:"com-tab-filter"},Ve={class:"article-mid"},Te={class:"article-tag"},je=["onClick"],$e=Ie((()=>P("span",null,null,-1))),Me={class:"popup-inner"},Ue=Ie((()=>P("div",{class:"popup-title"},"保险公司",-1))),De={class:"footer-button"};var Fe=g(s({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:s}){const{isPopShow:a,openPop:l,closePop:r}=function(e=!1){const s=t(e);return{isPopShow:s,openPop:e=>{e instanceof Function&&e(),s.value=!0},closePop:e=>{s.value=!1,e instanceof Function&&e()}}}(!1),d=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:u}=f(d),n=t(""),p=()=>{u.value=[]},v=()=>{var e;const{productCategoryId:t}=(null==(e=d.productCategoryList)?void 0:e[n.value])||{};s("onSelectInsure",{selectInsureCode:u.value,selectCategory:t}),r()};return V((()=>{T().then((e=>{const{code:s,data:t}=e;"10000"===s&&(i.value=null==t?void 0:t.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),j((()=>{de().then((e=>{const{code:s,data:t}=e||{};"10000"===s&&q(t)&&(d.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...t])}))})),(t,o)=>{const h=B,m=H;return C(),y("div",Se,[P("div",Ve,[P("div",Te,[(C(!0),y(L,null,w(k(d).productCategoryList,((e,t)=>(C(),y("div",{key:t,class:$(["tag-item",{checked:k(n)==t}]),onClick:a=>((e,t)=>{var a;n.value=t;const{productCategoryId:o}=(null==(a=d.productCategoryList)?void 0:a[n.value])||{};s("onSelectInsure",{selectInsureCode:u.value,selectCategory:o})})(null==e||e.productCategoryId,t)},[P("div",{class:$(["tag-out",{checked:k(n)==t}])},[P("div",{class:$(["tag-item-text",{checked:k(n)==t}])},b(e.productCategoryName),3)],2)],10,je)))),128))]),e.filter?(C(),y("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>k(l)&&k(l)(...e))},[$e,P("div",{class:$(["text",{"has-select-condition":k(u).length>0}])},"筛选",2),c(_e,{name:"filter"})])):M("",!0),c(m,{show:k(a),position:"right","close-on-click-overlay":"",teleport:"body",class:"proposal-list-filter-popup-wrap","overlay-style":{"z-index":5e3},style:O(e.popupStyle||{width:"322px",height:"100%",padding:"0 15px","z-index":5e3}),onClickOverlay:k(r)},{default:U((()=>[P("div",Me,[Ue,c(D,{modelValue:k(u),"onUpdate:modelValue":o[1]||(o[1]=e=>F(u)?u.value=e:null),options:k(i)},null,8,["modelValue","options"])]),P("div",De,[c(h,{plain:"",type:"primary",onClick:p},{default:U((()=>[N("重置")])),_:1}),c(h,{type:"primary",onClick:v},{default:U((()=>[N("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])])])}}}),[["__scopeId","data-v-d36af93a"]]);const Ne={class:"com-trial-product-wrapper"},Oe={class:"container"},qe=(e=>(A("data-v-49f70a68"),e=e(),z(),e))((()=>P("span",{class:"title"}," 已选产品 ",-1))),Be={class:"popup-body"},He={class:"cell-title"},Ae={class:"title"},ze=s({name:"TrialProductPopup"});var Ee=g(s({...ze,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:s}){const a=e,o=t([]),l=t([]),d=t({isShow:a.isShow}),i=()=>{s("close")},u=()=>{l.value=[],s("checked",[])},n=e=>{var t,a,r;null==(r=null==(a=null==(t=null==o?void 0:o.value)?void 0:t[e])?void 0:a.toggle)||r.call(a),s("checked",l.value)};return r((()=>a.isShow),(e=>{d.value.isShow=e})),r(l,((e=[])=>{s("update:modalValue",e)}),{deep:!0,immediate:!0}),r((()=>a.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(s,t)=>{const a=E,r=R,p=W,v=Y,h=H;return C(),y("div",Ne,[c(h,{show:k(d).isShow,"onUpdate:show":t[1]||(t[1]=e=>k(d).isShow=e),position:"bottom",onClose:i},{default:U((()=>[P("div",Oe,[P("div",{class:"popup-header"},[P("span",{class:"clear-all",onClick:u}," 清空选项 "),qe,P("span",{class:"close",onClick:i})]),P("div",Be,[c(v,{modelValue:k(l),"onUpdate:modelValue":t[0]||(t[0]=e=>F(l)?l.value=e:null)},{default:U((()=>[c(p,{inset:""},{default:U((()=>[(C(!0),y(L,null,w(e.proposalList,(e=>(C(),G(r,{key:e.productCode,title:e.productName,onClick:s=>n(e.productCode)},{"right-icon":U((()=>{var s;return[c(a,{ref_for:!0,ref:s=>k(o)[e.productCode]=s,shape:"square","model-value":null==(s=k(l))?void 0:s.includes(e.productCode),name:e.productCode,onClick:Q((s=>n(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:U((()=>[P("div",He,[P("div",Ae,b(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const Re={class:"search-wrap"},Ye={class:"page-proposal-list"},Ge={class:"check-button"},Qe={key:1,class:"van-sticky"},We={class:"add-plan"},Ze={class:"has-select-product"},Je=(e=>(A("data-v-7cdcfd9e"),e=e(),z(),e))((()=>P("span",{class:"icon"},null,-1))),Ke=s({name:"ProposalList"});var Xe=g(s({...Ke,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const s=re(),t=Z(),a=J(),{isCreateProposal:l}=a.query,r=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[]}),{searchValue:d,tagLists:i,isOpen:u,loading:n,finished:p,refreshing:v,productList:h,selectProduct:m,insurerCodeList:g,showCategory:x,productTotal:_,showFooter:S}=f(r);K();const[V,T]=K(),$=()=>{const{excludeProductCodeList:e}=r;ce({title:d.value,insurerCodeList:g.value,showCategory:x.value,excludeProductCodeList:Array.isArray(e)?e:[],pageNum:1,pageSize:999}).then((e=>{const{code:s,data:t,total:a}=e;"10000"===s&&(h.value=null==t?void 0:t.datas,_.value=a)}))},D=e=>{$()},O=e=>{const{selectInsureCode:s,selectCategory:t}=e;g.value=s,x.value=t,$()},q=()=>{v.value&&(h.value=[],v.value=!1),$(),n.value=!1,_.value===h.value.length&&(p.value=!0)},H=()=>{t.push({path:"historyProposalList"})};I((()=>{var e;const{birthday:t,gender:a}=(null==(e=s.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:t,gender:a}}));const A=I((()=>h.value.length>0)),z=({productCode:e})=>l?(r.productCode=e,r.selectProduct.includes(e)?(r.selectProduct=r.selectProduct.filter((s=>s!==e)),!1):void(async(e,t)=>{const{code:a,data:o,message:l}=await ue({...s.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===a?(r.errorMsgMap[e]="","function"==typeof t&&t(!0)):r.errorMsgMap[e]=l})(e,(()=>{r.selectProduct.push(e)}))):(t.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),R=e=>{r.selectProduct=e,r.selectedProductList=r.selectedProductList.filter((s=>e.includes(s.productCode)))},Y=()=>{const e=r.proposalList.filter((e=>r.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));s.setTrialData(e),s.setSelectedProduct(r.selectProduct),t.back()},Q=()=>{p.value=!0,n.value=!0,q()};return j((()=>{r.excludeProductCodeList=s.$state.excludeProduct})),(e,s)=>{const t=te,a=E,o=se,i=me,m=B,g=X("ProPageWrap");return C(),y(L,null,[c(g,{class:"page-proposal"},{default:U((()=>[P("div",Re,[c(t,{modelValue:k(d),"onUpdate:modelValue":s[0]||(s[0]=e=>F(d)?d.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:D},null,8,["modelValue"]),c(Fe,{filter:k(u),"onUpdate:filter":s[1]||(s[1]=e=>F(u)?u.value=e:null),"filter-class":"filter-area",onOnSelectInsure:O},null,8,["filter"])]),k(A)?M("",!0):(C(),G(ae,{key:0,"empty-img":k(oe),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),P("div",Ye,[c(i,{modelValue:k(v),"onUpdate:modelValue":s[3]||(s[3]=e=>F(v)?v.value=e:null),onRefresh:Q},{default:U((()=>[c(o,{loading:k(n),"onUpdate:loading":s[2]||(s[2]=e=>F(n)?n.value=e:null),finished:k(p),"finished-text":k(A)?"- 已经到底了哦 -":"",onLoad:q},{default:U((()=>[(C(!0),y(L,null,w(k(h),(e=>(C(),G(we,{key:e.id,"product-info":e,"error-msg":k(r).errorMsgMap[e.productCode],onClick:s=>z(e)},ee({_:2},[k(l)?{name:"checkedProduct",fn:U((()=>[P("div",Ge,[(C(),G(a,{key:e.id,name:e.productCode,"model-value":k(r).selectProduct.includes(e.productCode),shape:"square",onChange:s=>((e,s)=>{e?r.selectedProductList.push(s):r.selectedProductList=r.selectedProductList.filter((e=>e.productCode!==s.productCode))})(s,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),k(l)&&k(S)?(C(),y("div",Qe,[P("div",We,[P("p",{class:"has-select",onClick:s[4]||(s[4]=e=>k(T)(!k(V)))},[N(" 已选"),P("span",Ze,b(k(r).selectProduct.length),1),N("款产品 "),Je]),c(m,{type:"primary",disabled:!k(r).selectProduct.length,onClick:Y},{default:U((()=>[N("添加计划书")])),_:1},8,["disabled"])])])):M("",!0),c(Ee,{"modal-value":k(r).selectProduct,"proposal-list":k(r).selectedProductList,"is-show":k(V),onClose:s[5]||(s[5]=e=>k(T)(!1)),onChecked:R},null,8,["modal-value","proposal-list","is-show"])])),_:1}),k(l)?M("",!0):(C(),G(ie,{key:0,"button-image":k("/static/png/lishijihuashu-b6958e78.png"),onClick:H},null,8,["button-image"]))],64)}}}),[["__scopeId","data-v-7cdcfd9e"]]);export{Xe as default};
