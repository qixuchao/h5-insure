import{ay as e,d as n,j as a,r as o,E as r,k as t,cb as s,au as i,dM as l,av as c,o as u,c as d,a as f,u as m,b as D,f as I,F as p,e as v,w as Y,q as y,v as k,_ as S,bp as b,ao as M,ar as w,dN as $,aB as V,aC as g,aD as C}from"./index-8eabcead.js";import{I as E,d as L}from"./infoCollection-df32d4f8.js";const N=(n,a="YYYY-MM-DD")=>e(n).format(a),O=(n,a=0,o="day",r="YYYY-MM-DD")=>e(n).add(a,o).format(r),T=(n,a=0,o="day",r="YYYY-MM-DD")=>e(n).subtract(a,o).format(r);const _=e=>(g("data-v-4612f286"),e=e(),C(),e),R={class:"com-period-cell"},h={key:0,class:"period-custom-cell period-check-btn-cell"},U=_((()=>f("div",{class:"period-cell-label"},"保障期间",-1))),P={class:"period-cell-content"},x=_((()=>f("div",{class:"period-cell-label"},"生效日期",-1))),A={class:"period-cell-content period-custom-cell-content"},j=_((()=>f("div",{class:"period-cell-label"},"保障期限",-1))),q={class:"period-cell-content period-custom-cell-content"},F={key:2,class:"period-custom-cell period-common-cell"},H=_((()=>f("div",{class:"period-cell-label"},"保障期限",-1))),B={class:"period-cell-content"},X=_((()=>f("div",{class:"picker-custom-title"},"保险开始生效日期",-1))),z=n({name:"insurancePeriodCell"});var G=S(n({...z,props:{formInfo:{default:()=>({})},riskInfo:{default:()=>({})}},emits:["onReset","onUpdate","onVerify"],setup(n,{expose:S,emit:g}){const C=n;a({});const _=(e,n)=>"year"===e?`${n}年`:"month"===e?`${n}月`:"day"===e?`${n}日`:n,z=a(new Date),G=o({formInfo:C.formInfo}),J=a(!0);a([]),r((()=>G.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(z.value=new Date(e))}));const K=t((()=>{var e;const{insurancePeriodValueList:n=[]}=(null==(e=C.riskInfo)?void 0:e.productRiskInsureLimitVO)||{};return n.length?(G.formInfo.coveragePeriod||(G.formInfo.coveragePeriod=n[0].code),n):[]})),Q=t((()=>{var e;const{insuranceStartType:n}=(null==(e=C.riskInfo)?void 0:e.productRiskInsureLimitVO)||{};return n||1})),W=t((()=>{var e;const{insuranceEndType:n}=(null==(e=C.riskInfo)?void 0:e.productRiskInsureLimitVO)||{};return n||1})),[Z,ee]=s(!1),ne=()=>{J.value&&ee(!0)},ae=t((()=>{var e,n;if(`${Q.value}`===E.CUSTOM_DAY){const a=null==(n=null==(e=C.riskInfo)?void 0:e.productRiskInsureLimitVO)?void 0:n.insuranceStartTime;if(a&&a.indexOf(",")){const[e,n]=a.split(",");return new Date(O(new Date,Number(e),"day"))}}return new Date(O(new Date,1,"day"))})),oe=t((()=>{var e,n;if(`${Q.value}`===E.CUSTOM_DAY){const a=null==(n=null==(e=C.riskInfo)?void 0:e.productRiskInsureLimitVO)?void 0:n.insuranceStartTime;if(!a)return new Date;if(a.indexOf(",")){const[e,n]=a.split(",");return new Date(O(new Date,Number(n),"day"))}const o=O(new Date,Number(a),"day");return new Date(o)}return new Date})),re=e=>{G.formInfo.insuranceStartDate=`${N(e)} 00:00:00`,ee(!1)},te=()=>{ee(!1)};return r((()=>C.riskInfo),(()=>{const{productRiskInsureLimitVO:e}=C.riskInfo||{};if(e){const{insurancePeriodValueList:n,paymentFrequencyList:a=[]}=e||{};K.value=n}}),{deep:!0,immediate:!0}),r([()=>Q.value,()=>G.formInfo.coveragePeriod,()=>G.formInfo.insuranceStartDate,()=>C.riskInfo],(()=>{var n,a,o,r;if(!G.formInfo.coveragePeriod)return;const[t,s]=G.formInfo.coveragePeriod.split("_");if(!G.formInfo.insuranceStartDate)if(`${Q.value}`===E.CUSTOM_DAY){const e=null==(a=null==(n=C.riskInfo)?void 0:n.productRiskInsureLimitVO)?void 0:a.insuranceStartTime;if(e)if(e.indexOf(",")){const[n,a]=e.split(",");G.formInfo.insuranceStartDate=`${O(new Date,Number(n),"day")} 00:00:00`,console.log("start",n,a),J.value=n!==a}else G.formInfo.insuranceStartDate=`${O(new Date,e,"day")} 00:00:00`;else G.formInfo.insuranceStartDate=`${O(new Date,1,"day")} 00:00:00`}else`${Q.value}`===E.NEXT_DAY?G.formInfo.insuranceStartDate=`${O(new Date,1,"day")} 00:00:00`:G.formInfo.insuranceStartDate=`${N(new Date)} 00:00:00`;if("to"!==t)T(G.formInfo.insuranceStartDate,1,"day"),`${W.value}`===L.CURRENT_DAY?G.formInfo.insuranceEndDate=`${e(G.formInfo.insuranceStartDate).add(Number(s),t).subtract(1,"day").format("YYYY-MM-DD")} 23:59:59`:G.formInfo.insuranceEndDate=`${O(G.formInfo.insuranceStartDate,Number(s),t)} 00:00:00`;else{let e=null==(r=null==(o=G.formInfo.insuredList)?void 0:o[0])?void 0:r.birthday;G.formInfo.insuredList[0].certType===i.CERT&&G.formInfo.insuredList[0].certNo&&l(G.formInfo.insuredList[0].certNo)&&(e=c(G.formInfo.insuredList[0].certNo));const n=`${T(e,1,"day")} 00:00:00`;"single"===s&&(G.formInfo.insuranceEndDate="9999-99-99 23:59:59"),`${W.value}`===L.CURRENT_DAY?G.formInfo.insuranceEndDate=`${O(n,Number(s),t)} 23:59:59`:G.formInfo.insuranceEndDate=`${O(e,Number(s),t)} 00:00:00`}}),{immediate:!0,deep:!0}),S({}),(e,n)=>{const a=b,o=M,r=w,t=$,s=V;return u(),d(p,null,[f("div",R,[m(K).length>1?(u(),d("div",h,[U,f("div",P,[D(a,{modelValue:m(G).formInfo.coveragePeriod,"onUpdate:modelValue":n[0]||(n[0]=e=>m(G).formInfo.coveragePeriod=e),prop:{label:"value",value:"code"},options:m(K)},null,8,["modelValue","options"])])])):I("",!0),m(Q)+""===m(E).CUSTOM_DAY?(u(),d("div",{key:1,class:"period-custom-cell period-common-cell",onClick:ne},[m(J)?(u(),d(p,{key:0},[x,f("div",A,[f("span",null,v(m(G).formInfo.insuranceStartDate?m(N)(m(G).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),D(o,{class:"custom--arrow-right",name:"arrow-right"})])],64)):(u(),d(p,{key:1},[j,f("div",q,[f("span",null,v(m(G).formInfo.insuranceStartDate?m(N)(m(G).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+v(m(G).formInfo.insuranceEndDate?m(N)(m(G).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])],64))])):I("",!0),m(Q)+""!==m(E).CUSTOM_DAY?(u(),d("div",F,[H,f("div",B,v(m(G).formInfo.insuranceStartDate?m(N)(m(G).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+v(m(G).formInfo.insuranceEndDate?m(N)(m(G).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):I("",!0)]),D(s,{show:m(Z),"onUpdate:show":n[3]||(n[3]=e=>y(Z)?Z.value=e:null),height:340,closeable:!0},{default:Y((()=>[D(t,{modelValue:m(z),"onUpdate:modelValue":n[2]||(n[2]=e=>y(z)?z.value=e:null),type:"date",title:"保险开始生效日期","min-date":m(ae),"max-date":m(oe),formatter:_,"visible-item-count":5,class:"custom-date-picker",onConfirm:re,onCancel:te},{cancel:Y((()=>[])),title:Y((()=>[X])),confirm:Y((()=>[D(r,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:n[1]||(n[1]=e=>Z.value=!1)},{default:Y((()=>[k("确 定")])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-4612f286"]]);export{G as I};
