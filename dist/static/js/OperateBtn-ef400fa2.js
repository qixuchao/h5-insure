import{d as e,h as a,i as r,k as o,ag as t,o as s,c as n,u as d,m as i,w as l,a8 as c,cH as p,f as u,_ as m,a6 as h,bX as f,aH as y,cq as C,cr as g,cs as I}from"./index-26f63535.js";import{P as N,M as S}from"./constants-4b08cf92.js";import{c as k}from"./order-23ec5443.js";const $={class:"operate-wrap"},v=e({name:"operateBtn"});var x=m(e({...v,props:{detail:{default:()=>({})}},emits:["handleCancel"],setup(e,{emit:m}){const v=e,x=a(),T=r(),{tenantId:_,nextPageCode:q,isShare:P}=T.query,w=o((()=>{const{orderTopStatus:e,productClassFlag:a,orderStatus:r}=v.detail;return"-1"===e&&N.orderList===T.path&&!("underWritingFailed"===r&&a===h.YES)})),z=o((()=>{const{policyNo:e,applicationNo:a,orderStatus:r}=v.detail;return!e&&a&&"cancel"!==r})),D=o((()=>{const{orderStatus:e}=v.detail;return["offlinePayment","manualUnderWriting","paymentFailed"].includes(e)})),b=()=>{const{orderStatus:e,orderNo:a,insurerCode:r}=v.detail;let o=N.sign;"collectInfo"===e&&(o=N.infoCollection),f({messageType:S.AGENT,orderNo:a,tenantId:_}).then((({code:e})=>{"10000"===e&&x.push({path:o,query:{...T.query,tenantId:_,orderNo:a,insurerCode:r}})}))},j=()=>{const{orderNo:e,orderId:a}=v.detail;P?y.confirm({message:"撤单后将无法恢复，请您确认是否撤销本次投保"}).then((()=>{m("handleCancel")})):k({tenantId:_,orderNo:e,type:1}).then((({code:e,data:a})=>{"10000"===e&&y.confirm({message:"确认取消当前订单？"}).then((()=>{(e=>{const{holderName:a,holderGender:r,orderId:o,orderNo:t,insurerCode:s}=v.detail||{},n=a,d=`${C[r]}士`;g({shareType:0,title:`${I.cancel.title}`,desc:I.cancel.desc.replace("{name}",`${n}${d},`),url:`${window.location.href}&objectType=${e}&insurerCode=${s}&isShare=1&orderNo=${t}&orderId=${o}&nextPageCode=orderDetail`.replace(/\/orderDetail|\/order/,"/baseInsurance/long/phoneVerify"),imageUrl:"https://zatech-aquarius-v2-private-test.oss-cn-hangzhou.aliyuncs.com/lian_logo.png?OSSAccessKeyId=LTAI5t9uBW78vZ4sm5i3oQ5C&Expires=1697288114&Signature=S87PMeDRxltLovmmHVTeiHoew1c%3D"})})("holder")}))}))},H=()=>{const{orderNo:e,orderId:a,insurerCode:r}=v.detail;x.push({path:N.updateBankInfo,query:{tenantId:_,orderNo:e,orderId:a,insurerCode:r,nextPageCode:"orderDetail"}})};return(e,a)=>{const r=t;return s(),n("div",$,[d(w)?(s(),i(r,{key:0,type:"primary",size:"small",onClick:p(b,["stop"])},{default:l((()=>[c("去处理")])),_:1},8,["onClick"])):u("",!0),d(z)?(s(),i(r,{key:1,type:"primary",plain:"",size:"small",onClick:p(j,["stop"])},{default:l((()=>[c("撤单")])),_:1},8,["onClick"])):u("",!0),d(D)?(s(),i(r,{key:2,plain:"",size:"small",onClick:p(H,["stop"])},{default:l((()=>[c("银行卡修改")])),_:1},8,["onClick"])):u("",!0)])}}}),[["__scopeId","data-v-4af2f99e"]]);export{x as O};
