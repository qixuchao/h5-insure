import{d as e,h as t,aR as a,o as s,c as o,a as l,e as d,u as n,cF as r,b as i,ah as c,a8 as u,cW as p,w as v,as as m,bL as g,n as y,s as f,_ as I,ap as b,aq as C,av as h,T as N,az as k,cX as _,b_ as D,i as S,k as Y,l as L,z as U,O as x,aL as T,p as j,cC as P,f as W,F as B}from"./index-dc5ec44c.js";import{_ as E}from"./index-661fbf7f.js";import{L as G}from"./index-d2b11f4e.js";import{d as R,g as q}from"./order-31582c51.js";import{I as w}from"./infoItem-78cb91d5.js";import"./empty-ae586b6c.js";const A={class:"com-order-item"},z={class:"header"},F={class:"product-name"},H={class:"status"},M={class:"info"},O={class:"info-bottom"},X=(e=>(b("data-v-1c14f236"),e=e(),C(),e))((()=>l("div",{style:{width:"25%"}},[l("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),Z={class:"footer"},J={class:"fee"},K={class:"money"},Q={key:0,class:"buttons"},V={key:1,class:"buttons"},$={key:2,class:"buttons"};var ee=I(e({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:I}){const b=e,C=t(),D=()=>{h.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{R(b.detail.id,b.detail.orderStatus).then((e=>{const{code:t,data:a}=e;"10000"===t&&(N.success("删除成功"),I("afterDelete"))}))}))},S=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderTopStatus:c}=b.detail;if((p.PENDING===c||p.PAYING===c)&&[_.ZXYS,_.BWYL,_.BWYLUP].includes(e)){const a={[_.ZXYS]:"/internet/productDetail/package",[_.BWYL]:"/internet/productDetail",[_.BWYLUP]:"/internet/guaranteeUpgrade"};return C.push({path:a[e],query:{productCode:e,saleChannelId:i,agentCode:s,tenantId:l,agencyCode:r,orderNo:t}}),!0}return!1},Y=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r}=b.detail;S()||C.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyCode:r}})};return(t,I)=>{const C=a;return s(),o("div",A,[l("div",z,[l("div",F,d(e.detail.productName),1),l("div",H,d(n(r)[e.detail.orderStatus]),1)]),l("div",M,[i(w,{label:"订单号",content:e.detail.policyHolder,line:"","is-copy":""},null,8,["content"]),i(w,{label:"投保单号",content:e.detail.applicationNo,line:"","is-copy":""},null,8,["content"]),i(w,{label:"保单号",content:e.detail.policyNo,line:"","is-copy":""},null,8,["content"]),l("div",O,[l("div",null,[i(w,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),i(w,{label:"被保人",content:e.detail.insuredName,line:""},null,8,["content"]),i(w,{label:"创建时间",content:n(c)(e.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss"),line:""},null,8,["content"])]),X])]),l("div",Z,[l("div",J,[u(" 保费："),l("span",K,"￥"+d(e.detail.premium),1)]),e.detail.orderTopStatus===n(p).PENDING?(s(),o("div",Q,[i(C,{class:"button",onClick:m(D,["stop"])},{default:v((()=>[u("删除")])),_:1},8,["onClick"]),n(g).UNDERWRITING_FAILED!==e.detail.orderStatus?(s(),y(C,{key:0,class:"button primary",onClick:I[0]||(I[0]=m((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderStatus:c,abbreviation:u}=b.detail;S()||k("orderDetail",{orderNo:t,agentCode:s,tenantId:l,abbreviation:u,productCategory:n})})()),["stop"]))},{default:v((()=>[u("去处理")])),_:1})):f("",!0)])):f("",!0),e.detail.orderTopStatus===n(p).PAYING?(s(),o("div",V,[i(C,{class:"button primary",onClick:m(Y,["stop"])},{default:v((()=>[u("去支付")])),_:1},8,["onClick"])])):f("",!0),e.detail.orderTopStatus===n(p).TIMEOUT?(s(),o("div",$,[i(C,{class:"button",onClick:m(D,["stop"])},{default:v((()=>[u("删除")])),_:1},8,["onClick"])])):f("",!0)])])}}}),[["__scopeId","data-v-1c14f236"]]);const te={class:"page-order"},ae={key:0,class:"order-head"},se={class:"order-head-num"},oe={style:{"margin-left":"27px"},class:"order-head-num"},le={style:{"margin-left":"36px"},class:"order-head-num"},de={key:2,class:"empty-box"},ne=(e=>(b("data-v-7ae44c57"),e=e(),C(),e))((()=>l("div",{class:"footer"},[l("img",{src:"/static/png/logo-b728275d.png",alt:"",style:{width:"100%",height:"128px"}})],-1)));var re=I(e({__name:"index",setup(e){const a=D();t();const r=S().query,c=Y({"-1":1,0:2,1:3,2:4}[r.type]||0),p=Y(1),m=Y(!1),g=Y(!1),I=Y([]),b=Y(0),C=Y(0),h=Y(0),_=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],R=L((()=>(I.value=[],_[c.value].status))),w=()=>{N.loading({message:"加载中...",forbidClick:!0}),m.value=!0,q({condition:{orderTopStatus:R.value},pageSize:10,pageNum:p.value}).then((e=>{var t;m.value=!1;const{code:a,data:s}=e;"10000"===a&&s&&(1===p.value?(I.value=s.datas[0].applicationResList||[],b.value=s.datas[0].invalidNum,C.value=s.datas[0].totalNum,h.value=s.datas[0].validNum):I.value=[...I.value,...(null==(t=s.datas[0])?void 0:t.applicationResList)||[]]),g.value=!s||I.value.length>=(null==s?void 0:s.total)})).then((()=>{N.clear()}))},A=()=>{p.value+=1,w()},z=()=>{p.value=1,w()};return U(R,(()=>{p.value=1,w()})),x((()=>{w()})),(e,t)=>{const r=G,p=E,N=T;return s(),y(N,{"theme-vars":n(a)},{default:v((()=>[l("div",te,[i(P,{active:n(c),"onUpdate:active":t[0]||(t[0]=e=>j(c)?c.value=e:null),list:_,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),n(I).length?(s(),o("div",ae,[u(" 共 "),l("span",se,d(n(C)),1),u(" 张保单 "),l("span",oe,d(n(h)),1),u(" 张有效 "),l("span",le,d(n(b)),1),u(" 张失效 ")])):f("",!0),n(I).length?(s(),y(r,{key:1,class:"body",loading:n(m),finished:n(g),onLoad:A},{default:v((()=>[(s(!0),o(B,null,W(n(I),((e,t)=>(s(),y(ee,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n}=e;k("orderDetail",{orderNo:t,agentCode:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n})})(e),onAfterDelete:z},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])):(s(),o("div",de,[i(p,{title:"暂无投保单","empty-class":"empty-select"})])),ne])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-7ae44c57"]]);export{re as default};
