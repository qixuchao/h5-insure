var Z=Object.defineProperty,ee=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var M=(a,t,o)=>t in a?Z(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,g=(a,t)=>{for(var o in t||(t={}))ae.call(t,o)&&M(a,o,t[o]);if(L)for(var o of L(t))te.call(t,o)&&M(a,o,t[o]);return a},x=(a,t)=>ee(a,ue(t));import{g as oe,L as le,a0 as se,Q as ne,v as ie,ab as ce,C as w,m as _,n as c,j as s,z as v,G as K,d as Y,T as f,D as re,r as p,a5 as ve,k as y,y as B,I as q,a6 as V,a2 as me,a3 as de,B as D}from"./vendor-e9263418.js";import{i as pe,j as _e}from"./customer-13670369.js";import{u as k}from"./useCheckBack-f80d3d5c.js";import{u as fe}from"./index-b8742a0a.js";import{_ as ye}from"./plugin-vue_export-helper-46f75680.js";const A=a=>(me("data-v-79085360"),a=a(),de(),a),Fe={class:"doc-add"},Ce=A(()=>B("span",{class:"label"},"\u8BC1\u4EF6\u7C7B\u578B",-1)),Be=D(),De=A(()=>B("span",{class:"star"},"*",-1)),he={class:"value"},ke=D(" \u8BC1\u4EF6\u53F7\u7801"),Ee=A(()=>B("span",{class:"star"},"*",-1)),be=["src"],Te={key:0,class:"value"},ge={key:1,class:"cell-val"},xe={class:"cheack-val"},we=D("\u957F\u671F\u6709\u6548"),Ye={key:0,class:"footer"},qe=D("\u5220\u9664"),Ve=D("\u4FDD\u5B58"),Ae={key:1,class:"footer"},$e=D("\u4FDD\u5B58"),Ne=oe({setup(a){const{getIconUrl:t}=fe(),o=le({certNo:"",effectiveTime:"",expiryTime:"",forever:"",isLongTerm:!1,name:{label:"\u8EAB\u4EFD\u8BC1",value:"01"},primaryKey:""}),$=se(),n=ne();console.log(">>>>route",n.query),k(o);const U=[{name:"\u8EAB\u4EFD\u8BC1",value:"01"},{name:"\u62A4\u7167",value:"07"},{name:"\u519B\u5B98\u8BC1",value:"04"},{name:"\u6E2F\u6FB3\u901A\u884C\u8BC1",value:"09"},{name:"\u53F0\u6E7E\u901A\u884C\u8BC1",value:"11"},{name:"\u51FA\u751F\u8BC1",value:"12"},{name:"\u5176\u4ED6",value:"99"}],{name:m,certNo:r,effectiveTime:d,expiryTime:i,isLongTerm:F}=ie(o);ce(()=>{r.value=n.query.certNo,F.value=n.query.isLongTerm==="Y",d.value=n.query.effectiveTime?Y(`${n.query.effectiveTime}`).format("YYYY-MM-DD"):"",i.value=n.query.expiryTime?`${n.query.expiryTime}`:"",k(o)});const C=w(0),E=w(!1),N=w(!1),b=u=>{N.value||(C.value=u)},R=u=>{C.value===1?d.value=Y(u).format("YYYY-MM-DD"):C.value===2&&(i.value=Y(u).format("YYYY-MM-DD")),C.value=0},j=u=>{console.log(u),m.value.label=u.name,m.value.value=u.value},z=u=>{const e=document.createElement("input");document.body.appendChild(e),e.setAttribute("value",u),e.select(),document.execCommand("copy")&&(document.execCommand("copy"),f("\u5DF2\u590D\u5236")),document.body.removeChild(e)},G=u=>{N.value=u,u&&(i.value="\u81F3\u957F\u671F\u6709\u6548"),F.value=u},S=async()=>{const u=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,e=/^[0-9]*$/;if(!m.value.label||!r.value){f("\u8BF7\u8F93\u5165\u8BC1\u4EF6\u53F7\u7801");return}if(console.log(">>>>>>",u.test(r.value)),m.value.value==="01"){if(!u.test(r.value)){f("\u8BC1\u4EF6\u53F7\u7801\u6709\u8BEF\uFF0C\u8BF7\u91CD\u65B0\u8F93\u5165");return}}else if(!e.test(r.value)){f("\u8BC1\u4EF6\u53F7\u683C\u5F0F\u4E0D\u6B63\u786E");return}if(console.log(d.value,i.value,1),d.value>=i.value){f("\u6709\u6548\u6B62\u671F\u65E5\u671F\u9700\u665A\u4E8E\u6709\u6548\u8D77\u671F");return}(await pe(x(g({},n.query),{certificate:{certNo:r.value,certType:m.value.value,effectiveTime:d.value,expiryTime:i.value,isLongTerm:F.value?"Y":"N",name:m.value.label,primaryKey:n.query.primaryKey}}))).data.status===200&&(k(),f("\u4FDD\u5B58\u6210\u529F\uFF01"),$.back())},Q=async()=>{re.confirm({title:"\u63D0\u793A",message:"\u60A8\u786E\u8BA4\u8981\u5220\u9664\u8BC1\u4EF6\u4FE1\u606F\u5417?"}).then(async()=>{await _e(x(g({},n.query),{certificate:{certNo:r.value,certType:m.value.value,effectiveTime:d.value,expiryTime:i.value,isLongTerm:"string",name:m.value.label,primaryKey:n.query.primaryKey}})),f("\u5220\u9664\u6210\u529F").$nextTick(()=>{k(),$.back()})})};return(u,e)=>{const h=p("van-cell"),X=p("van-field"),H=p("van-checkbox"),J=p("van-action-sheet"),O=p("van-datetime-picker"),P=p("van-popup"),W=p("van-cell-group"),T=p("van-button"),I=ve("resize");return y(),_("div",Fe,[c(W,{inset:""},{default:s(()=>[c(h,{"is-link":"",onClick:e[0]||(e[0]=l=>E.value=!0)},{title:s(()=>[Ce,Be,De]),value:s(()=>[B("span",he,q(v(m).label),1)]),_:1}),c(X,{modelValue:v(r),"onUpdate:modelValue":e[2]||(e[2]=l=>V(r)?r.value=l:null),"label-class":"labe","input-align":"right",placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4EF6\u53F7\u7801"},{label:s(()=>[ke,Ee]),"right-icon":s(()=>[B("img",{src:v(t)("customer.copy"),class:"copy",onClick:e[1]||(e[1]=l=>z(v(r)))},null,8,be)]),_:1},8,["modelValue"]),c(h,{"title-class":"label",title:"\u6709\u6548\u8D77\u671F",onClick:e[3]||(e[3]=l=>b(1))},{value:s(()=>[v(d)?(y(),_("span",Te,q(v(d)),1)):(y(),_("span",ge," \u8BF7\u8F93\u5165\u6709\u6548\u8D77\u671F"))]),_:1}),c(h,{modelValue:v(i),"onUpdate:modelValue":e[7]||(e[7]=l=>V(i)?i.value=l:null),title:"\u6709\u6548\u6B62\u671F","title-class":"label"},{value:s(()=>[v(i)?(y(),_("span",{key:0,class:"value",onClick:e[4]||(e[4]=l=>b(2))},q(v(i)),1)):(y(),_("span",{key:1,class:"cell-val",onClick:e[5]||(e[5]=l=>b(2))},"\u8BF7\u8F93\u5165\u6709\u6548\u6B62\u671F"))]),"right-icon":s(()=>[B("span",xe,[c(H,{modelValue:v(F),"onUpdate:modelValue":e[6]||(e[6]=l=>V(F)?F.value=l:null),name:"1",onChange:G},{default:s(()=>[we]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"]),c(J,{show:E.value,"onUpdate:show":e[8]||(e[8]=l=>E.value=l),actions:U,"close-on-click-action":"","cancel-text":"\u53D6\u6D88",onSelect:j},null,8,["show"]),c(P,{show:C.value>0,position:"bottom",style:{height:"40%"}},{default:s(()=>[c(O,{type:"date",title:"\u9009\u62E9\u5E74\u6708\u65E5","min-date":new Date(1900,0,1),"max-date":new Date(2050,10,1),onConfirm:R,onCancel:e[9]||(e[9]=l=>C.value=0)},null,8,["min-date","max-date"])]),_:1},8,["show"])]),_:1}),v(n).query.certNo?K((y(),_("div",Ye,[c(T,{plain:"",type:"primary",class:"btn1",onClick:Q},{default:s(()=>[qe]),_:1}),c(T,{type:"primary",class:"btn",onClick:S},{default:s(()=>[Ve]),_:1})])),[[I]]):K((y(),_("div",Ae,[c(T,{type:"primary",class:"btn-enable",onClick:S},{default:s(()=>[$e]),_:1})])),[[I]])])}}});var Re=ye(Ne,[["__scopeId","data-v-79085360"]]);export{Re as default};
