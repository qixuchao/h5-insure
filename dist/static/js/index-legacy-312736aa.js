!function(){var e=document.createElement("style");e.innerHTML=".page-activity-invite{background:linear-gradient(180deg,#fea64a 0%,#fc7429 88%,#fc6d24 100%)}.page-activity-invite .logo{width:50%;margin:.4rem;position:absolute}.page-activity-invite .container{position:absolute;width:100%;bottom:.8rem;padding:.26667rem}.page-activity-invite .container .title{margin:auto;margin-top:-1.6rem;width:calc(100% - .8rem)}.page-activity-invite .container .title img{width:100%}.page-activity-invite .container .main-form{background:url(/static/assets/bg.c7f48ab0.png) no-repeat;background-size:100% 100%;position:relative;padding:1.33333rem 0 .6rem}.page-activity-invite .container .main-form .sms-code{width:2rem;text-align:center;font-size:.4rem;font-weight:500;color:#ff6d23;padding:0;white-space:nowrap}.page-activity-invite .container .main-form .submit{height:1.33333rem;margin-top:.53333rem;margin-bottom:.46667rem;background:url(/static/assets/button.4c281a6e.png) no-repeat;background-size:contain;background-position:center;border:none}.page-activity-invite .container .main-form .agree{padding:0 .33333rem;font-size:.37333rem;font-weight:400;color:#666;display:flex;align-items:flex-start}.page-activity-invite .container .main-form .van-cell .van-field__value{align-items:flex-start}.page-activity-invite .container .main-form .van-checkbox{width:1.33333rem}.page-activity-invite .container .main-form .pdf-viewer .title{color:#ff6d23}.page-activity-invite .container .main-form .van-checkbox__icon--checked .van-icon{background-color:#ff6d23;border-color:#ff6d23}\n",document.head.appendChild(e),System.register(["./vendor-legacy-1e86c4b9.js","./infoCollection-legacy-f3c4910f.js","./phoneVerify-legacy-9fb97b1c.js","./validator-legacy-efb74b7c.js","./index-legacy-5a15f51e.js","./trial-legacy-607b283d.js","./product-legacy-d6f5a2da.js","./logo-legacy-6244d35f.js","./blank-legacy-3a1efa43.js","./trial-legacy-47721fe0.js"],(function(e){"use strict";var a,t,n,o,l,i,r,c,s,u,d,m,f,v,g,p,b,y,h,k,I,V,w,C,N,x,j,_,L,O,U,F,P,q,z;return{setters:[function(e){a=e.g,t=e.E,n=e.M,o=e._,l=e.r,i=e.j,r=e.k,c=e.m,s=e.p,u=e.A,d=e.z,m=e.J,f=e.L,v=e.n,g=e.G,p=e.F,b=e.C,y=e.T,h=e.O,k=e.a9,I=e.h},function(e){V=e.a},function(e){w=e.s,C=e.c},function(e){N=e.v,x=e.a},function(e){j=e.a3},function(e){_=e.g,L=e.m,O=e.i},function(e){U=e.p},function(e){F=e.g,P=e.l,q=e.a},function(e){z=e.b},function(){}],execute:function(){const E={class:"agree"},D=b(" 我已阅读并同意 "),H=a({props:{info:{type:Object,default:()=>{}}},emits:["on-verify"],setup(e,{emit:a}){var b,h;const k=e,I=t({}),V=t(0),x=t("获取验证码"),j=/^\d{6}$/,_=n({mobile:null===(b=k.info)||void 0===b||null===(h=b.userInfo)||void 0===h?void 0:h.mobile,smsCode:"",agree:""}),L=e=>!!N(_.mobile)||"请输入正确的手机号",O=async()=>{V.value>0||null==I||I.value.validate("mobile").then((async()=>{const e=await w(_.mobile),{code:a,data:t}=e;"10000"===a&&(y({message:"短信发送成功，请查收"}),(()=>{if(V.value>0)return;V.value=30;const e=()=>{x.value=`${V.value}s`,V.value-=1};e();const a=setInterval((()=>{0===V.value?(x.value="获取验证码",V.value=0,clearInterval(a)):e()}),1e3)})())}))},U=async()=>{const e=await C(_.mobile,_.smsCode),{data:t}=e;t&&a("on-verify",_)},F=async()=>{null==I||I.value.validate().then((async()=>{U()}))};return o((()=>_),(()=>{N(_.mobile)&&j.test(_.smsCode)&&U()}),{deep:!0,immediate:!0}),(e,a)=>{const t=l("van-field"),n=l("van-cell-group"),o=l("van-checkbox"),b=l("ProPDFviewer"),y=l("VanForm");return i(),r(y,{ref_key:"formRef",ref:I,"label-width":"60"},{default:c((()=>{var e;return[s(n,null,{default:c((()=>[s(t,{modelValue:u(_).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>u(_).mobile=e),name:"mobile",label:"手机号",clearable:"",placeholder:"请输入手机号",maxlength:"11",rules:[{validator:L}]},null,8,["modelValue","rules"]),s(t,{modelValue:u(_).smsCode,"onUpdate:modelValue":a[1]||(a[1]=e=>u(_).smsCode=e),name:"smsCode",label:"验证码",clearable:"",placeholder:"请输入验证码",maxlength:"6",rules:[{pattern:j,message:"请输入正确的验证码"}]},{button:c((()=>[d("div",{class:f(["sms-code",{"count-down":V.value>0}]),onClick:O},m(x.value),3)])),_:1},8,["modelValue","rules"])])),_:1}),d("div",{class:"submit",onClick:F}),d("div",E,[s(o,{modelValue:u(_).agree,"onUpdate:modelValue":a[2]||(a[2]=e=>u(_).agree=e),name:"agree",shape:"square"},null,8,["modelValue"]),d("div",null,[D,(i(!0),v(p,null,g((null===(e=k.info)||void 0===e?void 0:e.attachmentList)||[],((e,a)=>(i(),r(b,{key:a,class:"file-name",title:`《${e.attachmentName}》`,content:e.attachmentUrl,type:"pdf"},null,8,["title","content"])))),128))])])]})),_:1},512)}}}),S={class:"agree"},T=b(" 我已阅读并同意 "),$=a({props:{info:{type:Object,default:()=>{}}},emits:["on-submit"],setup(e,{emit:a}){const o=e,m=t({}),f=n({name:o.info.userInfo.name,certNo:o.info.userInfo.certNo,agree:""}),b=e=>!!j(f.certNo)||"请填写正确的证件号",h=e=>!!x(e)||"请输入正确的姓名",k=()=>{null==m||m.value.validate().then((async e=>{f.agree?a("on-submit",f):y("请勾选协议")}))};return(e,a)=>{const t=l("van-field"),n=l("van-cell-group"),y=l("van-checkbox"),I=l("ProPDFviewer"),V=l("VanForm");return i(),r(V,{ref_key:"formRef",ref:m,"label-width":"60"},{default:c((()=>{var e;return[s(n,null,{default:c((()=>[s(t,{modelValue:u(f).name,"onUpdate:modelValue":a[0]||(a[0]=e=>u(f).name=e),name:"name",label:"姓名",clearable:"",placeholder:"请输入姓名",rules:[{validator:h}]},null,8,["modelValue","rules"]),s(t,{modelValue:u(f).certNo,"onUpdate:modelValue":a[1]||(a[1]=e=>u(f).certNo=e),name:"certNo",label:"身份证",clearable:"",placeholder:"请输入身份证号",rules:[{validator:b}]},null,8,["modelValue","rules"])])),_:1}),d("div",{class:"submit",onClick:k}),d("div",S,[s(y,{modelValue:u(f).agree,"onUpdate:modelValue":a[2]||(a[2]=e=>u(f).agree=e),name:"agree",shape:"square"},null,8,["modelValue"]),d("div",null,[T,(i(!0),v(p,null,g((null===(e=o.info)||void 0===e?void 0:e.attachmentList)||[],((e,a)=>(i(),r(I,{key:a,class:"file-name",title:`《${e.attachmentName}》`,content:e.attachmentUrl,type:"pdf"},null,8,["title","content"])))),128))])])]})),_:1},512)}}});const R={class:"page-activity-invite"},A=["src"],J=["src"],M={class:"container"},B={class:"main-form"},G={class:"title"},W=["src"];e("default",a({setup(e){const a=h(),o=k(),{productCode:l="7X9",tenantId:c="",extInfo:s}=a.query,m=F(s),f=t(!0),g=n({title:"/static/assets/title-step1.97cb9efa.png",attachmentList:[{}],userInfo:{mobile:m.phoneNo,certNo:"",name:""}}),p=t(),b=t(),w=async e=>{g.userInfo.mobile=e.mobile;const a=await _({holderPhone:g.userInfo.mobile,productCode:l,tenantId:c}),{code:t,data:n}=a;var o,i;"10000"===t&&(g.userInfo.name=null===(o=n.tenantOrderHolder)||void 0===o?void 0:o.name,g.userInfo.certNo=null===(i=n.tenantOrderHolder)||void 0===i?void 0:i.certNo);g.title="/static/assets/title-step2.258af5e9.png",f.value=!1},C=async e=>{try{y({message:"领取中...",forbidClick:!0,loadingType:"spinner"}),g.userInfo.certNo=e.certNo,g.userInfo.name=e.name;const t=q({tenantId:c,detail:p.value,...m,holder:g.userInfo,insured:{...g.userInfo,relationToHolder:V.SELF}}),n=await L(t),{code:l}=n;"10000"===l&&o.push({path:"/chuangxin/baigebao/productDetail",query:{...a.query,tenantId:c,productCode:"BWYL2021",extInfo:JSON.stringify({...m,phoneNo:g.userInfo.mobile,certNo:g.userInfo.certNo,name:g.userInfo.name})}}),y.clear()}catch(t){y.clear()}},N=async()=>{const e=U({productCode:l,withInsureInfo:!0}),a=O({productCode:l});Promise.all([e,a]).then((([e,a])=>{"10000"===e.code&&(p.value=e.data),"10000"===a.code&&(b.value=a.data,g.attachmentList=(()=>{let e=[];return b.value.productRiskVoList.forEach((a=>{a.riskDetailVOList.forEach((a=>{e=e.concat(a.riskAttachmentVOList)}))})),e})())}))};return I((()=>{N()})),(e,a)=>(i(),v("div",R,[d("img",{class:"logo",src:u(P)},null,8,A),d("img",{src:u(z)},null,8,J),d("div",M,[d("div",B,[d("div",G,[d("img",{src:u(g).title},null,8,W)]),f.value?(i(),r(H,{key:0,info:u(g),onOnVerify:w},null,8,["info"])):(i(),r($,{key:1,info:u(g),onOnSubmit:C},null,8,["info"]))])])]))}}))}}}))}();
