import{m as e,t as a,C as t,E as o,N as l,F as n,z as s,a6 as r,a7 as d,ab as i,u,r as c,o as v,s as p,v as m,x as f,U as I,T as h}from"./vendor-533c215b.js";import{j as w}from"./infoCollection-eaaba949.js";import{_ as b,a4 as y}from"./index-b8acfffb.js";import{c as g}from"./close-bad1ffb4.js";import{_ as C}from"./index-d13eefbd.js";import{a as N}from"./order-992b269f.js";import{d as U,i as O,g as $,s as x,e as S,E as j}from"./trial-c55fec63.js";import{t as k}from"./theme-3c294048.js";import{n as D,i as L,m as _,e as P,a as R,t as V,j as B,f as z,h as F}from"./utils-36a3bd7f.js";import{p as E}from"./product-5f01c48c.js";import"./trial-fb34b809.js";const H={class:"com-field-info"},J={class:"title"},T={class:"desc"};var q=b(e({props:{title:{type:String,default:""},desc:{type:String,default:""}},setup:e=>(n,s)=>(a(),t("div",H,[o("div",J,l(e.title),1),o("div",T,l(e.desc),1)]))}),[["__scopeId","data-v-26c796cf"]]);const K=e=>(r("data-v-fa9670a0"),e=e(),d(),e),M={key:0,class:"pro-modal"},G=K((()=>o("div",{class:"pro-overlay"},null,-1))),W={class:"pro-modal-wrapper"},Y=K((()=>o("div",{class:"pro-modal-content"},[o("p",null,"恭喜您"),o("p",null,"保障升级成功")],-1))),A=["src"];var Q=b(e({props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(e,{emit:l}){const r=e,d=()=>{l("on-close")},i=()=>{l("on-confirm")};return(e,l)=>r.isShow?(a(),t("div",M,[G,o("div",W,[o("div",{class:"pro-modal-body"},[Y,o("div",{class:"pro-modal-btn",onClick:i},"我知道了")]),o("div",{class:"pro-modal-close",onClick:d},[o("img",{src:n(g)},null,8,A)])])])):s("",!0)}}),[["__scopeId","data-v-fa9670a0"]]);const X={class:"page-activity-upgrade"},Z=["src"],ee={class:"container"},ae={class:"main-form"};var te=b(e({setup(e){const t=i(),l=u(),{productCode:s="BWYL2022",tenantId:r,orderNo:d,agentCode:b="",from:g}=l.query,H=c(),J=c(),T=c(),K=c(),M=c(),G=c(),W=c(!1),Y="check"===g,A=c(!1),te=c(0),oe=c("");let le="";const ne=()=>{W.value=!1},se=e=>`${y}/pay?orderNo=${e}&saleUserId=${b}&tenantId=${r}`,re=()=>{t.replace(`/pay?orderNo=${oe.value}&saleUserId=${b}&tenantId=${r}`)},de=async e=>{try{h.loading({forbidClick:!0,message:"升级中",duration:15e3});const e=await(async()=>{var e,a,t,o,l;const n=R({tenantId:r,applicationNo:T.value.applicationNo,policyNo:T.value.policyNo,saleUserId:b,saleChannelId:T.value.saleChannelId,orderStatus:N.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:H.value,insureDetail:J.value,paymentMethod:null==(a=null==(e=T.value.extInfo)?void 0:e.extraInfo)?void 0:a.paymentMethod,renewalDK:null==(o=null==(t=T.value.extInfo)?void 0:t.extraInfo)?void 0:o.renewalDK,iseeBizNo:le,successJumpUrl:"",premium:K.value,holder:{...T.value.tenantOrderHolder,socialFlag:T.value.tenantOrderHolder.extInfo.hasSocialInsurance},insured:{...T.value.tenantOrderInsuredList[0],socialFlag:T.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance},tenantOrderRiskList:V({tenantId:r,riskList:B(J.value.productRiskVoList[0].riskDetailVOList,H.value),riskPremium:{},productId:null==(l=H.value)?void 0:l.id})}),s=await x(n),{code:d,data:i}=s;return"10000"===d?i.data:""})();await U({tenantId:r,applicationNo:T.value.applicationNo});if(oe.value=e,G.value){if(Y){const a=encodeURIComponent(encodeURIComponent(se(e))),t=`${G.value}&successUrl=${a}`;window.location.href=t}else{const e=encodeURIComponent(encodeURIComponent(window.location.href)),a=`${G.value}&failUrl=${e}`;window.location.href=a}h.clear()}else(async e=>{const a=z({tenantId:r,premium:K.value,orderDetail:T.value,productDetail:H.value,insureDetail:J.value,successJumpUrl:se(e),iseeBizNo:le}),o=await j({orderNo:e,...a}),{code:l,data:n}=o;"10000"===l&&(Y?t.replace(`/internet/orderDetail?orderNo=${e}&productCode=${s}&tenantId=${r}`):(h.clear(),re()))})(e)}catch(a){h.clear()}},ie=async e=>{Y?A.value=!0:de()},ue=()=>{h.loading({forbidClick:!0,duration:2e4,message:"试算中"});const e=E({productCode:s,withInsureInfo:!0,tenantId:r}),a=O({productCode:s}),t=$({orderNo:d,tenantId:r});Promise.all([e,a,t]).then((([e,a,t])=>{var o;"10000"===e.code&&(H.value=e.data,document.title=(null==(o=e.data)?void 0:o.productFullName)||""),"10000"===a.code&&(J.value=a.data),"10000"===t.code&&(T.value=t.data,M.value=t.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),(async()=>{try{const e=z({tenantId:r,premium:K.value,orderDetail:T.value,productDetail:H.value,insureDetail:J.value,successJumpUrl:""},F),a=await S(e),{code:t,data:o}=a;"10000"===t&&(K.value=o.installmentPremium,G.value=o.signUrl),h.clear()}catch(e){}})()}))};return v((()=>{ue(),setTimeout((async()=>{le=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const l=p("ProRadioButton"),s=p("ProField"),r=p("van-config-provider");return a(),m(r,{"theme-vars":n(k)},{default:f((()=>{var e,a,r,d,i,u,c,v,p,m;return[o("div",X,[o("img",{src:null==(a=null==(e=H.value)?void 0:e.tenantProductInsureVO)?void 0:a.banner[0],class:"banner"},null,8,Z),o("div",ee,[o("div",ae,[I(q,{title:"姓名",desc:n(D)(null==(d=null==(r=T.value)?void 0:r.tenantOrderInsuredList)?void 0:d[0].name)},null,8,["desc"]),I(q,{title:"证件号码",desc:n(L)(null==(u=null==(i=T.value)?void 0:i.tenantOrderInsuredList)?void 0:u[0].certNo)},null,8,["desc"]),I(q,{title:"手机号码",desc:n(_)(null==(v=null==(c=T.value)?void 0:c.tenantOrderHolder)?void 0:v.mobile)},null,8,["desc"]),I(q,{title:"每月保费",desc:`${n(P)(K.value||0)}元 / 每月`},null,8,["desc"]),I(s,{label:"有无社保",name:"name",required:"",placeholder:"请选择"},{input:f((()=>[I(l,{modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=e=>M.value=e),disabled:!0,options:n(w)},null,8,["modelValue","options"])])),_:1}),o("div",{class:"submit",onClick:ie})])]),I(Q,{"is-show":W.value,onOnConfirm:re,onOnClose:ne},null,8,["is-show"])]),I(C,{show:A.value,"onUpdate:show":t[1]||(t[1]=e=>A.value=e),"content-list":null==(m=null==(p=H.value)?void 0:p.tenantProductInsureVO)?void 0:m.attachmentVOList,"active-index":te.value,text:"我已逐页阅读并确认告知内容",onSubmit:de},null,8,["show","content-list","active-index"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-7565f9b0"]]);export{te as default};
