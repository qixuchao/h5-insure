import{d as a,u as e,b$ as s,r as t,D as o,R as r,af as n,Z as c,bK as d,b as l,g as i,w as u,e as m,f as p,c as f,h as v,i as h}from"./index-6bbc1d25.js";import{u as b,b as w,c as g}from"./core-9955f44b.js";import{u as y}from"./useThread-637a02aa.js";const x={key:0,class:"wait-loading"},_={key:1,class:"result-view"},k={class:"content-box"},I=h("div",{class:"content"},"开通成功，正在为您生成保单...",-1),N=h("div",{class:"tip"},"请勿返回或退出",-1),$=a({__name:"payCheck",setup(a){const $=e().query,j=s(),C=t(!1),T=t(!1),D=t(""),P=t(!0);let q;const B=()=>{w({tenantId:$.tenantId,orderNo:$.orderNo}).then((a=>{const{code:e,data:s}=a;"10000"===e&&(P.value=!1);const t=s.redirectUrl||`/baseInsurance/orderDetail?orderNo=${$.businessTradeNo}&tenantId=${$.tenantId}&productCode=${$.productCode}`;1==+s.status?(T.value=!0,q.stop(),window.location.href=t):1==+$.from_wxpay?C.value=!0:g($)})).catch()};return q=y({start:()=>{console.log("开始轮询"),B()},stop:()=>{console.log("结束轮询"),T.value||o.alert({title:"提示",message:"未查到支付成功状态，请检查是否已支付完成",confirmButtonText:"好的，我知道了"}).then((()=>{window.location.href=D.value}))},time:2e3,number:5}),b(),r((()=>{1==+$.from_wxpay?(C.value=!0,q.run()):B()})),(a,e)=>{const s=n,t=c("ProPageWrap"),o=d;return l(),i(o,{"theme-vars":p(j)},{default:u((()=>[m(t,{"main-class":"page-pay-check"},{default:u((()=>[p(P)&&!p(C)?(l(),f("div",x,"加载中，请稍候...")):v("",!0),!p(P)&&p(C)?(l(),f("div",_,[h("div",k,[m(s,{name:"checked",class:"large-icon"}),I,N])])):v("",!0)])),_:1})])),_:1},8,["theme-vars"])}}});export{$ as default};
