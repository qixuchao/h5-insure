var lt=Object.defineProperty;var z=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,pt=Object.prototype.propertyIsEnumerable;var Q=(s,n,u)=>n in s?lt(s,n,{enumerable:!0,configurable:!0,writable:!0,value:u}):s[n]=u,G=(s,n)=>{for(var u in n||(n={}))ct.call(n,u)&&Q(s,u,n[u]);if(z)for(var u of z(n))pt.call(n,u)&&Q(s,u,n[u]);return s};import{g as Z,a5 as j,C as V,x as J,X as tt,r as I,h as v,m as b,F as M,E as H,y as o,n as c,I as D,j as g,k as m,s as B,z as f,B as h,a1 as ot,a2 as et,ad as mt,Q as _t,o as vt,d as ft,a6 as kt,D as ht}from"./vendor-4dbfa310.js";import{g as Lt}from"./index-cff3571e.js";import{u as It,P as Pt}from"./index-7526c06a.js";import{b as K,_ as st,n as Dt}from"./index-21ff2934.js";import{b as Ft}from"./trial-5b7db6fc.js";const gt=s=>K.post("/api/app/insure/proposal/AddOrUpdateProposal",s),Rt=(s={})=>K.get(`/api/app/insure/proposal/queryProposalDetail/${s.id}`,s),yt=(s={})=>K.post("/api/app/insure/product/listInsureProductDetail",s);const E=s=>(ot("data-v-ddf563b0"),s=s(),et(),s),Ct={class:"com-product-list-wrapper"},Vt={class:"risk-item-wrapper"},bt={class:"content"},Bt={class:"risk-premium"},Et=h(" \u4FDD\u8D39:"),$t={class:"premium"},Ot={class:"risk-factor"},wt={class:"factor"},St={class:"factor-value"},Nt=E(()=>o("span",{class:"factor-name"}," \u4FDD\u989D(\u5143) ",-1)),At={class:"factor"},xt={class:"factor-value"},qt=E(()=>o("span",{class:"factor-name"}," \u4FDD\u969C\u671F\u95F4 ",-1)),Ut={class:"factor"},Tt={class:"factor-value"},Yt=E(()=>o("span",{class:"factor-name"}," \u7F34\u8D39\u671F\u95F4 ",-1)),jt={class:"operate-bar"},Mt=h("\u5220\u9664"),Ht=h("+ \u9644\u52A0\u9669"),Kt=h("\u4FEE\u6539"),Wt={class:"content"},Xt={class:"risk-premium"},zt=h(" \u4FDD\u8D39:"),Qt={class:"premium"},Gt={class:"risk-factor"},Jt={class:"factor"},Zt={class:"factor-value"},to=E(()=>o("span",{class:"factor-name"}," \u4FDD\u989D(\u5143) ",-1)),oo={class:"factor"},eo={class:"factor-value"},so=E(()=>o("span",{class:"factor-name"}," \u4FDD\u969C\u671F\u95F4 ",-1)),ao={class:"factor"},uo={class:"factor-value"},ro=E(()=>o("span",{class:"factor-name"}," \u7F34\u8D39\u671F\u95F4 ",-1)),io={class:"operate-bar"},no=h("\u5220\u9664"),lo=h("+ \u9644\u52A0\u9669"),co=h("\u4FEE\u6539"),po={class:"premium-total"},mo=h(" \u4FDD\u8D39: "),_o={class:"premium"},vo=Z({props:{productRiskList:{default:()=>[]},enumList:{default:()=>({})},productInfo:{default:()=>({})},productData:{default:()=>({})},pickProductPremium:{type:Function,default:()=>{}},productNum:{default:0}},emits:["deleteRisk","updateRisk","addRisk"],setup(s,{emit:n}){const u=s,[$,C]=j(),e=V({checkedList:[],disabledList:[],riderRiskList:[],mainRiskData:{},totalPremium:0}),S=J(()=>{var l,p;return((p=(l=u.productData)==null?void 0:l.riskDetailVOList)==null?void 0:p[0].optionalRiderRiskVOList)||[]}),T=J(()=>{var l,p;return((p=(l=u.productData)==null?void 0:l.riskDetailVOList)==null?void 0:p[0].collocationVOList)||[]}),O=()=>{n("updateRisk",u.productInfo)},w=l=>{n("deleteRisk",l,u.productInfo)},Y=l=>{n("updateRisk",l,u.productInfo)},_=l=>{C(!0),n("addRisk",l,u.productInfo)};return tt(()=>u.productInfo,l=>{var L;let p=0;const R=r=>{r.forEach(F=>{var y;p+=F.premium,((y=F.riderRiskVOList)==null?void 0:y.length)&&R(F.riderRiskVOList)})};R(l.proposalProductRiskList||[]),(L=u==null?void 0:u.pickProductPremium)==null||L.call(u,{[`${l.productId}`]:p}),e.value.totalPremium=p},{deep:!0,immediate:!0}),(l,p)=>{const R=I("ProTitle"),L=I("ProCheckButton");return v(),b("div",Ct,[(v(!0),b(M,null,H(s.productRiskList,r=>{var F,y,N,A;return v(),b("div",{key:r.riskId},[o("div",Vt,[c(R,{"risk-type":r.riskType,title:r.riskName},null,8,["risk-type","title"]),o("div",bt,[o("div",Bt,[Et,o("span",$t,"\uFFE5"+D(r.premium.toLocaleString()),1)]),o("div",Ot,[o("div",wt,[o("span",St,D(r.amount.toLocaleString()),1),Nt]),o("div",At,[o("span",xt,D(r.coveragePeriod),1),qt]),o("div",Ut,[o("span",Tt,D(r.chargePeriod),1),Yt])]),o("div",jt,[s.productNum?(v(),g(L,{key:0,round:32,class:"border",onClick:k=>w(r)},{default:m(()=>[Mt]),_:2},1032,["onClick"])):B("",!0),((A=(N=(y=(F=s.productData)==null?void 0:F.riskDetailVOList)==null?void 0:y[0])==null?void 0:N.optionalRiderRiskVOList)==null?void 0:A.length)?(v(),g(L,{key:1,activated:"",round:32,onClick:k=>_(r)},{default:m(()=>[Ht]),_:2},1032,["onClick"])):B("",!0),c(L,{activated:"",round:32,onClick:k=>Y(r)},{default:m(()=>[Kt]),_:2},1032,["onClick"])])])]),(v(!0),b(M,null,H(r.riderRiskVOList,k=>{var x,q,a,t;return v(),b("div",{key:k.riskCode,class:"risk-item-wrapper"},[c(R,{"risk-type":k.riskType,title:k.riskName},null,8,["risk-type","title"]),o("div",Wt,[o("div",Xt,[zt,o("span",Qt,"\uFFE5"+D(k.premium.toLocaleString()),1)]),o("div",Gt,[o("div",Jt,[o("span",Zt,D(r.amount.toLocaleString()),1),to]),o("div",oo,[o("span",eo,D(r.coveragePeriod),1),so]),o("div",ao,[o("span",uo,D(r.chargePeriod),1),ro])]),o("div",io,[s.productNum?(v(),g(L,{key:0,round:32,class:"border",onClick:d=>w(k)},{default:m(()=>[no]),_:2},1032,["onClick"])):B("",!0),((t=(a=(q=(x=s.productData)==null?void 0:x.riskDetailVOList)==null?void 0:q[0])==null?void 0:a.optionalRiderRiskVOList)==null?void 0:t.length)?(v(),g(L,{key:1,activated:"",round:32,onClick:d=>_(k)},{default:m(()=>[lo]),_:2},1032,["onClick"])):B("",!0),c(L,{activated:"",round:32,onClick:d=>Y(k)},{default:m(()=>[co]),_:2},1032,["onClick"])])])])}),128)),o("div",po,[mo,o("span",_o,"\uFFE5"+D(e.value.totalPremium.toLocaleString()),1)])])}),128)),f($)?(v(),g(Ft,{key:0,modelValue:e.value.checkedList,"onUpdate:modelValue":p[0]||(p[0]=r=>e.value.checkedList=r),show:f($),disabled:e.value.disabledList,"risk-list":f(S),"collocation-list":f(T),onFinished:O,onClose:p[1]||(p[1]=r=>f(C)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):B("",!0)])}}});var fo=st(vo,[["__scopeId","data-v-ddf563b0"]]);const ko=s=>(ot("data-v-358dabd6"),s=s(),et(),s),ho={class:"container"},Lo=ko(()=>o("span",null,"\u8BA1\u5212\u4E66\u540D\u79F0",-1)),Io={class:"operate-bar"},Po=h("\u6DFB\u52A0\u4E3B\u9669"),Do={class:"footer-bar"},Fo={class:"trial-result"},go=h(" \u603B\u4FDD\u8D39 "),Ro={class:"result-num"},yo={class:"trial-operate"},Co=h("\u4FDD\u5B58\u5E76\u9884\u89C8"),Vo=Z({setup(s){const[n,u]=j(!1),[$,C]=j(),e=V({proposalHolder:{},proposalInsuredList:[{name:"",gender:"",birthday:"",proposalInsuredProductList:[]}],proposalName:"",totalPremium:0,relationUserType:2}),S=mt(),T=_t(),O=It(),{id:w,type:Y="add"}=T.query,_=V({enumList:{},productId:0,productCollection:{},productInfo:{},productPremium:{}}),l=V();V({}),V([]);const p=(a,t)=>{const d=t;ht.confirm({message:"\u786E\u8BA4\u5220\u9664\u8BE5\u9669\u79CD\uFF1F"}).then(()=>{a.riskType===1?e.value.proposalInsuredList[0].proposalInsuredProductList=e.value.proposalInsuredList[0].proposalInsuredProductList.filter(P=>P.productId!==t.productId):d.proposalProductRiskList[0].riderRiskVOList=d.proposalProductRiskList[0].riderRiskVOList.filter(P=>P.riskId!==a.riskId)})},R=(a,t)=>{_.value.productId=t.productId,_.value.productInfo=t,C(!0)},L=a=>{},r=(a={})=>{Object.assign(_.value.productPremium,a),e.value.totalPremium=Object.values(_.value.productPremium).reduce((t,d)=>t+d,0)},F=()=>{Rt({id:w}).then(({code:a,data:t})=>{a==="10000"&&Object.assign(e.value,t)})},y=()=>{l.value.validate().then(()=>{gt(e.value).then(({code:a,data:t})=>{a==="10000"&&S.push({path:"/compositionProposal",query:{id:t}})})})},N=()=>{Lt({dictCodeList:["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD"]}).then(({code:t,data:d})=>{if(t==="10000"){const P={};d.forEach(U=>{P[U.dictCode]=U.dictItemList}),_.enumList=P}})},A=a=>{e.value.proposalInsuredList[0].proposalInsuredProductList=e.value.proposalInsuredList[0].proposalInsuredProductList.map(t=>{let d=t;return t.productId===a.proposalInsuredList[0].proposalInsuredProductList[0].productId&&(d=G({},a.proposalInsuredList[0].proposalInsuredProductList[0])),d}),C(!1)},k=a=>{yt(a).then(({code:t,data:d})=>{t==="10000"&&(_.value.productCollection=d)}).finally(()=>{})},x=()=>{O.setProposalInfo(e.value),S.push({path:"/proposalList",query:{isCreateProposal:"1"}})},q=()=>{C(!1)};return vt(()=>{const a=O.$state.trialData,t=O.$state.proposalInfo;w?F():!Object.keys(t).length&&a.length?Object.assign(e.value,a[0]):Object.keys(t).length&&a.length&&(t.proposalInsuredList[0].proposalInsuredProductList.push(...a[0].proposalInsuredList[0].proposalInsuredProductList),e.value=t),N()}),tt(()=>{var a;return(a=e.value.proposalInsuredList[0].proposalInsuredProductList)==null?void 0:a.length},()=>{const a=e.value.proposalInsuredList[0].proposalInsuredProductList.map(t=>({productId:t.productId,source:2}));k({voList:a})}),(a,t)=>{const d=I("VanField"),P=I("ProCard"),U=I("ProRadioButton"),at=I("VanForm"),ut=I("ProCheckButton"),rt=I("VanButton"),it=I("van-datetime-picker"),nt=I("van-popup"),dt=I("ProPageWrap");return v(),g(dt,{class:"page-create-wrapper"},{default:m(()=>[o("div",ho,[c(at,{ref_key:"formRef",ref:l,"input-align":"right","error-message-align":"right"},{default:m(()=>[c(P,null,{default:m(()=>[c(d,{modelValue:e.value.proposalName,"onUpdate:modelValue":t[0]||(t[0]=i=>e.value.proposalName=i),name:"proposalName",placeholder:"\u8BF7\u8F93\u5165\u8BA1\u5212\u4E66\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8BA1\u5212\u4E66\u540D\u79F0"}]},{label:m(()=>[Lo]),_:1},8,["modelValue"])]),_:1}),c(P,{title:"\u88AB\u4FDD\u4EBA\u4FE1\u606F"},{default:m(()=>[c(d,{modelValue:e.value.proposalInsuredList[0].name,"onUpdate:modelValue":t[1]||(t[1]=i=>e.value.proposalInsuredList[0].name=i),name:"name",label:"\u59D3\u540D",placeholder:"\u8BF7\u8F93\u5165\uFF08\u9009\u586B\uFF09"},null,8,["modelValue"]),c(d,{modelValue:e.value.proposalInsuredList[0].birthday,"onUpdate:modelValue":t[2]||(t[2]=i=>e.value.proposalInsuredList[0].birthday=i),name:"birthday",label:"\u51FA\u751F\u65E5\u671F",formate:"YYYY-MM-DD","is-link":"",readonly:"",placeholder:"\u8BF7\u9009\u62E9",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],onClick:t[3]||(t[3]=i=>f(u)(!0))},null,8,["modelValue"]),c(d,{modelValue:e.value.proposalInsuredList[0].gender,"onUpdate:modelValue":t[5]||(t[5]=i=>e.value.proposalInsuredList[0].gender=i),name:"gender",label:"\u6027\u522B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:m(()=>[c(U,{modelValue:e.value.proposalInsuredList[0].gender,"onUpdate:modelValue":t[4]||(t[4]=i=>e.value.proposalInsuredList[0].gender=i),options:f(Dt)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])]),_:1})]),_:1},512),(v(!0),b(M,null,H(e.value.proposalInsuredList[0].proposalInsuredProductList||[],i=>(v(),g(P,{key:i.productId},{default:m(()=>{var W,X;return[c(fo,{"enum-list":_.value.enumList,"product-risk-list":i.proposalProductRiskList,"product-info":i,"product-num":((X=(W=e.value.proposalInsuredList[0])==null?void 0:W.proposalInsuredProductList)==null?void 0:X.length)-1,"product-data":_.value.productCollection[i.productId],"pick-product-premium":r,onAddRisk:L,onUpdateRisk:R,onDeleteRisk:p},null,8,["enum-list","product-risk-list","product-info","product-num","product-data"])]}),_:2},1024))),128)),o("div",Io,[c(ut,{activated:"",round:34,onClick:x},{default:m(()=>[Po]),_:1})])]),o("div",Do,[o("span",Fo,[go,o("span",Ro,"\uFFE5"+D(e.value.totalPremium.toLocaleString()),1)]),o("div",yo,[c(rt,{type:"primary",onClick:y},{default:m(()=>[Co]),_:1})])]),c(nt,{show:f(n),"onUpdate:show":t[8]||(t[8]=i=>kt(n)?n.value=i:null),position:"bottom"},{default:m(()=>[c(it,{type:"date",onConfirm:t[6]||(t[6]=i=>{e.value.proposalInsuredList[0].birthday=f(ft)(i).format("YYYY-MM-DD"),f(u)(!1)}),onCancel:t[7]||(t[7]=i=>f(u)(!1))})]),_:1},8,["show"]),f($)?(v(),g(Pt,{key:0,"is-show":f($),type:"edit","product-data":_.value.productCollection[_.value.productId],"form-info":_.value.productInfo,holder:e.value.proposalHolder,insured:e.value.proposalInsuredList[0],onClose:q,onFinished:A},null,8,["is-show","product-data","form-info","holder","insured"])):B("",!0)]),_:1})}}});var So=st(Vo,[["__scopeId","data-v-358dabd6"]]);export{So as default};
