import{k as e,aa as t,u as a,r as n,b as o,$ as r,o as d,p as l,s as u,t as i,v as s,S as c,C as v,M as p,E as m,y as f,d as I,D as O,a5 as L,a6 as C}from"./vendor-9bab628e.js";import{d as V}from"./debounce-a0c8763d.js";import{r as b,t as y}from"./utils-0cd37490.js";import{p as j}from"./product-7f0e5e22.js";import{i as P,b as R,p as h}from"./trial-59daee7b.js";import{_ as w,n as N}from"./nextStep-f0bd717d.js";import{u as g}from"./theme-467ed2f7.js";import{P as x}from"./index-79ae0ed3.js";import{_ as B}from"./index-246916e4.js";import"./useStorage-9366facd.js";import"./infoCollection-5ade81d8.js";import"./trial-b78b45d7.js";import"./relativeTime-043d4e7b.js";import"./useDicData-f247ae2d.js";const D=e=>(L("data-v-2bc144c6"),e=e(),C(),e),E={class:"net-sale-wrap"},k={class:"product-name"},_=D((()=>v("span",null,null,-1))),T=D((()=>v("span",null,null,-1))),Y={class:"footer-button"};var H=B(e({setup(e){const L=g();t();const C=a(),{productCode:B="HTEJBX",tenantId:D="9991000001",orderNo:H,agentCode:S="",saleChannelId:A,extraInfo:F,from:U}=C.query,$=n(),M=n(),z=n(),q=n(),J=n(),W=n({});let G={};try{G=JSON.parse(decodeURIComponent(F))}catch(oe){}const X=n({agencyId:S,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_underWrite",pageCode:"infoCollection",templateId:null==G?void 0:G.templateId,iseeBizNo:"",extraInfo:G},orderCategory:1,saleUserId:A,tenantId:D,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"1",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"xinao",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:D}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),K=o((()=>{var e,t;return!!(null==(t=null==(e=z.value)?void 0:e.productRelationPlanVOList)?void 0:t.length)})),Q=o((()=>{var e,t;let{premium:a}=J.value||{};if(!a){const{tenantProductInsureVO:n}=q.value||{};let o={};o=(null==(e=null==n?void 0:n.planList)?void 0:e.length)?null==n?void 0:n.planList.find((e=>e.plaCode===M.value)):null==n?void 0:n.planInsureVO;const{paymentFrequencyValue:r,premiumUnit:d}=(null==(t=null==o?void 0:o.productPremiumVOList)?void 0:t[0])||{};a=r+d}return a||""})),Z=o((()=>{var e,t,a;let n=[];return n=K.value?(null==(t=null==(e=z.value)?void 0:e.productRelationPlanVOList.find((e=>e.planCode===M.value)))?void 0:t.productRiskVoList)||[]:(null==(a=z.value)?void 0:a.productRiskVoList)||[],n}));o((()=>{var e,t,a;null==(a=null==(t=null==(e=Z.value)?void 0:e[0])?void 0:t.riskDetailVOList)||a[0]}));const ee=o((()=>`${I(new Date).add(1,"day").format("YYYY-MM-DD")}00:00:00`)),te=o((()=>`${I(new Date).add(1,"year").format("YYYY-MM-DD")}00:00:00`)),ae=async()=>{var e,t,a;X.value.venderCode=null==(e=z.value)?void 0:e.productBasicInfoVO.insurerCode,X.value.orderAmount=J.value.premium,X.value.orderRealAmount=J.value.premium,X.value.commencementTime=ee.value,X.value.expiryDate=te.value,X.value.tenantOrderInsuredList[0].planCode=M.value,X.value.tenantOrderInsuredList[0].planName=null==(a=null==(t=z.value)?void 0:t.productRelationPlanVOList.find((e=>e.planCode===M.value)))?void 0:a.planName,N(((e={},t={},a={})=>{var n;const o={...a},r={tenantId:D,riskList:(null==(n=o.tenantOrderInsuredList[0])?void 0:n.tenantOrderProductList[0].riskVOList)||[],riskPremium:t,productId:null==e?void 0:e.productBasicInfoVO.id};return o.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,tenantOrderRiskList:y(r)},o})(z.value,J.value,X.value),(()=>{}))},ne=async()=>{O.confirm({title:"分享",message:`即将向客户【${X.value.tenantOrderHolder.name}】发送投保确认信息,请确认是否继续？`}).then((()=>{ae()}))};r([()=>{var e;return null==(e=X.value.tenantOrderInsuredList)?void 0:e[0].gender},()=>{var e;return null==(e=X.value.tenantOrderInsuredList)?void 0:e[0].birthday},()=>M.value],V((([e,t])=>{e&&t&&(async(e,t,a)=>{var n;const o={holder:{personVO:e.tenantOrderHolder},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",personVO:e,productPlanVOList:[{insurerCode:t.productBasicInfoVO.insurerCode,planCode:M.value||0,riskVOList:b(a)}]}))),productCode:t.productBasicInfoVO.productCode,tenantId:D},{code:r}=await R(o);if("10000"===r){const{code:e,data:t}=await h(o);J.value="10000"===e?t:null}X.value.tenantOrderInsuredList[0].tenantOrderProductList=null==(n=o.insuredVOList[0])?void 0:n.productPlanVOList})(X.value,z.value,Z.value)}),500));return d((()=>{(async()=>{var e;const{code:t,data:a}=await j({productCode:B,withInsureInfo:!0,tenantId:D});"10000"===t&&(q.value=a,document.title=a.productFullName||"");const{code:n,data:o}=await P({productCode:B});"10000"===n&&(z.value=o,W.value=o.productFactor,(null==(e=null==o?void 0:o.productRelationPlanVOList)?void 0:e.length)&&(M.value=o.productRelationPlanVOList[0].planCode))})(),setTimeout((async()=>{window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const a=l("ProRadioButton"),n=l("ProCard"),o=l("ProCell"),r=l("ProPageWrap"),d=l("van-config-provider");return u(),i(d,{"theme-vars":m(L)},{default:s((()=>[c(r,null,{default:s((()=>{var e,r;return[v("div",E,[v("div",k,p(null==(r=null==(e=z.value)?void 0:e.productBasicInfoVO)?void 0:r.productFullName),1),m(K)?(u(),i(n,{key:0,title:"保障年期"},{default:s((()=>{var e;return[c(a,{modelValue:M.value,"onUpdate:modelValue":t[0]||(t[0]=e=>M.value=e),class:"radio-group",prop:{label:"planName",value:"planCode"},options:null==(e=z.value)?void 0:e.productRelationPlanVOList},null,8,["modelValue","options"])]})),_:1})):f("",!0),c(w,{ref_key:"formRef",ref:$,"title-collection":{HOLDER:"投保人",INSURER:"被保人",BENEFICIARY:"收益人"},"form-info":X.value,"send-sms-code":()=>{},"input-align":"left","factor-object":W.value},{holderName:s((()=>[_])),insurerName:s((()=>[T])),_:1},8,["form-info","send-sms-code","factor-object"]),c(o,{title:"保费",content:m(Q)},null,8,["content"]),c(o,{title:"保障期间",content:`${m(ee)}~${m(te)}`},null,8,["content"]),v("div",Y,[c(x,{text:"分享用户确认投保",onClick:ne})])])]})),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-2bc144c6"]]);export{H as default};
