import{ref as e,onMounted as a}from"vue";import{_ as t,u as o,g as r,T as u,aF as s,p as n}from"./index-d66a20d8.js";import{s as l,c as v}from"./phoneVerify-a37057a4.js";import{c as d}from"./format-b5e9d8b9.js";import{u as i}from"./useOrder-d2812e23.js";import"./pdfh5-e588f83d.js";import"./merge-e7788e50.js";import"./keysIn-131bbce9.js";import"./isObjectLike-a9798079.js";const c={class:"page-phone-verify"},p=(e=>(vue.pushScopeId("data-v-6781f4aa"),e=e(),vue.popScopeId(),e))((()=>vue.createElementVNode("div",{class:"title"},"通过投保人手机号验证后，可进行投保信息填写",-1))),m={class:"phone"},f={class:"input-wrapper"};var I=t(vue.defineComponent({__name:"phoneVerify",setup(t){const I=i(),C=e(""),N=e(""),h=e(0);let E;const S=o(),{agentCode:T,tenantId:_,templateId:b,productCode:y,insurerCode:V,orderNo:j,orderCode:g}=S.query,O=()=>{l(C.value).then((({code:e})=>{"10000"===e&&(h.value=60,E=setInterval((()=>{h.value-=1,h.value<=0&&clearInterval(E)}),1e3))}))},D=()=>{v(C.value,N.value).then((({code:e,data:a})=>{"10000"===e&&a?(u.success("验证成功"),I.value.orderStatus===s.PROCESSING?n("infoCollection",{...S.query,isShare:1}):[s.WAIT_IDENTIFICATION,s.IDENTIFICATION_COMPLETE,s.IN_IDENTIFICATION,s.UNDER_WRITING_SUCCESS].includes(I.value.orderStatus)&&n("infoPreview",{...S.query,isShare:1})):u.fail("验证失败")}))};return a((()=>{r({orderNo:g||j,saleUserId:T,tenantId:_}).then((({code:e,data:a})=>{var t;"10000"===e&&(Object.assign(I.value,a),C.value=null==(t=null==a?void 0:a.holder)?void 0:t.mobile)}))})),(e,a)=>{const t=vue.resolveComponent("van-button"),o=vue.resolveComponent("ProPageWrap");return vue.openBlock(),vue.createBlock(o,null,{default:vue.withCtx((()=>[vue.createElementVNode("div",c,[p,vue.createElementVNode("div",m,vue.toDisplayString(vue.unref(d)(vue.unref(C)||"")),1),vue.createElementVNode("div",f,[vue.withDirectives(vue.createElementVNode("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>vue.isRef(N)?N.value=e:null),placeholder:"请输入验证码",class:"input"},null,512),[[vue.vModelText,vue.unref(N)]]),vue.createElementVNode("div",{class:vue.normalizeClass(["btn",{second:vue.unref(h)}]),onClick:O},vue.toDisplayString(vue.unref(h)?`${vue.unref(h)}s`:"发送验证码"),3)]),vue.createVNode(t,{type:"primary",class:"submit-btn",onClick:D},{default:vue.withCtx((()=>[vue.createTextVNode("下一步")])),_:1})])])),_:1})}}}),[["__scopeId","data-v-6781f4aa"]]);export{I as default};
