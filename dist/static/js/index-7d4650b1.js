var he=Object.defineProperty,Se=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var Ne=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var ie=(e,p,o)=>p in e?he(e,p,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[p]=o,y=(e,p)=>{for(var o in p||(p={}))Ne.call(p,o)&&ie(e,o,p[o]);if(de)for(var o of de(p))Oe.call(p,o)&&ie(e,o,p[o]);return e},D=(e,p)=>Se(e,Ve(p));import{g as ve,E as k,y as ye,_ as pe,j as s,n as $,k as b,A as f,t as I,m as C,p as E,a4 as Ee,a5 as fe,z as S,C as U,O as Le,ak as xe,h as we,r as W,G as Ge,F as qe,T as ce,L as We,J as Me}from"./vendor-e057bbeb.js";import{q as je}from"./index-15376f4b.js";import{_ as be,Y as Ie,h as j,T as M,U as Pe,m as He,V as Ke,W as $e,w as Ue,X as Q,l as Z,Z as ze,$ as Je,r as me,G as Qe,Q as R,R as _,n as Ze,P as Xe}from"./index-a38d2223.js";import{c as P,a as Ye}from"./order-35b0e3c5.js";import{u as ea}from"./useDicData-90a18e30.js";import{_ as aa}from"./index-0c44f325.js";var Y=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(Y||{});const ee=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];P(ee);var ae=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(ae||{});const De=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];P(De);var h=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(h||{});const ke=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];P(ke);var A=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(A||{});const ua=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];P(ke);var Ce=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(Ce||{});const Re=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];P(Re);const ta=e=>(Ee("data-v-1e9a84d8"),e=e(),fe(),e),la={class:"com-bank-card-info"},oa=ta(()=>S("span",{class:"field-title"},[U("\u94F6\u884C\u5361\u7167\u7247 "),S("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),na=ve({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:p}){const o=e,z=ea("BANK"),n=k({bankCardType:ae.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),g=d=>o.factor&&o.factor[d]&&o.factor[d].isDisplay===Ie.YES,x=d=>d&&d.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247",w=ye(()=>z.value.map(d=>({label:d.name,value:d.code}))),G=d=>{Ke({ossKey:[d],imageType:$e.BANK_CARD}).then(i=>{const{data:r,code:O}=i;if(O==="10000"&&r&&r.bankCardOcrVO){n.value.bankCardNo=r.bankCardOcrVO.cardNo;const c=w.value.find(t=>t.label===r.bankCardOcrVO.bankName);c&&(n.value.payBank=c.value)}})};return pe(()=>o.modelValue,d=>{n.value=d},{immediate:!0}),pe(n,d=>{p("update:modelValue",d)}),(d,i)=>(s(),$("div",la,[g("cardType")?(s(),b(j,{key:0,modelValue:n.value.bankCardType,"onUpdate:modelValue":i[0]||(i[0]=r=>n.value.bankCardType=r),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":f(De),"is-view":""},null,8,["modelValue","data-source"])):I("",!0),g("bankCardNumber")?(s(),b(M,{key:1,modelValue:n.value.bankCardNo,"onUpdate:modelValue":i[1]||(i[1]=r=>n.value.bankCardNo=r),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):I("",!0),g("cardHolder")?(s(),b(M,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):I("",!0),g("bank")?(s(),b(j,{key:3,modelValue:n.value.payBank,"onUpdate:modelValue":i[2]||(i[2]=r=>n.value.payBank=r),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":f(w),required:""},null,8,["modelValue","data-source"])):I("",!0),g("bankCardAttachment")?(s(),b(M,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:x}]},{label:C(()=>[oa]),input:C(()=>[E(He,{modelValue:n.value.images,"onUpdate:modelValue":i[3]||(i[3]=r=>n.value.images=r),"max-count":2,"upload-type":f(Pe).BANK_CARD,onOnUploadFinished:G},null,8,["modelValue","upload-type"])]),_:1},8,["rules"])):I("",!0),g("bankPreMobile")?(s(),b(M,{key:5,modelValue:n.value.mobile,"onUpdate:modelValue":i[4]||(i[4]=r=>n.value.mobile=r),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):I("",!0)]))}});var X=be(na,[["__scopeId","data-v-1e9a84d8"]]);const ra=e=>(Ee("data-v-72b25f27"),e=e(),fe(),e),sa={class:"page-bank-card"},da={class:"reprise-card-list"},ia=["onClick"],pa={class:"agree"},ca=U(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),ma={class:"footer-button footer"},va=ra(()=>S("div",{class:"text"},"\u5237\u65B0",-1)),ya=U("\u5206\u4EAB"),Ea=U("\u4E0B\u4E00\u6B65"),fa=ve({setup(e){const p={1:"pdf",4:"picture",2:"richText",3:"link"},o=Le(),z=xe(),{orderNo:n="2022072710380711215",agentCode:g="D1234567-1",tenantId:x="9991000007",templateId:w=1,isShare:G,insureCode:d="kunlunhealth"}=o.query,i={bankCardType:ae.DEBIT};let r={};const O=k(""),c=k({payMethod:Y.REAL_TIME,bankData:D(y({},i),{imagesId:[],images:[]})}),t=k({payMethod:Y.REAL_TIME,expiryMethod:Ce.AUTOMATIC_PADDING,bankData:D(y({},i),{imagesId:[],images:[]}),payInfoType:A.FIRST_SAME}),T=k({bankData:D(y({},i),{imagesId:[],images:[]})}),L=k(A.FIRST_SAME),B=k({}),J=k(!1),ue=k(),te=k(),le=k(),oe=k({}),H=k(1),Te=v=>{L.value=v},K=(v,u)=>B.value&&B.value[u]&&B.value[u][v]&&B.value[u][v].isDisplay===Ie.YES,Fe=()=>{Je({insureCode:d,objectType:4,tenantId:x,orderNo:n}).then(({code:v,data:u})=>{v==="10000"&&(oe.value=u,u.materialSource===1?u.materialContent.indexOf(".pdf")!==-1?H.value=1:H.value=4:H.value=u.materialSource)})},ge=()=>{me({orderNo:n,saleUserId:g,tenantId:x}).then(v=>{var m,a,q;const{code:u,data:V}=v;u==="10000"&&(V.orderStatus!==Ye.PENDING?Qe("paymentResult",o.query):Promise.all([(m=ue.value)==null?void 0:m.validate(),(a=te.value)==null?void 0:a.validate(),(q=le.value)==null?void 0:q.validate()]).then(F=>{if(!J.value){ce.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}const l=[D(y({},F[0]),{id:c.value.id,paymentType:h.FIRST_TERM}),D(y({},F[1]),{id:t.value.id,paymentType:h.RENEW_TERM}),D(y({},F[2]),{id:T.value.id,paymentType:h.REPRISE,payInfoType:L.value})],N=[{category:R.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.INIT_SIGN,type:"png",uri:F[0].images[0],id:c.value.bankData.imagesId[0]},{category:R.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.INIT_SIGN,type:"png",uri:F[0].images[1],id:c.value.bankData.imagesId[1]}];t.value.payInfoType===A.OTHER&&(N.push({category:R.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:F[1].images[0],id:t.value.bankData.imagesId[0]}),N.push({category:R.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:F[1].images[1],id:t.value.bankData.imagesId[1]})),L.value===A.OTHER&&(N.push({category:R.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:F[2].images[0],id:T.value.bankData.imagesId[0]}),N.push({category:R.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:F[2].images[1],id:T.value.bankData.imagesId[1]})),Ze(D(y({},r),{pageCode:"payInfo",tenantOrderPayInfoList:l,extInfo:D(y({},r.extInfo),{templateId:w,pageCode:"payInfo",shareFlag:G?"Y":"N"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:N})).then(re=>{const{code:Be,data:se}=re;Be==="10000"&&se.success&&z.push({path:Xe[se.pageAction.data.nextPageCode],query:o.query})})}))})},_e=ye(()=>{const v=D(y({},o.query),{isShare:1,sharePageCode:"payInfo"});return`${window.location.origin}/phoneVerify?${je.stringify(v)}`}),ne=(v=!1)=>{me({orderNo:n,saleUserId:g,tenantId:x}).then(u=>{const{code:V,data:m}=u;V==="10000"&&m&&(r=m,O.value=m.tenantOrderHolder.name,m.tenantOrderPayInfoList.forEach(a=>{a.paymentType===h.FIRST_TERM?(c.value=a,c.value.bankData=D(y(y({},i),a),{images:[],imagesId:[]})):a.paymentType===h.RENEW_TERM?(t.value=a,t.value.bankData=D(y({},a),{images:[],imagesId:[]})):a.paymentType===h.REPRISE&&(T.value=a,T.value.bankData=D(y({},a),{images:[],imagesId:[]}),L.value=a.payInfoType)}),m.tenantOrderAttachmentList.forEach(a=>{a.objectType===_.INIT_SIGN?(a.category===R.OBVERSE_BANK_CARD&&(c.value.bankData.images[0]=a.uri,c.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(c.value.bankData.images[1]=a.uri,c.value.bankData.imagesId[1]=a.id)):a.objectType===_.RENEWAL_SIGN?(a.category===R.OBVERSE_BANK_CARD&&(t.value.bankData.images[0]=a.uri,t.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(t.value.bankData.images[1]=a.uri,t.value.bankData.imagesId[1]=a.id)):a.objectType===_.ANNUAL_SIGN&&(a.category===R.OBVERSE_BANK_CARD&&(T.value.bankData.images[0]=a.uri,T.value.bankData.imagesId[0]=a.id),a.category===R.REVERSE_BANK_CARD&&(T.value.bankData.images[1]=a.uri,T.value.bankData.imagesId[1]=a.id))}),v&&(m.tenantOrderPayInfoList.find(a=>a.paymentType===h.FIRST_TERM&&a.bankCardNo)||ce("\u7528\u6237\u672A\u5B8C\u6210\u94F6\u884C\u5361\u4FE1\u606F\u586B\u5199")))})},Ae=()=>{ne(!0)};return we(()=>{Fe(),Ue({pageCode:"payInfo",templateId:w}).then(v=>{const{code:u,data:V}=v;if(u==="10000"){const m={};V.productInsureFactorList.forEach(a=>{m[a.moduleType]||(m[a.moduleType]={}),m[a.moduleType][a.code]=a}),B.value=m}}),ne()}),(v,u)=>{const V=W("van-switch"),m=W("van-checkbox"),a=W("ProSvg"),q=W("van-button"),F=W("ProPageWrap");return s(),b(F,null,{default:C(()=>[S("div",sa,[E(Z,{title:"\u9996\u671F\u652F\u4ED8"},{default:C(()=>[E(Q,{ref_key:"form1",ref:ue},{default:C(()=>[K("paymentMethod","INIT")?(s(),b(j,{key:0,modelValue:c.value.payMethod,"onUpdate:modelValue":u[0]||(u[0]=l=>c.value.payMethod=l),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":f(ee)},null,8,["modelValue","data-source"])):I("",!0),E(X,{modelValue:c.value.bankData,"onUpdate:modelValue":u[1]||(u[1]=l=>c.value.bankData=l),"holder-name":O.value,factor:B.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),E(Z,{title:"\u7EED\u671F\u652F\u4ED8"},{default:C(()=>[E(Q,{ref_key:"form2",ref:te},{default:C(()=>[K("sameAsInit","RENEWAL")?(s(),b(M,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:C(()=>[E(V,{modelValue:t.value.payInfoType,"onUpdate:modelValue":u[2]||(u[2]=l=>t.value.payInfoType=l),size:"22","active-value":f(A).FIRST_SAME,"inactive-value":f(A).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):I("",!0),K("paymentMethod","RENEWAL")?(s(),b(j,{key:1,modelValue:t.value.payMethod,"onUpdate:modelValue":u[3]||(u[3]=l=>t.value.payMethod=l),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":f(ee),required:""},null,8,["modelValue","data-source"])):I("",!0),K("overduePayment","RENEWAL")?(s(),b(j,{key:2,modelValue:t.value.expiryMethod,"onUpdate:modelValue":u[4]||(u[4]=l=>t.value.expiryMethod=l),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":f(Re),required:"","label-width":"200"},null,8,["modelValue","data-source"])):I("",!0),t.value.payInfoType!==f(A).FIRST_SAME?(s(),b(X,{key:3,modelValue:t.value.bankData,"onUpdate:modelValue":u[5]||(u[5]=l=>t.value.bankData=l),"holder-name":O.value,factor:B.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):I("",!0)]),_:1},512)]),_:1}),E(Z,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:C(()=>[S("div",da,[(s(!0),$(qe,null,Ge(f(ua),(l,N)=>(s(),$("div",{key:N,class:We(["reprise-card-item",{selected:L.value===l.value}]),onClick:re=>Te(l.value)},Me(l.label),11,ia))),128))]),E(Q,{ref_key:"form3",ref:le},{default:C(()=>[L.value===f(A).OTHER?(s(),b(X,{key:0,modelValue:T.value.bankData,"onUpdate:modelValue":u[6]||(u[6]=l=>T.value.bankData=l),"holder-name":O.value,factor:B.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):I("",!0)]),_:1},512)]),_:1}),S("div",pa,[E(m,{modelValue:J.value,"onUpdate:modelValue":u[7]||(u[7]=l=>J.value=l),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),ca,E(ze,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",content:oe.value.materialContent,type:p[H.value]},null,8,["content","type"])]),S("div",ma,[f(G)?I("",!0):(s(),$("div",{key:0,class:"refresh-btn",onClick:Ae},[S("div",null,[E(a,{name:"refresh"})]),va])),f(G)?I("",!0):(s(),b(aa,{key:1,title:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",desc:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",link:f(_e),"-":""},{default:C(()=>[E(q,{plain:"",type:"primary"},{default:C(()=>[ya]),_:1})]),_:1},8,["link"])),E(q,{type:"primary",class:"submit-btn",onClick:ge},{default:C(()=>[Ea]),_:1})])])]),_:1})}}});var Fa=be(fa,[["__scopeId","data-v-72b25f27"]]);export{Fa as default};
