import{v as e,d as a,j as o,ci as t,dn as s,K as l,C as r,B as d,b as c,co as i,d2 as n,bP as u,H as p,X as v,dp as m,dq as f,dr as h,cn as g,k as C,ds as y,a0 as k,dt as P,bt as b,_ as L,t as x,r as _,o as w,c as I,a as S,u as V,e as j,F as M,q as $,g as O,I as q,O as B,du as U,az as F,n as A,f as N,m as T,w as R,dv as z,p as E,a8 as D,cc as H,aE as K,aj as W,cf as X,av as Z,aw as G,z as J,cZ as Q,as as Y,by as ee,at as ae,h as oe,i as te,d7 as se,b$ as le,l as re,bT as de,T as ce,bh as ie}from"./index-7b64144b.js";import{P as ne}from"./index-27a1c2a8.js";import{L as ue}from"./index-501fd5c0.js";import{P as pe,u as ve,_ as me}from"./index-a557c509.js";import{_ as fe}from"./index-c3d05ab6.js";import{_ as he}from"./empty-ae586b6c.js";import{q as ge,a as Ce}from"./proposalList-3a68c319.js";import{P as ye}from"./index-bbeed2f9.js";import{C as ke}from"./index-82818c1f.js";import{q as Pe}from"./trial-d37aea02.js";import"./index-175237a4.js";const[be,Le]=e("tabbar"),xe={route:Boolean,fixed:l,border:l,zIndex:r,placeholder:Boolean,activeColor:String,beforeChange:Function,inactiveColor:String,modelValue:d(0),safeAreaInsetBottom:{type:Boolean,default:null}},_e=Symbol(be);const we=p(a({name:be,props:xe,emits:["change","update:modelValue"],setup(e,{emit:a,slots:l}){const r=o(),{linkChildren:d}=t(_e),p=s(r,Le),v=()=>{var a;return null!=(a=e.safeAreaInsetBottom)?a:e.fixed},m=()=>{var a;const{fixed:o,zIndex:t,border:s}=e;return c("div",{ref:r,role:"tablist",style:i(t),class:[Le({fixed:o}),{[n]:s,"van-safe-area-bottom":v()}]},[null==(a=l.default)?void 0:a.call(l)])};return d({props:e,setActive:(o,t)=>{u(e.beforeChange,{args:[o],done(){a("update:modelValue",o),a("change",o),t()}})}}),()=>e.fixed&&e.placeholder?p(m):m()}})),[Ie,Se]=e("tabbar-item");const Ve=p(a({name:Ie,props:v({},m,{dot:Boolean,icon:String,name:r,badge:r,badgeProps:Object,iconPrefix:String}),emits:["click"],setup(e,{emit:a,slots:o}){const t=f(),s=h().proxy,{parent:l,index:r}=g(_e);if(!l)return;const d=C((()=>{var a;const{route:o,modelValue:t}=l.props;if(o&&"$route"in s){const{$route:a}=s,{to:o}=e,t=P(o)?o:{path:o};return!!a.matched.find((e=>{const a="path"in t&&t.path===e.path,o="name"in t&&t.name===e.name;return a||o}))}return(null!=(a=e.name)?a:r.value)===t})),i=o=>{var s;d.value||l.setActive(null!=(s=e.name)?s:r.value,t),a("click",o)},n=()=>o.icon?o.icon({active:d.value}):e.icon?c(b,{name:e.icon,classPrefix:e.iconPrefix},null):void 0;return()=>{var a;const{dot:t,badge:s}=e,{activeColor:r,inactiveColor:u}=l.props,p=d.value?r:u;return c("div",{role:"tab",class:Se({active:d.value}),style:{color:p},tabindex:0,"aria-selected":d.value,onClick:i},[c(y,k({dot:t,class:Se("icon"),content:s},e.badgeProps),{default:n}),c("div",{class:Se("text")},[null==(a=o.default)?void 0:a.call(o,{active:d.value})])])}}}));const je={class:"com-product-item"},Me={class:"content-wrap"},$e={class:"product-image"},Oe={class:"product-info"},qe={class:"title"},Be={class:"description"},Ue={class:"tags"};var Fe=L(a({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const a=e,{productInfo:o}=x(a),t=_({checked:!1});return x(t),(a,t)=>{var s,l,r,d,i;const n=q;return w(),I("div",je,[S("div",Me,[S("div",$e,[c(n,{src:(null==(s=V(o).showConfig)?void 0:s.fileThumbnailUrl)||(null==(l=V(o).showConfig)?void 0:l.fileUrl)},null,8,["src"])]),S("div",Oe,[S("p",qe,j(null==(r=V(o).showConfig)?void 0:r.title),1),S("p",Be,j(null==(d=V(o).showConfig)?void 0:d.text),1),S("p",Ue,[(w(!0),I(M,null,$(null==(i=V(o).showConfig)?void 0:i.tags,((e,a)=>(w(),I("span",{key:a,class:"tag"},j(e),1)))),128))])]),O(a.$slots,"checkedProduct",{},void 0,!0)]),c(pe,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-002f53ee"]]);const Ae=["xlink:href"],Ne=a({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const a=e,o=C((()=>`#icon-${a.name}`)),t=C((()=>a.name?`svg-icon icon-${a.name}`:"svg-icon"));return(a,s)=>(w(),I("svg",k({class:V(t)},a.$attrs,{style:{color:e.color}}),[S("use",{"xlink:href":V(o)},null,8,Ae)],16))}});const Te=e=>(Z("data-v-88e3365a"),e=e(),G(),e),Re={class:"com-tab-filter"},ze={class:"article-mid"},Ee={class:"article-tag"},De=["onClick"],He=Te((()=>S("span",null,null,-1))),Ke={class:"popup-inner"},We=Te((()=>S("div",{class:"popup-title"},"保险公司",-1))),Xe={class:"footer-button"};var Ze=L(a({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(e,{emit:a}){const t=e,{isPopShow:s,openPop:l,closePop:r}=function(e=!1){const a=o(e);return{isPopShow:a,openPop:e=>{e instanceof Function&&e(),a.value=!0},closePop:e=>{a.value=!1,e instanceof Function&&e()}}}(!1),d=_({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:i,checkedInsure:n}=x(d),u=o(""),p=()=>{n.value=[]},v=()=>{var e;const{productCategoryId:o}=(null==(e=d.productCategoryList)?void 0:e[u.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:o}),r()};B((()=>{t.filter&&U().then((e=>{const{code:a,data:o}=e;"10000"===a&&(i.value=null==o?void 0:o.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),F((()=>{ge().then((e=>{const{code:a,data:o}=e||{};"10000"===a&&K(o)&&(d.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...o])}))}));const m=o();return B((()=>{m.value=document.querySelector(".page-proposal")})),(o,t)=>{const f=W,h=X;return w(),I("div",Re,[S("div",ze,[S("div",Ee,[(w(!0),I(M,null,$(V(d).productCategoryList,((e,o)=>(w(),I("div",{key:o,class:A(["tag-item",{checked:V(u)==o}]),onClick:t=>((e,o)=>{var t;u.value=o;const{productCategoryId:s}=(null==(t=d.productCategoryList)?void 0:t[u.value])||{};a("onSelectInsure",{selectInsureCode:n.value,selectCategory:s})})(null==e||e.productCategoryId,o)},[S("div",{class:A(["tag-out",{checked:V(u)==o}])},[S("div",{class:A(["tag-item-text",{checked:V(u)==o}])},j(e.productCategoryName),3)],2)],10,De)))),128))]),e.filter?(w(),I("div",{key:0,class:"filter",onClick:t[0]||(t[0]=(...e)=>V(l)&&V(l)(...e))},[He,S("div",{class:A(["text",{"has-select-condition":V(n).length>0}])},"筛选",2),c(Ne,{name:"filter"})])):N("",!0),V(m)?(w(),T(h,{key:1,show:V(s),position:"right","close-on-click-overlay":"",class:"proposal-list-filter-popup-wrap",style:H(e.popupStyle),onClickOverlay:V(r)},{default:R((()=>[S("div",Ke,[We,c(z,{modelValue:V(n),"onUpdate:modelValue":t[1]||(t[1]=e=>E(n)?n.value=e:null),options:V(i)},null,8,["modelValue","options"])]),S("div",Xe,[c(f,{plain:"",type:"primary",onClick:p},{default:R((()=>[D("重置")])),_:1}),c(f,{type:"primary",onClick:v},{default:R((()=>[D("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])):N("",!0)])])}}}),[["__scopeId","data-v-88e3365a"]]);const Ge={class:"com-trial-product-wrapper"},Je={class:"container"},Qe=(e=>(Z("data-v-49f70a68"),e=e(),G(),e))((()=>S("span",{class:"title"}," 已选产品 ",-1))),Ye={class:"popup-body"},ea={class:"cell-title"},aa={class:"title"},oa=a({name:"TrialProductPopup"});var ta=L(a({...oa,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:a}){const t=e,s=o([]),l=o([]),r=o({isShow:t.isShow}),d=()=>{a("close")},i=()=>{l.value=[],a("checked",[])},n=e=>{var o,t,r;null==(r=null==(t=null==(o=null==s?void 0:s.value)?void 0:o[e])?void 0:t.toggle)||r.call(t),a("checked",l.value)};return J((()=>t.isShow),(e=>{r.value.isShow=e})),J(l,((e=[])=>{a("update:modalValue",e)}),{deep:!0,immediate:!0}),J((()=>t.modalValue),((e=[])=>{l.value=e}),{deep:!0,immediate:!0}),(a,o)=>{const t=Y,u=ee,p=ke,v=ae,m=X;return w(),I("div",Ge,[c(m,{show:V(r).isShow,"onUpdate:show":o[1]||(o[1]=e=>V(r).isShow=e),position:"bottom",onClose:d},{default:R((()=>[S("div",Je,[S("div",{class:"popup-header"},[S("span",{class:"clear-all",onClick:i}," 清空选项 "),Qe,S("span",{class:"close",onClick:d})]),S("div",Ye,[c(v,{modelValue:V(l),"onUpdate:modelValue":o[0]||(o[0]=e=>E(l)?l.value=e:null)},{default:R((()=>[c(p,{inset:""},{default:R((()=>[(w(!0),I(M,null,$(e.proposalList,(e=>(w(),T(u,{key:e.productCode,title:e.productName,onClick:a=>n(e.productCode)},{"right-icon":R((()=>{var a;return[c(t,{ref_for:!0,ref:a=>V(s)[e.productCode]=a,shape:"square","model-value":null==(a=V(l))?void 0:a.includes(e.productCode),name:e.productCode,onClick:Q((a=>n(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:R((()=>[S("div",ea,[S("div",aa,j(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const sa={class:"page-proposal-list"},la={class:"check-button"},ra={key:1,class:"van-sticky"},da={class:"add-plan"},ca={class:"has-select-product"},ia=(e=>(Z("data-v-a3bf660a"),e=e(),G(),e))((()=>S("span",{class:"icon"},null,-1))),na=a({name:"ProposalList"});var ua=L(a({...na,props:{isCreateProposal:{type:Boolean,default:!0}},setup(e){const a=ve(),t=oe(),s=te(),{isCreateProposal:l,productClass:r}=s.query,d=se(),i=_({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],excludeMainRiskCode:[],firstLoading:!0}),{searchValue:n,tagLists:u,isOpen:p,loading:v,finished:m,refreshing:f,productList:h,selectProduct:g,insurerCodeList:y,showCategory:k,productTotal:P,showFooter:b}=x(i);le();const[L,O]=le(),q=o(+(r||1)),B=C((()=>{const e=a.$state.insuredPersonVO||{};return Object.keys(e).length?[e]:[]})),U=()=>{const{excludeProductCodeList:e}=i;i.firstLoading&&ce.loading("加载中..."),Ce({productName:n.value,insurerCodeList:y.value,productClass:q.value,showCategory:k.value,selectProductCodes:Array.isArray(e)?e:[],selectRiskCodes:i.excludeMainRiskCode||[],insuredList:B.value,holder:a.$state.holder,pageNum:1,pageSize:999}).then((e=>{const{code:a,data:o,total:t}=e;"10000"===a&&(h.value=o,P.value=t)})).finally((()=>{ce.clear(),i.firstLoading=!1}))},A=e=>{U()},z=e=>{const{selectInsureCode:a,selectCategory:o}=e;y.value=a,k.value=o,U()},H=()=>{f.value&&(h.value=[],f.value=!1),U(),v.value=!1,P.value===h.value.length&&(m.value=!0)},K=()=>{t.push({path:"historyProposalList"})};C((()=>{var e;const{birthday:o,gender:t}=(null==(e=a.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:o,gender:t}}));const X=C((()=>h.value.length>0)),Z=({productCode:e})=>l?(i.productCode=e,i.selectProduct.includes(e)?(i.selectProduct=i.selectProduct.filter((a=>a!==e)),!1):void(async(e,o)=>{const{code:t,data:s,message:l}=await Pe({...a.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===t?(i.errorMsgMap[e]="","function"==typeof o&&o(!0)):i.errorMsgMap[e]=l})(e,(()=>{i.selectProduct.push(e)}))):(t.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),G=e=>{i.selectProduct=e,i.selectedProductList=i.selectedProductList.filter((a=>e.includes(a.productCode)))},J=()=>{const e=i.proposalList.filter((e=>i.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));a.setTrialData(e),a.setSelectedProduct(i.selectProduct),a.setSelectedProductList(i.selectedProductList),t.back()},Q=()=>{m.value=!0,v.value=!0,H()};return F((()=>{i.excludeProductCodeList=a.$state.excludeProduct,i.excludeMainRiskCode=a.$state.excludeMainRiskCode})),(e,a)=>{const o=Ve,t=we,s=me,u=Y,p=ue,g=ne,C=W,y=re("ProPageWrap"),k=ie;return w(),T(k,{"theme-vars":V(d)},{default:R((()=>[c(y,{class:"page-proposal"},{default:R((()=>[c(s,{modelValue:V(n),"onUpdate:modelValue":a[1]||(a[1]=e=>E(n)?n.value=e:null),placeholder:"请输入计划书名称",onSearch:A},{default:R((()=>[c(Ze,{"filter-class":"filter-area",onOnSelectInsure:z}),c(t,{modelValue:V(q),"onUpdate:modelValue":a[0]||(a[0]=e=>E(q)?q.value=e:null),disabled:"","active-color":"var(--van-primary-color)","inactive-color":"black",fixed:!1,"before-change":()=>!V(r),onChange:U},{default:R((()=>[c(o,{name:1},{default:R((()=>[D("非组合计划书")])),_:1}),c(o,{name:4},{default:R((()=>[D("组合计划书")])),_:1})])),_:1},8,["modelValue","before-change"])])),_:1},8,["modelValue"]),V(X)||V(i).firstLoading?N("",!0):(w(),T(fe,{key:0,"empty-img":V(he),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),S("div",sa,[c(g,{modelValue:V(f),"onUpdate:modelValue":a[3]||(a[3]=e=>E(f)?f.value=e:null),onRefresh:Q},{default:R((()=>[c(p,{loading:V(v),"onUpdate:loading":a[2]||(a[2]=e=>E(v)?v.value=e:null),finished:V(m),"finished-text":V(X)?"- 已经到底了哦 -":"",onLoad:H},{default:R((()=>[(w(!0),I(M,null,$(V(h),(e=>(w(),T(Fe,{key:e.id,"product-info":e,"error-msg":V(i).errorMsgMap[e.productCode],onClick:a=>Z(e)},de({_:2},[V(l)?{name:"checkedProduct",fn:R((()=>[S("div",la,[(w(),T(u,{key:e.id,name:e.productCode,"model-value":V(i).selectProduct.includes(e.productCode),shape:"square",onChange:a=>((e,a)=>{e?i.selectedProductList.push(a):i.selectedProductList=i.selectedProductList.filter((e=>e.productCode!==a.productCode))})(a,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),V(l)&&V(b)?(w(),I("div",ra,[S("div",da,[S("p",{class:"has-select",onClick:a[4]||(a[4]=e=>V(O)(!V(L)))},[D(" 已选"),S("span",ca,j(V(i).selectProduct.length),1),D("款产品 "),ia]),c(C,{type:"primary",disabled:!V(i).selectProduct.length,onClick:J},{default:R((()=>[D("添加到计划书")])),_:1},8,["disabled"])])])):N("",!0),c(ta,{"modal-value":V(i).selectProduct,"proposal-list":V(i).selectedProductList,"is-show":V(L),onClose:a[5]||(a[5]=e=>V(O)(!1)),onChecked:G},null,8,["modal-value","proposal-list","is-show"])])),_:1}),V(l)?N("",!0):(w(),T(ye,{key:0,"button-image":V("/static/png/lishijihuashu-b6958e78.png"),onClick:K},null,8,["button-image"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-a3bf660a"]]);export{ua as default};
