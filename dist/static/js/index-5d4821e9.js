import{_ as e,d as t,g as a,o,c as s,a as d,e as l,u as n,da as r,b as i,al as c,a8 as u,dx as p,w as v,aw as m,c2 as g,l as y,q as I,aA as f,T as b,a9 as C,an as h,at as N,au as k,dy as _,co as D,h as S,i as Y,j as U,z as T,O as x,b7 as j,m as L,d9 as P,n as q,F as w}from"./index-d5e08f40.js";import{_ as A}from"./index-0ce91838.js";import{L as B}from"./index-23901af3.js";import{d as E,q as G}from"./order-5dfa88b3.js";import{I as W}from"./infoItem-de948487.js";import"./empty-ae586b6c.js";const M={class:"com-order-item"},O={class:"header"},R={class:"product-name"},z={class:"status"},F={class:"info"},H={class:"info-bottom"},X=(e=>(N("data-v-4c15aef8"),e=e(),k(),e))((()=>d("div",{style:{width:"25%"}},[d("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),Z={class:"footer"},J={class:"fee"},K={class:"money"},Q={key:0,class:"buttons"},V={key:1,class:"buttons"},$={key:2,class:"buttons"};var ee=e(t({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:t}){const N=e,k=a(),D=()=>{f.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{E(N.detail.id,N.detail.orderStatus).then((e=>{const{code:a,data:o}=e;"10000"===a&&(b.success("删除成功"),t("afterDelete"))}))}))},S=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyId:r,saleChannelId:i,orderTopStatus:c}=N.detail;if((p.PENDING===c||p.PAYING===c)&&[_.ZXYS,_.BWYL,_.BWYLUP].includes(e)){const a={[_.ZXYS]:"/internet/productDetail/package",[_.BWYL]:"/internet/productDetail",[_.BWYLUP]:"/internet/guaranteeUpgrade"};return k.push({path:a[e],query:{productCode:e,saleChannelId:i,agentCode:o,tenantId:d,agencyCode:r,orderNo:t}}),!0}return!1},Y=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyId:r}=N.detail;S()||k.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyCode:r}})};return(t,a)=>{var f;const b=h;return o(),s("div",M,[d("div",O,[d("div",R,l(e.detail.productName),1),d("div",z,l(n(r)[e.detail.orderStatus]),1)]),d("div",F,[i(W,{label:"订单号",content:e.detail.orderNo,line:"","is-copy":""},null,8,["content"]),i(W,{label:"投保单号",content:e.detail.applicationNo,line:"","is-copy":""},null,8,["content"]),i(W,{label:"保单号",content:e.detail.policyNo,line:"","is-copy":""},null,8,["content"]),d("div",H,[d("div",null,[i(W,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),i(W,{label:"被保人",content:null==(f=e.detail.insuredName)?void 0:f[0],line:""},null,8,["content"]),i(W,{label:"创建时间",content:n(c)(e.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss"),line:""},null,8,["content"])]),X])]),d("div",Z,[d("div",J,[u(" 保费："),d("span",K,"￥"+l(e.detail.premium),1)]),e.detail.orderTopStatus===n(p).PENDING?(o(),s("div",Q,[i(b,{class:"button",onClick:m(D,["stop"])},{default:v((()=>[u("删除")])),_:1},8,["onClick"]),n(g).UNDERWRITING_FAILED!==e.detail.orderStatus?(o(),y(b,{key:0,class:"button primary",onClick:a[0]||(a[0]=m((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:o,templateId:s,tenantId:d,insurerCode:l,productCategory:n,agencyId:r,saleChannelId:i,orderStatus:c,abbreviation:u}=N.detail;S()||C("orderDetail",{orderNo:t,agentCode:o,tenantId:d,abbreviation:u,productCategory:n})})()),["stop"]))},{default:v((()=>[u("去处理")])),_:1})):I("",!0)])):I("",!0),e.detail.orderTopStatus===n(p).PAYING?(o(),s("div",V,[i(b,{class:"button primary",onClick:m(Y,["stop"])},{default:v((()=>[u("去支付")])),_:1},8,["onClick"])])):I("",!0),e.detail.orderTopStatus===n(p).TIMEOUT?(o(),s("div",$,[i(b,{class:"button",onClick:m(D,["stop"])},{default:v((()=>[u("删除")])),_:1},8,["onClick"])])):I("",!0)])])}}}),[["__scopeId","data-v-4c15aef8"]]);const te={class:"page-order"},ae=(e=>(N("data-v-93b0bdf6"),e=e(),k(),e))((()=>d("div",{class:"footer"},[d("img",{src:"/static/png/logo-b728275d.png",alt:"",style:{width:"100%",height:"128px"}})],-1))),oe={key:1,class:"empty-box"};var se=e(t({__name:"index",setup(e){const t=D();a();const l=S(),{type:r,tenantId:c,agentCode:u}=l.query,p=Y({"-1":1,0:2,1:3,2:4}[r]||0),m=Y(1),g=Y(!1),I=Y(!1),f=Y([]);Y(0),Y(0),Y(0);const h=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],N=U((()=>(f.value=[],h[p.value].status))),k=()=>{b.loading({message:"加载中...",forbidClick:!0}),g.value=!0,G({condition:{orderTopStatus:N.value,tenantId:c,agentCode:u},pageSize:10,pageNum:m.value}).then((e=>{var t;g.value=!1;const{code:a,data:o}=e;"10000"===a&&o&&(1===m.value?f.value=o.datas||[]:f.value=[...f.value,...(null==(t=o.datas[0])?void 0:t.applicationResList)||[]]),I.value=!o||f.value.length>=(null==o?void 0:o.total)})).then((()=>{b.clear()}))},_=()=>{m.value+=1,k()},E=()=>{m.value=1,k()};return T(N,(()=>{m.value=1,k()})),x((()=>{k()})),(e,a)=>{const l=B,r=A,m=j;return o(),y(m,{"theme-vars":n(t)},{default:v((()=>[d("div",te,[i(P,{active:n(p),"onUpdate:active":a[0]||(a[0]=e=>L(p)?p.value=e:null),list:h,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),n(f).length?(o(),y(l,{key:0,class:"body",loading:n(g),finished:n(I),onLoad:_},{default:v((()=>[(o(!0),s(w,null,q(n(f),((e,t)=>(o(),y(ee,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,abbreviation:o,productCategory:s,applicationNo:d,orderId:l}=e;C("orderDetail",{orderNo:t,agentCode:u,tenantId:c,abbreviation:o,productCategory:s,applicationNo:d,orderId:l})})(e),onAfterDelete:E},null,8,["detail","onClick"])))),128)),ae])),_:1},8,["loading","finished"])):(o(),s("div",oe,[i(r,{title:"暂无投保单","empty-class":"empty-select"})]))])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-93b0bdf6"]]);export{se as default};
