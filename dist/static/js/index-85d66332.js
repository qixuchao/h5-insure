var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var U=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var V=(f,u,i)=>u in f?Z(f,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):f[u]=i,P=(f,u)=>{for(var i in u||(u={}))ne.call(u,i)&&V(f,i,u[i]);if(U)for(var i of U(u))re.call(u,i)&&V(f,i,u[i]);return f},q=(f,u)=>ee(f,te(u));import{g as oe,af as ae,Q as se,a5 as de,C as L,L as ue,o as ie,X as M,r as m,h as I,j as E,k as c,z as s,n as l,s as R,m as x,F as le,E as ce,y as _,I as b,B as N}from"./vendor-d47732e4.js";import{F as h,E as H,P as fe}from"./index-db87a2a1.js";import{c as pe,n as me,a as Ie}from"./index-fe2b9b8d.js";import{_ as Y,R as _e,B as ye,A as Oe,a as Ee}from"./index-53473330.js";import"./useDicData-732ea23a.js";const Be={key:0,class:"beneficiary-part"},Ae={class:"part-title"},Le={class:"title"},ve=N("\u5220\u9664"),ge=N("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),Te=N("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ce={class:"radio-item-wrapper"},De={class:"name"},Fe={class:"hone"},Re={class:"address"},be={class:"footer-button"},he=N("\u4E0B\u4E00\u6B65"),Ue=oe({setup(f){const u=ae(),i=se(),{templateId:k=1,orderNo:$="2022072710380711215",tenantId:w="9991000007"}=i.query,[j,G]=de(),S=i.path==="/infoPreview"?"infoPreview":"infoCollection",v=L({}),e=L({extInfo:{pageCode:S},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),W=L(null),y=L([]),O=L([]),d=ue({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),z=()=>{const t=P({},e.value);t.tenantOrderAttachmentList=[{category:h.OBVERSE_CERT,objectType:H.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:y.value[0]},{category:h.REVERSE_CERT,objectType:H.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:y.value[1]},{category:h.OBVERSE_CERT,objectType:H.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:O.value[0]},{category:h.REVERSE_CERT,objectType:H.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:O.value[1]}],me(t).then(({code:n,data:r})=>{n==="10000"&&r.pageAction.pageAction==="jumpToPage"&&u.push({path:fe[r.pageAction.data.nextPageCode],query:i.query})})},J=t=>{console.log("value",t)},Q=()=>{d.beneficiaryId+=1,e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:d.beneficiaryId,extInfo:{}})},X=t=>{e.value.tenantOrderInsuredList[0].beneficiaryReqList=e.value.tenantOrderInsuredList[0].beneficiaryReqList.filter(n=>n.beneficiaryId!==t.beneficiaryId)},K=()=>{Ie({orderNo:$,tenantId:w}).then(({code:t,data:n})=>{if(t==="10000"){const r=n;r.extInfo=q(P({},r.extInfo),{pageCode:S,templateId:k}),r.tenantOrderHolder=r.tenantOrderHolder||{},r.tenantOrderHolder.extInfo=r.tenantOrderHolder.extInfo||{},r.tenantOrderInsuredList[0].extInfo=r.tenantOrderInsuredList[0].extInfo||{},r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{const p=o;return p.extInfo={},p}),r.tenantOrderAttachmentList.forEach(o=>{o.category,o.objectType,o.category===22?o.objectType===2?y[0]=o.uri:o.objectType===3&&(O[0]=o.uri):o.category===23&&(o.objectType===2?y[1]=o.uri:o.objectType===3&&(O[1]=o.uri))}),Object.assign(e.value,r)}}).finally(()=>{d.isLoading=!1})};return ie(()=>{K(),pe({pageCode:"infoCollection",templateId:k}).then(({code:t,data:n})=>{if(t==="10000"){const r={BENEFICIARY:[],INSURER:[],HOLDER:[]};n.productInsureFactorList.forEach(o=>{(r[o.moduleType]=r[o.moduleType]||[]).push(o)}),v.value=r}})}),M(()=>e.value,t=>{var n,r,o,p,g,B,T,C,D,F;if(t){const a=[{contactAddress:((r=(n=t.tenantOrderHolder)==null?void 0:n.extInfo)==null?void 0:r.familyAddress)||1231123,contactName:t.tenantOrderHolder.name||123131,contactPhoneNo:t.tenantOrderHolder.mobile||123132},{contactAddress:(p=(o=t.tenantOrderHolder)==null?void 0:o.extInfo)==null?void 0:p.workAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(B=(g=t.tenantOrderInsuredList[0])==null?void 0:g.extInfo)==null?void 0:B.familyAddress,contactName:(T=t.tenantOrderInsuredList[0])==null?void 0:T.name,contactPhoneNo:(C=t.tenantOrderInsuredList[0])==null?void 0:C.mobile},{contactAddress:(F=(D=t.tenantOrderInsuredList[0])==null?void 0:D.extInfo)==null?void 0:F.workAddress,contactName:t.tenantOrderInsuredList[0].name,contactPhoneNo:t.tenantOrderInsuredList[0].mobile}];d.addressList=a.filter(A=>A.contactAddress&&A.contactName&&A.contactPhoneNo)}},{deep:!0,immediate:!0}),M(()=>e.value.tenantOrderInsuredList[0].relationToHolder,t=>{+t==1&&Object.assign(e.value.tenantOrderInsuredList[0],e.value.tenantOrderHolder,{id:e.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(t,n)=>{const r=m("ProCard"),o=m("ProRadioButton"),p=m("ProField"),g=m("ProSvg"),B=m("VanButton"),T=m("ProCheckButton"),C=m("van-cell"),D=m("ProForm"),F=m("ProPageWrap");return I(),E(F,{class:"page-info-wrapper"},{default:c(()=>[s(d).isLoading?R("",!0):(I(),E(D,{key:0,ref_key:"formRef",ref:W},{default:c(()=>[l(r,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[l(Y,{images:y.value,"onUpdate:images":n[0]||(n[0]=a=>y.value=a),"form-info":e.value.tenantOrderHolder,"factor-list":v.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),l(r,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[l(p,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":n[2]||(n[2]=a=>e.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(o,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":n[1]||(n[1]=a=>e.value.tenantOrderInsuredList[0].relationToHolder=a),options:s(_e)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+e.value.tenantOrderInsuredList[0].relationToHolder!=1?(I(),E(Y,{key:0,images:O.value,"onUpdate:images":n[3]||(n[3]=a=>O.value=a),"form-info":e.value.tenantOrderInsuredList[0],"factor-list":v.value.INSURER||[]},null,8,["images","form-info","factor-list"])):R("",!0),l(p,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),l(r,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[l(p,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":n[5]||(n[5]=a=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(o,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":n[4]||(n[4]=a=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:s(ye)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),e.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(I(),x("div",Be,[(I(!0),x(le,null,ce(e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(a,A)=>(I(),x("div",{key:a.beneficiaryId,class:"beneficiary-item"},[_("div",Ae,[_("span",Le,b(`\u53D7\u76CA\u4EBA${A+1}`),1),l(g,{name:"delete",onClick:He=>X(a)},{default:c(()=>[ve]),_:2},1032,["onClick"])]),l(Ee,{"form-info":a,"factor-list":v.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),l(B,{onClick:Q},{default:c(()=>[ge]),_:1})])):R("",!0)]),_:1}),l(r,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>[s(d).currentAddress?(I(),E(C,{key:1,title:"\u5355\u5143\u683C","is-link":""},{title:c(()=>[_("div",Ce,[_("p",null,[_("span",De,b(s(d).addressList[s(d).currentAddress-1].contactName),1),_("span",Fe,b(s(d).addressList[s(d).currentAddress-1].contactPhoneNo),1)]),_("p",Re,b(s(d).addressList[s(d).currentAddress-1].contactAddress),1)])]),_:1})):(I(),E(T,{key:0,activated:"",onClick:n[6]||(n[6]=a=>s(G)(!0))},{default:c(()=>[Te]),_:1}))]),_:1})]),_:1},512)),_("div",be,[l(B,{block:"",type:"primary",onClick:z},{default:c(()=>[he]),_:1})]),s(j)?(I(),E(Oe,{key:1,modelValue:s(d).currentAddress,"onUpdate:modelValue":n[7]||(n[7]=a=>s(d).currentAddress=a),show:s(j),"data-source":s(d).addressList,onSubmit:J},null,8,["modelValue","show","data-source"])):R("",!0)]),_:1})}}});export{Ue as default};
