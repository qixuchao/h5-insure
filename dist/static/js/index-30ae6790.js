var ae=Object.defineProperty,oe=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var V=(i,c,B)=>c in i?ae(i,c,{enumerable:!0,configurable:!0,writable:!0,value:B}):i[c]=B,$=(i,c)=>{for(var B in c||(c={}))re.call(c,B)&&V(i,B,c[B]);if(M)for(var B of M(c))ie.call(c,B)&&V(i,B,c[B]);return i},Y=(i,c)=>oe(i,ne(c));import{g as ce,Q as le,af as de,C as x,d as Be,M as _e,r as Q,h as f,j as fe,k as D,y as u,n as E,I as F,J as q,m as v,s as N,z as g,E as w,F as R,a1 as De,a2 as Ee,B as h,T as z,D as Fe}from"./vendor-f01850c4.js";import{_ as ve,S as Ce,B as he,n as W,j as O,C as G,N as k,P as Ae}from"./index-0dd1165e.js";import{g as pe,f as ge,s as J,a as me}from"./verify-bc9a1d0d.js";import{a as ye,n as Ie}from"./index-eaca83ab.js";const K=i=>(De("data-v-5ed1f3b2"),i=i(),Ee(),i),Ne={class:"page-verify"},Oe={class:"people"},ke={class:"name"},Se={class:"verify-item"},be=K(()=>u("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),xe={class:"no"},we=h(" \u53BB\u8BA4\u8BC1 "),Re={class:"sign-body"},Pe={class:"date"},Le={class:"file"},Ue=h(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A"),He={key:0,class:"dun-hao"},Te={class:"people"},je={class:"name"},Me={class:"verify-item"},Ve=K(()=>u("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),$e={class:"no"},Ye=["onClick"],Qe=h(" \u53BB\u8BA4\u8BC1 "),qe=["onClick"],ze={class:"sign-body"},We={class:"date"},Ge={class:"file"},Je=h(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A"),Ke={key:0,class:"dun-hao"},Xe={class:"footer-button footer"},Ze=h("\u63D0\u4EA4"),eu=ce({setup(i){const c=le(),B=de(),{orderNo:I="2022072810590219649",saleUserId:P="D1234567-1",tenantId:A="9991000007",templateId:X=1,productCode:Z="CQ75CQ76"}=c.query,S=new Ce({source:"localStorage"}),m=x([]),l=x(),y=x(),p=[],L=Be().format("YYYY-MM-DD"),ee=()=>{var s;(s=y.value)==null||s.clear()},ue=s=>{p[s].clear()},U=(s,a)=>{me({callbackUrl:window.location.href,certiNo:s,faceAuthMode:"TENCENT",userName:a,tenantId:9991000007}).then(n=>{const{code:r,data:d}=n;if(r==="10000"){const{originalUrl:e,serialNo:o}=d;window.location.href=e,S.set("verifyData",{serialNo:o,certNo:s,name:a})}})},H=s=>{var a,n,r,d;s===-1?U((a=l.value.tenantOrderHolder)==null?void 0:a.certNo,(n=l.value.tenantOrderHolder)==null?void 0:n.name):U((r=l.value.tenantOrderInsuredList[s])==null?void 0:r.certNo,(d=l.value.tenantOrderInsuredList[s])==null?void 0:d.name)},te=s=>{s&&p.every(a=>a!==s)&&p.push(s)},se=()=>{var a;if((a=y.value)==null?void 0:a.isEmpty()){z.fail("\u8BF7\u6295\u4FDD\u4EBA\u7B7E\u540D");return}if(p.some(n=>n.isEmpty())){z.fail("\u8BF7\u88AB\u4FDD\u4EBA\u7B7E\u540D");return}Fe.confirm({title:"\u63D0\u793A",message:"\u8BF7\u786E\u8BA4\u4FE1\u606F\u586B\u5199\u65E0\u8BEF\u540E\uFF0C\u518D\u8FDB\u884C\u652F\u4ED8"}).then(()=>{var r,d;const n=(r=y.value)==null?void 0:r.save();Promise.all([J("HOLDER",n,(d=l.value)==null?void 0:d.id,`${A}`),...p.map(e=>{var o;return J("INSURED",e.save(),(o=l.value)==null?void 0:o.id,`${A}`)})]).then(()=>{Ie(Y($({},l.value),{pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:{pageCode:"sign",templateId:X}})).then(e=>{const{code:o,data:t}=e;o==="10000"&&t.success&&B.push({path:Ae[t.pageAction.data.nextPageCode],query:{orderNo:I,saleUserId:P,tenantId:A}})})})})};return _e(()=>{ye({orderNo:I,saleUserId:P,tenantId:A}).then(a=>{const{code:n,data:r}=a;if(n==="10000"){l.value=r;let d=0;r.tenantOrderAttachmentList.forEach(e=>{e.category===21&&(e.objectType===2?y.value.setDataURL(e.fileBase64):e.objectType===1&&(p[d].setDataURL(e.fileBase64),d+=1))})}}),pe({orderNo:I,productCode:Z,tenantId:A}).then(a=>{const{code:n,data:r}=a;n==="10000"&&(m.value=r||[])});const s=S.get("verifyData");if(s){const{serialNo:a,certNo:n,name:r}=s;ge({certiNo:n,orderNo:I,serialNo:a,tenantId:A,userName:r}).then(d=>{S.remove("verifyData")})}}),(s,a)=>{const n=Q("van-button"),r=Q("ProPageWrap");return f(),fe(r,null,{default:D(()=>{var d;return[u("div",Ne,[E(he,{type:"warning",title:"\u5C0A\u656C\u7684\u5BA2\u6237\uFF0C\u672C\u6B21\u6295\u4FDD\u9700\u8981\u8FDB\u884C\u8EAB\u4EFD\u8BA4\u8BC1",content:"\u672C\u4EA7\u54C1\u6295\u4FDD\u9700\u8981\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\uFF0C\u60A8\u8D2D\u4E70\u672C\u4EA7\u54C1\u7684\u7D2F\u8BA1\u603B\u4FDD\u8D39\u5DF2\u8D85\u8FC720\u4E07\uFF0C\u6309\u76D1\u7BA1\u8981\u6C42\uFF0C\u9700\u8981\u63D0\u4F9B\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u3001\u6307\u5B9A\u53D7\u76CA\u4EBA\u8BC1\u4EF6\u5F71\u50CF\uFF0C\u672C\u4EA7\u54C1\u975E\u672C\u4EBA\u6295\u4FDD\u4E14\u5E26\u8EAB\u6545\u8D23\u4EFB\u3001\u9700\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\uFF08\u6210\u4EBA\uFF09\u7684\u6295\u4FDD\u610F\u613F\u8FDB\u884C\u7B7E\u5B57\u786E\u8BA4\u3002"}),E(O,{title:"\u6295\u4FDD\u4EBA",class:"card"},{extra:D(()=>{var e,o,t,_,C,b,T,j;return[u("div",Oe,[u("div",ke,F((o=(e=l.value)==null?void 0:e.tenantOrderHolder)==null?void 0:o.name),1),u("div",{class:q(["status",{verified:(C=(_=(t=l.value)==null?void 0:t.tenantOrderHolder)==null?void 0:_.extInfo)==null?void 0:C.isCert}])},F(((j=(T=(b=l.value)==null?void 0:b.tenantOrderHolder)==null?void 0:T.extInfo)==null?void 0:j.isCert)?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:D(()=>{var e,o,t,_,C;return[u("div",Se,[be,u("div",xe,F((o=(e=l.value)==null?void 0:e.tenantOrderHolder)==null?void 0:o.certNo),1),((C=(_=(t=l.value)==null?void 0:t.tenantOrderHolder)==null?void 0:_.extInfo)==null?void 0:C.isCert)?N("",!0):(f(),v("div",{key:0,class:"action",onClick:a[0]||(a[0]=b=>H(-1))},[we,E(W,{name:"right_arrow",class:"icon"})]))])]}),_:1}),E(O,{title:"\u6295\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:D(()=>[u("div",{class:"resign",onClick:ee},"\u91CD\u7B7E")]),default:D(()=>[E(G,{ref_key:"holderSign",ref:y,class:"sign"},null,512),u("div",Re,[u("div",Pe,"\u7B7E\u540D\u65E5\u671F\uFF1A "+F(g(L)),1),u("div",Le,[Ue,(f(!0),v(R,null,w(m.value.filter(e=>e.noticeObject===g(k).HOLDER),(e,o)=>(f(),v("span",{key:o,class:"file-name"},[h(F(`\u300A${e.materialName}\u300B`),1),o!==m.value.filter(t=>t.noticeObject===g(k).HOLDER).length-1?(f(),v("span",He,"\u3001")):N("",!0)]))),128))])])]),_:1}),(f(!0),v(R,null,w((d=l.value)==null?void 0:d.tenantOrderInsuredList,(e,o)=>(f(),v("div",{key:o},[E(O,{title:"\u88AB\u4FDD\u4EBA",class:"card"},{extra:D(()=>{var t,_;return[u("div",Te,[u("div",je,F(e.name),1),u("div",{class:q(["status",{verified:(t=e.extInfo)==null?void 0:t.isCert}])},F(((_=e.extInfo)==null?void 0:_.isCert)?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:D(()=>{var t;return[u("div",Me,[Ve,u("div",$e,F(e.certNo),1),((t=e.extInfo)==null?void 0:t.isCert)?N("",!0):(f(),v("div",{key:0,class:"action",onClick:_=>H(o)},[Qe,E(W,{name:"right_arrow",class:"icon"})],8,Ye))])]}),_:2},1024),E(O,{title:"\u88AB\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:D(()=>[u("div",{class:"resign",onClick:t=>ue(o)},"\u91CD\u7B7E",8,qe)]),default:D(()=>[E(G,{ref_for:!0,ref:te,class:"sign"}),u("div",ze,[u("div",We,"\u7B7E\u540D\u65E5\u671F\uFF1A "+F(g(L)),1),u("div",Ge,[Je,(f(!0),v(R,null,w(m.value.filter(t=>t.noticeObject===g(k).INSURED),(t,_)=>(f(),v("span",{key:_,class:"file-name"},[h(F(`\u300A${t.materialName}\u300B`),1),_!==m.value.filter(C=>C.noticeObject===g(k).INSURED).length-1?(f(),v("span",Ke,"\u3001")):N("",!0)]))),128))])])]),_:2},1024)]))),128)),u("div",Xe,[E(n,{type:"primary",class:"submit-btn",onClick:se},{default:D(()=>[Ze]),_:1})])])]}),_:1})}}});var nu=ve(eu,[["__scopeId","data-v-5ed1f3b2"]]);export{nu as default};
