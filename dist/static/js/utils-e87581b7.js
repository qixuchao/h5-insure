import{C as e}from"./index-00e424aa.js";import{q as i}from"./createProposal-6d09e532.js";import"./trial-3b9ebb5d.js";const t=({holder:e,insuredList:i=[]})=>{const t=["birthday","certEndDate","certEndType","certNo","certStartDate","verificationCode","certType","email","gender","mobile","name","id","insuredBeneficiaryType","relationToHolder","relationToMainInsured","tenantOrderBeneficiaryList","extInfo"],r=e=>{const i={extInfo:{}};return"[object Object]"==={}.toString.call(e)&&Object.keys(e).forEach((r=>{t.includes(r)?i[r]=e[r]:i.extInfo[r]=e[r]})),i};return{tenantOrderHolder:r(e),tenantOrderInsuredList:(i||[]).map((e=>r(e)))}},r=async({proposalId:e,productCode:t,tenantId:r,proposalInsuredId:a},o)=>{const n=(await i({id:e,tenantId:r})).data,l={holder:{},insuredVOList:[],productCode:t};l.holder={personVO:null==n?void 0:n.holder},l.insuredVOList=null==n?void 0:n.insuredList.filter((e=>e.id===+a)).map((e=>({personVO:{age:e.age,birthday:e.birthday,bmi:e.bmi,certNo:e.certNo,certType:e.certType,email:e.email,gender:e.gender,hasSocialInsurance:e.hasSocialInsurance,height:e.height,holderRelation:e.holderRelation,insureAreaCode:e.insureAreaCode,insureCityCode:e.insureCityCode,insureProvinceCode:e.insureProvinceCode,mobile:e.mobile,name:e.name,occupationClass:e.occupationClass,occupationCodeList:e.occupationCode,smokeFlag:e.smokeFlag,socialFlag:e.socialFlag,weight:e.weight},productPlanVOList:e.proposalInsuredProductList.map((e=>({insurerCode:null,planCode:"",relationToHolder:"1",riskVOList:e.proposalProductRiskList.map((e=>({amount:e.amount,annuityDrawDate:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,chargePeriod:e.chargePeriod,copy:e.copy,coveragePeriod:e.coveragePeriod,liabilityVOList:e.liabilityVOList.map((e=>({liabilityAmount:null,liabilityAttributeType:e.liabilityAttributeType,liabilityAttributeValueList:e.liabilityAttributeValueList,liabilityCode:e.liabilityCode,liabilityId:e.liabilityId,liabilityRateType:null,liabilityValue:null}))),mainRiskCode:e.mainRiskCode,mainRiskId:e.mainRiskId,paymentFrequency:e.paymentFrequency,premium:e.premium,riskCategory:e.riskCategory,riskCode:e.riskCode,riskId:e.riskId,riskName:e.riskName,riskType:e.riskType})))})))}))),null==o||o(l)},a=(i,t,r)=>{const a={...r,...i};let o=[];const{riskInsuredDetailVOList:n=[],initialAmount:l,initialPremium:s=0}=t||{};return n.length&&(o=n.map((e=>{const i={totalPremium:e.totalPremium,riskMap:{}};return e.riskPremiumDetailVOList.forEach((e=>{i.riskMap[e.riskCode]={premium:e.unitPremium,amount:e.unitAmount}})),i}))),a.premium=s,a.orderAmount=s,a.insuredList=(a.insuredList||[]).map(((t,r)=>({...t,certType:t.certType||e.CERT,certNo:(t.certNo||"").toLocaleUpperCase(),productList:(t.productList||[]).map((e=>{var t;return{premium:null==(t=null==o?void 0:o[r])?void 0:t.totalPremium,productCode:i.productCode,productName:i.productName,riskList:(e.riskList||[]).map((e=>{var i,t;const{amount:a,premium:n}=(null==(t=null==(i=null==o?void 0:o[r])?void 0:i.riskMap)?void 0:t[e.riskCode])||{};return{...e,initialAmount:a,initialPremium:n,regularPremium:s,totalPremium:s}}))}}))}))),a};export{t as f,r as p,a as t};
