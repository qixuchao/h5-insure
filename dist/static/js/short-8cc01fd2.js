import{d as be,h as Z,r as I,$ as K,A as L,R as Pe,k as z,ag as xe,m as n,s as o,B as s,F as R,C as t,H as Q,M as ae,L as F,x,n as J,G as ce,t as D,p as Y,I as Te,a5 as ve,a6 as _e,Z as Be,_ as ot,N as Ce,U as lt,T as it,aa as rt,P as ut,l as ct,j as dt,D as pt}from"./vendor-902054a7.js";import{_ as ee,e as Ae,i as pe,a7 as mt,C as he,I as Me,K as ft,a1 as vt}from"./index-2b589d9a.js";import{C as ye,k as se,l as le,m as _t,S as we,R as Se,g as yt}from"./infoCollection-9aa7455c.js";import{i as ht,n as Ee,p as Pt,g as Ct}from"./trial-5f9c866e.js";import{p as It}from"./product-c982e971.js";import{o as Re,r as Dt,t as gt}from"./utils-37500008.js";import{t as qe,u as Ot}from"./theme-fdbb0f53.js";import{B as $e}from"./index-ec3029bf.js";import{P as Vt}from"./index-41bbf693.js";import{L as kt}from"./loading-1c9c1d7b.js";import{_ as Lt,a as Ft}from"./index-1cad1ceb.js";import{u as wt}from"./useDicData-ccc0ffbd.js";import{P as St}from"./index-ac7c43cd.js";import{_ as Et}from"./index-5a71a14f.js";import"./useStorage-5afabf38.js";import"./trial-0a483bd3.js";import"./check-detail-c292a89b.js";import"./relativeTime-cdc592a9.js";const me=(d,g="YYYY-MM-DD")=>be(d).format(g),oe=(d,g=0,i="day",l="YYYY-MM-DD")=>be(d).add(g,i).format(l);const $t=d=>(ve("data-v-9a094e48"),d=d(),_e(),d),Nt={class:"guarantee-list"},bt=$t(()=>s("span",null,"\u4FDD\u969C\u8BA1\u5212",-1)),xt={key:0,class:"picture-payment-content"},Tt=["onClick"],Bt=["src"],At=["src"],Mt={key:1,class:"plan-list"},Rt=["onClick"],qt={key:2,class:"feerate-view"},Ut={class:"guarantee-detail"},Yt={key:0,class:"plan-list"},Ht=["onClick"],jt={key:1},Gt={class:"extinfo-info-list"},zt={class:"content"},Wt=Z({props:{dataSource:{type:Object,default:()=>{}},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:5},activePlanCode:{type:String,default:""},isMultiplePlan:{type:Boolean,default:!1}},emits:["update-active-plan"],setup(d,{emit:g}){var a;const i=d,l=I((a=i.dataSource)==null?void 0:a.planList),m=I(i.activePlanCode);K([()=>i.dataSource,()=>i.activePlanCode],()=>{var e;i.isMultiplePlan&&(l.value=(e=i.dataSource)==null?void 0:e.planList)},{immediate:!0});const O=I([]),y=I([]),u=I(),T=L(()=>i.isMultiplePlan?i.dataSource.planList.map(e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null).filter(e=>!!e):[]);K([()=>i.dataSource,()=>i.activePlanCode],()=>{var e,c,k,A;if(m.value=i.activePlanCode,!i.isMultiplePlan)O.value=(e=i.dataSource)==null?void 0:e.planInsureVO.guaranteeItemVOS,y.value=(c=i.dataSource)==null?void 0:c.planInsureVO.extInfoVOList,u.value=(k=i.dataSource)==null?void 0:k.planInsureVO.productPremiumVOList[0];else if(l.value&&l.value.length>0){let M=0;const te=l.value.findIndex(w=>w.planCode===m.value);te>-1&&(M=te),O.value=l.value[M].guaranteeItemVOS,y.value=l.value[M].extInfoVOList,u.value=(A=l.value[M])==null?void 0:A.productPremiumVOList[0]}},{immediate:!0,deep:!0});const S=L(()=>{var e;return((e=i.dataSource)==null?void 0:e.rateUri)||""}),f=L(()=>!!(u.value&&u.value.paymentFrequencyValue&&u.value.premiumUnit&&!!S)),[v,E]=Pe(!1),B=L(()=>{var e;return!O.value||!((e=O.value)!=null&&e.length)?!1:O.value.length>i.count?i.isShowClose?!0:!v.value:!1}),H=()=>{E()},j=L(()=>{var e;return!O.value||!((e=O.value)!=null&&e.length)?[]:O.value.length<=i.count||v.value?O.value:O.value.slice(0,i.count)}),U=e=>{m.value=e,g("update-active-plan",e)},N=I(!1),$=()=>{N.value=!0},p=()=>{Re({fileType:"pdf",feeFileUri:S.value})};return(e,c)=>{var te,w;const k=z("ProCell"),A=z("ProPopup"),M=xe("dompurify-html");return n(),o(R,null,[s("div",Nt,[s("div",{class:"header"},[bt,s("span",{onClick:$},"\u67E5\u770B\u8BE6\u60C5")]),d.isMultiplePlan?(n(),o(R,{key:0},[t(T).length>0?(n(),o("div",xt,[(n(!0),o(R,null,Q(t(T),P=>(n(),o("div",{key:P.planCode,class:ae("picture-payment-item"),onClick:W=>U(P.planCode)},[m.value==P.planCode?(n(),o("img",{key:0,src:P.selectedPic},null,8,Bt)):(n(),o("img",{key:1,src:P.unSelectedPic},null,8,At))],8,Tt))),128))])):(n(),o("div",Mt,[(n(!0),o(R,null,Q(l.value,(P,W)=>(n(),o("div",{key:`${P.planCode}_${W}`,class:ae(`plan-list-item ${P.planCode===m.value?"plan-list-item-active":""}`),onClick:ne=>U(P.planCode)},[s("span",null,F(P.planName),1)],10,Rt))),128))]))],64)):x("",!0),(n(!0),o(R,null,Q(t(j),(P,W)=>(n(),J(k,{key:W,class:"guarantee-item",title:P.title,content:P.desc,border:!1},null,8,["title","content"]))),128)),t(B)?(n(),o("div",{key:1,class:"show-more",onClick:H},[ce(F(t(v)?"\u6536\u8D77":"\u67E5\u770B\u66F4\u591A")+" ",1),D(Ae,{name:"down",class:ae(["icon",{showMore:t(v)}])},null,8,["class"])])):x("",!0),t(f)?(n(),o("div",qt,[s("span",null,F(`${((te=u.value)==null?void 0:te.paymentFrequencyValue)||""}${((w=u.value)==null?void 0:w.premiumUnit)||""}`),1),t(S)?(n(),o("span",{key:0,onClick:p},"\u67E5\u770B\u4FDD\u8D39")):x("",!0)])):x("",!0)]),D(pe),D(A,{show:N.value,"onUpdate:show":c[0]||(c[0]=P=>N.value=P),title:"\u4FDD\u969C\u8BE6\u60C5",class:"guarantee-popup"},{default:Y(()=>[s("div",Ut,[d.isMultiplePlan?(n(),o("div",Yt,[(n(!0),o(R,null,Q(l.value,(P,W)=>(n(),o("div",{key:`${P.planCode}_${W}`,class:ae(`plan-list-item ${P.planCode===m.value?"plan-list-item-active":""}`),onClick:ne=>U(P.planCode)},[s("span",null,F(P.planName),1)],10,Ht))),128))])):x("",!0),y.value&&y.value.length>0?(n(),o("div",jt,[s("div",Gt,[(n(!0),o(R,null,Q(y.value,(P,W)=>(n(),J(k,{key:W,title:P.name,content:P.description,border:!1,size:"small"},null,8,["title","content"]))),128))]),D(pe)])):x("",!0),(n(!0),o(R,null,Q(O.value,(P,W)=>(n(),o("div",{key:W,class:"guarantee-item"},[D(k,{title:P.title,content:P.desc,border:!1,size:"small"},null,8,["title","content"]),Te(s("div",zt,null,512),[[M,P.content]])]))),128))])]),_:1},8,["show"])],64)}}});var Qt=ee(Wt,[["__scopeId","data-v-9a094e48"]]);const Kt={class:"com-custom-card"},Jt={class:"title"},Xt=Z({props:{title:{type:String,required:!0}},setup(d){return(g,i)=>(n(),o("div",Kt,[s("div",Jt,F(d.title),1),s("div",null,[Be(g.$slots,"default",{},void 0,!0)])]))}});var Ne=ee(Xt,[["__scopeId","data-v-059c21ee"]]);const Zt={class:"question"},en={class:"title"},tn=Z({props:{name:{type:String,default:""},question:{type:String,default:""},answer:{type:String,default:""}},setup(d){return(g,i)=>{const l=z("ProSvg"),m=z("van-collapse-item");return n(),J(m,{name:d.name,class:"com-question-item"},{title:Y(()=>[s("div",Zt,[D(l,{name:"question"}),s("div",en,F(d.question),1)])]),default:Y(()=>[ce(" "+F(d.answer),1)]),_:1},8,["name"])}}});var nn=ee(tn,[["__scopeId","data-v-0d7ea124"]]);const an={class:"com-question"},sn=Z({props:{list:{type:Array,default:()=>[]}},setup(d){const g=d,[i,l]=Pe(!1),m=I([]),O=()=>{l()},y=L(()=>g.list.length<=4||i.value?g.list:g.list.slice(0,4));return(u,T)=>{const S=z("van-collapse");return n(),o("div",an,[D(S,{modelValue:m.value,"onUpdate:modelValue":T[0]||(T[0]=f=>m.value=f)},{default:Y(()=>[(n(!0),o(R,null,Q(t(y),(f,v)=>(n(),J(nn,{key:v,name:v.toString(),question:f.title,answer:f.desc},null,8,["name","question","answer"]))),128))]),_:1},8,["modelValue"]),d.list.length>4?(n(),o("div",{key:0,class:"show-more",onClick:O},[ce(F(t(i)?"\u6536\u8D77":"\u5C55\u5F00")+" ",1),D(Ae,{name:"down",class:ae(["icon",{showMore:t(i)}])},null,8,["class"])])):x("",!0)])}}});var on=ee(sn,[["__scopeId","data-v-1b7e97e9"]]);const ln={class:"spec"},rn=["src"],un={key:1,class:"spec"},cn=["src"],dn=Z({props:{isCheck:{type:Boolean,default:!1},url:{type:String,default:""},detail:{type:Object,default:()=>{}}},setup(d,{expose:g}){const i=d,l=I(),m=I([{title:"\u4EA7\u54C1\u4EAE\u70B9",slotName:"tab1"},{title:"\u7406\u8D54\u8BF4\u660E",slotName:"tab2"},{title:"\u6211\u8981\u6295\u4FDD",slotName:"tab3"}]),O=L(()=>{var f,v,E,B;return((v=(f=i.detail)==null?void 0:f.tenantProductInsureVO)==null?void 0:v.spec)&&((B=(E=i.detail)==null?void 0:E.tenantProductInsureVO)==null?void 0:B.spec.length)>0}),y=L(()=>{var v,E,B,H,j,U,N,$,p,a,e,c,k,A;const f=(E=(v=i.detail)==null?void 0:v.tenantProductInsureVO)==null?void 0:E.settlementProcessVO.settlementProcessType;return!!(f===ye.WORD&&((j=(H=(B=i.detail)==null?void 0:B.tenantProductInsureVO)==null?void 0:H.settlementProcessVO)==null?void 0:j.settlementProcessList)&&(($=(N=(U=i.detail)==null?void 0:U.tenantProductInsureVO)==null?void 0:N.settlementProcessVO)==null?void 0:$.settlementProcessList.length)>0||f===ye.IMAGE&&((e=(a=(p=i.detail)==null?void 0:p.tenantProductInsureVO)==null?void 0:a.settlementProcessVO)==null?void 0:e.settlementProcessPicList)&&((A=(k=(c=i.detail)==null?void 0:c.tenantProductInsureVO)==null?void 0:k.settlementProcessVO)==null?void 0:A.settlementProcessPicList.length)>0)}),u=L(()=>{var f,v,E,B;return((v=(f=i.detail)==null?void 0:f.tenantProductInsureVO)==null?void 0:v.questionList)&&((B=(E=i.detail)==null?void 0:E.tenantProductInsureVO)==null?void 0:B.questionList.length)>0}),T=L(()=>{let f=[...m.value];return O.value||(f=f.filter(v=>v.slotName!=="tab1")),!y.value&&!u.value&&(f=f.filter(v=>v.slotName!=="tab2")),f});return g({handleClickTab:()=>{var f;return(f=l.value)==null?void 0:f.handleClickTab}}),(f,v)=>(n(),J(mt,{ref_key:"scrollRef",ref:l,class:"tabs",list:t(T),sticky:"",scrollspy:""},ot({tab3:Y(()=>[Be(f.$slots,"form",{},void 0,!0)]),_:2},[t(O)?{name:"tab1",fn:Y(()=>{var E,B;return[s("div",ln,[(n(!0),o(R,null,Q(((B=(E=i.detail)==null?void 0:E.tenantProductInsureVO)==null?void 0:B.spec)||[],(H,j)=>(n(),o("img",{key:j,src:H,class:"detail-img"},null,8,rn))),128)),D(pe)])]})}:void 0,t(y)||t(u)?{name:"tab2",fn:Y(()=>{var E,B,H,j,U;return[t(y)?(n(),o(R,{key:0},[((B=(E=i.detail)==null?void 0:E.tenantProductInsureVO)==null?void 0:B.settlementProcessVO.settlementProcessType)===t(ye).WORD?(n(),J(Ne,{key:0,title:"\u7406\u8D54\u6D41\u7A0B"},{default:Y(()=>{var N,$,p;return[D(Vt,{list:(p=($=(N=i.detail)==null?void 0:N.tenantProductInsureVO)==null?void 0:$.settlementProcessVO)==null?void 0:p.settlementProcessList},null,8,["list"])]}),_:1})):(n(),o("div",un,[(n(!0),o(R,null,Q(((U=(j=(H=i.detail)==null?void 0:H.tenantProductInsureVO)==null?void 0:j.settlementProcessVO)==null?void 0:U.settlementProcessPicList)||[],(N,$)=>(n(),o("img",{key:$,src:N,class:"detail-img"},null,8,cn))),128))])),D(pe)],64)):x("",!0),t(u)?(n(),o(R,{key:1},[D(Ne,{title:"\u5E38\u89C1\u95EE\u9898"},{default:Y(()=>{var N,$;return[D(on,{list:($=(N=i.detail)==null?void 0:N.tenantProductInsureVO)==null?void 0:$.questionList},null,8,["list"])]}),_:1}),D(pe)],64)):x("",!0)]})}:void 0]),1032,["list"]))}});var pn=ee(dn,[["__scopeId","data-v-4383aeea"]]);const mn=d=>(ve("data-v-ead4d7ae"),d=d(),_e(),d),fn={key:0,class:"page-waiting"},vn=["src"],_n=mn(()=>s("div",{class:"tips"},[s("p",null,"\u652F\u4ED8\u6210\u529F\uFF0C\u627F\u4FDD\u4E2D...")],-1)),yn=Z({props:{isShow:{type:Boolean,default:()=>{}}},setup(d){const g=d;return K(()=>g.isShow,i=>{i?document.body.style.overflow="hidden":document.body.style.overflow="inherit"}),(i,l)=>g.isShow?(n(),o("div",fn,[s("img",{class:"loading",src:t(kt)},null,8,vn),_n])):x("",!0)}});var hn=ee(yn,[["__scopeId","data-v-ead4d7ae"]]);const Ie=d=>(ve("data-v-50f7b053"),d=d(),_e(),d),Pn={class:"com-period-cell"},Cn={key:0,class:"custom-cell check-btn-cell"},In=Ie(()=>s("div",{class:"cell-label"},"\u4FDD\u969C\u671F\u95F4",-1)),Dn={class:"cell-content"},gn=Ie(()=>s("div",{class:"cell-label"},"\u751F\u6548\u65E5\u671F",-1)),On={class:"cell-content"},Vn={key:2,class:"custom-cell common-cell"},kn=Ie(()=>s("div",{class:"cell-label"},"\u4FDD\u969C\u671F\u9650",-1)),Ln={class:"cell-content"},Fn=Z({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(d,{expose:g,emit:i}){const l=d;I({});const m=(p,a)=>p==="year"?`${a}\u5E74`:p==="month"?`${a}\u6708`:p==="day"?`${a}\u65E5`:a,O=I(new Date),y=wt("RISK_INSURANCE_PERIOD"),u=Ce({formInfo:l.formInfo});K(()=>u.formInfo.insuranceStartDate,p=>{p&&typeof p=="string"&&(O.value=new Date(p))});const T=I(),S=I([]);K([()=>l.insureDetail,()=>u.formInfo.activePlanCode],()=>{var p;if(u.formInfo.insurancePeriodValue="",l.insureDetail)if(l.insureDetail.productRelationPlanVOList&&l.insureDetail.productRelationPlanVOList.length>0){let a=0;const e=l.insureDetail.productRelationPlanVOList.findIndex(A=>A.planCode===u.formInfo.activePlanCode);e>-1&&(a=e);const k=(((p=l.insureDetail.productRelationPlanVOList[a])==null?void 0:p.productRiskVoList[0].riskDetailVOList)||[]).find(A=>A.riskType===1);k&&(T.value=k)}else{const e=(l.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find(c=>c.riskType===1);e&&(T.value=e)}},{deep:!0,immediate:!0}),K([()=>T.value,()=>y.value],()=>{S.value=[],Array.isArray(y.value)&&y.value.length>1&&T.value&&(S.value=(T.value.riskInsureLimitVO.insurancePeriodValueList||[]).map(p=>{const a=y.value.find(e=>e.value===p);return a?{label:a.name,value:a.value}:null}).filter(p=>!!p)),S.value.length>0&&(u.formInfo.insurancePeriodValue=S.value[0].value)},{deep:!0,immediate:!0});const f=L(()=>{var p,a;return(p=T.value)!=null&&p.riskInsureLimitVO.guaranteeStartDate?String((a=T.value)==null?void 0:a.riskInsureLimitVO.guaranteeStartDate):se.CURRENT_DAY}),[v,E]=Pe(!1),B=()=>{E(!0)},H=new Date(oe(new Date,1,"day")),j=L(()=>{var p;if(f.value===se.CUSTOM_DAY){const a=(p=T.value)==null?void 0:p.riskInsureLimitVO.maxInsuranceDay;if(!a)return new Date;const e=oe(new Date,Number(a),"day");return new Date(e)}return new Date}),U=p=>{u.formInfo.insuranceStartDate=`${me(p)} 00:00:00`,E(!1)},N=()=>{E(!1)},$=L(()=>{if(f.value===se.CUSTOM_DAY||!u.formInfo.insurancePeriodValue)return"";const[p,a]=u.formInfo.insurancePeriodValue.split("_");if(p!=="to"){let e=me(new Date);if(f.value===se.NEXT_DAY)return e=oe(new Date,1,"day"),"";const c=oe(e,Number(a)-1,p);return`${e} - ${c}`}return u.formInfo.insured.certNo,""});return K([()=>f.value,()=>$.value,()=>u.formInfo.insurancePeriodValue,()=>u.formInfo.insuranceStartDate],()=>{const[p,a]=u.formInfo.insurancePeriodValue.split("_");u.formInfo.insuranceStartDate||(f.value===se.CUSTOM_DAY?u.formInfo.insuranceStartDate=`${oe(new Date,1,"day")} 00:00:00`:f.value===se.NEXT_DAY?u.formInfo.insuranceStartDate=`${oe(new Date,1,"day")} 00:00:00`:u.formInfo.insuranceStartDate=`${me(new Date)} 00:00:00`),p!=="to"?u.formInfo.insuranceEndDate=`${oe(u.formInfo.insuranceStartDate,Number(a)-1,p)} 23:59:59`:(u.formInfo.tenantOrderInsuredList[0].birthday,u.formInfo.tenantOrderInsuredList[0].certType===he.CERT&&u.formInfo.tenantOrderInsuredList[0].certNo&&Me(u.formInfo.tenantOrderInsuredList[0].certNo)&&ft(u.formInfo.tenantOrderInsuredList[0].certNo),a==="single"&&(u.formInfo.insuranceEndDate="9999-99-99 23:59:59"),u.formInfo.insuranceEndDate=`${oe(u.formInfo.insuranceStartDate,Number(a)-1,p)} 23:59:59`)},{immediate:!0}),g({}),(p,a)=>{const e=z("ProRadioButton"),c=z("van-config-provider"),k=z("van-datetime-picker"),A=z("ProPopup");return n(),o(R,null,[D(c,{"theme-vars":t(qe)},{default:Y(()=>[s("div",Pn,[S.value.length>1?(n(),o("div",Cn,[In,s("div",Dn,[D(e,{modelValue:t(u).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=M=>t(u).formInfo.insurancePeriodValue=M),options:S.value},null,8,["modelValue","options"])])])):x("",!0),t(f)===t(se).CUSTOM_DAY?(n(),o("div",{key:1,class:"custom-cell common-cell",onClick:B},[gn,s("div",On,F(t(u).formInfo.insuranceStartDate),1)])):x("",!0),t(f)!==t(se).CUSTOM_DAY?(n(),o("div",Vn,[kn,s("div",Ln,F(t($)),1)])):x("",!0)])]),_:1},8,["theme-vars"]),D(A,{show:t(v),"onUpdate:show":a[2]||(a[2]=M=>lt(v)?v.value=M:null),height:40,closeable:!1},{default:Y(()=>[D(k,{modelValue:O.value,"onUpdate:modelValue":a[1]||(a[1]=M=>O.value=M),type:"date",title:"\u9009\u62E9\u5E74\u6708","min-date":t(H),"max-date":t(j),formatter:m,onConfirm:U,onCancel:N},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"])],64)}}});var wn=ee(Fn,[["__scopeId","data-v-50f7b053"]]);const de=d=>(ve("data-v-0027858f"),d=d(),_e(),d),Sn={class:"com-payment-type"},En={class:"title"},$n={key:0,class:"picture-payment-content"},Nn=["onClick"],bn=["src"],xn=["src"],Tn={key:1,class:"custom-cell check-btn-cell"},Bn=de(()=>s("div",{class:"cell-label"},"\u4FDD\u969C\u65B9\u6848",-1)),An={class:"cell-content"},Mn={key:0,class:"picture-payment-content"},Rn=["onClick"],qn=["src"],Un=["src"],Yn={key:1,class:"default-payment-content"},Hn=de(()=>s("div",{class:"pay-method"},[s("span",{class:"method"},F("\u6309\u6708\u4EA4\u8D39")),s("span",{class:"acount"},F("\u517112\u671F"))],-1)),jn=[Hn],Gn=de(()=>s("div",null,[s("div",{class:"tip"},[s("span",null,F("\u6BD4\u6309\u6708\u652F\u4ED8\u6700\u9AD8\u7701")),ce(),s("span",null,"16%")]),s("div",{class:"triangle"}),s("div",{class:"pay-method"},[s("span",{class:"method"},F("\u4E00\u6B21\u4EA4\u6E05")),s("span",{class:"acount"},F("\u6BD4\u6708\u4EA4\u4FDD\u8D39\u7701\u6700\u9AD82014\u5143"))])],-1)),zn=[Gn],Wn={key:2,class:"custom-cell check-btn-cell"},Qn=de(()=>s("div",{class:"cell-label"},"\u4EA4\u8D39\u65B9\u5F0F",-1)),Kn={class:"cell-content"},Jn={class:"custom-cell common-cell"},Xn=de(()=>s("div",{class:"cell-label"},"\u5B9E\u4ED8\u4FDD\u8D39",-1)),Zn={class:"cell-content actual-premium"},ea={key:0,class:"feerate-explain"},ta={class:"content"},na=de(()=>s("div",{class:"triangle-top"},null,-1)),aa=Z({props:{showConfig:{type:Object,default:()=>{}},formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premium:{type:[Number||null],default:null}},emits:["onReset","onUpdate","onVerify"],setup(d,{expose:g,emit:i}){const l=d;I({});const m=Ce({formInfo:l.formInfo}),O=I([]),y=I(),u=I(),T=L(()=>{var e;return String((e=y.value)==null?void 0:e.paymentFrequencyFlag)==="1"}),S=L(()=>{var e;return(e=u.value)==null?void 0:e.productPremiumVOList.find(c=>c.paymentFrequency===m.formInfo.paymentFrequency)}),f=L(()=>l.premium&&S.value?`${l.premium}${S.value.premiumUnit||""}`:S.value?`${S.value.paymentFrequencyValue||""}${S.value.premiumUnit||""}`:""),v=L(()=>{if(u){const{premiumExplain:e,premiumExplainViewName:c,premiumExplainUri:k}=u.value||{};return{premiumExplain:e,premiumExplainUri:k,premiumExplainViewName:c}}return null});K(()=>l.configDetail,()=>{var e;l.isMultiplePlan&&l.configDetail&&(O.value=(e=l.configDetail.tenantProductInsureVO)==null?void 0:e.planList)},{immediate:!0,deep:!0}),K([()=>l.configDetail,()=>l.isMultiplePlan,()=>m.formInfo.activePlanCode],()=>{if(l.configDetail)if(l.isMultiplePlan){let e=0;const c=l.configDetail.tenantProductInsureVO.planList.findIndex(k=>k.planCode===m.formInfo.activePlanCode);c>-1&&(e=c),y.value=l.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,u.value=l.configDetail.tenantProductInsureVO.planList[e]}else y.value=l.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,u.value=l.configDetail.tenantProductInsureVO.planInsureVO},{deep:!0,immediate:!0});const E=L(()=>y.value?y.value.paymentFrequency.split(",").length>1:!1),B=L(()=>{if(y.value){const e=y.value.paymentFrequency.split(",");if(e.length===1)return m.formInfo.paymentFrequency=y.value.paymentFrequency,!1;if(e.length===2&&e.filter(c=>![le.SINGLE,le.MONTH].includes(c)).length<1)return!0}return!1}),H=L(()=>{var e;return y.value?(e=y.value.paymentFrequencyList||[])==null?void 0:e.map(c=>({...c,paymentFrequency:c.skinValue})):[]}),j=L(()=>H.value.length>0),U=L(()=>l.isMultiplePlan?l.configDetail.tenantProductInsureVO.planList.map(e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null).filter(e=>!!e):[]),N=L(()=>{var e;if(y.value){const c=y.value.paymentFrequency.split(",");return c.length===1&&(console.log("paymentFrequencyList======",c),m.formInfo.paymentFrequency=c[0]),(e=c||[])==null?void 0:e.map(k=>({label:_t[k],value:k}))}return[]}),$=e=>{console.log("type",e),m.formInfo.paymentFrequency=e},p=e=>{m.formInfo.activePlanCode=e},a=()=>{var e,c;if(!((e=v.value)!=null&&e.premiumExplainUri)){it("\u65E0\u8D39\u7387\u6587\u4EF6\uFF01");return}Re({fileType:"pdf",fileUri:(c=v.value)==null?void 0:c.premiumExplainUri})};return g({}),(e,c)=>{const k=z("ProRadioButton"),A=z("templat"),M=z("ProDivider"),te=z("van-config-provider");return n(),J(te,{"theme-vars":t(qe)},{default:Y(()=>[s("div",Sn,[s("div",En,F(t(E)?"\u4EA4\u8D39\u65B9\u5F0F":"\u4FDD\u969C\u8BA1\u5212"),1),d.isMultiplePlan?(n(),o(R,{key:0},[t(U).length>0?(n(),o("div",$n,[(n(!0),o(R,null,Q(t(U),w=>(n(),o("div",{key:w.planCode,class:ae("picture-payment-item"),onClick:P=>p(w.planCode)},[t(m).formInfo.activePlanCode==w.planCode?(n(),o("img",{key:0,src:w.selectedPic},null,8,bn)):(n(),o("img",{key:1,src:w.unSelectedPic},null,8,xn))],8,Nn))),128))])):(n(),o("div",Tn,[Bn,s("div",An,[D(k,{modelValue:t(m).formInfo.activePlanCode,"onUpdate:modelValue":c[0]||(c[0]=w=>t(m).formInfo.activePlanCode=w),options:O.value,prop:{value:"planCode",label:"planName"}},null,8,["modelValue","options"])])]))],64)):x("",!0),t(T)?(n(),J(A,{key:1},{default:Y(()=>[t(j)?(n(),o("div",Mn,[(n(!0),o(R,null,Q(t(H),w=>(n(),o("div",{key:w.paymentFrequency,class:ae("picture-payment-item"),onClick:P=>$(w.paymentFrequency)},[t(m).formInfo.paymentFrequency==w.paymentFrequency?(n(),o("img",{key:0,src:w.selectedPic},null,8,qn)):(n(),o("img",{key:1,src:w.unSelectedPic},null,8,Un))],8,Rn))),128))])):t(B)?(n(),o("div",Yn,[s("div",{class:ae(`com-payment-type-item ${t(m).formInfo.paymentFrequency==t(le).MONTH?"active":""}`),onClick:c[1]||(c[1]=w=>$(t(le).MONTH))},jn,2),s("div",{class:ae(`com-payment-type-item ${t(m).formInfo.paymentFrequency==t(le).SINGLE?"active":""}`),onClick:c[2]||(c[2]=w=>$(t(le).SINGLE))},zn,2)])):t(N).length>1?(n(),o("div",Wn,[Qn,s("div",Kn,[D(k,{modelValue:t(m).formInfo.paymentFrequency,"onUpdate:modelValue":c[3]||(c[3]=w=>t(m).formInfo.paymentFrequency=w),options:t(N)},null,8,["modelValue","options"])])])):x("",!0)]),_:1})):x("",!0),D(wn,{"form-info":t(m).formInfo,"insure-detail":d.insureDetail,"config-detail":d.configDetail},null,8,["form-info","insure-detail","config-detail"]),t(S)&&t(S).premiumUnit?(n(),o(R,{key:2},[s("div",Jn,[Xn,s("div",Zn,F(t(f)),1)]),t(v)&&t(v).premiumExplain&&t(v).premiumExplainViewName?(n(),o("div",ea,[s("div",ta,[na,s("div",null,[s("span",null,F(t(v).premiumExplain||""),1),s("span",{class:"file-name",onClick:a},"\u300A"+F(t(v).premiumExplainViewName||"")+"\u300B",1)])])])):x("",!0)],64)):x("",!0)]),D(M)]),_:1},8,["theme-vars"])}}});var sa=ee(aa,[["__scopeId","data-v-0027858f"]]);const oa={class:"inscribedContent-content"},la={class:"content"},ia=Z({props:{inscribedContent:{type:String,default:""}},setup(d){const g=d,i=I();return K(()=>g.inscribedContent,l=>{l?i.value=l.replaceAll(`
`,"<br />"):i.value=""},{immediate:!0,deep:!0}),(l,m)=>{const O=xe("dompurify-html");return n(),o("div",oa,[Te(s("div",la,null,512),[[O,i.value]])])}}});var ra=ee(ia,[["__scopeId","data-v-702b2de2"]]);const ua={class:"com-attachment-list"},ca=["onClick"],da=Z({props:{preText:{type:String,default:""},attachementList:{type:Object,default:()=>{}}},emits:["preview-file"],setup(d,{emit:g}){const i=l=>{g("preview-file",l)};return(l,m)=>(n(),o("div",ua,[s("span",null,F(d.preText),1),(n(!0),o(R,null,Q(d.attachementList||[],(O,y)=>(n(),o("span",{key:y,class:"attachment-item",onClick:u=>i(y)}," \u300A"+F(O.attachmentName)+"\u300B ",9,ca))),128))]))}});var pa=ee(da,[["__scopeId","data-v-17da129e"]]);const ma={class:"page-internet-product-detail"},fa={class:"info"},va={class:"footer-area"},_a={class:"price"},ya=ce(" \u603B\u4FDD\u8D39"),ha=ce(F("\u7ACB\u5373\u6295\u4FDD")),Pa=Z({setup(d){var Ve,ke;const g=Ot();rt();const i=ut(),{productCode:l="BWYL2021",tenantId:m,orderNo:O,phoneNo:y,agentCode:u="",saleChannelId:T,paymentMethod:S,certNo:f,name:v,templateId:E,pageCode:B,from:H,extraInfo:j,insurerCode:U}=i.query;let N={};try{N=JSON.parse(decodeURIComponent(j))}catch{}const $=I(),p=I(),a=I(),e=I(),c=I(),k=I(!1),A=I(!1),M=I(!1),te=I(0),w=I(!1);I(!1);let P="";const W=I(!0),ne=Ce({holder:{certNo:f,certType:he.CERT,mobile:y,name:v,socialFlag:we.HAS},insured:{certNo:f,certType:he.CERT,name:v,socialFlag:we.HAS,relationToHolder:Se.SELF},paymentMethod:S,renewalDK:"Y",packageProductList:[],mobileSmsCode:"",activePlanCode:"",paymentFrequency:le.MONTH,insurancePeriodValue:"",commencementTime:me(new Date)}),q=I({tenantId:m,agencyId:u,orderCategory:1,saleUserId:T,saleChannelId:T,venderCode:U,insuranceStartDate:null,insuranceEndDate:null,activePlanCode:"",paymentFrequency:le.MONTH,insurancePeriodValue:"",commencementTime:"",tenantOrderHolder:{extInfo:{},socialFlag:"1"},tenantOrderInsuredList:[{socialFlag:"1",relationToHolder:Se.SELF,extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{tenantId:m,productCode:(Ve=a.value)==null?void 0:Ve.productCode,productName:(ke=a.value)==null?void 0:ke.productName,premium:c.value||0}]}],extInfo:{buttonCode:"EVENT_SHORT_saveOrder",successJumpUrl:"",pageCode:"productInfo",...N},operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),ie=L(()=>{var r,h,C,_,V,b;return a.value?!!(((h=(r=a.value)==null?void 0:r.tenantProductInsureVO)==null?void 0:h.planList)&&Array.isArray((_=(C=a.value)==null?void 0:C.tenantProductInsureVO)==null?void 0:_.planList)&&((b=(V=a.value)==null?void 0:V.tenantProductInsureVO)==null?void 0:b.planList.length)>0):!1}),Ue=L(()=>{var r,h,C;if(ie.value){if(q.value.activePlanCode)return((r=e.value)==null?void 0:r.planFactor[q.value.activePlanCode])||{}}else if((h=e.value)!=null&&h.productFactor)return(C=e.value)==null?void 0:C.productFactor;return{}});K(()=>ie.value,()=>{var r,h;ie.value&&(q.value.activePlanCode=(h=(r=a.value)==null?void 0:r.tenantProductInsureVO)==null?void 0:h.planList[0].planCode)},{immediate:!0});const De=L(()=>{var r,h,C;return ie.value?((h=(r=e.value)==null?void 0:r.productRelationPlanVOList.find(_=>_.planCode===q.value.activePlanCode))==null?void 0:h.productRiskVoList)||[]:((C=e.value)==null?void 0:C.productRiskVoList)||[]}),Ye=r=>{q.value.activePlanCode=r},He=L(()=>[]),fe=L(()=>{var C,_;let r={};if(ie){const V=(C=a.value)==null?void 0:C.tenantProductInsureVO.planList.find(b=>b.planCode===(q.value.activePlanCode||""));V&&(r=V==null?void 0:V.attachmentVOList)}else r=(_=a.value)==null?void 0:_.tenantProductInsureVO.planInsureVO.attachmentVOList;if(console.log("tempList",r),!r)return{};const h={2:"richText",3:"link"};return Object.keys(r).map(V=>(r[V].forEach(b=>{if(b.attachmentType==="1"){const G=b.attachmentUri.split("?"),X=G[0].substr(G[0].lastIndexOf(".")+1);console.log("type",X),X==="pdf"?b.attachmentType="pdf":b.attachmentType="picture"}else b.attachmentType=h[b.attachmentType]}),{attachmentName:V,attachmentList:r[V]}))}),je=()=>{console.log("detailScrollRef.value",p.value),p.value.handleClickTab()("tab3")},Ge=()=>{const{holder:{certNo:r,mobile:h,name:C,socialFlag:_},insured:{certNo:V,name:b,socialFlag:G,relationToHolder:X},paymentMethod:ue}=ne;return!!(Me(V)&&!!G)},ze=(r={},h={},C={})=>{var b,G;const _={...C};console.log("currentOrderDetail==========",(b=_.tenantOrderInsuredList[0])==null?void 0:b.tenantOrderProductList[0].riskVOList);const V={tenantId:m,riskList:((G=_.tenantOrderInsuredList[0])==null?void 0:G.tenantOrderProductList[0].riskVOList)||[],riskPremium:h,productId:r==null?void 0:r.productBasicInfoVO.id};return _.extInfo.iseeBizNo=P,_.commencementTime=me(_.insuranceStartDate||new Date,"YYYY-MM-DD HH:mm:ss"),_.tenantOrderInsuredList=_.tenantOrderInsuredList.map(X=>({...X,planCode:q.value.activePlanCode||0})),_.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:r.productBasicInfoVO.productCode,productName:r.productBasicInfoVO.productName,planCode:q.value.activePlanCode||0,tenantOrderRiskList:gt(V)},_},We=async r=>{const{code:h,data:C}=await Ct({orderNo:r,tenantId:m});if(h==="10000"){C.extInfo={...C.extInfo,buttonCode:"EVENT_SHORT_underWrite"};const{code:_,data:V}=await Ee(C);_==="10000"&&console.log("res=====",V),Object.assign(q.value,C)}},Qe=async r=>{var _,V,b,G;const{code:h,data:C}=await Ee(ze(e.value,{},q.value));console.log("data",C),(V=(_=C.pageAction)==null?void 0:_.data)!=null&&V.orderNo&&(console.log("23233322332"),await We((G=(b=C.pageAction)==null?void 0:b.data)==null?void 0:G.orderNo))},Ke=async()=>{},Je=r=>{te.value=r,M.value=!0},Xe=async(r,h,C)=>{var X,ue;const _=Dt(C).map(re=>({...re,paymentFrequency:r.paymentFrequency,insurancePeriodValue:r.insurancePeriodValue}));console.log("orderDetail.value.activePlanCode",q.value.activePlanCode);const V={tenantId:m,productCode:(X=a.value)==null?void 0:X.productCode,insuranceStartDate:r.insuranceStartDate,commencementTime:r.insuranceStartDate,insuranceEndDate:r.insuranceEndDate,holder:{personVO:r.tenantOrderHolder},insuredVOList:r.tenantOrderInsuredList.map(re=>({insuredCode:"",personVO:re,productPlanVOList:[{insurerCode:h.productBasicInfoVO.insurerCode,planCode:q.value.activePlanCode||0,riskVOList:_}]}))},{code:b,data:G}=await Pt(V);q.value.tenantOrderInsuredList[0].tenantOrderProductList=(ue=V.insuredVOList[0])==null?void 0:ue.productPlanVOList,q.value.premium=G.premium},ge=async()=>{try{console.log("currentRiskInfo.value",De.value),await Xe(q.value,e.value,De.value),Qe({})}catch{}},Ze=r=>{r==="allFalse"?(A.value=!1,k.value=!0,ge()):pt.confirm({message:"\u60A8\u5F53\u524D\u7684\u5065\u5EB7\u72B6\u51B5\u4E0D\u7B26\u5408\u8BE5\u4EA7\u54C1",confirmButtonText:"\u786E\u5B9A"}).then(()=>{window.history.back()}).catch(()=>{var h;(h=$.value)==null||h.reEditForm(),k.value=!1})},Oe=()=>{var r;(r=$.value)==null||r.reEditForm(),k.value=!1},et=()=>{A.value=!1,Oe()},tt=()=>{M.value=!1,Oe()},nt=()=>{M.value=!1,A.value=!0};K([()=>ne.insured.certNo,()=>ne.insured.socialFlag,()=>ne.packageProductList,()=>ne.paymentFrequency],ct.exports.debounce(()=>{ne.insured.certNo&&ne.insured.socialFlag&&Ge()&&Ke()},500),{deep:!0,immediate:!0});const at=async()=>{const r=It({productCode:l,withInsureInfo:!0,tenantId:m}),h=ht({productCode:l});await Promise.all([r,h]).then(([C,_])=>{var V;C.code==="10000"&&(a.value={...C.data},document.title=((V=C.data)==null?void 0:V.productFullName)||""),_.code==="10000"&&(e.value=_.data)})};return dt(()=>{at(),setTimeout(async()=>{P=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(r,h)=>{const C=z("van-config-provider");return n(),o(R,null,[D(C,{"theme-vars":t(g)},{default:Y(()=>{var _,V,b,G,X,ue,re,Le,Fe;return[s("div",ma,[s("div",fa,[D($e,{url:(V=(_=a.value)==null?void 0:_.tenantProductInsureVO)==null?void 0:V.banner[0]},null,8,["url"]),(G=(b=a.value)==null?void 0:b.tenantProductInsureVO)!=null&&G.bannerMove?(n(),J($e,{key:0,url:(ue=(X=a.value)==null?void 0:X.tenantProductInsureVO)==null?void 0:ue.bannerMove[0],onClick:je},null,8,["url"])):x("",!0)]),D(Qt,{"show-service-config":"","data-source":(re=a.value)==null?void 0:re.tenantProductInsureVO,"is-multiple-plan":t(ie),"active-plan-code":q.value.activePlanCode,onUpdateActivePlan:Ye},null,8,["data-source","is-multiple-plan","active-plan-code"]),D(pn,{ref_key:"detailScrollRef",ref:p,detail:a.value},{form:Y(()=>[D(Et,{ref_key:"formRef",ref:$,"title-collection":{HOLDER:"\u672C\u4EBA\u4FE1\u606F\uFF08\u6295\u4FDD\u4EBA\uFF09",INSURER:"\u4E3A\u8C01\u6295\u4FDD\uFF08\u88AB\u4FDD\u4EBA\uFF09"},"form-info":q.value,"send-sms-code":()=>{},"factor-object":t(Ue)||{}},null,8,["form-info","send-sms-code","factor-object"]),D(sa,{"form-info":q.value,"insure-detail":e.value,"config-detail":a.value,"is-multiple-plan":t(ie),"risk-info-period-list":r.riskInfoPeriodList,premium:c.value},null,8,["form-info","insure-detail","config-detail","is-multiple-plan","risk-info-period-list","premium"])]),_:1},8,["detail"]),(Le=a.value)!=null&&Le.tenantProductInsureVO.inscribedContent?(n(),J(ra,{key:0,"inscribed-content":(Fe=a.value)==null?void 0:Fe.tenantProductInsureVO.inscribedContent},null,8,["inscribed-content"])):x("",!0),t(fe)&&t(fe).length>1?(n(),J(pa,{key:1,"attachement-list":t(fe),"pre-text":"\u8BF7\u9605\u8BFB",onPreviewFile:h[0]||(h[0]=st=>Je(st))},null,8,["attachement-list"])):x("",!0),s("div",va,[s("div",_a,[ya,s("span",null,F(c.value?"\uFFE5":"")+F(t(vt)(c.value))+" "+F(c.value?q.value.paymentFrequency==t(yt).YEAR?"\u5143/\u5E74":"\u5143/\u6708":""),1)]),D(St,{shadow:!1,"theme-vars":t(g),class:"right",text:"\u7ACB\u5373\u6295\u4FDD",onClick:ge},{default:Y(()=>[ha]),_:1},8,["theme-vars"])])])]}),_:1},8,["theme-vars"]),D(Lt,{show:A.value,"onUpdate:show":h[1]||(h[1]=_=>A.value=_),"content-list":t(He),"active-index":0,onOnConfirmHealth:Ze,onOnCloseHealth:et},null,8,["show","content-list"]),M.value?(n(),J(Ft,{key:0,show:M.value,"onUpdate:show":h[2]||(h[2]=_=>M.value=_),"content-list":t(fe),"is-only-view":W.value,"active-index":te.value,text:W.value?"\u5173\u95ED":"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9","force-read-cound":0,"on-close-file-preview":"",onSubmit:nt,onOnCloseFilePreview:tt},null,8,["show","content-list","is-only-view","active-index","text"])):x("",!0),D(hn,{"is-show":w.value},null,8,["is-show"])],64)}}});var Aa=ee(Pa,[["__scopeId","data-v-2cf6d54b"]]);export{Aa as default};
