import{d as e,cE as a,r as l,G as t,N as n,Y as s,aH as i,bS as o,ct as u,b as c,c as r,i as d,f as v,U as p,a4 as m,a0 as f,$ as g,h,g as y,j as b,e as C,a1 as k,bh as w,w as S,V as L,b4 as U,ag as E,cF as N,cG as $,O as j,bT as A,cH as B,aJ as V,aU as x,aV as P}from"./index-faa0f0b8.js";import{o as T}from"./utils-2051a9dd.js";import"./infoCollection-54c6f351.js";import"./trial-bcd3cfde.js";const _={class:"guarantee-list"},F=(e=>(x("data-v-72bcb63c"),e=e(),P(),e))((()=>d("span",null,"保障计划",-1))),G={key:0,class:"plan-list"},q=["onClick"],z={key:2,class:"feerate-view"},D={key:0},H={class:"extinfo-info-list"},I={class:"guarantee-detail"},O={class:"content"},Y=e({name:"guarantee"});var J=E(e({...Y,props:{dataSource:{default:()=>({})},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{default:5},planList:{default:()=>[]}},emits:["updateActivePlan"],setup(e,{emit:E}){var x,P;const Y=e;a((e=>({"47c8f96c":v(J)})));const J=l(""),M=l((null==(P=null==(x=Y.planList)?void 0:x[0])?void 0:P.planCode)||void 0),R=l(),K=l([]),Q=l([]),W=l(),X=t((()=>!!Y.planList.length));n([()=>Y.dataSource,()=>M.value],(()=>{var e,a;K.value=((null==(a=((null==(e=Y.dataSource)?void 0:e.GUARANTEE)||[]).find((e=>e.planCode===M.value)))?void 0:a.data)||[]).filter((e=>e.isShowOn===`${s.YES}`))}),{immediate:!0,deep:!0});const Z=t((()=>{var e;return(null==(e=Y.dataSource)?void 0:e.rateUri)||""})),ee=t((()=>!!(W.value&&W.value.paymentFrequencyValue&&W.value.premiumUnit&&Z))),[ae,le]=i(!1),te=t((()=>{var e;return!(!K.value||!(null==(e=K.value)?void 0:e.length))&&(K.value.length>Y.count&&(!!Y.isShowClose||!ae.value))})),ne=()=>{le()},se=t((()=>{var e;return K.value&&(null==(e=K.value)?void 0:e.length)?K.value.length<=Y.count||ae.value?K.value:K.value.slice(0,Y.count):[]})),ie=l(!1),oe=e=>{const a=e||window.event;a.preventDefault?a.preventDefault():a.returnValue=!1,a.stopPropagation?a.stopPropagation():a.cancelBubble=!0,"A"===a.target.tagName&&a.target.href&&(N()?$("",a.target.href):window.open(a.target.href))},ue=()=>{ie.value=!0,j((()=>{var e,a;null==(a=null==(e=document.getElementsByClassName("guarantee-detail"))?void 0:e[0])||a.addEventListener("click",oe,!1)}))};o((()=>{var e,a;null==(a=null==(e=document.getElementsByClassName("guarantee-detail"))?void 0:e[0])||a.removeEventListener("click",oe,!1)}));const ce=()=>{T({fileType:"pdf",fileUri:Z.value})},re=e=>{M.value=Y.planList[e.name].planCode};return(e,a)=>{var l,t;const n=A,s=B,i=V,o=u("dompurify-html");return c(),r(p,null,[d("div",_,[d("div",{class:"header"},[F,d("span",{onClick:ue},"查看详情")]),v(X)?(c(),r("div",G,[(c(!0),r(p,null,m(e.planList,((e,a)=>(c(),r("div",{key:`${e.planCode}_${a}`,class:f("plan-list-item "+(e.planCode===v(M)?"plan-list-item-active":"")),onClick:a=>{return l=e.planCode,M.value=l,R.value=Y.planList.findIndex((e=>e.planCode===l)),void E("updateActivePlan",l);var l}},[d("span",null,g(e.planName),1)],10,q)))),128))])):h("",!0),(c(!0),r(p,null,m(v(se),((e,a)=>(c(),y(n,{key:a,class:"guarantee-item",title:e.title,content:e.desc,border:!1},null,8,["title","content"])))),128)),v(te)?(c(),r("div",{key:1,class:"show-more",onClick:ne},[b(g(v(ae)?"收起":"查看更多")+" ",1),C(k,{name:"arrow-down-dobule",class:f(["icon",{showMore:v(ae)}])},null,8,["class"])])):h("",!0),v(ee)?(c(),r("div",z,[d("span",null,g(`${(null==(l=v(W))?void 0:l.paymentFrequencyValue)||""}${(null==(t=v(W))?void 0:t.premiumUnit)||""}`),1),v(Z)?(c(),r("span",{key:0,onClick:ce},"查看保费")):h("",!0)])):h("",!0)]),C(w),C(i,{show:v(ie),"onUpdate:show":a[1]||(a[1]=e=>L(ie)?ie.value=e:null),title:"保障详情",class:"guarantee-popup"},{default:S((()=>[v(Q)&&v(Q).length>0?(c(),r("div",D,[d("div",H,[(c(!0),r(p,null,m(v(Q),((e,a)=>(c(),y(n,{key:a,title:e.name,content:e.description,border:!1,size:"small"},null,8,["title","content"])))),128))]),C(w)])):h("",!0),v(X)?(c(),y(s,{key:1,active:v(R),"onUpdate:active":a[0]||(a[0]=e=>L(R)?R.value=e:null),list:e.planList.map(((e,a)=>({title:e.planName}))),class:"custom-plan-tab",onClickTab:re},null,8,["active","list"])):h("",!0),d("div",I,[(c(!0),r(p,null,m(v(K),((e,a)=>(c(),r("div",{key:a,class:"guarantee-item"},[C(n,{title:e.title,content:e.desc,border:!1,size:"small"},null,8,["title","content"]),U(d("div",O,null,512),[[o,e.tips]])])))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-72bcb63c"]]);export{J as default};
