import{h as ge,R as _e,P as De,G as y,d as ve,z as pe,$ as G,r as U,B as T,k as u,p as ie,m as s,n as p,s as C,v as i,A as oe,E as Ee,L as He,M as ea,T as W,aa as Me,N as Ye,F as je,H as aa,l as oa,j as la,D as ta,Y as ua}from"./vendor-4d9de129.js";import{p as Oe,i as na,g as ra,s as ia,u as da,a as sa}from"./trial-c7cf8f2a.js";import{e as ma,R as Z,S as Fe,g as fa,I as ca}from"./infoCollection-caf02023.js";import{r as va}from"./relativeTime-4ed25667.js";import{C as b,V as X,I as Ke,J as Be,K as Ia,Y as he,_ as pa,a4 as qe}from"./index-a7234636.js";import{u as Re}from"./useDicData-861025a9.js";import{g as Le,o as Se,a as $e,t as ya,b as Ca,d as Ie}from"./utils-80c05d8d.js";import{u as Fa}from"./theme-775c7ab9.js";import{a as xe}from"./order-d79a6ca1.js";import{a as Ea,_ as Va}from"./index-fef103b9.js";import"./trial-1cb90f2b.js";const xa={key:0,class:"com-personal-wrapper"},ba={class:"date-extra"},Ba=Ee("\u957F\u671F"),ga=oe("span",{class:"input-extra"},"\u4E07",-1),Da=oe("span",{class:"input-extra"},"\u4E07",-1),Aa=oe("span",{class:"input-extra"},"%",-1),be=ge({props:{formInfo:{default:()=>({})},factorList:{default:()=>[]},images:{default:()=>[]},isView:{type:Boolean,default:!1},prefix:{default:""},beneficiaryList:{default:()=>[]},sendSmsCode:{type:Function,default:t=>{}}},emits:["update:images"],setup(t,{emit:de}){const A=t;_e();const{venderCode:h=""}=De().query,F=Re(`${h.toLocaleUpperCase()}_OCCUPATION`),D=Re("NATIONAL_REGION_CODE"),P=y([]),H=y(!1),e=y({formInfo:A.formInfo,birth:{min:new Date("1900-01-01"),max:new Date},certEndDate:{min:new Date("1900-01-01"),max:new Date("2099-12-31")},occupationalText:""});ve.extend(va);const z=y(A.formInfo.certEndType===2),se=60,q=y(0),N=y("\u83B7\u53D6\u9A8C\u8BC1\u7801"),w=y(!1),B=pe(()=>{const d={};return A.factorList.forEach(a=>{d[a.code]=a}),console.log("factorObj",B),d}),L=pe(()=>/^1(3|4|5|6|7|8|9)\d{9}$/.test(e.value.formInfo.mobile)),S=()=>{if(q.value>0)return;q.value=se;const d=()=>{N.value=`${q.value}s`,q.value-=1};d();const a=setInterval(()=>{q.value===0?(N.value="\u83B7\u53D6\u9A8C\u8BC1\u7801",q.value=0,clearInterval(a)):d()},1e3)},j=async()=>{q.value>0||A.isSendSmsCode(()=>{w.value=!0,W({message:"\u77ED\u4FE1\u53D1\u9001\u6210\u529F\uFF0C\u8BF7\u67E5\u6536"}),S()})},O=d=>{e.value.formInfo.certNo=d.personIdCard,e.value.formInfo.name=d.personName,e.value.formInfo.certEndDate=ve(d.validDateEnd,"YYYYMMDD").toDate()},r=d=>B.value&&B.value[d]&&B.value[d].isDisplay===he.YES,n=d=>B.value&&B.value[d]&&B.value[d].isMustInput===he.YES,l=(d,a)=>{var E,v;return((v=(E=B.value)==null?void 0:E[d])==null?void 0:v[a])||""},M=pe(()=>[b.CERT,b.HOUSE_HOLD].includes(`${e.value.formInfo.certType}`)?[X.ID_CARD]:`${e.value.formInfo.certType}`===b.BIRTH?[X.BIRTH]:`${e.value.formInfo.certType}`===b.PASSPORT?[X.PASSPORT]:[X.ID_CARD]),K=(d,a)=>n("attachment")?e.value.formInfo.certEndType===2||e.value.formInfo.certEndDate?"":"\u8BF7\u9009\u62E9\u6709\u6548\u671F\u81F3":"",me=(d,a)=>/^\d{1,10}(\.\d{1,2})?$/.test(d)?"":"\u5E74\u6536\u5165\u6700\u591A\u5F55\u516510\u4F4D\u6570\u5B57",ye=(d,a)=>/^[1-9]$|^[1-9][0-9]$|^100$/.test(d)?"":"\u6536\u76CA\u6BD4\u4F8B\u53EA\u80FD\u586B\u51991-100\u7684\u6B63\u6574\u6570",_=(d,a,E)=>a.length>d?`\u6700\u5927\u4E0D\u80FD\u8D85\u8FC7${d}\u4E2A\u5B57\u7B26`:"",Ce=(d,a)=>{var E,v,ee,$,le,te,ue;if(!r("nationality"))return"";if(((v=(E=e.value.formInfo)==null?void 0:E.extInfo)==null?void 0:v.nationalityCode)==="CHN"){if(![b.CERT,b.HOUSE_HOLD,b.BIRTH,b.MILITARY_CARD].includes(`${d}`))return"\u56FD\u7C4D\u4E3A\u4E2D\u56FD\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u8EAB\u4EFD\u8BC1\u3001\u6237\u53E3\u672C\u3001\u51FA\u751F\u8BC1\u3001\u519B\u5B98\u8BC1"}else if(["HKG","MAC"].includes(($=(ee=e.value.formInfo)==null?void 0:ee.extInfo)==null?void 0:$.nationalityCode)){if(![b.HK_MACAO_RESIDENCE_PERMIT,b.HONGKONG_MACAO].includes(`${d}`))return"\u56FD\u7C4D\u4E3A\u4E2D\u56FD\u9999\u6E2F\u3001\u4E2D\u56FD\u6FB3\u95E8\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u6E2F\u6FB3\u901A\u884C\u8BC1\u3001\u6E2F\u6FB3\u5C45\u6C11\u5C45\u4F4F\u8BC1"}else if(((te=(le=e.value.formInfo)==null?void 0:le.extInfo)==null?void 0:te.nationalityCode)==="TWN"){if(![b.TAIWAN_RESIDENCE_PERMIT,b.TAIWAN_TRAVEL].includes(`${d}`))return"\u56FD\u7C4D\u4E3A\u4E2D\u56FD\u53F0\u6E7E\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u53F0\u6E7E\u901A\u884C\u8BC1\u3001\u53F0\u6E7E\u5C45\u6C11\u5C45\u4F4F\u8BC1"}else if(![b.PASSPORT,b.FOREIGN_PERMANENT].includes(`${d}`))return"\u56FD\u7C4D\u4E3A\u975E\u4E2D\u56FD\u3001\u6E2F\u6FB3\u53F0\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u53EA\u5141\u8BB8\u9009\u62E9\u62A4\u7167\u3001\u5916\u56FD\u4EBA\u6C38\u4E45\u5C45\u7559\u8EAB\u4EFD\u8BC1";return ve().year()-ve((ue=e.value.formInfo)==null?void 0:ue.birthday).year()>2&&d===b.BIRTH?"\u5E74\u9F84\u5927\u4E8E\u7B49\u4E8E2\u5468\u5C81\u65F6\uFF0C\u8BC1\u4EF6\u7C7B\u578B\u4E0D\u80FD\u9009\u62E9\u51FA\u751F\u8BC1":""},fe=d=>Array.isArray(d)&&d.length===2&&d[0]&&d[1]?"":"\u8BF7\u4E0A\u4F20\u8EAB\u4EFD\u8BC1\u6B63\u53CD\u9762\u7167\u7247",f=d=>A.beneficiaryList.filter(a=>a.relationToInsured===ma.SPOUSE).length>=2?"\u5DF2\u5B58\u5728\u914D\u5076\u5173\u7CFB\u7684\u53D7\u76CA\u4EBA":"";return G(()=>z.value,d=>{d?(e.value.formInfo.certEndType=2,e.value.formInfo.certEndDate=""):e.value.formInfo.certEndType=1},{immediate:!0}),G(()=>e.value.formInfo.certType,d=>{[b.CERT,b.HOUSE_HOLD].includes(d)?H.value=!0:H.value=!1},{deep:!0,immediate:!0}),G(()=>e.value.formInfo.certNo,d=>{Ke(d)&&(e.value.formInfo.gender=+Be(d),e.value.formInfo.birthday=ve(new Date(Ia(d))).format("YYYY-MM-DD"))},{deep:!0,immediate:!0}),G(()=>A.images,d=>{P.value=d},{immediate:!0}),G(()=>A.formInfo,()=>{e.value.formInfo=A.formInfo},{deep:!0,immediate:!0}),G(P,d=>{de("update:images",d)},{deep:!0}),(d,a)=>{const E=U("ProRadioButton"),v=U("ProField"),ee=U("ProDatePicker"),$=U("ProPicker"),le=U("ProIDCardUpload"),te=U("ProImageUpload"),ue=U("van-checkbox"),ae=U("ProCascader"),Ve=U("van-button");return Object.keys(T(B)).length?(u(),ie("div",xa,[r("relationToHolder")?(u(),s(v,{key:0,modelValue:e.value.formInfo.relationToInsured,"onUpdate:modelValue":a[1]||(a[1]=o=>e.value.formInfo.relationToInsured=o),name:`${t.prefix}_relationToInsured`,required:n("relationToHolder"),label:l("relationToHolder","title"),rules:[{validator:f}]},{input:p(()=>[C(E,{modelValue:e.value.formInfo.relationToInsured,"onUpdate:modelValue":a[0]||(a[0]=o=>e.value.formInfo.relationToInsured=o),"is-view":t.isView,options:l("relationToHolder","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","name","required","label","rules"])):i("",!0),r("insuredBeneficiaryType")?(u(),s(v,{key:1,modelValue:e.value.formInfo.insuredBeneficiaryType,"onUpdate:modelValue":a[3]||(a[3]=o=>e.value.formInfo.insuredBeneficiaryType=o),label:l("insuredBeneficiaryType","title"),name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:p(()=>[C(E,{modelValue:e.value.formInfo.insuredBeneficiaryType,"onUpdate:modelValue":a[2]||(a[2]=o=>e.value.formInfo.insuredBeneficiaryType=o),options:l("insuredBeneficiaryType","attributeValueList")||[]},null,8,["modelValue","options"])]),_:1},8,["modelValue","label"])):i("",!0),r("insuredRelation")?(u(),s(v,{key:2,modelValue:e.value.formInfo.insuredRelation,"onUpdate:modelValue":a[5]||(a[5]=o=>e.value.formInfo.insuredRelation=o),label:l("insuredRelation","title"),name:"insuredRelation",placeholder:"\u8BF7\u9009\u62E9"},{input:p(()=>[C(E,{modelValue:e.value.formInfo.insuredRelation,"onUpdate:modelValue":a[4]||(a[4]=o=>e.value.formInfo.insuredRelation=o),options:l("insuredRelation","attributeValueList")||[]},null,8,["modelValue","options"])]),_:1},8,["modelValue","label"])):i("",!0),r("name")?(u(),s(v,{key:3,modelValue:e.value.formInfo.name,"onUpdate:modelValue":a[6]||(a[6]=o=>e.value.formInfo.name=o),label:l("name","title"),name:`${t.prefix}_name`,required:n("name")},null,8,["modelValue","label","name","required"])):i("",!0),r("sex")?(u(),s(v,{key:4,modelValue:e.value.formInfo.gender,"onUpdate:modelValue":a[8]||(a[8]=o=>e.value.formInfo.gender=o),required:n("sex"),label:l("sex","title"),name:`${t.prefix}_gender`,placeholder:"\u8BF7\u9009\u62E9","is-view":H.value},{input:p(()=>[C(E,{modelValue:e.value.formInfo.gender,"onUpdate:modelValue":a[7]||(a[7]=o=>e.value.formInfo.gender=o),disabled:H.value,"is-view":t.isView,options:l("sex","attributeValueList")||[]},null,8,["modelValue","disabled","is-view","options"])]),_:1},8,["modelValue","required","label","name","is-view"])):i("",!0),r("birthDate")?(u(),s(ee,{key:5,modelValue:e.value.formInfo.birthday,"onUpdate:modelValue":a[9]||(a[9]=o=>e.value.formInfo.birthday=o),label:l("birthDate","title"),name:`${t.prefix}_birthday`,min:e.value.birth.min,max:e.value.birth.max,type:"date",required:n("birthDate")},null,8,["modelValue","label","name","min","max","required"])):i("",!0),r("certType")?(u(),s($,{key:6,modelValue:e.value.formInfo.certType,"onUpdate:modelValue":a[10]||(a[10]=o=>e.value.formInfo.certType=o),label:l("certType","title"),name:`${t.prefix}_certType`,"data-source":l("certType","attributeValueList")||[],required:n("certType"),rules:[{validator:Ce}]},null,8,["modelValue","label","name","data-source","required","rules"])):i("",!0),r("certImage")&&e.value.formInfo.certType+""=="1"?(u(),s(v,{key:7,label:"\u8EAB\u4EFD\u8BC1\u4E0A\u4F20",block:"",required:n("certImage"),rules:[{validator:fe}],name:`${t.prefix}_idCard`},{input:p(()=>[C(le,{modelValue:P.value,"onUpdate:modelValue":a[11]||(a[11]=o=>P.value=o),"is-view":t.isView,onOnOCR:O},null,8,["modelValue","is-view"])]),_:1},8,["required","rules","name"])):i("",!0),r("certImage")&&e.value.formInfo.certType&&e.value.formInfo.certType+""!="1"?(u(),s(v,{key:8,label:l("certImage","title"),block:"",required:n("certImage")},{input:p(()=>[C(te,{modelValue:P.value,"onUpdate:modelValue":a[12]||(a[12]=o=>P.value=o),"max-count":1},null,8,["modelValue"])]),_:1},8,["label","required"])):i("",!0),r("certNo")?(u(),s(v,{key:9,modelValue:e.value.formInfo.certNo,"onUpdate:modelValue":a[13]||(a[13]=o=>e.value.formInfo.certNo=o),label:l("certNo","title"),name:`${t.prefix}_certNo`,required:n("certNo"),placeholder:"\u8BF7\u8F93\u5165",maxlength:18,"validate-type":T(M)},null,8,["modelValue","label","name","required","validate-type"])):i("",!0),r("certExpiry")?(u(),s(ee,{key:10,modelValue:e.value.formInfo.certEndDate,"onUpdate:modelValue":a[15]||(a[15]=o=>e.value.formInfo.certEndDate=o),label:l("certExpiry","title"),name:`${t.prefix}_certEndDate`,type:"date",min:e.value.certEndDate.min,max:e.value.certEndDate.max,"is-view":z.value||t.isView,read:"",rules:[{validator:K}]},{extra:p(()=>[oe("div",ba,[C(ue,{modelValue:z.value,"onUpdate:modelValue":a[14]||(a[14]=o=>z.value=o),"icon-size":16,disabled:t.isView},{default:p(()=>[Ba]),_:1},8,["modelValue","disabled"])])]),_:1},8,["modelValue","label","name","min","max","is-view","rules"])):i("",!0),r("age")?(u(),s(v,{key:11,modelValue:e.value.formInfo.name,"onUpdate:modelValue":a[16]||(a[16]=o=>e.value.formInfo.name=o),label:l("age","title"),name:`${t.prefix}_age`,required:n("age")},null,8,["modelValue","label","name","required"])):i("",!0),r("residence")?(u(),s(ae,{key:12,modelValue:e.value.formInfo.extInfo.provinceCode,"onUpdate:modelValue":a[17]||(a[17]=o=>e.value.formInfo.extInfo.provinceCode=o),field1:e.value.formInfo.extInfo.provinceCode,"onUpdate:field1":a[18]||(a[18]=o=>e.value.formInfo.extInfo.provinceCode=o),field2:e.value.formInfo.extInfo.cityCode,"onUpdate:field2":a[19]||(a[19]=o=>e.value.formInfo.extInfo.cityCode=o),field3:e.value.formInfo.extInfo.areaCode,"onUpdate:field3":a[20]||(a[20]=o=>e.value.formInfo.extInfo.areaCode=o),label:l("residence","title"),name:`${t.prefix}_provinceCode`,placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:n("residence"),"data-source":T(D),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","label","name","required","data-source"])):i("",!0),r("social")?(u(),s(v,{key:13,modelValue:e.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":a[22]||(a[22]=o=>e.value.formInfo.extInfo.hasSocialInsurance=o),label:l("social","title"),name:`${t.prefix}_hasSocialInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:n("social")},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":a[21]||(a[21]=o=>e.value.formInfo.extInfo.hasSocialInsurance=o),"is-view":t.isView,options:l("social","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("height")?(u(),s(v,{key:14,modelValue:e.value.formInfo.name,"onUpdate:modelValue":a[23]||(a[23]=o=>e.value.formInfo.name=o),label:l("height","title"),name:`${t.prefix}_height`,required:n("height")},null,8,["modelValue","label","name","required"])):i("",!0),r("weight")?(u(),s(v,{key:15,modelValue:e.value.formInfo.name,"onUpdate:modelValue":a[24]||(a[24]=o=>e.value.formInfo.name=o),label:l("weight","title"),name:`${t.prefix}_weight`,required:n("weight")},null,8,["modelValue","label","name","required"])):i("",!0),r("BMI")?(u(),s(v,{key:16,modelValue:e.value.formInfo.name,"onUpdate:modelValue":a[25]||(a[25]=o=>e.value.formInfo.name=o),label:l("BMI","title"),name:`${t.prefix}_BMI`,required:n("BMI")},null,8,["modelValue","label","name","required"])):i("",!0),r("insuredRiskManagementLevel")?(u(),s(v,{key:17,modelValue:e.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":a[27]||(a[27]=o=>e.value.formInfo.extInfo.hasSocialInsurance=o),label:l("insuredRiskManagementLevel","title"),name:`${t.prefix}_hasSocialInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:n("insuredRiskManagementLevel")},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":a[26]||(a[26]=o=>e.value.formInfo.extInfo.hasSocialInsurance=o),"is-view":t.isView,options:l("insuredRiskManagementLevel","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("purchaseOtherInsurance")?(u(),s(v,{key:18,modelValue:e.value.formInfo.extInfo.purchaseOtherInsurance,"onUpdate:modelValue":a[29]||(a[29]=o=>e.value.formInfo.extInfo.purchaseOtherInsurance=o),label:l("purchaseOtherInsurance","title"),name:`${t.prefix}_purchaseOtherInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:n("purchaseOtherInsurance")},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.hasSocialInsurance,"onUpdate:modelValue":a[28]||(a[28]=o=>e.value.formInfo.extInfo.hasSocialInsurance=o),"is-view":t.isView,options:l("purchaseOtherInsurance","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("injuryInsurance")?(u(),s(v,{key:19,modelValue:e.value.formInfo.extInfo.injuryInsurance,"onUpdate:modelValue":a[31]||(a[31]=o=>e.value.formInfo.extInfo.injuryInsurance=o),label:l("injuryInsurance","title"),name:`${t.prefix}_hasSocialInsurance`,placeholder:"\u8BF7\u9009\u62E9",required:n("injuryInsurance")},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.injuryInsurance,"onUpdate:modelValue":a[30]||(a[30]=o=>e.value.formInfo.extInfo.injuryInsurance=o),"is-view":t.isView,options:l("injuryInsurance","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("insureArea")?(u(),s(ae,{key:20,label:l("insureArea","title"),name:"insureAreaCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:n("insureArea"),"data-source":T(D),mapping:{label:"name",value:"code",children:"children"}},null,8,["label","required","data-source"])):i("",!0),r("occupation")?(u(),s(ae,{key:21,modelValue:e.value.formInfo.extInfo.occupationCodeList[0],"onUpdate:modelValue":a[32]||(a[32]=o=>e.value.formInfo.extInfo.occupationCodeList[0]=o),field0:e.value.formInfo.extInfo.occupationCodeList[0],"onUpdate:field0":a[33]||(a[33]=o=>e.value.formInfo.extInfo.occupationCodeList[0]=o),field1:e.value.formInfo.extInfo.occupationCodeList[1],"onUpdate:field1":a[34]||(a[34]=o=>e.value.formInfo.extInfo.occupationCodeList[1]=o),field2:e.value.formInfo.extInfo.occupationCodeList[2],"onUpdate:field2":a[35]||(a[35]=o=>e.value.formInfo.extInfo.occupationCodeList[2]=o),label:l("occupation","title"),name:`${t.prefix}_occupationCodeList`,placeholder:"\u8BF7\u9009\u62E9",required:n("occupation"),"data-source":T(F),mapping:{label:"value",value:"code",children:"children"},"is-link":""},null,8,["modelValue","field0","field1","field2","label","name","required","data-source"])):i("",!0),r("personalAnnualIncome")?(u(),s(v,{key:22,modelValue:e.value.formInfo.extInfo.personalAnnualIncome,"onUpdate:modelValue":a[36]||(a[36]=o=>e.value.formInfo.extInfo.personalAnnualIncome=o),label:l("personalAnnualIncome","title"),name:`${t.prefix}_personalAnnualIncome`,required:n("personalAnnualIncome"),placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:me}]},{extra:p(()=>[ga]),_:1},8,["modelValue","label","name","required","rules"])):i("",!0),r("familyAnnualIncome")?(u(),s(v,{key:23,modelValue:e.value.formInfo.extInfo.familyAnnualIncome,"onUpdate:modelValue":a[37]||(a[37]=o=>e.value.formInfo.extInfo.familyAnnualIncome=o),label:l("familyAnnualIncome","title"),name:`${t.prefix}_familyAnnualIncome`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:me}],required:n("familyAnnualIncome")},{extra:p(()=>[Da]),_:1},8,["modelValue","label","name","rules","required"])):i("",!0),r("country")?(u(),s($,{key:24,modelValue:e.value.formInfo.extInfo.nationalityCode,"onUpdate:modelValue":a[38]||(a[38]=o=>e.value.formInfo.extInfo.nationalityCode=o),label:l("country","title"),name:`${t.prefix}_nationalityCode`,"data-source":l("country","attributeValueList")||[],mapping:{label:"name",value:"code",children:"child"},placeholder:"\u8BF7\u9009\u62E9",required:n("country"),"is-link":""},null,8,["modelValue","label","name","data-source","required"])):i("",!0),r("hasUsCard")?(u(),s(v,{key:25,modelValue:e.value.formInfo.extInfo.hasUsCard,"onUpdate:modelValue":a[40]||(a[40]=o=>e.value.formInfo.extInfo.hasUsCard=o),label:l("hasUsCard","title"),name:`${t.prefix}_hasUsCard`,placeholder:"\u8BF7\u9009\u62E9",required:n("hasUsCard")},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.hasUsCard,"onUpdate:modelValue":a[39]||(a[39]=o=>e.value.formInfo.extInfo.hasUsCard=o),"is-view":t.isView,options:l("hasUsCard","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("marritalStatus")?(u(),s($,{key:26,modelValue:e.value.formInfo.extInfo.marriageStatus,"onUpdate:modelValue":a[41]||(a[41]=o=>e.value.formInfo.extInfo.marriageStatus=o),label:l("marritalStatus","title"),name:`${t.prefix}_marriageStatus`,placeholder:"\u8BF7\u9009\u62E9","data-source":l("marritalStatus","attributeValueList")||[],"is-link":"",required:n("marritalStatus")},null,8,["modelValue","label","name","data-source","required"])):i("",!0),r("degree")?(u(),s($,{key:27,modelValue:e.value.formInfo.extInfo.educationDegree,"onUpdate:modelValue":a[42]||(a[42]=o=>e.value.formInfo.extInfo.educationDegree=o),label:l("degree","title"),name:`${t.prefix}_educationDegree`,"data-source":l("degree","attributeValueList")||[],mapping:{label:"name",value:"code",children:"child"},placeholder:"\u8BF7\u9009\u62E9",required:n("degree"),"is-link":""},null,8,["modelValue","label","name","data-source","required"])):i("",!0),r("mobile")?(u(),s(v,{key:28,modelValue:e.value.formInfo.mobile,"onUpdate:modelValue":a[43]||(a[43]=o=>e.value.formInfo.mobile=o),label:l("mobile","title"),name:`${t.prefix}_mobile`,placeholder:"\u8BF7\u8F93\u5165",maxlength:11,required:n("mobile"),"validate-type":[T(X).PHONE]},null,8,["modelValue","label","name","required","validate-type"])):i("",!0),r("verificationCode")?(u(),s(v,{key:29,modelValue:e.value.formInfo.verificationCode,"onUpdate:modelValue":a[44]||(a[44]=o=>e.value.formInfo.verificationCode=o),label:l("verificationCode","title"),name:`${t.prefix}_verificationCode`,required:n("verificationCode")},{extra:p(()=>[C(Ve,{class:ea(["sms-code",{"count-down":q.value>0}]),size:"small",type:"primary",disabled:!T(L),onClick:j},{default:p(()=>[Ee(He(N.value),1)]),_:1},8,["class","disabled"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("isSmoke")?(u(),s(v,{key:30,modelValue:e.value.formInfo.isSmoke,"onUpdate:modelValue":a[46]||(a[46]=o=>e.value.formInfo.isSmoke=o),required:n("isSmoke"),label:l("isSmoke","title"),name:`${t.prefix}_isSmoke`,placeholder:"\u8BF7\u9009\u62E9","is-view":H.value},{input:p(()=>[C(E,{modelValue:e.value.formInfo.isSmoke,"onUpdate:modelValue":a[45]||(a[45]=o=>e.value.formInfo.isSmoke=o),"is-view":t.isView,options:l("isSmoke","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","required","label","name","is-view"])):i("",!0),r("contactNo")?(u(),s(v,{key:31,modelValue:e.value.formInfo.contactNo,"onUpdate:modelValue":a[47]||(a[47]=o=>e.value.formInfo.contactNo=o),label:l("contactNo","title"),name:`${t.prefix}_contactNo`,required:n("contactNo")},null,8,["modelValue","label","name","required"])):i("",!0),r("email")?(u(),s(v,{key:32,modelValue:e.value.formInfo.email,"onUpdate:modelValue":a[48]||(a[48]=o=>e.value.formInfo.email=o),label:l("email","title"),name:`${t.prefix}_email`,placeholder:"\u8BF7\u8F93\u5165",required:n("email"),"validate-type":[T(X).EMAIL]},null,8,["modelValue","label","name","required","validate-type"])):i("",!0),r("homeAddress")?(u(),s(ae,{key:33,modelValue:e.value.formInfo.extInfo.familyAreaCode,"onUpdate:modelValue":a[49]||(a[49]=o=>e.value.formInfo.extInfo.familyAreaCode=o),field1:e.value.formInfo.extInfo.familyProvinceCode,"onUpdate:field1":a[50]||(a[50]=o=>e.value.formInfo.extInfo.familyProvinceCode=o),field2:e.value.formInfo.extInfo.familyCityCode,"onUpdate:field2":a[51]||(a[51]=o=>e.value.formInfo.extInfo.familyCityCode=o),field3:e.value.formInfo.extInfo.familyAreaCode,"onUpdate:field3":a[52]||(a[52]=o=>e.value.formInfo.extInfo.familyAreaCode=o),label:l("homeAddress","title"),name:`${t.prefix}_familyProvinceCode`,placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:n("homeAddress"),"data-source":T(D),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","label","name","required","data-source"])):i("",!0),r("homeAddressDetail")?(u(),s(v,{key:34,modelValue:e.value.formInfo.extInfo.familyAddress,"onUpdate:modelValue":a[53]||(a[53]=o=>e.value.formInfo.extInfo.familyAddress=o),label:l("homeAddressDetail","title"),name:`${t.prefix}_familyAddress`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...o)=>_(100,...o)}],required:n("homeAddressDetail")},null,8,["modelValue","label","name","rules","required"])):i("",!0),r("homePostalCode")?(u(),s(v,{key:35,modelValue:e.value.formInfo.extInfo.familyZipCode,"onUpdate:modelValue":a[54]||(a[54]=o=>e.value.formInfo.extInfo.familyZipCode=o),label:l("homePostalCode","title"),name:`${t.prefix}_familyZipCode`,placeholder:"\u8BF7\u8F93\u5165",required:n("homePostalCode"),"validate-type":[T(X).ZIP_CODE]},null,8,["modelValue","label","name","required","validate-type"])):i("",!0),r("workAddress")?(u(),s(ae,{key:36,modelValue:e.value.formInfo.extInfo.workAreaCode,"onUpdate:modelValue":a[55]||(a[55]=o=>e.value.formInfo.extInfo.workAreaCode=o),field1:e.value.formInfo.extInfo.workProvinceCode,"onUpdate:field1":a[56]||(a[56]=o=>e.value.formInfo.extInfo.workProvinceCode=o),field2:e.value.formInfo.extInfo.workCityCode,"onUpdate:field2":a[57]||(a[57]=o=>e.value.formInfo.extInfo.workCityCode=o),field3:e.value.formInfo.extInfo.workAreaCode,"onUpdate:field3":a[58]||(a[58]=o=>e.value.formInfo.extInfo.workAreaCode=o),label:l("workAddress","title"),name:`${t.prefix}_workProvinceCode`,placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:n("workAddress"),"data-source":T(D),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","label","name","required","data-source"])):i("",!0),r("workAddressDetail")?(u(),s(v,{key:37,modelValue:e.value.formInfo.extInfo.workAddress,"onUpdate:modelValue":a[59]||(a[59]=o=>e.value.formInfo.extInfo.workAddress=o),label:l("workAddressDetail","title"),name:`${t.prefix}_workAddress`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...o)=>_(100,...o)}],required:n("workAddressDetail")},null,8,["modelValue","label","name","rules","required"])):i("",!0),r("workPostalCode")?(u(),s(v,{key:38,modelValue:e.value.formInfo.extInfo.workZipCode,"onUpdate:modelValue":a[60]||(a[60]=o=>e.value.formInfo.extInfo.workZipCode=o),label:l("workPostalCode","title"),required:n("workZipCode"),name:`${t.prefix}_workPostCode`,placeholder:"\u8BF7\u8F93\u5165","validate-type":[T(X).ZIP_CODE]},null,8,["modelValue","label","required","name","validate-type"])):i("",!0),r("companyName")?(u(),s(v,{key:39,modelValue:e.value.formInfo.extInfo.workStation,"onUpdate:modelValue":a[61]||(a[61]=o=>e.value.formInfo.extInfo.workStation=o),label:l("companyName","title"),name:`${t.prefix}_workPostCode`,placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...o)=>_(20,...o)}],required:n("companyName")},null,8,["modelValue","label","name","rules","required"])):i("",!0),r("workContent")?(u(),s(v,{key:40,modelValue:e.value.formInfo.extInfo.workContent,"onUpdate:modelValue":a[62]||(a[62]=o=>e.value.formInfo.extInfo.workContent=o),label:l("workContent","title"),name:`${t.prefix}_workContent`,required:n("workContent"),placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...o)=>_(100,...o)}]},null,8,["modelValue","label","name","required","rules"])):i("",!0),r("chineseTaxResident")?(u(),s(v,{key:41,modelValue:e.value.formInfo.extInfo.chineseTaxResident,"onUpdate:modelValue":a[64]||(a[64]=o=>e.value.formInfo.extInfo.chineseTaxResident=o),label:l("chineseTaxResident","title"),name:`${t.prefix}_taxResident`,required:n("chineseTaxResident"),placeholder:"\u8BF7\u8F93\u5165"},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.chineseTaxResident,"onUpdate:modelValue":a[63]||(a[63]=o=>e.value.formInfo.extInfo.chineseTaxResident=o),"is-view":t.isView,options:l("chineseTaxResident","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("taxResident")?(u(),s($,{key:42,modelValue:e.value.formInfo.taxResident,"onUpdate:modelValue":a[65]||(a[65]=o=>e.value.formInfo.taxResident=o),label:l("taxResident","title"),name:`${t.prefix}_benefitOrder`,"data-source":l("taxResident","attributeValueList")||[],required:n("taxResident")},null,8,["modelValue","label","name","data-source","required"])):i("",!0),r("partTimeJob")?(u(),s(v,{key:43,modelValue:e.value.formInfo.extInfo.isPartTime,"onUpdate:modelValue":a[67]||(a[67]=o=>e.value.formInfo.extInfo.isPartTime=o),label:l("partTimeJob","title"),name:`${t.prefix}_isPartTime`,required:n("partTimeJob"),placeholder:"\u8BF7\u8F93\u5165"},{input:p(()=>[C(E,{modelValue:e.value.formInfo.extInfo.isPartTime,"onUpdate:modelValue":a[66]||(a[66]=o=>e.value.formInfo.extInfo.isPartTime=o),"is-view":t.isView,options:l("partTimeJob","attributeValueList")||[]},null,8,["modelValue","is-view","options"])]),_:1},8,["modelValue","label","name","required"])):i("",!0),r("gasNumberCollection")?(u(),s(v,{key:44,modelValue:e.value.formInfo.extInfo.gasNumberCollection,"onUpdate:modelValue":a[68]||(a[68]=o=>e.value.formInfo.extInfo.gasNumberCollection=o),label:l("gasNumberCollection","title"),name:`${t.prefix}_gasNumberCollection`,required:n("gasNumberCollection"),placeholder:"\u8BF7\u8F93\u5165",rules:[{validator:(...o)=>_(100,...o)}]},null,8,["modelValue","label","name","required","rules"])):i("",!0),r("benefitOrder")?(u(),s($,{key:45,modelValue:e.value.formInfo.benefitOrder,"onUpdate:modelValue":a[69]||(a[69]=o=>e.value.formInfo.benefitOrder=o),label:l("benefitOrder","title"),name:`${t.prefix}_benefitOrder`,"data-source":l("benefitOrder","attributeValueList")||[],required:n("benefitOrder")},null,8,["modelValue","label","name","data-source","required"])):i("",!0),r("benefitRate")?(u(),s(v,{key:46,modelValue:e.value.formInfo.benefitRate,"onUpdate:modelValue":a[70]||(a[70]=o=>e.value.formInfo.benefitRate=o),required:n("benefitRate"),name:`${t.prefix}_benefitRate`,rules:[{validator:ye}],label:l("benefitRate","title")},{extra:p(()=>[Aa]),_:1},8,["modelValue","required","name","rules","label"])):i("",!0)])):i("",!0)}}});const wa={class:"page-info-wrapper"},ka={key:0,class:"beneficiary-part"},Ta={class:"part-title"},Ua={class:"title"},Na=Ee("\u5220\u9664"),Pa=ge({props:{factorObject:null,formData:{default:()=>({})},isView:{type:Boolean,default:!1},sendSmsCode:{type:Function,default:t=>{}}},setup(t,{expose:de}){const A=t;Me(),De();const h=y({}),F=y({tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),D=y(null),P=y([]),H=y([]);y([]),y([]);const e=y([]);Ye({beneficiaryId:0,nextPage:"",currentAddress:null,isLoading:!0});const z=N=>{F.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=F.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(w=>w.beneficiaryId!==N.beneficiaryId||N.id!==w.id)},se=()=>{Object.assign(F.value.tenantOrderInsuredList[0],F.value.tenantOrderHolder,{id:F.value.tenantOrderInsuredList[0].id,extInfo:{...F.value.tenantOrderHolder.extInfo,insureProvinceCode:F.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,insureCityCode:F.value.tenantOrderInsuredList[0].extInfo.insureCityCode,insureAreaCode:F.value.tenantOrderInsuredList[0].extInfo.insureAreaCode}})};return de({validateForm:()=>new Promise((N,w)=>{var B;(B=D.value)==null||B.validate().then(()=>{N(F.value)},()=>{w()})})}),G(()=>A.factorObject,()=>{const N={BENEFICIARY:A.factorObject[3],INSURER:A.factorObject[2],HOLDER:A.factorObject[1]};h.value=N},{immediate:!0,deep:!0}),G([()=>F.value.tenantOrderInsuredList[0].relationToHolder,()=>F.value.tenantOrderHolder],()=>{`${F.value.tenantOrderInsuredList[0].relationToHolder}`===Z.SELF&&se()},{deep:!0,immediate:!0}),(N,w)=>{const B=U("ProCard"),L=U("ProSvg"),S=U("ProForm");return u(),ie("div",wa,[C(S,{ref_key:"formRef",ref:D,"show-error":"","show-error-message":!1,"input-align":"left"},{default:p(()=>{var j,O,r;return[(j=h.value.HOLDER)!=null&&j.length?(u(),s(B,{key:0,"show-divider":!1,title:"\u672C\u4EBA\u4FE1\u606F\uFF08\u6295\u4FDD\u4EBA\uFF09"},{default:p(()=>[C(be,{images:P.value,"onUpdate:images":w[0]||(w[0]=n=>P.value=n),"form-info":F.value.tenantOrderHolder,"factor-list":h.value.HOLDER,prefix:"holder","is-view":t.isView,"send-sms-code":t.sendSmsCode},null,8,["images","form-info","factor-list","is-view","send-sms-code"])]),_:1})):i("",!0),(O=h.value.INSURER)!=null&&O.length?(u(),s(B,{key:1,"show-divider":!1,title:"\u4E3A\u8C01\u6295\u4FDD\uFF08\u88AB\u4FDD\u4EBA\uFF09"},{default:p(()=>[+F.value.tenantOrderInsuredList[0].relationToHolder!=1?(u(),s(be,{key:0,images:H.value,"onUpdate:images":w[1]||(w[1]=n=>H.value=n),"form-info":F.value.tenantOrderInsuredList[0],"factor-list":h.value.INSURER||[],prefix:"insure","send-sms-code":t.sendSmsCode,"is-view":t.isView},null,8,["images","form-info","factor-list","send-sms-code","is-view"])):i("",!0)]),_:1})):i("",!0),(r=h.value.BENEFICIARY)!=null&&r.length?(u(),s(B,{key:2,"show-divider":!1,title:"\u53D7\u76CA\u4EBA"},{default:p(()=>[F.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(u(),ie("div",ka,[(u(!0),ie(je,null,aa(F.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(n,l)=>(u(),ie("div",{key:n.beneficiaryId||n.id,class:"beneficiary-item"},[oe("div",Ta,[oe("span",Ua,He(`\u53D7\u76CA\u4EBA${l+1}`),1),C(L,{name:"delete",onClick:M=>z(n)},{default:p(()=>[Na]),_:2},1032,["onClick"])]),C(be,{images:e.value,"onUpdate:images":w[2]||(w[2]=M=>e.value=M),"form-info":n,"factor-list":h.value.BENEFICIARY||[],prefix:`beneficiary-${l}`,"is-view":t.isView,"send-sms-code":t.sendSmsCode,"beneficiary-list":F.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","is-view","send-sms-code","beneficiary-list"])]))),128))])):i("",!0)]),_:1})):i("",!0)]}),_:1},512)])}}});const Oa={class:"footer-button"},ha=Ee("\u5206\u4EAB\u7528\u6237\u786E\u8BA4\u6295\u4FDD"),qa=ge({setup(t){const de=Fa(),A=Me(),h=De(),{productCode:F="03O4",tenantId:D="0",orderNo:P,phoneNo:H,agentCode:e="",saleChannelId:z,paymentMethod:se,certNo:q,name:N,pageCode:w,from:B}=h.query,L=y(),S=y({}),j=y(),O=y(),r=y({}),n=w==="payBack",l=y(!1),M=y(!1),K=y(!1),me=y(0),ye=y(!1),_=y(!1),Ce=y({show:!1,html:""});let fe="";const f=Ye({holder:{certNo:q,certType:b.CERT,mobile:H,name:N,socialFlag:Fe.HAS},insured:{certNo:q,certType:b.CERT,name:N,socialFlag:Fe.HAS,relationToHolder:Z.SELF},paymentMethod:se,renewalDK:"Y",paymentFrequency:fa.YEAR,packageProductList:[],mobileSmsCode:""}),d=()=>{L.value&&L.value.validateForm().then(c=>{console.log("formData",c)})},a=pe(()=>{var c,m;return((m=(c=S.value)==null?void 0:c.tenantProductInsureVO)==null?void 0:m.attachmentVOList.filter(I=>I.attachmentName==="\u5065\u5EB7\u544A\u77E5"))||[]}),E=pe(()=>{var c,m;return((m=(c=S.value)==null?void 0:c.tenantProductInsureVO)==null?void 0:m.attachmentVOList.filter(I=>I.attachmentName!=="\u5065\u5EB7\u544A\u77E5"))||[]}),v=()=>{if(f.holder.certNo){const c=Ie(f.holder.certNo,"year"),m=Be(f.holder.certNo);if(c<18)return W("\u6295\u4FDD\u4EBA\u5E74\u9F84\u5FC5\u987B\u5927\u4E8E18\u5C81\uFF01"),!1;if(f.insured.certNo&&f.insured.relationToHolder===Z.MATE){const I=Be(f.insured.certNo);if(m===I)return W("\u88AB\u4FDD\u4EBA\u4E3A\u914D\u5076\u65F6\uFF0C\u6027\u522B\u4E0D\u53EF\u76F8\u540C\uFF01"),!1}}if(f.insured.certNo){const c=Ie(f.insured.certNo,"day"),m=Ie(f.insured.certNo,"year");if(f.insured.relationToHolder===Z.CHILD&&c<30)return W("\u88AB\u4FDD\u4EBA\u4E3A\u5B50\u5973\u65F6\uFF0C\u5E74\u9F84\u5FC5\u987B\u5927\u4E8E\u7B49\u4E8E30\u5929\uFF01"),!1;if(f.insured.relationToHolder===Z.PARENT&&m>=71)return W("\u88AB\u4FDD\u4EBA\u4E3A\u7236\u6BCD\u65F6\uFF0C\u5E74\u9F84\u5FC5\u987B\u5C0F\u4E8E\u7B49\u4E8E70\u5C81\uFF01"),!1}if([Z.CHILD,Z.PARENT].includes(f.insured.relationToHolder)){const c=Ie(f.holder.certNo,"year"),m=Ie(f.insured.certNo,"year");if(f.insured.relationToHolder===Z.CHILD&&c-m<18)return W("\u6295\u4FDD\u4EBA\u548C\u5B50\u5973\u5E74\u9F84\u5FC5\u987B\u76F8\u5DEE18\u5C81\uFF01"),!1;if(f.insured.relationToHolder===Z.PARENT&&m-c<18)return W("\u6295\u4FDD\u4EBA\u548C\u7236\u6BCD\u5E74\u9F84\u5FC5\u987B\u76F8\u5DEE18\u5C81\uFF01"),!1}return!0},ee=()=>{const{holder:{certNo:c,mobile:m,name:I,socialFlag:x},insured:{certNo:V,name:g,socialFlag:R,relationToHolder:Y},paymentMethod:J}=f;return!!(Ke(V)&&!!R)},$=()=>{A.push({path:"/internet/guaranteeUpgrade",query:{...h.query,tenantId:D,productCode:"BWYL2022",orderNo:P,agentCode:e}})},le=async c=>{W.loading({message:"\u6838\u4FDD\u4E2D...",forbidClick:!0});try{const m=await da(c),{code:I}=m;if(I==="10000"){W.loading({message:"\u6838\u4FDD\u4E2D...",forbidClick:!0});const x=await sa({orderNo:c.orderNo,tenantId:D}),{data:V}=x;x.code==="10000"&&(V.type===2?(Ce.value={show:!0,html:V.paymentUrl},console.log("data.paymentUrl",Ce.value),ua(()=>{console.log("document.forms",document.forms);const g=document.getElementById("cashierSubmit");g==null||g.addEventListener("submit",R=>{R.preventDefault()}),g==null||g.submit()})):window.location.href=V.paymentUrl)}}catch(m){console.log(m)}},te=c=>`${qe}/pay?orderNo=${c}&saleUserId=${e}&tenantId=${D}`,ue=c=>`${qe}/internet/payFail?tenantId=${D}&orderNo=${c}&agentCode=${e}&pageCode=payBack&from=${B||"normal"}`,ae=async c=>{console.log("risk",c);const m=Ca({tenantId:D,saleUserId:e,saleChannelId:z,detail:S.value,insureDetail:j.value,paymentMethod:f.paymentMethod,paymentFrequency:f.paymentFrequency,renewalDK:f.renewalDK,iseeBizNo:fe,successJumpUrl:"",premium:O.value,holder:f.holder,insured:f.insured,tenantOrderRiskList:c,orderStatus:"",orderTopStatus:""});try{const I=await ia(m),{code:x,data:V}=I;x==="10000"&&le({...m,orderNo:V.data,extInfo:{extraInfo:{renewalDK:f.renewalDK,paymentMethod:f.paymentMethod,paymentFrequency:f.paymentFrequency,successJumpUrl:te(V.data),failUrl:ue(V.data)},iseeBizNo:fe}})}catch(I){console.log(I)}},Ve=async()=>{const{calcData:c,riskVOList:m}=Le({holder:f.holder,insured:f.insured,tenantId:D,productDetail:S.value,insureDetail:j.value,paymentFrequency:f.paymentFrequency,packageRiskIdList:Se(f.packageProductList)},!1,$e);if(!Array.isArray(m)||m.length<1)return O.value=null,{};const I=await Oe(c),{code:x,data:V}=I;return x==="10000"?(O.value=V.premium,{condition:m,data:V}):(O.value=null,{})},o=c=>{me.value=c,K.value=!0},We=()=>new Promise((c,m)=>{var I,x;(x=(I=L.value)==null?void 0:I.validateForm)==null||x.call(I).then(async()=>{var ce;if(!v())return;if(!(((ce=L.value)==null?void 0:ce.isAgreeFile)||l.value)){l.value=!1,K.value=!0,o(0);return}const{calcData:g,riskVOList:R}=Le({holder:f.holder,insured:f.insured,tenantId:D,productDetail:S.value,insureDetail:j.value,paymentFrequency:f.paymentFrequency,packageRiskIdList:Se(f.packageProductList)},!1,$e);(!Array.isArray(R)||R.length<1)&&(O.value=null,m(new Error));const Y=await Oe(g),{code:J,data:ne}=Y;J==="10000"?(O.value=ne.premium,c({condition:R,data:ne})):(O.value=null,m(new Error))}).catch(()=>{})}),Ze=async()=>{var c;if(n){$();return}try{const{condition:m,data:I}=await We(),x={},V=(R=[])=>{(R||[]).forEach(Y=>{var J;x[Y.riskCode]=Y,(J=Y.riskPremiumDetailVOList)!=null&&J.length&&V(Y.riskPremiumDetailVOList)})};V(I.riskPremiumDetailVOList);const g=ya({tenantId:D,riskList:m,riskPremium:x,productId:(c=S.value)==null?void 0:c.id});ae(g)}catch(m){console.log(m)}},Ge=c=>{c==="allFalse"?(M.value=!1,l.value=!0,Ze()):ta.confirm({message:"\u60A8\u5F53\u524D\u7684\u5065\u5EB7\u72B6\u51B5\u4E0D\u7B26\u5408\u8BE5\u4EA7\u54C1",confirmButtonText:"\u786E\u5B9A"}).then(()=>{window.history.back()}).catch(()=>{var m;(m=L.value)==null||m.reEditForm(),l.value=!1})},Ae=()=>{var c;(c=L.value)==null||c.reEditForm(),l.value=!1},ze=()=>{console.log("onCloseHealthPopup========"),M.value=!1,Ae()},Je=()=>{console.log("onCloseFilePreview========"),K.value=!1,Ae()},Qe=()=>{K.value=!1,M.value=!0};G([()=>f.insured.certNo,()=>f.insured.socialFlag,()=>f.packageProductList,()=>f.paymentFrequency],oa.exports.debounce(()=>{f.insured.certNo&&f.insured.socialFlag&&ee()&&Ve()},500),{deep:!0,immediate:!0});const we=async()=>{var x,V,g,R,Y,J,ne,ce,ke,Te,Ue,Ne,Pe;const c=await ra({orderNo:P,tenantId:D}),{code:m,data:I}=c;if(m==="10000"){const{tenantOrderHolder:Q,tenantOrderInsuredList:k,extInfo:re}=I;if(!n){Object.assign(f,{holder:{certNo:Q.certNo,certType:Q.certType,mobile:Q.mobile,name:Q.name,socialFlag:Fe.HAS},insured:{certNo:k==null?void 0:k[0].certNo,certType:(x=k[0])==null?void 0:x.certType,name:(V=k[0])==null?void 0:V.name,socialFlag:(R=(g=k[0])==null?void 0:g.extInfo)==null?void 0:R.hasSocialInsurance,relationToHolder:(Y=k[0])==null?void 0:Y.relationToHolder},paymentMethod:re.extraInfo.paymentMethod,paymentFrequency:re.extraInfo.paymentFrequency,renewalDK:re.extraInfo.renewalDK||"N"});return}Object.assign(f,{holder:{certNo:Q.certNo,certType:Q.certType,mobile:Q.mobile,name:Q.name,socialFlag:Fe.HAS},insured:{certNo:k==null?void 0:k[0].certNo,certType:(J=k[0])==null?void 0:J.certType,name:(ne=k[0])==null?void 0:ne.name,socialFlag:(ke=(ce=k[0])==null?void 0:ce.extInfo)==null?void 0:ke.hasSocialInsurance,relationToHolder:(Te=k[0])==null?void 0:Te.relationToHolder},paymentMethod:re.extraInfo.paymentMethod,paymentFrequency:re.extraInfo.paymentFrequency,renewalDK:re.extraInfo.renewalDK||"N"}),O.value=(Pe=(Ne=(Ue=k[0])==null?void 0:Ue.tenantOrderProductList)==null?void 0:Ne[0])==null?void 0:Pe.premium,(I.orderStatus===xe.ACCEPT_POLICY||I.orderStatus===xe.PAYMENT_SUCCESS)&&(ye.value=!1,_.value=!0),I.orderStatus===xe.PAYING&&(ye.value=!0,setTimeout(()=>{we()},3*1e3))}},Xe=async()=>{var I;const{code:c,data:m}=await na({productCode:F});c==="10000"&&(f.packageProductList=(((I=m.data)==null?void 0:I.packageProductVOList)||[]).map(x=>({...x,value:ca.UN_INSURE,disabled:!1})),j.value=m.data,r.value=m.productFactor),P&&we()};return la(()=>{Xe(),setTimeout(async()=>{fe=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(c,m)=>{const I=U("van-button"),x=U("ProPageWrap"),V=U("van-config-provider");return u(),ie(je,null,[C(V,{"theme-vars":T(de)},{default:p(()=>[C(x,{class:"net-sale-wrap"},{default:p(()=>[C(Pa,{ref_key:"formRef",ref:L,"form-info":S.value,"send-sms-code":()=>{},"factor-object":r.value},null,8,["form-info","send-sms-code","factor-object"]),oe("div",Oa,[C(I,{type:"primary",block:"",onClick:d},{default:p(()=>[ha]),_:1})])]),_:1})]),_:1},8,["theme-vars"]),C(Ea,{show:M.value,"onUpdate:show":m[0]||(m[0]=g=>M.value=g),"content-list":T(a),"active-index":0,onOnConfirmHealth:Ge,onOnCloseHealth:ze},null,8,["show","content-list"]),K.value?(u(),s(Va,{key:0,show:K.value,"onUpdate:show":m[1]||(m[1]=g=>K.value=g),"content-list":T(E),"active-index":me.value,text:"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9","force-read-cound":2,"on-close-file-preview":"",onSubmit:Qe,onOnCloseFilePreview:Je},null,8,["show","content-list","active-index"])):i("",!0)],64)}}});var Ga=pa(qa,[["__scopeId","data-v-7093cf5d"]]);export{Ga as default};
