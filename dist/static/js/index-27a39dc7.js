var Fe=Object.defineProperty,Ce=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var fe=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var pe=(t,o,n)=>o in t?Fe(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,$=(t,o)=>{for(var n in o||(o={}))Ae.call(o,n)&&pe(t,n,o[n]);if(fe)for(var n of fe(o))Oe.call(o,n)&&pe(t,n,o[n]);return t},S=(t,o)=>Ce(t,he(o));import{g as P,L as q,o as z,$ as T,r as L,k as f,m as h,n as D,j as v,y as O,z as e,a0 as Q,a1 as X,a2 as Z,C as x,h as b,s as E,I as Y,d as xe,a3 as Re,x as N,F as M,E as j,a4 as _e,a5 as Be,B as G}from"./vendor-1bbdd8d9.js";import{_ as W,P as _,a as we}from"./index-f46d842e.js";import{b as H,S as J}from"./index-f3d84f20.js";const Te=[{label:"\u7537",value:"1"},{label:"\u5973",value:"2"}],Pe=[{label:"\u6709",value:"1"},{label:"\u65E0",value:"2"}],qe=[{value:1,label:"\u7B2C5\u4E2A\u4FDD\u5355\u5468\u5E74\u65E5"},{value:2,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8455\u5468\u5C81"},{value:3,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8460\u5468\u5C81"},{value:4,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8465\u5468\u5C81"},{value:5,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8470\u5468\u5C81"},{value:6,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8475\u5468\u5C81"}],Ue=[{value:1,label:"\u5E74\u9886"},{value:2,label:"\u6708\u9886"}],ye=[{label:"\u8DB8\u4EA4",value:"1"},{label:"\u5E74\u4EA4",value:"2"},{label:"\u534A\u5E74\u4EA4",value:"3"},{label:"\u5B63\u4EA4",value:"4"},{label:"\u6708\u4EA4",value:"5"}],Ve=[{label:"\u8DB8\u4EA4",value:"single"},{label:"1\u5E74\u4EA4",value:"year_1"},{label:"5\u5E74\u4EA4",value:"year_5"},{label:"10\u5E74\u4EA4",value:"year_10"},{label:"15\u5E74\u4EA4",value:"year_15"},{label:"20\u5E74\u4EA4",value:"year_20"},{label:"25\u5E74\u4EA4",value:"year_25"},{label:"30\u5E74\u4EA4",value:"year_30"},{label:"35\u5E74\u4EA4",value:"year_35"}],ke=[{label:"7\u5929",value:"day_7"},{label:"14\u5929",value:"day_14"},{label:"30\u5929",value:"day_30"},{label:"1\u5E74",value:"year_1"},{label:"3\u5E74",value:"year_3"},{label:"5\u5E74",value:"year_5"},{label:"10\u5E74",value:"year_10"},{label:"15\u5E74",value:"year_15"},{label:"20\u5E74",value:"year_20"},{label:"25\u5E74",value:"year_25"},{label:"30\u5E74",value:"year_30"},{label:"35\u5E74",value:"year_35"},{label:"\u7EC8\u8EAB",value:"to_life"}],$e=[{label:"\u4E3B\u9669\u4FDD\u969C\u671F\u95F4\u51CF1",value:"3"},{label:"\u65E0\u9650\u5236",value:"2"}],Ie=[{label:"\u8FD4\u4FDD\u989D",value:1},{label:"\u8FD4\u4FDD\u8D39",value:2}],Se=[{label:"\u6295\u4FDD",value:1},{label:"\u4E0D\u6295\u4FDD",value:2}],Ee=(t={})=>H.post("/api/gateway/system/dict/v2/queryDictInfo",t);new J({source:"sessionStorage"});const De=new J({source:"localStorage"});new J({source:"cookie"});const Ne=t=>(Q("data-v-1e1e74de"),t=t(),X(),t),Ye={class:"com-occupational-wrapper"},Me=Ne(()=>O("div",{class:"popup-title"},"\u9009\u62E9\u804C\u4E1A",-1)),je={class:"popup-content"},Ge=P({props:{modelValue:{type:Array,required:!0,default:()=>[]},insuredCode:{type:String,required:!0,default:""},show:{type:Boolean,required:!0,default:!1}},emits:["finish","close","update:modelValue"],setup(t,{emit:o}){const n=t,y=q({show:n.show,options:[],currentValue:""}),l=()=>{o("close")},F=({value:m,selectedOptions:s})=>{console.log(m,s);const i=(s||[]).map(d=>d.value).join("/");o("update:modelValue",m),o("finish",i),l()},I=m=>{const s=m,i=d=>{d.forEach(r=>{const a=r;a.children.length?i(a.children):a.children=null})};return i(s),s},u=()=>{var i,d;const m=`${(d=(i=n.insurerCode)==null?void 0:i.toLocaleUpperCase)==null?void 0:d.call(i)}_OCCUPATION`,s=De.get("occupational")||{};if(s[m]){y.options=s[m];return}Ee({dictCodeList:[m]}).then(({code:r,data:a})=>{var c;if(r==="10000"){const V=I(((c=a==null?void 0:a[0])==null?void 0:c.dictItemList)||[]);y.options=V,s[m]=V,De.set("occupational",s)}})};return z(()=>{u()}),T(()=>n.modelValue,m=>{},{deep:!0,immediate:!0}),(m,s)=>{const i=L("van-cascader"),d=L("VanPopup");return f(),h("div",Ye,[D(d,{show:e(y).show,"onUpdate:show":s[1]||(s[1]=r=>e(y).show=r),"show-footer":"",position:"bottom",closeable:"",onClose:l},{default:v(()=>[Me,O("div",je,[D(i,{modelValue:e(y).currentValue,"onUpdate:modelValue":s[0]||(s[0]=r=>e(y).currentValue=r),title:"\u8BF7\u9009\u62E9\u804C\u4E1A","show-header":!1,placeholder:"\u8BF7\u9009\u62E9",options:e(y).options,"active-color":"#0d6efe","field-names":{text:"value",value:"code",children:"children"},onFinish:F},null,8,["modelValue","options"])])]),_:1},8,["show"])])}}});var We=W(Ge,[["__scopeId","data-v-1e1e74de"]]);const Ke={class:"com-personal-info-wrapper"},ve=P({props:{formInfo:{type:Object,required:!0,default:()=>{}},insuredCode:{type:String,required:!0,default:""},factorList:{type:Array,required:!0,default:()=>[]}},setup(t,{expose:o}){const n=t,[y,l]=Z(),[F,I]=Z(),u=x(),m=q({formInfo:n==null?void 0:n.formInfo,occupationalText:""}),s=r=>{m.occupationalText=r},i=()=>{I(!1)};return o({validateForm:()=>new Promise((r,a)=>{u==null||u.value.validate().then(()=>{r("")},()=>{a()})})}),(r,a)=>{const c=L("VanField"),V=L("VanForm"),g=L("van-datetime-picker"),A=L("van-popup");return f(),h("div",Ke,[D(V,{ref_key:"formRef",ref:u,"input-align":"right","error-message-align":"right"},{default:v(()=>[t.factorList.includes("APPLICANT.AGE")||t.factorList.includes("AGE")?(f(),b(c,{key:0,modelValue:e(m).formInfo.birthday,"onUpdate:modelValue":a[0]||(a[0]=k=>e(m).formInfo.birthday=k),rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],name:"birth",label:"\u51FA\u751F\u65E5\u671F","is-link":"",placeholder:"\u8BF7\u9009\u62E9",onClick:a[1]||(a[1]=k=>e(l)(!0))},null,8,["modelValue"])):E("",!0),t.factorList.includes("APPLICANT.GENDER")||t.factorList.includes("GENDER")?(f(),b(c,{key:1,modelValue:e(m).formInfo.gender,"onUpdate:modelValue":a[3]||(a[3]=k=>e(m).formInfo.gender=k),name:"gender",label:"\u6027\u522B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[D(_,{modelValue:e(m).formInfo.gender,"onUpdate:modelValue":a[2]||(a[2]=k=>e(m).formInfo.gender=k),options:e(Te)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),t.factorList.includes("SOCIAL_INS")?(f(),b(c,{key:2,modelValue:e(m).formInfo.socialSecurity,"onUpdate:modelValue":a[5]||(a[5]=k=>e(m).formInfo.socialSecurity=k),name:"socialSecurity",label:"\u793E\u4FDD",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[D(_,{modelValue:e(m).formInfo.socialSecurity,"onUpdate:modelValue":a[4]||(a[4]=k=>e(m).formInfo.socialSecurity=k),options:e(Pe)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),t.factorList.includes("OCCUPATION_CATEGORY")?(f(),b(c,{key:3,modelValue:e(m).formInfo.occupationalClass,"onUpdate:modelValue":a[6]||(a[6]=k=>e(m).formInfo.occupationalClass=k),rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],name:"occupationalClass",label:"\u804C\u4E1A\u7C7B\u578B","is-link":"",placeholder:"\u8BF7\u9009\u62E9",onClick:a[7]||(a[7]=k=>e(I)(!0))},{input:v(()=>[O("div",null,Y(e(m).occupationalText),1)]),_:1},8,["modelValue"])):E("",!0)]),_:1},512),D(A,{show:e(y),"onUpdate:show":a[10]||(a[10]=k=>Re(y)?y.value=k:null),position:"bottom"},{default:v(()=>[D(g,{type:"date","min-date":new Date("1900-01-01"),"max-date":new Date,onConfirm:a[8]||(a[8]=k=>{e(m).formInfo.birthday=e(xe)(k).format("YYYY-MM-DD"),e(l)(!1)}),onCancel:a[9]||(a[9]=k=>e(l)(!1))},null,8,["min-date","max-date"])]),_:1},8,["show"]),e(F)?(f(),b(We,{key:0,modelValue:e(m).formInfo.occupationalClass,"onUpdate:modelValue":a[11]||(a[11]=k=>e(m).formInfo.occupationalClass=k),show:e(F),"insured-code":"insuredCode",onFinish:s,onClose:i},null,8,["modelValue","show"])):E("",!0)])}}}),Ze={class:"com-risk-card-wrapper"},ze={key:0},Qe={key:0},Xe={key:1},He={key:7,class:"liab-desc"},Je=O("div",{class:"title"},"\u8D23\u4EFB\u6295\u4FDD\u8BF4\u660E",-1),ge=P({props:{originData:{type:Object,required:!0,default:()=>{}},formInfo:{type:Object,required:!0,default:()=>{}},mainRiskData:{type:Object,default:()=>{}},index:{type:[Number,String],default:0,required:!0}},setup(t){const o=t,n=q({formInfo:o.formInfo}),y=s=>typeof s!="boolean"&&!s||Array.isArray(s)&&!s.length?!0:{}.toString.call(s)==="object Object"?Object.keys(s).length:!1,l=(s,i)=>{let d=i;return Array.isArray(i)||(d=[`${d}`]),(s||[]).filter(r=>d.includes(`${r.value}`))},F=N(()=>{var s,i,d,r,a,c,V,g;return((s=o.originData)==null?void 0:s.riskType)===1?l(ke,(d=(i=o==null?void 0:o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:d.insurancePeriodValueList):((r=o.originData)==null?void 0:r.periodType)===2?l([{value:"4",label:"1\u5E74"}],(c=(a=o==null?void 0:o.originData)==null?void 0:a.riskInsureLimitVO)==null?void 0:c.insurancePeriodRule):l(ke,(g=(V=o==null?void 0:o.mainRiskData)==null?void 0:V.riskInsureLimitVO)==null?void 0:g.insurancePeriodValueList)}),I=N(()=>{var s,i,d,r,a,c,V,g,A,k,C;return((s=o.originData)==null?void 0:s.riskType)===1?l(Ve,(d=(i=o==null?void 0:o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:d.paymentPeriodValueList):((r=o.originData)==null?void 0:r.exemptFlag)===1?l($e,(c=(a=o==null?void 0:o.originData)==null?void 0:a.riskInsureLimitVO)==null?void 0:c.paymentPeriodRule):((V=o.originData)==null?void 0:V.periodType)===2?l([{value:"4",label:"1\u5E74\u4EA4"}],(A=(g=o==null?void 0:o.originData)==null?void 0:g.riskInsureLimitVO)==null?void 0:A.paymentPeriodRule):l(Ve,(C=(k=o==null?void 0:o.mainRiskData)==null?void 0:k.riskInsureLimitVO)==null?void 0:C.paymentPeriodValueList)}),u=N(()=>{var s,i,d,r,a;return((s=o.originData)==null?void 0:s.riskType)===1?l(ye,(d=(i=o==null?void 0:o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:d.paymentFrequencyList):l(ye,(a=(r=o==null?void 0:o.mainRiskData)==null?void 0:r.riskInsureLimitVO)==null?void 0:a.paymentFrequencyList)}),m=N(()=>{var d,r;let s=0,i=0;return(((r=(d=o.originData)==null?void 0:d.riskCalcMethodInfoVO)==null?void 0:r.paymentMethodLimitList)||[]).forEach((a,c)=>{c===0&&(s=a.minAmount,i=a.maxAmount),s>a.minAmount&&(s=a.minAmount),i<a.maxAmount&&(i=a.maxAmount)}),n.formInfo[o.index].sumInsured=s,{min:s,max:i}});return z(()=>{var i;const s={riskType:o.originData.riskType,riskId:o.originData.id,riskCode:o.originData.riskCode,mainRiskCode:o.originData.riskCode,mainRiskId:o.originData.id,riskCategory:o.originData.riskCategory,liabilityVOList:(o.originData.riskLiabilityInfoVOList||[]).map(d=>({liabilityAttributeCode:d.liabilityAttribute,liabilityAttributeValue:d.liabilityAttributeValue,liabilityCode:d.liabilityCode,liabilityId:d.id,liabilityRateType:d.liabilityRateType}))};console.log("props.index",o.index),Object.assign((i=n==null?void 0:n.formInfo)==null?void 0:i[o.index],s)}),T(()=>o.originData,()=>{},{immediate:!0,deep:!0}),(s,i)=>{var a,c,V,g,A,k,C,w,U,B,ee,te,ae,oe,ie,ne,ue,le,re,se,de,ce,me;const d=L("VanStepper"),r=L("VanField");return f(),h("div",Ze,[((c=(a=t.originData)==null?void 0:a.riskCalcMethodInfoVO)==null?void 0:c.saleMethod)===1?(f(),b(r,{key:0,modelValue:e(n).formInfo[t.index].sumInsured,"onUpdate:modelValue":i[1]||(i[1]=p=>e(n).formInfo[t.index].sumInsured=p),label:"\u4FDD\u989D",name:"sumInsured",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:v(()=>[D(d,{modelValue:e(n).formInfo[t.index].sumInsured,"onUpdate:modelValue":i[0]||(i[0]=p=>e(n).formInfo[t.index].sumInsured=p),min:e(m).min,max:e(m).max},null,8,["modelValue","min","max"])]),_:1},8,["modelValue"])):E("",!0),((g=(V=t.originData)==null?void 0:V.riskCalcMethodInfoVO)==null?void 0:g.saleMethod)===2?(f(),b(r,{key:1,modelValue:e(n).formInfo[t.index].premium,"onUpdate:modelValue":i[3]||(i[3]=p=>e(n).formInfo[t.index].premium=p),label:"\u4FDD\u8D39",name:"premium",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:v(()=>[D(d,{modelValue:e(n).formInfo[t.index].premium,"onUpdate:modelValue":i[2]||(i[2]=p=>e(n).formInfo[t.index].premium=p)},null,8,["modelValue"])]),_:1},8,["modelValue"])):E("",!0),!y((k=(A=t.originData)==null?void 0:A.riskInsureLimitVO)==null?void 0:k.insurancePeriodValueList)||!y((w=(C=t.originData)==null?void 0:C.riskInsureLimitVO)==null?void 0:w.insurancePeriodRule)?(f(),b(r,{key:2,modelValue:e(n).formInfo[t.index].coverageYear,"onUpdate:modelValue":i[5]||(i[5]=p=>e(n).formInfo[t.index].coverageYear=p),label:"\u4FDD\u969C\u671F\u95F4",name:"coverageYear",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[D(_,{modelValue:e(n).formInfo[t.index].coverageYear,"onUpdate:modelValue":i[4]||(i[4]=p=>e(n).formInfo[t.index].coverageYear=p),options:e(F)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),!y((B=(U=t.originData)==null?void 0:U.riskInsureLimitVO)==null?void 0:B.paymentPeriodValueList)||!y((te=(ee=t.originData)==null?void 0:ee.riskInsureLimitVO)==null?void 0:te.paymentPeriodRule)?(f(),b(r,{key:3,modelValue:e(n).formInfo[t.index].paymentYear,"onUpdate:modelValue":i[7]||(i[7]=p=>e(n).formInfo[t.index].paymentYear=p),label:"\u4EA4\u8D39\u671F\u95F4",name:"paymentYear",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[D(_,{modelValue:e(n).formInfo[t.index].paymentYear,"onUpdate:modelValue":i[6]||(i[6]=p=>e(n).formInfo[t.index].paymentYear=p),options:e(I)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),!y((oe=(ae=t.originData)==null?void 0:ae.riskInsureLimitVO)==null?void 0:oe.paymentFrequencyList)||!y((ne=(ie=t.originData)==null?void 0:ie.riskInsureLimitVO)==null?void 0:ne.paymentTypeRule)?(f(),b(r,{key:4,modelValue:e(n).formInfo[t.index].paymentFrequency,"onUpdate:modelValue":i[9]||(i[9]=p=>e(n).formInfo[t.index].paymentFrequency=p),label:"\u4EA4\u8D39\u65B9\u5F0F",name:"paymentFrequency",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[D(_,{modelValue:e(n).formInfo[t.index].paymentFrequency,"onUpdate:modelValue":i[8]||(i[8]=p=>e(n).formInfo[t.index].paymentFrequency=p),options:e(u)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),y((le=(ue=t.originData)==null?void 0:ue.riskInsureLimitVO)==null?void 0:le.annuityDrawTypeList)?E("",!0):(f(),b(r,{key:5,modelValue:e(n).formInfo[t.index].annuityDrawDate,"onUpdate:modelValue":i[11]||(i[11]=p=>e(n).formInfo[t.index].annuityDrawDate=p),label:"\u9886\u53D6\u65F6\u95F4",name:"annuityDrawDate",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>{var p,R;return[D(_,{modelValue:e(n).formInfo[t.index].annuityDrawDate,"onUpdate:modelValue":i[10]||(i[10]=K=>e(n).formInfo[t.index].annuityDrawDate=K),options:l(e(qe),(R=(p=t.originData)==null?void 0:p.riskInsureLimitVO)==null?void 0:R.annuityDrawTypeList)},null,8,["modelValue","options"])]}),_:1},8,["modelValue"])),y((se=(re=t.originData)==null?void 0:re.riskInsureLimitVO)==null?void 0:se.annuityDrawFrequencyList)?E("",!0):(f(),b(r,{key:6,modelValue:e(n).formInfo[t.index].annuityDrawType,"onUpdate:modelValue":i[13]||(i[13]=p=>e(n).formInfo[t.index].annuityDrawType=p),label:"\u9886\u53D6\u65B9\u5F0F",name:"annuityDrawType",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>{var p,R;return[D(_,{modelValue:e(n).formInfo[t.index].annuityDrawType,"onUpdate:modelValue":i[12]||(i[12]=K=>e(n).formInfo[t.index].annuityDrawType=K),options:l(e(Ue),(R=(p=t.originData)==null?void 0:p.riskInsureLimitVO)==null?void 0:R.annuityDrawFrequencyList)},null,8,["modelValue","options"])]}),_:1},8,["modelValue"])),(f(!0),h(M,null,j(((de=t.originData)==null?void 0:de.riskLiabilityInfoVOList)||[],p=>(f(),b(r,{key:p.liabilityId,label:p.liabilityName,name:"liabilityAttributeValue",rules:[{required:p.optionalFlag===1&&p.liabilityAttributeValue,message:"\u8BF7\u9009\u62E9"}]},{input:v(()=>[p.optionalFlag===1?(f(),h("div",ze,[p.liabilityAttributeValue?(f(),b(_,{key:1,modelValue:e(n).formInfo[t.index].liabilityVOList,"onUpdate:modelValue":i[14]||(i[14]=R=>e(n).formInfo[t.index].liabilityVOList=R),options:e(Ie)},null,8,["modelValue","options"])):(f(),h("span",Qe,"50\u4E07"))])):(f(),h("div",Xe,[p.liabilityAttributeValue?(f(),b(_,{key:1,modelValue:e(n).formInfo[t.index].liabilityVOList,"onUpdate:modelValue":i[16]||(i[16]=R=>e(n).formInfo[t.index].liabilityVOList=R),options:e(Ie)},null,8,["modelValue","options"])):(f(),b(_,{key:0,modelValue:e(n).formInfo[t.index].liabilityVOList,"onUpdate:modelValue":i[15]||(i[15]=R=>e(n).formInfo[t.index].liabilityVOList=R),options:e(Se)},null,8,["modelValue","options"]))]))]),_:2},1032,["label","rules"]))),128)),((ce=t.originData)==null?void 0:ce.relationDesc)?(f(),h("div",He,[Je,O("div",null,Y((me=t.originData)==null?void 0:me.relationDesc),1)])):E("",!0)])}}});const et=t=>(Q("data-v-aeeb813a"),t=t(),X(),t),tt={class:"com-risk-list-wrapper"},at=et(()=>O("div",{class:"popup-title"},"\u9009\u62E9\u9644\u52A0\u9669",-1)),ot={class:"risk-list"},it={class:"footer-bar"},nt=G("\u786E\u8BA4"),ut=P({props:{riskList:{type:Array,required:!0,default:()=>[]},show:{type:Boolean,required:!0,default:!1},collocationList:{type:Array,default:()=>[]},disabled:{type:Array,required:!0,default:()=>[]},modelValue:{type:Array,required:!0,default:()=>[]}},emits:["finished","close","update:modelValue"],setup(t,{emit:o}){const n=t,y=x([]),l=x([]),F=x(n.disabled),I=q({show:n.show,currentChecked:[]}),u=(d,r)=>{n.collocationList.forEach(a=>{d===a.riskId&&(r?a.collocationType===1?I.currentChecked=I.currentChecked.filter(c=>!(c===a.collocationRiskId||c===d)):a.collocationType===3&&F.value.filter(c=>c!==a.collocationRiskId):a.collocationType===1?I.currentChecked.push(a.collocationRiskId,d):a.collocationType===3&&F.value.push(a.collocationRiskId))})},m=d=>{var a,c,V;const r=I.currentChecked.includes(d);console.log("status",r),u(d,r),(V=(c=(a=y==null?void 0:y.value)==null?void 0:a[d])==null?void 0:c.toggle)==null||V.call(c)},s=()=>{o("close")},i=()=>{const d=n.riskList.filter(r=>I.currentChecked.includes(r.id));o("update:modelValue",l),o("finished",d),o("close")};return _e(()=>{y.value=[]}),T(()=>n.modelValue,d=>{l.value=d,F.value=d},{deep:!0,immediate:!0}),(d,r)=>{const a=L("van-checkbox"),c=L("VanCell"),V=L("van-cell-group"),g=L("van-checkbox-group"),A=L("VanButton"),k=L("VanPopup");return f(),h("div",tt,[D(k,{show:e(I).show,"onUpdate:show":r[2]||(r[2]=C=>e(I).show=C),title:"\u9009\u62E9\u9644\u52A0\u9669","show-footer":"",position:"bottom",closeable:"",onClose:s},{default:v(()=>[at,O("div",ot,[D(g,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=C=>l.value=C)},{default:v(()=>[D(V,{inset:""},{default:v(()=>[(f(!0),h(M,null,j(t.riskList,C=>(f(),b(c,{key:C.id,title:C.riskName,onClick:w=>m(C.id)},{"right-icon":v(()=>[D(a,{ref_for:!0,ref:w=>y.value[C.id]=w,disabled:F.value.includes(C.id),shape:"square",name:C.id,onClick:r[0]||(r[0]=Be(()=>{},["stop"]))},null,8,["disabled","name"])]),_:2},1032,["title","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])]),O("div",it,[D(A,{type:"primary",disabled:!e(I).currentChecked.length,block:"",onClick:i},{default:v(()=>[nt]),_:1},8,["disabled"])])]),_:1},8,["show"])])}}});var lt=W(ut,[["__scopeId","data-v-aeeb813a"]]);const rt={class:"risk-list-wrapper"},st={key:0,class:"add-rider-risk"},dt={class:"left-part"},ct=G("+ \u9644\u52A0\u9669"),mt=P({props:{riskInfo:{type:Object,required:!0,default:()=>{}},originData:{type:Object,required:!0,default:()=>{}},pickFactor:{type:Function,required:!0,default:()=>{}}},setup(t){const o=t,[n,y]=Z(!1);x(null),x(null);const l=q({mainRiskInfo:o.riskInfo,riderRiskInfo:o.riskInfo[0].riderRiskVOList,requiredRiderRiskData:[],mainRiskData:{},riderRiskList:[],checkedList:[],relationListNum:0,disabledList:[]}),F=(I,u)=>{l.riderRiskInfo.push({}),l.disabledList=u,l.requiredRiderRiskData=l.requiredRiderRiskData.concat(I)};return T(()=>l.mainRiskInfo,()=>{},{deep:!0,immediate:!0}),T(()=>l.riderRiskInfo,()=>{},{deep:!0,immediate:!0}),T(()=>l.requiredRiderRiskData,I=>{const u=[l.mainRiskData,...I];let m=[],s=[];u.forEach(i=>{var r;const d=((r=i==null?void 0:i.riskCalcMethodInfoVO)==null?void 0:r.riskFactorRelationList)||[];m=m.concat(d.filter(a=>a.factorObject==="insured").map(a=>a.factorCode)),s=s.concat(d.filter(a=>a.factorObject==="holder").map(a=>a.factorCode))}),o.pickFactor({insuredFactorList:[...new Set(m)],holderFactorList:[...new Set(s)]})},{deep:!0,immediate:!0}),T(()=>o.originData,I=>{(I||[]).forEach(u=>{u.riskType===1?(l.mainRiskData=u,l.requiredRiderRiskData=(u==null?void 0:u.requiredRiderRiskVOList)||[],l.riderRiskList=u==null?void 0:u.optionalRiderRiskVOList):l.riderRiskList.push(u)})},{deep:!0,immediate:!0}),(I,u)=>(f(),h("div",rt,[D(ge,{"form-info":e(l).mainRiskInfo,index:0,"origin-data":e(l).mainRiskData},null,8,["form-info","origin-data"]),(f(!0),h(M,null,j(e(l).requiredRiderRiskData,(m,s)=>(f(),b(ge,{key:m.id,"form-info":e(l).riderRiskInfo,index:s,"main-risk-data":e(l).mainRiskData,"origin-data":m},null,8,["form-info","index","main-risk-data","origin-data"]))),128)),e(l).riderRiskList.length-e(l).checkedList.length?(f(),h("div",st,[O("span",dt,Y(`\u5171\u6709${e(l).riderRiskList.length-e(l).checkedList.length}\u6B3E\u9644\u52A0\u9669\u53EF\u4EE5\u6DFB\u52A0`),1),D(we,{activied:"",onClick:u[0]||(u[0]=m=>e(y)(!0))},{default:v(()=>[ct]),_:1})])):E("",!0),e(n)?(f(),b(lt,{key:1,modelValue:e(l).checkedList,"onUpdate:modelValue":u[1]||(u[1]=m=>e(l).checkedList=m),show:e(n),disabled:e(l).disabledList,"risk-list":e(l).riderRiskList,"collocation-list":e(l).mainRiskData.collocationVOList||[],onFinished:F,onClose:u[2]||(u[2]=m=>e(y)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):E("",!0)]))}});var be=W(mt,[["__scopeId","data-v-f37289bc"]]);const ft=(t={})=>H.get(`/api/product/insureProductDetail/${t==null?void 0:t.productId}`,t),pt=(t={})=>H.post("/api/insurance/premiumCalc",t);const Le=t=>(Q("data-v-ca9a3e7e"),t=t(),X(),t),yt={key:0,class:"part-card"},Vt=Le(()=>O("div",{class:"part-title"},"\u6295\u4FDD\u4EBA",-1)),kt={key:1,class:"part-card"},It=Le(()=>O("div",{class:"part-title"},"\u88AB\u4FDD\u4EBA",-1)),Dt={class:"risk-content"},vt={key:0,class:"risk"},gt={key:1,class:"plan-risk"},bt={class:"footer-bar"},Et={class:"trial-result"},Lt=G("\u53BB\u8BD5\u7B97"),Ft=G("\u53BB\u6295\u4FDD"),Ct=P({setup(t){const o=x({personVO:{}}),n=x({insuredCode:"",personVO:{}}),y=x([{liabilityVOList:[],riderRiskVOList:[{}]}]),l=x({}),F=x({}),I=x({}),u=q({currentPlan:"",riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0}),m=async()=>{var c,V,g;const a=["RISK_PAYMENT_PERIOD","RISK_INSURANCE_PERIOD","LIABILITY_ATTRIBUTE_TYPE",`${(g=(V=(c=u==null?void 0:u.riskBaseInfo)==null?void 0:c.insurerCode)==null?void 0:V.toLocaleUpperCase)==null?void 0:g.call(V)}_OCCUPATION`];await Ee({dictCodeList:a})},s=()=>{var c,V,g;const a={holder:{personVO:S($({},o.value.personVO),{birthday:o.value.personVO.birthday&&`${o.value.personVO.birthday} 00:00:00`})},productCode:(c=u==null?void 0:u.riskBaseInfo)==null?void 0:c.productCode,insuredVOList:[S($({},n.value),{personVO:S($({},n.value.personVO),{birthday:n.value.personVO.birthday&&`${n.value.personVO.birthday} 00:00:00`}),productPlanVOList:[{planCode:u.currentPlan||((g=(V=u.riskPlanData)==null?void 0:V[0])==null?void 0:g.planCode),riskVOList:y.value}]})]};pt($({},a)).then(({code:A,data:k})=>{A==="10000"&&(u.trialResult=k,u.canTrial=!1)})},i=()=>{var a,c,V,g,A;Promise.all([(c=(a=l==null?void 0:l.value)==null?void 0:a.validateForm)==null?void 0:c.call(a),(g=(V=F==null?void 0:F.value)==null?void 0:V.validateForm)==null?void 0:g.call(V),(A=I==null?void 0:I.value)==null?void 0:A.validate()]).then(()=>{s()})},d=()=>{ft({productId:115}).then(({code:a,data:c})=>{a==="10000"&&(u.riskBaseInfo=c==null?void 0:c.productBasicInfoVO,u.riskData=(c==null?void 0:c.riskDetailVOList)||[],u.riskPlanData=(c==null?void 0:c.productRelationPlanVOList)||[],m())}).finally(()=>{})},r=a=>{u.holderFactor=a.insuredFactorList,u.insuredFactor=a.holderFactorList};return T([()=>y.value,()=>o.value,()=>n.value],a=>{a&&u.canTrial&&(u.canTrial=!0)},{deep:!0}),z(()=>{d()}),(a,c)=>{const V=L("VanForm"),g=L("VanTab"),A=L("VanTabs"),k=L("VanButton"),C=L("ZaPageWrap");return f(),b(C,{class:"page-trial-wrapper"},{default:v(()=>{var w,U;return[e(u).holderFactor.length?(f(),h("div",yt,[Vt,D(ve,{ref_key:"holderRef",ref:l,"insured-code":(w=e(u).riskBaseInfo)==null?void 0:w.insuredCode,"form-info":o.value.personVO,"factor-list":e(u).holderFactor},null,8,["insured-code","form-info","factor-list"])])):E("",!0),e(u).insuredFactor.length?(f(),h("div",kt,[It,D(ve,{ref_key:"insuredRef",ref:F,"insured-code":(U=e(u).riskBaseInfo)==null?void 0:U.insuredCode,"form-info":n.value.personVO,"factor-list":e(u).insuredFactor},null,8,["insured-code","form-info","factor-list"])])):E("",!0),O("div",Dt,[e(u).riskData.length?(f(),h("div",vt,[D(V,{ref_key:"riskFormRef",ref:I,"input-align":"right","error-message-align":"right"},{default:v(()=>[D(be,{"risk-info":y.value,"origin-data":e(u).riskData,"pick-factor":r},null,8,["risk-info","origin-data"])]),_:1},512)])):E("",!0),e(u).riskPlanData.length?(f(),h("div",gt,[D(V,{ref_key:"riskFormRef",ref:I,"input-align":"right","error-message-align":"right"},{default:v(()=>[D(A,{modelValue:e(u).currentPlan,"onUpdate:modelValue":c[0]||(c[0]=B=>e(u).currentPlan=B)},{default:v(()=>[(f(!0),h(M,null,j(e(u).riskPlanData,B=>(f(),b(g,{key:B.planCode,name:B.planCode,title:B.planName},{default:v(()=>[D(be,{"risk-info":y.value,"origin-data":B.riskDetailVOList,"pick-factor":r},null,8,["risk-info","origin-data"])]),_:2},1032,["name","title"]))),128))]),_:1},8,["modelValue"])]),_:1},512)])):E("",!0)]),O("div",bt,[O("span",Et,Y(e(u).trialResult.premium),1),e(u).canTrial?(f(),b(k,{key:0,type:"primary",onClick:i},{default:v(()=>[Lt]),_:1})):(f(),b(k,{key:1,type:"primary",onClick:i},{default:v(()=>[Ft]),_:1}))])]}),_:1})}}});var Rt=W(Ct,[["__scopeId","data-v-ca9a3e7e"]]);export{Rt as default};
