import{k as a,O as e,r as s,A as t,aa as l,b as o,p as r,s as i,t as d,v as n,S as u,E as p,U as c,C as m,B as v,I as h,M as f,H as y,y as g,G as b,D as k,T as P}from"./vendor-8df8a31f.js";import{_ as x,a1 as _}from"./index-0ba4cb7d.js";import{Z as C,e as j}from"./empty-3fb34041.js";import{P as I}from"./index-373bda3d.js";import{d as V,h as L}from"./proposalList-a3adcf92.js";import{a as U,b as w,t as N}from"./format-12461bbc.js";const S={class:"proposal-content"},q={class:"title"},O={class:"premium"},T=b(" 保费："),z={class:"operate-btn"},A=b("删除"),B=b("编辑"),D=b("预览");var E=x(a({setup(a){const b=[{title:"险种名称",dataIndex:"riskName",width:180},{title:"保障期间",dataIndex:"coveragePeriod",render:a=>U(null==a?void 0:a.coveragePeriod)},{title:"缴费期间",dataIndex:"chargePeriod",width:110,render:a=>w(null==a?void 0:a.chargePeriod)},{title:"保费",dataIndex:"premium",width:120,render:a=>N(null==a?void 0:a.premium)}],x=e({historyList:[],searchValue:""}),E=s(!1),G=s(!1),H=s(1),{historyList:M,searchValue:R}=t(x),W=l(),Z=()=>{L({name:R.value,pageNum:H.value,pageSize:20,relationUserType:2}).then((a=>{const{code:e,data:s}=a;"10000"===e&&(1===H.value?M.value=s.datas||[]:M.value=M.value.concat(s.datas),H.value+=1,E.value=!1,G.value=M.value.length>=s.total)}))},F=()=>{Z()},J=o((()=>M.value.length>0)),K=a=>{R.value=a,H.value=1,Z()};return(a,e)=>{const s=r("van-search"),t=r("van-button"),l=r("van-list"),o=r("ProPageWrap");return i(),d(o,{class:"page-history-proposal"},{default:n((()=>[u(s,{modelValue:p(R),"onUpdate:modelValue":e[0]||(e[0]=a=>c(R)?R.value=a:null),placeholder:"请输入被保人姓名/计划书名称",shape:"round",class:"search",onSearch:K},null,8,["modelValue"]),m("div",S,[u(l,{loading:E.value,"onUpdate:loading":e[1]||(e[1]=a=>E.value=a),finished:G.value,"finished-text":p(J)?"- 没有更多了 -":"",onLoad:F},{default:n((()=>[(i(!0),v(y,null,h(p(M),(a=>(i(),v("div",{key:a.id,class:"proposal-item"},[m("div",q,f(a.proposalName)+"计划书",1),m("p",O,[T,m("span",null,"¥"+f(p(_)(a.totalPremium)),1)]),u(I,{columns:b,class:"table","data-source":a.proposalProductRiskVOList},null,8,["data-source"]),m("div",z,[u(t,{plain:"",round:"",type:"primary",class:"del-btn",onClick:e=>{return s=a.id,void k.confirm({message:"是否确定删除计划书？"}).then((()=>{V(s).then((a=>{const{code:e}=a;"10000"===e&&(P.success("删除成功"),H.value=1,Z())}))})).catch((()=>{}));var s}},{default:n((()=>[A])),_:2},1032,["onClick"]),u(t,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void W.push({path:"/proposal/createProposal",query:{id:s}});var s}},{default:n((()=>[B])),_:2},1032,["onClick"]),u(t,{plain:"",round:"",type:"primary",onClick:e=>{return s=a.id,void W.push({path:"compositionProposal",query:{id:s}});var s}},{default:n((()=>[D])),_:2},1032,["onClick"])])])))),128))])),_:1},8,["loading","finished","finished-text"])]),p(J)?g("",!0):(i(),d(C,{key:0,"empty-img":p(j),title:"暂无历史计划书","empty-class":"empty-select"},null,8,["empty-img"]))])),_:1})}}}),[["__scopeId","data-v-36b7a1a3"]]);export{E as default};
