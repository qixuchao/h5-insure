import{g as C,a0 as b,Q as w,L as G,C as f,M as q,d as m,m as L,n as l,j as u,y as t,h as P,s as N,F as $,aa as A,T as p,r as I,k as h,ah as R,z as E,I as U,a2 as V,a3 as j,B as _,D as M}from"./vendor-e9263418.js";import{s as y,b as W,_ as Z,r as z}from"./target-1dc74256.js";import{a as T,r as D,c as J}from"./detailList-ff721244.js";import{u as O,S as Q}from"./index-b8742a0a.js";import{T as Y,D as H}from"./Divided-522e7e8e.js";import{_ as K}from"./plugin-vue_export-helper-46f75680.js";const B=c=>(V("data-v-3aff3073"),c=c(),j(),c),X={class:"top"},aa=B(()=>t("div",{class:"head-div"},null,-1)),ea=["src"],ta=_(" \u6062\u590D\u9ED8\u8BA4\u76EE\u6807 "),sa={class:"bottom"},oa=B(()=>t("div",{class:"head-div"},null,-1)),la={class:"target-explain"},ua={class:"target-detail-footer"},ra={class:"btn-out"},na=_("\u8BBE\u7F6E\u76EE\u6807\u503C"),ia=_("\u4FDD\u5B58\u4E3A\u6211\u7684\u76EE\u6807"),ca=C({setup(c){const{getIconUrl:F}=O(),v=b(),s=w(),g=new Q({source:"localStorage"}),d=G([]),o=f([]),a=f({}),x=()=>{M.confirm({theme:"round-button",message:"\u786E\u5B9A\u8981\u6062\u590D\u76EE\u6807\u9ED8\u8BA4\u503C\u5417\uFF1F"}).then(async()=>{await z({agencyId:a.value.agencyId,tplGoalId:a.value.tplGoalId,goalId:a.value.goalId});const e=await y({goalId:s.query.goalId,tplGoalId:s.query.tplGoalId,effectiveTime:`${m().format("YYYY")}-01-01 00:00:00`,expriyTime:`${m().format("YYYY")}-12-31 23:59:59`});a.value=e.data.data;const{detailList:r,goalPeriods:n}=e.data.data;d.splice(0),d.push({title:"\u76EE\u6807\u9879",dataIndex:"code"},...T(r)),o.value=D(r),p("\u6062\u590D\u6210\u529F")}).catch(()=>{})},k=()=>{v.push({name:"SetTarget",params:{info:JSON.stringify(A(o.value)),name:a.value.name}})},S=()=>{W({channelId:a.value.channelId,goalId:s.query.goalId,tplGoalId:a.value.tplGoalId,name:a.value.name,effectiveTime:a.value.effectiveTime,expriyTime:a.value.expriyTime,goalPeriods:a.value.goalPeriods,goalItems:a.value.goalItems,remark:a.value.remark,detailList:J(o.value,a.value.goalPeriods.split("\uFF0C")),dml:s.query.setting==="true"?"U":"I"}).then(e=>{console.log(e.data.status),e.data.status!==200?p("\u4FDD\u5B58\u5931\u8D25"):(p("\u4FDD\u5B58\u6210\u529F"),v.back())})};return q(async()=>{const e=g.get("targetInfoData");g.remove("targetInfoData");const{setting:r}=s.query,n=await y({goalId:r==="true"?s.query.goalId:"",tplGoalId:s.query.tplGoalId,effectiveTime:`${m().format("YYYY")}-01-01 00:00:00`,expriyTime:`${m().format("YYYY")}-12-31 23:59:59`});a.value=n.data.data;const{detailList:i,goalPeriods:da}=n.data.data;d.push({title:"\u76EE\u6807\u9879",dataIndex:"code"},...T(i)),e?o.value=e:o.value=D(i)}),(e,r)=>{const n=I("ZaPageWrap"),i=I("van-button");return h(),L($,null,[l(n,{"main-class":"page-targetDetail"},{default:u(()=>[t("div",X,[l(Y,{title:a.value.name,"title-class":"aaa"},R({head:u(()=>[aa]),_:2},[a.value.goalId&&a.value.allowUpdate==="Y"?{name:"tail",fn:u(()=>[t("div",{class:"title-tail",onClick:x},[t("img",{src:E(F)("target.refreshIcon"),alt:""},null,8,ea),ta])])}:void 0]),1032,["title"]),l(Z,{columns:E(d),"data-source":o.value},null,8,["columns","data-source"])]),l(H),t("div",sa,[l(Y,{title:"\u76EE\u6807\u8BF4\u660E","title-class":"aaa"},{head:u(()=>[oa]),_:1}),t("div",la,U(a.value.remark||"\u6682\u65E0\u76EE\u6807\u8BF4\u660E"),1)])]),_:1}),t("div",ua,[t("div",ra,[a.value.allowUpdate==="Y"?(h(),P(i,{key:0,round:"",plain:"",type:"primary",color:"#EF4034",class:"btn-left",onClick:k},{default:u(()=>[na]),_:1})):N("",!0),l(i,{round:"",type:"primary",class:"btn-right",onClick:S},{default:u(()=>[ia]),_:1})])])],64)}}});var Ia=K(ca,[["__scopeId","data-v-3aff3073"]]);export{Ia as default};
