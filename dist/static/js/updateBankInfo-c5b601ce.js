import{_ as e,d as a,i as t,h as s,j as o,aG as n,o as r,c as d,u as i,m as l,p as u,f as c,a as p,b as m,w as f,a8 as v,aM as y,a9 as I,cH as h,bw as b,ai as g,cr as j,cs as _,ct as P}from"./index-4f878428.js";import{_ as x}from"./PayInfo-be2a2267.js";import{u as C}from"./useOrder-788a898d.js";import{p as N}from"./utils-179d7562.js";import{g as k,m as w}from"./trial-76e92b21.js";import{n as A}from"./nextStep-8c344496.js";import{B as O,a as $}from"./constants-4b08cf92.js";import"./PolicyInfo-ef327f17.js";import"./utils-0d37680d.js";import"./infoCollection-27c16b65.js";import"./trial-34347d78.js";import"./core-66734bfb.js";const B={class:"bank-info-wrap"},E={class:"footer-button"},G=a({name:"updateBankInfo"});var L=e(a({...G,setup(e){const a=t(),G=s(),{orderNo:L,isShare:U,tenantId:D,nextPageCode:S}=a.query,T=C(),M=o({schema:[],config:[],formData:[]}),V=o(!!U),q=o(),F=o(),R=()=>{G.back()},H=()=>{q.value&&q.value.validate(!1).then((e=>{e&&(T.value.tenantOrderPayInfoList=F,U?(T.value.extInfo.buttonCode=O.UPDATE_BANK_INFO_HOLDER,A(T.value,((e,t)=>{t===y.JUMP_PAGE&&I(e.nextPageCode,a.query)}),a)):(T.value.extInfo.buttonCode=O.UPDATE_BANK_INFO_AGENT,A(T.value,((e,a)=>{a===y.JUMP_PAGE&&((e,a)=>{const{holder:t,insured:s}=T.value;let o={name:t.name,gender:`${j[t.gender]}士`};"insured"===e&&(o={name:null==s?void 0:s[0].name,gender:`${j[null==s?void 0:s[0].gender]}士`}),_({shareType:0,title:`${P[a].title}`,desc:P[a].desc.replace("{name}",`${o.name}${o.gender},`),url:`${window.location.href}&objectType=${e}&isShare=1&nextPageCode=updateBankInfo`.replace("/updateBankInfo","/phoneVerify"),imageUrl:"https://aquarius-v100-test.oss-cn-hangzhou.aliyuncs.com/MyPicture/asdad.png"})})("holder","pay")}),a)))}))};return n((()=>{(async()=>{let e={};h({orderNo:L,tenantId:D}).then((({code:e,data:a})=>{"10000"===e&&(F.value=a.tenantOrderPayInfoList)}));const{code:a,data:t}=await k({orderNo:L,tenantId:D});"10000"===a&&(Object.assign(T.value,t,{extInfo:{...t.extInfo,buttonCode:O.SIGN,pageCode:$.SIGN}}),e=N(t.insuredList[0].productList)),w(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:t}=e,{payInfo:s}=b(t);M.value={...M.value,...s}}}))})()})),(e,a)=>{const t=g;return r(),d("div",B,[i(M).schema.length&&i(F)?(r(),l(x,{key:0,ref_key:"payInfoRef",ref:q,modelValue:i(F),"onUpdate:modelValue":a[0]||(a[0]=e=>u(F)?F.value=e:null),schema:i(M).schema,"is-view":i(V),"user-data":i(T)},null,8,["modelValue","schema","is-view","user-data"])):c("",!0),p("div",E,[m(t,{type:"primary",plain:"",onClick:R},{default:f((()=>[v("取消")])),_:1}),m(t,{type:"primary",onClick:H},{default:f((()=>[v("确认")])),_:1})])])}}}),[["__scopeId","data-v-61e78bea"]]);export{L as default};
