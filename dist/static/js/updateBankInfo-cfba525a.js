import{_ as e,d as a,j as s,i as t,h as o,cd as n,bc as i,l,o as r,c as d,u as c,p as u,q as p,f as m,a as f,b as v,w as y,v as g,e as b,c3 as I,d5 as h,ba as j,bk as w,d6 as P,aY as _,bb as N,bN as k,b3 as C,bo as x,bp as O,cF as T,cI as $,cH as L,c4 as V}from"./index-ce7a290e.js";import{P as A}from"./PolicyInfo-2232742a.js";import{u as B}from"./useOrder-5f7ec629.js";import{p as E}from"./utils-a1ae3989.js";import{g as U,m as q}from"./trial-a0c05bd8.js";import{n as D}from"./nextStep-0a06bb8f.js";import{_ as G}from"./MessagePopup-ed5fa33c.js";import{q as S}from"./qianming-ece13dd4.js";import{i as F}from"./core-2f106181.js";import"./cloneDeep-f47385c4.js";import"./utils-740a92ac.js";import"./createProposal-8cd6cbd5.js";import"./trial-9ea40275.js";import"./utils-1a3a1064.js";import"./infoCollection-faf37129.js";const M=e=>(x("data-v-54e0d05e"),e=e(),O(),e),z={class:"bank-info-wrap"},R={class:"footer-button"},H={class:"content-inner"},J=["src"],K=M((()=>f("h4",null,"提交成功",-1))),W=M((()=>f("p",null,"您的变更已成功提交，详情结果请在我的订单中查看",-1))),Y=a({name:"updateBankInfo"});var Q=e(a({...Y,setup(e){const a=s(!1),x=t(),O=o(),{orderNo:M,isShare:Y,tenantId:Q,nextPageCode:X}=x.query,Z=B(),ee=s({schema:[],config:[],formData:[]}),ae=s(!!Y),se=s(),te=s(),[oe,ne]=n(),ie=()=>{O.back()},le=()=>{F?I.closeWindow():window.close(),h()},re=()=>{se.value&&se.value.validate(!1).then((e=>{e&&(a.value=!0,Z.value.tenantOrderPayInfoList=te,Y?(Z.value.extInfo.buttonCode=j.UPDATE_BANK_INFO_HOLDER,D(Z.value,((e,a)=>{a===w.JUMP_PAGE&&(ne(!0),setTimeout((()=>{le()}),1500))}),x).finally((()=>{a.value=!1}))):(Z.value.extInfo.buttonCode=j.UPDATE_BANK_INFO_AGENT,D(Z.value,((e,a)=>{a===w.JUMP_PAGE&&(ne(!0),((e,a)=>{var s;const{holder:t,insuredList:o}=Z.value;let n={name:t.name,gender:`${T[t.gender]}士`};"insured"===e&&(n={name:null==o?void 0:o[0].name,gender:`${T[null==o?void 0:o[0].gender]}士`});const i={...x.query,objectType:e,isShare:1,nextPageCode:"updateBankInfo"};$({shareType:0,title:`${L[a].title}`,desc:L[a].desc.replace("{name}",`${n.name}${n.gender}`),url:`${null==(s=window.location.href.split("?"))?void 0:s[0]}?${V.stringify(i)}`.replace("/updateBankInfo","/phoneVerify"),imageUrl:"https://aquarius-v100-test.oss-cn-hangzhou.aliyuncs.com/MyPicture/asdad.png"})})("holder","pay"))}),x).finally((()=>{a.value=!1}))))}))};i((()=>{(async()=>{let e={};P({orderNo:M,tenantId:Q}).then((({code:e,data:a})=>{if("10000"===e){te.value=a.tenantOrderPayInfoList;const e=[];a.tenantOrderPayInfoList.forEach(((a,s)=>{`${a.paymentType}`==`${_.NO}`&&(e[s]={paymentType:{isView:!0}})})),ee.value.config=e}}));const{code:a,data:s}=await U({orderNo:M,tenantId:Q});"10000"===a&&(Object.assign(Z.value,s,{extInfo:{...s.extInfo,buttonCode:j.SIGN,pageCode:N.SIGN}}),e=E(s.insuredList[0].productList)),q(e).then((({data:e,code:a})=>{if("10000"===a){const{productDetailResList:a,productFactor:s}=e,{payInfo:t}=k(s);ee.value={...ee.value,...t}}}))})()}));const de=s();return l((()=>{setTimeout((async()=>{de.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,s)=>{const t=C;return r(),d("div",z,[c(ee).schema.length&&c(te)?(r(),u(A,{key:0,ref_key:"payInfoRef",ref:se,modelValue:c(te),"onUpdate:modelValue":s[0]||(s[0]=e=>p(te)?te.value=e:null),schema:c(ee).schema,config:c(ee).config,"is-view":c(ae),"user-data":c(Z)},null,8,["modelValue","schema","config","is-view","user-data"])):m("",!0),f("div",R,[v(t,{type:"primary",plain:"",onClick:ie},{default:y((()=>[g("取消")])),_:1}),v(t,{disabled:c(a),type:"primary",onClick:re},{default:y((()=>[g(b(c(Y)?"确认":"分享给客户确认"),1)])),_:1},8,["disabled"])]),v(G,{modelValue:c(oe),"onUpdate:modelValue":s[1]||(s[1]=e=>p(oe)?oe.value=e:null),onClose:le},{default:y((()=>[f("div",H,[f("img",{src:c(S),alt:"",class:"header-img"},null,8,J),K,W])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-54e0d05e"]]);export{Q as default};
