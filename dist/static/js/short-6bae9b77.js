import{_ as e,d as t,aY as a,r as n,a7 as l,x as r,G as u,aR as i,b as o,q as s,c as d,g as c,i as v,F as p,l as m,h as f,B as O,t as I,j as y,e as P,n as h,f as L,I as C,Q as V,w as g,s as _,K as b,L as x,aZ as S,b0 as k,aJ as T,b5 as H,a8 as w,u as E,a as N,a_ as F,a$ as j,an as q,a2 as D,y as R,aP as A,aK as B,T as U,a4 as M}from"./index-6a34609b.js";import{d as z}from"./debounce-acadfd72.js";import{i as $,b as G,p as Q,g as W}from"./trial-2be178ef.js";import{p as J}from"./product-5a7197ac.js";import{n as K}from"./nextStep-6ca1c012.js";import{C as Y,S as Z,R as X,O as ee,m as te}from"./infoCollection-a2cc3706.js";import{k as ae,j as ne}from"./trial-1f83dd78.js";import{u as le}from"./core-9c1e25e6.js";import{u as re,B as ue,P as ie}from"./index-c93fb87a.js";import{u as oe}from"./theme-40e4e415.js";import{o as se,g as de,v as ce,r as ve,t as pe}from"./utils-a24353e4.js";import{v as me}from"./validator-5a13dc82.js";import{s as fe,c as Oe}from"./phoneVerify-122b2dd5.js";import{s as Ie}from"./useStorage-da385c53.js";import"./pdfdist-5d72820d.js";import"./index-1e43e8a7.js";import"./index-527e43f8.js";const ye={class:"guarantee-list"},Pe=(e=>(b("data-v-ac4580b0"),e=e(),x(),e))((()=>v("span",null,"保障计划",-1))),he={key:0,class:"picture-payment-content"},Le=["onClick"],Ce=["src"],Ve=["src"],ge={key:1,class:"plan-list"},_e=["onClick"],be={key:2,class:"feerate-view"},xe={key:0},Se={class:"extinfo-info-list"},ke={class:"guarantee-detail"},Te={class:"content"};var He=e(t({props:{dataSource:{type:Object,default:()=>{}},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:5},activePlanCode:{type:String,default:""},isMultiplePlan:{type:Boolean,default:!1},paymentFrequency:{type:String,default:""},premiumInfo:{type:Object,default:()=>{}}},emits:["update-active-plan"],setup(e,{emit:t}){var b;const x=e;a((e=>({"541c7141":Q.value})));const S=n(null==(b=x.dataSource)?void 0:b.planList),k=n(x.activePlanCode),T=n();l([()=>x.dataSource,()=>x.activePlanCode],(()=>{var e,t;x.isMultiplePlan&&(S.value=null==(e=x.dataSource)?void 0:e.planList,k.value=x.activePlanCode,T.value=null==(t=x.dataSource)?void 0:t.planList.findIndex((e=>e.planCode===k.value)))}),{immediate:!0});const H=n([]),w=n([]),E=n(),N=r((()=>x.isMultiplePlan?x.dataSource.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[]));l([()=>x.dataSource,()=>x.activePlanCode,()=>x.paymentFrequency,()=>k.value],(()=>{var e,t,a,n,l;if(x.isMultiplePlan){if(S.value&&S.value.length>0){let e=0;const t=S.value.findIndex((e=>e.planCode===k.value));t>-1&&(e=t),H.value=S.value[e].guaranteeItemVOS,w.value=S.value[e].extInfoVOList;const a=S.value[e].productPremiumVOList.find((e=>e.paymentFrequency===x.paymentFrequency));E.value=a||(null==(l=S.value[e])?void 0:l.productPremiumVOList[0])}}else{H.value=null==(e=x.dataSource)?void 0:e.planInsureVO.guaranteeItemVOS,w.value=null==(t=x.dataSource)?void 0:t.planInsureVO.extInfoVOList;const l=null==(a=x.dataSource)?void 0:a.planInsureVO.productPremiumVOList.find((e=>e.paymentFrequency===x.paymentFrequency));E.value=l||(null==(n=x.dataSource)?void 0:n.planInsureVO.productPremiumVOList[0])}}),{immediate:!0,deep:!0});const F=r((()=>{var e;return(null==(e=x.dataSource)?void 0:e.rateUri)||""})),j=r((()=>!!(E.value&&E.value.paymentFrequencyValue&&E.value.premiumUnit&&F))),[q,D]=u(!1),R=r((()=>{var e;return!(!H.value||!(null==(e=H.value)?void 0:e.length))&&(H.value.length>x.count&&(!!x.isShowClose||!q.value))})),A=()=>{D()},B=r((()=>{var e;return H.value&&(null==(e=H.value)?void 0:e.length)?H.value.length<=x.count||q.value?H.value:H.value.slice(0,x.count):[]})),U=e=>{var t;k.value=e,T.value=null==(t=x.dataSource)?void 0:t.planList.findIndex((e=>e.planCode===k.value))},M=n(!1),z=()=>{M.value=!0},$=()=>{se({fileType:"pdf",fileUri:F.value})},G=e=>{k.value=S.value[e.name].planCode},Q=n("");return l([()=>k.value,()=>M.value],(()=>{i((()=>{(()=>{var e,t;const a=((null==(e=document.querySelector(".guarantee-popup .extinfo-info-list"))?void 0:e.clientHeight)||0)+1,n=a+((null==(t=document.querySelector(".guarantee-popup .custom-plan-tab"))?void 0:t.clientHeight)||0)+(a?5:0);Q.value=`calc( 100% - ${n}px )`})()}))})),(t,a)=>{var n,l;const r=o("ProCell"),u=o("ProTab"),i=o("ProPopup"),b=s("dompurify-html");return d(),c(p,null,[v("div",ye,[v("div",{class:"header"},[Pe,v("span",{onClick:z},"查看详情")]),e.isMultiplePlan?(d(),c(p,{key:0},[m(N).length>0?(d(),c("div",he,[(d(!0),c(p,null,f(m(N),(e=>(d(),c("div",{key:e.planCode,class:O("picture-payment-item"),onClick:t=>U(e.planCode)},[k.value==e.planCode?(d(),c("img",{key:0,src:e.selectedPic},null,8,Ce)):(d(),c("img",{key:1,src:e.unSelectedPic},null,8,Ve))],8,Le)))),128))])):(d(),c("div",ge,[(d(!0),c(p,null,f(S.value,((e,t)=>(d(),c("div",{key:`${e.planCode}_${t}`,class:O("plan-list-item "+(e.planCode===k.value?"plan-list-item-active":"")),onClick:t=>U(e.planCode)},[v("span",null,I(e.planName),1)],10,_e)))),128))]))],64)):y("",!0),(d(!0),c(p,null,f(m(B),((e,t)=>(d(),P(r,{key:t,class:"guarantee-item",title:e.title,content:e.desc,border:!1},null,8,["title","content"])))),128)),m(R)?(d(),c("div",{key:1,class:"show-more",onClick:A},[h(I(m(q)?"收起":"查看更多")+" ",1),L(C,{name:"arrow-down-dobule",class:O(["icon",{showMore:m(q)}])},null,8,["class"])])):y("",!0),m(j)?(d(),c("div",be,[v("span",null,I(`${(null==(n=E.value)?void 0:n.paymentFrequencyValue)||""}${(null==(l=E.value)?void 0:l.premiumUnit)||""}`),1),m(F)?(d(),c("span",{key:0,onClick:$},"查看保费")):y("",!0)])):y("",!0)]),L(V),L(i,{show:M.value,"onUpdate:show":a[1]||(a[1]=e=>M.value=e),title:"保障详情",class:"guarantee-popup"},{default:g((()=>[w.value&&w.value.length>0?(d(),c("div",xe,[v("div",Se,[(d(!0),c(p,null,f(w.value,((e,t)=>(d(),P(r,{key:t,title:e.name,content:e.description,border:!1,size:"small"},null,8,["title","content"])))),128))]),L(V)])):y("",!0),e.isMultiplePlan?(d(),P(u,{key:1,active:T.value,"onUpdate:active":a[0]||(a[0]=e=>T.value=e),list:S.value.map(((e,t)=>({title:e.planName}))),class:"custom-plan-tab",onClickTab:G},null,8,["active","list"])):y("",!0),v("div",ke,[(d(!0),c(p,null,f(H.value,((e,t)=>(d(),c("div",{key:t,class:"guarantee-item"},[L(r,{title:e.title,content:e.desc,border:!1,size:"small"},null,8,["title","content"]),_(v("div",Te,null,512),[[b,e.content]])])))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-ac4580b0"]]);const we={class:"spec"},Ee={key:1,class:"spec"};var Ne=e(t({props:{isCheck:{type:Boolean,default:!1},url:{type:String,default:""},detail:{type:Object,default:()=>{}}},setup(e,{expose:t}){const a=e,l=S((()=>k((()=>import("./index-6a34609b.js").then((function(e){return e.bn}))),["static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),u=S((()=>k((()=>import("./index-a20b809b.js")),["static/js/index-a20b809b.js","static/css/index-f22f2764.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),i=S((()=>k((()=>import("./index-6a34609b.js").then((function(e){return e.bl}))),["static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),s=S((()=>k((()=>import("./index-e529c6d8.js")),["static/js/index-e529c6d8.js","static/css/index-7b3feb06.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),O=S((()=>k((()=>import("./index-14d5b06e.js")),["static/js/index-14d5b06e.js","static/css/index-bfbfdd15.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),I=n(),h=n([{title:"产品亮点",slotName:"tab1"},{title:"理赔说明",slotName:"tab2"},{title:"我要投保",slotName:"tab3"}]),C=r((()=>{var e,t,n,l;return(null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.spec)&&(null==(l=null==(n=a.detail)?void 0:n.tenantProductInsureVO)?void 0:l.spec.length)>0})),V=r((()=>{var e,t,n,l,r,u,i,o,s,d,c,v,p,m;const f=null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.settlementProcessVO.settlementProcessType;return!!(f===Y.WORD&&(null==(r=null==(l=null==(n=a.detail)?void 0:n.tenantProductInsureVO)?void 0:l.settlementProcessVO)?void 0:r.settlementProcessList)&&(null==(o=null==(i=null==(u=a.detail)?void 0:u.tenantProductInsureVO)?void 0:i.settlementProcessVO)?void 0:o.settlementProcessList.length)>0||f===Y.IMAGE&&(null==(c=null==(d=null==(s=a.detail)?void 0:s.tenantProductInsureVO)?void 0:d.settlementProcessVO)?void 0:c.settlementProcessPicList)&&(null==(m=null==(p=null==(v=a.detail)?void 0:v.tenantProductInsureVO)?void 0:p.settlementProcessVO)?void 0:m.settlementProcessPicList.length)>0)})),_=r((()=>{var e,t,n,l;return(null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.questionList)&&(null==(l=null==(n=a.detail)?void 0:n.tenantProductInsureVO)?void 0:l.questionList.length)>0})),b=r((()=>{let e=[...h.value];return C.value||(e=e.filter((e=>"tab1"!==e.slotName))),V.value||_.value||(e=e.filter((e=>"tab2"!==e.slotName))),e}));return t({handleClickTab:()=>{var e;return null==(e=I.value)?void 0:e.handleClickTab}}),(e,t)=>{const n=o("van-image"),r=o("ProSvg");return d(),P(m(l),{ref_key:"scrollRef",ref:I,class:"tabs",list:m(b),sticky:"",scrollspy:""},T({tab3:g((()=>[w(e.$slots,"form",{},void 0,!0)])),_:2},[m(C)?{name:"tab1",fn:g((()=>{var e,t;return[v("div",we,[(d(!0),c(p,null,f((null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.spec)||[],((e,t)=>(d(),P(H,{key:t},{fallback:g((()=>[L(r,{name:"img",style:{"font-size":"40px",margin:"10px auto",display:"block"}})])),default:g((()=>[(d(),P(n,{key:t,class:"detail-img",width:"100%",src:e},null,8,["src"]))])),_:2},1024)))),128)),L(m(i))])]}))}:void 0,m(V)||m(_)?{name:"tab2",fn:g((()=>{var e,t;return[m(V)?(d(),c(p,{key:0},[(null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.settlementProcessVO.settlementProcessType)===m(Y).WORD?(d(),P(m(s),{key:0,title:"理赔说明"},{default:g((()=>{var e,t,n;return[L(m(u),{list:null==(n=null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.settlementProcessVO)?void 0:n.settlementProcessList},null,8,["list"])]})),_:1})):(d(),c("div",Ee,[(d(),P(H,null,{fallback:g((()=>[L(r,{name:"img",style:{"font-size":"40px",margin:"10px auto",display:"block"}})])),default:g((()=>{var e,t,l;return[(d(!0),c(p,null,f((null==(l=null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.settlementProcessVO)?void 0:l.settlementProcessPicList)||[],((e,t)=>(d(),P(n,{key:t,width:"100%",src:e,class:"detail-img"},null,8,["src"])))),128))]})),_:1}))])),L(m(i))],64)):y("",!0),m(_)?(d(),c(p,{key:1},[L(m(s),{title:"常见问题"},{default:g((()=>{var e,t;return[L(m(O),{list:null==(t=null==(e=a.detail)?void 0:e.tenantProductInsureVO)?void 0:t.questionList},null,8,["list"])]})),_:1}),L(m(i))],64)):y("",!0)]}))}:void 0]),1032,["list"])}}}),[["__scopeId","data-v-717e916d"]]);const Fe=e=>(b("data-v-4f898a32"),e=e(),x(),e),je={class:"page-internet-product-detail"},qe={class:"info"},De={class:"custom-page-form"},Re=Fe((()=>v("div",{class:"form-title"},"请填写投保信息",-1))),Ae={key:2,class:"footer-area"},Be={class:"price"},Ue={key:0},Me=h(I("立即投保")),ze=Fe((()=>v("div",{id:"xinaoDialog"},null,-1)));var $e=e(t({setup(e){var t,a;const u=S((()=>k((()=>import("./index-dcdf8e1c.js")),["static/js/index-dcdf8e1c.js","static/css/index-ea588f10.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js","static/js/theme-40e4e415.js","static/js/index-527e43f8.js","static/css/index-2dbcd337.css","static/js/utils-a24353e4.js","static/js/infoCollection-a2cc3706.js","static/js/useStorage-da385c53.js","static/js/trial-1f83dd78.js"]))),s=S((()=>k((()=>import("./index-0c84c70b.js")),["static/js/index-0c84c70b.js","static/css/index-ea7db681.css","static/js/infoCollection-a2cc3706.js","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js","static/js/useDicData-c8a3ea4e.js","static/js/trial-1f83dd78.js","static/js/utils-a24353e4.js","static/js/useStorage-da385c53.js"]))),f=S((()=>k((()=>import("./index-527e43f8.js")),["static/js/index-527e43f8.js","static/css/index-2dbcd337.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),O=S((()=>k((()=>import("./index-fb11bc79.js")),["static/js/index-fb11bc79.js","static/css/index-6733e696.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js","static/js/infoCollection-a2cc3706.js","static/js/relativeTime-db269b7c.js","static/js/validator-5a13dc82.js","static/js/useDicData-c8a3ea4e.js"]))),h=S((()=>k((()=>import("./index-55c1ca7f.js")),["static/js/index-55c1ca7f.js","static/css/index-16e82e4a.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),C=S((()=>k((()=>import("./index-aee6af64.js")),["static/js/index-aee6af64.js","static/css/index-607986ff.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),V=S((()=>k((()=>import("./index-914dfe20.js")),["static/js/index-914dfe20.js","static/css/index-b9ba3011.css","static/js/index-6a34609b.js","static/css/index-76f73643.css","static/js/pdfdist-5d72820d.js"]))),_=oe();E();const b=N(),{productCode:x="",tenantId:H,agentCode:w="",agencyCode:Y,saleChannelId:se,extraInfo:ye,insurerCode:Pe,preview:he}=b.query;let Le={};try{Le=JSON.parse(decodeURIComponent(ye))}catch(bt){}const{openId:Ce}=Le,Ve=n(),ge=n(),_e=n(),be=n(!1),xe=n(),Se=n(),ke=n(!1),Te=n(!1),we=n(0),Ee=n(!1),Fe=n({}),$e=n({}),Ge=n(!0),Qe=n(!0),We=n(""),Je=n(),Ke=n(),Ye=n(""),Ze=n(""),Xe=n("");Ce&&re({openId:Ce},(e=>{$e.value=e}));const et="jumpToPage",tt=n({tenantId:H,agencyId:Y,agentCode:w,orderCategory:1,saleChannelId:se,venderCode:Pe,productCode:x,insuranceStartDate:null,insuranceEndDate:null,activePlanCode:"",paymentFrequency:"",premium:0,insurancePeriodValue:ae.YEAR_1,commencementTime:"",tenantOrderHolder:{extInfo:{hasSocialInsurance:Z.HAS}},tenantOrderInsuredList:[{dontFetchDefaultInfo:!1,relationToHolder:X.SELF,extInfo:{hasSocialInsurance:Z.HAS},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{tenantId:H,productCode:(null==(t=xe.value)?void 0:t.productCode)||"",planCode:"",productName:(null==(a=xe.value)?void 0:a.productName)||"",premium:Je.value||0,tenantOrderRiskList:[]}]}],extInfo:{buttonCode:"EVENT_SHORT_saveOrder",pageCode:"productInfo",extraInfo:Le,templateId:(null==Le?void 0:Le.templateId)||"1",iseeBizNo:""},operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),at=r((()=>!!he)),nt=r((()=>{var e,t,a,n,l,r;return!!xe.value&&!!((null==(t=null==(e=xe.value)?void 0:e.tenantProductInsureVO)?void 0:t.planList)&&Array.isArray(null==(n=null==(a=xe.value)?void 0:a.tenantProductInsureVO)?void 0:n.planList)&&(null==(r=null==(l=xe.value)?void 0:l.tenantProductInsureVO)?void 0:r.planList.length)>0)})),lt=r((()=>{if($e.value){const e=[];return Object.keys($e.value).forEach((t=>{e.push(...$e.value[t])})),e}return[]})),rt=r((()=>lt.value.length>0)),ut=r((()=>{var e,t,a;let n={};if((null==(e=Se.value)?void 0:e.productFactor)?n=null==(t=Se.value)?void 0:t.productFactor:tt.value.activePlanCode&&(n=(null==(a=Se.value)?void 0:a.planFactor[tt.value.activePlanCode])||{}),rt.value&&n[1]){const e=n[1].findIndex((e=>"verificationCode"===e.code&&1===e.isDisplay));e>-1&&(n[1][e].isDisplay=2)}return n})),it=r((()=>{if(ut.value[1]){if(ut.value[1].findIndex((e=>"verificationCode"===e.code&&1===e.isDisplay))>-1)return!0}return!1}));l((()=>nt.value),(()=>{var e,t;nt.value&&(tt.value.activePlanCode=tt.value.activePlanCode?tt.value.activePlanCode:null==(t=null==(e=xe.value)?void 0:e.tenantProductInsureVO)?void 0:t.planList[0].planCode)}),{immediate:!0});const ot=r((()=>{var e,t,a;return nt.value?(null==(t=null==(e=Se.value)?void 0:e.productRelationPlanVOList.find((e=>e.planCode===tt.value.activePlanCode)))?void 0:t.productRiskVoList)||[]:(null==(a=Se.value)?void 0:a.productRiskVoList)||[]})),st=r((()=>{var e;if(!xe.value)return{};if(nt.value){const t=null==(e=xe.value)?void 0:e.tenantProductInsureVO.planList.find((e=>e.planCode===tt.value.activePlanCode));return t||{}}return xe.value.tenantProductInsureVO.planInsureVO})),dt=e=>{tt.value.activePlanCode=e},ct=r((()=>{var e,t,a;if((null==(e=Se.value)?void 0:e.productQuestionnaireVOList)&&(null==(t=Se.value)?void 0:t.productQuestionnaireVOList.length)>0){const e=null==(a=Se.value)?void 0:a.productQuestionnaireVOList[0];if(e){const{basicInfo:{questionnaireType:t},questions:a}=e.questionnaireDetailResponseVO||{};return"2"===String(t)?[{attachmentName:null==e?void 0:e.questionnaireName,attachmentUri:a,attachmentType:"question"}]:[{attachmentName:null==e?void 0:e.questionnaireName,attachmentUri:a[0].content,attachmentType:de(String(a[0].textType),a[0].content)}]}}return[]})),vt=n();l([()=>nt.value,()=>tt.value.activePlanCode,()=>xe.value],(()=>{var e,t;let a=null;if(nt.value&&xe.value){const t=null==(e=xe.value)?void 0:e.tenantProductInsureVO.planList.find((e=>e.planCode===(tt.value.activePlanCode||"")));t&&(a=null==t?void 0:t.attachmentVOList)}else xe.value&&(a=null==(t=xe.value)?void 0:t.tenantProductInsureVO.planInsureVO.attachmentVOList);vt.value=a?Object.keys(a).map((e=>(a[e].forEach((e=>{e.attachmentType=de(String(e.attachmentType),e.attachmentUri)})),{attachmentName:e,attachmentList:a[e]}))):[]}),{immediate:!0});const pt=async({mobile:e,type:t},a)=>{var n;if(Ve.value){if(at.value)return void(null==a||a());null==(n=Ve.value)||n.validateForm(`${t}_mobile`).then((async()=>{const t=await fe(e),{code:n,data:l}=t;"10000"===n&&(null==a||a())}))}},mt=()=>{ge.value.handleClickTab()("tab3")},ft=e=>{Qe.value=!1,Object.assign(tt.value.tenantOrderHolder,e),i((()=>{Qe.value=!0}))},Ot=e=>{Qe.value=!1,Object.assign(tt.value.tenantOrderInsuredList[0],e),i((()=>{Qe.value=!0}))},It=e=>{we.value=e,Te.value=!0},yt=async()=>{try{await K(((e={},t={},a={})=>{var n;const l={...a},r={tenantId:H,riskList:(null==(n=l.tenantOrderInsuredList[0])?void 0:n.tenantOrderProductList[0].riskVOList)||[],riskPremium:t,productId:null==e?void 0:e.productBasicInfoVO.id};return l.extInfo.iseeBizNo=We.value,l.productCode=e.productBasicInfoVO.productCode,l.commencementTime=l.insuranceStartDate,l.expiryDate=l.insuranceEndDate,l.paymentFrequency=l.paymentFrequency||te.SINGLE,l.tenantOrderHolder={...l.tenantOrderHolder,socialFlag:l.tenantOrderHolder.extInfo.hasSocialInsurance||Z.HAS,certType:l.tenantOrderHolder.certType||D.CERT,extInfo:{...l.tenantOrderHolder.extInfo,hasSocialInsurance:l.tenantOrderHolder.extInfo.hasSocialInsurance||Z.HAS}},l.tenantOrderInsuredList=l.tenantOrderInsuredList.map((e=>({...e,certType:e.certType||D.CERT,socialFlag:e.socialFlag||Z.HAS,planCode:tt.value.activePlanCode?tt.value.activePlanCode:null}))),l.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:Je.value,productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,planCode:tt.value.activePlanCode?tt.value.activePlanCode:null,tenantOrderRiskList:pe(r)},l})(Se.value,Fe.value,tt.value),(async(e,t)=>{t===et&&(null==e?void 0:e.orderNo)&&await(async e=>{try{const{code:t,data:a}=await W({orderNo:e,tenantId:H});"10000"===t&&(a.extInfo={...a.extInfo,buttonCode:"EVENT_SHORT_underWrite"},await K(a))}catch(bt){}})(null==e?void 0:e.orderNo)}))}catch(bt){}},Pt=async(e,t,a,n=!0)=>{var l;try{Xe.value="保费试算中...";const r=ve(a).map((t=>({...t,paymentFrequency:e.paymentFrequency||te.SINGLE,insurancePeriodValue:e.insurancePeriodValue,coveragePeriod:e.insurancePeriodValue}))),u={tenantId:H,productCode:null==(l=xe.value)?void 0:l.productCode,insuranceStartDate:e.insuranceStartDate,insuranceEndDate:e.insuranceEndDate,commencementTime:e.insuranceStartDate,expiryDate:e.insuranceEndDate,paymentFrequency:e.paymentFrequency||te.SINGLE,holder:{personVO:{...e.tenantOrderHolder,socialFlag:e.tenantOrderHolder.extInfo.hasSocialInsurance||Z.HAS,certType:e.tenantOrderHolder.certType||D.CERT,extInfo:{...e.tenantOrderHolder.extInfo,hasSocialInsurance:e.tenantOrderHolder.extInfo.hasSocialInsurance||Z.HAS}}},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",relationToHolder:e.relationToHolder,personVO:{...e,socialFlag:e.extInfo.hasSocialInsurance||Z.HAS,certType:e.certType||D.CERT,extInfo:{...e.extInfo,hasSocialInsurance:e.extInfo.hasSocialInsurance||Z.HAS}},productPlanVOList:[{insurerCode:t.productBasicInfoVO.insurerCode,planCode:tt.value.activePlanCode?tt.value.activePlanCode:null,riskVOList:r}]})))},{code:i,message:o}=await G(u);if("10000"===i){const{code:e,data:t}=await Q(u);if("10000"===e){if(Xe.value="",tt.value.tenantOrderInsuredList[0].tenantOrderProductList=u.insuredVOList[0].productPlanVOList,Je.value=null==t?void 0:t.premium,tt.value.premium=t.premium,tt.value.orderAmount=t.premium,tt.value.orderRealAmount=t.premium,!n){const e={};t.riskPremiumDetailVOList&&t.riskPremiumDetailVOList.length&&t.riskPremiumDetailVOList.forEach((t=>{e[t.riskCode]={premium:t.premium,amount:t.amount}})),Fe.value=e,vt.value.length>0?(Ge.value=!1,It(0)):ct.value.length>0?ke.value=!0:await yt()}}else Xe.value=""}else Xe.value="",U(o)}catch(bt){Xe.value=""}},ht=async()=>{var e;try{ke.value=!1,Te.value=!1,Ve.value&&(null==(e=Ve.value)||e.validateForm().then((async()=>{var e;if(rt.value||!it.value)await Pt(tt.value,Se.value,ot.value,!1);else{const t=null==(e=tt.value.tenantOrderHolder)?void 0:e.verificationCode;if(!t||!ce(t))return void U({message:"请输入正确的验证码"});const{code:a,data:n}=await Oe(tt.value.tenantOrderHolder.mobile,t);"10000"===a&&await Pt(tt.value,Se.value,ot.value,!1)}})))}catch(t){}},Lt=e=>{"allFalse"===e?(ke.value=!1,yt()):M.confirm({className:"xinao-custom-dialog",title:"提示",teleport:"#xinaoDialog",message:"被保人不符合健康要求，很抱歉暂时无法投保该产品",confirmButtonText:"选错了",cancelButtonText:"为其他人投保"}).then((()=>{})).catch((()=>{ke.value=!1}))},Ct=()=>{Te.value=!1,ct.value.length<1?yt():ke.value=!0},Vt=()=>{ke.value=!1,Te.value=!1};l((()=>tt.value.tenantOrderInsuredList[0].relationToHolder),(()=>{i((()=>{tt.value.tenantOrderInsuredList[0]&&tt.value.tenantOrderInsuredList[0].extInfo&&!tt.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance&&(tt.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance=Z.HAS)}))}),{deep:!0,immediate:!0});const gt=()=>{const{name:e,birthday:t,gender:a,certType:n,extInfo:{hasSocialInsurance:l}}=tt.value.tenantOrderInsuredList[0];return!!(t&&a&&tt.value.paymentFrequency&&e&&me(e)&&l)},_t=()=>{if(gt()&&(Xe.value="保费试算中..."),st.value&&st.value.productPremiumVOList){const e=st.value.productPremiumVOList.find((e=>e.paymentFrequency===tt.value.paymentFrequency));e&&(Je.value=null,Ke.value=e.paymentFrequencyValue?Number(e.paymentFrequencyValue):null,Ye.value=e.premiumUnit,Ze.value=e.actualPremiumUnit)}};l([()=>st.value,()=>tt.value.activePlanCode,()=>tt.value.paymentFrequency],(()=>{_t()}),{deep:!0,immediate:!0}),l([()=>tt.value.tenantOrderInsuredList[0].birthday,()=>tt.value.tenantOrderInsuredList[0].name,()=>tt.value.tenantOrderInsuredList[0].gender,()=>tt.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance,()=>tt.value.activePlanCode,()=>tt.value.paymentFrequency,()=>tt.value.insurancePeriodValue],z((()=>{if(gt()){if(at.value)return;Pt(tt.value,Se.value,ot.value)}else _t()}),500)),l((()=>tt.value.tenantOrderInsuredList[0]),(e=>{if(F($e.value))return null;const t=$e.value[e.relationToHolder]||[];return 1===t.length&&(ne.SELF!==e.relationToHolder?tt.value.tenantOrderInsuredList[0].dontFetchDefaultInfo||(tt.value.tenantOrderInsuredList[0].dontFetchDefaultInfo=!0,tt.value.tenantOrderInsuredList[0].certNo=tt.value.tenantOrderInsuredList[0].certNo?tt.value.tenantOrderInsuredList[0].certNo:t[0].cert[0].certNo,tt.value.tenantOrderInsuredList[0].name=tt.value.tenantOrderInsuredList[0].name?tt.value.tenantOrderInsuredList[0].name:t[0].cert[0].certName,tt.value.tenantOrderInsuredList[0].mobile=tt.value.tenantOrderInsuredList[0].mobile?tt.value.tenantOrderInsuredList[0].mobile:t[0].contact[0].contactNo):tt.value.tenantOrderHolder.dontFetchDefaultInfo||(tt.value.tenantOrderHolder.dontFetchDefaultInfo=!0,tt.value.tenantOrderHolder.certNo=tt.value.tenantOrderHolder.certNo?tt.value.tenantOrderHolder.certNo:t[0].cert[0].certNo,tt.value.tenantOrderHolder.name=tt.value.tenantOrderHolder.name?tt.value.tenantOrderHolder.name:t[0].cert[0].certName,tt.value.tenantOrderHolder.mobile=tt.value.tenantOrderHolder.mobile?tt.value.tenantOrderHolder.mobile:t[0].contact[0].contactNo)),!1}),{immediate:!0,deep:!0});return i((()=>{j(_e,(([{isIntersecting:e}],t)=>{be.value=!e}))})),le(),q((()=>{var e;const t=Ie.get(ee);if(t){const{tenantOrderHolder:a,tenantOrderInsuredList:n}=t;if(a&&(tt.value.tenantOrderHolder={...a,certType:a.certType||D.CERT}),Array(n)&&n[0]){const t=n[0]||{};if(tt.value.activePlanCode=t.planCode,t.tenantOrderProductListtenantOrderProductList&&t.tenantOrderProductList[0]&&t.tenantOrderProductList[0].tenantOrderRiskList){const a=null==(e=t.tenantOrderProductList[0].tenantOrderRiskList)?void 0:e.find((e=>"1"===String(e.riskType)));a&&(tt.value.paymentFrequency=(null==a?void 0:a.paymentFrequency)?String(null==a?void 0:a.paymentFrequency):te.SINGLE)}}}})),R((()=>{(async()=>{await J({productCode:x,withInsureInfo:!0,tenantId:H}).then((e=>{var t,a;"10000"===e.code&&(xe.value={...e.data},document.title=(null==(a=null==(t=e.data)?void 0:t.tenantProductInsureVO)?void 0:a.productName)||"")})),await $({productCode:x}).then((e=>{"10000"===e.code&&(Ee.value=!0,Se.value=e.data)}))})(),setTimeout((async()=>{We.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),A((()=>{Ie.remove(ee)})),(e,t)=>{const a=o("van-config-provider"),n=o("HealthNoticePreview");return d(),c(p,null,[L(a,{"theme-vars":m(_)},{default:g((()=>{var e,a,n,l,r,u,i,o,b;return[v("div",je,[v("div",qe,[L(ue,{url:null==(a=null==(e=xe.value)?void 0:e.tenantProductInsureVO)?void 0:a.banner[0]},null,8,["url"]),(null==(l=null==(n=xe.value)?void 0:n.tenantProductInsureVO)?void 0:l.bannerMove)?(d(),P(ue,{key:0,url:null==(u=null==(r=xe.value)?void 0:r.tenantProductInsureVO)?void 0:u.bannerMove[0],onClick:mt},null,8,["url"])):y("",!0),v("div",{ref_key:"observeRef",ref:_e},null,512)]),L(He,{"show-service-config":"","data-source":null==(i=xe.value)?void 0:i.tenantProductInsureVO,"is-multiple-plan":m(nt),"active-plan-code":tt.value.activePlanCode,"payment-frequency":tt.value.paymentFrequency,"premium-info":{premium:Je.value,unit:Ye.value,premiumLoadingText:Xe.value},onUpdateActivePlan:dt},null,8,["data-source","is-multiple-plan","active-plan-code","payment-frequency","premium-info"]),L(Ne,{ref_key:"detailScrollRef",ref:ge,detail:xe.value},{form:g((()=>[v("div",De,[Re,L(m(O),{ref_key:"formRef",ref:Ve,"title-collection":{HOLDER:"本人信息（投保人）",INSURER:"为谁投保（被保人）"},"form-info":tt.value,"need-desensitize":Qe.value,"send-sms-code":pt,"factor-object":m(ut)||{}},T({_:2},[m(lt).length>1?{name:"holderName",fn:g((()=>[L(m(h),{"user-info":tt.value.tenantOrderHolder,data:m(lt),onChange:ft},null,8,["user-info","data"])]))}:void 0,m(lt).length>1?{name:"insurerName",fn:g((()=>[L(m(h),{title:"选择被保人","user-info":tt.value.tenantOrderInsuredList[0],data:m(lt),onChange:Ot},null,8,["user-info","data"])]))}:void 0]),1032,["form-info","need-desensitize","factor-object"])]),L(m(s),{"form-info":tt.value,"insure-detail":Se.value,"config-detail":xe.value,"is-multiple-plan":m(nt),"premium-info":{premium:Je.value,unit:Ye.value,minPremiun:Ke.value,actualUnit:Ze.value,premiumLoadingText:Xe.value},onUpdateActivePlan:dt},null,8,["form-info","insure-detail","config-detail","is-multiple-plan","premium-info"])])),_:1},8,["detail"]),(null==(o=xe.value)?void 0:o.tenantProductInsureVO.inscribedContent)?(d(),P(m(C),{key:0,"inscribed-content":null==(b=xe.value)?void 0:b.tenantProductInsureVO.inscribedContent},null,8,["inscribed-content"])):y("",!0),vt.value&&vt.value.length>0?(d(),P(m(V),{key:1,"attachement-list":vt.value,"pre-text":"请阅读",onPreviewFile:t[0]||(t[0]=e=>It(e))},null,8,["attachement-list"])):y("",!0),be.value?(d(),c("div",Ae,[v("div",Be,[Xe.value?(d(),c("span",Ue,I(Xe.value),1)):Je.value?(d(),c(p,{key:1},[v("span",null,I(m(B)(Je.value)),1),v("span",null,I(Ze.value||"元"),1)],64)):(d(),c(p,{key:2},[v("span",null,I(Ke.value),1),v("span",null,I(Ye.value),1)],64))]),L(m(f),{disabled:m(at),shadow:!1,"theme-vars":m(_),class:"right",text:"立即投保",onClick:ht},{default:g((()=>[Me])),_:1},8,["disabled","theme-vars"])])):y("",!0)]),Ee.value?(d(),P(ie,{key:0,"product-detail":xe.value},null,8,["product-detail"])):y("",!0),ze]})),_:1},8,["theme-vars"]),L(n,{show:ke.value,"onUpdate:show":t[1]||(t[1]=e=>ke.value=e),"content-list":m(ct),"active-index":0,onOnConfirmHealth:Lt,onOnCloseHealthByMask:Vt},null,8,["show","content-list"]),Te.value?(d(),P(m(u),{key:0,show:Te.value,"onUpdate:show":t[2]||(t[2]=e=>Te.value=e),"content-list":vt.value,"is-only-view":Ge.value,"active-index":we.value,text:Ge.value?"关闭":"我已逐页阅读并确认告知内容","force-read-cound":0,"on-close-file-preview":"",onSubmit:Ct,onOnCloseFilePreviewByMask:Vt},null,8,["show","content-list","is-only-view","active-index","text"])):y("",!0)],64)}}}),[["__scopeId","data-v-4f898a32"]]);export{$e as default};
