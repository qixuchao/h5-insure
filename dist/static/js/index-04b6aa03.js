var Te=Object.defineProperty,_e=Object.defineProperties;var Fe=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ae=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var ne=(e,n,d)=>n in e?Te(e,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[n]=d,m=(e,n)=>{for(var d in n||(n={}))Ae.call(n,d)&&ne(e,d,n[d]);if(oe)for(var d of oe(n))Be.call(n,d)&&ne(e,d,n[d]);return e},b=(e,n)=>_e(e,Fe(n));import{g as ie,E as g,_ as re,y as pe,j as s,n as M,k as y,A as c,t as E,m as I,p as v,a4 as ce,a5 as me,z as S,C as K,O as Se,ak as he,h as Ve,r as x,G as Ne,F as Le,T as se,L as Oe,J as xe}from"./vendor-96e68f0e.js";import{q as we}from"./index-fbbc79b7.js";import{_ as ve,Y as ye,h as G,Q as w,U as Ge,m as We,R as qe,T as Pe,w as je,V as U,l as z,r as de,L as He,W as D,X as A,n as Me,P as Ke}from"./index-d081bc8c.js";import{c as W,a as $e}from"./order-ad7bcd6c.js";import{u as Ue}from"./useDicData-9ccaa997.js";import{P as ze}from"./index-b8c3374e.js";import{_ as Je}from"./index-54120b35.js";var Q=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(Q||{});const Z=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];W(Z);var X=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(X||{});const Ee=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];W(Ee);var V=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(V||{});const fe=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];W(fe);var B=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(B||{});const Qe=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];W(fe);var be=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(be||{});const Ie=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];W(Ie);const Ze=e=>(ce("data-v-c2f6ec68"),e=e(),me(),e),Xe={class:"com-bank-card-info"},Ye=Ze(()=>S("span",{class:"field-title"},[K("\u94F6\u884C\u5361\u7167\u7247 "),S("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),ea=ie({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:n}){const d=e,q=Ue("BANK"),p=g({bankCardType:X.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),_=r=>d.factor&&d.factor[r]&&d.factor[r].isDisplay===ye.YES,P=r=>r&&r.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247",j=r=>{qe({ossKey:[r],imageType:Pe.BANK_CARD}).then(i=>{const{data:u,code:t}=i;t==="10000"&&u&&u.bankCardOcrVO&&(p.value.bankCardNo=u.bankCardOcrVO.bankNo)})};re(()=>d.modelValue,r=>{p.value=r},{immediate:!0}),re(p,r=>{n("update:modelValue",r)});const N=pe(()=>q.value.map(r=>({label:r.name,value:r.code})));return(r,i)=>(s(),M("div",Xe,[_("cardType")?(s(),y(G,{key:0,modelValue:p.value.bankCardType,"onUpdate:modelValue":i[0]||(i[0]=u=>p.value.bankCardType=u),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":c(Ee),"is-view":""},null,8,["modelValue","data-source"])):E("",!0),_("bankCardNumber")?(s(),y(w,{key:1,modelValue:p.value.bankCardNo,"onUpdate:modelValue":i[1]||(i[1]=u=>p.value.bankCardNo=u),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):E("",!0),_("cardHolder")?(s(),y(w,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):E("",!0),_("bank")?(s(),y(G,{key:3,modelValue:p.value.payBank,"onUpdate:modelValue":i[2]||(i[2]=u=>p.value.payBank=u),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":c(N),required:""},null,8,["modelValue","data-source"])):E("",!0),_("bankCardAttachment")?(s(),y(w,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:P}]},{label:I(()=>[Ye]),input:I(()=>[v(We,{modelValue:p.value.images,"onUpdate:modelValue":i[3]||(i[3]=u=>p.value.images=u),"max-count":2,"upload-type":c(Ge).BANK_CARD,onOnUploadFinished:j},null,8,["modelValue","upload-type"])]),_:1},8,["rules"])):E("",!0),_("bankPreMobile")?(s(),y(w,{key:5,modelValue:p.value.mobile,"onUpdate:modelValue":i[4]||(i[4]=u=>p.value.mobile=u),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):E("",!0)]))}});var J=ve(ea,[["__scopeId","data-v-c2f6ec68"]]),aa="/static/assets/bank.588e555f.pdf";const ua=e=>(ce("data-v-3430f6c0"),e=e(),me(),e),la={class:"page-bank-card"},ta={class:"reprise-card-list"},oa=["onClick"],na={class:"agree"},ra=K(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),sa={class:"footer-button footer"},da=ua(()=>S("div",{class:"text"},"\u5237\u65B0",-1)),ia=K("\u5206\u4EAB"),pa=K("\u4E0B\u4E00\u6B65"),ca=ie({setup(e){const n=Se(),d=he(),{orderNo:q="2022072710380711215",agentCode:p="D1234567-1",tenantId:_="9991000007",templateId:P=1,isShare:j}=n.query,N={bankCardType:X.DEBIT};let r={};const i=g(""),u=g({payMethod:Q.REAL_TIME,bankData:b(m({},N),{imagesId:[],images:[]})}),t=g({payMethod:Q.REAL_TIME,expiryMethod:be.AUTOMATIC_PADDING,bankData:b(m({},N),{imagesId:[],images:[]}),payInfoType:B.FIRST_SAME}),k=g({bankData:b(m({},N),{imagesId:[],images:[]})}),L=g(B.FIRST_SAME),F=g({}),$=g(!1),Y=g(),ee=g(),ae=g(),De=f=>{L.value=f},H=(f,l)=>(console.log("factor",F.value),F.value&&F.value[l]&&F.value[l][f]&&F.value[l][f].isDisplay===ye.YES),ke=()=>{de({orderNo:q,saleUserId:p,tenantId:_}).then(f=>{var a,T,O;const{code:l,data:R}=f;l==="10000"&&(R.orderStatus!==$e.PENDING?(se.fail("\u8BA2\u5355\u975E\u5F85\u5904\u7406\u72B6\u6001"),He("paymentResult",n.query)):Promise.all([(a=Y.value)==null?void 0:a.validate(),(T=ee.value)==null?void 0:T.validate(),(O=ae.value)==null?void 0:O.validate()]).then(C=>{if(!$.value){se.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}const o=[b(m({},C[0]),{id:u.value.id,paymentType:V.FIRST_TERM}),b(m({},C[1]),{id:t.value.id,paymentType:V.RENEW_TERM}),b(m({},C[2]),{id:k.value.id,paymentType:V.REPRISE,payInfoType:L.value})],h=[{category:D.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.INIT_SIGN,type:"png",uri:C[0].images[0],id:u.value.bankData.imagesId[0]},{category:D.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:A.INIT_SIGN,type:"png",uri:C[0].images[1],id:u.value.bankData.imagesId[1]}];t.value.payInfoType===B.OTHER&&(h.push({category:D.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.RENEWAL_SIGN,type:"png",uri:C[1].images[0],id:t.value.bankData.imagesId[0]}),h.push({category:D.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.RENEWAL_SIGN,type:"png",uri:C[1].images[1],id:t.value.bankData.imagesId[1]})),L.value===B.OTHER&&(h.push({category:D.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.ANNUAL_SIGN,type:"png",uri:C[2].images[0],id:k.value.bankData.imagesId[0]}),h.push({category:D.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:A.ANNUAL_SIGN,type:"png",uri:C[2].images[1],id:k.value.bankData.imagesId[1]})),Me(b(m({},r),{pageCode:"payInfo",tenantOrderPayInfoList:o,extInfo:b(m({},r.extInfo),{templateId:P,pageCode:"payInfo"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:h})).then(le=>{const{code:ge,data:te}=le;ge==="10000"&&te.success&&d.push({path:Ke[te.pageAction.data.nextPageCode],query:n.query})})}))})},Re=pe(()=>{const f=b(m({},n.query),{isShare:1,sharePageCode:"payInfo"});return`${window.location.origin}/phoneVerify?${we.stringify(f)}`}),ue=()=>{de({orderNo:q,saleUserId:p,tenantId:_}).then(f=>{const{code:l,data:R}=f;l==="10000"&&R&&(r=R,i.value=R.tenantOrderHolder.name,R.tenantOrderPayInfoList.forEach(a=>{a.paymentType===V.FIRST_TERM?(u.value=a,u.value.bankData=b(m(m({},N),a),{images:[],imagesId:[]})):a.paymentType===V.RENEW_TERM?(t.value=a,t.value.bankData=b(m({},a),{images:[],imagesId:[]})):a.paymentType===V.REPRISE&&(k.value=a,k.value.bankData=b(m({},a),{images:[],imagesId:[]}),L.value=a.payInfoType)}),R.tenantOrderAttachmentList.forEach(a=>{a.objectType===A.INIT_SIGN?(a.category===D.OBVERSE_BANK_CARD&&(u.value.bankData.images[0]=a.uri,u.value.bankData.imagesId[0]=a.id),a.category===D.REVERSE_BANK_CARD&&(u.value.bankData.images[1]=a.uri,u.value.bankData.imagesId[1]=a.id)):a.objectType===A.RENEWAL_SIGN?(a.category===D.OBVERSE_BANK_CARD&&(t.value.bankData.images[0]=a.uri,t.value.bankData.imagesId[0]=a.id),a.category===D.REVERSE_BANK_CARD&&(t.value.bankData.images[1]=a.uri,t.value.bankData.imagesId[1]=a.id)):a.objectType===A.ANNUAL_SIGN&&(a.category===D.OBVERSE_BANK_CARD&&(k.value.bankData.images[0]=a.uri,k.value.bankData.imagesId[0]=a.id),a.category===D.REVERSE_BANK_CARD&&(k.value.bankData.images[1]=a.uri,k.value.bankData.imagesId[1]=a.id))}))})},Ce=()=>{ue()};return Ve(()=>{je({pageCode:"payInfo",templateId:P}).then(f=>{const{code:l,data:R}=f;if(l==="10000"){const a={};R.productInsureFactorList.forEach(T=>{a[T.moduleType]||(a[T.moduleType]={}),a[T.moduleType][T.code]=T}),F.value=a}}),ue()}),(f,l)=>{const R=x("van-switch"),a=x("van-checkbox"),T=x("ProSvg"),O=x("van-button"),C=x("ProPageWrap");return s(),y(C,null,{default:I(()=>[S("div",la,[v(z,{title:"\u9996\u671F\u652F\u4ED8"},{default:I(()=>[v(U,{ref_key:"form1",ref:Y},{default:I(()=>[H("paymentMethod","INIT")?(s(),y(G,{key:0,modelValue:u.value.payMethod,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.payMethod=o),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":c(Z)},null,8,["modelValue","data-source"])):E("",!0),v(J,{modelValue:u.value.bankData,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.bankData=o),"holder-name":i.value,factor:F.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),v(z,{title:"\u7EED\u671F\u652F\u4ED8"},{default:I(()=>[v(U,{ref_key:"form2",ref:ee},{default:I(()=>[H("sameAsInit","RENEWAL")?(s(),y(w,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:I(()=>[v(R,{modelValue:t.value.payInfoType,"onUpdate:modelValue":l[2]||(l[2]=o=>t.value.payInfoType=o),size:"22","active-value":c(B).FIRST_SAME,"inactive-value":c(B).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):E("",!0),H("paymentMethod","RENEWAL")?(s(),y(G,{key:1,modelValue:t.value.payMethod,"onUpdate:modelValue":l[3]||(l[3]=o=>t.value.payMethod=o),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":c(Z),required:""},null,8,["modelValue","data-source"])):E("",!0),H("overduePayment","RENEWAL")?(s(),y(G,{key:2,modelValue:t.value.expiryMethod,"onUpdate:modelValue":l[4]||(l[4]=o=>t.value.expiryMethod=o),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":c(Ie),required:"","label-width":"200"},null,8,["modelValue","data-source"])):E("",!0),t.value.payInfoType!==c(B).FIRST_SAME?(s(),y(J,{key:3,modelValue:t.value.bankData,"onUpdate:modelValue":l[5]||(l[5]=o=>t.value.bankData=o),"holder-name":i.value,factor:F.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):E("",!0)]),_:1},512)]),_:1}),v(z,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:I(()=>[S("div",ta,[(s(!0),M(Le,null,Ne(c(Qe),(o,h)=>(s(),M("div",{key:h,class:Oe(["reprise-card-item",{selected:L.value===o.value}]),onClick:le=>De(o.value)},xe(o.label),11,oa))),128))]),v(U,{ref_key:"form3",ref:ae},{default:I(()=>[L.value===c(B).OTHER?(s(),y(J,{key:0,modelValue:k.value.bankData,"onUpdate:modelValue":l[6]||(l[6]=o=>k.value.bankData=o),"holder-name":i.value,factor:F.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):E("",!0)]),_:1},512)]),_:1}),S("div",na,[v(a,{modelValue:$.value,"onUpdate:modelValue":l[7]||(l[7]=o=>$.value=o),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),ra,v(ze,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",url:c(aa)},null,8,["url"])]),S("div",sa,[c(j)?E("",!0):(s(),M("div",{key:0,class:"refresh-btn",onClick:Ce},[S("div",null,[v(T,{name:"refresh"})]),da])),c(j)?E("",!0):(s(),y(Je,{key:1,title:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",desc:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",link:c(Re),"-":""},{default:I(()=>[v(O,{plain:"",type:"primary"},{default:I(()=>[ia]),_:1})]),_:1},8,["link"])),v(O,{type:"primary",class:"submit-btn",onClick:ke},{default:I(()=>[pa]),_:1})])])]),_:1})}}});var ka=ve(ca,[["__scopeId","data-v-3430f6c0"]]);export{ka as default};
