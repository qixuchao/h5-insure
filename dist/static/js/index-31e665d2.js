var De=Object.defineProperty,he=Object.defineProperties;var ge=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Pe=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var de=(m,d,l)=>d in m?De(m,d,{enumerable:!0,configurable:!0,writable:!0,value:l}):m[d]=l,E=(m,d)=>{for(var l in d||(d={}))Pe.call(d,l)&&de(m,l,d[l]);if(ie)for(var l of ie(d))Te.call(d,l)&&de(m,l,d[l]);return m},A=(m,d)=>he(m,ge(d));import{h as me,G as B,$ as ae,r as _,k as L,m as V,n as c,A as i,s as f,p as Z,H as Ie,L as k,F as ve,E as $,aa as Re,P as be,R as xe,N as Ne,z as le,o as Fe,B as p,v as Q,d as ce,T as Ve}from"./vendor-0e135a62.js";import{_ as ke,m as He,h as Se,g as Ue,A as Y,t as F,N as we,n as $e,b as je}from"./index-77081846.js";import{p as Me}from"./trial-a16aa1f2.js";import{P as fe,I as pe,R as Ye}from"./trial-bf700902.js";import{u as qe}from"./useDicData-2cefbd70.js";import{R as Ge,a as Ke,B as We,b as ze}from"./infoCollection-cf13707a.js";import{_ as oe}from"./index-6509d6fd.js";const Je={class:"com-select-container"},Xe={class:"radio-item-wrapper"},Qe={class:"name"},Ze={class:"hone"},et={class:"address"},tt={class:"footer-button"},nt=$("\u53D6\u6D88"),rt=$("\u786E\u8BA4"),ot=me({props:{dataSource:{type:Array,default:()=>[]},show:{type:Boolean,default:!1},modelValue:{type:[String,Number],default:null}},emits:["update","update:modelValue","submit","close"],setup(m,{emit:d}){const l=m,R=B(l.modelValue),q=B(l.show),ee=()=>{d("submit",R.value),q.value=!1},te=()=>{d("close")};return ae(()=>l.modelValue,G=>{R.value=G}),ae(()=>R.value,G=>{d("update:modelValue",G)}),(G,H)=>{const X=_("van-radio"),K=_("van-radio-group"),W=_("VanButton");return L(),V(He,{show:q.value,"onUpdate:show":H[1]||(H[1]=D=>q.value=D),class:"com-select",title:"\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F",onClose:te},{default:c(()=>[i("div",Je,[f(K,{modelValue:R.value,"onUpdate:modelValue":H[0]||(H[0]=D=>R.value=D)},{default:c(()=>[(L(!0),Z(ve,null,Ie(m.dataSource,(D,S)=>(L(),V(X,{key:S,name:S+1,class:"radio-item"},{default:c(()=>[i("div",Xe,[i("p",null,[i("span",Qe,k(D.contactName),1),i("span",Ze,k(D.contactPhoneNo),1)]),i("p",et,k(D.contactAddress),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),i("div",tt,[f(W,{plain:"",type:"primary"},{default:c(()=>[nt]),_:1}),f(W,{type:"primary",onClick:ee},{default:c(()=>[rt]),_:1})])]),_:1},8,["show"])}}});var at=ke(ot,[["__scopeId","data-v-a821acd4"]]);const st={key:0,class:"beneficiary-part"},ut={class:"part-title"},it={class:"title"},dt=$("\u5220\u9664"),lt=$("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),ct=$("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),ft={class:"radio-item-wrapper"},pt={class:"name"},mt={class:"hone"},It={class:"address"},vt={class:"footer-button","safe-area-inset-bottom":""},_t={class:"left"},Ot={class:"trial-result"},Et=$(" \u9996\u671F"),Lt={class:"result-num"},yt=i("div",{class:"result-desc"},"\u5B9E\u9645\u4FDD\u8D39\u4EE5\u540E\u7EED\u4E3A\u51C6",-1),Ct={class:"operate-btn"},At=$("\u4E0B\u4E00\u6B65"),xt=me({setup(m){const d=Re(),l=be(),{templateId:R=1,orderNo:q="2022072710380711215",productCode:ee,tenantId:te="9991000007",proposalId:G,insurerCode:H="kunlunhealth"}=l.query,[X,K]=xe(),W=l.path==="/infoPreview"?"infoPreview":"infoCollection",D=qe("NATIONAL_REGION_CODE"),S=B({}),e=B({extInfo:{pageCode:W},tenantOrderHolder:{extInfo:{occupationCodeList:[]},holderType:1},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),ne=B(null),b=B([]),j=B([]),z=B([]),re=B([]),se=B([]),x=Ne({beneficiaryId:0,nextPage:"",currentAddress:null,isLoading:!0}),ue=le(()=>{var t,u,s,r,o,I,v,h,g,P;return[{contactAddress:(u=(t=e.value.tenantOrderHolder)==null?void 0:t.extInfo)==null?void 0:u.familyAddress,contactName:e.value.tenantOrderHolder.name,contactPhoneNo:e.value.tenantOrderHolder.mobile},{contactAddress:(r=(s=e.value.tenantOrderHolder)==null?void 0:s.extInfo)==null?void 0:r.workAddress,contactName:e.value.tenantOrderHolder.name,contactPhoneNo:e.value.tenantOrderHolder.mobile},{contactAddress:(I=(o=e.value.tenantOrderInsuredList[0])==null?void 0:o.extInfo)==null?void 0:I.familyAddress,contactName:(v=e.value.tenantOrderInsuredList[0])==null?void 0:v.name,contactPhoneNo:(h=e.value.tenantOrderInsuredList[0])==null?void 0:h.mobile},{contactAddress:(P=(g=e.value.tenantOrderInsuredList[0])==null?void 0:g.extInfo)==null?void 0:P.workAddress,contactName:e.value.tenantOrderInsuredList[0].name,contactPhoneNo:e.value.tenantOrderInsuredList[0].mobile}].filter(y=>y.contactAddress&&y.contactName&&y.contactPhoneNo)||[]}),J=le(()=>{var a,t;return x.currentAddress?ue.value[x.currentAddress-1]||{}:((t=(a=e.value.extInfo)==null?void 0:a.contactInfo)==null?void 0:t[0])||{}}),_e=a=>{const t={};return a.map(u=>{const{initialAmount:s,annuityDrawFrequency:r,annuityDrawType:o,paymentFrequency:I,paymentPeriod:v,paymentPeriodType:h,insurancePeriodType:g,insurancePeriodValue:P,riskCode:y,riskType:U,initialPremium:M,liabilityDetails:w,extInfo:C}=u,{riskId:N,copy:n}=C,O={amount:s,annuityDrawDate:r,annuityDrawType:o,paymentFrequency:I,riskId:N,copy:n,chargePeriod:v?`${fe[h]}_${v}`:fe[h],coveragePeriod:P?`${pe[g]}_${P}`:pe[g],riskCode:y,riskType:U,premium:M,liabilityVOList:w.map(T=>A(E({},T),{liabilityAttributeValue:T.refundMethod,liabilityAttributeCode:T.refundMethod&&1}))};return U===Ye.MAIN_RISK?(t.mainRiskCode=y,t.mainRiskId=N):Object.assign(O,t),O})},Oe=()=>{var t;const a=E({},e.value);a.extInfo=A(E({},a.extInfo),{contactInfo:[J.value],buttonCode:we.infoCollection}),a.tenantOrderAttachmentList=[{category:Y.OBVERSE_CERT,objectType:F.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:b.value[0],id:z.value[0]},{category:Y.REVERSE_CERT,objectType:F.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:b.value[1],id:z.value[1]},{category:Y.OBVERSE_CERT,objectType:F.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:j.value[0]||b.value[0],id:re.value[1]},{category:Y.REVERSE_CERT,objectType:F.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:j.value[1]||b.value[1],id:re.value[1]}].filter(u=>u.uri),(t=ne.value)==null||t.validate().then(u=>{if(a.tenantOrderInsuredList[0].insuredBeneficiaryType===ze.SPECIFY){const s={};if(a.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.forEach(r=>{s[r.benefitOrder]?s[r.benefitOrder].sum+=Number(r.benefitRate):s[r.benefitOrder]={sum:Number(r.benefitRate)}}),Object.values(s).some(r=>r.sum!==100)){Ve.fail("\u540C\u4E00\u987A\u4F4D\u7684\u53D7\u76CA\u4EBA\u6BD4\u4F8B\u4E4B\u548C\u5FC5\u987B\u4E3A100");return}}$e(a).then(({code:s,data:r})=>{s==="10000"&&r.pageAction.pageAction==="jumpToPage"&&d.push({path:je[r.pageAction.data.nextPageCode],query:l.query})})})},Ee=()=>{var a;(a=ne.value)==null||a.validate().then(()=>{const{birthday:t,gender:u,extInfo:s}=e.value.tenantOrderHolder,{hasSocialInsurance:r,occupationCodeList:o}=s,{birthday:I,gender:v,extInfo:h,tenantOrderProductList:g}=e.value.tenantOrderInsuredList[0],{hasSocialInsurance:P,occupationCodeList:y}=h,U={holder:{personVO:{birthday:ce(t).format("YYYY-MM-DD"),gender:u,socialFlag:r,occupationCodeList:o}},productCode:ee,insuredVOList:[{insurerCode:H,personVO:{birthday:ce(I).format("YYYY-MM-DD"),gender:v,socialFlag:P,occupationCodeList:y},productPlanVOList:[{insurerCode:H,planCode:"",riskVOList:_e(g[0].tenantOrderRiskList)}]}]};Me(E({},U)).then(({code:M,data:w})=>{if(M==="10000"){const C={},N=(n=[])=>{(n||[]).forEach(O=>{var T;C[O.riskCode]=O,((T=O.riskPremiumDetailVOList)==null?void 0:T.length)&&N(O.riskPremiumDetailVOList)})};N(w.riskPremiumDetailVOList),e.value.tenantOrderInsuredList[0].tenantOrderProductList[0]=A(E({},e.value.tenantOrderInsuredList[0].tenantOrderProductList[0]),{premium:w.premium,tenantOrderRiskList:e.value.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantOrderRiskList.map(n=>A(E({},n),{initialAmount:C[n.riskCode].amount,initialPremium:C[n.riskCode].premium}))}),Oe()}})})},Le=a=>{},ye=()=>{x.beneficiaryId+=1,e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:x.beneficiaryId,extInfo:{}})},Ce=a=>{e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.filter(t=>t.beneficiaryId!==a.beneficiaryId||a.id!==t.id)},Ae=()=>{Ue({orderNo:q,tenantId:te}).then(({code:a,data:t})=>{var u,s;if(a==="10000"){const r=t;r.extInfo=A(E({},r.extInfo),{pageCode:W,templateId:R}),r.tenantOrderHolder=r.tenantOrderHolder||{holderType:1},r.tenantOrderHolder.extInfo=A(E({},r.tenantOrderHolder.extInfo),{occupationCodeList:((u=r.tenantOrderHolder.extInfo)==null?void 0:u.occupationCodeList)||[]}),r.tenantOrderInsuredList[0].extInfo=A(E({},r.tenantOrderInsuredList[0].extInfo),{occupationCodeList:((s=r.tenantOrderInsuredList[0].extInfo)==null?void 0:s.occupationCodeList)||[]}),r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{var v;const I=o;return I.extInfo=A(E({},I.extInfo),{occupationCodeList:((v=I.extInfo)==null?void 0:v.occupationCodeList)||[]}),I}),r.tenantOrderAttachmentList.forEach(o=>{o.category===Y.OBVERSE_CERT?o.objectType===F.HOLDER?(b.value[0]=o.uri,z.value[0]=o.id):o.objectType===F.INSURED&&(j.value[0]=o.uri,re.value[0]=o.id):o.category===Y.REVERSE_CERT&&(o.objectType===F.HOLDER?(b.value[1]=o.uri,z.value[1]=o.id):o.objectType===F.INSURED&&(j.value[1]=o.uri,z.value[1]=o.id))}),Object.assign(e.value,r)}}).finally(()=>{x.isLoading=!1})},Be=()=>{Object.assign(e.value.tenantOrderInsuredList[0],e.value.tenantOrderHolder,{id:e.value.tenantOrderInsuredList[0].id,extInfo:A(E({},e.value.tenantOrderHolder.extInfo),{insureProvinceCode:e.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,insureCityCode:e.value.tenantOrderInsuredList[0].extInfo.insureCityCode,insureAreaCode:e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode})})};return Fe(()=>{Ae(),Se({pageCode:"infoCollection",templateId:R}).then(({code:a,data:t})=>{if(a==="10000"){const u={BENEFICIARY:[],INSURER:[],HOLDER:[]};t.productInsureFactorList.forEach(s=>{(u[s.moduleType]=u[s.moduleType]||[]).push(s)}),S.value=u}})}),ae([()=>e.value.tenantOrderInsuredList[0].relationToHolder,()=>e.value.tenantOrderHolder],()=>{`${e.value.tenantOrderInsuredList[0].relationToHolder}`===Ge.SELF&&Be()},{deep:!0,immediate:!0}),(a,t)=>{const u=_("ProCard"),s=_("ProRadioButton"),r=_("ProField"),o=_("ProCascader"),I=_("ProSvg"),v=_("VanButton"),h=_("ProCheckButton"),g=_("van-cell"),P=_("ProForm"),y=_("ProPageWrap");return L(),V(y,{class:"page-info-wrapper"},{default:c(()=>{var U,M,w,C,N;return[p(x).isLoading?Q("",!0):(L(),V(P,{key:0,ref_key:"formRef",ref:ne},{default:c(()=>[f(u,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[f(oe,{images:b.value,"onUpdate:images":t[0]||(t[0]=n=>b.value=n),"form-info":e.value.tenantOrderHolder,"factor-list":S.value.HOLDER,prefix:"holder"},null,8,["images","form-info","factor-list"])]),_:1}),f(u,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[f(r,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":t[2]||(t[2]=n=>e.value.tenantOrderInsuredList[0].relationToHolder=n),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[f(s,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":t[1]||(t[1]=n=>e.value.tenantOrderInsuredList[0].relationToHolder=n),options:p(Ke)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+e.value.tenantOrderInsuredList[0].relationToHolder!=1?(L(),V(oe,{key:0,images:j.value,"onUpdate:images":t[3]||(t[3]=n=>j.value=n),"form-info":e.value.tenantOrderInsuredList[0],"factor-list":S.value.INSURER||[],prefix:"insure"},null,8,["images","form-info","factor-list"])):Q("",!0),f(o,{modelValue:e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:modelValue":t[4]||(t[4]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=n),field1:e.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":t[5]||(t[5]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=n),field2:e.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":t[6]||(t[6]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureCityCode=n),field3:e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":t[7]||(t[7]=n=>e.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=n),label:"\u6295\u4FDD\u5730\u533A",name:"insureAreaCode",placeholder:"\u8BF7\u9009\u62E9","is-link":"",required:"","data-source":p(D),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])]),_:1}),f(u,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[f(r,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":t[9]||(t[9]=n=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=n),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[f(s,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":t[8]||(t[8]=n=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=n),options:p(We)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),e.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(L(),Z("div",st,[(L(!0),Z(ve,null,Ie(e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(n,O)=>(L(),Z("div",{key:n.beneficiaryId||n.id,class:"beneficiary-item"},[i("div",ut,[i("span",it,k(`\u53D7\u76CA\u4EBA${O+1}`),1),f(I,{name:"delete",onClick:T=>Ce(n)},{default:c(()=>[dt]),_:2},1032,["onClick"])]),f(oe,{images:se.value,"onUpdate:images":t[10]||(t[10]=T=>se.value=T),"form-info":n,"factor-list":S.value.BENEFICIARY||[],prefix:`beneficiary-${O}`,"beneficiary-list":e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","beneficiary-list"])]))),128)),f(v,{onClick:ye},{default:c(()=>[lt]),_:1})])):Q("",!0)]),_:1}),f(u,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>{var n;return[((n=Object.keys(p(J)))==null?void 0:n.length)?(L(),V(g,{key:1,title:"\u5355\u5143\u683C","is-link":"",onClick:t[12]||(t[12]=O=>p(K)(!0))},{title:c(()=>[i("div",ft,[i("p",null,[i("span",pt,k(p(J).contactName),1),i("span",mt,k(p(J).contactPhoneNo),1)]),i("p",It,k(p(J).contactAddress),1)])]),_:1})):(L(),V(h,{key:0,activated:"",onClick:t[11]||(t[11]=O=>p(K)(!0))},{default:c(()=>[ct]),_:1}))]}),_:1})]),_:1},512)),i("div",vt,[i("div",_t,[i("div",Ot,[Et,i("span",Lt,"\uFFE5"+k((N=(C=(w=(M=(U=e.value.tenantOrderInsuredList)==null?void 0:U[0])==null?void 0:M.tenantOrderProductList)==null?void 0:w[0].premium)==null?void 0:C.toLocaleString)==null?void 0:N.call(C)),1)]),yt]),i("div",Ct,[f(v,{block:"",type:"primary",onClick:Ee},{default:c(()=>[At]),_:1})])]),p(X)?(L(),V(at,{key:1,modelValue:p(x).currentAddress,"onUpdate:modelValue":t[13]||(t[13]=n=>p(x).currentAddress=n),show:p(X),"data-source":p(ue),onSubmit:Le,onClose:t[14]||(t[14]=n=>p(K)(!1))},null,8,["modelValue","show","data-source"])):Q("",!0)]}),_:1})}}});export{xt as default};
