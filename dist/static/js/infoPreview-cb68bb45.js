import{d as e,o as t,c as a,b as n,w as o,F as s,s as i,p as r,a as l,u as c,a6 as d,f as u,cY as p,aI as m,a4 as f,a5 as y,i as I,h,aa as v,r as g,j as w,az as b,l as k,q as j,ad as _,a0 as q,cZ as C,ae as P,g as V,a8 as L,aG as x,aF as N,ay as D,bA as O,ab as S,by as T,af as E,bV as R}from"./index-e5e6a3c6.js";import{_ as A}from"./PayInfo-df20da74.js";import{_ as F}from"./PolicyInfo-60757fe9.js";import{g as Q,m as U}from"./trial-225bc6c3.js";import{n as M}from"./nextStep-fd4e902a.js";import{b as z,l as Y}from"./product-24a5e2b1.js";import{u as $}from"./useOrder-acb4a9a9.js";import{P as B}from"./index-3a2d89d6.js";import{P as G}from"./index-57238a19.js";import{R as J,c as K}from"./trial-7199215b.js";import{p as W,d as X}from"./utils-5942b81a.js";import{I as Z}from"./insuranceNotificationInformation-00bf5b74.js";import{Q as H}from"./notice-33e6eedd.js";import{g as ee}from"./utils-19cb7a72.js";import{Q as te}from"./questionnaire-42dcb602.js";import"./core-3c0e79a8.js";import"./cloneDeep-dbcdde05.js";import"./infoCollection-4bd4d253.js";import"./util-033f99b8.js";import"./index-0ccfa23b.js";import"./index-76bcfe35.js";const ae={class:"com-insured-part-wrapper"},ne={class:"content-wrapper"},oe={class:"risk-item"},se=e({__name:"InsureInfo",props:{productData:{default:()=>[]},totalPremium:{default:0}},setup:e=>(f,y)=>{const I=p,h=m;return t(),a("div",ae,[n(h,{title:"保障信息","show-icon":!1},{default:o((()=>[(t(!0),a(s,null,i(e.productData,(e=>(t(),a(s,{key:e.productCode},[(t(!0),a(s,null,i(e.riskList,(e=>(t(),r(h,{key:e.riskCode,title:e.riskName},{default:o((()=>{var o;return[l("div",ne,[l("div",oe,[e.riskType===c(J).MAIN_RISK?(t(),a(s,{key:0},[n(I,{title:"保障期间",content:e.coveragePeriodDesc},null,8,["content"]),n(I,{title:"交费期间",content:e.chargePeriodDesc},null,8,["content"])],64)):(t(),a(s,{key:1},[n(I,{title:e.riskName,content:"投保"},null,8,["title"]),e.exemptFlag===c(d).YES?(t(),r(I,{key:0,title:"交费期间",content:e.chargePeriodDesc},null,8,["content"])):(null==(o=e.liabilityList)?void 0:o.length)?(t(),a(s,{key:1},[n(I,{title:"保障期间",content:e.coveragePeriodDesc},null,8,["content"]),n(I,{title:"交费期间",content:e.chargePeriodDesc},null,8,["content"]),n(I,{title:"交费方式",content:c(K)[e.paymentFrequency]},null,8,["content"])],64)):u("",!0)],64)),n(I,{title:"保障金额",content:(e.initialAmount||0).toLocaleString("hanidec",{style:"currency",currency:"CNY"})},null,8,["content"]),n(I,{title:"首期保费",class:"price",content:(e.initialPremium||0).toLocaleString("hanidec",{style:"currency",currency:"CNY"})},null,8,["content"])])])]})),_:2},1032,["title"])))),128))],64)))),128))])),_:1})])}});const ie={class:"long-info-preview"},re={class:"insurance-notification-information card"},le={class:"footer-btn"},ce=l("span",null,"分享",-1),de=e({__name:"infoPreview",setup(e){const d=f((()=>y((()=>import("./index-2868f638.js")),["static/js/index-2868f638.js","static/css/index-fa4edf2a.css","static/js/index-e5e6a3c6.js","static/css/index-972c27e5.css","static/js/theme-94cf7d00.js","static/js/index-57238a19.js","static/css/index-bbfdd7ec.css","static/js/utils-19cb7a72.js","static/js/infoCollection-4bd4d253.js","static/js/trial-7199215b.js"]))),p=I(),J=h(),K=$(),ae={holder:v.holderSign,insured:v.insuredSign,agent:v.agentSign},{productCode:ne="",tenantId:oe,agentCode:de="",agencyCode:ue,saleChannelId:pe,isShare:me,orderNo:fe,extraInfo:ye,insurerCode:Ie,objectType:he="1",preview:ve}=p.query;let ge={};try{ge=JSON.parse(decodeURIComponent(ye))}catch(Re){}const we=g({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),be=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`,ke=w({imgUrl:"",desc:"",title:"",link:be}),je=w(),_e=w(),qe=w(!1),Ce=w(0),Pe=w(!1),Ve=()=>{qe.value=!1},Le=w(),xe=()=>{M(K.value,((e,t)=>{t===x.JUMP_PAGE&&Le.value.handleShare()}))},Ne=async()=>{ve?N(D.INFO_PREVIEW,p.query):J.push({path:ae[he],query:p.query})},De=w(),Oe=w(),Se=w([]),Te=async()=>{let e={};const{code:t,data:a}=await Q({orderNo:fe,tenantId:oe});"10000"===t&&(Object.assign(K.value,a),e=W(a.insuredList[0].productList),De.value=a,Pe.value=!0),(async e=>{let t=[];const{code:a,data:n}=await R({orderNo:fe,tenantId:oe});"10000"===a&&(t=n.productQuestionnaireVOList);const{code:o,data:s}=await Y(e);if("10000"===o){const{productQuestionnaireVOList:e}=s||{},a=e.filter((e=>e.businessType!==H.VISIT));we.customerQuestions=a.map((e=>{const{questionnaireDetailResponseVO:a,questionnaireId:n,questionnaireName:o}=e||{},{questions:s,basicInfo:i}=a||{},{objectType:r,questionnaireType:l}=i||{};if(l===te.TEXT){const{content:e,textType:t}=(null==s?void 0:s[0])||{};return{content:e,contentType:ee(`${t}`,e),questionnaireId:n,questionnaireName:o}}const c=(t||[]).find((e=>e.questionnaireId===n));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:n,questionnaireName:o}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),z(e).then((({code:e,data:t})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:a}=X(t);Se.value=e.concat(a)}})),U(e).then((({data:e,code:t})=>{if("10000"===t){const{productDetailResList:t,productFactor:a}=e;Oe.value=a;const{payInfo:n,other:o}=O(a);we.payInfo={...we.payInfo,...n},we.policyInfo={...we.policyInfo,...o}}}))};b((()=>{Te()}));const Ee=w();return k((()=>{setTimeout((async()=>{Ee.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,p)=>{var f,y,I;const h=S,v=T,g=m,w=E;return t(),a("div",ie,[n(h),n(se,{"product-data":null==(y=null==(f=c(K).insuredList)?void 0:f[0])?void 0:y.productList},null,8,["product-data"]),(null==(I=Object.keys(c(Oe)||{}))?void 0:I.length)?(t(),r(B,{key:0,ref_key:"personalInfoRef",ref:_e,modelValue:c(De),"onUpdate:modelValue":p[0]||(p[0]=e=>j(De)?De.value=e:null),"product-factor":c(Oe),"is-view":""},null,8,["modelValue","product-factor"])):u("",!0),c(we).payInfo.schema.length?(t(),r(c(A),{key:1,ref_key:"payInfoRef",ref:je,modelValue:c(K).tenantOrderPayInfoList,"onUpdate:modelValue":p[1]||(p[1]=e=>c(K).tenantOrderPayInfoList=e),schema:c(we).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):u("",!0),c(we).policyInfo.schema.length?(t(),r(c(F),{key:2,modelValue:c(K).extInfo,"onUpdate:modelValue":p[2]||(p[2]=e=>c(K).extInfo=e),schema:c(we).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):u("",!0),l("div",re,[n(Z,{title:"投保告知信息",data:c(we).customerQuestions||[]},null,8,["data"])]),n(g,{title:"产品资料","show-line":!1,"show-icon":!1},{default:o((()=>[(t(!0),a(s,null,i(c(Se),((e,a)=>(t(),r(v,{key:a,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{Ce.value=e,qe.value=!0})(a)},null,8,["title","onClick"])))),128))])),_:1}),l("div",le,[!c(me)&&c(ke).isShare&&c(_)()?(t(),r(P,q({key:0},c(ke),{class:"share-btn",onClick:C(xe,["stop"])}),{default:o((()=>[n(w,{name:"share-icon","font-size":"24px",color:"#AEAEAE"}),ce])),_:1},16,["onClick"])):u("",!0),n(G,{shadow:!1,onClick:Ne},{default:o((()=>[V(e.$slots,"default",{},(()=>[L("下一步")]))])),_:3})]),c(qe)?(t(),r(c(d),{key:3,show:c(qe),"onUpdate:show":p[3]||(p[3]=e=>j(qe)?qe.value=e:null),"content-list":[c(Se)[c(Ce)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:Ve},null,8,["show","content-list"])):u("",!0)])}}});export{de as default};
