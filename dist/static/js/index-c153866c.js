var ce=Object.defineProperty,de=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var G=(d,e,_)=>e in d?ce(d,e,{enumerable:!0,configurable:!0,writable:!0,value:_}):d[e]=_,W=(d,e)=>{for(var _ in e||(e={}))Be.call(e,_)&&G(d,_,e[_]);if(z)for(var _ of z(e))Ee.call(e,_)&&G(d,_,e[_]);return d},J=(d,e)=>de(d,_e(e));import{g as se,a5 as fe,r as T,j as D,n as g,z as t,A as y,p as f,a6 as ve,Q as De,aj as Ce,E as U,d as Fe,h as pe,k as L,m as v,J as p,L as K,t as X,G as $,F as H,a1 as he,a2 as Ae,C as N,T as I,D as ge}from"./vendor-83047d1f.js";import{_ as ae,S as me,D as ye,p as Z,l as R,E as ee,N as ue,P as Ne}from"./index-b38321f8.js";import{g as Ie,f as Re,s as te,a as Te}from"./verify-d6ef28c9.js";import{n as xe,a as Se}from"./index-35f19a9b.js";var Oe="/static/assets/sidenav.5031dada.png";const be={class:"com-navigator"},we=["src"],ke=se({setup(d){const[e,_]=fe(!1),x=()=>{_(!0)};return(S,C)=>{const O=T("van-popup");return D(),g("div",be,[t("img",{class:"btn",src:y(Oe),onClick:x},null,8,we),f(O,{show:y(e),"onUpdate:show":C[0]||(C[0]=b=>ve(e)?e.value=b:null),position:"right",style:{width:"50%",height:"100%"},"safe-area-inset-top":""},null,8,["show"])])}}});var Pe=ae(ke,[["__scopeId","data-v-48192b24"]]);const oe=d=>(he("data-v-ab7a6660"),d=d(),Ae(),d),Ue={class:"page-verify"},Le={class:"people"},$e={class:"name"},He={class:"verify-item"},je=oe(()=>t("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),Me={class:"no"},Ve=N(" \u53BB\u8BA4\u8BC1 "),Ye={class:"sign-body"},qe={class:"date"},Qe={class:"file"},ze=N(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A "),Ge={class:"people"},We={class:"name"},Je={class:"verify-item"},Ke=oe(()=>t("div",{class:"label"},"\u8EAB\u4EFD\u8BC1\u53F7\u7801",-1)),Xe={class:"no"},Ze=["onClick"],eu=N(" \u53BB\u8BA4\u8BC1 "),uu=["onClick"],tu={class:"sign-body"},su={class:"date"},au={class:"file"},ou=N(" \u7B7E\u540D\u5C06\u88AB\u7528\u4E8E\u4EE5\u4E0B\u6587\u4EF6\uFF1A "),nu={class:"footer-button footer"},ru=N("\u63D0\u4EA4"),iu=se({setup(d){const e={CERT:1,NO_CERT:2},_=De(),x=Ce(),{saleUserId:S="D1234567-1",tenantId:C="9991000007",templateId:O=1,productCode:b="CQ75CQ76",insurerCode:lu="ancheng"}=_.query;let{orderNo:h}=_.query;typeof h=="object"&&(h=(h||[])[0]);const w=new me({source:"localStorage"}),k=U([]),l=U(),m=U(),A=[],j=Fe().format("YYYY-MM-DD"),ne=()=>{var s;(s=m.value)==null||s.clear()},re=s=>{A[s].clear()},M=(s,o)=>{Te({callbackUrl:window.location.href,certiNo:s,faceAuthMode:"TENCENT",userName:o,tenantId:9991000007}).then(n=>{const{code:r,data:i}=n;if(r==="10000"){const{originalUrl:E,serialNo:u}=i;window.location.href=E,w.set("verifyData",{serialNo:u,certNo:s,name:o})}})},V=s=>{var o,n,r,i;s===-1?M((o=l.value.tenantOrderHolder)==null?void 0:o.certNo,(n=l.value.tenantOrderHolder)==null?void 0:n.name):M((r=l.value.tenantOrderInsuredList[s])==null?void 0:r.certNo,(i=l.value.tenantOrderInsuredList[s])==null?void 0:i.name)},ie=s=>{s&&A.every(o=>o!==s)&&A.push(s)},le=()=>{var o,n,r,i;if((o=m.value)==null?void 0:o.isEmpty()){I.fail("\u8BF7\u6295\u4FDD\u4EBA\u7B7E\u540D");return}if(A.some(E=>E.isEmpty())){I.fail("\u8BF7\u88AB\u4FDD\u4EBA\u7B7E\u540D");return}if(((r=(n=l.value.tenantOrderHolder)==null?void 0:n.extInfo)==null?void 0:r.isCert)!==e.CERT){I.fail("\u8BF7\u6295\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}if((i=l.value.tenantOrderInsuredList)==null?void 0:i.some(E=>{var u;return((u=E.extInfo)==null?void 0:u.isCert)!==e.CERT})){I.fail("\u8BF7\u88AB\u4FDD\u4EBA\u53BB\u8BA4\u8BC1");return}ge.confirm({title:"\u63D0\u793A",message:"\u8BF7\u786E\u8BA4\u4FE1\u606F\u586B\u5199\u65E0\u8BEF\u540E\uFF0C\u518D\u8FDB\u884C\u652F\u4ED8"}).then(()=>{var u,B;const E=(u=m.value)==null?void 0:u.save();Promise.all([te("HOLDER",E,(B=l.value)==null?void 0:B.id,`${C}`),...A.map(a=>{var c;return te("INSURED",a.save(),(c=l.value)==null?void 0:c.id,`${C}`)})]).then(()=>{xe(J(W({},l.value),{pageCode:"sign",operateOption:{withSignInfo:!0},extInfo:{pageCode:"sign",templateId:O},venderCode:"ancheng"})).then(a=>{const{code:c,data:F}=a;c==="10000"&&F.success&&x.push({path:Ne[F.pageAction.data.nextPageCode],query:{orderNo:h,saleUserId:S,tenantId:C}})})})})},Y=()=>{Se({orderNo:h,saleUserId:S,tenantId:C}).then(s=>{const{code:o,data:n}=s;o==="10000"&&(l.value=n,setTimeout(()=>{let r=0;n.tenantOrderAttachmentList.forEach(i=>{i.category===21&&(i.objectType===2?(m.value.clear(),m.value.setDataURL(i.fileBase64)):i.objectType===1&&(A[r].clear(),A[r].setDataURL(i.fileBase64),r+=1))})}))})};return pe(()=>{Y(),Ie({orderNo:h,productCode:b,tenantId:C}).then(o=>{const{code:n,data:r}=o;n==="10000"&&(k.value=r||[])});const s=w.get("verifyData");if(s){const{serialNo:o,certNo:n,name:r}=s;Re({certiNo:n,orderNo:h,serialNo:o,tenantId:C,userName:r}).then(i=>{const{code:E,data:u}=i;E==="10000"&&(w.remove("verifyData"),Y())})}}),(s,o)=>{const n=T("ProPDFviewer"),r=T("van-button"),i=T("ProPageWrap");return D(),L(i,null,{default:v(()=>{var E;return[t("div",Ue,[f(ye,{type:"warning",title:"\u5C0A\u656C\u7684\u5BA2\u6237\uFF0C\u672C\u6B21\u6295\u4FDD\u9700\u8981\u8FDB\u884C\u8EAB\u4EFD\u8BA4\u8BC1",content:"\u672C\u4EA7\u54C1\u6295\u4FDD\u9700\u8981\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\uFF0C\u60A8\u8D2D\u4E70\u672C\u4EA7\u54C1\u7684\u7D2F\u8BA1\u603B\u4FDD\u8D39\u5DF2\u8D85\u8FC720\u4E07\uFF0C\u6309\u76D1\u7BA1\u8981\u6C42\uFF0C\u9700\u8981\u63D0\u4F9B\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\u3001\u6307\u5B9A\u53D7\u76CA\u4EBA\u8BC1\u4EF6\u5F71\u50CF\uFF0C\u672C\u4EA7\u54C1\u975E\u672C\u4EBA\u6295\u4FDD\u4E14\u5E26\u8EAB\u6545\u8D23\u4EFB\u3001\u9700\u5BF9\u6295\u4FDD\u4EBA\u3001\u88AB\u4FDD\u4EBA\uFF08\u6210\u4EBA\uFF09\u7684\u6295\u4FDD\u610F\u613F\u8FDB\u884C\u7B7E\u5B57\u786E\u8BA4\u3002"}),f(R,{title:"\u6295\u4FDD\u4EBA",class:"card"},{extra:v(()=>{var u,B,a,c,F,P,q,Q;return[t("div",Le,[t("div",$e,p((B=(u=l.value)==null?void 0:u.tenantOrderHolder)==null?void 0:B.name),1),t("div",{class:K(["status",{verified:((F=(c=(a=l.value)==null?void 0:a.tenantOrderHolder)==null?void 0:c.extInfo)==null?void 0:F.isCert)===e.CERT}])},p(((Q=(q=(P=l.value)==null?void 0:P.tenantOrderHolder)==null?void 0:q.extInfo)==null?void 0:Q.isCert)===e.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:v(()=>{var u,B,a,c,F;return[t("div",He,[je,t("div",Me,p((B=(u=l.value)==null?void 0:u.tenantOrderHolder)==null?void 0:B.certNo),1),((F=(c=(a=l.value)==null?void 0:a.tenantOrderHolder)==null?void 0:c.extInfo)==null?void 0:F.isCert)!==e.CERT?(D(),g("div",{key:0,class:"action",onClick:o[0]||(o[0]=P=>V(-1))},[Ve,f(Z,{name:"right_arrow",class:"icon"})])):X("",!0)])]}),_:1}),f(R,{title:"\u6295\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:v(()=>[t("div",{class:"resign",onClick:ne},"\u91CD\u7B7E")]),default:v(()=>[f(ee,{ref_key:"holderSign",ref:m,class:"sign"},null,512),t("div",Ye,[t("div",qe,"\u7B7E\u540D\u65E5\u671F\uFF1A "+p(y(j)),1),t("div",Qe,[ze,(D(!0),g(H,null,$(k.value.filter(u=>u.noticeObject===y(ue).HOLDER),(u,B)=>(D(),L(n,{key:B,class:"file",title:`\u300A${u.materialName}\u300B`,url:u.materialSource},null,8,["title","url"]))),128))])])]),_:1}),(D(!0),g(H,null,$((E=l.value)==null?void 0:E.tenantOrderInsuredList,(u,B)=>(D(),g("div",{key:B},[f(R,{title:"\u88AB\u4FDD\u4EBA",class:"card"},{extra:v(()=>{var a,c;return[t("div",Ge,[t("div",We,p(u.name),1),t("div",{class:K(["status",{verified:((a=u.extInfo)==null?void 0:a.isCert)===e.CERT}])},p(((c=u.extInfo)==null?void 0:c.isCert)===e.CERT?"\u5DF2\u8BA4\u8BC1":"\u5F85\u8BA4\u8BC1"),3)])]}),default:v(()=>{var a;return[t("div",Je,[Ke,t("div",Xe,p(u.certNo),1),((a=u.extInfo)==null?void 0:a.isCert)!==e.CERT?(D(),g("div",{key:0,class:"action",onClick:c=>V(B)},[eu,f(Z,{name:"right_arrow",class:"icon"})],8,Ze)):X("",!0)])]}),_:2},1024),f(R,{title:"\u88AB\u4FDD\u4EBA\u7B7E\u540D","show-icon":!1,class:"sign-card","show-line":!1},{extra:v(()=>[t("div",{class:"resign",onClick:a=>re(B)},"\u91CD\u7B7E",8,uu)]),default:v(()=>[f(ee,{ref_for:!0,ref:ie,class:"sign"}),t("div",tu,[t("div",su,"\u7B7E\u540D\u65E5\u671F\uFF1A "+p(y(j)),1),t("div",au,[ou,(D(!0),g(H,null,$(k.value.filter(a=>a.noticeObject===y(ue).INSURED),(a,c)=>(D(),L(n,{key:c,class:"file",title:`\u300A${a.materialName}\u300B`,url:a.materialSource},null,8,["title","url"]))),128))])])]),_:2},1024)]))),128)),t("div",nu,[f(r,{type:"primary",class:"submit-btn",onClick:le},{default:v(()=>[ru]),_:1})])]),f(Pe)]}),_:1})}}});var fu=ae(iu,[["__scopeId","data-v-ab7a6660"]]);export{fu as default};
