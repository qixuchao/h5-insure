import{d as e,r as a,j as l,k as i,l as t,E as u,an as o,o as n,c as s,b as d,w as r,a as m,u as c,p as v,e as p,f as y,F as b,_ as V,bz as k,bA as f,s as g,be as h,bB as L,bC as C,bo as D,bp as I,aY as A,bD as x,m as O,bg as S,bh as F}from"./index-57c18dfc.js";import{S as K,g as w,o as P}from"./index-8d7ce0ca.js";import{c as _}from"./cloneDeep-e02f9e14.js";import{a as U,b as R}from"./infoCollection-75411a5e.js";import"./index-d21fedb9.js";import{f as N}from"./trial-b659e06b.js";import{L as T}from"./product-7bbf9c44.js";const E={key:0},j={class:"custom-field"},Y={key:1,class:"flex-field"},$={class:"pro-radio-wrap"},J={key:2},M={class:"pro-radio-wrap"},q={class:"custom-field"},B={key:1},G={key:3},z={class:"custom-field"},X={key:1},H={class:"custom-field"},Q={key:0},W={key:1},Z={key:4},ee=e({name:"BaoeBaofei"});var ae=V(e({...ee,props:{originData:{default:()=>({})},modelValue:{default:()=>({})},defaultValue:{default:()=>({})},trialResult:{default:0}},emits:["update:modelValue","trialChange"],setup(e,{emit:V}){const g=V,h=e;a({hadSetDefault:!1});const L=l(),C=l(),D=l(0),I=()=>2===L.value.saleMethod?{label:"首年保费",key:"unitPremium"}:{label:"基本保险金额",key:"unitAmount"},A=()=>{switch(`${L.value.displayUnit}`){case U.YUAN:return"元";case U.MONTH_SALARY:return"倍月薪";case U.MILLION:return"万元";case U.COPY:return"份"}return""},x=i((()=>2===L.value.saleMethod?{label:"首年保费",key:"unitPremium"}:{label:"基本保险金额",key:"unitAmount"})),O=i((()=>{if(L.value.displayValues){const e=I().key;return 1!==L.value.displayValues.length||C.value.riskCode||(C.value[e]=L.value.displayValues[0].code),L.value.displayValues.map((e=>({label:e.value,value:e.code})))}return[]})),S=()=>{};return t((()=>{})),u((()=>L),(e=>{(()=>{const{displayType:e,requireCopies:a,displayValues:l,initialAmount:i,copiesAmount:t,minCopiesValue:u,maxCopiesValue:o}=L.value,n=I().key,s=!C.value.riskCode;`${e}`===R.STEP?D.value=1:`${e}`===R.FIXED&&2===a?(D.value=2,l.length>=1&&s&&!C.value[n]&&(C.value[n]=l[0].code||l[0].value)):`${e}`===R.FIXED&&1===a?(D.value=3,u===o&&s&&!C.value.copy&&(C.value.copy=u),l.length>=1&&s&&!C.value[n]&&(C.value[n]=l[0].code||l[0].value)):`${e}`===R.COPY&&(D.value=4,u===o&&s&&!C.value.copy&&(C.value.copy=u),s&&!i&&(C.value.unitAmount=t))})()}),{deep:!0}),u((()=>h.defaultValue),((e,a)=>{(null==e?void 0:e.riskCode)&&o(e,a)&&(C.value={...C.value,unitAmount:e.unitAmount,unitPremium:e.unitPremium,copy:e.copy})}),{deep:!0,immediate:!0}),u((()=>h.originData),(e=>{L.value=e}),{immediate:!0,deep:!0}),u((()=>h.modelValue),(e=>{C.value=e}),{deep:!0,immediate:!0}),u((()=>C.value),(e=>{(()=>{if(1===D.value){const e=C.value[x.value.key],a=h.originData.minStepValue,l=h.originData.maxStepValue,i=h.originData.stepValue;if(+e>+l)return!1;if(+e<+a)return!1;if((+e-+a)%+i!=0)return!1}return!0})()&&(g("update:modelValue",e),g("trialChange",e))}),{deep:!0,immediate:!0}),(e,a)=>{const l=K,i=k,t=f;return n(),s(b,null,[1===D.value?(n(),s("div",E,[d(i,{label:`${c(x).label}`,name:c(x).key,class:"risk-select-field"},{input:r((()=>[m("div",j,[d(l,{modelValue:C.value[c(x).key],"onUpdate:modelValue":a[0]||(a[0]=e=>C.value[c(x).key]=e),"input-width":"80px","default-value":e.originData.minStepValue,min:e.originData.minStepValue,step:e.originData.stepValue,max:e.originData.maxStepValue||1/0,theme:"round"},null,8,["modelValue","default-value","min","step","max"])])])),_:1},8,["label","name"])])):2===D.value?(n(),s("div",Y,[d(i,{modelValue:C.value[c(x).key],"onUpdate:modelValue":a[2]||(a[2]=e=>C.value[c(x).key]=e),label:`${c(x).label}`,name:c(x).key,class:"risk-select-field"},{input:r((()=>[m("div",$,[d(t,{modelValue:C.value[c(x).key],"onUpdate:modelValue":a[1]||(a[1]=e=>C.value[c(x).key]=e),options:c(O),onclick:S},null,8,["modelValue","options"])])])),_:1},8,["modelValue","label","name"])])):3===D.value?(n(),s("div",J,[d(i,{modelValue:C.value[c(x).key],"onUpdate:modelValue":a[4]||(a[4]=e=>C.value[c(x).key]=e),label:`${c(x).label}`,name:c(x).key,class:"risk-select-field"},{input:r((()=>[m("div",M,[d(t,{modelValue:C.value[c(x).key],"onUpdate:modelValue":a[3]||(a[3]=e=>C.value[c(x).key]=e),options:c(O),onclick:S},null,8,["modelValue","options"])])])),_:1},8,["modelValue","label","name"]),m("div",null,[d(i,{modelValue:C.value.copy,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value.copy=e),label:"份数",name:"copy",class:"risk-select-field"},{input:r((()=>[m("div",q,[e.originData.minCopiesValue!==e.originData.maxCopiesValue?(n(),v(l,{key:0,modelValue:C.value.copy,"onUpdate:modelValue":a[5]||(a[5]=e=>C.value.copy=e),"input-width":"80px","default-value":e.originData.minCopiesValue,min:e.originData.minCopiesValue||1,step:1,max:e.originData.maxCopiesValue||1/0,theme:"round"},null,8,["modelValue","default-value","min","max"])):(n(),s("span",B,p(e.originData.minCopiesValue),1))])])),_:1},8,["modelValue"])])])):4===D.value?(n(),s("div",G,[d(i,{modelValue:C.value.copy,"onUpdate:modelValue":a[8]||(a[8]=e=>C.value.copy=e),label:"份数",name:"copy",class:"risk-select-field"},{input:r((()=>[m("div",z,[e.originData.minCopiesValue!==e.originData.maxCopiesValue?(n(),v(l,{key:0,modelValue:C.value.copy,"onUpdate:modelValue":a[7]||(a[7]=e=>C.value.copy=e),"input-width":"64px","default-value":e.originData.minCopiesValue,min:e.originData.minCopiesValue||1,step:1,max:e.originData.maxCopiesValue||1/0,theme:"round"},null,8,["modelValue","default-value","min","max"])):(n(),s("span",X,p(e.originData.minCopiesValue),1))])])),_:1},8,["modelValue"]),d(i,{label:c(x).label,name:"copyAmount",class:"risk-select-field"},{input:r((()=>[m("div",H,[e.originData.minCopiesValue!==e.originData.maxCopiesValue?(n(),s("span",Q,p(+e.originData.copiesAmount*+C.value.copy+A()),1)):(n(),s("span",W,p(+e.originData.minCopiesValue*+e.originData.copiesAmount+A()),1))])])),_:1},8,["label"])])):y("",!0),2===L.value.saleMethod&&e.trialResult>0?(n(),s("div",Z,[d(i,{label:"基本保险金额",class:"risk-select-field"},{input:r((()=>[m("span",null,p(e.trialResult+A()),1)])),_:1})])):y("",!0)],64)}}}),[["__scopeId","data-v-788f13b8"]]);const le=[{name:"年金领取期间",type:"checkbox",configKey:["annuityDrawValueList"],valueKey:"annuityDrawDate"},{name:"领取频率",type:"checkbox",configKey:["annuityDrawFrequencyList"],valueKey:"annuityDrawFrequency"},{name:"交费方式",type:"checkbox",configKey:["paymentFrequencyList"],valueKey:"paymentFrequency",ruleKey:"paymentTypeRule"},{name:"交费期间",type:"checkbox",configKey:["paymentPeriodValueList"],valueKey:"chargePeriod",ruleKey:"paymentPeriodRule",ruleValueKey:"chargePeriod"},{name:"保险期间",type:"checkbox",configKey:["insurancePeriodValueList"],valueKey:"coveragePeriod",ruleKey:"insurancePeriodRule",ruleValueKey:"chargePeriod"}];const ie={class:"pro-radio-wrap"},te=e({name:"ProductKeys"});var ue=V(e({...te,props:{originData:{default:()=>({})},modelValue:{default:()=>({})},riskInfo:{default:()=>({})},defaultValue:{default:()=>({})},useData:{default:()=>({})}},emits:["trialChange","inputChange"],setup(e,{emit:a}){const o=a,p=e,V=l(p.originData),h=l(p.modelValue);l(1);const L=i((()=>e=>{let a=w(p.originData,e);const l=w(p.defaultValue,e);return(null==l?void 0:l.length)&&(a=l),(a||[]).map((e=>{const a=l?l.find((a=>a.code===e.code)):null;return{label:e.value,value:e.code,disabled:!!(null==a?void 0:a.useFlag)&&1!==a.useFlag}}))})),C=()=>{le.forEach((e=>{const a=w(p.originData,e.configKey);"checkbox"===e.type&&a&&a.length>0&&!h.value.riskCode&&(h.value[e.valueKey]=a[0].code)}))};return t((()=>{C()})),u((()=>p.defaultValue),(e=>{(null==e?void 0:e.riskCode)&&(h.value=JSON.parse(JSON.stringify(e)))}),{deep:!0,immediate:!0}),u((()=>p.modelValue),(e=>{Object.assign(h.value,e)}),{deep:!0,immediate:!0}),u((()=>V.value),(e=>{C()}),{deep:!0,immediate:!0}),u((()=>JSON.stringify(h.value)),((e,a)=>{const l=e&&JSON.parse(e)||{};console.log("---v new = ",l);const i=a&&JSON.parse(a)||{};let t=null;le.forEach((e=>{l[e.valueKey]&&i[e.valueKey]&&l[e.valueKey]!==i[e.valueKey]&&(t||(t={key:e.valueKey,oldValue:i[e.valueKey],newValue:l[e.valueKey],riskCode:p.riskInfo.riskCode}))})),e&&o("trialChange",JSON.parse(e),t)}),{deep:!0,immediate:!0}),(e,a)=>{const l=f,i=k;return n(!0),s(b,null,g(c(le),(a=>(n(),s(b,null,[c(w)(e.originData,a.configKey)||c(w)(e.originData,a.ruleKey)?(n(),s("div",{key:e.riskInfo.riskCode+"_"+a.name},["checkbox"===a.type?(n(),v(i,{key:0,modelValue:h.value[a.valueKey],"onUpdate:modelValue":e=>h.value[a.valueKey]=e,label:a.name,name:a.valueKey,class:"risk-select-field"},{input:r((()=>[m("div",ie,[d(l,{modelValue:h.value[a.valueKey],"onUpdate:modelValue":[e=>h.value[a.valueKey]=e,e=>((e,a)=>{console.log("-------change",e,a)})(e,a.valueKey)],options:c(L)(a.configKey)},null,8,["modelValue","onUpdate:modelValue","options"])])])),_:2},1032,["modelValue","onUpdate:modelValue","label","name"])):y("",!0)])):y("",!0)],64)))),256)}}}),[["__scopeId","data-v-d3c1d622"]]);const oe={class:"com-risk-liabilityinfo"},ne={class:"item-wrap"},se={key:0},de=(e=>(D("data-v-7cfce85f"),e=e(),I(),e))((()=>m("div",{class:"cell-content"},null,-1))),re=e({name:"riskLiabilityInfo"});var me=V(e({...re,props:{dataSource:{default:()=>({})},modelValue:{default:()=>({})},dataSourceFolmulate:{default:()=>({})},params:{default:()=>({amountUnit:"",basicsAmount:"",basicsPremium:"",riskId:""})},defaultValue:{default:()=>({})}},emits:["trialChange"],setup(e,{emit:a}){const o=a,p=e,V=l({formInfo:p.dataSource,isCheckList:[],checkValueList:[],liabilityList:[],signLiabilityClick:[]}),D=(e,a)=>{V.value.signLiabilityClick.push({item:e,index:a})},I=(e,a)=>{const{riskLiabilityInfoVOList:l,riskLiabilityCollocationVOList:i}=p.dataSource,t=l[e].liabilityId,u=(i||[]).find((e=>e.relatedLiabilityId===t||e.collocationLiabilityId===t))||{};let o=null;u.collocationLiabilityId===t?(o=u.relatedLiabilityId,u.collocationType===T.YI_LAI&&(o=u.collocationLiabilityId)):o=u.collocationLiabilityId;const n=l.findIndex((e=>e.liabilityId===o));((e,a,l)=>{V.value.isCheckList[e]===`${A.YES}`?l===T.BANG_DING||l===T.YI_LAI?V.value.isCheckList[a]="1":V.value.isCheckList[a]="2":l===T.BANG_DING?V.value.isCheckList[a]="2":l===T.YI_LAI&&(V.value.isCheckList[a]=e!==a?"3":"2")})(e,n,u.collocationType),a(l[n],n,!0)},x=(e,a,l)=>{var i,t;const u=((null==(i=V.value)?void 0:i.liabilityList)||[]).map((e=>e.key)),o=0===(null==e?void 0:e.liabilityAttributeValueList.length)&&0===(null==e?void 0:e.formula.length),n=V.value.isCheckList[a];o&&-1===u.indexOf(a)&&n&&V.value.liabilityList.push({liabilityValue:e,key:a,isSwitchOn:V.value.isCheckList[a]}),"1"===n?D(e,a):V.value.signLiabilityClick.splice(a,1),-1!==u.indexOf(a)&&((null==(t=V.value)?void 0:t.liabilityList)||[]).forEach((e=>{e.key===a&&(e.isSwitchOn=V.value.isCheckList[a])})),l||I(a,x)},O=(e,a)=>{const l=e.liabilityAttributeValueList.filter((e=>e.displayValue===V.value.checkValueList[a])),i=JSON.parse(JSON.stringify(l))[0]||e.liabilityAttributeValueList[0],t={...e,liabilityValue:i};V.value.liabilityList.length>0&&Object.keys(V.value.checkValueList).indexOf(a)&&(V.value.liabilityList=V.value.liabilityList.filter((e=>e.key!==a))),V.value.checkValueList[a]=i.displayValue,V.value.liabilityList.push({liabilityValue:t,key:a,isSwitchOn:"1"})},S=i((()=>_(p.dataSourceFolmulate))),F=(e,a,l)=>{1===l?V.value.liabilityList.push({liabilityValue:{...e,liabilityValue:null==e?void 0:e.liabilityAttributeValueList[0]},key:a,isSwitchOn:"1"}):V.value.liabilityList.push({liabilityValue:{...e,liabilityValue:null==e?void 0:e.liabilityAttributeValueList[0]},key:a,isSwitchOn:"2"})};u((()=>S.value),((e,a)=>{var l,i,t;const u=null==(l=p.dataSourceFolmulate)?void 0:l.initialAmount,o=null==(i=p.dataSourceFolmulate)?void 0:i.initialPremium,n={amountUnit:p.params.amountUnit,basicsAmount:u,basicsPremium:o,riskId:p.params.riskId};((null==(t=null==p?void 0:p.dataSource)?void 0:t.riskLiabilityInfoVOList)||[]).map((async l=>{if(l.formula.length>0&&(u||o)&&((null==e?void 0:e.initialAmount)!==(null==a?void 0:a.initialAmount)||(null==e?void 0:e.initialPremium)!==(null==a?void 0:a.initialPremium))){const{code:e,data:a}=await N({...n,riskLiabilities:[l]});if("10000"===e){if(l.liabilityAttributeValueList=a[0].formulaResult,V.value.signLiabilityClick.length>0){const e=V.value.signLiabilityClick.find((e=>e.item.liabilityCode===l.liabilityCode));e&&O(e.item,e.index)}return{...l,liabilityAttributeValueList:a[0]}}return l}}))}),{deep:!0,immediate:!0}),u((()=>V.value.liabilityList),h((e=>{const a=V.value.liabilityList.filter((e=>"1"===e.isSwitchOn)).map((e=>({...e.liabilityValue})));o("trialChange",a)}),300),{deep:!0,immediate:!0}),t((()=>{var e;console.log("----mounted"),((null==(e=null==p?void 0:p.dataSource)?void 0:e.riskLiabilityInfoVOList)||[]).map(((e,a)=>{const l=e.liabilityAttributeValueList.length>0&&0===e.formula.length&&e.liabilityAttributeValueList[0].displayValue;return V.value.checkValueList[a]||(V.value.checkValueList[a]=l),1!=+e.showFlag&&V.value.liabilityList.push({liabilityValue:e,key:a,isSwitchOn:"1"}),1==+e.showFlag&&(1===e.attributeFlag&&2===e.insureFlag&&0===e.formula.length&&F(e,a,1),1===e.attributeFlag&&1===e.insureFlag&&0===e.formula.length&&F(e,a,2),2===e.attributeFlag&&1===(null==e?void 0:e.liabilityAttributeValueList.length)&&2===e.insureFlag&&F(e,a,1),2===e.attributeFlag&&1===(null==e?void 0:e.liabilityAttributeValueList.length)&&1===e.insureFlag&&F(e,a,2)),null}))}));const K=l([]);return u((()=>p.dataSource.riskLiabilityInfoVOList),h((e=>{K.value=(e||[]).map((e=>{const a=(p.dataSource.riskLiabilityCollocationVOList||[]).find((a=>a.collocationLiabilityId===e.liabilityId));return{...e,relation:null==a?void 0:a.collocationType}}))}),300),{deep:!0,immediate:!0}),u((()=>p.defaultValue),h((e=>{var a;(null==e?void 0:e.riskCode)&&e.liabilityList&&(V.value.signLiabilityClick=[],((null==(a=null==p?void 0:p.dataSource)?void 0:a.riskLiabilityInfoVOList)||[]).forEach(((a,l)=>{var i;const t=null==e?void 0:e.liabilityList.find((e=>e.liabilityCode===a.liabilityCode));t&&(V.value.isCheckList[l]="1",V.value.checkValueList[l]=null==(i=null==t?void 0:t.liabilityValue)?void 0:i.displayValue,1==+a.showFlag&&2==+a.optionalFlag?x(a,l):D(a,l))})))}),300),{deep:!0,immediate:!0}),(e,a)=>{const l=L,i=k,t=C;return n(),v(t,null,{default:r((()=>[m("div",oe,[m("div",ne,[(n(!0),s(b,null,g(c(K),((e,a)=>(n(),s("div",{key:a},[1!=+e.showFlag||2===e.attributeFlag&&1===(null==e?void 0:e.liabilityAttributeValueList.length)&&2===e.insureFlag?y("",!0):(n(),s("div",se,[(c(V).isCheckList[a]?"3"!==c(V).isCheckList[a]:e.relation!==c(T).YI_LAI)?(n(),v(i,{key:0,label:`${e.liabilityName}`,"label-width":"44%",name:"insuredRelation",class:"riskliab-select-field"},{input:r((()=>[1==+e.insureFlag?(n(),v(l,{key:0,modelValue:c(V).isCheckList[a],"onUpdate:modelValue":e=>c(V).isCheckList[a]=e,"active-value":"1","inactive-value":"2",size:"0.68rem",onClick:l=>x(e,a)},null,8,["modelValue","onUpdate:modelValue","onClick"])):y("",!0)])),_:2},1032,["label"])):y("",!0),1==+c(V).isCheckList[a]&&1===e.attributeFlag||1===e.attributeFlag&&2===e.insureFlag?(n(),v(i,{key:1,label:e.liabilityAttributeTypeDesc,"label-width":"44%",name:"insuredRelation",class:"riskliab-select-field-children"},{input:r((()=>[d(f,{modelValue:c(V).checkValueList[a],"onUpdate:modelValue":e=>c(V).checkValueList[a]=e,prop:{label:"displayValue",value:"displayValue"},options:(e.formula.length,e.liabilityAttributeValueList),"is-simply":!0,onClick:l=>O(e,a)},null,8,["modelValue","onUpdate:modelValue","options","onClick"])])),_:2},1032,["label"])):y("",!0)]))])))),128))])]),de])),_:1})}}}),[["__scopeId","data-v-7cfce85f"]]);const ce=e({name:"InsureInfos"}),ve=e({...ce,props:{originData:{default:()=>({})},defaultValue:{default:()=>({})},trialResult:{default:0}},emits:["trialChange"],setup(e,{expose:i,emit:s}){const m=s,p=e,y=l(null),b=l({}),V=l({}),k=a({personalInfo:{},basicsAmount:"",basicsPremium:"",defaultValues:p.defaultValue,changeData:null,sValues:b.value});x("premium"),V.value=x("enumList")||{},t((()=>{}));const f=e=>{p.originData.mainRiskFlag,b.value.riskCategory=p.originData.riskCategory,b.value.riskCode=p.originData.riskCode,b.value.riskId=p.originData.riskId,b.value.riskType=p.originData.riskType,b.value.riskName=p.originData.riskName,b.value.riskType=p.originData.riskType,b.value.mainRiskCode=p.originData.mainRiskCode,b.value.mainRiskId=p.originData.mainRiskId,b.value.exemptFlag=p.originData.exemptFlag,e?m("trialChange",b.value,e):m("trialChange",b.value)},g=(e,a)=>{a?b.value[a.key]=a.newValue:P(e).forEach((a=>{b.value[a]=e[a]})),f(a)},h=e=>{var a,l,i;1==+(null==(i=null==(l=null==(a=p.originData)?void 0:a.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO)?void 0:i.saleMethod)?k.basicsAmount=null==e?void 0:e.initialAmount:k.basicsAmount=null==e?void 0:e.initialPremium,P(e).forEach((a=>{b.value[a]=e[a]})),f()},L=e=>{b.value.liabilityList=e,f()};return u((()=>p.defaultValue),((e,a)=>{o(e,a)||(k.defaultValues=_(e),b.value={...e})}),{deep:!0,immediate:!0}),u((()=>b.value),(e=>{k.sValues=e}),{deep:!0,immediate:!0}),i({validate:async()=>{var e;await(null==(e=y.value)?void 0:e.validate())}}),(e,a)=>{const l=O("dev");return S((n(),v(l,null,{default:r((()=>{var l,i,t,u,o;return[d(c(ae),{modelValue:c(k).sValues,"onUpdate:modelValue":a[0]||(a[0]=e=>c(k).sValues=e),"origin-data":null==(i=null==(l=e.originData)?void 0:l.productRiskInsureLimitVO)?void 0:i.amountPremiumConfigVO,"default-value":c(k).defaultValues,"trial-result":e.trialResult,onTrialChange:h},null,8,["modelValue","origin-data","default-value","trial-result"]),d(c(ue),{"v-model":c(k).sValues,"use-data":c(k).sValues,"origin-data":e.originData.productRiskInsureLimitVO,"risk-info":e.originData,"default-value":c(k).defaultValues,onTrialChange:g},null,8,["v-model","use-data","origin-data","risk-info","default-value"]),d(c(me),{"data-source-folmulate":c(b),"data-source":e.originData,params:{amountUnit:null==(u=null==(t=e.originData)?void 0:t.productRiskInsureLimitVO)?void 0:u.amountPremiumConfigVO.displayUnit,basicsAmount:c(k).basicsAmount,basicsPremium:c(k).basicsPremium,riskId:null==(o=e.originData)?void 0:o.riskId},"default-value":c(k).defaultValues,onTrialChange:L},null,8,["data-source-folmulate","data-source","params","default-value"])]})),_:1},512)),[[F,e.originData.exemptFlag===c(A).NO]])}}});export{ve as _};
