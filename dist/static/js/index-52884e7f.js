import{E as e,d as a,c as t,y as o,f as l,z as n,g as s,h as r,ag as d,ah as i,a as c,u,r as v,a0 as p,ax as m,e as f,w as I,i as h,a1 as y,T as w,ay as g,az as C,b$ as b}from"./index-b6496322.js";import{f as N}from"./infoCollection-32a91bdc.js";import{c as O,_ as U}from"./close-cb5f1788.js";import{O as x}from"./order-d10f3bfa.js";import{h as $,i as _,c as S,s as k,f as D,E as L}from"./trial-1adde4f4.js";import{t as j}from"./theme-ea709837.js";import{n as V,i as P,m as R,e as z,g as B,t as q,k as E,l as F,f as H,h as J}from"./utils-97e46e98.js";import{p as T}from"./product-8d2efc9e.js";import"./pdfh5-008ca364.js";import"./trial-3646e1de.js";const K={class:"com-field-info"},M={class:"title"},G={class:"desc"};var W=e(a({__name:"index",props:{title:{type:String,default:""},desc:{type:String,default:""}},setup:e=>(a,s)=>(t(),o("div",K,[l("div",M,n(e.title),1),l("div",G,n(e.desc),1)]))}),[["__scopeId","data-v-2ff3e068"]]);const Y=e=>(d("data-v-ed9081ee"),e=e(),i(),e),A={key:0,class:"pro-modal"},Q=Y((()=>l("div",{class:"pro-overlay"},null,-1))),X={class:"pro-modal-wrapper"},Z=Y((()=>l("div",{class:"pro-modal-content"},[l("p",null,"恭喜您"),l("p",null,"保障升级成功")],-1))),ee=["src"];var ae=e(a({__name:"index",props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(e,{emit:a}){const n=e,d=()=>{a("on-close")},i=()=>{a("on-confirm")};return(e,a)=>n.isShow?(t(),o("div",A,[Q,l("div",X,[l("div",{class:"pro-modal-body"},[Z,l("div",{class:"pro-modal-btn",onClick:i},"我知道了")]),l("div",{class:"pro-modal-close",onClick:d},[l("img",{src:s(O)},null,8,ee)])])])):r("",!0)}}),[["__scopeId","data-v-ed9081ee"]]);const te={class:"page-activity-upgrade"},oe=["src"],le={class:"container"},ne={class:"main-form"};var se=e(a({__name:"index",setup(e){const a=c(),o=u(),{productCode:n="BWYL2022",tenantId:r,orderNo:d,agentCode:i="",from:O}=o.query;console.log("upload--route.query",o.query);const K=v(),M=v(),G=v(),Y=v(),A=v(),Q=v(),X=v(!1),Z="check"===O,ee=v(!1),se=v(0),re=v("");let de="";const ie=()=>{X.value=!1},ce=e=>`${b}/pay?orderNo=${e}&saleUserId=${i}&tenantId=${r}`,ue=()=>{a.replace(`/pay?orderNo=${re.value}&saleUserId=${i}&tenantId=${r}`)},ve=async e=>{try{w.loading({forbidClick:!0,message:"升级中",duration:15e3});const e=await(async()=>{var e,a,t,o,l;const n=B({tenantId:r,applicationNo:G.value.applicationNo,policyNo:G.value.policyNo,saleUserId:i,saleChannelId:G.value.saleChannelId,orderStatus:x.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:K.value,insureDetail:M.value,paymentMethod:null==(a=null==(e=G.value.extInfo)?void 0:e.extraInfo)?void 0:a.paymentMethod,renewalDK:null==(o=null==(t=G.value.extInfo)?void 0:t.extraInfo)?void 0:o.renewalDK,iseeBizNo:de,successJumpUrl:"",premium:Y.value,holder:{...G.value.tenantOrderHolder,socialFlag:G.value.tenantOrderHolder.extInfo.hasSocialInsurance},insured:{...G.value.tenantOrderInsuredList[0],socialFlag:G.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance},tenantOrderRiskList:q({tenantId:r,riskList:E(F(M.value.productRiskVoList[0].riskDetailVOList),K.value),riskPremium:{},productId:null==(l=K.value)?void 0:l.id})}),s=await k(n),{code:d,data:c}=s;return"10000"===d?c.data:""})();await $({tenantId:r,applicationNo:G.value.applicationNo});if(re.value=e,console.log(re.value,"orderNoUp.value===",e),Q.value){if(Z){const a=encodeURIComponent(encodeURIComponent(ce(e))),t=`${Q.value}&successUrl=${a}`;window.location.href=t}else{const e=encodeURIComponent(encodeURIComponent(window.location.href)),a=`${Q.value}&failUrl=${e}`;window.location.href=a}w.clear()}else(async e=>{const t=H({tenantId:r,premium:Y.value,orderDetail:G.value,productDetail:K.value,insureDetail:M.value,successJumpUrl:ce(e),iseeBizNo:de}),o=await L({orderNo:e,...t}),{code:l,data:s}=o;"10000"===l&&(Z?a.replace(`/internet/orderDetail?orderNo=${e}&productCode=${n}&tenantId=${r}`):(w.clear(),ue()))})(e)}catch(t){console.log(t),w.clear()}},pe=async e=>{Z?ee.value=!0:ve()},me=()=>{w.loading({forbidClick:!0,duration:2e4,message:"试算中"});const e=T({productCode:n,withInsureInfo:!0,tenantId:r}),a=_({productCode:n}),t=S({orderNo:d,tenantId:r});Promise.all([e,a,t]).then((([e,a,t])=>{var o;"10000"===e.code&&(K.value=e.data,document.title=(null==(o=e.data)?void 0:o.productFullName)||""),"10000"===a.code&&(M.value=a.data),"10000"===t.code&&(G.value=t.data,A.value=t.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),(async()=>{try{const e=H({tenantId:r,premium:Y.value,orderDetail:G.value,productDetail:K.value,insureDetail:M.value,successJumpUrl:""},J),a=await D(e),{code:t,data:o}=a;"10000"===t&&(Y.value=o.installmentPremium,Q.value=o.signUrl)}catch(e){console.log(e)}finally{w.clear()}})()}))};return p((()=>{me(),setTimeout((async()=>{de=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const o=g,n=C,r=m;return t(),f(r,{"theme-vars":s(j)},{default:I((()=>{var e,t,r,d,i,c,u,v,p,m;return[l("div",te,[l("img",{src:null==(t=null==(e=s(K))?void 0:e.tenantProductInsureVO)?void 0:t.banner[0],class:"banner"},null,8,oe),l("div",le,[l("div",ne,[h(W,{title:"姓名",desc:s(V)(null==(d=null==(r=s(G))?void 0:r.tenantOrderInsuredList)?void 0:d[0].name)},null,8,["desc"]),h(W,{title:"证件号码",desc:s(P)(null==(c=null==(i=s(G))?void 0:i.tenantOrderInsuredList)?void 0:c[0].certNo)},null,8,["desc"]),h(W,{title:"手机号码",desc:s(R)(null==(v=null==(u=s(G))?void 0:u.tenantOrderHolder)?void 0:v.mobile)},null,8,["desc"]),h(W,{title:"每月保费",desc:`${s(z)(s(Y)||0)}元 / 每月`},null,8,["desc"]),h(n,{label:"有无社保",name:"name",required:"",placeholder:"请选择"},{input:I((()=>[h(o,{modelValue:s(A),"onUpdate:modelValue":a[0]||(a[0]=e=>y(A)?A.value=e:null),disabled:!0,options:s(N)},null,8,["modelValue","options"])])),_:1}),l("div",{class:"submit",onClick:pe})])]),h(ae,{"is-show":s(X),onOnConfirm:ue,onOnClose:ie},null,8,["is-show"])]),h(U,{show:s(ee),"onUpdate:show":a[1]||(a[1]=e=>y(ee)?ee.value=e:null),"content-list":null==(m=null==(p=s(K))?void 0:p.tenantProductInsureVO)?void 0:m.attachmentVOList,"active-index":s(se),text:"我已逐页阅读并确认告知内容",onSubmit:ve},null,8,["show","content-list","active-index"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-942be77c"]]);export{se as default};
