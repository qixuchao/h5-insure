import{_ as M}from"./index-e4c11be9.js";import{b as R,e as z,q as O}from"./select-105475a6.js";import{u as G,h as H}from"./index-b8742a0a.js";import{g as L,C as y,a4 as C,x as I,aa as K,r as h,k as i,h as g,j as v,y as r,m as w,z as f,s as N,n as D,p as A,E as P,I as Q,F as W,B as F,M as X}from"./vendor-e9263418.js";const Y={class:"com-pop-select"},Z={class:"title"},ee=F(" \u641C\u7D22 "),ae={class:"back-icon"},te=["src"],le={class:"close-img"},oe=["src"],ne={class:"search"},se=["onClick"],ce={class:"footer"},ue=F("\u786E\u5B9A"),re=L({props:{title:{type:String,default:"\u641C\u7D22"},dataSource:{type:Array,default:()=>[]},dataIndex:{type:String,default:"name"},keyIndex:{type:String,default:"id"},visible:{type:Boolean,required:!0,default:()=>!1},mode:{type:String,default:"single"},showBackIcon:{type:Boolean,default:!1},showNextIcon:{type:Boolean,default:!0},selectValue:{type:Array,default:()=>[]},searchCurrentInfo:{type:Boolean,default:!1},clearSelect:{type:Boolean,default:!1},isTarget:{type:Boolean,default:!1}},emits:["on-submit","on-close","update:visible","onItemClick","onBackIconClick","onClear","onSearch"],setup(u,{emit:s}){const a=u,{getIconUrl:o}=G(),n=y(a.mode==="single"?[]:[]),c=y(""),k=e=>!(e.memberType==="A"||a.isTarget&&e.memberType==="T"||a.showNextIcon===!1);C(n,(e,l)=>{JSON.stringify(e)!==JSON.stringify(l)&&a.mode==="single"&&(n.value=e[e.length-1]?[e[e.length-1]]:[])});const d=()=>{s("on-close"),s("update:visible",!1)},S=e=>{s("onItemClick",e)},x=()=>{a.mode==="single"?s("on-submit",a.dataSource.filter(e=>n.value.includes(e[a.keyIndex]))):s("on-submit",a.dataSource.filter(e=>n.value.includes(e[a.keyIndex])))};I(()=>n.value.length);const _=I(()=>a.searchCurrentInfo?a.dataSource.filter(e=>e[a.dataIndex]&&e[a.dataIndex].includes(c.value)):a.dataSource),B=I(()=>(a.mode==="multiple","van-checkbox-group")),T=I(()=>(a.mode==="multiple","van-checkbox"));C(()=>a.dataSource,(e,l)=>{JSON.stringify(e)!==JSON.stringify(l)&&(n.value=a.mode==="single"?[]:[])}),C(()=>a.visible,e=>{e&&a.selectValue&&(n.value=Object.keys(K(a.selectValue)).length!==0?a.selectValue.map(l=>l[a.keyIndex]):[])},{immediate:!0}),C(()=>a.selectValue,(e,l)=>{JSON.stringify(e)!==JSON.stringify(l)&&e[0]&&(n.value=[e[0].memberCode])},{immediate:!0});const V=()=>{s("onBackIconClick")},t=e=>{console.log(e),s("onSearch",e)},m=()=>{s("onClear")};return(e,l)=>{const b=h("van-search"),E=h("van-icon"),J=h("van-cell"),q=h("van-cell-group"),U=h("van-button"),$=h("van-popup");return i(),g($,{show:u.visible,round:"",position:"bottom",class:"select-comp-popup",style:{height:"70%"},onClickCloseIcon:d},{default:v(()=>[r("div",Y,[r("div",Z,[ee,r("div",ae,[u.showBackIcon?(i(),w("div",{key:0,class:"back-icon-left",onClick:V},[r("img",{src:f(R),alt:""},null,8,te)])):N("",!0)]),r("div",le,[r("img",{src:f(H),alt:"",onClick:d},null,8,oe)])]),r("div",ne,[D(b,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=p=>c.value=p),shape:"round",clearable:"","left-icon":f(o)("target.searchImg"),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5173\u952E\u8BCD",onSearch:t,onClear:m},null,8,["modelValue","left-icon"])]),(i(),g(A(f(B)),{modelValue:n.value,"onUpdate:modelValue":l[1]||(l[1]=p=>n.value=p)},{default:v(()=>[D(q,{inset:""},{default:v(()=>[(i(!0),w(W,null,P(f(_),(p,j)=>(i(),g(J,{key:j,class:"cell"},{title:v(()=>[(i(),g(A(f(T)),{shape:a.mode==="multiple"?"square":"round",name:p[u.keyIndex],"label-disabled":!0},{default:v(()=>[r("div",{onClick:ie=>S(p)},Q(p[u.dataIndex]),9,se)]),_:2},1032,["shape","name"]))]),"right-icon":v(()=>[k(p)?(i(),g(E,{key:0,name:"arrow",color:"#DDDDDD",style:{marginRight:"15px"}})):N("",!0)]),_:2},1024))),128))]),_:1})]),_:1},8,["modelValue"])),f(_).length===0?(i(),g(M,{key:0,"empty-img":f(z),title:"\u6CA1\u6709\u627E\u5230\u76F8\u5173\u4FE1\u606F~","empty-class":"empty-select"},null,8,["empty-img"])):N("",!0),r("div",ce,[D(U,{type:"primary",class:"btn",onClick:x},{default:v(()=>[ue]),_:1})])])]),_:1},8,["show"])}}}),ve=L({props:{visible:{type:Boolean,default:!1},mode:{type:String,default:"single"},dataValue:{type:Array,default:()=>[]},isTarget:{type:Boolean,default:!1}},emits:["on-submit","update:visible"],setup(u,{emit:s}){const a=u,o=y([]),n=y({}),c=y([]),k=y(!1);X(()=>{k.value=a.isTarget});const d=()=>{var t,m;O({directLevel:1,memberType:(t=o.value[o.value.length-1])==null?void 0:t.memberType,memberCode:(m=o.value[o.value.length-1])==null?void 0:m.memberCode}).then(e=>{const{status:l}=e;l===200&&(console.log(a.dataValue,">>>>>>>>>>>>>"),a.dataValue.length>0?(c.value=a.dataValue,n.value=a.dataValue):a.isTarget?c.value=e.data.data.filter(b=>b.memberType!=="A"):c.value=e.data.data)})};C(()=>a.visible,t=>{t&&d()});const S=t=>{n.value=t,s("on-submit",t),s("update:visible",!1)},x=t=>{var m;console.log(t),O({directLevel:1,keyword:t,memberType:t?"ALL":"",memberCode:(m=o.value[o.value.length-1])==null?void 0:m.memberCode}).then(e=>{const{status:l}=e;l===200&&(a.isTarget?c.value=e.data.data.filter(b=>b.memberType!=="A"):c.value=e.data.data)})},_=()=>{console.log("clear"),d()},B=()=>{s("update:visible",!1)},T=t=>{a.isTarget?t.hasSubordinate&&t.memberType!=="T"&&(o.value.push({memberType:t.memberType,memberCode:t.memberCode}),console.log(o.value,"agencyIdList.value"),d()):t.hasSubordinate&&(o.value.push({memberType:t.memberType,memberCode:t.memberCode}),console.log(o.value,"agencyIdList.value"),d())},V=()=>{o.value.length>0&&(o.value.pop(),d())};return(t,m)=>(i(),g(re,{visible:u.visible,"data-source":c.value,"data-index":"agencyName",mode:u.mode,"clear-select":!0,"show-back-icon":o.value.length>0,"select-value":n.value,"is-target":k.value,"key-index":"agencyId",onOnSubmit:S,onOnClose:B,onOnItemClick:T,onOnBackIconClick:V,onOnSearch:x,onOnClear:_},null,8,["visible","data-source","mode","show-back-icon","select-value","is-target"]))}});export{ve as _,re as a};
