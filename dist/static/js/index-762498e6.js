var J=Object.defineProperty,Q=Object.defineProperties;var H=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var b=(u,t,o)=>t in u?J(u,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):u[t]=o,_=(u,t)=>{for(var o in t||(t={}))W.call(t,o)&&b(u,o,t[o]);if(L)for(var o of L(t))X.call(t,o)&&b(u,o,t[o]);return u},k=(u,t)=>Q(u,H(t));import{g as K,a9 as Z,O as ee,E as m,d as te,M as oe,h as se,r as E,j as f,k as N,m as v,p as g,n as q,G as I,A as x,F as U,z as C,J as ne,C as P,T as F,L as ue}from"./vendor-667a94d7.js";import{_ as ie,l as O,r as ae,T as le,U as re,n as ce,P as pe,a0 as _e}from"./index-cf1a5775.js";import{l as Ee,g as fe}from"./inform-f7c231e2.js";import{s as ve}from"./useStorage-84438cf3.js";import{s as ge}from"./verify-365ea99d.js";import{A as Ce,d as de,e as Te}from"./notice-0d700074.js";const Be={class:"date"},me={class:"inform-file"},ye={class:"tips"},he=P(" \u60A8\u7684\u7B7E\u540D\u5C06\u88AB\u7528\u4E8E"),De=P("\u6587\u4EF6 "),Ae={class:"footer-button"},ke=P("\u4E0B\u4E00\u6B65"),Ne=K({setup(u){const t=Z(),o=ee(),{productCode:xe="MMBBSF",agentCode:R="65434444",tenantId:d="9991000007",agencyCode:Fe="3311222",insurerCode:y="zhongan",productCategory:S=1,templateId:Y=1,orderNo:h="2022080217103534947"}=o.query,p=m(null),D=m(!1),G=te().format("YYYY-MM-DD"),T=m(""),A=m(),j=()=>{var s;(s=p.value)==null||s.clear()},i=oe({noticeType:"",materialSource:"",noticeList:[],pageData:{}}),V=()=>{ae({orderNo:h,saleUserId:R,tenantId:d}).then(({code:s,data:n})=>{s==="10000"&&(Object.assign(i.pageData,n),n.tenantOrderAttachmentList.forEach(a=>{a.category===le.ELECTRIC_SIGN&&a.objectType===re.AGENT&&p.value.setDataURL(a.fileBase64)}))})},w=s=>{console.log(s);const{id:n,objectType:a}=s,c={1:"pdf",2:"richText",3:"link"};fe({insurerCode:y,id:n,objectType:a,productCategory:S,orderNo:h,tenantId:d}).then(({code:r,data:e})=>{r==="10000"&&(console.log(e),(e==null?void 0:e[0].questionType)===Te?(T.value="question",A.value=e):((e==null?void 0:e[0].textType)===1&&(e==null?void 0:e[0].content.includes("png"))?T.value="picture":T.value=c[e==null?void 0:e[0].textType],A.value=e==null?void 0:e[0].content))})};se(()=>{V(),Ee({insurerCode:y,orderNo:h,productCategory:S,tenantId:d,noticeType:Ce,objectType:de}).then(({code:s,data:n})=>{s==="10000"&&(i.noticeList=[...i.noticeList,...n])})});const $=s=>{ve.set("questionData",s),t.push({path:"/healthNotice",query:_({questionnaireType:s.questionnaireType},o.query)})},z=()=>{var a,c;if(!(i.noticeList&&i.noticeList.every(r=>r.isDone===1))){F("\u8BF7\u5B8C\u6210\u6240\u6709\u544A\u77E5\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if((a=p.value)==null?void 0:a.isEmpty()){F("\u8BF7\u5B8C\u6210\u4EE3\u7406\u4EBA\u7B7E\u5B57\u8FDB\u884C\u4E0B\u4E00\u6B65");return}if(!D.value){F("\u8BF7\u52FE\u9009\u540C\u610F\u7B7E\u540D");return}const n=(c=p.value)==null?void 0:c.save();ge("AGENT",n,i.pageData.id,d).then(r=>{r&&ce(k(_({},i.pageData),{extInfo:k(_({},i.pageData.extInfo),{templateId:Y,pageCode:"salesNotice"}),venderCode:y})).then(({code:e,data:B})=>{e==="10000"&&B.pageAction.pageAction==="jumpToPage"&&t.push({path:pe[B.pageAction.data.nextPageCode],query:_({},o.query)})})})};return(s,n)=>{const a=E("van-cell"),c=E("ProSign"),r=E("van-checkbox"),e=E("van-button"),B=E("ProPageWrap");return f(),N(B,{class:"page-salesman-inform"},{default:v(()=>[g(O,{title:"\u8425\u9500\u5458\u544A\u77E5\u4E66"},{default:v(()=>[(f(!0),q(U,null,I(x(i).noticeList,l=>(f(),N(a,{key:l.id,class:ue({"is-active":l.isDone===2}),title:`\u300A${l.title}\u300B`,"is-link":"",value:`${l.isDone===1?"\u5DF2\u5B8C\u6210":"\u53BB\u5B8C\u6210"}`,onClick:M=>$(l)},null,8,["class","title","value","onClick"]))),128))]),_:1}),g(O,{title:"\u8425\u9500\u5458\u7B7E\u5B57","show-divider":!1,"show-line":!1},{extra:v(()=>[C("div",{class:"resign",onClick:j},"\u91CD\u7B7E")]),default:v(()=>[g(c,{ref_key:"agentSignRef",ref:p,selector:"sign2"},null,512),C("div",Be,"\u7B7E\u540D\u65E5\u671F\uFF1A "+ne(x(G)),1)]),_:1}),C("div",me,[g(r,{modelValue:D.value,"onUpdate:modelValue":n[0]||(n[0]=l=>D.value=l),shape:"square"},null,8,["modelValue"]),C("p",ye,[he,(f(!0),q(U,null,I(x(i).noticeList,(l,M)=>(f(),N(_e,{key:M,class:"file",title:`\u300A${l.title}\u300B`,content:A.value,type:T.value,onClick:Pe=>w(l)},null,8,["title","content","type","onClick"]))),128)),De])]),C("div",Ae,[g(e,{type:"primary",block:"",onClick:z},{default:v(()=>[ke]),_:1})])]),_:1})}}});var Oe=ie(Ne,[["__scopeId","data-v-6f2238ba"]]);export{Oe as default};
