import{d as Te,h as J,r as P,$ as K,A as k,R as he,k as z,ag as be,m as n,s as o,B as s,F as M,C as t,H as Q,M as ne,L as w,x,n as X,G as re,t as I,p as H,I as xe,a5 as me,a6 as pe,Z as Be,_ as st,N as Pe,U as ot,T as lt,aa as it,P as rt,l as ut,j as ct,D as dt}from"./vendor-902054a7.js";import{_ as Z,e as Ae,i as ce,a7 as mt,C as ye,I as Re,K as pt,a1 as ft}from"./index-3a9ce3bd.js";import{C as _e,k as ae,l as se,m as vt,S as we,R as Ee,g as _t}from"./infoCollection-0841e133.js";import{p as $e,i as yt,n as ht}from"./trial-378270e6.js";import{p as Pt}from"./product-d07530f9.js";import{o as Me,g as It,a as Ct,v as Dt,r as gt,t as Ot}from"./utils-fa410f53.js";import{t as qe,u as kt}from"./theme-fdbb0f53.js";import{B as Se}from"./index-27bf1d4b.js";import{P as Vt}from"./index-5107d13b.js";import{L as Ft}from"./loading-1c9c1d7b.js";import{_ as Lt,a as wt}from"./index-158f1935.js";import{u as Et}from"./useDicData-89e61451.js";import{P as $t}from"./index-35bad872.js";import{_ as St}from"./index-2b0aecd9.js";import"./useStorage-9696cc10.js";import"./trial-40f2c4e1.js";import"./check-detail-c292a89b.js";import"./relativeTime-cdc592a9.js";const ie=(c,g="YYYY-MM-DD")=>Te(c).format(g),le=(c,g=0,i="day",l="YYYY-MM-DD")=>Te(c).add(g,i).format(l);const Nt=c=>(me("data-v-5e998d80"),c=c(),pe(),c),Tt={class:"guarantee-list"},bt=Nt(()=>s("span",null,"\u4FDD\u969C\u8BA1\u5212",-1)),xt={key:0,class:"picture-payment-content"},Bt=["onClick"],At=["src"],Rt=["src"],Mt={key:1,class:"plan-list"},qt=["onClick"],Ut={key:2,class:"feerate-view"},Yt={class:"guarantee-detail"},Ht={key:0,class:"plan-list"},jt=["onClick"],Gt={key:1},zt={class:"extinfo-info-list"},Wt={class:"content"},Qt=J({props:{dataSource:{type:Object,default:()=>{}},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:5},activePlanCode:{type:String,default:""},isMultiplePlan:{type:Boolean,default:!1}},emits:["update-active-plan"],setup(c,{emit:g}){var d;const i=c,l=P((d=i.dataSource)==null?void 0:d.planList),p=P(i.activePlanCode);K(()=>i.dataSource,()=>{var e;i.isMultiplePlan&&(l.value=(e=i.dataSource)==null?void 0:e.planList)},{immediate:!0});const O=P([]),y=P([]),r=P(),R=k(()=>i.isMultiplePlan?i.dataSource.planList.map(e=>({...e.planPicList,planCode:e.planCode,planName:e.planName})):[]);K([()=>i.dataSource,()=>i.activePlanCode],()=>{var e,m,C,T;if(p.value=i.activePlanCode,!i.isMultiplePlan)O.value=(e=i.dataSource)==null?void 0:e.planInsureVO.guaranteeItemVOS,y.value=(m=i.dataSource)==null?void 0:m.planInsureVO.extInfoVOList,r.value=(C=i.dataSource)==null?void 0:C.planInsureVO.productPremiumVOList[0];else if(l.value&&l.value.length>0){let U=0;const te=l.value.findIndex(F=>F.planCode===p.value);te>-1&&(U=te),O.value=l.value[U].guaranteeItemVOS,y.value=l.value[U].extInfoVOList,r.value=(T=l.value[U])==null?void 0:T.productPremiumVOList[0]}},{immediate:!0,deep:!0});const E=k(()=>{var e;return((e=i.dataSource)==null?void 0:e.rateUri)||""}),f=k(()=>!!(r.value&&r.value.paymentFrequencyValue&&r.value.premiumUnit&&!!E)),[v,$]=he(!1),B=k(()=>{var e;return!O.value||!((e=O.value)!=null&&e.length)?!1:O.value.length>i.count?i.isShowClose?!0:!v.value:!1}),j=()=>{$()},G=k(()=>{var e;return!O.value||!((e=O.value)!=null&&e.length)?[]:O.value.length<=i.count||v.value?O.value:O.value.slice(0,i.count)}),q=e=>{p.value=e,g("update-active-plan",e)},S=P(!1),N=()=>{S.value=!0},a=()=>{Me({fileType:"pdf",feeFileUri:E.value})};return(e,m)=>{var te,F;const C=z("ProCell"),T=z("ProPopup"),U=be("dompurify-html");return n(),o(M,null,[s("div",Tt,[s("div",{class:"header"},[bt,s("span",{onClick:N},"\u67E5\u770B\u8BE6\u60C5")]),c.isMultiplePlan?(n(),o(M,{key:0},[t(R).length>0?(n(),o("div",xt,[(n(!0),o(M,null,Q(t(R),h=>(n(),o("div",{key:h.planCode,class:ne("picture-payment-item"),onClick:b=>q(h.planCode)},[p.value==h.planCode?(n(),o("img",{key:0,src:h.selectedPic},null,8,At)):(n(),o("img",{key:1,src:h.unSelectedPic},null,8,Rt))],8,Bt))),128))])):(n(),o("div",Mt,[(n(!0),o(M,null,Q(l.value,(h,b)=>(n(),o("div",{key:`${h.planCode}_${b}`,class:ne(`plan-list-item ${h.planCode===p.value?"plan-list-item-active":""}`),onClick:Y=>q(h.planCode)},[s("span",null,w(h.planName),1)],10,qt))),128))]))],64)):x("",!0),(n(!0),o(M,null,Q(t(G),(h,b)=>(n(),X(C,{key:b,class:"guarantee-item",title:h.title,content:h.desc,border:!1},null,8,["title","content"]))),128)),t(B)?(n(),o("div",{key:1,class:"show-more",onClick:j},[re(w(t(v)?"\u6536\u8D77":"\u67E5\u770B\u66F4\u591A")+" ",1),I(Ae,{name:"down",class:ne(["icon",{showMore:t(v)}])},null,8,["class"])])):x("",!0),t(f)?(n(),o("div",Ut,[s("span",null,w(`${((te=r.value)==null?void 0:te.paymentFrequencyValue)||""}${((F=r.value)==null?void 0:F.premiumUnit)||""}`),1),t(E)?(n(),o("span",{key:0,onClick:a},"\u67E5\u770B\u4FDD\u8D39")):x("",!0)])):x("",!0)]),I(ce),I(T,{show:S.value,"onUpdate:show":m[0]||(m[0]=h=>S.value=h),title:"\u4FDD\u969C\u8BE6\u60C5",class:"guarantee-popup"},{default:H(()=>[s("div",Yt,[c.isMultiplePlan?(n(),o("div",Ht,[(n(!0),o(M,null,Q(l.value,(h,b)=>(n(),o("div",{key:`${h.planCode}_${b}`,class:ne(`plan-list-item ${h.planCode===p.value?"plan-list-item-active":""}`),onClick:Y=>q(h.planCode)},[s("span",null,w(h.planName),1)],10,jt))),128))])):x("",!0),y.value&&y.value.length>0?(n(),o("div",Gt,[s("div",zt,[(n(!0),o(M,null,Q(y.value,(h,b)=>(n(),X(C,{key:b,title:h.name,content:h.description,border:!1,size:"small"},null,8,["title","content"]))),128))]),I(ce)])):x("",!0),(n(!0),o(M,null,Q(O.value,(h,b)=>(n(),o("div",{key:b,class:"guarantee-item"},[I(C,{title:h.title,content:h.desc,border:!1,size:"small"},null,8,["title","content"]),xe(s("div",Wt,null,512),[[U,h.content]])]))),128))])]),_:1},8,["show"])],64)}}});var Kt=Z(Qt,[["__scopeId","data-v-5e998d80"]]);const Xt={class:"com-custom-card"},Jt={class:"title"},Zt=J({props:{title:{type:String,required:!0}},setup(c){return(g,i)=>(n(),o("div",Xt,[s("div",Jt,w(c.title),1),s("div",null,[Be(g.$slots,"default",{},void 0,!0)])]))}});var Ne=Z(Zt,[["__scopeId","data-v-059c21ee"]]);const en={class:"question"},tn={class:"title"},nn=J({props:{name:{type:String,default:""},question:{type:String,default:""},answer:{type:String,default:""}},setup(c){return(g,i)=>{const l=z("ProSvg"),p=z("van-collapse-item");return n(),X(p,{name:c.name,class:"com-question-item"},{title:H(()=>[s("div",en,[I(l,{name:"question"}),s("div",tn,w(c.question),1)])]),default:H(()=>[re(" "+w(c.answer),1)]),_:1},8,["name"])}}});var an=Z(nn,[["__scopeId","data-v-0d7ea124"]]);const sn={class:"com-question"},on=J({props:{list:{type:Array,default:()=>[]}},setup(c){const g=c,[i,l]=he(!1),p=P([]),O=()=>{l()},y=k(()=>g.list.length<=4||i.value?g.list:g.list.slice(0,4));return(r,R)=>{const E=z("van-collapse");return n(),o("div",sn,[I(E,{modelValue:p.value,"onUpdate:modelValue":R[0]||(R[0]=f=>p.value=f)},{default:H(()=>[(n(!0),o(M,null,Q(t(y),(f,v)=>(n(),X(an,{key:v,name:v.toString(),question:f.title,answer:f.desc},null,8,["name","question","answer"]))),128))]),_:1},8,["modelValue"]),c.list.length>4?(n(),o("div",{key:0,class:"show-more",onClick:O},[re(w(t(i)?"\u6536\u8D77":"\u5C55\u5F00")+" ",1),I(Ae,{name:"down",class:ne(["icon",{showMore:t(i)}])},null,8,["class"])])):x("",!0)])}}});var ln=Z(on,[["__scopeId","data-v-1b7e97e9"]]);const rn={class:"spec"},un=["src"],cn={key:1,class:"spec"},dn=["src"],mn=J({props:{isCheck:{type:Boolean,default:!1},url:{type:String,default:""},detail:{type:Object,default:()=>{}}},setup(c,{expose:g}){const i=c,l=P(),p=P([{title:"\u4EA7\u54C1\u4EAE\u70B9",slotName:"tab1"},{title:"\u7406\u8D54\u8BF4\u660E",slotName:"tab2"},{title:"\u6211\u8981\u6295\u4FDD",slotName:"tab3"}]),O=k(()=>{var f,v,$,B;return((v=(f=i.detail)==null?void 0:f.tenantProductInsureVO)==null?void 0:v.spec)&&((B=($=i.detail)==null?void 0:$.tenantProductInsureVO)==null?void 0:B.spec.length)>0}),y=k(()=>{var v,$,B,j,G,q,S,N,a,d,e,m,C,T;const f=($=(v=i.detail)==null?void 0:v.tenantProductInsureVO)==null?void 0:$.settlementProcessVO.settlementProcessType;return!!(f===_e.WORD&&((G=(j=(B=i.detail)==null?void 0:B.tenantProductInsureVO)==null?void 0:j.settlementProcessVO)==null?void 0:G.settlementProcessList)&&((N=(S=(q=i.detail)==null?void 0:q.tenantProductInsureVO)==null?void 0:S.settlementProcessVO)==null?void 0:N.settlementProcessList.length)>0||f===_e.IMAGE&&((e=(d=(a=i.detail)==null?void 0:a.tenantProductInsureVO)==null?void 0:d.settlementProcessVO)==null?void 0:e.settlementProcessPicList)&&((T=(C=(m=i.detail)==null?void 0:m.tenantProductInsureVO)==null?void 0:C.settlementProcessVO)==null?void 0:T.settlementProcessPicList.length)>0)}),r=k(()=>{var f,v,$,B;return((v=(f=i.detail)==null?void 0:f.tenantProductInsureVO)==null?void 0:v.questionList)&&((B=($=i.detail)==null?void 0:$.tenantProductInsureVO)==null?void 0:B.questionList.length)>0}),R=k(()=>{let f=[...p.value];return O.value||(f=f.filter(v=>v.slotName!=="tab1")),!y.value&&!r.value&&(f=f.filter(v=>v.slotName!=="tab2")),f});return g({handleClickTab:()=>{var f;return(f=l.value)==null?void 0:f.handleClickTab}}),(f,v)=>(n(),X(mt,{ref_key:"scrollRef",ref:l,class:"tabs",list:t(R),sticky:"",scrollspy:""},st({tab3:H(()=>[Be(f.$slots,"form",{},void 0,!0)]),_:2},[t(O)?{name:"tab1",fn:H(()=>{var $,B;return[s("div",rn,[(n(!0),o(M,null,Q(((B=($=i.detail)==null?void 0:$.tenantProductInsureVO)==null?void 0:B.spec)||[],(j,G)=>(n(),o("img",{key:G,src:j,class:"detail-img"},null,8,un))),128)),I(ce)])]})}:void 0,t(y)||t(r)?{name:"tab2",fn:H(()=>{var $,B,j,G,q;return[t(y)?(n(),o(M,{key:0},[((B=($=i.detail)==null?void 0:$.tenantProductInsureVO)==null?void 0:B.settlementProcessVO.settlementProcessType)===t(_e).WORD?(n(),X(Ne,{key:0,title:"\u7406\u8D54\u6D41\u7A0B"},{default:H(()=>{var S,N,a;return[I(Vt,{list:(a=(N=(S=i.detail)==null?void 0:S.tenantProductInsureVO)==null?void 0:N.settlementProcessVO)==null?void 0:a.settlementProcessList},null,8,["list"])]}),_:1})):(n(),o("div",cn,[(n(!0),o(M,null,Q(((q=(G=(j=i.detail)==null?void 0:j.tenantProductInsureVO)==null?void 0:G.settlementProcessVO)==null?void 0:q.settlementProcessPicList)||[],(S,N)=>(n(),o("img",{key:N,src:S,class:"detail-img"},null,8,dn))),128))])),I(ce)],64)):x("",!0),t(r)?(n(),o(M,{key:1},[I(Ne,{title:"\u5E38\u89C1\u95EE\u9898"},{default:H(()=>{var S,N;return[I(ln,{list:(N=(S=i.detail)==null?void 0:S.tenantProductInsureVO)==null?void 0:N.questionList},null,8,["list"])]}),_:1}),I(ce)],64)):x("",!0)]})}:void 0]),1032,["list"]))}});var pn=Z(mn,[["__scopeId","data-v-4383aeea"]]);const fn=c=>(me("data-v-ead4d7ae"),c=c(),pe(),c),vn={key:0,class:"page-waiting"},_n=["src"],yn=fn(()=>s("div",{class:"tips"},[s("p",null,"\u652F\u4ED8\u6210\u529F\uFF0C\u627F\u4FDD\u4E2D...")],-1)),hn=J({props:{isShow:{type:Boolean,default:()=>{}}},setup(c){const g=c;return K(()=>g.isShow,i=>{i?document.body.style.overflow="hidden":document.body.style.overflow="inherit"}),(i,l)=>g.isShow?(n(),o("div",vn,[s("img",{class:"loading",src:t(Ft)},null,8,_n),yn])):x("",!0)}});var Pn=Z(hn,[["__scopeId","data-v-ead4d7ae"]]);const Ie=c=>(me("data-v-c0f1fa00"),c=c(),pe(),c),In={class:"com-period-cell"},Cn={key:0,class:"custom-cell check-btn-cell"},Dn=Ie(()=>s("div",{class:"cell-label"},"\u4FDD\u969C\u671F\u95F4",-1)),gn={class:"cell-content"},On={key:1,class:"custom-cell common-cell"},kn=Ie(()=>s("div",{class:"cell-label"},"\u751F\u6548\u65E5\u671F",-1)),Vn={key:2,class:"custom-cell common-cell"},Fn=Ie(()=>s("div",{class:"cell-label"},"\u4FDD\u969C\u671F\u9650",-1)),Ln={class:"cell-content"},wn=J({props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(c,{expose:g,emit:i}){const l=c;P({});const p=(a,d)=>a==="year"?`${d}\u5E74`:a==="month"?`${d}\u6708`:a==="day"?`${d}\u65E5`:d,O=P(new Date),y=Et("RISK_INSURANCE_PERIOD"),r=Pe({formInfo:l.formInfo});K(()=>r.formInfo.commencementTime,a=>{a&&typeof a=="string"&&(O.value=new Date(a))});const R=P(),E=P([]);K([()=>l.insureDetail,()=>r.formInfo.activePlanCode],()=>{var a;if(r.formInfo.insurancePeriodValue="",r.formInfo.commencementTime="",l.insureDetail)if(l.insureDetail.productRelationPlanVOList&&l.insureDetail.productRelationPlanVOList.length>0){let d=0;const e=l.insureDetail.productRelationPlanVOList.findIndex(T=>T.planCode===r.formInfo.activePlanCode);e>-1&&(d=e);const C=(((a=l.insureDetail.productRelationPlanVOList[d])==null?void 0:a.productRiskVoList[0].riskDetailVOList)||[]).find(T=>T.riskType===1);C&&(R.value=C)}else{const e=(l.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find(m=>m.riskType===1);e&&(R.value=e)}},{deep:!0,immediate:!0}),K([()=>R.value,()=>y.value],()=>{E.value=[],Array.isArray(y.value)&&y.value.length>1&&R.value&&(E.value=(R.value.riskInsureLimitVO.insurancePeriodValueList||[]).map(a=>{const d=y.value.find(e=>e.value===a);return d?{label:d.name,value:d.value}:null}).filter(a=>!!a)),E.value.length>0&&(r.formInfo.insurancePeriodValue=E.value[0].value)},{deep:!0,immediate:!0});const f=k(()=>{var a;return((a=R.value)==null?void 0:a.riskInsureLimitVO.guaranteeStartDate)||ae.CURRENT_DAY}),[v,$]=he(!1),B=()=>{$(!0)},j=new Date(le(new Date,1,"day")),G=k(()=>{var a;if(f.value===ae.CUSTOM_DAY){const d=(a=R.value)==null?void 0:a.riskInsureLimitVO.maxInsuranceDay;if(!d)return new Date;const e=le(new Date,Number(d),"day");return new Date(e)}return new Date}),q=a=>{r.formInfo.commencementTime=ie(a),$(!1)},S=()=>{$(!1)},N=k(()=>{if(f.value===ae.CUSTOM_DAY||!r.formInfo.insurancePeriodValue)return"";const[a,d]=r.formInfo.insurancePeriodValue.split("_");if(a!=="to"){let e=ie(new Date);if(f.value===ae.NEXT_DAY)return e=le(new Date,1,"day"),"";const m=le(e,Number(d),a);return`${e} - ${m}`}return r.formInfo.insured.certNo,""});return K([()=>f.value,()=>N.value,()=>r.formInfo.commencementTime,()=>r.formInfo.insurancePeriodValue],()=>{const[a,d]=r.formInfo.insurancePeriodValue.split("_");f.value===ae.CUSTOM_DAY?r.formInfo.insuranceStartDate=`${ie(r.formInfo.commencementTime)} 00:00:00`:f.value===ae.NEXT_DAY?r.formInfo.insuranceStartDate=`${le(new Date,1,"day")} 00:00:00`:r.formInfo.insuranceStartDate=`${ie(new Date)} 00:00:00`,a!=="to"?r.formInfo.insuranceEndDate=`${le(r.formInfo.insuranceStartDate,Number(d),a)} 23:59:59`:(r.formInfo.tenantOrderInsuredList[0].birthday,r.formInfo.tenantOrderInsuredList[0].certType===ye.CERT&&r.formInfo.tenantOrderInsuredList[0].certNo&&Re(r.formInfo.tenantOrderInsuredList[0].certNo)&&pt(r.formInfo.tenantOrderInsuredList[0].certNo),d==="single"&&(r.formInfo.insuranceEndDate="9999-99-99 23:59:59"),r.formInfo.insuranceEndDate=`${le(r.formInfo.insuranceStartDate,Number(d),a)} 23:59:59`)},{immediate:!0}),g({}),(a,d)=>{const e=z("ProRadioButton"),m=z("van-config-provider"),C=z("van-datetime-picker"),T=z("ProPopup");return n(),o(M,null,[I(m,{"theme-vars":t(qe)},{default:H(()=>[s("div",In,[E.value.length>1?(n(),o("div",Cn,[Dn,s("div",gn,[I(e,{modelValue:t(r).formInfo.insurancePeriodValue,"onUpdate:modelValue":d[0]||(d[0]=U=>t(r).formInfo.insurancePeriodValue=U),options:E.value},null,8,["modelValue","options"])])])):x("",!0),t(f)===t(ae).CUSTOM_DAY?(n(),o("div",On,[kn,s("div",{class:"cell-content",onClick:B},w(t(r).formInfo.commencementTime),1)])):x("",!0),t(f)!==t(ae).CUSTOM_DAY?(n(),o("div",Vn,[Fn,s("div",Ln,w(t(N)),1)])):x("",!0)])]),_:1},8,["theme-vars"]),I(T,{show:t(v),"onUpdate:show":d[2]||(d[2]=U=>ot(v)?v.value=U:null),height:40,closeable:!1},{default:H(()=>[I(C,{modelValue:O.value,"onUpdate:modelValue":d[1]||(d[1]=U=>O.value=U),type:"date",title:"\u9009\u62E9\u5E74\u6708","min-date":t(j),"max-date":t(G),formatter:p,onConfirm:q,onCancel:S},null,8,["modelValue","min-date","max-date"])]),_:1},8,["show"])],64)}}});var En=Z(wn,[["__scopeId","data-v-c0f1fa00"]]);const ue=c=>(me("data-v-a110c0f6"),c=c(),pe(),c),$n={class:"com-payment-type"},Sn={class:"title"},Nn={key:0,class:"picture-payment-content"},Tn=["onClick"],bn=["src"],xn=["src"],Bn={key:1,class:"custom-cell check-btn-cell"},An=ue(()=>s("div",{class:"cell-label"},"\u4FDD\u969C\u65B9\u6848",-1)),Rn={class:"cell-content"},Mn={key:0,class:"picture-payment-content"},qn=["onClick"],Un=["src"],Yn=["src"],Hn={key:1,class:"default-payment-content"},jn=ue(()=>s("div",{class:"pay-method"},[s("span",{class:"method"},w("\u6309\u6708\u4EA4\u8D39")),s("span",{class:"acount"},w("\u517112\u671F"))],-1)),Gn=[jn],zn=ue(()=>s("div",null,[s("div",{class:"tip"},[s("span",null,w("\u6BD4\u6309\u6708\u652F\u4ED8\u6700\u9AD8\u7701")),re(),s("span",null,"16%")]),s("div",{class:"triangle"}),s("div",{class:"pay-method"},[s("span",{class:"method"},w("\u4E00\u6B21\u4EA4\u6E05")),s("span",{class:"acount"},w("\u6BD4\u6708\u4EA4\u4FDD\u8D39\u7701\u6700\u9AD82014\u5143"))])],-1)),Wn=[zn],Qn={key:2,class:"custom-cell check-btn-cell"},Kn=ue(()=>s("div",{class:"cell-label"},"\u4EA4\u8D39\u65B9\u5F0F",-1)),Xn={class:"cell-content"},Jn={class:"custom-cell common-cell"},Zn=ue(()=>s("div",{class:"cell-label"},"\u5B9E\u4ED8\u4FDD\u8D39",-1)),ea={class:"cell-content actual-premium"},ta={key:0,class:"feerate-explain"},na={class:"content"},aa=ue(()=>s("div",{class:"triangle-top"},null,-1)),sa=J({props:{showConfig:{type:Object,default:()=>{}},formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premium:{type:[Number||null],default:null}},emits:["onReset","onUpdate","onVerify"],setup(c,{expose:g,emit:i}){const l=c;P({});const p=Pe({formInfo:l.formInfo}),O=P([]),y=P(),r=P(),R=k(()=>{var e;return String((e=y.value)==null?void 0:e.paymentFrequencyFlag)==="1"}),E=k(()=>{var e;return(e=r.value)==null?void 0:e.productPremiumVOList.find(m=>m.paymentFrequency===p.formInfo.paymentFrequency)}),f=k(()=>l.premium&&E.value?`${l.premium}${E.value.premiumUnit||""}`:E.value?`${E.value.paymentFrequencyValue||""}${E.value.premiumUnit||""}`:""),v=k(()=>{if(r){const{premiumExplain:e,premiumExplainViewName:m,premiumExplainUri:C}=r.value||{};return{premiumExplain:e,premiumExplainUri:C,premiumExplainViewName:m}}return null});K(()=>l.configDetail,()=>{var e;l.isMultiplePlan&&l.configDetail&&(O.value=(e=l.configDetail.tenantProductInsureVO)==null?void 0:e.planList)},{immediate:!0,deep:!0}),K([()=>l.configDetail,()=>l.isMultiplePlan,()=>p.formInfo.activePlanCode],()=>{if(l.configDetail)if(l.isMultiplePlan){let e=0;const m=l.configDetail.tenantProductInsureVO.planList.findIndex(C=>C.planCode===p.formInfo.activePlanCode);m>-1&&(e=m),y.value=l.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,r.value=l.configDetail.tenantProductInsureVO.planList[e]}else y.value=l.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,r.value=l.configDetail.tenantProductInsureVO.planInsureVO},{deep:!0,immediate:!0});const $=k(()=>y.value?y.value.paymentFrequency.split(",").length>1:!1),B=k(()=>{if(y.value){const e=y.value.paymentFrequency.split(",");if(e.length===1)return p.formInfo.paymentFrequency=y.value.paymentFrequency,!1;if(e.length===2&&e.filter(m=>![se.SINGLE,se.MONTH].includes(m)).length<1)return!0}return!1}),j=k(()=>{var e;return y.value?(e=y.value.paymentFrequencyList||[])==null?void 0:e.map(m=>({...m,paymentFrequency:m.skinValue})):[]}),G=k(()=>j.value.length>0),q=k(()=>l.isMultiplePlan?l.configDetail.tenantProductInsureVO.planList.map(e=>({...e.planPicList,planCode:e.planCode,planName:e.planName})):[]),S=k(()=>{var e;return y.value?(e=y.value.paymentFrequency.split(",")||[])==null?void 0:e.map(C=>({label:vt[C],value:C})):[]}),N=e=>{console.log("type",e),p.formInfo.paymentFrequency=e},a=e=>{p.formInfo.activePlanCode=e},d=()=>{var e,m;if(!((e=v.value)!=null&&e.premiumExplainUri)){lt("\u65E0\u8D39\u7387\u6587\u4EF6\uFF01");return}Me({fileType:"pdf",fileUri:(m=v.value)==null?void 0:m.premiumExplainUri})};return g({}),(e,m)=>{const C=z("ProRadioButton"),T=z("templat"),U=z("ProDivider"),te=z("van-config-provider");return n(),X(te,{"theme-vars":t(qe)},{default:H(()=>[s("div",$n,[s("div",Sn,w(t($)?"\u4EA4\u8D39\u65B9\u5F0F":"\u4FDD\u969C\u8BA1\u5212"),1),c.isMultiplePlan?(n(),o(M,{key:0},[t(q).length>0?(n(),o("div",Nn,[(n(!0),o(M,null,Q(t(q),F=>(n(),o("div",{key:F.planCode,class:ne("picture-payment-item"),onClick:h=>a(F.planCode)},[t(p).formInfo.activePlanCode==F.planCode?(n(),o("img",{key:0,src:F.selectedPic},null,8,bn)):(n(),o("img",{key:1,src:F.unSelectedPic},null,8,xn))],8,Tn))),128))])):(n(),o("div",Bn,[An,s("div",Rn,[I(C,{modelValue:t(p).formInfo.activePlanCode,"onUpdate:modelValue":m[0]||(m[0]=F=>t(p).formInfo.activePlanCode=F),options:O.value,prop:{value:"planCode",label:"planName"}},null,8,["modelValue","options"])])]))],64)):x("",!0),t(R)?(n(),X(T,{key:1},{default:H(()=>[t(G)?(n(),o("div",Mn,[(n(!0),o(M,null,Q(t(j),F=>(n(),o("div",{key:F.paymentFrequency,class:ne("picture-payment-item"),onClick:h=>N(F.paymentFrequency)},[t(p).formInfo.paymentFrequency==F.paymentFrequency?(n(),o("img",{key:0,src:F.selectedPic},null,8,Un)):(n(),o("img",{key:1,src:F.unSelectedPic},null,8,Yn))],8,qn))),128))])):t(B)?(n(),o("div",Hn,[s("div",{class:ne(`com-payment-type-item ${t(p).formInfo.paymentFrequency==t(se).MONTH?"active":""}`),onClick:m[1]||(m[1]=F=>N(t(se).MONTH))},Gn,2),s("div",{class:ne(`com-payment-type-item ${t(p).formInfo.paymentFrequency==t(se).SINGLE?"active":""}`),onClick:m[2]||(m[2]=F=>N(t(se).SINGLE))},Wn,2)])):t(S).length>1?(n(),o("div",Qn,[Kn,s("div",Xn,[I(C,{modelValue:t(p).formInfo.paymentFrequency,"onUpdate:modelValue":m[3]||(m[3]=F=>t(p).formInfo.paymentFrequency=F),options:t(S)},null,8,["modelValue","options"])])])):x("",!0)]),_:1})):x("",!0),I(En,{"form-info":t(p).formInfo,"insure-detail":c.insureDetail,"config-detail":c.configDetail},null,8,["form-info","insure-detail","config-detail"]),t(E)&&t(E).premiumUnit?(n(),o(M,{key:2},[s("div",Jn,[Zn,s("div",ea,w(t(f)),1)]),t(v)&&t(v).premiumExplain&&t(v).premiumExplainViewName?(n(),o("div",ta,[s("div",na,[aa,s("div",null,[s("span",null,w(t(v).premiumExplain||""),1),s("span",{class:"file-name",onClick:d},"\u300A"+w(t(v).premiumExplainViewName||"")+"\u300B",1)])])])):x("",!0)],64)):x("",!0)]),I(U)]),_:1},8,["theme-vars"])}}});var oa=Z(sa,[["__scopeId","data-v-a110c0f6"]]);const la={class:"inscribedContent-content"},ia={class:"content"},ra=J({props:{inscribedContent:{type:String,default:""}},setup(c){const g=c,i=P();return K(()=>g.inscribedContent,l=>{l?i.value=l.replaceAll(`
`,"<br />"):i.value=""},{immediate:!0,deep:!0}),(l,p)=>{const O=be("dompurify-html");return n(),o("div",la,[xe(s("div",ia,null,512),[[O,i.value]])])}}});var ua=Z(ra,[["__scopeId","data-v-702b2de2"]]);const ca={class:"com-attachment-list"},da=["onClick"],ma=J({props:{preText:{type:String,default:""},attachementList:{type:Object,default:()=>{}}},emits:["preview-file"],setup(c,{emit:g}){const i=l=>{g("preview-file",l)};return(l,p)=>(n(),o("div",ca,[s("span",null,w(c.preText),1),(n(!0),o(M,null,Q(c.attachementList||[],(O,y)=>(n(),o("span",{key:y,class:"attachment-item",onClick:r=>i(y)}," \u300A"+w(O.attachmentName)+"\u300B ",9,da))),128))]))}});var pa=Z(ma,[["__scopeId","data-v-17da129e"]]);const fa={class:"page-internet-product-detail"},va={class:"info"},_a={class:"footer-area"},ya={class:"price"},ha=re(" \u603B\u4FDD\u8D39"),Pa=re(w("\u7ACB\u5373\u6295\u4FDD")),Ia=J({setup(c){var Oe,ke,Ve;const g=kt();it();const i=rt(),{productCode:l="BWYL2021",tenantId:p,orderNo:O,phoneNo:y,agentCode:r="",saleChannelId:R,paymentMethod:E,certNo:f,name:v,templateId:$,pageCode:B,from:j,extraInfo:G}=i.query;let q={};try{q=JSON.parse(decodeURIComponent(G))}catch{}const S=P(),N=P(),a=P(),d=P(),e=P(),m=P(!1),C=P(!1),T=P(!1),U=P(0),te=P(!1);P(!1);let F="";const h=P(!0),b=Pe({holder:{certNo:f,certType:ye.CERT,mobile:y,name:v,socialFlag:we.HAS},insured:{certNo:f,certType:ye.CERT,name:v,socialFlag:we.HAS,relationToHolder:Ee.SELF},paymentMethod:E,renewalDK:"Y",packageProductList:[],mobileSmsCode:"",activePlanCode:"",paymentFrequency:se.MONTH,insurancePeriodValue:"",commencementTime:ie(new Date)}),Y=P({tenantId:p,agencyId:r,orderCategory:1,saleUserId:R,saleChannelId:R,venderCode:(Oe=a.value)==null?void 0:Oe.insurerCode,insuranceStartDate:null,insuranceEndDate:null,activePlanCode:"",paymentFrequency:se.MONTH,insurancePeriodValue:"",commencementTime:ie(new Date),tenantOrderHolder:{extInfo:{},socialFlag:"1"},tenantOrderInsuredList:[{socialFlag:"1",relationToHolder:Ee.SELF,extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{tenantId:p,productCode:(ke=a.value)==null?void 0:ke.productCode,productName:(Ve=a.value)==null?void 0:Ve.productName,premium:e.value||0}]}],extInfo:{buttonCode:"EVENT_SHORT_saveOrder",successJumpUrl:"",...q},operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),oe=k(()=>{var u,_,L,D,V,A;return a.value?!!(((_=(u=a.value)==null?void 0:u.tenantProductInsureVO)==null?void 0:_.planList)&&Array.isArray((D=(L=a.value)==null?void 0:L.tenantProductInsureVO)==null?void 0:D.planList)&&((A=(V=a.value)==null?void 0:V.tenantProductInsureVO)==null?void 0:A.planList.length)>0):!1}),Ue=k(()=>{var u,_,L;if(oe.value){if(Y.value.activePlanCode)return((u=d.value)==null?void 0:u.planFactor[Y.value.activePlanCode])||{}}else if((_=d.value)!=null&&_.productFactor)return(L=d.value)==null?void 0:L.productFactor;return{}});K(()=>oe.value,()=>{var u,_;oe.value&&(Y.value.activePlanCode=(_=(u=a.value)==null?void 0:u.tenantProductInsureVO)==null?void 0:_.planList[0].planCode)},{immediate:!0});const Ce=k(()=>{var u,_,L;return oe.value?((_=(u=d.value)==null?void 0:u.productRelationPlanVOList.find(D=>D.planCode===Y.value.activePlanCode))==null?void 0:_.productRiskVoList)||[]:((L=d.value)==null?void 0:L.productRiskVoList)||[]}),Ye=u=>{Y.value.activePlanCode=u},He=k(()=>[]),de=k(()=>{var L,D;let u={};if(oe){const V=(L=a.value)==null?void 0:L.tenantProductInsureVO.planList.find(A=>A.planCode===(Y.value.activePlanCode||""));u=V==null?void 0:V.attachmentVOList}else u=(D=a.value)==null?void 0:D.tenantProductInsureVO.planInsureVO.attachmentVOList;if(!u)return{};const _={2:"richText",3:"link"};return Object.keys(u).map(V=>(u[V].forEach(A=>{if(A.attachmentType==="1"){const W=A.attachmentUri.split("?"),ee=W[0].substr(W[0].lastIndexOf(".")+1);console.log("type",ee),ee==="pdf"?A.attachmentType="pdf":A.attachmentType="picture"}else A.attachmentType=_[A.attachmentType]}),{attachmentName:V,attachmentList:u[V]}))}),je=()=>{console.log("detailScrollRef.value",N.value),N.value.handleClickTab()("tab3")},Ge=()=>{const{holder:{certNo:u,mobile:_,name:L,socialFlag:D},insured:{certNo:V,name:A,socialFlag:W,relationToHolder:ee},paymentMethod:fe}=b;return!!(Re(V)&&!!W)},ze=(u={},_={},L={})=>{var A,W;const D={...L};console.log("currentOrderDetail==========",(A=D.tenantOrderInsuredList[0])==null?void 0:A.tenantOrderProductList[0].riskVOList);const V={tenantId:p,riskList:((W=D.tenantOrderInsuredList[0])==null?void 0:W.tenantOrderProductList[0].riskVOList)||[],riskPremium:_,productId:u==null?void 0:u.productBasicInfoVO.id};return D.extInfo.iseeBizNo=F,D.commencementTime=ie(D.commencementTime||new Date,"YYYY-MM-DD HH:mm:ss"),D.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:u.productBasicInfoVO.productCode,productName:u.productBasicInfoVO.productName,tenantOrderRiskList:Ot(V)},D},We=async u=>{const{code:_,data:L}=await ht(ze(d.value,{},Y.value));_==="10000"&&(h.value=!1)},Qe=async()=>{const{calcData:u,riskVOList:_}=It({holder:b.holder,insured:b.insured,tenantId:p,productDetail:a.value,insureDetail:d.value,paymentFrequency:b.paymentFrequency,packageRiskIdList:Ct(b.packageProductList)},!1,Dt);if(!Array.isArray(_)||_.length<1)return e.value=null,{};const L=await $e(u),{code:D,data:V}=L;return D==="10000"?(e.value=V.premium,{condition:_,data:V}):(e.value=null,{})},Ke=u=>{U.value=u,T.value=!0},Xe=async(u,_,L)=>{var A,W;const D=gt(L).map(ee=>({...ee,paymentFrequency:u.paymentFrequency,insurancePeriodValue:u.insurancePeriodValue})),V={tenantId:p,productCode:(A=a.value)==null?void 0:A.productCode,insuranceStartDate:u.insuranceStartDate,insuranceEndDate:u.insuranceEndDate,holder:{personVO:u.tenantOrderHolder},insuredVOList:u.tenantOrderInsuredList.map(ee=>({insuredCode:"",personVO:ee,productPlanVOList:[{insurerCode:_.productBasicInfoVO.insurerCode,planCode:Y.value.activePlanCode||0,riskVOList:D}]}))};await $e(V),Y.value.tenantOrderInsuredList[0].tenantOrderProductList=(W=V.insuredVOList[0])==null?void 0:W.productPlanVOList},De=async()=>{try{console.log("currentRiskInfo.value",Ce.value),await Xe(Y.value,d.value,Ce.value),console.log("orderDetail.value.tenantOrderInsuredList[0].tenantOrderProductList[0]",Y.value),We({})}catch{}},Je=u=>{u==="allFalse"?(C.value=!1,m.value=!0,De()):dt.confirm({message:"\u60A8\u5F53\u524D\u7684\u5065\u5EB7\u72B6\u51B5\u4E0D\u7B26\u5408\u8BE5\u4EA7\u54C1",confirmButtonText:"\u786E\u5B9A"}).then(()=>{window.history.back()}).catch(()=>{var _;(_=S.value)==null||_.reEditForm(),m.value=!1})},ge=()=>{var u;(u=S.value)==null||u.reEditForm(),m.value=!1},Ze=()=>{C.value=!1,ge()},et=()=>{T.value=!1,ge()},tt=()=>{T.value=!1,C.value=!0};K([()=>b.insured.certNo,()=>b.insured.socialFlag,()=>b.packageProductList,()=>b.paymentFrequency],ut.exports.debounce(()=>{b.insured.certNo&&b.insured.socialFlag&&Ge()&&Qe()},500),{deep:!0,immediate:!0});const nt=async()=>{const u=Pt({productCode:l,withInsureInfo:!0,tenantId:p}),_=yt({productCode:l});await Promise.all([u,_]).then(([L,D])=>{var V;L.code==="10000"&&(a.value={...L.data},document.title=((V=L.data)==null?void 0:V.productFullName)||""),D.code==="10000"&&(d.value=D.data)})};return ct(()=>{nt(),setTimeout(async()=>{F=window.getIseeBiz&&await window.getIseeBiz()},1500)}),(u,_)=>{const L=z("van-config-provider");return n(),o(M,null,[I(L,{"theme-vars":t(g)},{default:H(()=>{var D,V,A,W,ee,fe,ve,Fe,Le;return[s("div",fa,[s("div",va,[I(Se,{url:(V=(D=a.value)==null?void 0:D.tenantProductInsureVO)==null?void 0:V.banner[0]},null,8,["url"]),(W=(A=a.value)==null?void 0:A.tenantProductInsureVO)!=null&&W.bannerMove?(n(),X(Se,{key:0,url:(fe=(ee=a.value)==null?void 0:ee.tenantProductInsureVO)==null?void 0:fe.bannerMove[0],onClick:je},null,8,["url"])):x("",!0)]),I(Kt,{"show-service-config":"","data-source":(ve=a.value)==null?void 0:ve.tenantProductInsureVO,"is-multiple-plan":t(oe),"active-plan-code":Y.value.activePlanCode,onUpdateActivePlan:Ye},null,8,["data-source","is-multiple-plan","active-plan-code"]),I(pn,{ref_key:"detailScrollRef",ref:N,detail:a.value},{form:H(()=>[I(St,{ref_key:"formRef",ref:S,"title-collection":{HOLDER:"\u672C\u4EBA\u4FE1\u606F\uFF08\u6295\u4FDD\u4EBA\uFF09",INSURER:"\u4E3A\u8C01\u6295\u4FDD\uFF08\u88AB\u4FDD\u4EBA\uFF09"},"form-info":Y.value,"send-sms-code":()=>{},"factor-object":t(Ue)||{}},null,8,["form-info","send-sms-code","factor-object"]),I(oa,{"form-info":Y.value,"insure-detail":d.value,"config-detail":a.value,"is-multiple-plan":t(oe),"risk-info-period-list":u.riskInfoPeriodList,premium:e.value},null,8,["form-info","insure-detail","config-detail","is-multiple-plan","risk-info-period-list","premium"])]),_:1},8,["detail"]),(Fe=a.value)!=null&&Fe.tenantProductInsureVO.inscribedContent?(n(),X(ua,{key:0,"inscribed-content":(Le=a.value)==null?void 0:Le.tenantProductInsureVO.inscribedContent},null,8,["inscribed-content"])):x("",!0),t(de)&&t(de).length>1?(n(),X(pa,{key:1,"attachement-list":t(de),"pre-text":"\u8BF7\u9605\u8BFB",onPreviewFile:_[0]||(_[0]=at=>Ke(at))},null,8,["attachement-list"])):x("",!0),s("div",_a,[s("div",ya,[ha,s("span",null,w(e.value?"\uFFE5":"")+w(t(ft)(e.value))+" "+w(e.value?Y.value.paymentFrequency==t(_t).YEAR?"\u5143/\u5E74":"\u5143/\u6708":""),1)]),I($t,{shadow:!1,"theme-vars":t(g),class:"right",text:"\u7ACB\u5373\u6295\u4FDD",onClick:De},{default:H(()=>[Pa]),_:1},8,["theme-vars"])])])]}),_:1},8,["theme-vars"]),I(Lt,{show:C.value,"onUpdate:show":_[1]||(_[1]=D=>C.value=D),"content-list":t(He),"active-index":0,onOnConfirmHealth:Je,onOnCloseHealth:Ze},null,8,["show","content-list"]),T.value?(n(),X(wt,{key:0,show:T.value,"onUpdate:show":_[2]||(_[2]=D=>T.value=D),"content-list":t(de),"is-only-view":h.value,"active-index":U.value,text:h.value?"\u5173\u95ED":"\u6211\u5DF2\u9010\u9875\u9605\u8BFB\u5E76\u786E\u8BA4\u544A\u77E5\u5185\u5BB9","force-read-cound":0,"on-close-file-preview":"",onSubmit:tt,onOnCloseFilePreview:et},null,8,["show","content-list","is-only-view","active-index","text"])):x("",!0),I(Pn,{"is-show":te.value},null,8,["is-show"])],64)}}});var Ra=Z(Ia,[["__scopeId","data-v-6e0d1097"]]);export{Ra as default};
