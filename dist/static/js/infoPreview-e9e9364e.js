import{d as e,af as o,ag as a,i as t,h as s,c9 as n,r as i,j as l,aG as r,l as c,o as d,c as u,b as p,u as f,p as m,q as y,f as I,w as v,F as h,s as w,a as b,g as j,v as g,dG as k,T as V,bH as C,ak as q,bK as x,aS as L,dM as T,aQ as _,c6 as P}from"./index-2278a2d6.js";import{P as O,a as R}from"./PolicyInfo-4b3bd6f9.js";import{g as E,m as N}from"./trial-9a4d1309.js";import{n as U}from"./nextStep-f2296c4b.js";import{b as D,l as F}from"./product-4e616cc7.js";import{u as Q}from"./useOrder-6ac48bc3.js";import{P as B}from"./index-71fe3b71.js";import{P as M}from"./index-370099bf.js";import{_ as S}from"./InsureInfo-1385d7db.js";import{p as $,d as A}from"./utils-42e85f58.js";import{Q as G}from"./notice-33e6eedd.js";import{g as z}from"./utils-3d4e7c9e.js";import{Q as J}from"./questionnaire-42dcb602.js";import{P as H}from"./constants-b39aa53b.js";import{T as K}from"./infoCollection-4919a7c6.js";import"./core-c0e87ed9.js";import"./cloneDeep-fc21491a.js";import"./util-78c49ceb.js";import"./trial-0a69ca6d.js";const W={class:"long-info-preview"},X={class:"footer-button"},Y=e({__name:"infoPreview",setup(e){const Y=o((()=>a((()=>import("./index-61d7379d.js")),["static/js/index-61d7379d.js","static/css/index-fa4edf2a.css","static/js/index-2278a2d6.js","static/css/index-c51a28e6.css","static/js/theme-94cf7d00.js","static/js/index-370099bf.js","static/css/index-bbfdd7ec.css","static/js/utils-3d4e7c9e.js","static/js/infoCollection-4919a7c6.js","static/js/trial-0a69ca6d.js"]))),Z=t(),ee=s(),oe=Q(),{productCode:ae="",tenantId:te,agentCode:se="",agencyCode:ne,saleChannelId:ie,isShare:le,orderNo:re,extraInfo:ce,insurerCode:de,objectType:ue="1",templateId:pe,preview:fe,origin:me}=Z.query;let ye={};try{ye=JSON.parse(decodeURIComponent(ce))}catch(Pe){}n(!1);const Ie=i({isView:!1,personalInfo:{},policyInfo:{schema:[],config:[],formData:{}},payInfo:{schema:[],config:[],formData:[]},customerQuestions:[]}),ve=`${window.origin}/baseInsurance/long/phoneVerify${window.location.search}`;l({imgUrl:"",desc:"",title:"",link:ve});const he=l(),we=l(),be=l(!1),je=l(0),ge=l(!1),ke=()=>{be.value=!1};l();const Ve=()=>{pe===K.FREE&&(oe.value.extInfo.buttonCode=k.free.underWriteAndIssue,oe.value.extInfo.pageCode="productInfo",U(oe.value,((e,o)=>{o===_.JUMP_PAGE&&ee.push({path:H[e.nextPageCode],query:Z.query})})))},Ce=async()=>{pe===K.FREE&&V("被保人已完成认证")},qe=l(),xe=l(),Le=l([]),Te=async()=>{let e={};const{code:o,data:a}=await E({orderNo:re,tenantId:te});"10000"===o&&(Object.assign(oe.value,a),e=$(a.insuredList[0].productList),qe.value=a,ge.value=!0),(async e=>{let o=[];const{code:a,data:t}=await P({orderNo:re,tenantId:te});"10000"===a&&(o=t.productQuestionnaireVOList);const{code:s,data:n}=await F(e);if("10000"===s){const{productQuestionnaireVOList:e}=n||{},a=e.filter((e=>e.businessType!==G.VISIT));Ie.customerQuestions=a.map((e=>{const{questionnaireDetailResponseVO:a,questionnaireId:t,questionnaireName:s}=e||{},{questions:n,basicInfo:i}=a||{},{objectType:l,questionnaireType:r}=i||{};if(r===J.TEXT){const{content:e,textType:o}=(null==n?void 0:n[0])||{};return{content:e,contentType:z(`${o}`,e),questionnaireId:t,questionnaireName:s}}const c=(o||[]).find((e=>e.questionnaireId===t));return{...a,contentType:"question",...null==c?void 0:c.questionnaireDetailResponseVO,questionnaireId:t,questionnaireName:s}}))}})({productCodeList:e.productList.map((e=>e.productCode))}),D(e).then((({code:e,data:o})=>{if("10000"===e){const{productMaterialList:e,riskMaterialList:a}=A(o);Le.value=e.concat(a)}})),N(e).then((({data:e,code:o})=>{if("10000"===o){const{productDetailResList:o,productFactor:a}=e;xe.value=a;const{payInfo:t,other:s}=C(a);Ie.payInfo={...Ie.payInfo,...t},Ie.policyInfo={...Ie.policyInfo,...s}}}))};r((()=>{Te()}));const _e=l();return c((()=>{setTimeout((async()=>{_e.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,o)=>{var a,t,s;const n=q,i=x,l=L,r=T;return d(),u("div",W,[p(n),p(S,{"product-data":null==(t=null==(a=f(oe).insuredList)?void 0:a[0])?void 0:t.productList},null,8,["product-data"]),(null==(s=Object.keys(f(xe)||{}))?void 0:s.length)?(d(),m(B,{key:0,ref_key:"personalInfoRef",ref:we,modelValue:f(qe),"onUpdate:modelValue":o[0]||(o[0]=e=>y(qe)?qe.value=e:null),"product-factor":f(xe),"is-view":"","input-align":"left"},null,8,["modelValue","product-factor"])):I("",!0),f(Ie).payInfo.schema.length?(d(),m(f(O),{key:1,ref_key:"payInfoRef",ref:he,modelValue:f(oe).tenantOrderPayInfoList,"onUpdate:modelValue":o[1]||(o[1]=e=>f(oe).tenantOrderPayInfoList=e),schema:f(Ie).payInfo.schema,"is-view":""},null,8,["modelValue","schema"])):I("",!0),f(Ie).policyInfo.schema.length?(d(),m(f(R),{key:2,modelValue:f(oe).extInfo,"onUpdate:modelValue":o[2]||(o[2]=e=>f(oe).extInfo=e),schema:f(Ie).policyInfo.schema,"is-view":""},null,8,["modelValue","schema"])):I("",!0),p(l,{title:"产品资料","show-line":!1,"show-icon":!1},{default:v((()=>[(d(!0),u(h,null,w(f(Le),((e,o)=>(d(),m(i,{key:o,"is-link":"",title:e.attachmentName,onClick:e=>(e=>{je.value=e,be.value=!0})(o)},null,8,["title","onClick"])))),128))])),_:1}),b("div",X,["confirm"!==f(me)?(d(),m(M,{key:0,shadow:!1,onClick:Ce},{default:v((()=>[j(e.$slots,"default",{},(()=>[g("确认")]))])),_:3})):(d(),m(M,{key:1,shadow:!1,onClick:Ve},{default:v((()=>[j(e.$slots,"default",{},(()=>[g("领取保障并激活")]))])),_:3}))]),f(be)?(d(),m(f(Y),{key:3,show:f(be),"onUpdate:show":o[3]||(o[3]=e=>y(be)?be.value=e:null),"content-list":[f(Le)[f(je)]],"is-only-view":"","active-index":0,text:"关闭","force-read-cound":0,onOnCloseFilePreviewByMask:ke},null,8,["show","content-list"])):I("",!0),p(r,{modelValue:f(Ie).visibleFile,"onUpdate:modelValue":o[4]||(o[4]=e=>f(Ie).visibleFile=e),"data-source":f(Ie).files,onClickBtn:e.clickBtn},null,8,["modelValue","data-source","onClickBtn"])])}}});export{Y as default};
