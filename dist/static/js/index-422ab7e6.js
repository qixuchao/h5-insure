import{d as e,g as t,am as a,o as s,c as o,a as l,e as d,u as n,cG as r,b as i,al as c,a8 as u,cW as p,w as m,aw as v,bM as g,l as y,q as I,_ as b,at as f,au as C,az as h,T as N,a9 as k,cX as _,b_ as D,h as S,i as Y,j as U,z as x,O as T,aJ as L,m as j,cD as G,n as P,F as W}from"./index-e18db70e.js";import{_ as w}from"./index-04b3c352.js";import{L as B}from"./index-2d468c4b.js";import{d as E,g as q}from"./order-c799ec64.js";import{I as A}from"./infoItem-469c61f8.js";import"./empty-ae586b6c.js";const M={class:"com-order-item"},R={class:"header"},z={class:"product-name"},H={class:"status"},O={class:"info"},X={class:"info-bottom"},F=(e=>(f("data-v-1c14f236"),e=e(),C(),e))((()=>l("div",{style:{width:"25%"}},[l("img",{src:"/static/png/tree-0f48942e.png",alt:"",style:{width:"80%"}})],-1))),Z={class:"footer"},J={class:"fee"},K={class:"money"},Q={key:0,class:"buttons"},V={key:1,class:"buttons"},$={key:2,class:"buttons"};var ee=b(e({__name:"item",props:{detail:{type:Object,default:()=>{}}},emits:["afterDelete"],setup(e,{emit:b}){const f=e,C=t(),D=()=>{h.confirm({title:"",message:"确认要删除该订单么？",confirmButtonText:"删除"}).then((()=>{E(f.detail.id,f.detail.orderStatus).then((e=>{const{code:t,data:a}=e;"10000"===t&&(N.success("删除成功"),b("afterDelete"))}))}))},S=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderTopStatus:c}=f.detail;if((p.PENDING===c||p.PAYING===c)&&[_.ZXYS,_.BWYL,_.BWYLUP].includes(e)){const a={[_.ZXYS]:"/internet/productDetail/package",[_.BWYL]:"/internet/productDetail",[_.BWYLUP]:"/internet/guaranteeUpgrade"};return C.push({path:a[e],query:{productCode:e,saleChannelId:i,agentCode:s,tenantId:l,agencyCode:r,orderNo:t}}),!0}return!1},Y=()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r}=f.detail;S()||C.push({path:"orderDetail",query:{productCode:e,orderNo:t,orderId:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyCode:r}})};return(t,b)=>{const C=a;return s(),o("div",M,[l("div",R,[l("div",z,d(e.detail.productName),1),l("div",H,d(n(r)[e.detail.orderStatus]),1)]),l("div",O,[i(A,{label:"订单号",content:e.detail.policyHolder,line:"","is-copy":""},null,8,["content"]),i(A,{label:"投保单号",content:e.detail.applicationNo,line:"","is-copy":""},null,8,["content"]),i(A,{label:"保单号",content:e.detail.policyNo,line:"","is-copy":""},null,8,["content"]),l("div",X,[l("div",null,[i(A,{label:"投保人",content:e.detail.holderName,line:""},null,8,["content"]),i(A,{label:"被保人",content:e.detail.insuredName,line:""},null,8,["content"]),i(A,{label:"创建时间",content:n(c)(e.detail.orderStartDate).format("YYYY-MM-DD HH:mm:ss"),line:""},null,8,["content"])]),F])]),l("div",Z,[l("div",J,[u(" 保费："),l("span",K,"￥"+d(e.detail.premium),1)]),e.detail.orderTopStatus===n(p).PENDING?(s(),o("div",Q,[i(C,{class:"button",onClick:v(D,["stop"])},{default:m((()=>[u("删除")])),_:1},8,["onClick"]),n(g).UNDERWRITING_FAILED!==e.detail.orderStatus?(s(),y(C,{key:0,class:"button primary",onClick:b[0]||(b[0]=v((e=>(()=>{const{goodsCode:e,orderNo:t,id:a,saleUserId:s,templateId:o,tenantId:l,insurerCode:d,productCategory:n,agencyId:r,saleChannelId:i,orderStatus:c,abbreviation:u}=f.detail;S()||k("orderDetail",{orderNo:t,agentCode:s,tenantId:l,abbreviation:u,productCategory:n})})()),["stop"]))},{default:m((()=>[u("去处理")])),_:1})):I("",!0)])):I("",!0),e.detail.orderTopStatus===n(p).PAYING?(s(),o("div",V,[i(C,{class:"button primary",onClick:v(Y,["stop"])},{default:m((()=>[u("去支付")])),_:1},8,["onClick"])])):I("",!0),e.detail.orderTopStatus===n(p).TIMEOUT?(s(),o("div",$,[i(C,{class:"button",onClick:v(D,["stop"])},{default:m((()=>[u("删除")])),_:1},8,["onClick"])])):I("",!0)])])}}}),[["__scopeId","data-v-1c14f236"]]);const te={class:"page-order"},ae={key:0,class:"order-head"},se={class:"order-head-num"},oe={style:{"margin-left":"27px"},class:"order-head-num"},le={style:{"margin-left":"36px"},class:"order-head-num"},de={key:2,class:"empty-box"},ne=(e=>(f("data-v-7ae44c57"),e=e(),C(),e))((()=>l("div",{class:"footer"},[l("img",{src:"/static/png/logo-b728275d.png",alt:"",style:{width:"100%",height:"128px"}})],-1)));var re=b(e({__name:"index",setup(e){const a=D();t();const r=S().query,c=Y({"-1":1,0:2,1:3,2:4}[r.type]||0),p=Y(1),v=Y(!1),g=Y(!1),b=Y([]),f=Y(0),C=Y(0),h=Y(0),_=[{title:"全部",status:""},{title:"待处理",status:"-1"},{title:"待支付",status:"0"},{title:"已完成",status:"1"},{title:"已失效",status:"2"}],E=U((()=>(b.value=[],_[c.value].status))),A=()=>{N.loading({message:"加载中...",forbidClick:!0}),v.value=!0,q({condition:{orderTopStatus:E.value},pageSize:10,pageNum:p.value}).then((e=>{var t;v.value=!1;const{code:a,data:s}=e;"10000"===a&&s&&(1===p.value?(b.value=s.datas[0].applicationResList||[],f.value=s.datas[0].invalidNum,C.value=s.datas[0].totalNum,h.value=s.datas[0].validNum):b.value=[...b.value,...(null==(t=s.datas[0])?void 0:t.applicationResList)||[]]),g.value=!s||b.value.length>=(null==s?void 0:s.total)})).then((()=>{N.clear()}))},M=()=>{p.value+=1,A()},R=()=>{p.value=1,A()};return x(E,(()=>{p.value=1,A()})),T((()=>{A()})),(e,t)=>{const r=B,p=w,N=L;return s(),y(N,{"theme-vars":n(a)},{default:m((()=>[l("div",te,[i(G,{active:n(c),"onUpdate:active":t[0]||(t[0]=e=>j(c)?c.value=e:null),list:_,class:"tab","title-active-color":"#c41e21"},null,8,["active"]),n(b).length?(s(),o("div",ae,[u(" 共 "),l("span",se,d(n(C)),1),u(" 张保单 "),l("span",oe,d(n(h)),1),u(" 张有效 "),l("span",le,d(n(f)),1),u(" 张失效 ")])):I("",!0),n(b).length?(s(),y(r,{key:1,class:"body",loading:n(v),finished:n(g),onLoad:M},{default:m((()=>[(s(!0),o(W,null,P(n(b),((e,t)=>(s(),y(ee,{key:t,detail:e,onClick:t=>(e=>{const{orderNo:t,saleUserId:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n}=e;k("orderDetail",{orderNo:t,agentCode:a,tenantId:s,abbreviation:o,productCategory:l,applicationNo:d,orderId:n})})(e),onAfterDelete:R},null,8,["detail","onClick"])))),128))])),_:1},8,["loading","finished"])):(s(),o("div",de,[i(p,{title:"暂无投保单","empty-class":"empty-select"})])),ne])])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-7ae44c57"]]);export{re as default};
