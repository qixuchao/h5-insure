import{toRefs as e,reactive as o,computed as t,ref as u,onMounted as l,onBeforeMount as r,watch as a}from"vue";import{_ as n,aL as s,aM as c,K as d,a as v,u as i,aI as p,x as m,T as f}from"./index-d66a20d8.js";/* empty css              */import{P as C}from"./index-218bd70e.js";import{_ as h}from"./empty-ae586b6c.js";import{P as g,u as k}from"./ProductTips-58ffd84d.js";import{q as V,a as y}from"./proposalList-40dc08b4.js";import{P as N}from"./index-8caef2e8.js";import{c as P}from"./trial-0ac61dce.js";import"./pdfh5-e588f83d.js";const L={class:"com-product-item"},w={class:"content-wrap"},x={class:"product-image"},E={class:"insure-name"},B={class:"product-info"},S={class:"title"},b={class:"description"},I={class:"tags"};var _=n(vue.defineComponent({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(t){const u=t,{productInfo:l}=e(u),r=o({checked:!1});return e(r),(e,o)=>{var t,u,r,a,n;const s=vue.resolveComponent("van-image");return vue.openBlock(),vue.createElementBlock("div",L,[vue.createElementVNode("div",w,[vue.createElementVNode("div",x,[vue.createVNode(s,{src:(null==(t=vue.unref(l).showConfig)?void 0:t.fileThumbnailUrl)||(null==(u=vue.unref(l).showConfig)?void 0:u.fileUrl)},null,8,["src"]),vue.createElementVNode("p",E,vue.toDisplayString((vue.unref(l).insurerName||"").substring(0,6)),1)]),vue.createElementVNode("div",B,[vue.createElementVNode("p",S,vue.toDisplayString(null==(r=vue.unref(l).showConfig)?void 0:r.title),1),vue.createElementVNode("p",b,vue.toDisplayString(null==(a=vue.unref(l).showConfig)?void 0:a.text),1),vue.createElementVNode("p",I,[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(null==(n=vue.unref(l).showConfig)?void 0:n.tags,((e,o)=>(vue.openBlock(),vue.createElementBlock("span",{key:o,class:"tag"},vue.toDisplayString(e),1)))),128))])]),vue.renderSlot(e.$slots,"checkedProduct",{},void 0,!0)]),vue.createVNode(g,{"error-msg":e.errorMsg},null,8,["error-msg"])])}}}),[["__scopeId","data-v-d0dbf77c"]]);const M=["xlink:href"],T=vue.defineComponent({__name:"index",props:{name:{type:String,required:!0},color:{type:String,default:""}},setup(e){const o=e,u=t((()=>`#icon-${o.name}`)),l=t((()=>o.name?`svg-icon icon-${o.name}`:"svg-icon"));return(o,t)=>(vue.openBlock(),vue.createElementBlock("svg",vue.mergeProps({class:vue.unref(l)},o.$attrs,{style:{color:e.color}}),[vue.createElementVNode("use",{"xlink:href":vue.unref(u)},null,8,M)],16))}});const j=e=>(vue.pushScopeId("data-v-d36af93a"),e=e(),vue.popScopeId(),e),F={class:"com-tab-filter"},U={class:"article-mid"},z={class:"article-tag"},D=["onClick"],O=j((()=>vue.createElementVNode("span",null,null,-1))),R={class:"popup-inner"},$=j((()=>vue.createElementVNode("div",{class:"popup-title"},"保险公司",-1))),q={class:"footer-button"};var A=n(vue.defineComponent({__name:"insureFilter",props:{tagList:{type:Array,default:()=>[]},filter:{type:Boolean,default:!1},popupStyle:{type:Object,default:()=>{}}},emits:["onSelectInsure"],setup(t,{emit:a}){const{isPopShow:n,openPop:v,closePop:i}=function(e=!1){const o=vue.ref(e);return{isPopShow:o,openPop:e=>{e instanceof Function&&e(),o.value=!0},closePop:e=>{o.value=!1,e instanceof Function&&e()}}}(!1),p=o({insureList:[],checkedInsure:[],productCategoryList:[]}),{insureList:m,checkedInsure:f}=e(p),C=u(""),h=()=>{f.value=[]},g=()=>{var e;const{productCategoryId:o}=(null==(e=p.productCategoryList)?void 0:e[C.value])||{};a("onSelectInsure",{selectInsureCode:f.value,selectCategory:o}),i()};return l((()=>{s().then((e=>{const{code:o,data:t}=e;"10000"===o&&(m.value=null==t?void 0:t.map((e=>({label:e.abbreviation,value:e.insurerCode}))))}))})),r((()=>{V().then((e=>{const{code:o,data:t}=e||{};"10000"===o&&d(t)&&(p.productCategoryList=[{productCategoryName:"全部",productCategoryId:""},...t])}))})),(e,o)=>{const u=vue.resolveComponent("van-button"),l=vue.resolveComponent("van-popup");return vue.openBlock(),vue.createElementBlock("div",F,[vue.createElementVNode("div",U,[vue.createElementVNode("div",z,[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(vue.unref(p).productCategoryList,((e,o)=>(vue.openBlock(),vue.createElementBlock("div",{key:o,class:vue.normalizeClass(["tag-item",{checked:vue.unref(C)==o}]),onClick:t=>((e,o)=>{var t;C.value=o;const{productCategoryId:u}=(null==(t=p.productCategoryList)?void 0:t[C.value])||{};a("onSelectInsure",{selectInsureCode:f.value,selectCategory:u})})(null==e||e.productCategoryId,o)},[vue.createElementVNode("div",{class:vue.normalizeClass(["tag-out",{checked:vue.unref(C)==o}])},[vue.createElementVNode("div",{class:vue.normalizeClass(["tag-item-text",{checked:vue.unref(C)==o}])},vue.toDisplayString(e.productCategoryName),3)],2)],10,D)))),128))]),t.filter?(vue.openBlock(),vue.createElementBlock("div",{key:0,class:"filter",onClick:o[0]||(o[0]=(...e)=>vue.unref(v)&&vue.unref(v)(...e))},[O,vue.createElementVNode("div",{class:vue.normalizeClass(["text",{"has-select-condition":vue.unref(f).length>0}])},"筛选",2),vue.createVNode(T,{name:"filter"})])):vue.createCommentVNode("",!0),vue.createVNode(l,{show:vue.unref(n),position:"right","close-on-click-overlay":"",teleport:"body",class:"proposal-list-filter-popup-wrap","overlay-style":{"z-index":5e3},style:vue.normalizeStyle(t.popupStyle||{width:"322px",height:"100%",padding:"0 15px","z-index":5e3}),onClickOverlay:vue.unref(i)},{default:vue.withCtx((()=>[vue.createElementVNode("div",R,[$,vue.createVNode(c,{modelValue:vue.unref(f),"onUpdate:modelValue":o[1]||(o[1]=e=>vue.isRef(f)?f.value=e:null),options:vue.unref(m)},null,8,["modelValue","options"])]),vue.createElementVNode("div",q,[vue.createVNode(u,{plain:"",type:"primary",onClick:h},{default:vue.withCtx((()=>[vue.createTextVNode("重置")])),_:1}),vue.createVNode(u,{type:"primary",onClick:g},{default:vue.withCtx((()=>[vue.createTextVNode("确定")])),_:1})])])),_:1},8,["show","style","onClickOverlay"])])])}}}),[["__scopeId","data-v-d36af93a"]]);const K={class:"com-trial-product-wrapper"},W={class:"container"},G=(e=>(vue.pushScopeId("data-v-49f70a68"),e=e(),vue.popScopeId(),e))((()=>vue.createElementVNode("span",{class:"title"}," 已选产品 ",-1))),H={class:"popup-body"},J={class:"cell-title"},Q={class:"title"},X=vue.defineComponent({name:"TrialProductPopup"});var Y=n(vue.defineComponent({...X,props:{isShow:{type:Boolean,default:!1},proposalList:{default:()=>[]},modalValue:{default:()=>[]}},emits:["close","update:modalValue","checked"],setup(e,{emit:o}){const t=e,l=u([]),r=u([]),n=u({isShow:t.isShow}),s=()=>{o("close")},c=()=>{r.value=[],o("checked",[])},d=e=>{var t,u,a;null==(a=null==(u=null==(t=null==l?void 0:l.value)?void 0:t[e])?void 0:u.toggle)||a.call(u),o("checked",r.value)};return a((()=>t.isShow),(e=>{n.value.isShow=e})),a(r,((e=[])=>{o("update:modalValue",e)}),{deep:!0,immediate:!0}),a((()=>t.modalValue),((e=[])=>{r.value=e}),{deep:!0,immediate:!0}),(e,o)=>{const t=vue.resolveComponent("van-checkbox"),u=vue.resolveComponent("VanCell"),a=vue.resolveComponent("van-cell-group"),v=vue.resolveComponent("van-checkbox-group"),i=vue.resolveComponent("VanPopup");return vue.openBlock(),vue.createElementBlock("div",K,[vue.createVNode(i,{show:vue.unref(n).isShow,"onUpdate:show":o[1]||(o[1]=e=>vue.unref(n).isShow=e),position:"bottom",onClose:s},{default:vue.withCtx((()=>[vue.createElementVNode("div",W,[vue.createElementVNode("div",{class:"popup-header"},[vue.createElementVNode("span",{class:"clear-all",onClick:c}," 清空选项 "),G,vue.createElementVNode("span",{class:"close",onClick:s})]),vue.createElementVNode("div",H,[vue.createVNode(v,{modelValue:vue.unref(r),"onUpdate:modelValue":o[0]||(o[0]=e=>vue.isRef(r)?r.value=e:null)},{default:vue.withCtx((()=>[vue.createVNode(a,{inset:""},{default:vue.withCtx((()=>[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(e.proposalList,(e=>(vue.openBlock(),vue.createBlock(u,{key:e.productCode,title:e.productName,onClick:o=>d(e.productCode)},{"right-icon":vue.withCtx((()=>{var o;return[vue.createVNode(t,{ref_for:!0,ref:o=>vue.unref(l)[e.productCode]=o,shape:"square","model-value":null==(o=vue.unref(r))?void 0:o.includes(e.productCode),name:e.productCode,onClick:vue.withModifiers((o=>d(e.productCode)),["stop"])},null,8,["model-value","name","onClick"])]})),title:vue.withCtx((()=>[vue.createElementVNode("div",J,[vue.createElementVNode("div",Q,vue.toDisplayString(e.productName),1)])])),_:2},1032,["title","onClick"])))),128))])),_:1})])),_:1},8,["modelValue"])])])])),_:1},8,["show"])])}}}),[["__scopeId","data-v-49f70a68"]]);const Z={class:"search-wrap"},ee={class:"page-proposal-list"},oe={class:"check-button"},te={key:1,class:"van-sticky"},ue={class:"add-plan"},le={class:"has-select-product"},re=(e=>(vue.pushScopeId("data-v-35ed5c08"),e=e(),vue.popScopeId(),e))((()=>vue.createElementVNode("span",{class:"icon"},null,-1))),ae=vue.defineComponent({name:"ProposalList"});var ne=n(vue.defineComponent({...ae,props:{isCreateProposal:{type:Boolean,default:!0}},setup(u){const l=k(),a=v(),n=i(),{isCreateProposal:s}=n.query,c=p(),d=o({searchValue:"",tagLists:[],isOpen:!0,loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],showCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],firstLoading:!0}),{searchValue:g,tagLists:V,isOpen:L,loading:w,finished:x,refreshing:E,productList:B,selectProduct:S,insurerCodeList:b,showCategory:I,productTotal:M,showFooter:T}=e(d);m();const[j,F]=m(),U=()=>{const{excludeProductCodeList:e}=d;d.firstLoading&&f.loading("加载中..."),y({title:g.value,insurerCodeList:b.value,showCategory:I.value,excludeProductCodeList:Array.isArray(e)?e:[],pageNum:1,pageSize:999}).then((e=>{const{code:o,data:t,total:u}=e;"10000"===o&&(B.value=null==t?void 0:t.datas,M.value=u)})).finally((()=>{f.clear(),d.firstLoading=!1}))},z=e=>{U()},D=e=>{const{selectInsureCode:o,selectCategory:t}=e;b.value=o,I.value=t,U()},O=()=>{E.value&&(B.value=[],E.value=!1),U(),w.value=!1,M.value===B.value.length&&(x.value=!0)},R=()=>{a.push({path:"historyProposalList"})};t((()=>{var e;const{birthday:o,gender:t}=(null==(e=l.$state.proposalInfo.proposalInsuredList)?void 0:e[0])||{};return{birthday:o,gender:t}}));const $=t((()=>B.value.length>0)),q=({productCode:e})=>s?(d.productCode=e,d.selectProduct.includes(e)?(d.selectProduct=d.selectProduct.filter((o=>o!==e)),!1):void(async(e,o)=>{const{code:t,data:u,message:r}=await P({...l.$state.insuredPersonVO,calcProductFactorList:[{productCode:e}]},{isCustomError:!0});"10000"===t?(d.errorMsgMap[e]="","function"==typeof o&&o(!0)):d.errorMsgMap[e]=r})(e,(()=>{d.selectProduct.push(e)}))):(a.push({path:"/proposal/createProposal",query:{productCode:e}}),!1),K=e=>{d.selectProduct=e,d.selectedProductList=d.selectedProductList.filter((o=>e.includes(o.productCode)))},W=()=>{const e=d.proposalList.filter((e=>d.selectProduct.includes(e.proposalInsuredList[0].proposalInsuredProductList[0].productCode)));l.setTrialData(e),l.setSelectedProduct(d.selectProduct),a.back()},G=()=>{x.value=!0,w.value=!0,O()};return r((()=>{d.excludeProductCodeList=l.$state.excludeProduct})),(e,o)=>{const t=vue.resolveComponent("van-search"),u=vue.resolveComponent("van-checkbox"),l=vue.resolveComponent("van-list"),r=vue.resolveComponent("van-pull-refresh"),a=vue.resolveComponent("van-button"),n=vue.resolveComponent("ProPageWrap"),v=vue.resolveComponent("van-config-provider");return vue.openBlock(),vue.createBlock(v,{"theme-vars":vue.unref(c)},{default:vue.withCtx((()=>[vue.createVNode(n,{class:"page-proposal"},{default:vue.withCtx((()=>[vue.createElementVNode("div",Z,[vue.createVNode(t,{modelValue:vue.unref(g),"onUpdate:modelValue":o[0]||(o[0]=e=>vue.isRef(g)?g.value=e:null),placeholder:"搜索计划书",shape:"round",class:"search",onSearch:z},null,8,["modelValue"]),vue.createVNode(A,{filter:vue.unref(L),"onUpdate:filter":o[1]||(o[1]=e=>vue.isRef(L)?L.value=e:null),"filter-class":"filter-area",onOnSelectInsure:D},null,8,["filter"])]),vue.unref($)||vue.unref(d).firstLoading?vue.createCommentVNode("",!0):(vue.openBlock(),vue.createBlock(C,{key:0,"empty-img":vue.unref(h),title:"没有找到相关内容~","empty-class":"empty-select"},null,8,["empty-img"])),vue.createElementVNode("div",ee,[vue.createVNode(r,{modelValue:vue.unref(E),"onUpdate:modelValue":o[3]||(o[3]=e=>vue.isRef(E)?E.value=e:null),onRefresh:G},{default:vue.withCtx((()=>[vue.createVNode(l,{loading:vue.unref(w),"onUpdate:loading":o[2]||(o[2]=e=>vue.isRef(w)?w.value=e:null),finished:vue.unref(x),"finished-text":vue.unref($)?"- 已经到底了哦 -":"",onLoad:O},{default:vue.withCtx((()=>[(vue.openBlock(!0),vue.createElementBlock(vue.Fragment,null,vue.renderList(vue.unref(B),(e=>(vue.openBlock(),vue.createBlock(_,{key:e.id,"product-info":e,"error-msg":vue.unref(d).errorMsgMap[e.productCode],onClick:o=>q(e)},vue.createSlots({_:2},[vue.unref(s)?{name:"checkedProduct",fn:vue.withCtx((()=>[vue.createElementVNode("div",oe,[(vue.openBlock(),vue.createBlock(u,{key:e.id,name:e.productCode,"model-value":vue.unref(d).selectProduct.includes(e.productCode),shape:"square",onChange:o=>((e,o)=>{e?d.selectedProductList.push(o):d.selectedProductList=d.selectedProductList.filter((e=>e.productCode!==o.productCode))})(o,e)},null,8,["name","model-value","onChange"]))])])),key:"0"}:void 0]),1032,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])]),vue.unref(s)&&vue.unref(T)?(vue.openBlock(),vue.createElementBlock("div",te,[vue.createElementVNode("div",ue,[vue.createElementVNode("p",{class:"has-select",onClick:o[4]||(o[4]=e=>vue.unref(F)(!vue.unref(j)))},[vue.createTextVNode(" 已选"),vue.createElementVNode("span",le,vue.toDisplayString(vue.unref(d).selectProduct.length),1),vue.createTextVNode("款产品 "),re]),vue.createVNode(a,{type:"primary",disabled:!vue.unref(d).selectProduct.length,onClick:W},{default:vue.withCtx((()=>[vue.createTextVNode("添加计划书")])),_:1},8,["disabled"])])])):vue.createCommentVNode("",!0),vue.createVNode(Y,{"modal-value":vue.unref(d).selectProduct,"proposal-list":vue.unref(d).selectedProductList,"is-show":vue.unref(j),onClose:o[5]||(o[5]=e=>vue.unref(F)(!1)),onChecked:K},null,8,["modal-value","proposal-list","is-show"])])),_:1}),vue.unref(s)?vue.createCommentVNode("",!0):(vue.openBlock(),vue.createBlock(N,{key:0,"button-image":vue.unref("/static/png/lishijihuashu-b6958e78.png"),onClick:R},null,8,["button-image"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-35ed5c08"]]);export{ne as default};
