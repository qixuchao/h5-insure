import{h as e,L as a,Z as t,k as r,l as o,m as l,n,z as d,X as s,A as i,r as u,P as c,x as I,y as v,F as A,E as p,C as m,I as f,J as g,s as C,a3 as D,a4 as h,a8 as E,N as S,j as O,Q as P,T as w,d as y,av as T}from"./vendor-0381d15c.js";import{p as x}from"./product-b070a0d5.js";import{q as b,g as U,a as k,i as L}from"./trial-947b6d41.js";import{P as V}from"./index-1464f7bd.js";import{_ as G,o as Q,ad as Y}from"./index-ee8ceb03.js";import{a as N}from"./trial-07e9a605.js";import{c as B}from"./utils-c6e3e953.js";import{u as R,s as M}from"./core-7eb3f98a.js";import{a as j}from"./order-7fed145f.js";import{u as z}from"./theme-126054aa.js";import{s as K}from"./useStorage-05df32a8.js";import{O as W}from"./infoCollection-df5ee04b.js";import"./index-38a8c5cf.js";const H={class:"pro-curtain"},q=["src"];var F=G(e({props:{show:{type:Boolean,default:!0}},emits:["close"],setup(e,{emit:u}){const c=e,I=a({show:c.show});return t((()=>c.show),(()=>{I.show=c.show}),{immediate:!0}),(e,a)=>{const t=r("van-overlay");return o(),l(t,{show:i(I).show},{default:n((()=>[d("div",H,[s(e.$slots,"default",{},void 0,!0),d("img",{class:"close",src:i("data:image/png;base64,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"),onClick:a[0]||(a[0]=e=>u("close"))},null,8,q)])])),_:3},8,["show"])}}}),[["__scopeId","data-v-4c1ecdfa"]]);const J={class:"guarantee-list"},Z=(e=>(D("data-v-cb90a938"),e=e(),h(),e))((()=>d("div",{class:"title"},"保障内容",-1))),X=["src"];var _=G(e({props:{dataSource:{type:Array,default:()=>[]},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:10}},setup(e){const a=e,n=u(a.dataSource||[]),[s,D]=c(!1),h=I((()=>{var e;return!(!n.value||!(null==(e=n.value)?void 0:e.length))&&(n.value.length>a.count&&(!!a.isShowClose||!s.value))})),E=()=>{D()},S=I((()=>{var e;return n.value&&(null==(e=n.value)?void 0:e.length)?n.value.length<=a.count||s.value?n.value:n.value.slice(0,a.count):[]}));return t((()=>a.dataSource),(()=>{n.value=a.dataSource})),(e,a)=>{const t=r("ProCell");return o(),v("div",J,[Z,(o(!0),v(A,null,p(i(S),((e,a)=>(o(),l(t,{key:a,title:e.title,content:e.desc,border:!1},null,8,["title","content"])))),128)),i(h)?(o(),v("div",{key:0,class:"show-more",onClick:E},[m(f(i(s)?"收起":"查看更多")+" ",1),d("img",{src:i("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAjNJREFUOE+1VEtPE1EUPufM9GXKCnWlqAQZuhEff8CNxpYdSReVatIWJMYI7FkYF+wtxsSCBWNLY4JhZxHd+AdMqhs6PmJJWMkPsO303mPmQs10GJuawOxu5tzvfK9chCP+8Ijx4HgAVyZGskgQEgIXJkvbO//D+sXtyDlN43mW8Du9Vp1VDPNJ4xkiRoC5DhKz6VJ1qxfQ/MTITUSeA8QgM29niuYDBbh6/XyQzwZmAPCWfUbmLdAb2dTLWt0LeDE6FOjr12YYMfp3freRTX2s1Ts8VBuJZwEwxBJ2SMDj1OtqzQn66u7gQIt9jwDwgq1IAixOFs137ZlDobgvMPPTzNrXTaUkcfEG6zTXbaFnyrakcL/+EBBi+5vlB2Cy2meW8j35mk+8LOlaG8VII9v0kA3LzA1gXmwz9vJXAS4njRQC+qnR2kivf99zDubigwO+gH8egbUWwsJUwfzp/L8SHzolA/o4Azeniubqfm3uGBlgPMMITSnE5r3St0ovtXmeHB7VkWLI4Afk3UzBzCvA3DXwkWHEiPCyqgFxxQqGy9NLnywvYHtejxhRALyiHJZckWGzPL0EVoeHzo3Mcs8i8eZ+4cevDgsSwydJwzgBngYAS0hRdio6FErOdYGkKKcOLFhOGJdQxzFbor2QmnLd7blnym5JguUXImohw1WVNsjP4kTfWy9LutZGMSIcQwT/gWzLyfiftemWqG2BT6NxZqYmtTbcnrrvHs972Evnep35AykjACSCRaPlAAAAAElFTkSuQmCC"),class:g(["icon",{showMore:i(s)}])},null,10,X)])):C("",!0)])}}}),[["__scopeId","data-v-cb90a938"]]);const $=Q([{value:j.PENDING,label:"待处理"},{value:j.PAYING,label:"订单未完成，逾期将失效"},{value:j.PAYMENT_SUCCESS,label:"支付成功"},{value:j.PAYMENT_FAILED,label:"支付失败"},{value:j.CANCELED,label:"已失效"},{value:j.ACCEPT_POLICY,label:"投保成功"},{value:j.INSURER_REJECT,label:"保司拒保"},{value:j.TIMEOUT,label:"订单已经关闭"},{value:j.UNDER_WRITING_SUCCESS,label:"核保通过"},{value:j.NOTE,label:"照会"},{value:j.INSURANCE_PROCESSING,label:"保司处理中"}]),ee={[j.ACCEPT_POLICY]:"恭喜 您已成功购买保障",[j.CANCELED]:"赠险保单已失效",[j.PAYING]:"剩余支付时间：23:59:59",[j.TIMEOUT]:"请您重新提交订单"};const ae=e=>(D("data-v-7b961ef8"),e=e(),h(),e),te={class:"page-pay-result"},re={class:"header"},oe={class:"product-status"},le=["innerHTML"],ne={class:"prodouct-container"},de={class:"product-card"},se={class:"product-name"},ie={class:"label"},ue={class:"value"},ce={key:1,class:"desc"},Ie=[m("已有"),ae((()=>d("span",null,"29,182",-1))),m("位用户已投保")],ve=["src"],Ae=ae((()=>d("div",{class:"footer-desc"},[d("div",null,"客服电话"),d("div",null,"400 605 8000")],-1))),pe=["src"];var me=G(e({setup(e){const t=z();E();const s=S(),{tenantId:c,from:m="other",orderNo:g,productCode:D}=s.query,h=a({insureDetail:{},detail:{},orderDetail:{},showOrderDetail:!1,guaranteeItemVOS:[],pageInfo:{title:"",desc:"",insureList:[],productImage:"",notificationImage:""},timeDown:{},templateId:"2"}),G=u(!1),Q=I((()=>[j.ACCEPT_POLICY,j.CANCELED,j.PAYMENT_SUCCESS].includes(h.orderDetail.orderStatus)?"下载保单":j.PAYING===h.orderDetail.orderStatus?"立即支付":j.TIMEOUT===h.orderDetail.orderStatus?"重下一单":"")),H=async(e=!1)=>{var a,t,r,o;try{const{insurerCode:l}=h.insureDetail.productBasicInfoVO;delete h.orderDetail.extInfo.extraInfo.templateId;const n={insurerCode:l,productCode:e?null==(t=null==(a=h.insureDetail)?void 0:a.productBasicInfoVO)?void 0:t.upgradeGuaranteeConfigVO.productCode:D,tenantId:c,agencyCode:h.orderDetail.agencyId,agentCode:h.orderDetail.agentCode,saleChannelId:null==(o=null==(r=h.orderDetail.extInfo)?void 0:r.extraInfo)?void 0:o.saleChannelId,extraMap:{...h.orderDetail.extInfo.extraInfo}};delete n.extraMap.templateId;const{code:d,data:s}=await b(n);if("10000"===d){if(!e){const{tenantOrderHolder:e,tenantOrderInsuredList:a}=h.orderDetail;K.set(W,{tenantOrderHolder:e,tenantOrderInsuredList:a})}window.location.href=s||""}}catch(l){}},q=async()=>{var e,a,t,r,o;if("下载保单"===Q.value)if(null==(e=h.orderDetail.extInfo)?void 0:e.policyUrl)(null==(r=h.orderDetail.extInfo)?void 0:r.policyUrl)&&Y(null==(o=h.orderDetail.extInfo)?void 0:o.policyUrl);else{const e=await U({orderNo:g,tenantId:c});"10000"===e.code&&(h.orderDetail=e.data,(null==(a=h.orderDetail.extInfo)?void 0:a.policyUrl)?Y(null==(t=h.orderDetail.extInfo)?void 0:t.policyUrl):w("下载保单地址待定"))}else"立即支付"===Q.value?k({...h.orderDetail,extInfo:{...h.orderDetail.extInfo,redirectUrl:window.location.href}}).then((({code:e,data:a})=>{"10000"===e&&M(a.paymentUrl)})):"重下一单"===Q.value&&H(!1)},J=async()=>{const e=x({productCode:D,withInsureInfo:!0,tenantId:c}),a=U({orderNo:g,tenantId:c}),t=L({productCode:D});Promise.all([e,a,t]).then((([e,a,t])=>{"10000"===e.code&&(h.detail=e.data),"10000"===t.code&&(h.insureDetail=t.data),"10000"===a.code&&(h.orderDetail=a.data),(()=>{var e,a,t,r,o,l,n,d,s,i,u,c,I,v,A,p,f,g,C,D,E,S,O,P,w,x,b;[j.PAYMENT_SUCCESS,j.ACCEPT_POLICY].includes(h.orderDetail.orderStatus)&&(h.orderDetail.orderStatus=j.ACCEPT_POLICY),h.pageInfo.title=$[h.orderDetail.orderStatus],h.pageInfo.desc=ee[h.orderDetail.orderStatus],document.title=(null==(a=null==(e=h.detail)?void 0:e.tenantProductInsureVO)?void 0:a.productName)||"";let U="";if("free"===m?h.orderDetail.tenantOrderInsuredList[0].tenantOrderProductList.forEach((e=>U?null:(e.tenantOrderRiskList.forEach((e=>{1!==e.riskType||U||(U=B(e.insurancePeriodValue,N[e.insurancePeriodType]))})),!1))):(h.pageInfo.insureList=[{label:"本期缴费金额",value:`${h.orderDetail.orderAmount}元`}],U=`${y(h.orderDetail.commencementTime).format("YYYY.MM.DD")}到${y(h.orderDetail.expiryDate).format("YYYY.MM.DD")}`),h.pageInfo.insureList=[...h.pageInfo.insureList,{label:"被保人",value:null==(o=null==(r=null==(t=h.orderDetail)?void 0:t.tenantOrderInsuredList)?void 0:r[0])?void 0:o.name},{label:"保障期间",value:U||""}],h.templateId=h.orderDetail.extInfo.templateId,"free"!==m&&[j.PAYING,j.TIMEOUT].includes(h.orderDetail.orderStatus)?h.showOrderDetail=!0:(null==(n=null==(l=h.insureDetail)?void 0:l.productBasicInfoVO)?void 0:n.upgradeGuaranteeConfigVO.productCode)&&(h.pageInfo.notificationImage=(null==(u=null==(i=null==(s=null==(d=h.insureDetail)?void 0:d.productBasicInfoVO)?void 0:s.upgradeGuaranteeConfigVO)?void 0:i.notificationImage)?void 0:u[0])||"",h.pageInfo.productImage=(null==(A=null==(v=null==(I=null==(c=h.insureDetail)?void 0:c.productBasicInfoVO)?void 0:I.upgradeGuaranteeConfigVO)?void 0:v.productImage)?void 0:A[0])||"",G.value=!0),j.PAYING===h.orderDetail.orderStatus){const e=null==(f=null==(p=h.orderDetail.tenantOrderPaymentInfoList)?void 0:p[0])?void 0:f.paymentExpiryDate;h.timeDown=T({time:y(e).diff(new Date,"millisecond")}),h.timeDown.start()}try{const e=null==(g=h.orderDetail.tenantOrderInsuredList)?void 0:g[0].planCode;(null==(D=null==(C=h.detail)?void 0:C.tenantProductInsureVO)?void 0:D.planInsureVO)?h.guaranteeItemVOS=(null==(b=null==(x=null==(w=h.detail)?void 0:w.tenantProductInsureVO)?void 0:x.planInsureVO)?void 0:b.guaranteeItemVOS)||[]:h.guaranteeItemVOS=(null==(P=null==(O=null==(S=null==(E=h.detail)?void 0:E.tenantProductInsureVO)?void 0:S.planList.filter((a=>a.planCode===e)))?void 0:O[0])?void 0:P.guaranteeItemVOS)||[]}catch(k){}})()}))},Z=I((()=>{var e;return j.PAYING===(null==(e=h.orderDetail)?void 0:e.orderStatus)?h.timeDown.current.total<=0?(h.orderDetail.orderStatus=j.TIMEOUT,h.pageInfo.title=$[h.orderDetail.orderStatus],h.pageInfo.desc=ee[h.orderDetail.orderStatus],h.timeDown.pause(),h.pageInfo.desc):`剩余支付时间：${h.timeDown.current.hours}:${h.timeDown.current.minutes}:${h.timeDown.current.seconds}`:h.pageInfo.desc}));return R(),O((()=>{J()})),(e,a)=>{const s=r("van-config-provider");return o(),l(s,{"theme-vars":i(t)},{default:n((()=>{var e,r;return[d("div",te,[d("div",re,[d("div",oe,f(i(h).pageInfo.title),1),"重下一单"!==i(Q)||"3"!==i(h).templateId.toString()?(o(),v("div",{key:0,class:"desc",innerHTML:i(Z)},null,8,le)):C("",!0)]),d("div",ne,[d("div",de,[d("div",se,f((null==(r=null==(e=i(h).insureDetail)?void 0:e.productBasicInfoVO)?void 0:r.productName)||""),1),(o(!0),v(A,null,p(i(h).pageInfo.insureList,((e,a)=>(o(),v("div",{key:a,class:"list"},[d("span",ie,f(e.label),1),d("span",ue,f(e.value),1)])))),128)),"重下一单"!==i(Q)||"3"!==i(h).templateId.toString()?(o(),l(V,{key:0,"theme-vars":i(t),class:"btn",text:i(Q),onClick:q},null,8,["theme-vars","text"])):C("",!0),i(h).showOrderDetail?(o(),v("div",ce,Ie)):C("",!0)]),i(h).pageInfo.productImage?(o(),v("img",{key:0,class:"product-img",src:i(h).pageInfo.productImage,onClick:a[0]||(a[0]=e=>H(!0))},null,8,ve)):C("",!0),i(h).showOrderDetail?(o(),l(_,{key:1,"is-show-close":"",count:5,"data-source":i(h).guaranteeItemVOS},null,8,["data-source"])):C("",!0),Ae])]),P(F,{show:G.value,"onUpdate:show":a[2]||(a[2]=e=>G.value=e),onClose:a[3]||(a[3]=e=>G.value=!1)},{default:n((()=>[d("img",{class:"jump-img",src:i(h).pageInfo.notificationImage,style:{display:"block"},onClick:a[1]||(a[1]=e=>H(!0))},null,8,pe)])),_:1},8,["show"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-7b961ef8"]]);export{me as default};
