import{l as e,a as l,P as a}from"./index-02d52ec0.js";import{d as i,z as s,o as t,a1 as n,R as o,c as r,A as u,V as d,U as c,g as p,i as v,w as m,h as f,k,G as I,aN as y,r as L,e as b,f as h,aO as g,aP as V,aZ as R,aT as C,L as x,a_ as P,a$ as O,F as T,E as w,b0 as S,aR as D,am as _,an as F,ah as E,j as M,aB as N,b1 as A,a3 as Y,ab as U,B as $,b2 as j,b3 as B,u as X,a as q,$ as K,n as Q,av as H,T as W,P as z,p as G}from"./index-cd20886f.js";import{_ as J}from"./index-868300ad.js";/* empty css              */import{S as Z}from"./index-c6cb6249.js";import{P as ee}from"./index-cc6f3fad.js";import{S as le,_ as ae}from"./box-title-0dd8305f.js";import{_ as ie}from"./index-4a96b1a8.js";import{_ as se}from"./empty-ae586b6c.js";import{R as te}from"./trial-3f568f82.js";import{u as ne,b as oe,p as re,q as ue,c as de}from"./trial-f6807009.js";import{u as ce}from"./useOrder-5a938d4e.js";import{t as pe}from"./utils-06172306.js";import{P as ve,B as me}from"./constants-7afb7c3d.js";import{n as fe}from"./nextStep-2b51d90e.js";const ke={key:0},Ie={key:0,class:"risk2-field"},ye=i({name:"ProductRiskList"});var Le=I(i({...ye,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(e,{emit:l}){const a=e,i=s({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),I=e=>{const l=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&l.push({...e}),[]))),l},L=(e,s,t)=>{var n;i.riskIsInsure[s].data=e;const o=[...i.disabledRiskInfo];null==(n=a.dataSource.insureProductRiskVOList)||n.forEach((e=>{if(1!==e.mainRiskFlag){const l=i.riskIsInsure[e.riskId];l.data&&Object.keys(l.data).length>0&&"1"===l.selected&&o.push(l.data)}})),l("trialChange",o,t)},b=(e,l)=>{var s;null==(s=a.dataSource.productRiskRelationVOList)||s.forEach((a=>{1!==a.collocationType&&(l.riskId===a.riskId?(i.riskIsInsure[l.riskId]&&i.riskIsInsure[l.riskId].selected,2===a.collocationType&&i.riskIsInsure[a.collocationRiskId]&&(i.riskIsInsure[a.collocationRiskId].selected=e),3===a.collocationType&&i.riskIsInsure[a.collocationRiskId]&&"1"===e&&(i.riskIsInsure[a.collocationRiskId].selected="1"===e?"2":"1")):l.riskId===a.collocationRiskId&&(3===a.collocationType&&"1"===e&&i.riskIsInsure[a.riskId]&&(i.riskIsInsure[a.riskId].selected="1"===e?"2":"1"),2===a.collocationType&&i.riskIsInsure[a.riskId]&&(i.riskIsInsure[a.riskId].selected=e)))})),"2"===e?L({},l.riskId):(e=>{var l,a,i,s,t,n,o,r,u,d,c,p;if(1!==(null==e?void 0:e.factorDisPlayFlag)){const v=null==(l=null==e?void 0:e.productRiskInsureLimitVO)?void 0:l.amountPremiumConfigVO,m={riskCategory:e.riskCategory,riskCode:e.riskCode,riskName:e.riskName,riskId:e.riskId,riskType:e.riskType,mainRiskId:e.mainRiskId,mainRiskCode:e.mainRiskCode,liabilityList:I(e)};m.chargePeriod=(null==(i=null==(a=null==e?void 0:e.productRiskInsureLimitVO)?void 0:a.paymentPeriodValueList)?void 0:i.length)>0&&(null==(s=null==e?void 0:e.productRiskInsureLimitVO)?void 0:s.paymentPeriodValueList[0].code)||null,m.coveragePeriod=(null==(n=null==(t=null==e?void 0:e.productRiskInsureLimitVO)?void 0:t.insurancePeriodValueList)?void 0:n.length)>0&&(null==(o=null==e?void 0:e.productRiskInsureLimitVO)?void 0:o.insurancePeriodValueList[0].code)||null,m.paymentFrequency=(null==(u=null==(r=null==e?void 0:e.productRiskInsureLimitVO)?void 0:r.paymentFrequencyList)?void 0:u.length)>0&&(null==(d=null==e?void 0:e.productRiskInsureLimitVO)?void 0:d.paymentFrequencyList[0].code)||null;let f=0;1===v.displayType?f=(null==v?void 0:v.minStepValue)>0?null==v?void 0:v.minStepValue:0:3===v.displayType&&2===v.requireCopies?f=(null==(c=null==v?void 0:v.displayValues)?void 0:c.length)>0?null==v?void 0:v.displayValues[0].value:0:3===v.displayType&&1===v.requireCopies?(f=(null==(p=null==v?void 0:v.displayValues)?void 0:p.length)>0?null==v?void 0:v.displayValues[0].value:0,m.copy=v.minCopiesValue):2===v.displayType?m.copy=v.minCopiesValue:f=0,1===v.saleMethod?m.initialAmount=f:m.initialPremium=f,L(m,e.riskId)}})(l)};return t((()=>{(()=>{var e,l;i.disabledRiskInfo=[];let s=null;if(null==(e=a.dataSource.insureProductRiskVOList)||e.forEach((e=>{var l;const t=1!==e.mainRiskFlag?null==(l=a.dataSource.productRiskRelationVOList)?void 0:l.find((l=>l.collocationRiskId===e.riskId)):{};1===e.mainRiskFlag&&(s=e),i.riskIsInsure[e.riskId]?(i.riskIsInsure[e.riskId].data=null,i.riskIsInsure[e.riskId].relation=t,i.riskIsInsure[e.riskId].isMust=!1):i.riskIsInsure[e.riskId]={selected:"2",data:null,relation:t,isMust:!1}})),s){const e=null==(l=a.dataSource.productRiskRelationVOList)?void 0:l.filter((e=>e.riskId===s.riskId));if(!e)return;null==e||e.forEach((e=>{var l,s,t,n,o,r,u,d,c,p,v,m,f,k,y;if(2===e.collocationType){i.riskIsInsure[e.collocationRiskId].selected="1",i.riskIsInsure[e.collocationRiskId].isMust=!0;const b=null==(l=a.dataSource.insureProductRiskVOList)?void 0:l.find((l=>e.collocationRiskId===l.riskId));if(b&&1!==b.factorDisPlayFlag&&(null==(s=null==b?void 0:b.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO)){const l=null==(t=b.riskLiabilityInfoVOList)?void 0:t.every((e=>1!==e.showFlag)),a=null==(n=null==b?void 0:b.productRiskInsureLimitVO)?void 0:n.amountPremiumConfigVO;if(l){i.riskIsInsure[e.collocationRiskId].isDisabled=!0;const l={riskCategory:b.riskCategory,riskCode:b.riskCode,riskName:b.riskName,riskId:b.riskId,riskType:b.riskType,mainRiskId:b.mainRiskId,mainRiskCode:b.mainRiskCode,liabilityList:I(b)};l.chargePeriod=(null==(r=null==(o=null==b?void 0:b.productRiskInsureLimitVO)?void 0:o.paymentPeriodValueList)?void 0:r.length)>0&&(null==(u=null==b?void 0:b.productRiskInsureLimitVO)?void 0:u.paymentPeriodValueList[0].code)||null,l.coveragePeriod=(null==(c=null==(d=null==b?void 0:b.productRiskInsureLimitVO)?void 0:d.insurancePeriodValueList)?void 0:c.length)>0&&(null==(p=null==b?void 0:b.productRiskInsureLimitVO)?void 0:p.insurancePeriodValueList[0].code)||null,l.paymentFrequency=(null==(m=null==(v=null==b?void 0:b.productRiskInsureLimitVO)?void 0:v.paymentFrequencyList)?void 0:m.length)>0&&(null==(f=null==b?void 0:b.productRiskInsureLimitVO)?void 0:f.paymentFrequencyList[0].code)||null;let s=0;1===a.displayType?s=(null==a?void 0:a.minStepValue)>0?null==a?void 0:a.minStepValue:0:3===a.displayType&&2===a.requireCopies?s=(null==(k=null==a?void 0:a.displayValues)?void 0:k.length)>0?null==a?void 0:a.displayValues[0].value:0:3===a.displayType&&1===a.requireCopies?(s=(null==(y=null==a?void 0:a.displayValues)?void 0:y.length)>0?null==a?void 0:a.displayValues[0].value:0,l.copy=a.minCopiesValue):2===a.displayType&&(l.copy=a.minCopiesValue),1===a.saleMethod?l.initialAmount=s:l.initialPremium=s,i.disabledRiskInfo.push(l),L(l,b.riskId)}}}3===e.collocationType&&(i.riskIsInsure[e.collocationRiskId].selected="2",i.riskIsInsure[e.collocationRiskId].isMust=!0)}))}})()})),n((()=>{i.loading=!0})),o((()=>i.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>a.defaultValue),(e=>{(null==e?void 0:e.length)>0&&e.forEach((e=>{i.risksDefaultValue[e.riskCode]=e,i.riskIsInsure[e.riskId]?(i.riskIsInsure[e.riskId].selected="1",L(e,e.riskId)):i.riskIsInsure[e.riskId]={selected:"1",isMust:!1}}))}),{deep:!0,immediate:!0}),(l,a)=>{const s=Z,t=y;return r(!0),u(c,null,d(e.dataSource.insureProductRiskVOList,(a=>{var n,o;return r(),u(c,{key:a.riskCode},[(!e.showMainRisk&&1!==a.mainRiskFlag||e.showMainRisk)&&(null==(o=null==(n=p(i).riskIsInsure)?void 0:n[a.riskId])?void 0:o.relation)?(r(),u("div",ke,[v(t,{modelValue:p(i).riskIsInsure[a.riskId].selected,"onUpdate:modelValue":e=>p(i).riskIsInsure[a.riskId].selected=e,label:a.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:m((()=>[v(s,{modelValue:p(i).riskIsInsure[a.riskId].selected,"onUpdate:modelValue":e=>p(i).riskIsInsure[a.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"0.74rem",disabled:p(i).riskIsInsure[a.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>b(e,a)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===p(i).riskIsInsure[a.riskId].selected?(r(),u("div",Ie,[v(J,{modelValue:p(i).riskIsInsure[a.riskId].data,"onUpdate:modelValue":e=>p(i).riskIsInsure[a.riskId].data=e,"origin-data":a,"product-factor":e.dataSource.productFactor,"default-value":p(i).risksDefaultValue[a.riskCode],onTrialChange:(e,l)=>L(e,a.riskId,l)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):f("",!0),1===a.exemptFlag&&"1"===p(i).riskIsInsure[a.riskId].selected?k(l.$slots,"holderForm",{key:1},void 0,!0):f("",!0)])):f("",!0)],64)})),128)}}}),[["__scopeId","data-v-04703dac"]]);const be={class:"pro-radio-wrap"},he=i({name:"PlanSelect"}),ge=i({...he,props:{planList:{default:()=>[]},defaultPlan:{default:()=>{}}},emits:["planChange"],setup(e,{emit:l}){const a=e,i=L("");let s=!1;return n((()=>{a.defaultPlan&&(s=!0,i.value=a.defaultPlan.planCode)})),o((()=>i),(e=>{s||l("planChange",i.value),s&&(s=!1)}),{deep:!0,immediate:!0}),(l,s)=>{const t=g,n=V;return e.planList.length>0?(r(),b(n,{key:0,modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),label:"保障计划",name:"planCode",class:"risk-select-field"},{input:m((()=>[h("div",be,[v(t,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=e=>i.value=e),options:a.planList.map((e=>({label:e.planName,value:e.planCode})))},null,8,["modelValue","options"])])])),_:1},8,["modelValue"])):f("",!0)}}});var Ve=I(i({__name:"ScrollWrap",props:{moduleValue:{type:Number,default:0},scrollX:{type:Boolean,default:!1},scrollY:{type:Boolean,default:!1}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:l}){const a=e,i=s({offsetX:0,offsetY:0,startX:0,startY:0}),t=L(null),d=L(null),{width:c,height:v}=R(t),{width:m,height:f}=R(d),I=C("PRO_TABLE_KEY"),y=x((()=>{const e=c.value>m.value+4;return l("update:needFixed",e),e})),b=x((()=>v.value>f.value+4)),{direction:h}=P(t,{passive:!1,onSwipeStart(e){const{clientX:l,clientY:a}=e.touches[0];i.startX=l,i.startY=a},onSwipe(e){const{clientX:l,clientY:a}=e.touches[0];if(["LEFT","RIGHT"].includes(h.value)){const e=i.offsetX-(i.startX-l);e>-c.value+m.value&&e<0&&(i.offsetX=e,I.state.offsetX=i.offsetX),i.startX=l}if(["UP","DOWN"].includes(h.value)){const e=i.offsetY-(i.startY-a);e>-v.value+f.value&&e<0&&(i.offsetY=e,I.state.offsetY=i.offsetY),i.startY=a}},onSwipeEnd(e){}}),g=x((()=>a.scrollX||a.scrollY?`transform: translate(${a.scrollX?`${i.offsetX}px`:0},${a.scrollY?`${i.offsetY}px`:0} );`:""));return o((()=>null==I?void 0:I.state),(()=>{const{offsetX:e,offsetY:l}=(null==I?void 0:I.state)||{};y.value&&(i.offsetX=e),b.value&&(i.offsetY=l)}),{deep:!0,immediate:!0}),n((()=>{var e;d.value=null==(e=t.value)?void 0:e.parentElement})),(e,l)=>(r(),u("div",{ref_key:"swiperEl",ref:t,class:"scroll-wrap",style:O(p(g))},[k(e.$slots,"default",{},void 0,!0)],4))}}),[["__scopeId","data-v-0ba94815"]]);const Re={class:"pro-com-table-wrap"},Ce={ref:"tableHeadRef",class:"com-table"},xe={class:"com-table-head"},Pe={class:"com-table-row"},Oe={ref:"tableBodyRef",class:"com-table"},Te={class:"com-table-head"},we={class:"com-table-row"},Se={class:"com-table-body"};var De=I(i({__name:"Table",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},translateY:{type:Number,default:0}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:l}){const a=e=>{l("update:needFixed",e)};return(l,i)=>(r(),u("div",Re,[v(Ve,{ref:"tableScroll",class:"pro-table-head","scroll-x":"","onUpdate:needFixed":a},{default:m((()=>[h("table",Ce,[h("thead",xe,[h("tr",Pe,[(r(!0),u(c,null,d(e.columns,((e,l)=>(r(),u("th",{key:l,class:T(["table-cell",`table-cell-${l}`]),style:O({minWidth:`${e.width||80}px`})},w(e.title),7)))),128))])])],512)])),_:1},512),v(Ve,{ref:"tableScroll",class:"pro-table-body","scroll-y":"","scroll-x":""},{default:m((()=>[h("table",Oe,[h("thead",Te,[h("tr",we,[(r(!0),u(c,null,d(e.columns,((e,l)=>(r(),u("th",{key:l,class:T(["table-cell",`table-cell-${l}`]),style:O({minWidth:`${e.width||80}px`})},w(e.title),7)))),128))])]),h("tbody",Se,[(r(!0),u(c,null,d(e.data,((l,a)=>(r(),u("tr",{key:a,class:"com-table-row"},[(r(!0),u(c,null,d(e.columns,((e,i)=>(r(),u("td",{key:i,class:T(["table-cell"])},[h("span",null,w(e.render?e.render(l,a):l[e.key]),1)])))),128))])))),128))])],512)])),_:1},512)]))}}),[["__scopeId","data-v-f37eb4be"]]);const _e=e=>(_("data-v-0cf962f9"),e=e(),F(),e),Fe={key:0,class:"pro-table-wrap"},Ee={key:1,class:"no-data-wrap"},Me=[_e((()=>h("img",{src:se,alt:"暂无数据"},null,-1))),_e((()=>h("span",null,"暂无数据～",-1)))];var Ne=I(i({__name:"ProTable",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},setup(e){const l=e;L(null),L(null);const a=s({translateY:0,translateX:0,offsetX:0,offsetY:0,needFixed:!1});S("PRO_TABLE_KEY",{state:a});const i=x((()=>D(l.columns)?l.columns.filter((e=>e.fixed)):[])),t=e=>{a.needFixed=e};return(l,s)=>e.data&&e.data.length?(r(),u("div",Fe,[v(De,{"translate-y":p(a).translateY,"onUpdate:translateY":s[0]||(s[0]=e=>p(a).translateY=e),columns:e.columns,data:e.data,"onUpdate:needFixed":t},null,8,["translate-y","columns","data"]),p(a).needFixed?(r(),b(De,{key:0,"translate-y":p(a).translateY,"onUpdate:translateY":s[1]||(s[1]=e=>p(a).translateY=e),class:"pro-table-fixed",style:{width:"160px"},columns:p(i),data:e.data},null,8,["translate-y","columns","data"])):f("",!0)])):(r(),u("div",Ee,Me))}}),[["__scopeId","data-v-0cf962f9"]]);const Ae={class:"benefit-table"},Ye=i({__name:"BenefitTable",props:{dataSource:null},setup(e){const l=e,a=x((()=>D(l.dataSource.headers)?l.dataSource.headers.map(((e,l)=>({title:e,key:`header_${l}`,fixed:l<2}))):[])),i=x((()=>D(l.dataSource.dataList)?l.dataSource.dataList.map((e=>{const l={};return e.forEach(((e,a)=>{l[`header_${a}`]=e})),l})):[]));return(e,l)=>(r(),u("div",Ae,[v(Ne,{columns:p(a),data:p(i),"is-clone":!0},null,8,["columns","data"])]))}});const Ue=e=>(_("data-v-5e4dfbe9"),e=e(),F(),e),$e={key:0,class:"benefit-container"},je={key:0,class:"benefit"},Be=Ue((()=>h("div",{class:"line"},null,-1))),Xe={class:"box-title box-title-chart"},qe=Ue((()=>h("img",{class:"tl",src:ae,alt:""},null,-1))),Ke=Ue((()=>h("img",{class:"transform-z180 tr",src:ae,alt:""},null,-1))),Qe={key:0},He={class:"box"},We={class:"box-title"},ze=Ue((()=>h("img",{class:"tl",src:ae,alt:""},null,-1))),Ge=Ue((()=>h("img",{class:"transform-z180 tr",src:ae,alt:""},null,-1))),Je={class:"box-price"},Ze={class:"text1"},el={class:"text2"},ll={key:1},al={key:2,style:{width:"100%, minWidth: 338px"}},il={class:"slider"},sl={style:{flex:"1",margin:"0px 5px"}},tl={class:"custom-button"},nl=Ue((()=>h("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),ol={class:"btn-two"},rl={key:1,class:"benefit-container"},ul={key:0},dl={class:"benefit"},cl=Ue((()=>h("div",{class:"line"},null,-1))),pl=Ue((()=>h("div",null,[h("div",{class:"box"},[h("p",{class:"box-title"},[h("img",{class:"tl",src:ae,alt:""}),M(" 保单年度"),h("span",null,"-"),M("年度，被保人"),h("span",null,"-"),M("岁时 "),h("img",{class:"transform-z180 tr",src:ae,alt:""})]),h("div",{class:"box-price"})])],-1))),vl={class:"slider"},ml={class:"opt lf"},fl={style:{flex:"1",margin:"0px 5px"}},kl=Ue((()=>h("div",{class:"custom-button"},"0 岁",-1))),Il={class:"opt rg"},yl=Ue((()=>h("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),Ll={class:"btn-two"},bl={key:1,class:"empty-box"},hl=i({name:"Benefit"});var gl=I(i({...hl,props:{dataSource:{default:()=>({showTypeList:["1"]})},productInfo:{default:()=>null}},setup(e){var l;const a=e,i="1",s="2",t="3",n=L(0),k=L(0),I=L(0),y=L(),g=L(0),V=L(null==(l=a.dataSource.showTypeList)?void 0:l[0]),R=L(),C=e=>{if(!(null==e?void 0:e.benefitRiskResultVOList))return;const l=null==e?void 0:e.benefitRiskResultVOList[n.value];k.value=l.ageBegin+1,g.value=l.ageBegin+1,I.value=l.ageEnd},x=()=>{var e,l,i,s,t,o;const r=null==(l=null==(e=a.dataSource)?void 0:e.benefitRiskResultVOList)?void 0:l[n.value];R.value=null==(t=null==(s=null==(i=a.dataSource)?void 0:i.benefitRiskResultVOList)?void 0:s[n.value].benefitRiskTableResultVOList)?void 0:t[0];const{a:u,year:d}=((e,l)=>{const a=[],i=[];for(let s=e,t=0;s<=l;s++,t++)a.push(s.toString()),i.push(t+1);return{a:a,year:i}})(k.value,I.value),c={index:u.indexOf(g.value.toString()),age:u,year:d,result:null==(o=null==r?void 0:r.benefitRiskItemResultVOList)?void 0:o[0]};y.value=c},P=()=>{g.value>I.value-1||(g.value+=1,x())},O=()=>{g.value>k.value&&(g.value-=1,x())},T=e=>{n.value=e.name,C(a.dataSource),x()};return o((()=>a.dataSource),(e=>{var l;e&&(C(e),x(),V.value=null==(l=e.showTypeList)?void 0:l[0])}),{deep:!0,immediate:!0}),o(g,(()=>{x()})),(l,o)=>{var L;const C=U,x=le,S=$,D=j,_=B,F=ee;return(null==(L=e.dataSource)?void 0:L.benefitRiskResultVOList)?(r(),u("div",$e,[v(_,{active:p(n),onClickTab:T},{default:m((()=>{var e;return[(r(!0),u(c,null,d(null==(e=a.dataSource)?void 0:e.benefitRiskResultVOList,((e,l)=>(r(),b(D,{key:l,name:l,title:e.riskName},{default:m((()=>{var e,L,T,D,_,F,U,$,j,B,X,q,K,Q,H,W;return[l==p(n)?(r(),u("div",je,[Be,E(h("p",Xe,[qe,M(" 保单年度"),h("span",null,w(null==(T=null==(e=p(y))?void 0:e.year)?void 0:T[null==(L=p(y))?void 0:L.index]),1),M("年度，被保人"),h("span",null,w(null==(F=null==(D=p(y))?void 0:D.age)?void 0:F[null==(_=p(y))?void 0:_.index]),1),M("岁时 "),Ke],512),[[N,p(V)===s]]),p(V)===i?(r(),u("div",Qe,[h("div",He,[h("p",We,[ze,M(" 保单年度"),h("span",null,w(null==(j=null==(U=p(y))?void 0:U.year)?void 0:j[null==($=p(y))?void 0:$.index]),1),M("年度，被保人"),h("span",null,w(null==(q=null==(B=p(y))?void 0:B.age)?void 0:q[null==(X=p(y))?void 0:X.index]),1),M("岁时 "),Ge]),h("div",Je,[(r(!0),u(c,null,d(null==(Q=null==(K=p(y))?void 0:K.result)?void 0:Q.headers,((e,l)=>{var a,i,s,t,n,o,d,c,v,m;return r(),u("div",{key:l,style:{width:"33%"}},[h("p",Ze,w(("0"==(null==(n=null==(t=null==(i=null==(a=p(y))?void 0:a.result)?void 0:i.dataList)?void 0:t[null==(s=p(y))?void 0:s.index])?void 0:n[l])?"0":p(A)(Number(null==(m=null==(v=null==(d=null==(o=p(y))?void 0:o.result)?void 0:d.dataList)?void 0:v[null==(c=p(y))?void 0:c.index])?void 0:m[l])))||"0"),1),h("p",el,w(e)+"(元）",1)])})),128))])])])):f("",!0),p(V)===t?(r(),u("div",ll,[v(Ye,{"data-source":p(R)},null,8,["data-source"])])):f("",!0),p(V)==s?(r(),u("div",al,[v(ie,{min:p(k),max:p(I),current:p(g),data:null==(W=null==(H=p(y))?void 0:H.result)?void 0:W.benefitRiskItemList},null,8,["min","max","current","data"])])):f("",!0),p(V)!=t?(r(),u(c,{key:3},[h("div",il,[h("div",{class:"opt lf",onClick:O},[v(C,{name:"minus"})]),h("div",sl,[p(k)?(r(),b(x,{key:0,modelValue:p(g),"onUpdate:modelValue":o[0]||(o[0]=e=>Y(g)?g.value=e:null),min:p(k),max:p(I),"bar-height":"8px"},{button:m((()=>[h("div",tl,w(p(g))+" 岁",1)])),_:1},8,["modelValue","min","max"])):f("",!0)]),h("div",{class:"opt rg",onClick:P},[v(C,{name:"plus"})])]),nl],64)):f("",!0),h("div",ol,[a.dataSource.showTypeList.includes(i)?(r(),b(S,{key:0,round:"",plain:p(V)!==i,type:"primary",class:"btn",onClick:o[1]||(o[1]=e=>V.value=i)},{default:m((()=>[M("图表展示")])),_:1},8,["plain"])):f("",!0),a.dataSource.showTypeList.includes(s)?(r(),b(S,{key:1,round:"",plain:p(V)!==s,type:"primary",class:"btn",onClick:o[2]||(o[2]=e=>V.value=s)},{default:m((()=>[M("趋势展示")])),_:1},8,["plain"])):f("",!0),a.dataSource.showTypeList.includes(t)?(r(),b(S,{key:2,round:"",plain:p(V)!==t,type:"primary",class:"btn",onClick:o[3]||(o[3]=e=>V.value=t)},{default:m((()=>[M("表格展示")])),_:1},8,["plain"])):f("",!0)])])):f("",!0)]})),_:2},1032,["name","title"])))),128))]})),_:1},8,["active"])])):(r(),u("div",rl,[a.productInfo?(r(),u("div",ul,[v(_,{active:p(n),onClickTab:T},{default:m((()=>[(r(),b(D,{key:1,name:1,title:e.productInfo.insureProductRiskVOList[0].riskName},{default:m((()=>[h("div",dl,[cl,pl,h("div",vl,[h("div",ml,[v(C,{name:"minus"})]),h("div",fl,[v(x,{modelValue:p(g),"onUpdate:modelValue":o[4]||(o[4]=e=>Y(g)?g.value=e:null),min:0,max:80,"bar-height":"8px",disabled:""},{button:m((()=>[kl])),_:1},8,["modelValue"])]),h("div",Il,[v(C,{name:"plus"})])]),yl,h("div",Ll,[v(S,{round:"",plain:!0,type:"primary",class:"btn",disabled:""},{default:m((()=>[M("图表展示")])),_:1}),v(S,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:m((()=>[M("趋势展示")])),_:1}),v(S,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:m((()=>[M("表格展示")])),_:1})])])])),_:1},8,["title"]))])),_:1},8,["active"])])):(r(),u("div",bl,[v(F,{title:"试算结果正在计算中...","empty-class":"empty-select"})]))]))}}}),[["__scopeId","data-v-5e4dfbe9"]]);const Vl={key:0,class:"head-warning-wrap"},Rl=h("div",{class:"warning-icon"},[h("span",null,"!")],-1),Cl={class:"warning-text"},xl=i({name:"HeadWaring"}),Pl=i({...xl,props:{labels:{default:()=>[]}},setup:e=>(l,a)=>e.labels.length>0?(r(),u("div",Vl,[Rl,h("div",Cl,[(r(!0),u(c,null,d(e.labels,(e=>(r(),u("span",{key:e},w(e),1)))),128))])])):f("",!0)}),Ol=(l,a,i)=>{const s=l,{holder:t}=i,n=i.insuredList[0],o=(a||"").split("_");if(o.length<2)return a;if(e.exports.isNaN(Number(o[1])))return a;if(o[1]-=1,1===s.exemptFlag){if("to"===o[0]){let e=0;1===s.exemptType?(null==t?void 0:t.birthday)&&(e=parseInt(""+((new Date).getTime()-new Date(t.birthday).getTime())/31536e6,10)):2===s.exemptType&&(null==n?void 0:n.birthday)&&(e=parseInt(""+(+(new Date).getTime()-new Date(n.birthday).getTime())/31536e6,10)),o[1]=+o[1]-e}o[0]="year"}return o.join("_")},Tl=(e,l)=>{const a=[],i={};return null==e||e.forEach((e=>{i[e.riskId]=e})),null==l||l.forEach((e=>{var l,s,t,n;const{collocationType:o,collocationRiskId:r,riskId:u}=e;switch(o){case 2:{const e=null==(l=i[u])?void 0:l.riskName,t=null==(s=i[r])?void 0:s.riskName;a.push(`${e} 和 ${t} 必须同时投保`);break}case 3:{const e=null==(t=i[u])?void 0:t.riskName,l=null==(n=i[r])?void 0:n.riskName;a.push(`${e} 和 ${l} 不能同时投保`);break}}})),a};const wl={class:"com-body"},Sl={class:"trial-body"},Dl={class:"container"},_l=(e=>(_("data-v-ed8b4a52"),e=e(),F(),e))((()=>h("div",{class:"empty"},null,-1))),Fl=i({name:"TrialBody"});var El=I(i({...Fl,props:{dataSource:{default:()=>[]},productInfo:{default:()=>({productCode:"",productName:"",insurerCode:"",tenantId:"",planList:[]})},tenantProductDetail:{default:()=>({})},hideBenefit:{type:Boolean,default:!1},hidePopupButton:{type:Boolean,default:!1},title:{default:"算一算保费"},defaultData:{default:null},isTrial:{type:Boolean,default:!1}},emits:["trialStart","trialEnd"],setup(i,{expose:d,emit:c}){const I=i,y=L(null),g=X();q();const{tenantId:V,templateId:R,preview:C}=g.query,P=L(),O=s({loading:!1,show:!1,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},riskList:[{}],mainRiskVO:{},ifPersonalInfoSuccess:!1,trialMsg:"",trialResultPremium:0,trialResult:{initialPremium:0,initialAmount:0},isAniShow:!1,defaultValue:null,isAutoChange:!1,planIndex:0,isSkipFirstTrial:!1,hadSkipFirstTrial:!1,isQuerying:!1,currentPlanCode:""}),T=ce();L();const w=L(),S=L(I.dataSource),_=L([]),F=e=>{const{holder:l,insuredList:a}=e||{};l&&(O.submitData.holder=l),a&&a.length>0&&a.forEach(((e,l)=>{var a;O.submitData.insuredList&&O.submitData.insuredList.length>l?O.submitData.insuredList[l]=e:((null==(a=O.submitData)?void 0:a.insuredList)||(O.submitData.insuredList=[]),O.submitData.insuredList.push(e))}))},E=x((()=>I.productInfo.planList&&I.productInfo.planList.length>2)),M=(e,l)=>{if(e){const a=["birthday","age","gender","id"];l.includes("occupationCodeList")&&a.push("occupationCodeClass"),Object.keys(e).forEach((i=>{[...l,...a].includes(i)||(e[i]=null)}))}},N=(e,l=(e=>!0))=>D(e)?e.filter(l).map((e=>e.code)):[],A=()=>{console.log("--current plan = ",S.value),console.log("---current submit = ",O.submitData);const l=e.exports.cloneDeep(O.submitData);if(!E.value)return l;const{1:a,2:i,3:s}=S.value.productFactor||{};if(l.holder&&M(l.holder,N(a)),l.insuredList){const e=["productList","beneficiaryList"],a=N(i,(e=>"2"!==String(e.subModuleType))),t=N(i,(e=>"2"===String(e.subModuleType))),n=D(t),o=N(s),r=D(o);l.insuredList.forEach(((l,i)=>{var s,u;M(l,[...i>=1&&n?t:a,...e,r?["insuredBeneficiaryType"]:[]]),(null==(s=l.beneficiaryList)?void 0:s.length)>0&&(r?l.beneficiaryList.forEach((e=>M(e,o))):l.beneficiaryList.length=0),l.planCode=S.value.planCode;const d=(null==(u=l.productList[0])?void 0:u.riskList)||[],c=S.value.insureProductRiskVOList||[];if(d&&c){const e=d.filter((e=>null!==c.find((l=>l.riskCode===e.riskCode))));l.productList[0].riskList=e}}))}return l},Y=L(),U=L({}),$=["annuityDrawDate","coveragePeriod","chargePeriod","paymentFrequency"],j=e=>{var l,i,s,t,n,o;if(null==(i=null==(l=null==e?void 0:e.data)?void 0:l[0])?void 0:i.productRiskDyInsureFactorVOList){const l=[];if(null==(s=S.value)||s.insureProductRiskVOList.forEach((i=>{var s,t;const n=null==(t=null==(s=null==e?void 0:e.data)?void 0:s[0])?void 0:t.productRiskDyInsureFactorVOList.find((e=>e.riskCode===i.riskCode));if(n){i.productRiskInsureLimitVO={...i.productRiskInsureLimitVO,...n};const e=O.riskList.find((e=>e.riskCode===i.riskCode));let s=!1;a.forEach((l=>{if($.indexOf(l.valueKey)>=0){const a=i.productRiskInsureLimitVO[l.configKey];if(a&&e){const i=a.find((a=>a.code===e[l.valueKey]));if(i&&2===i.useFlag){const i=a.find((e=>1===e.defaultFlag));e[l.valueKey]=i.code,s=!0}}}})),s&&l.push({...e,...n,riskCode:i.riskCode})}})),l.length>0&&(null==(o=null==(n=null==(t=O.defaultValue)?void 0:t.insuredList)?void 0:n[0])?void 0:o.productList))return l.forEach((e=>{var l,a,i;O.defaultValue.insuredList[0].productList=null==(i=null==(a=null==(l=O.defaultValue)?void 0:l.insuredList)?void 0:a[0])?void 0:i.productList.map((l=>(l.riskList=null==l?void 0:l.riskList.map((l=>(l.riskCode===e.riskCode&&(l=e),l))),l)))})),!1}return!0},B=async(e,l=!0)=>{O.trialMsg="试算中...",O.trialResultPremium=0,O.loading=!0,c("trialStart");let a=!1;if(l){const{code:l}=await ne(e);a="10000"===l}!a&&l||(O.isQuerying=!0,I.hideBenefit||oe(e).then((e=>{e.data&&e.code===H&&(U.value=e.data)})).finally((()=>{O.loading=!1})),re(e).then((l=>{var a,i;if(l.data&&l.code===H){(null==(a=null==l?void 0:l.data)?void 0:a.errorInfo)&&W(`${null==(i=null==l?void 0:l.data)?void 0:i.errorInfo}`),O.trialMsg="",O.trialResultPremium=l.data.initialPremium,O.trialResult=l.data;const s={};l.data.riskPremiumDetailVOList&&l.data.riskPremiumDetailVOList.length&&l.data.riskPremiumDetailVOList.forEach((e=>{s[e.riskCode]={initialAmount:e.initialAmount,initialPremium:e.initialPremium}})),Y.value=s,c("trialEnd",l.data,e)}})).finally((()=>{O.loading=!1,O.isQuerying=!1})))},Z=e.exports.debounce((async()=>{console.log(">>>>>调用试算<<<<<",O.ifPersonalInfoSuccess,P.value.canTrail());const{productCode:e,productName:l}=I.productInfo||{};if(O.ifPersonalInfoSuccess||P.value.canTrail()){O.submitData.productCode=e,O.submitData.productName=l,O.submitData.tenantId=I.productInfo.tenantId,O.riskList=O.riskList.map((e=>(e=>{var l,i,s,t;const n=null==(l=S.value.insureProductRiskVOList)?void 0:l.find((l=>e.riskId===l.riskId));if(n&&1!==n.mainRiskFlag){const l=null==(s=null==(i=S.value)?void 0:i.productRiskRelationVOList)?void 0:s.filter((e=>{var l;if(e.collocationRiskId===n.riskId&&3!==e.collocationType){const a=null==(l=S.value.insureProductRiskVOList)?void 0:l.find((l=>e.riskId===l.riskId));if(a&&a.riskType===te.MAIN_RISK)return!0}return!1})),o=l.length>0?l[0]:null;if(o){const l=null==(t=O.riskList)?void 0:t.find((e=>e.riskId===o.riskId));a.forEach((a=>{a.ruleKey&&n.productRiskInsureLimitVO&&l&&(1===n.productRiskInsureLimitVO[a.ruleKey]&&(e[a.valueKey]=l[a.valueKey]),3===n.productRiskInsureLimitVO[a.ruleKey]&&(1!==n.exemptFlag?e[a.valueKey]=Ol(n,l[a.valueKey],O.submitData):e[a.valueKey]=Ol(n,l[a.ruleValueKey],O.submitData)))}))}}return e})(e))),O.submitData.insuredList&&O.submitData.insuredList.forEach((a=>{a.productList=[{productCode:e,productName:l,riskList:O.riskList}]}));const i=A();console.log(">>>数据构建<<<",i),await B(i)}}),300),ee=async e=>{var l;const{insuredList:a,isFirstInsuredChange:i}=e;if(F(e),O.ifPersonalInfoSuccess=!0,i){console.log("处理第一被保人修改的dy变化"),O.isQuerying=!0;const e=await ue({calcProductFactorList:[{planCode:S.value.planCode,productCode:I.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:null==(l=S.value.insureProductRiskVOList)?void 0:l[0]}]}],...a[0]});if(O.isQuerying=!1,!j(e))return}console.log("投被保人的信息回传 ",e),Z()},le=async(l,a)=>{var i,s,t,n;if(a){const o=e.exports.cloneDeep(l);delete o.insurancePeriodValueList,delete o.paymentFrequencyList,delete o.paymentPeriodValueList;if($.indexOf(a.key)>=0&&`${a.oldValue}`!=`${a.newValue}`){const e={};switch(a.key){case"annuityDrawDate":e.changeType=3;break;case"coveragePeriod":e.changeType=2;break;case"chargePeriod":e.changeType=1}const r=null==(s=null==(i=O.submitData)?void 0:i.insuredList)?void 0:s[0],u=null==(n=null==(t=S.value)?void 0:t.insureProductRiskVOList)?void 0:n.find((e=>e.riskCode===l.riskCode));if(!O.isAutoChange){O.isQuerying=!0;const a=await ue({calcProductFactorList:[{planCode:S.value.planCode,productCode:I.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:u,insureRiskEditReqVO:{riskId:l.riskId,riskCode:l.riskCode,...o,...e}}]}],...r});O.isQuerying=!1;const i=j(a);return i||(O.isAutoChange=!0),i}O.isAutoChange=!1}}return!0},ae=async(e,l)=>{O.mainRiskVO=e;await le(e,l)&&(O.riskList.length>0&&(O.riskList[0]=e),console.log("标准险种的信息回传",e),Z())},ie=async(e,l)=>{if(O.riskList=[O.mainRiskVO,...e],console.log("附加险列表数据回传",e),l){const a=e.find((e=>e.riskCode===l.riskCode));if(!(await le(a,l)))return}Z()},se=e=>{var l,a,i,s;O.userData=e,O.defaultValue=e;const t=(null==(l=e.insuredList)?void 0:l[0].productList.findIndex((e=>e.planCode===S.value.planCode)))||0;O.planIndex=-1===t?0:t,O.riskList=(null==(s=null==(i=null==(a=null==e?void 0:e.insuredList)?void 0:a[0].productList)?void 0:i[O.planIndex])?void 0:s.riskList)||[],B(e,!0)},ke=async e=>{var l;if(I.defaultData){const e=I.defaultData.find((e=>e.productCode===I.productInfo.productCode))||I.defaultData[0];se(e),F(null==(l=I.defaultData)?void 0:l[0])}else _.value.push(S.value.planCode),await(async()=>{var e;const l=await de({calcProductFactorList:[{planCode:S.value.planCode,productCode:I.productInfo.productCode}]});if(l.data){const a=l.data.find((e=>e.productCode===I.productInfo.productCode))||l.data[0];se(a),F(null==(e=l.data)?void 0:e[0])}})()},Ie=async e=>{var l,a;const i=I.productInfo.planList.findIndex((l=>l.planCode===e)),s=(null==(a=null==(l=O.defaultValue)?void 0:l.insuredList)?void 0:a[0].productList.findIndex((l=>l.planCode===e)))||0,t=i>=0?I.productInfo.planList[i]:null;t&&(O.currentPlanCode=e,S.value=t,O.planIndex=s>=0?s:0,O.defaultValue.insuredList[0].productList[O.planIndex].riskList=O.riskList,_.value.findIndex((l=>l===e))<0&&_.value.push(e))};t((()=>{var e,l;O.select={},O.list=[],O.userData={},O.riskIsInsure={},O.submitData={},O.riskList=[{}],O.mainRiskVO={},O.ifPersonalInfoSuccess=!1,O.trialMsg="",O.trialResultPremium=0,O.riskIsInsure={},null==(l=null==(e=S.value)?void 0:e.insureProductRiskVOList)||l.forEach((e=>{var l;const a=null==(l=S.value.productRiskRelationVOList)?void 0:l.find((l=>l.collocationRiskId===e.riskId));a&&(O.riskIsInsure[e.riskCode]={selected:"2",data:null,relation:a})}))})),n((()=>{S.value=I.dataSource,O.loading=!0,O.show=!0,O.isAniShow=!0,O.isSkipFirstTrial=!0,O.hadSkipFirstTrial=!1,K((()=>{ke()}))}));return d({getTrialSuccessFlag:()=>O.trialResultPremium>0,validate:()=>P.value.validate(!1),validateTrialFields:()=>P.value.validateTrialFields(),validateHolder:e=>{var l;return null==(l=P.value)?void 0:l.validateHolder(e)},getUserData:()=>({...O.userData}),onShare:e=>{var l;O.trialResultPremium&&(null==(l=y.value)||l.validate().then((()=>{Object.assign(T.value,{extInfo:{...T.value.extInfo,buttonCode:me.TRIAL_PREMIUM,pageCode:ve.TRIAL_PREMIUM,templateId:R}});const l=pe(I.productInfo,Y.value,T.value);fe(l,((l,a)=>{a===z.JUMP_PAGE&&(w.value.link=`${window.location.href}&isShare=1&orderNo=${l.orderNo}`,e())})),console.log("---- validate success ----")})))},onNext:()=>{var e;C?Q(ve.TRIAL_PREMIUM,g.query):O.trialResultPremium&&(null==(e=y.value)||e.validate().then((()=>{Object.assign(T.value,{extInfo:{...T.value.extInfo,buttonCode:me.TRIAL_PREMIUM,pageCode:ve.TRIAL_PREMIUM,templateId:R}}),console.log("dealMixData()",A());const e=pe(A(),O.trialResult,T.value);fe(e,((e,l)=>{l===z.JUMP_PAGE&&G(e.nextPageCode,{...g.query,orderNo:e.orderNo})})),console.log("---- validate success ----")})),O.loading=!1,O.show=!0,O.isAniShow=!0)}}),o((()=>O.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>O.userData),(e=>{if(e){const{holder:l,insuredList:a}=e||{};Object.assign(O.submitData,{holder:l,insuredList:a})}}),{deep:!0}),o((()=>I.dataSource),(e=>{S.value=e}),{deep:!0,immediate:!0}),(e,a)=>{var s,t,n,o,d,c,I,L;return r(),u("div",wl,[k(e.$slots,"trialHead",{},void 0,!0),h("div",Sl,[v(Pl,{labels:p(Tl)((null==(s=S.value)?void 0:s.insureProductRiskVOList)||[],S.value.productRiskRelationVOList)},null,8,["labels"]),h("div",Dl,[!i.hideBenefit&&(null==(t=U.value)?void 0:t.benefitRiskResultVOList)?(r(),b(gl,{key:0,class:"benefit-wrap","data-source":U.value,"product-info":S.value,"show-type-list":U.value.showTypList},null,8,["data-source","product-info","show-type-list"])):f("",!0),p(E)?(r(),b(ge,{key:1,"plan-list":i.productInfo.planList,"default-plan":S.value,onPlanChange:Ie},null,8,["plan-list","default-plan"])):f("",!0),S.value.productFactor?(r(),b(p(l),{ref_key:"personalInfoRef",ref:P,key:S.value.planCode,modelValue:p(O).userData,"onUpdate:modelValue":a[0]||(a[0]=e=>p(O).userData=e),"is-trial":i.isTrial,"product-factor":S.value.productFactor,"multi-insured-config":null==(n=S.value)?void 0:n.multiInsuredConfigVO,onTrailChange:ee},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):f("",!0),(r(),b(J,{ref_key:"insureInfosRef",ref:y,key:S.value.planCode,"origin-data":null==(o=S.value.insureProductRiskVOList)?void 0:o[0],"product-factor":S.value.productFactor,"default-value":p(O).defaultValue?null==(c=null==(d=p(O).defaultValue)?void 0:d.insuredList[0].productList[p(O).planIndex])?void 0:c.riskList[0]:null,"trial-result":p(O).trialResult,onTrialChange:ae},null,8,["origin-data","product-factor","default-value","trial-result"])),S.value.insureProductRiskVOList?(r(),b(Le,{key:S.value.planCode,"data-source":S.value,"show-main-risk":!1,"default-value":p(O).defaultValue?null==(L=null==(I=p(O).defaultValue)?void 0:I.insuredList[0].productList[p(O).planIndex])?void 0:L.riskList:[],onTrialChange:ie},{holderForm:m((()=>{var e;return[i.isTrial&&i.dataSource.productFactor?(r(),b(p(l),{key:0,ref_key:"personalInfoRef",ref:P,modelValue:p(O).userData,"onUpdate:modelValue":a[1]||(a[1]=e=>p(O).userData=e),"is-trial":i.isTrial,"is-only-holder":!0,"product-factor":i.dataSource.productFactor,"multi-insured-config":null==(e=i.dataSource)?void 0:e.multiInsuredConfigVO,onTrailChange:ee},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):f("",!0)]})),_:1},8,["data-source","default-value"])):f("",!0),_l])]),k(e.$slots,"trialBtn",{trialData:p(O).submitData,riskPremium:p(O).trialResult,loading:p(O).isQuerying,personalInfoRef:P.value},void 0,!0)])}}}),[["__scopeId","data-v-ed8b4a52"]]);export{El as T};
