import{n as e,o as n,m as a,p as t}from"./infoCollection-8db5a31c.js";import{a0 as l,_ as i,d as r,r as o,z as u,ac as s,x as c,G as m,a4 as d,aq as f,as as p,b as v,c as y,h as I,f as D,w as V,j as g,g as P,k,F as Y,t as O,X as C,n as b,K as x,L as S,e as E,i as L,B as h,T as M}from"./index-637b8a09.js";import{l as w}from"./trial-50e1d1d9.js";import{h as _,o as F}from"./utils-9a9afdca.js";import"./pdfh5-008ca364.js";import"./useStorage-74eb036f.js";const N=(e,n="YYYY-MM-DD")=>l(e).format(n),q=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).add(n,a).format(t),T=(e,n=0,a="day",t="YYYY-MM-DD")=>l(e).subtract(n,a).format(t);const U=e=>(x("data-v-6225f53a"),e=e(),S(),e),R={class:"com-period-cell"},$={key:0,class:"period-custom-cell period-check-btn-cell"},j=U((()=>g("div",{class:"period-cell-label"},"保障期间",-1))),A={class:"period-cell-content"},B=U((()=>g("div",{class:"period-cell-label"},"生效日期",-1))),G={class:"period-cell-content period-custom-cell-content"},H=U((()=>g("div",{class:"period-cell-label"},"保障期限",-1))),X={class:"period-cell-content period-custom-cell-content"},z={key:2,class:"period-custom-cell period-common-cell"},K=U((()=>g("div",{class:"period-cell-label"},"保障期限",-1))),J={class:"period-cell-content"},Q=U((()=>g("div",{class:"picker-custom-title"},"保险开始生效日期",-1)));var W=i(r({__name:"index",props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}}},emits:["onReset","onUpdate","onVerify"],setup(a,{expose:t,emit:l}){const i=a;o({});const r=(e,n)=>"year"===e?`${n}年`:"month"===e?`${n}月`:"day"===e?`${n}日`:n,x=o(new Date),S=u({formInfo:i.formInfo}),E=o(!0);s((()=>S.formInfo.insuranceStartDate),(e=>{e&&"string"==typeof e&&(x.value=new Date(e))}));const L=o(),h=o([]);s([()=>i.insureDetail,()=>S.formInfo.activePlanCode],(()=>{var e;if(S.formInfo.insuranceStartDate="",S.formInfo.insuranceEndDate="",S.formInfo.commencementTime="",i.insureDetail)if(i.insureDetail.productRelationPlanVOList&&i.insureDetail.productRelationPlanVOList.length>0){let n=0;const a=i.insureDetail.productRelationPlanVOList.findIndex((e=>e.planCode===S.formInfo.activePlanCode));a>-1&&(n=a);const t=((null==(e=i.insureDetail.productRelationPlanVOList[n])?void 0:e.productRiskVoList[0].riskDetailVOList)||[]).find((e=>1===e.riskType));t&&(L.value=t)}else{const e=(i.insureDetail.productRiskVoList[0].riskDetailVOList||[]).find((e=>1===e.riskType));e&&(L.value=e)}}),{deep:!0,immediate:!0}),s((()=>L.value),(()=>{var e,n;h.value=[],h.value=_((null==(n=null==(e=L.value)?void 0:e.riskInsureLimitVO)?void 0:n.insurancePeriodValueList)||[]),h.value.length>0?h.value.findIndex((e=>e.value===S.formInfo.insurancePeriodValue))<0&&(S.formInfo.insurancePeriodValue=h.value[0].value):S.formInfo.insurancePeriodValue=w.YEAR_1}),{deep:!0,immediate:!0});const M=c((()=>{var n,a;return(null==(n=L.value)?void 0:n.insuranceStartType)?String(null==(a=L.value)?void 0:a.insuranceStartType):e.CURRENT_DAY})),F=c((()=>{var e,a;return(null==(e=L.value)?void 0:e.insuranceEndType)?String(null==(a=L.value)?void 0:a.insuranceEndType):n.CURRENT_DAY})),[U,W]=m(!1),Z=()=>{E.value&&W(!0)},ee=c((()=>{var n;if(M.value===e.CUSTOM_DAY){const e=null==(n=L.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(e&&e.indexOf(",")){const[n,a]=e.split(",");return new Date(q(new Date,Number(n),"day"))}}return new Date(q(new Date,1,"day"))})),ne=c((()=>{var n;if(M.value===e.CUSTOM_DAY){const e=null==(n=L.value)?void 0:n.riskInsureLimitVO.maxInsuranceDay;if(!e)return new Date;if(e.indexOf(",")){const[n,a]=e.split(",");return new Date(q(new Date,Number(a),"day"))}const a=q(new Date,Number(e),"day");return new Date(a)}return new Date})),ae=e=>{S.formInfo.insuranceStartDate=`${N(e)} 00:00:00`,W(!1)},te=()=>{W(!1)};return s([()=>M.value,()=>S.formInfo.insurancePeriodValue,()=>S.formInfo.insuranceStartDate,()=>L.value],(()=>{var a;if(!S.formInfo.insurancePeriodValue)return;const[t,l]=S.formInfo.insurancePeriodValue.split("_");if(!S.formInfo.insuranceStartDate)if(M.value===e.CUSTOM_DAY){const e=null==(a=L.value)?void 0:a.riskInsureLimitVO.maxInsuranceDay;if(e)if(e.indexOf(",")){const[n,a]=e.split(",");S.formInfo.insuranceStartDate=`${q(new Date,Number(n),"day")} 00:00:00`,E.value=n!==a}else S.formInfo.insuranceStartDate=`${q(new Date,e,"day")} 00:00:00`;else S.formInfo.insuranceStartDate=`${q(new Date,1,"day")} 00:00:00`}else M.value===e.NEXT_DAY?S.formInfo.insuranceStartDate=`${q(new Date,1,"day")} 00:00:00`:S.formInfo.insuranceStartDate=`${N(new Date)} 00:00:00`;if("to"!==t){const e=`${T(S.formInfo.insuranceStartDate,1,"day")} 00:00:00`;F.value===n.CURRENT_DAY?S.formInfo.insuranceEndDate=`${q(e,Number(l),t)} 23:59:59`:S.formInfo.insuranceEndDate=`${q(S.formInfo.insuranceStartDate,Number(l),t)} 00:00:00`}else{let e=S.formInfo.tenantOrderInsuredList[0].birthday;S.formInfo.tenantOrderInsuredList[0].certType===d.CERT&&S.formInfo.tenantOrderInsuredList[0].certNo&&f(S.formInfo.tenantOrderInsuredList[0].certNo)&&(e=p(S.formInfo.tenantOrderInsuredList[0].certNo));const a=`${T(e,1,"day")} 00:00:00`;"single"===l&&(S.formInfo.insuranceEndDate="9999-99-99 23:59:59"),F.value===n.CURRENT_DAY?S.formInfo.insuranceEndDate=`${q(a,Number(l),t)} 23:59:59`:S.formInfo.insuranceEndDate=`${q(e,Number(l),t)} 00:00:00`}}),{immediate:!0}),t({}),(n,a)=>{const t=v("ProRadioButton"),l=v("ProSvg"),i=v("van-config-provider"),o=v("VanButton"),u=v("van-datetime-picker"),s=v("ProPopup");return y(),I(Y,null,[D(i,null,{default:V((()=>[g("div",R,[P(h).length>1?(y(),I("div",$,[j,g("div",A,[D(t,{modelValue:P(S).formInfo.insurancePeriodValue,"onUpdate:modelValue":a[0]||(a[0]=e=>P(S).formInfo.insurancePeriodValue=e),options:P(h)},null,8,["modelValue","options"])])])):k("",!0),P(M)===P(e).CUSTOM_DAY?(y(),I("div",{key:1,class:"period-custom-cell period-common-cell",onClick:Z},[P(E)?(y(),I(Y,{key:0},[B,g("div",G,[g("span",null,O(P(S).formInfo.insuranceStartDate?P(N)(P(S).formInfo.insuranceStartDate,"YYYY.MM.DD HH:mm:ss"):""),1),D(l,{class:"custom--arrow-right",name:"arrow-right"})])],64)):(y(),I(Y,{key:1},[H,g("div",X,[g("span",null,O(P(S).formInfo.insuranceStartDate?P(N)(P(S).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+O(P(S).formInfo.insuranceEndDate?P(N)(P(S).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])],64))])):k("",!0),P(M)!==P(e).CUSTOM_DAY?(y(),I("div",z,[K,g("div",J,O(P(S).formInfo.insuranceStartDate?P(N)(P(S).formInfo.insuranceStartDate,"YYYY.MM.DD"):"")+"-"+O(P(S).formInfo.insuranceEndDate?P(N)(P(S).formInfo.insuranceEndDate,"YYYY.MM.DD"):""),1)])):k("",!0)])])),_:1}),D(s,{show:P(U),"onUpdate:show":a[3]||(a[3]=e=>C(U)?U.value=e:null),height:"340",closeable:!0},{default:V((()=>[D(u,{modelValue:P(x),"onUpdate:modelValue":a[2]||(a[2]=e=>C(x)?x.value=e:null),type:"date",title:"保险开始生效日期","min-date":P(ee),"max-date":P(ne),formatter:r,"visible-item-count":5,class:"custom-date-picker",onConfirm:ae,onCancel:te},{cancel:V((()=>[])),title:V((()=>[Q])),confirm:V((()=>[D(o,{type:"primary",round:"",block:"",class:"linear-btn custom-picker-btn",onClick:a[1]||(a[1]=e=>U.value=!1)},{default:V((()=>[b("确 定")])),_:1})])),_:1},8,["modelValue","min-date","max-date"])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-6225f53a"]]);const Z=e=>(x("data-v-1defc39e"),e=e(),S(),e),ee={class:"com-payment-type"},ne={class:"title"},ae={key:0,class:"picture-payment-content"},te=["onClick"],le=["src"],ie=["src"],re={key:1,class:"custom-cell check-btn-cell"},oe=Z((()=>g("div",{class:"cell-label"},"保障方案",-1))),ue={class:"cell-content"},se={key:0,class:"picture-payment-content"},ce=["onClick"],me=["src"],de=["src"],fe={key:1,class:"custom-cell check-btn-cell"},pe=Z((()=>g("div",{class:"cell-label"},"交费方式",-1))),ve={class:"cell-content"},ye={class:"custom-cell common-cell"},Ie=Z((()=>g("div",{class:"cell-label"},"实付保费",-1))),De={key:0,class:"cell-content actual-premium"},Ve={class:"cell-content actual-premium"},ge={key:0,class:"actual-premium actual-premium-month-tip"},Pe={key:0,class:"feerate-explain"},ke={class:"content"},Ye=Z((()=>g("div",{class:"triangle-top"},null,-1)));var Oe=i(r({__name:"index",props:{formInfo:{type:Object,default:()=>{}},insureDetail:{type:Object,default:()=>{}},configDetail:{type:Object,default:()=>{}},isMultiplePlan:{type:Boolean,default:!1},premiumInfo:{type:Object,default:()=>{}}},emits:["update-active-plan"],setup(e,{expose:n,emit:l}){const i=e;o({});const r=u({formInfo:i.formInfo}),m=o([]),d=o(),f=o(),p=c((()=>{var e;return"1"===String(null==(e=d.value)?void 0:e.paymentFrequencyFlag)}));c((()=>{var e;return null==(e=f.value)?void 0:e.productPremiumVOList.find((e=>e.paymentFrequency===r.formInfo.paymentFrequency))}));const C=c((()=>i.premiumInfo.premiumLoadingText?i.premiumInfo.premiumLoadingText:i.premiumInfo.premium?`${i.premiumInfo.premium||""}${i.premiumInfo.actualUnit||"元"}`:`${i.premiumInfo.minPremiun||""}${i.premiumInfo.unit||""}`)),b=c((()=>{if(f){const{premiumExplain:e,premiumExplainViewName:n,premiumExplainUri:a}=f.value||{};return{premiumExplain:e,premiumExplainUri:a,premiumExplainViewName:n}}return null})),x=c((()=>b.value&&b.value.premiumExplain&&b.value.premiumExplainViewName));s((()=>i.configDetail),(()=>{var e;i.isMultiplePlan&&i.configDetail&&(m.value=null==(e=i.configDetail.tenantProductInsureVO)?void 0:e.planList)}),{immediate:!0,deep:!0}),s([()=>i.configDetail,()=>i.isMultiplePlan,()=>r.formInfo.activePlanCode],(()=>{if(i.configDetail)if(i.isMultiplePlan){let e=0;const n=i.configDetail.tenantProductInsureVO.planList.findIndex((e=>e.planCode===r.formInfo.activePlanCode));n>-1&&(e=n),d.value=i.configDetail.tenantProductInsureVO.planList[e].productPlanInsureConditionVO,f.value=i.configDetail.tenantProductInsureVO.planList[e]}else d.value=i.configDetail.tenantProductInsureVO.planInsureVO.productPlanInsureConditionVO,f.value=i.configDetail.tenantProductInsureVO.planInsureVO}),{deep:!0,immediate:!0});const S=c((()=>{var e;if(d.value&&d.value.paymentFrequency){return((null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[]).length>1}return!1}));s((()=>d.value),(()=>{var e;if(d.value){const n=(null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[];if(1===n.length)return void(r.formInfo.paymentFrequency=d.value.paymentFrequency);if(2===n.length&&n.filter((e=>![a.SINGLE,a.MONTH].includes(e))).length<1)return void(r.formInfo.paymentFrequency||(r.formInfo.paymentFrequency=a.SINGLE));n.length>1&&!r.formInfo.paymentFrequency&&(r.formInfo.paymentFrequency=null==n?void 0:n[0])}}),{immediate:!0,deep:!0});const w=c((()=>{var e;return d.value?null==(e=d.value.paymentFrequencyList||[])?void 0:e.map((e=>({...e,paymentFrequency:e.skinValue}))):[]})),_=c((()=>w.value.length>0)),N=c((()=>i.isMultiplePlan?i.configDetail.tenantProductInsureVO.planList.map((e=>e.planPicList?{...e.planPicList,planCode:e.planCode,planName:e.planName}:null)).filter((e=>!!e)):[])),q=c((()=>{var e,n;if(d.value){const a=(null==(e=d.value.paymentFrequency)?void 0:e.split(","))||[];return 1===a.length&&(r.formInfo.paymentFrequency=a[0]),null==(n=a||[])?void 0:n.map((e=>({label:t[e],value:e})))}return[]})),T=e=>{r.formInfo.activePlanCode=e},U=()=>{var e,n;(null==(e=b.value)?void 0:e.premiumExplainUri)?F({fileType:"pdf",fileUri:null==(n=b.value)?void 0:n.premiumExplainUri}):M("无费率文件！")};return n({}),(n,a)=>{const t=v("ProRadioButton"),l=v("templat"),o=v("ProDivider"),u=v("van-config-provider");return y(),E(u,null,{default:V((()=>[g("div",ee,[g("div",ne,O(P(S)?"交费方式":"保障计划"),1),e.isMultiplePlan?(y(),I(Y,{key:0},[P(N).length>0?(y(),I("div",ae,[(y(!0),I(Y,null,L(P(N),(e=>(y(),I("div",{key:e.planCode,class:h("picture-payment-item"),onClick:n=>T(e.planCode)},[P(r).formInfo.activePlanCode==e.planCode?(y(),I("img",{key:0,src:e.selectedPic},null,8,le)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,ie))],8,te)))),128))])):(y(),I("div",re,[oe,g("div",ue,[D(t,{modelValue:P(r).formInfo.activePlanCode,"onUpdate:modelValue":a[0]||(a[0]=e=>P(r).formInfo.activePlanCode=e),options:P(m),prop:{value:"planCode",label:"planName"},onChange:T},null,8,["modelValue","options"])])]))],64)):k("",!0),P(p)?(y(),E(l,{key:1},{default:V((()=>[P(_)&&P(w).length>1?(y(),I("div",se,[(y(!0),I(Y,null,L(P(w),(e=>(y(),I("div",{key:e.paymentFrequency,class:h("picture-payment-item"),onClick:n=>{return a=e.paymentFrequency,void(r.formInfo.paymentFrequency=a);var a}},[P(r).formInfo.paymentFrequency==e.paymentFrequency?(y(),I("img",{key:0,src:e.selectedPic},null,8,me)):(y(),I("img",{key:1,src:e.unSelectedPic},null,8,de))],8,ce)))),128))])):P(q).length>1?(y(),I("div",fe,[pe,g("div",ve,[D(t,{modelValue:P(r).formInfo.paymentFrequency,"onUpdate:modelValue":a[1]||(a[1]=e=>P(r).formInfo.paymentFrequency=e),options:P(q)},null,8,["modelValue","options"])])])):k("",!0)])),_:1})):k("",!0),D(W,{"form-info":P(r).formInfo,"insure-detail":e.insureDetail,"config-detail":e.configDetail},null,8,["form-info","insure-detail","config-detail"]),P(C)&&P(x)?(y(),I(Y,{key:2},[g("div",ye,[Ie,i.premiumInfo.premiumLoadingText?(y(),I("div",De,O(P(C)),1)):(y(),I(Y,{key:1},[g("div",Ve,O(P(C)),1),"5"===P(r).formInfo.paymentFrequency?(y(),I("div",ge," 共12期 ")):k("",!0)],64))]),P(x)?(y(),I("div",Pe,[g("div",ke,[Ye,g("div",null,[g("span",null,O(P(b).premiumExplain||""),1),g("span",{class:"file-name",onClick:U},"《"+O(P(b).premiumExplainViewName||"")+"》",1)])])])):k("",!0)],64)):k("",!0)]),D(o)])),_:1})}}}),[["__scopeId","data-v-1defc39e"]]);export{Oe as default};
