import{t as e}from"./theme-3c294048.js";import{m as a,r as l,e as t,a1 as o,s,t as d,v as r,x as u,z as i,B as v,G as n,H as c,J as p,O as f}from"./vendor-ec128989.js";const m={class:"item"},b={class:"footer"},h=a({props:{show:{type:Boolean,default:!1},contentList:{type:Array,default:()=>[]},activeIndex:{type:Number,default:0},text:{type:String,default:""},beforeReadOverText:{type:String,default:"同意，下一条"},forceReadCound:{type:Number,default:0}},emits:["update:show","submit","onCloseFilePreview"],setup(a,{emit:h}){const y=a,w=l(y.show),C=l(y.contentList.map(((e,a)=>({...e,disabled:!0,readDisabled:!0})))),k=l(y.activeIndex),R=l(0),g=l(null),x=t((()=>{var e,a;return null==(a=null==(e=C.value)?void 0:e[k.value])?void 0:a.attachmentUri})),P=t((()=>{var e;return null==(e=C.value[k.value])?void 0:e.readDisabled})),_=t((()=>!(k.value>=y.forceReadCound-1)&&(!(R.value>=y.forceReadCound)&&(R.value<y.forceReadCound&&k.value!==y.forceReadCound-1)))),D=()=>{k.value+=1},T=()=>{h("update:show",!1),h("submit")};o((()=>y),(()=>{w.value=y.show,k.value=y.activeIndex}),{deep:!0,immediate:!0});const N=e=>{e&&Math.floor(e.target.scrollHeight-e.target.scrollTop)===e.target.clientHeight&&C.value[k.value].readDisabled&&(C.value[k.value].disabled=!1,C.value[k.value].readDisabled=!1,C.value[k.value+1].disabled=!1,R.value+=1)};return o((()=>k.value),(()=>{y.show&&(R.value>=y.forceReadCound&&C.value.forEach((e=>{e.disabled=!1,e.readDisabled=!1})),g.value&&(g.value.scrollTop=0))}),{immediate:!0}),(l,t)=>{const o=s("ProTab"),R=s("ProFilePreview"),$=s("VanButton"),B=s("van-config-provider"),F=s("ProPopup");return d(),r(F,{show:w.value,"onUpdate:show":t[1]||(t[1]=e=>w.value=e),class:"file-preview-popup-wrap",closeable:!1,onClose:t[2]||(t[2]=e=>h("onCloseFilePreview"))},{default:u((()=>[i(B,{"theme-vars":c(e),class:"custom-provider"},{default:u((()=>[w.value?(d(),r(o,{key:0,active:k.value,"onUpdate:active":t[0]||(t[0]=e=>k.value=e),list:C.value.map(((e,a)=>({title:e.attachmentName,disabled:a!=k.value&&(e.disabled||!1),slotName:`guarantee-${a}`}))),class:"tab"},null,8,["active","list"])):v("",!0),n("div",{ref_key:"previewRef",ref:g,class:"list",onScroll:N},[n("div",m,[(d(),r(R,{key:c(x),content:c(x),type:"pdf","forbid-click":!0},null,8,["content"]))])],544),n("div",b,[c(_)?(d(),r($,{key:0,disabled:c(P),type:"primary",block:"",round:"",onClick:D},{default:u((()=>[p(f(`${a.beforeReadOverText}(${k.value+1}/${a.forceReadCound})`),1)])),_:1},8,["disabled"])):(d(),r($,{key:1,disabled:c(P),type:"primary",block:"",round:"",onClick:T},{default:u((()=>[p(f(y.text),1)])),_:1},8,["disabled"]))])])),_:1},8,["theme-vars"])])),_:1},8,["show"])}}});export{h as _};
