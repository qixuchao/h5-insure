import{m as e,ab as t,u as a,r as n,e as o,a0 as r,o as l,s as d,t as u,v as i,x as s,U as c,E as v,N as p,F as m,z as f,H as I,D as O,a6 as L,a7 as C}from"./vendor-533c215b.js";import{d as b}from"./debounce-7666f3da.js";import{r as V,t as y}from"./utils-c94b3c10.js";import{p as j}from"./product-5f01c48c.js";import{i as P,b as R,p as h}from"./trial-c55fec63.js";import{_ as N,n as g}from"./nextStep-470e19ae.js";import{u as w}from"./theme-467ed2f7.js";import{_ as B}from"./index-b8acfffb.js";import"./useStorage-0a80cedc.js";import"./infoCollection-eaaba949.js";import"./trial-fb34b809.js";import"./relativeTime-67dc04d9.js";import"./useDicData-bf5f000a.js";const x=e=>(L("data-v-dba7be18"),e=e(),C(),e),E={class:"net-sale-wrap"},k={class:"product-name"},_=x((()=>v("span",null,null,-1))),H=x((()=>v("span",null,null,-1))),T={class:"footer-button"},D=I("分享用户确认投保");var F=B(e({setup(e){const I=w();t();const L=a(),{productCode:C="HTEJBX",tenantId:B="9991000001",orderNo:x,agentCode:F="",saleChannelId:U,extraInfo:A,from:S}=L.query,z=n(),q=n(),J=n(),W=n(),G=n(),X=n({});let Y={};try{Y=JSON.parse(decodeURIComponent(A))}catch(te){}const $=n({agencyId:F,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"EVENT_NETSALE_underWrite",pageCode:"infoCollection",templateId:null==Y?void 0:Y.templateId,iseeBizNo:"",extraInfo:Y},orderCategory:1,saleUserId:U,tenantId:B,venderCode:"",tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"1",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"xinao",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",tenantId:B}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}}),K=o((()=>{var e,t;return!!(null==(t=null==(e=J.value)?void 0:e.productRelationPlanVOList)?void 0:t.length)})),M=o((()=>{var e,t;let{premium:a}=G.value||{};if(!a){const{tenantProductInsureVO:n}=W.value||{};let o={};o=(null==(e=null==n?void 0:n.planList)?void 0:e.length)?null==n?void 0:n.planList.find((e=>e.plaCode===q.value)):null==n?void 0:n.planInsureVO;const{paymentFrequencyValue:r,premiumUnit:l}=(null==(t=null==o?void 0:o.productPremiumVOList)?void 0:t[0])||{};a=r+l}return a||""})),Q=o((()=>{var e,t,a;let n=[];return n=K.value?(null==(t=null==(e=J.value)?void 0:e.productRelationPlanVOList.find((e=>e.planCode===q.value)))?void 0:t.productRiskVoList)||[]:(null==(a=J.value)?void 0:a.productRiskVoList)||[],n}));o((()=>{var e,t,a;null==(a=null==(t=null==(e=Q.value)?void 0:e[0])?void 0:t.riskDetailVOList)||a[0]}));const Z=async()=>{var e,t,a;$.value.venderCode=null==(e=J.value)?void 0:e.productBasicInfoVO.insurerCode,$.value.orderAmount=G.value.premium,$.value.orderRealAmount=G.value.premium,$.value.tenantOrderInsuredList[0].planCode=q.value,$.value.tenantOrderInsuredList[0].planName=null==(a=null==(t=J.value)?void 0:t.productRelationPlanVOList.find((e=>e.planCode===q.value)))?void 0:a.planName,g(((e={},t={},a={})=>{var n;const o={...a},r={tenantId:B,riskList:(null==(n=o.tenantOrderInsuredList[0])?void 0:n.tenantOrderProductList[0].riskVOList)||[],riskPremium:t,productId:null==e?void 0:e.productBasicInfoVO.id};return o.tenantOrderInsuredList[0].tenantOrderProductList[0]={premium:"",productCode:e.productBasicInfoVO.productCode,productName:e.productBasicInfoVO.productName,tenantOrderRiskList:y(r)},o})(J.value,G.value,$.value),(()=>{}))},ee=async()=>{O.confirm({title:"分享",message:`即将向客户【${$.value.tenantOrderHolder.name}】发送投保确认信息,请确认是否继续？`}).then((()=>{Z()}))};r([()=>$.value.tenantOrderHolder.gender,()=>$.value.tenantOrderHolder.birthday,()=>{var e;return null==(e=$.value.tenantOrderInsuredList)?void 0:e[0].gender},()=>{var e;return null==(e=$.value.tenantOrderInsuredList)?void 0:e[0].birthday},()=>q.value],b((([e,t,a,n])=>{e&&t&&a&&n&&(async(e,t,a)=>{var n;const o={holder:{personVO:e.tenantOrderHolder},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",personVO:e,productPlanVOList:[{insurerCode:t.productBasicInfoVO.insurerCode,planCode:q.value||0,riskVOList:V(a)}]}))),productCode:t.productBasicInfoVO.productCode,tenantId:B},{code:r}=await R(o);if("10000"===r){const{code:e,data:t}=await h(o);G.value="10000"===e?t:null}$.value.tenantOrderInsuredList[0].tenantOrderProductList=null==(n=o.insuredVOList[0])?void 0:n.productPlanVOList})($.value,J.value,Q.value)}),500));return l((()=>{(async()=>{var e;const{code:t,data:a}=await j({productCode:C,withInsureInfo:!0,tenantId:B});"10000"===t&&(W.value=a,document.title=a.productFullName||"");const{code:n,data:o}=await P({productCode:C});"10000"===n&&(J.value=o,X.value=o.productFactor,(null==(e=null==o?void 0:o.productRelationPlanVOList)?void 0:e.length)&&(q.value=o.productRelationPlanVOList[0].planCode))})(),setTimeout((async()=>{window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const a=d("ProRadioButton"),n=d("ProCard"),o=d("ProCell"),r=d("van-button"),l=d("ProPageWrap"),O=d("van-config-provider");return u(),i(O,{"theme-vars":m(I)},{default:s((()=>[c(l,null,{default:s((()=>{var e,l;return[v("div",E,[v("div",k,p(null==(l=null==(e=J.value)?void 0:e.productBasicInfoVO)?void 0:l.productFullName),1),m(K)?(u(),i(n,{key:0,title:"保障年期"},{default:s((()=>{var e;return[c(a,{modelValue:q.value,"onUpdate:modelValue":t[0]||(t[0]=e=>q.value=e),class:"radio-group",prop:{label:"planName",value:"planCode"},options:null==(e=J.value)?void 0:e.productRelationPlanVOList},null,8,["modelValue","options"])]})),_:1})):f("",!0),c(N,{ref_key:"formRef",ref:z,"title-collection":{HOLDER:"投保人",INSURER:"被保人",BENEFICIARY:"收益人"},"form-info":$.value,"send-sms-code":()=>{},"input-align":"left","factor-object":X.value},{holderName:s((()=>[_])),insurerName:s((()=>[H])),_:1},8,["form-info","send-sms-code","factor-object"]),c(o,{title:"保费",content:m(M)},null,8,["content"]),v("div",T,[c(r,{type:"primary",block:"",onClick:ee},{default:s((()=>[D])),_:1})])])]})),_:1})])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-dba7be18"]]);export{F as default};
