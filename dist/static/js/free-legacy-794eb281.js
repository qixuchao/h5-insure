!function(){var e=document.createElement("style");e.innerHTML=".free-crad .page-info-wrapper .com-card-wrap .header.showLine{display:none}.free-crad .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell{background:#f6f6f6;border-radius:.21333rem;margin-bottom:.32rem;height:1.17333rem;padding:0 .42667rem;display:flex;align-items:center}.free-crad .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell .van-field__label{width:1.62667rem;margin-top:0;margin-bottom:0}.free-crad .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell .van-cell__value .van-field__body{width:100%}.free-crad .page-info-wrapper .com-card-wrap .com-personal-wrapper .van-cell:after{border-bottom:0}.free-crad .page-info-wrapper .com-card-wrap .van-cell:after{border-bottom:0}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-field__label{width:1.62667rem;margin-top:0;margin-bottom:0}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body{width:100%}.free-crad .page-info-wrapper .com-card-wrap .van-cell.relation-holder{padding-right:0}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap{width:100%}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap .radio-btn{display:flex;justify-content:flex-start}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap .radio-btn .btn-wrapper{margin:0}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-cell__value .van-field__body .van-field__control .com-radio-btn-wrap .radio-btn .btn-wrapper .com-check-btn{min-width:1.33333rem;border-radius:.53333rem!important;margin:0 .10667rem .13333rem 0}.free-crad .page-info-wrapper .com-card-wrap .van-cell .van-cell:after{border-bottom:0}.free-crad[data-v-a8331544]{padding:0 .42667rem;background:linear-gradient(var(--2689eaee),var(--2689eab0))}.free-crad .container[data-v-a8331544]{padding:.61333rem .53333rem .26667rem;background:#ffffff;text-align:center;border-radius:.53333rem}.free-crad .container .title[data-v-a8331544]{height:.44rem;margin-bottom:.53333rem;display:flex;align-items:center;justify-content:center}.free-crad .container .title span[data-v-a8331544]{font-size:.42667rem;font-family:PingFangSC-Semibold,PingFang SC;font-weight:600;color:#333;line-height:.42667rem;margin:0 .29333rem}.free-crad .container .title img[data-v-a8331544]{height:.4rem}.free-crad .container .holder-form[data-v-a8331544]{height:4.66667rem}.page-free-product-detail[data-v-000dd3ac]{background:var(--7d17c51f);padding-bottom:3.14667rem}.page-free-product-detail .submit-btn[data-v-000dd3ac]{margin-top:.4rem}.page-free-product-detail .product-desc img[data-v-000dd3ac]{width:100%}.page-free-product-detail .page-free-footer[data-v-000dd3ac]{position:fixed;width:100%;bottom:0;padding:0 .93333rem .93333rem;box-sizing:border-box}\n",document.head.appendChild(e),System.register(["./vendor-legacy-5ea3e76d.js","./index-legacy-20674234.js","./index-legacy-2468e1f3.js","./index-legacy-4936a720.js","./nextStep-legacy-c6ccd920.js","./phoneVerify-legacy-023a6265.js","./product-legacy-47fb8cb9.js","./trial-legacy-c0945bae.js","./trial-legacy-537d5294.js","./utils-legacy-3f7b8ff6.js","./theme-legacy-41f77bf2.js","./infoCollection-legacy-f09af7f8.js","./relativeTime-legacy-3e445e0c.js","./useDicData-legacy-5035f212.js","./useStorage-legacy-a03407c1.js"],(function(e){"use strict";var t,r,a,n,o,i,d,l,c,s,u,p,f,m,w,v,g,h,y,b,A,I,O,_,C,P,x,k,F,j,V,D,T,N,H,E,L,B,U,S,R,z,Z,M,G,J,Q;return{setters:[function(e){t=e.k,r=e.ax,a=e.r,n=e.O,o=e.$,i=e.s,d=e.B,l=e.C,c=e.E,s=e.S,u=e.Z,p=e.a5,f=e.a6,m=e.m,w=e.aa,v=e.u,g=e.o,h=e.ay,y=e.p,b=e.t,A=e.v,I=e.y,O=e.I,_=e.H,C=e.T},function(e){P=e._,x=e.a8,k=e.a9},function(e){F=e.P},function(e){j=e.B,V=e.A,D=e._,T=e.P},function(e){N=e._,H=e.n},function(e){E=e.a,L=e.s,B=e.c},function(e){U=e.q,S=e.p,R=e.g},function(e){z=e.i,Z=e.t},function(e){M=e.j},function(e){G=e.v,J=e.f},function(e){Q=e.u},function(){},function(){},function(){},function(){}],execute:function(){var q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAAAeCAMAAACBgxnEAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAA8UExURUdwTPpkAPpkAPpkAPlkAPlkAP9fAPpkAP9jAPljAPljAPlkAPdhAP9VAPhlAPpjAPpiAPpkAPlhAPpkAKrbDd8AAAATdFJOUwCe3XX6YBgzC+yKwSIDTrE+0C9Hm6hZAAAAf0lEQVR42u2MSw6AIAxEi6CCf+j976ommvG3omxMOqv2vczQmZa3tPRMptdZndVZndXZf892/JGOxN68qUEr24/zk84jSvne93fae3Qk3scrjZeWzDcVaNUQIvRDOGkYQOU+hYMmsBJ+cTt1C0gZP7mNTvhL+Zq5xlfOW4tb6le9ZDBDk4RvXwAAAABJRU5ErkJggg==";const X={class:"free-crad"},$={class:"container"},K={class:"title"},Y=["src"],W=(e=>(p("data-v-a8331544"),e=e(),f(),e))((()=>l("span",null,"最后一步 填写信息",-1))),ee=["src"],te=t({props:{colors:{type:Array,default:()=>["#CDDFFE","#F1F7FE"]},detail:{type:Object,default:()=>{}},isFirst:{type:Boolean,default:!0},insureDetail:{type:Object,default:()=>{}}},setup(e,{expose:t}){const p=e;r((e=>({"2689eaee":p.colors[0],"2689eab0":p.colors[1]})));const f=a(),m=n({factorObj:{1:[{attributeValues:null,code:"mobile",datasource:null,defaultValue:null,displayType:null,factorId:null,factorScript:null,hasDefaultValue:1,id:8249,isDisplay:1,isHidden:1,isMustInput:2,isReadOnly:null,moduleType:1,placeholder:null,planCode:null,position:null,productCode:"lin23323",productId:null,title:"手机号"},{attributeValues:null,code:"verificationCode",datasource:null,defaultValue:null,displayType:null,factorId:null,factorScript:null,hasDefaultValue:1,id:8249,isDisplay:1,isHidden:1,isMustInput:2,isReadOnly:null,moduleType:1,placeholder:null,planCode:null,position:null,productCode:"lin23323",productId:null,title:"验证码"}],2:[],3:[]},isFirst:!0}),w=async(e,t)=>{const r=p.isFirst?E:L,a=await r(e),{code:n,data:o}=a;"10000"===n&&t?.()};return o((()=>p.isFirst),(()=>{p.isFirst||(m.factorObj=p.insureDetail?.productFactor)})),t({validateForm:()=>new Promise(((e,t)=>{f.value.validateForm().then((t=>{e(!0)})).catch((()=>{t()}))}))}),(t,r)=>(i(),d("div",X,[l("div",$,[l("div",K,[l("img",{src:c(q)},null,8,Y),W,l("img",{src:c(q)},null,8,ee)]),s(N,{ref_key:"formRef",ref:f,"send-sms-code":w,"form-info":e.detail,"factor-object":c(m).factorObj},null,8,["form-info","factor-object"]),u(t.$slots,"default",{},void 0,!0)])]))}});var re=P(te,[["__scopeId","data-v-a8331544"]]);const ae=(e,t,r)=>{m((()=>{(async()=>{try{const{code:r,data:a}=await U(e);if("10000"===r){const e={};a.forEach((t=>{e[t.relationCode]||(e[t.relationCode]=[]),e[t.relationCode].push(t)})),t?.(e)}}catch(a){r?.(!1)}})()}))};const ne={class:"page-free-product-detail"},oe={class:"product-desc"},ie={key:0,class:"page-free-footer"};e("default",P(t({setup(e){r((e=>({"7d17c51f":c(Y).colors[1]})));const t=Q(),u=w(),p=v(),{productCode:f="",tenantId:m="",extraInfo:P}=p.query;let N={};try{N=JSON.parse(decodeURIComponent(P))}catch(se){}const{openId:E,indirectCode:L="123",saleUserId:U="",saleChannelId:q=""}=N;let X="";const $=a(),K=a(),Y=n({colors:["#fff"],detail:{},order:{tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{occupationCodeList:[]},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{occupationCodeList:[]}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}},relationList:{},banner:"",productDesc:[],newAuth:!0,isValidateCode:!1,insureDetail:{},loading:!0,showBtn:!1,activeIndex:0,showFilePreview:!1,isOnlyView:!0}),W=a();ae({openId:E},(e=>{Y.relationList=e}));const ee=async()=>{Y.loading=!0;const e=S({productCode:f,withInsureInfo:!0,tenantId:m}),t=z({productCode:f}),r=R({openId:E});await Promise.all([e,t,r]).then((([e,t,r])=>{if("10000"===e.code){Y.detail=e.data,Y.banner=Y.detail.tenantProductInsureVO?.banner[0];const{colorEnd:t,colorStart:r}=Y.detail.tenantProductInsureVO?.backgroundInsureVO||{};Y.colors=[r,t],Y.productDesc=Y.detail.tenantProductInsureVO.spec||[],document.title=Y.detail.productFullName||""}if("10000"===t.code&&(Y.insureDetail=t.data,Y.insureDetail.productFactor[1].forEach((e=>{"verificationCode"===e.code&&1===e.isDisplay&&(Y.isValidateCode=!0)})),Y.insureDetail.productFactor[2]=Y.insureDetail.productFactor?.[2].map((e=>("relationToHolder"===e.code&&1===e.isDisplay&&(e.title="被保人",Y.order.tenantOrderInsuredList[0].relationToHolder=e.attributeValueList?.[0]?.code||""),e)))),"10000"===r.code&&(Y.newAuth=!r.data,r.data)){const e=r.data;Y.order.tenantOrderHolder={certNo:e?.certiNo,extInfo:{},mobile:e?.mobile,name:e?.name}}(()=>{let e={};if(e=Y.detail.tenantProductInsureVO.planInsureVO.attachmentVOList||[],!e)return void(W.value=[]);const t={2:"richText",3:"link"};W.value=Object.keys(e).map((r=>(e[r].forEach((e=>{if("1"===e.attachmentType){const t=e.attachmentUri.split("?"),r=t[0].substr(t[0].lastIndexOf(".")+1);e.attachmentType="pdf"===r?"pdf":"picture"}else e.attachmentType=t[e.attachmentType]})),{attachmentName:r,attachmentList:e[r]})))||[]})(),Y.loading=!1}))},te=async()=>{let e={loginType:"2",openId:E,thirdUserType:"XINAO_WECHAT",indirectCode:L};try{if(Y.newAuth?(e.loginName=Y.order.tenantOrderHolder.mobile,e.password=Y.order.tenantOrderHolder.verificationCode):e=J({order:Y.order,tenantId:m,extraInfo:N,detail:Y.detail,insureDetail:Y.insureDetail,iseeBizNo:X,saleUserId:U,templateId:N?.templateId,saleChannelId:q,pageCode:"infoCollection",buttonCode:"EVENT_FREE_multiIssuePolicy"}),Y.newAuth){const{code:t,data:r}=await Z(e);"10000"===t&&(Y.newAuth=!1)}else H(e,((e,t)=>{t===k.JUMP_PAGE&&e.orderNo&&u.push(`/baseInsurance/orderDetail?from=free&tenantId=${m}&orderNo=${e.orderNo}&productCode=${f}`)}))}catch(t){}},de=async()=>await(async()=>{await K.value.validateForm();const e=Y.order.tenantOrderHolder?.verificationCode;if(Y.isValidateCode&&(!e||!G(e)))return C({message:"请输入正确的验证码"}),!1;if(Y.newAuth||!Y.isValidateCode)return!0;const{code:t,data:r}=await B(Y.order.tenantOrderHolder.mobile,e);return!!r})()?(Y.newAuth||0===W.value.length?te():(Y.isOnlyView=!1,Y.showFilePreview=!0),!1):null,le=()=>{Y.showFilePreview=!1,Y.isOnlyView=!1},ce=()=>{Y.showFilePreview=!1,Y.isOnlyView=!0,te()};return g((()=>{ee(),setTimeout((async()=>{X=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),o((()=>Y.order.tenantOrderInsuredList[0]),(e=>{if(x(Y.relationList)||Y.newAuth)return null;const t=Y.relationList[e.relationToHolder]||[];return 1===t.length&&(M.SELF!==e.relationToHolder?(Y.order.tenantOrderInsuredList[0].certNo=Y.order.tenantOrderInsuredList[0].certNo?Y.order.tenantOrderInsuredList[0].certNo:t[0].cert[0].certNo,Y.order.tenantOrderInsuredList[0].name=Y.order.tenantOrderInsuredList[0].name?Y.order.tenantOrderInsuredList[0].name:t[0].cert[0].certName):(Y.order.tenantOrderHolder.certNo=Y.order.tenantOrderHolder.certNo?Y.order.tenantOrderHolder.certNo:t[0].cert[0].certNo,Y.order.tenantOrderHolder.name=Y.order.tenantOrderHolder.name?Y.order.tenantOrderHolder.name:t[0].cert[0].certName)),!1}),{immediate:!0,deep:!0}),h($,(([{isIntersecting:e}],t)=>{Y.showBtn=!e})),(e,r)=>{const a=y("van-image"),n=y("van-config-provider");return i(),b(n,{"theme-vars":c(t)},{default:A((()=>[l("div",ne,[s(j,{url:c(Y).banner},null,8,["url"]),s(re,{ref_key:"formRef",ref:K,"is-first":c(Y).newAuth,"insure-detail":c(Y).insureDetail,detail:c(Y).order,colors:c(Y).colors},{default:A((()=>[s(F,{ref_key:"root",ref:$,class:"submit-btn","is-gradient":!1,text:c(Y).newAuth?"立即领取":"激活保障",onClick:de},null,8,["text"]),W.value&&W.value.length>0?(i(),b(V,{key:0,"attachement-list":W.value,"has-bg-color":!1,"pre-text":"请阅读",onPreviewFile:r[0]||(r[0]=e=>(e=>{Y.activeIndex=e,Y.showFilePreview=!0})(e))},null,8,["attachement-list"])):I("",!0)])),_:1},8,["is-first","insure-detail","detail","colors"]),l("div",oe,[(i(!0),d(_,null,O(c(Y).productDesc,((e,t)=>(i(),b(a,{key:t,width:"100%","lazy-load":"",src:e,class:""},null,8,["src"])))),128))]),c(Y).showBtn?(i(),d("footer",ie,[s(F,{"is-gradient":!1,text:c(Y).newAuth?"立即领取":"激活保障",onClick:de},null,8,["text"])])):I("",!0)]),c(Y).showFilePreview&&0!==W.value.length?(i(),b(D,{key:0,show:c(Y).showFilePreview,"onUpdate:show":r[1]||(r[1]=e=>c(Y).showFilePreview=e),"content-list":W.value,"is-only-view":c(Y).isOnlyView,"active-index":c(Y).activeIndex,text:c(Y).isOnlyView?"关闭":"我已逐页阅读上述内容并同意","force-read-cound":0,"on-close-file-preview":"",onSubmit:ce,onOnCloseFilePreview:le},null,8,["show","content-list","is-only-view","active-index","text"])):I("",!0),c(Y).loading?I("",!0):(i(),b(T,{key:1,"product-detail":c(Y).detail},null,8,["product-detail"]))])),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-000dd3ac"]]))}}}))}();
