!function(){var e=document.createElement("style");e.innerHTML='@charset "UTF-8";.page-card-info{background:#f4f5f7;height:100%}.page-card-info .van-cell__title .label{color:#343434}.page-card-info .van-field__label{color:#343434;height:.56rem;font-size:.4rem;line-height:.56rem}.page-card-info .van-field__body{height:.56rem;font-size:.4rem;line-height:.56rem}.page-card-info .van-field--disabled .van-field__label{color:#343434}.page-card-info .van-field__control:disabled{color:#343434}.page-card-info .van-cell{font-size:.37333rem;padding:.44rem .4rem}.page-card-info .card-info-person{padding:.26667rem .4rem .10667rem}.page-card-info .card-info-person .label,.page-card-info .card-info-person .label-person{font-size:.4rem}.page-card-info .card-info-person .van-cell__label{font-size:.32rem;color:#bcbcbc}.page-card-info .van-cell__title .label{line-height:1.33333rem}.page-card-info .van-cell__right-icon{line-height:.93333rem;color:#ddd}.page-card-info .van-uploader__input-wrapper{display:flex;align-items:center}@charset "UTF-8";.page-card-info .info-img[data-v-0d506285]{width:1.17333rem;height:1.17333rem}.page-card-info .arrow-icon-card[data-v-0d506285]{color:#ddd;height:.32rem;margin-left:.32rem;line-height:1.46667rem;border-radius:0}.page-card-info .info-img-avata[data-v-0d506285]{border-radius:50%}.page-card-info .card-person-cell[data-v-0d506285]{color:var(--van-primary-color);width:8rem}.page-card-info .card-person-cell .van-cell__label[data-v-0d506285]{font-size:.32rem;color:#bcbcbc}.page-card-info .label[data-v-0d506285]{color:#343434}.page-card-info .line[data-v-0d506285]{display:inline-block;width:.10667rem;height:.37333rem;background:var(--van-primary-color);vertical-align:middle;margin-right:.21333rem}.page-card-info input[data-v-0d506285]::placeholder{color:#bcbcbc}.page-card-info .cell-val[data-v-0d506285]{color:#bcbcbc}.page-card-info .copy[data-v-0d506285]{width:.48rem;vertical-align:sub}.page-card-info .star[data-v-0d506285]{color:var(--van-primary-color)}.page-card-info .desc[data-v-0d506285]{font-size:.32rem;color:#bcbcbc;line-height:.44rem}.page-card-info .value[data-v-0d506285]{color:#343434}.page-card-info .van-cell-group--inset[data-v-0d506285]{margin:0}.page-card-info .card-info-btn[data-v-0d506285]{width:100%;padding:1.30667rem .4rem 0}.page-card-info .card-info-btn .btn[data-v-0d506285]{height:1.2rem}.page-card-info .card-info-btn .btn .van-button__text[data-v-0d506285]{font-size:.42667rem}\n',document.head.appendChild(e),System.register(["./vendor-legacy-f56233fa.js","./businessCard-legacy-ee5b8d3d.js","./useCheckBack-legacy-8b231055.js","./plugin-vue_export-helper-legacy-57eac467.js","./index-legacy-9604cbf9.js"],(function(e){"use strict";var t,i,a,n,o,s,l,r,c,d,h,p,m,g,f,u,v,b,y,w,x,k;return{setters:[function(e){e.a8,t=e.g,i=e.Q,a=e.a0,n=e.C,o=e.M,s=e.h,l=e.j,r=e.r,c=e.k,d=e.n,h=e.y,p=e.z,m=e.a2,g=e.a3,f=e.B,u=e.T},function(e){v=e.g,b=e.u,y=e.a,w=e.m},function(e){x=e.u},function(e){k=e._},function(){}],execute:function(){var _={exports:{}};_.exports=function(){function e(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&a.firstChild?a.insertBefore(n,a.firstChild):a.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}e(".clipic-body{background:#1c1c1c;position:fixed;width:100%;height:100%;top:0;left:0;-webkit-transform:translateY(100%);-ms-transform:translateY(100%);transform:translateY(100%);-webkit-transition:.4s;-o-transition:.4s;transition:.4s;-webkit-touch-callout:none;-webkit-user-select:none;z-index:99;overflow:hidden}.clipic-body,.clipic-body *{-webkit-box-sizing:border-box;box-sizing:border-box}.clipic-operation-bar{display:-webkit-box;display:-ms-flexbox;display:flex;color:#f2f2f2;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;position:absolute;width:100%;bottom:0;left:0}.clipic-operation-bar [role=button]{padding:15px 20px;font-size:1em}.clipic-frame{background:#f2f2f2;position:absolute;left:50%;top:30px;transform:translateX(-50%);transition:.3s}.clipic-frame img{-webkit-touch-callout:none;pointer-events:none}.clipic-frame-show{overflow:hidden}.clipic-cancel{color:#e04c4c}.clipic-reset{color:#3680fd}.clipic-confirm{color:#23c667}.clipic-layer{position:fixed;width:100%;height:100%;top:0;left:0;background:rgba(0,0,0,.8);pointer-events:none;transform:translateZ(0)}");var t='\n    <div class="clipic-frame" id="clipicFrame1"><img id="clipicImg1"></div>\n    <div class="clipic-layer"></div>\n    <div class="clipic-frame clipic-frame-show" id="clipicFrame2"><img id="clipicImg2"></div>\n    <div class="clipic-operation-bar">\n      <div class="clipic-cancel" id="clipicCancel" role="button">取消</div>\n      <div class="clipic-reset" id="clipicReset" role="button">重置</div>\n      <div class="clipic-confirm" id="clipicConfirm" role="button">完成</div>\n    </div>\n  ',i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=function(){function e(){i(this,e),this.default={width:500,height:500,src:"",encode:"base64",type:"jpeg",name:"clipic",quality:.9,buttonText:["取消","重置","完成"]},this.init(),this.clipic=this.getId("clipic"),this.img1=this.getId("clipicImg1"),this.img2=this.getId("clipicImg2"),this.frame1=this.getId("clipicFrame1"),this.frame2=this.getId("clipicFrame2"),this.cancelBtn=this.getId("clipicCancel"),this.resetBtn=this.getId("clipicReset"),this.confirmBtn=this.getId("clipicConfirm"),this.reset=this.reset.bind(this),this.done=this.done.bind(this),this.cancel=this.cancel.bind(this)}return a(e,[{key:"init",value:function(){this.getId("clipic")||this.createHtml()}},{key:"getId",value:function(e){return document.getElementById(e)}},{key:"createHtml",value:function(){var e=document.createElement("div");e.className="clipic-body",e.setAttribute("id","clipic"),e.innerHTML=t,document.body.appendChild(e)}},{key:"getImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.scale=1,this.rotate=0,this.translateX=0,this.translateY=0;var i=JSON.parse(JSON.stringify(this.default));this.options=Object.assign(i,t),this.cancelBtn.innerHTML=this.options.buttonText[0],this.resetBtn.innerHTML=this.options.buttonText[1],this.confirmBtn.innerHTML=this.options.buttonText[2],this.img1.src=this.options.src,this.img2.src=this.options.src;var a=new Image;a.onload=function(){e.originW=e.img2.width,e.originH=e.img2.height,e.options.ratio?(e.options.width=e.img2.width,e.options.height=e.img2.width/e.options.ratio):e.options.ratio=e.options.width/e.options.height,e.originRatio=e.originW/e.originH,e.initSize(),e.clipic.style.transform="translate(0, 0)",setTimeout((function(){e.options.ratio>e.originRatio?(e.img1.style.width=e.frame2.clientWidth+"px",e.img2.style.width=e.frame2.clientWidth+"px"):(e.img1.style.height=e.frame2.clientHeight+"px",e.img2.style.height=e.frame2.clientHeight+"px")}),300),e.setTransform(),e.cancelBtn.addEventListener("click",e.cancel),e.resetBtn.addEventListener("click",e.reset),e.confirmBtn.addEventListener("click",e.done),e.clipic.addEventListener("touchmove",(function(t){if(t.preventDefault(),t.touches.length>1)return e.setScale(t.touches[0],t.touches[1]),void e.setRotate(t.touches[0],t.touches[1]);e.setTranslate(t.touches[0])})),e.clipic.addEventListener("touchend",(function(t){e.distance=null,e.angle=null,e.moveX=null,e.moveY=null}))},a.src=this.options.src}},{key:"initSize",value:function(){var e=document.documentElement||document.body,t=e.clientWidth-60,i=e.clientHeight-80;this.frame1.style.width=t+"px",this.frame1.style.height=t/this.options.ratio+"px",this.frame2.style.width=t+"px",this.frame2.style.height=t/this.options.ratio+"px",t/this.options.ratio>i&&(this.frame1.style.height=i+"px",this.frame1.style.width=i*this.options.ratio+"px",this.frame2.style.height=i+"px",this.frame2.style.width=i*this.options.ratio+"px")}},{key:"setScale",value:function(e,t){var i=Math.abs(e.clientX-t.clientX),a=Math.abs(e.clientY-t.clientY),n=Math.sqrt(i*i+a*a);this.distance&&(this.scale+=(n-this.distance)/this.img2.clientWidth,this.setTransform()),this.distance=n}},{key:"setRotate",value:function(e,t){var i=e.clientX-t.clientX,a=e.clientY-t.clientY,n=180*Math.atan2(a,i)/Math.PI;this.angle&&(this.rotate+=n-this.angle,this.setTransform()),this.angle=n}},{key:"setTranslate",value:function(e){var t=e.clientX,i=e.clientY;this.moveX&&(this.translateX+=t-this.moveX),this.moveY&&(this.translateY+=i-this.moveY),this.moveX=t,this.moveY=i,this.setTransform()}},{key:"setTransform",value:function(){var e="translate("+this.translateX+"px, "+this.translateY+"px) scale("+this.scale+") rotate("+this.rotate+"deg)";this.img1.style.transform=e,this.img2.style.transform=e}},{key:"cancel",value:function(e){var t=this;this.clipic.style.transform="translate(0, 100%)",setTimeout((function(){t.img1.style="",t.img1.src="",t.img2.style="",t.img2.src=""}),400),this.options.onCancel&&"done"!==e&&this.options.onCancel(),this.cancelBtn.removeEventListener("click",this.cancel),this.resetBtn.removeEventListener("click",this.reset),this.confirmBtn.removeEventListener("click",this.done,!0)}},{key:"reset",value:function(){var e=this;this.scale=1,this.rotate=0,this.translateX=0,this.translateY=0,this.img1.style.transition="0.3s",this.img2.style.transition="0.3s",this.setTransform(),setTimeout((function(){e.img1.style.transition="",e.img2.style.transition=""}),300)}},{key:"done",value:function(){var e=this,t=this.options.width/this.frame2.clientWidth,i=document.createElement("canvas");i.width=this.options.width,i.height=this.options.height;var a=i.getContext("2d");a.fillStyle="#fff",a.fillRect(0,0,i.width,i.height);var n=void 0,o=void 0;this.options.ratio>this.originRatio?(n=this.options.width,o=this.originH/(this.originW/this.options.width)):(o=this.options.height,n=this.originW/(this.originH/this.options.height));var s={x:n/2,y:o/2};if(a.translate(this.translateX*t,this.translateY*t),0!==this.rotate&&(a.translate(s.x,s.y),a.rotate(this.rotate*Math.PI/180),a.translate(-s.x,-s.y)),1!==this.scale&&(a.translate(s.x*(1-this.scale),s.y*(1-this.scale)),a.scale(this.scale,this.scale)),a.drawImage(this.img2,0,0,n,o),this.options.onDone)switch(this.options.encode){case"base64":default:this.options.onDone(i.toDataURL("image/"+this.options.type,this.options.quality));break;case"blob":i.toBlob((function(t){e.options.onDone(t)}),"image/"+this.options.type);break;case"file":i.toBlob((function(t){var i=new window.File([t],e.options.name,{type:"image/"+e.options.type});e.options.onDone(i)}),"image/"+this.options.type)}this.cancel("done")}}]),e}();return n}();var T=_.exports;const I=e=>(m("data-v-0d506285"),e=e(),g(),e),z=I((()=>h("span",{class:"label-person"},"个人形象照",-1))),C=I((()=>h("span",{class:"star"},"*",-1))),B=["src"],U=I((()=>h("span",{class:"label"},"微信二维码",-1))),Y=["src"],j={class:"card-info-btn"},E=f(" 保存 "),L=t({setup(e){i();const t=a(),m=new T,g=n(!1);n("");const f=n({});x(f);const k=e=>{if(!("image/jpg"===e.type||"image/jpeg"===e.type||"image/png"===e.type))return u("请上传 image 格式图片"),!1;if(!(e.size/1024/1024<5))return u("文件大小不能超过 5M"),!1;const t=new FileReader;t.readAsDataURL(e),t.onload=e=>{var t;m.getImage({width:800,height:800,src:null==e||null===(t=e.target)||void 0===t?void 0:t.result,onDone:async e=>{const t=await b({fileBase64:e}),{status:i,data:a}=t.data,n=await y({key:a}),{data:o}=n.data;f.value.imagePhotoUrl=o.fileOriginalUrl}})}},_=e=>{if(!("image/jpg"===e.type||"image/jpeg"===e.type||"image/png"===e.type))return u("请上传 image 格式图片"),!1;if(!(e.size/1024/1024<5))return u("文件大小不能超过 5M"),!1;const t=new FileReader;t.readAsDataURL(e),t.onload=e=>{var t;m.getImage({width:500,height:400,src:null==e||null===(t=e.target)||void 0===t?void 0:t.result,onDone:async e=>{const t=await b({fileBase64:e}),{status:i,data:a}=t.data,n=await y({key:a}),{data:o}=n.data;f.value.wechatQrCodeUrl=o.fileOriginalUrl}})}},I=async()=>{if(f.value.imagePhotoUrl){const e=await w({personalPhoto:f.value.imagePhotoUrl,wechatNo:f.value.wechatNumber,qrCode:f.value.wechatQrCodeUrl}),{status:i}=e.data;200===i&&(u("保存成功！"),g.value=!1,x(),t.back())}else u("请先上传个人形象照")};return o((async()=>{const e=await v({}),{status:t,data:i}=e.data;f.value=i,200===t&&(f.value=i,x(f))})),(e,t)=>{const i=r("ZaSvg"),a=r("van-uploader"),n=r("van-cell"),o=r("van-field"),m=r("van-cell-group"),g=r("van-button"),u=r("ZaPageWrap");return c(),s(u,{"main-class":"page-card-info"},{default:l((()=>[d(m,{inset:"","custom-class":"card-person-cell"},{default:l((()=>[d(n,{label:"建议尺寸800*800",class:"card-info-person"},{title:l((()=>[z,C])),default:l((()=>[d(a,{"result-type":e.file,"max-count":1,"before-read":k,"max-size":5242880,"preview-size":"44",onOversize:e.onOversize},{default:l((()=>[h("img",{src:p(f).imagePhotoUrl,alt:"",class:"info-img info-img-avata"},null,8,B),d(i,{name:"right_arrow",class:"arrow-icon-card"})])),_:1},8,["result-type","onOversize"])])),_:1}),d(o,{modelValue:p(f).name,"onUpdate:modelValue":t[0]||(t[0]=e=>p(f).name=e),name:"name",label:"姓名",placeholder:"","input-align":"right",disabled:""},null,8,["modelValue"]),d(o,{modelValue:p(f).mobile,"onUpdate:modelValue":t[1]||(t[1]=e=>p(f).mobile=e),name:"mobile",label:"手机号码","input-align":"right",placeholder:"",disabled:""},null,8,["modelValue"]),d(o,{modelValue:p(f).company,"onUpdate:modelValue":t[2]||(t[2]=e=>p(f).company=e),name:"company",label:"所在公司",placeholder:"","input-align":"right",disabled:""},null,8,["modelValue"]),d(o,{modelValue:p(f).companyPosition,"onUpdate:modelValue":t[3]||(t[3]=e=>p(f).companyPosition=e),name:"companyPosition",label:"公司职位","input-align":"right",placeholder:"",disabled:""},null,8,["modelValue"]),d(o,{modelValue:p(f).wechatNumber,"onUpdate:modelValue":t[4]||(t[4]=e=>p(f).wechatNumber=e),name:"wechatNumber",label:"微信号","input-align":"right",placeholder:"",center:""},null,8,["modelValue"]),d(n,{class:"card-info-person"},{title:l((()=>[U])),default:l((()=>[d(a,{"before-read":_},{default:l((()=>[h("img",{src:p(f).wechatQrCodeUrl,alt:"",class:"info-img"},null,8,Y),d(i,{name:"right_arrow",class:"arrow-icon-card"})])),_:1})])),_:1})])),_:1}),h("div",j,[d(g,{round:"",block:"",class:"btn",type:"primary",onClick:I},{default:l((()=>[E])),_:1})])])),_:1})}}});e("default",k(L,[["__scopeId","data-v-0d506285"]]))}}}))}();
