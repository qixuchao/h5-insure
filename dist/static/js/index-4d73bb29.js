import{d as e,u as a,a as t,G as n,r,z as i,x as o,aj as d,O as s,b as l,c as u,e as f,w as c,l as p,f as I,j as v,g as m,F as y,h as O,i as L,t as C,n as g,a4 as x,C as b,D as h,p as T,N as E,a6 as P,a7 as R}from"./index-47b8fe54.js";import{a as B,B as H}from"./infoCollection-dabb668d.js";import{_ as V}from"./index-6caf9d9e.js";import{I as j}from"./InsuredPart-00777f32.js";import{u as w}from"./useDicData-26b166b7.js";import"./pdfh5-e5c0db2a.js";import"./relativeTime-190c9ccf.js";import"./trial-0d968ca8.js";const _={key:0,class:"beneficiary-part"},A={class:"part-title"},U={class:"title"},N={class:"radio-item-wrapper"},k={class:"name"},D={class:"hone"},S={class:"address"},F={class:"footer-button"},q=g("下一步"),$=e({setup(e){const g=a(),$=t(),{templateId:G=1,orderNo:Y="2022072710380711215",tenantId:z="9991000007",isShare:W,sharePageCode:J}=$.query;n();const K="/infoPreview"===$.path?"infoPreview":"infoCollection",M=r({}),Q=w("NATIONAL_REGION_CODE"),X=r({extInfo:{pageCode:K},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),Z=r(null),ee=r([]),ae=r([]),te=r([]),ne=r([]),re=r([]),ie=i({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),oe=o((()=>{var e,a;return(null==(a=null==(e=X.value.extInfo)?void 0:e.contactInfo)?void 0:a[0])||{}})),de=()=>{W?x(`${J}`,$.query):b(X.value).then((({code:e,data:a})=>{"10000"===e&&"jumpToPage"===a.pageAction.pageAction&&g.push({path:h[a.pageAction.data.nextPageCode],query:$.query})}))};return d((()=>{T({orderNo:Y,tenantId:z}).then((({code:e,data:a})=>{if("10000"===e){const e=a;e.extInfo={...e.extInfo,pageCode:K,templateId:G,buttonCode:E.infoPreview},e.tenantOrderHolder=e.tenantOrderHolder||{},e.tenantOrderHolder.extInfo=e.tenantOrderHolder.extInfo||{occupationCodeList:[]},e.tenantOrderInsuredList[0].extInfo=e.tenantOrderInsuredList[0].extInfo||{occupationCodeList:[]},e.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=e.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map((e=>{const a=e;return a.extInfo=a.extInfo||{},a})),e.tenantOrderAttachmentList.forEach((e=>{e.category===P.OBVERSE_CERT?e.objectType===R.HOLDER?(ee.value[0]=e.uri,te.value[0]=e.id):e.objectType===R.INSURED&&(ae.value[0]=e.uri,ne.value[0]=e.id):e.category===P.REVERSE_CERT&&(e.objectType===R.HOLDER?(ee.value[1]=e.uri,te.value[1]=e.id):e.objectType===R.INSURED&&(ae.value[1]=e.uri,te.value[1]=e.id))})),Object.assign(X.value,e)}})).finally((()=>{ie.isLoading=!1})),s({pageCode:"infoCollection",templateId:G}).then((({code:e,data:a})=>{if("10000"===e){const e={BENEFICIARY:[],INSURER:[],HOLDER:[]};a.productInsureFactorList.forEach((a=>{(e[a.moduleType]=e[a.moduleType]||[]).push(a)})),M.value=e}}))})),(e,a)=>{const t=l("ProCard"),n=l("ProRadioButton"),r=l("ProField"),i=l("ProCascader"),o=l("van-cell"),d=l("ProForm"),s=l("VanButton"),g=l("ProPageWrap");return u(),f(g,{class:"page-info-wrapper"},{default:c((()=>[p(ie).isLoading?v("",!0):(u(),f(d,{key:0,ref_key:"formRef",ref:Z,"is-view":""},{default:c((()=>{var e;return[I(j,{"product-data":null==(e=X.value.tenantOrderInsuredList[0])?void 0:e.tenantOrderProductList[0]},null,8,["product-data"]),I(t,{title:"投保人"},{default:c((()=>[I(V,{images:ee.value,"onUpdate:images":a[0]||(a[0]=e=>ee.value=e),"form-info":X.value.tenantOrderHolder,"factor-list":M.value.HOLDER,"is-view":""},null,8,["images","form-info","factor-list"])])),_:1}),I(t,{title:"被保人"},{default:c((()=>[I(r,{modelValue:X.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":a[2]||(a[2]=e=>X.value.tenantOrderInsuredList[0].relationToHolder=e),label:"为谁保单",name:"relationToHolder",placeholder:"请选择"},{input:c((()=>[I(n,{modelValue:X.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":a[1]||(a[1]=e=>X.value.tenantOrderInsuredList[0].relationToHolder=e),options:p(B),"is-view":""},null,8,["modelValue","options"])])),_:1},8,["modelValue"]),1!=+X.value.tenantOrderInsuredList[0].relationToHolder?(u(),f(V,{key:0,images:ae.value,"onUpdate:images":a[3]||(a[3]=e=>ae.value=e),"form-info":X.value.tenantOrderInsuredList[0],"factor-list":M.value.INSURER||[],"is-view":""},null,8,["images","form-info","factor-list"])):v("",!0),I(i,{modelValue:X.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:modelValue":a[4]||(a[4]=e=>X.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=e),field1:X.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode,"onUpdate:field1":a[5]||(a[5]=e=>X.value.tenantOrderInsuredList[0].extInfo.insureProvinceCode=e),field2:X.value.tenantOrderInsuredList[0].extInfo.insureCityCode,"onUpdate:field2":a[6]||(a[6]=e=>X.value.tenantOrderInsuredList[0].extInfo.insureCityCode=e),field3:X.value.tenantOrderInsuredList[0].extInfo.insureAreaCode,"onUpdate:field3":a[7]||(a[7]=e=>X.value.tenantOrderInsuredList[0].extInfo.insureAreaCode=e),label:"投保地区",name:"insureProvinceCode",placeholder:"请选择","is-link":"",required:"","data-source":p(Q),mapping:{label:"name",value:"code",children:"children"}},null,8,["modelValue","field1","field2","field3","data-source"])])),_:1}),I(t,{title:"受益人"},{default:c((()=>[I(r,{modelValue:X.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":a[9]||(a[9]=e=>X.value.tenantOrderInsuredList[0].insuredBeneficiaryType=e),label:"受益人类型",name:"insuredBeneficiaryType",placeholder:"请选择"},{input:c((()=>[I(n,{modelValue:X.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":a[8]||(a[8]=e=>X.value.tenantOrderInsuredList[0].insuredBeneficiaryType=e),options:p(H),"is-view":""},null,8,["modelValue","options"])])),_:1},8,["modelValue"]),2==X.value.tenantOrderInsuredList[0].insuredBeneficiaryType?(u(),m("div",_,[(u(!0),m(y,null,O(X.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,((e,t)=>(u(),m("div",{key:e.beneficiaryId,class:"beneficiary-item"},[L("div",A,[L("span",U,C(`受益人${t+1}`),1)]),I(V,{images:re.value,"onUpdate:images":a[10]||(a[10]=e=>re.value=e),"form-info":e,"factor-list":M.value.BENEFICIARY||[],prefix:`beneficiary-${t}`,"is-view":"","beneficiary-list":X.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList},null,8,["images","form-info","factor-list","prefix","beneficiary-list"])])))),128))])):v("",!0)])),_:1}),I(t,{title:"保单通讯信息"},{default:c((()=>[Object.keys(p(oe)).length?(u(),f(o,{key:0,title:"单元格"},{title:c((()=>[L("div",N,[L("p",null,[L("span",k,C(p(oe).contactName),1),L("span",D,C(p(oe).contactPhoneNo),1)]),L("p",S,C(p(oe).contactAddress),1)])])),_:1})):v("",!0)])),_:1})]})),_:1},512)),L("div",F,[I(s,{block:"",type:"primary",onClick:de},{default:c((()=>[q])),_:1})])])),_:1})}}});export{$ as default};
