import{d as e,r as a,ay as n,R as t,c as r,A as i,f as s,g as o,i as l,h as d,E as u,U as c,w as p,k as m,j as y,a9 as f,az as h,ae as v,C as k}from"./index-e193e8da.js";import{P as C}from"./index-56005bd3.js";import{b as T,c as I}from"./trial-ff4a49b1.js";const O={class:"trial-button-wrap"},D={class:"footer-area"},x=s("span",null,"分享",-1),P={class:"price"},g={key:0},E=e({name:"trialButton"}),S=e({...E,props:{premium:{default:0},tenantProductDetail:{default:()=>({})},planCode:{default:void 0},loadingText:{default:""},paymentFrequency:{default:""},shareInfo:{default:()=>({})},isShare:{type:Boolean,default:!1},handleShare:null},emits:["handleClick"],setup(e,{emit:k}){const T=e,I=a(""),E=a(""),S=n(),b=a(),L=()=>{T.handleShare?T.handleShare((()=>b.value.handleShare())):b.value.handleShare()};return t([()=>T.premium,()=>T.tenantProductDetail,()=>T.paymentFrequency,()=>T.planCode],(([e])=>{const{PREMIUM:a=[]}=T.tenantProductDetail||{};let n={};if(null==a?void 0:a.length){n=(a||[]).find((e=>e.planCode===T.planCode||!e.planCode))||{};const t=((null==n?void 0:n.data)||[]).find((e=>e.paymentFrequency===T.paymentFrequency)),{premium:r,minActualUnit:i}=t||{};e?(E.value=i,I.value=e&&`${e}`):(E.value=r,I.value="")}else e&&(E.value="",I.value=e&&`${e}`)}),{deep:!0,immediate:!0}),(a,n)=>{const t=v;return r(),i("div",O,[s("div",D,[e.isShare&&o(S)?(r(),i("div",{key:0,class:"com-share",onClick:L},[l(t,{name:"share-icon","font-size":"24px",color:"#AEAEAE"}),x])):d("",!0),s("div",P,[e.loadingText?(r(),i("span",g,u(e.loadingText),1)):(r(),i(c,{key:1},[s("span",null,u(o(I)),1),s("span",null,u(o(E)),1)],64))]),l(C,{shadow:!1,class:"right",onClick:n[0]||(n[0]=e=>k("handleClick"))},{default:p((()=>[m(a.$slots,"default",{},(()=>[y("立即投保")]))])),_:3})]),l(h,f({ref_key:"shareRef",ref:b},e.shareInfo),null,16)])}}}),b=(e,a)=>{const n=[];return e.forEach((e=>{var t;null==(t=e.tenantOrderRiskList)||t.forEach((e=>{const{currentAmount:t,paymentPeriod:r,paymentPeriodType:i,liabilityDetails:s,extInfo:o,insurancePeriodValue:l,insurancePeriodType:d,paymentFrequency:u,riskType:c,riskCode:p,initialPremium:m,initialAmount:y,annuityDrawFrequency:f,annuityDrawDate:h}=e;let v=`${T[i]}_${r}`;1===i&&(v="single");let k=`${I[d]}_${l}`;5===d&&(k="to_life"),n.push({amount:y,annuityDrawDate:h,annuityDrawFrequency:f,chargePeriod:v,copy:(null==o?void 0:o.copy)||"",coveragePeriod:k,insuredCode:a,liabilityVOList:s,mainRisk:"",mainRiskCode:"",mainRiskId:"",paymentFrequency:u,premium:m,riskType:c,riskCode:p,riskId:(null==o?void 0:o.riskId)||"",riderRisk:"",riderRiskVOList:[]})}))})),n},L=({holder:e,insuredList:a=[]})=>{const n=["birthday","certEndDate","certEndType","certNo","certStartDate","verificationCode","certType","email","gender","mobile","name","id","insuredBeneficiaryType","relationToHolder","relationToMainInsured","tenantOrderBeneficiaryList","extInfo"],t=e=>{const a={extInfo:{}};return"[object Object]"==={}.toString.call(e)&&Object.keys(e).forEach((t=>{n.includes(t)?a[t]=e[t]:a.extInfo[t]=e[t]})),a};return{tenantOrderHolder:t(e),tenantOrderInsuredList:(a||[]).map((e=>t(e)))}},R=(e,a)=>{var n;const{tenantId:t,commencementTime:r,expiryDate:i,venderCode:s,tenantOrderHolder:o,tenantOrderInsuredList:l}=e;return{tenantId:t,insuranceStartDate:r,insuranceEndDate:i,holder:{personVO:{...o,socialFlag:null==(n=o.extInfo)?void 0:n.hasSocialInsurance,certType:o.certType||k.CERT}},insuredVOList:l.map((n=>({insuredCode:"",relationToHolder:n.relationToHolder,personVO:{...n,socialFlag:n.extInfo.hasSocialInsurance,certType:n.certType||k.CERT},productPlanVOList:[{insurerCode:s,planCode:a||"",riskVOList:b(n.tenantOrderProductList||[],e.venderCode)}]})))}};export{S as _,L as f,R as o};
