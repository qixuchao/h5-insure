import{bS as e,bT as t,bk as r,T as n,bU as o,bi as s,b5 as a,y as u,b4 as i,af as I}from"./index-4d5fa34d.js";import{s as d}from"./core-7b92637e.js";const{VITE_BASE:E}={VITE_BASE:"/h5insure/",VITE_API_BASEURL:"/h5insure/",VITE_APP_TITLE:"投保流程",VITE_THEME_COLOR:"#C41E21",VITE_APP_DESCRIPTION:"一种互联网投保的快速落地实现方案",BASE_URL:"/h5insure/",MODE:"production",DEV:!1,PROD:!0},l=async(l,_,p)=>{var c,T;const y=l,{extInfo:A,orderNo:N,insuredList:R,tenantId:L}=y||{},{iseeBizNo:h,templateId:q}=A||{};if(N){const{productCode:e}=(null==(T=null==(c=null==R?void 0:R[0])?void 0:c.productList)?void 0:T[0])||{};let t=`${window.location.origin}${E}baseInsurance/orderDetail?orderNo=${N}&tenantId=${L}&ISEE_BIZ=${h}&productCode=${e}`;q>200&&(t=`${window.location.origin}${E}baseInsurance/long/result?orderNo=${N}&templateId=${q}&tenantId=${L}&ISEE_BIZ=${h}&productCode=${e}`),y.extInfo.redirectUrl=t}const S=e();if(S.ext)try{y.ext=S.ext}catch(f){console.error("ext 参数格式错误",S.ext,f)}const{code:U,data:$}=await t(y);if("10000"===U){const{pageAction:e,message:t,data:E}=$.pageAction||{};null==_||_(E,e,t),e===r.ALERT&&n(t),e===r.JUMP_URL&&d(null==E?void 0:E.payUrl),e===r.JUMP_ALERT&&(E.alertType===o.PAY_AUTH?s.confirm({title:"投保提示",message:"根据央行发布《关于规范支付创新业务的通知》，明确代收服务机构应当要求收款人事先与付款人签订收款协议，取得持卡人授权，并在代收交易处理中验证协议关系，银行与持卡人的直接授权。",confirmButtonText:"去鉴权"}).then((()=>{a.push({path:u.payAuth,query:p.query})})):E.alertType===o.SIGN_FAIL?(i.set(`${I}_underwriteResult`,{[o.SIGN_FAIL]:t}),a.push({path:u.signUnderWriteResult,query:{...p.query,underwriteStatus:o.SIGN_FAIL}})):E.alertType===o.PAY_FAIL?a.push({path:u.updateBankInfo,query:p.query}):[o.LONG_HOLDER_QUESTIONNAIRE,o.LONG_INSURED_QUESTIONNAIRE].includes(E.alertType)?s.confirm({confirmButtonText:"返回修改",message:t}).then((()=>{o.LONG_INSURED_QUESTIONNAIRE===E.alertType?(delete p.query.questionnaireId,a.push({path:u.questionNotice,query:p.query})):a.push({path:`${u.questionNotice}/${p.query.questionnaireId}`,query:p.query})})):E.alertType===o.UNDER_WRITE_FAIL&&(i.set(`${I}_underwriteResult`,{[o.UNDER_WRITE_FAIL]:t}),a.push({path:u.underWriteResult,query:{...p.query,underwriteStatus:o.UNDER_WRITE_FAIL}})))}};export{l as n};
