import{_ as e,d as a,S as t,E as s,c as n,h as l,f as r,w as o,F as i,i as d,g as c,e as u,n as p,t as m,V as v,L as f,k as g,m as h,ap as y,au as I,X as O,Y as b,j as A,bY as _,bZ as x,bp as k,r as L,bt as C,c7 as P,bk as T,I as E,a as V,an as D,c8 as j,b_ as w,u as R,J as N,b3 as S,a9 as H,aE as B,H as F,ah as U,G as q,bR as z,a7 as M,T as G,aj as $,c0 as Q,c9 as J,bT as W,c1 as Y}from"./index-f03140d4.js";import{d as Z}from"./debounce-910624d9.js";import{i as K,b as X,p as ee,g as ae}from"./trial-4c132c87.js";import{b as te}from"./product-48bec35b.js";import{n as se}from"./nextStep-41bfc4a8.js";import{g as ne,C as le,I as re,O as oe,l as ie,S as de}from"./infoCollection-494ff537.js";import{u as ce,P as ue}from"./index-035969a8.js";import{v as pe,g as me,r as ve,t as fe}from"./utils-82788e76.js";import{v as ge}from"./validator-5a13dc82.js";import{B as he}from"./index-ef324314.js";import{s as ye,c as Ie}from"./phoneVerify-07a196ce.js";import Oe from"./index-11a28513.js";import{c as be,t as Ae,_ as _e}from"./index-d8aa9fd3.js";import"./trial-58dc58d8.js";import"./pdfh5-008ca364.js";import"./isObject-cd478a85.js";import"./isObjectLike-f858f31d.js";import"./core-3a08fcc7.js";import"./constant-c3f28a3b.js";import"./_nodeUtil-ef4cea77.js";const xe={class:"refueling-package-com"},ke=(e=>(O("data-v-7e34c868"),e=e(),b(),e))((()=>A("div",{class:"title"},"加油包",-1)));var Le=e(a({__name:"index",props:{packageProductList:{type:Array,default:()=>[]},isShowClose:{type:Boolean,default:!1},count:{type:Number,default:3}},setup(e){const a=e,[O,b]=t(!1),A=s((()=>a.packageProductList.length>a.count&&(!!a.isShowClose||!O.value))),_=()=>{b()},x=s((()=>a.packageProductList.length<=a.count||O.value?a.packageProductList:a.packageProductList.slice(0,a.count)));return(e,a)=>{const t=h,s=y,b=I;return n(),l("div",xe,[ke,r(b,{ref:"formRef"},{default:o((()=>[(n(!0),l(i,null,d(c(x),((e,a)=>(n(),u(s,{key:`${e.value}_${a}`,modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,label:e.packageName,required:"",placeholder:"请选择"},{input:o((()=>[r(t,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:c(ne),disabled:e.disabled},null,8,["modelValue","onUpdate:modelValue","options","disabled"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"])))),128)),c(A)?(n(),l("div",{key:0,class:"show-more",onClick:_},[p(m(c(O)?"收起":"查看更多")+" ",1),r(v,{name:"down",class:f(["icon",{showMore:c(O)}])},null,8,["class"])])):g("",!0)])),_:1},512)])}}}),[["__scopeId","data-v-7e34c868"]]);const Ce={class:"spec"},Pe={key:1,class:"spec"};var Te=e(a({__name:"index",props:{dataSource:{default:()=>({spec:[],settlementProcessVO:{},questionList:[]})}},setup(e,{expose:a}){const t=e,p=_((()=>x((()=>import("./index-f03140d4.js").then((function(e){return e.cG}))),["static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),m=_((()=>x((()=>import("./index-71768f0f.js")),["static/js/index-71768f0f.js","static/css/index-f22f2764.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),f=_((()=>x((()=>import("./index-f03140d4.js").then((function(e){return e.cE}))),["static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),h=_((()=>x((()=>import("./index-ee0f97c7.js")),["static/js/index-ee0f97c7.js","static/css/index-7b3feb06.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),y=_((()=>x((()=>import("./index-0adb166f.js")),["static/js/index-0adb166f.js","static/css/index-bfbfdd15.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js","static/js/index-48824806.js"]))),{dataSource:I}=k(t),O=L(),b=L([{title:"产品亮点",slotName:"tab1"},{title:"理赔说明",slotName:"tab2"},{title:"我要投保",slotName:"tab3"}]),V=s((()=>I.value.spec&&I.value.spec.length>0)),D=s((()=>{var e,a,t,s;const n=I.value.settlementProcessVO.settlementProcessType;return!!(n===le.WORD&&(null==(e=I.value.settlementProcessVO)?void 0:e.settlementProcessList)&&(null==(a=I.value.settlementProcessVO)?void 0:a.settlementProcessList.length)>0||n===le.IMAGE&&(null==(t=I.value.settlementProcessVO)?void 0:t.settlementProcessPicList)&&(null==(s=I.value.settlementProcessVO)?void 0:s.settlementProcessPicList.length)>0)})),j=s((()=>I.value.questionList&&I.value.questionList.length>0)),w=s((()=>{let e=[...b.value];return V.value||(e=e.filter((e=>"tab1"!==e.slotName))),D.value||j.value||(e=e.filter((e=>"tab2"!==e.slotName))),e}));return a({handleClickTab:()=>{var e;return null==(e=O.value)?void 0:e.handleClickTab}}),(e,a)=>{const t=E,s=v;return n(),u(c(p),{ref_key:"scrollRef",ref:O,class:"tabs",list:c(w),sticky:"",scrollspy:""},C({tab3:o((()=>[T(e.$slots,"form",{},void 0,!0)])),_:2},[c(V)?{name:"tab1",fn:o((()=>[A("div",Ce,[(n(!0),l(i,null,d(c(I).spec||[],((e,a)=>(n(),u(P,{key:a},{fallback:o((()=>[r(s,{name:"img",style:{"font-size":"40px",margin:"10px auto",display:"block"}})])),default:o((()=>[(n(),u(t,{key:a,class:"detail-img",width:"100%",src:e},null,8,["src"]))])),_:2},1024)))),128)),r(c(f))])])),key:"0"}:void 0,c(D)||c(j)?{name:"tab2",fn:o((()=>{var e;return[c(D)?(n(),l(i,{key:0},[(null==(e=c(I).settlementProcessVO)?void 0:e.settlementProcessType)===c(le).WORD?(n(),u(c(h),{key:0,title:"理赔说明"},{default:o((()=>{var e;return[r(c(m),{list:null==(e=c(I).settlementProcessVO)?void 0:e.settlementProcessList},null,8,["list"])]})),_:1})):(n(),l("div",Pe,[(n(),u(P,null,{fallback:o((()=>[r(s,{name:"img",style:{"font-size":"40px",margin:"10px auto",display:"block"}})])),default:o((()=>{var e;return[(n(!0),l(i,null,d((null==(e=c(I).settlementProcessVO)?void 0:e.settlementProcessPicList)||[],((e,a)=>(n(),u(t,{key:a,width:"100%",src:e,class:"detail-img"},null,8,["src"])))),128))]})),_:1}))])),r(c(f))],64)):g("",!0),c(j)?(n(),l(i,{key:1},[r(c(h),{title:"常见问题"},{default:o((()=>[r(c(y),{list:c(I).questionList},null,8,["list"])])),_:1}),r(c(f))],64)):g("",!0)]})),key:"1"}:void 0]),1032,["list"])}}}),[["__scopeId","data-v-cbff6950"]]);const Ee={class:"trial-button-wrap"},Ve={class:"footer-area"},De={class:"price"},je={key:0},we=a({__name:"TrialButton",props:{premium:{default:0},tenantProductDetail:{default:()=>({})},planCode:{default:""},loadingText:{default:""}},emits:["onClick"],setup(e,{emit:a}){const t=e,s=L(""),d=L("");return D([()=>t.premium,()=>t.tenantProductDetail,()=>t.planCode],(([e])=>{var a,n;const{tenantProductInsureVO:l}=t.tenantProductDetail||{};let r={};r=(null==(a=null==l?void 0:l.planList)?void 0:a.length)?((null==l?void 0:l.planList)||[]).find((e=>e.planCode===t.planCode)):null==l?void 0:l.planInsureVO;const{paymentFrequencyValue:o,premiumUnit:i,actualPremiumUnit:c}=(null==(n=null==r?void 0:r.productPremiumVOList)?void 0:n[0])||{};e?(d.value=c,s.value=e&&`${e}`):(d.value=i,s.value=o&&`${o}`)}),{deep:!0,immediate:!0}),(t,u)=>(n(),l("div",Ee,[A("div",Ve,[A("div",De,[e.loadingText?(n(),l("span",je,m(e.loadingText),1)):(n(),l(i,{key:1},[A("span",null,m(c(s)),1),A("span",null,m(c(d)),1)],64))]),r(Oe,{shadow:!1,class:"right",onClick:u[0]||(u[0]=e=>a("onClick"))},{default:o((()=>[T(t.$slots,"default",{},(()=>[p("立即投保")]))])),_:3})])]))}});const Re=e=>(O("data-v-2ecf641a"),e=e(),b(),e),Ne={key:0},Se=[Re((()=>A("div",{class:"__skeleton_short_content__"},[A("div",{class:"van-config-provider sk",style:{"--van-primary-color":"#0d6efe","--van-primary-color-light8":"#0d6efe80","--van-primary-color-light1":"#0d6efe10","--van-primary-color-light2":"#0d6efe20","--van-danger-color":"#FF3C10","--van-primary-background-color":"#0d6efe20","--van-button-primary-background-color":"#0d6efe","--van-button-primary-border-color":"#0d6efe","--van-checkbox-checked-bg-color":"#0d6efe10","--van-switch-on-background-color":"#0d6efe","--van-toast-default-padding":"14px","--van-linear-bg":"linear-gradient(to right, #0d6efe, rgba(13,150,254,1))","--van-popup-close-icon-margin":"20px","--van-popup-round-border-radius":"20px","--van-card-title":"#0d6efe","--van-card-cell-color":"#0d6efe80","--van-radio-checked-icon-color":"#0d6efe","--van-pro-check-radius":"40px"}},[A("div",{class:"page-internet-product-detail"},[A("div",{class:"info"},[A("div",{class:"van-image banner",style:{width:"100%",height:"223px"},src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},[A("img",{class:"van-image__img","data-src":"https://zatech-aquarius-v2-private-test.oss-cn-hangzhou.aliyuncs.com/common/20221222/e3719801cf6546449e18e06f3bbe8416/%E5%B0%8A%E4%BA%ABe%E7%94%9F.png?Expires=1676527379&OSSAccessKeyId=LTAI5t9uBW78vZ4sm5i3oQ5C&Signature=tkscLe6oOZYjnRIA%2B7AiMS3bOs0%3D",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",lazy:"loaded",style:{background:"rgb(238, 238, 238)"}})]),A("div")]),A("div",{class:"guarantee-list"},[A("div",{class:"header"},[A("span",null,[A("span",{class:"sk-text",style:{"--fp":"14.86%","--sp":"85.14%","--lh":"18.4999px"}},"保障计划")]),A("span",null,[A("span",{class:"sk-text",style:{"--fp":"14.86%","--sp":"85.14%","--lh":"18.4999px"}},"查看详情")])]),A("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[A("div",{class:"cell-container"},[A("div",{class:"left-part large"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"一般医疗保险金")]),A("div",{class:"divider"}),A("div",{class:"right-part"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"最高300万")])])]),A("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[A("div",{class:"cell-container"},[A("div",{class:"left-part large"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"重大疾病医疗保险金")]),A("div",{class:"divider"}),A("div",{class:"right-part"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"最高600万")])])]),A("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[A("div",{class:"cell-container"},[A("div",{class:"left-part large"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"恶性肿瘤质子重离子医疗")]),A("div",{class:"divider"}),A("div",{class:"right-part"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"最高600万")])])]),A("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[A("div",{class:"cell-container"},[A("div",{class:"left-part large"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"恶性肿瘤院外特定药品费用医疗")]),A("div",{class:"divider"}),A("div",{class:"right-part"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"最高600万")])])]),A("div",{class:"common-cell-wrapper com-cell-wrapper guarantee-item"},[A("div",{class:"cell-container"},[A("div",{class:"left-part large"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"恶性肿瘤特定器械耗材费用医疗责任 （适用于女性被保险人）")]),A("div",{class:"divider"}),A("div",{class:"right-part"},[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"最高100万")])])]),A("div",{class:"show-more"},[A("span",{class:"sk-text",style:{"--fp":"14.29%","--sp":"85.71%","--lh":"16.799999999999997px"}},"查看更多 "),A("svg",{class:"svg-icon icon-arrow-down-dobule icon icon"},[A("use",{"xlink:href":"#icon-arrow-down-dobule"})])]),A("div",{class:"feerate-view sk-border"},[A("span",null,[A("span",{class:"sk-text",style:{"--fp":"15.00%","--sp":"85.00%","--lh":"19.9999px"}},"142.00元/年起")])])]),A("div",{class:"com-divider"}),A("div",{class:"tabs",sticky:"",scrollspy:""},[A("div",null,[A("div",{class:"van-sticky"},[A("div",{class:"van-tabs"},[A("div",{id:"tab-list",class:"tab-list"},[A("a",{class:"tab-title active",title:"产品亮点"},[A("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"产品亮点")]),A("a",{class:"tab-title",title:"理赔说明"},[A("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"理赔说明")]),A("a",{class:"tab-title",title:"我要投保"},[A("span",{class:"sk-text",style:{"--fp":"31.82%","--sp":"68.18%","--lh":"43.9999px"}},"我要投保")])])])])]),A("div",{class:"tab-content"},[A("div",{id:"tab1"},[A("div",{class:"spec"},[A("div",{class:"van-image detail-img",style:{width:"100%"}},[A("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",class:"van-image__img",style:{background:"rgb(238, 238, 238)"}})])])])])])])])],-1)))],He={class:"page-internet-product-detail"},Be={class:"info"},Fe={class:"custom-page-form"},Ue=Re((()=>A("div",{class:"form-title"},"请填写投保信息",-1))),qe=Re((()=>A("div",{id:"xinaoDialog"},null,-1)));var ze=e(a({__name:"short",setup(e){j(),_((()=>x((()=>import("./index-61950c4f.js")),["static/js/index-61950c4f.js","static/css/index-ea588f10.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js","static/js/theme-65292714.js","static/js/index-11a28513.js","static/css/index-19d9cc6b.css","static/js/utils-82788e76.js","static/js/infoCollection-494ff537.js","static/js/trial-58dc58d8.js"])));const a=_((()=>x((()=>import("./index-fe77d1ce.js")),["static/js/index-fe77d1ce.js","static/css/index-c743ae40.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js","static/js/theme-65292714.js"]))),t=_((()=>x((()=>import("./index-e3cf2010.js")),["static/js/index-e3cf2010.js","static/css/index-8fb5d6c6.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js","static/js/infoCollection-494ff537.js","static/js/trial-58dc58d8.js"])));_((()=>x((()=>import("./index-11a28513.js")),["static/js/index-11a28513.js","static/css/index-19d9cc6b.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),_((()=>x((()=>import("./index-2e8a1772.js")),["static/js/index-2e8a1772.js","static/css/index-6733e696.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js","static/js/infoCollection-494ff537.js","static/js/relativeTime-fde2a46e.js","static/js/validator-5a13dc82.js","static/js/useDicData-488e69ee.js"]))),_((()=>x((()=>import("./index-2d1bbbed.js")),["static/js/index-2d1bbbed.js","static/css/index-a14d73ae.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),_((()=>x((()=>import("./index-3b2f5c1f.js")),["static/js/index-3b2f5c1f.js","static/css/index-b1275e60.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"]))),_((()=>x((()=>import("./index-1e38df42.js")),["static/js/index-1e38df42.js","static/css/index-b9ba3011.css","static/js/index-f03140d4.js","static/css/index-f4a47bf4.css","static/js/pdfh5-008ca364.js"])));const m=w();R();const v=V(),{productCode:f="",tenantId:h,agentCode:y="",agencyCode:I,saleChannelId:O,extraInfo:b,insurerCode:k,preview:C}=v.query;let P={};try{console.log("extInfo",decodeURIComponent(b)),P=JSON.parse(decodeURIComponent(b))}catch(Ia){}const{openId:T}=P;L();const E=L(),ne=L(),le=L(!1),Oe=L({}),xe=L({}),ke=L(!1),Ce=L(!1),Pe=L(0),Ee=L(!1),Ve=L({}),De=L({}),je=L(!0),Re=L(!0),ze=L(!0),Me=L(""),Ge=L([]);L({});const $e=L({}),Qe=L({}),Je=L([]),We=L(),Ye=L(),Ze=N({holder:{formData:{},schema:[],trialFactorCodes:[],config:{name:{},verificationCode:{sendSMSCode:async({mobile:e},a)=>{const t=await ye(e),{code:s}=t;"10000"===s&&"function"==typeof a&&a()}},certType:{},certNo:{label:"身份证号"},occupation:{dictCode:be(k)}}},insuredList:[{formData:{},schema:[],trialFactorCodes:[],config:{relationToHolder:{label:""},certNo:{label:"身份证号"}}}]});T&&ce({openId:T},(e=>{De.value=e})),L({imgUrl:"",desc:"",title:"",link:window.location.href});const Ke=(e=>{const{tenantId:a,agentCode:t="",agencyCode:s,saleChannelId:n,extraInfo:l,insurerCode:r}=V().query;let o={};try{o=JSON.parse(decodeURIComponent(l))}catch(Ia){}const i=L({agencyId:s,commencementTime:"",expiryDate:"",extInfo:{buttonCode:"",pageCode:"",iseeBizNo:"",extraInfo:{}},orderCategory:1,saleUserId:t,saleChannelId:n,tenantId:a,venderCode:r,tenantOrderHolder:{extInfo:{occupationCodeList:[]}},tenantOrderInsuredList:[{relationToHolder:"1",extInfo:{occupationCodeList:[]},tenantOrderBeneficiaryList:[{extInfo:{}}],tenantOrderProductList:[{}]}],tenantOrderSubjectList:[{extInfo:{subjectRelatedFirm:"",subjectRelatedUserId:""},subjectName:"",subjectObjectType:"HOLDER",subjectType:"GENERAL",subjectNo:"",tenantId:a}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0,withProductInfo:!0}});return"[object Object]"==={}.toString.call(e)&&Object.assign(i.value,e),i})({extInfo:{buttonCode:"EVENT_SHORT_saveOrder",pageCode:"productInfo",extraInfo:P,templateId:(null==P?void 0:P.templateId)||"1",iseeBizNo:""}}),Xe=L({}),ea=s((()=>!!C)),aa=L([]),ta=async()=>{await K({productCode:f}).then((({data:e,code:a})=>{var t;"10000"===a&&(Ee.value=!0,xe.value=e,$e.value=null==(t=e.productPlanInsureVOList)?void 0:t[0],Je.value=(e.productPlanInsureVOList||[]).filter((e=>e.planCode)).map((e=>({planName:e.planName,planCode:e.planCode}))))})),ze.value=!1,te({productCode:f}).then((({code:e,data:a})=>{var t,s,n,l;if("10000"===e){const{productInsureMaterialVOList:e,productQuestionnaireVOList:r}=a,{basicInfo:{questionnaireType:o},questions:i,questionnaireName:d}=(null==(t=null==r?void 0:r[0])?void 0:t.questionnaireDetailResponseVO)||{basicInfo:{}};2===o&&(aa.value=[{attachmentName:d,attachmentUri:i,attachmentType:"question"}]),aa.value=[{attachmentName:d,attachmentUri:null==(s=null==i?void 0:i[0])?void 0:s.content,attachmentType:me(String(null==(n=null==i?void 0:i[0])?void 0:n.textType),null==(l=null==i?void 0:i[0])?void 0:l.content)}]}}))},sa=s((()=>{if(De.value){const e=[];return Object.keys(De.value).forEach((a=>{e.push(...De.value[a])})),e}return[]})),na=s((()=>sa.value.length>0)),la=L([]),ra=e=>{$e.value=(xe.value.productPlanInsureVOList||[]).find((a=>a.planCode===e))},oa=()=>{E.value.handleClickTab()("tab3")};L([]);const ia=L([]),da=async()=>{try{await se(((e={},a={},t={})=>{var s;const n={...t},l={tenantId:h,riskList:(null==(s=n.tenantOrderInsuredList[0])?void 0:s.tenantOrderProductList[0].riskVOList)||[],riskPremium:a,productId:e.id};return n.extInfo.iseeBizNo=Me.value,n.productCode=e.productCode,n.commencementTime=n.insuranceStartDate,n.expiryDate=n.insuranceEndDate,n.tenantOrderHolder={...n.tenantOrderHolder,certType:n.tenantOrderHolder.certType||U.CERT,certNo:(n.tenantOrderHolder.certNo||"").toLocaleUpperCase(),extInfo:{...n.tenantOrderHolder.extInfo}},n.tenantOrderInsuredList=n.tenantOrderInsuredList.map((e=>({...e,certType:e.certType||U.CERT,certNo:(e.certNo||"").toLocaleUpperCase(),planCode:$e.value.planCode,extInfo:{...e.extInfo}}))),n.tenantOrderInsuredList[0].tenantOrderProductList[0]={productCode:e.productCode,productName:e.productName,planCode:$e.value.planCode,tenantOrderRiskList:fe(l)},n})(xe.value,Ve.value,Ke.value),(async(e,a)=>{a===Y.JUMP_PAGE&&(null==e?void 0:e.orderNo)&&await(async e=>{try{const{code:a,data:t}=await ae({orderNo:e,tenantId:h});"10000"===a&&(t.extInfo={...t.extInfo,buttonCode:"EVENT_SHORT_underWrite"},await se(t))}catch(Ia){}})(null==e?void 0:e.orderNo)}))}catch(Ia){}},ca=L(""),ua=L(0),pa=async(e,a,t,s=!0)=>{var n;const{chargePeriod:l,coveragePeriod:r,paymentFrequency:o,insuranceEndDate:i,insuranceStartDate:d}=Xe.value;ca.value="保费试算中...";const c=ve(t).map((e=>({...e,paymentFrequency:o,chargePeriod:l,coveragePeriod:r}))),u={tenantId:h,productCode:a.productCode,insuranceStartDate:d,insuranceEndDate:i,holder:{personVO:{...e.tenantOrderHolder,socialFlag:null==(n=e.tenantOrderHolder.extInfo)?void 0:n.hasSocialInsurance,certType:e.tenantOrderHolder.certType||U.CERT}},insuredVOList:e.tenantOrderInsuredList.map((e=>({insuredCode:"",relationToHolder:e.relationToHolder,personVO:{...e,socialFlag:e.extInfo.hasSocialInsurance,certType:e.certType||U.CERT},productPlanVOList:[{insurerCode:k,planCode:$e.value.planCode,riskVOList:c}]})))},{code:p,message:m}=await X(u);if("10000"===p){const{code:e,data:a}=await ee(u);if("10000"===e){if(ca.value="",Ke.value.tenantOrderInsuredList[0].tenantOrderProductList=u.insuredVOList[0].productPlanVOList,ua.value=null==a?void 0:a.premium,Ke.value.premium=a.premium,Ke.value.orderAmount=a.premium,Ke.value.orderRealAmount=a.premium,!s){const e={};a.riskPremiumDetailVOList&&a.riskPremiumDetailVOList.length&&a.riskPremiumDetailVOList.forEach((a=>{e[a.riskCode]={premium:a.premium,amount:a.amount}})),Ve.value=e,ia.value.length>0?(je.value=!1,v=0,Pe.value=v,Ce.value=!0):aa.value.length>0?ke.value=!0:await da()}}else ca.value=""}else ca.value="",G(m);var v},ma=()=>{const e=[];return Ge.value.filter((e=>e.value===re.INSURE)).forEach((a=>{e.push(...a.productRiskVoList)})),e},va=async()=>{if(console.log(11111111,Ye.value),ua.value)da();else try{ke.value=!1,Ce.value=!1,We.value&&We.value.validate().then((async()=>{var e;if(na.value)await pa(Ke.value,xe.value,[...la.value,...ma()],!1);else{const a=null==(e=Ke.value.tenantOrderHolder)?void 0:e.verificationCode;if(!pe(a))return void G({message:"请输入正确的验证码"});const{code:t,data:s}=await Ie(Ke.value.tenantOrderHolder.mobile,a);"10000"===t&&await pa(Ke.value,xe.value,[...la.value,...ma()],!1)}})).catch((()=>{const e=document.querySelector(".form-title");e&&e.scrollIntoView()}))}catch(e){}},fa=e=>{"allFalse"===e?(ke.value=!1,da()):$.confirm({className:"xinao-custom-dialog",title:"提示",teleport:"#xinaoDialog",message:"被保人不符合健康要求，很抱歉暂时无法投保该产品",confirmButtonText:"选错了",cancelButtonText:"为其他人投保"}).then((()=>{})).catch((()=>{ke.value=!1}))},ga=()=>{ke.value=!1,Ce.value=!1,je.value=!0};D((()=>Ke.value.tenantOrderInsuredList[0].relationToHolder),(()=>{Ge.value&&Ge.value.forEach((e=>{e.value=re.UN_INSURE})),Re.value=!1,S((()=>{const{certType:e,extInfo:a}=Ke.value.tenantOrderInsuredList[0];a&&!a.hasSocialInsurance&&(Ke.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance=de.HAS),Re.value=!0}))}),{deep:!0,immediate:!0}),D([()=>Ze.holder.formData,()=>Ze.insuredList],(([e,a])=>{Object.assign(Ke.value,(({holder:e,insuredList:a=[]})=>{const t=["birthday","certEndDate","certEndType","certNo","certStartDate","verificationCode","certType","email","gender","mobile","name","id","insuredBeneficiaryType","relationToHolder","relationToMainInsured"],s=e=>{const a={extInfo:{}};return"[object Object]"==={}.toString.call(e)&&Object.keys(e).forEach((s=>{t.includes(s)?a[s]=e[s]:a.extInfo[s]=e[s]})),a};return{tenantOrderHolder:s(e),tenantOrderInsuredList:(a||[]).map((e=>s(e)))}})({holder:e,insuredList:a.map((e=>e.formData))}))}),{deep:!0});const ha=()=>{const{name:e,birthday:a,gender:t,certType:s,extInfo:{hasSocialInsurance:n}}=Ke.value.tenantOrderInsuredList[0];return!!(a&&t&&Ke.value.paymentFrequency&&e&&ge(e)&&n)},ya=()=>{ha()&&(ca.value="保费试算中...")};return D([()=>$e.value,()=>Xe.value.paymentFrequency],(()=>{ya()}),{deep:!0,immediate:!0}),D((()=>[...Ze.holder.trialFactorCodes.map((e=>Ze.holder.formData[e])),...Ze.insuredList.reduce(((e,a,t)=>(e.push(...a.trialFactorCodes.map((e=>Ze.insuredList[t].formData[e]))),e)),[])]),((...e)=>{console.log(999999,e),console.log("%c🔥 试算因子变动了","color:#1989fa;background:#5e4;padding:3px 5px;")}),{deep:!0,immediate:!0}),D([()=>Ke.value.tenantOrderInsuredList[0].birthday,()=>Ke.value.tenantOrderInsuredList[0].name,()=>Ke.value.tenantOrderInsuredList[0].gender,()=>Ke.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance,()=>Ke.value.activePlanCode,()=>Ke.value.paymentFrequency,()=>Ke.value.insurancePeriodValue,()=>Ge.value],Z((()=>{if(ha()){if(ea.value)return;pa(Ke.value,xe.value,[...la.value,...ma()])}else ya()}),500),{deep:!0}),D((()=>Ze.holder.formData),((...e)=>{console.log("%c🔥 投保人信息变动了","color:#1989fa;background:#5e4;padding:3px 5px;"),Ze.insuredList.forEach(((e,a)=>{const{formData:t,schema:s}=e||{};"1"===t.relationToHolder&&Object.assign(e.formData,Ze.holder.formData)}))}),{deep:!0,immediate:!0}),D((()=>$e.value),(()=>{let{productFactor:e}=$e.value;const{oilPackageProductVOList:a,planCode:t,insureProductRiskVOList:s}=$e.value;na.value&&e[1]&&(e=e[1].filter((e=>"verificationCode"!==e.code))),Xe.value.planCode=t,la.value=s,Qe.value=(s||[]).find((e=>e.mainRiskFlag===H.YES)),console.log("mainRiskInfo.value",Qe.value),Ge.value=(a||[]).map((e=>({...e,value:re.UN_INSURE})));const[n,l,r]=Ae(e);Ze.holder={...Ze.holder,...n},Ze.insuredList[0]={...Ze.insuredList[0],...l}}),{deep:!0,immediate:!0}),D((()=>Ze.insuredList.map(((e,a)=>Ze.insuredList[a].formData.relationToHolder))),((e,a)=>{console.log("%c🔥 与投保人关系变动了","color:#1989fa;background:#5e4;padding:3px 5px;"),Ze.insuredList.forEach(((e,a)=>{const{formData:t,schema:s,config:n}=e||{},l="1"===t.relationToHolder,r="3"===t.relationToHolder;n.certNo.label="身份证号"+(r?"(户口簿)":""),e.schema.forEach((e=>{e.relationToHolder=t.relationToHolder,e.hidden=!e.isSelfInsuredNeed&&l})),l?Object.assign(e.formData,{...Ze.insuredList[a].formData,...Ze.holder.formData}):Object.assign(e.formData,{...Object.keys(e.formData).reduce(((e,a)=>(e[a]="",e)),{}),relationToHolder:t.relationToHolder})}))}),{immediate:!0,deep:!0}),S((()=>{Q(ne,(([{isIntersecting:e}],a)=>{le.value=!e}))})),B((()=>{var e;const a=F.get(oe);if(a){const{tenantOrderHolder:t,tenantOrderInsuredList:s}=a;if(t&&(Ke.value.tenantOrderHolder={...t,certType:t.certType||U.CERT}),Array(s)&&s[0]){const a=s[0]||{};if(Ke.value.activePlanCode=a.planCode,a.tenantOrderProductListtenantOrderProductList&&a.tenantOrderProductList[0]&&a.tenantOrderProductList[0].tenantOrderRiskList){const t=null==(e=a.tenantOrderProductList[0].tenantOrderRiskList)?void 0:e.find((e=>"1"===String(e.riskType)));t&&(Ke.value.paymentFrequency=(null==t?void 0:t.paymentFrequency)?String(null==t?void 0:t.paymentFrequency):ie.SINGLE)}}}})),q((()=>{ze.value=!0,ta(),setTimeout((async()=>{Me.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),z((()=>{F.remove(oe)})),(e,s)=>{const v=J,f=W;return n(),l(i,null,[c(ze)?(n(),l("div",Ne,Se)):(n(),u(f,{key:1,"data-skeleton-root":"SHORT","theme-vars":c(m)},{default:o((()=>{var e,a,s,m,f,h;return[A("div",He,[A("div",Be,[r(he,{"data-skeleton-type":"img",url:null==(a=null==(e=c(Oe))?void 0:e.tenantProductInsureVO)?void 0:a.banner[0]},null,8,["url"]),(null==(m=null==(s=c(Oe))?void 0:s.tenantProductInsureVO)?void 0:m.bannerMove)?(n(),u(he,{key:0,url:null==(h=null==(f=c(Oe))?void 0:f.tenantProductInsureVO)?void 0:h.bannerMove[0],onClick:oa},null,8,["url"])):g("",!0),A("div",{ref_key:"observeRef",ref:ne},null,512)]),(n(),u(Te,{key:0,ref:"tenantProductDetailScrollRef","data-source":c(Oe).tenantProductInsureVO},{form:o((()=>[A("div",Fe,[Ue,r(c(_e),{ref_key:"holderFormRef",ref:We,title:"本人信息（投保人）",model:c(Ze).holder.formData,schema:c(Ze).holder.schema,config:c(Ze).holder.config},null,8,["model","schema","config"]),(n(!0),l(i,null,d(c(Ze).insuredList,((e,a)=>(n(),u(c(_e),{ref_for:!0,ref_key:"insuredFormRef",ref:Ye,key:a,title:"为谁投保（被保人）",model:c(Ze).insuredList[a].formData,schema:e.schema,config:e.config},null,8,["model","schema","config"])))),128))]),r(c(t),{"form-info":c(Xe),"risk-info":c(Qe),"tenant-product-detail":c(Oe),"plan-list":c(Je),"premium-info":{premium:c(ua),premiumLoadingText:c(ca)},onUpdateActivePlan:ra},null,8,["form-info","risk-info","tenant-product-detail","plan-list","premium-info"]),c(Ge).length>0?(n(),u(Le,{key:0,"package-product-list":c(Ge)},null,8,["package-product-list"])):g("",!0)])),_:1},8,["data-source"])),r(v),r(v),c(le)?(n(),u(we,{key:1,premium:c(ua),"loading-text":c(ca),"plan-code":c($e).planCode,"tenant-product-detail":{},onClick:va},{default:o((()=>[p("立即投保")])),_:1},8,["premium","loading-text","plan-code"])):g("",!0)]),c(Ee)?(n(),u(ue,{key:0,"product-detail":c(Oe)},null,8,["product-detail"])):g("",!0),qe]})),_:1},8,["theme-vars"])),r(c(a),{show:c(ke),"onUpdate:show":s[0]||(s[0]=e=>M(ke)?ke.value=e:null),"content-list":c(aa),"active-index":0,onOnConfirmHealth:fa,onOnCloseHealthByMask:ga},null,8,["show","content-list"])],64)}}}),[["__scopeId","data-v-2ecf641a"]]);export{ze as default};
