var fe=Object.defineProperty,be=Object.defineProperties;var Ie=Object.getOwnPropertyDescriptors;var ae=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var ue=(e,r,d)=>r in e?fe(e,r,{enumerable:!0,configurable:!0,writable:!0,value:d}):e[r]=d,m=(e,r)=>{for(var d in r||(r={}))De.call(r,d)&&ue(e,d,r[d]);if(ae)for(var d of ae(r))ke.call(r,d)&&ue(e,d,r[d]);return e},y=(e,r)=>be(e,Ie(r));import{g as te,E as C,_ as le,y as oe,j as s,n as z,k as b,A as f,t as k,m as E,p,a4 as ne,a5 as re,z as T,C as j,O as Ce,ak as Re,h as ge,r as L,G as _e,F as Fe,T as Te,L as Ae,J as Be}from"./vendor-96e68f0e.js";import{q as he}from"./index-fbbc79b7.js";import{_ as de,Y as se,h as x,M as O,U as Se,m as Ve,Q as Ne,R as Le,w as Oe,r as xe,T as _,V as D,W as K,l as $,n as we,P as Ge}from"./index-87df9c0d.js";import{c as w}from"./utils-b6782348.js";import{u as We}from"./useDicData-a3ae4551.js";import{P as qe}from"./index-0d86e329.js";import{_ as je}from"./index-2667678f.js";var J=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(J||{});const Q=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];w(Q);var Z=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(Z||{});const ie=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];w(ie);var h=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(h||{});const pe=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];w(pe);var F=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(F||{});const He=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];w(pe);var ce=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(ce||{});const me=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];w(me);const Me=e=>(ne("data-v-c2f6ec68"),e=e(),re(),e),Pe={class:"com-bank-card-info"},Ke=Me(()=>T("span",{class:"field-title"},[j("\u94F6\u884C\u5361\u7167\u7247 "),T("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),$e=te({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:r}){const d=e,H=We("BANK"),i=C({bankCardType:Z.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),A=n=>d.factor&&d.factor[n]&&d.factor[n].isDisplay===se.YES,G=n=>n&&n.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247",S=n=>{Ne({ossKey:[n],imageType:Le.BANK_CARD}).then(t=>{const{data:u,code:v}=t;v==="10000"&&u&&u.bankCardOcrVO&&(i.value.bankCardNo=u.bankCardOcrVO.bankNo)})};le(()=>d.modelValue,n=>{i.value=n},{immediate:!0}),le(i,n=>{r("update:modelValue",n)});const N=oe(()=>H.value.map(n=>({label:n.name,value:n.code})));return(n,t)=>(s(),z("div",Pe,[A("cardType")?(s(),b(x,{key:0,modelValue:i.value.bankCardType,"onUpdate:modelValue":t[0]||(t[0]=u=>i.value.bankCardType=u),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":f(ie),"is-view":""},null,8,["modelValue","data-source"])):k("",!0),A("bankCardNumber")?(s(),b(O,{key:1,modelValue:i.value.bankCardNo,"onUpdate:modelValue":t[1]||(t[1]=u=>i.value.bankCardNo=u),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):k("",!0),A("cardHolder")?(s(),b(O,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):k("",!0),A("bank")?(s(),b(x,{key:3,modelValue:i.value.payBank,"onUpdate:modelValue":t[2]||(t[2]=u=>i.value.payBank=u),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":f(N),required:""},null,8,["modelValue","data-source"])):k("",!0),A("bankCardAttachment")?(s(),b(O,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:G}]},{label:E(()=>[Ke]),input:E(()=>[p(Ve,{modelValue:i.value.images,"onUpdate:modelValue":t[3]||(t[3]=u=>i.value.images=u),"max-count":2,"upload-type":f(Se).BANK_CARD,onOnUploadFinished:S},null,8,["modelValue","upload-type"])]),_:1},8,["rules"])):k("",!0),A("bankPreMobile")?(s(),b(O,{key:5,modelValue:i.value.mobile,"onUpdate:modelValue":t[4]||(t[4]=u=>i.value.mobile=u),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):k("",!0)]))}});var U=de($e,[["__scopeId","data-v-c2f6ec68"]]),Ue="/static/assets/bank.588e555f.pdf";const ze=e=>(ne("data-v-6a6a2c8d"),e=e(),re(),e),Je={class:"page-bank-card"},Qe={class:"reprise-card-list"},Ze=["onClick"],Xe={class:"agree"},Ye=j(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),ea={class:"footer-button footer"},aa={class:"refresh-btn"},ua=ze(()=>T("div",{class:"text"},"\u5237\u65B0",-1)),la=j("\u5206\u4EAB"),ta=j("\u4E0B\u4E00\u6B65"),oa=te({setup(e){const r=Ce(),d=Re(),{orderNo:H="2022072710380711215",agentCode:i="D1234567-1",tenantId:A="9991000007",templateId:G=1}=r.query,S={bankCardType:Z.DEBIT};let N={};const n=C(""),t=C({payMethod:J.REAL_TIME,bankData:y(m({},S),{imagesId:[],images:[]})}),u=C({payMethod:J.REAL_TIME,expiryMethod:ce.AUTOMATIC_PADDING,bankData:y(m({},S),{imagesId:[],images:[]}),payInfoType:F.FIRST_SAME}),v=C({bankData:y(m({},S),{imagesId:[],images:[]})}),V=C(F.FIRST_SAME),R=C({}),M=C(!1),X=C(),Y=C(),ee=C(),ve=c=>{V.value=c},W=(c,l)=>(console.log("factor",R.value),R.value&&R.value[l]&&R.value[l][c]&&R.value[l][c].isDisplay===se.YES),ye=()=>{var c,l,I;if(!M.value){Te.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}Promise.all([(c=X.value)==null?void 0:c.validate(),(l=Y.value)==null?void 0:l.validate(),(I=ee.value)==null?void 0:I.validate()]).then(a=>{const g=[y(m({},a[0]),{id:t.value.id,paymentType:h.FIRST_TERM}),y(m({},a[1]),{id:u.value.id,paymentType:h.RENEW_TERM}),y(m({},a[2]),{id:v.value.id,paymentType:h.REPRISE,payInfoType:V.value})],B=[{category:D.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.INIT_SIGN,type:"png",uri:a[0].images[0],id:t.value.bankData.imagesId[0]},{category:D.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.INIT_SIGN,type:"png",uri:a[0].images[1],id:t.value.bankData.imagesId[1]}];u.value.payInfoType===F.OTHER&&(B.push({category:D.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:a[1].images[0],id:u.value.bankData.imagesId[0]}),B.push({category:D.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.RENEWAL_SIGN,type:"png",uri:a[1].images[1],id:u.value.bankData.imagesId[1]})),V.value===F.OTHER&&(B.push({category:D.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:a[2].images[0],id:v.value.bankData.imagesId[0]}),B.push({category:D.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:_.ANNUAL_SIGN,type:"png",uri:a[2].images[1],id:v.value.bankData.imagesId[1]})),we(y(m({},N),{pageCode:"payInfo",tenantOrderPayInfoList:g,extInfo:y(m({},N.extInfo),{templateId:G,pageCode:"payInfo"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:B})).then(P=>{const{code:o,data:q}=P;o==="10000"&&q.success&&d.push({path:Ge[q.pageAction.data.nextPageCode],query:r.query})})})},Ee=oe(()=>{const c=y(m({},r.query),{isShare:1,sharePageCode:"payInfo"});return`${window.location.origin}/phoneVerify?${he.stringify(c)}`});return ge(()=>{Oe({pageCode:"payInfo",templateId:G}).then(c=>{const{code:l,data:I}=c;if(l==="10000"){const a={};I.productInsureFactorList.forEach(g=>{a[g.moduleType]||(a[g.moduleType]={}),a[g.moduleType][g.code]=g}),R.value=a}}),xe({orderNo:H,saleUserId:i,tenantId:A}).then(c=>{const{code:l,data:I}=c;l==="10000"&&I&&(N=I,n.value=I.tenantOrderHolder.name,I.tenantOrderPayInfoList.forEach(a=>{a.paymentType===h.FIRST_TERM?(t.value=a,t.value.bankData=y(m(m({},S),a),{images:[],imagesId:[]})):a.paymentType===h.RENEW_TERM?(u.value=a,u.value.bankData=y(m({},a),{images:[],imagesId:[]})):a.paymentType===h.REPRISE&&(v.value=a,v.value.bankData=y(m({},a),{images:[],imagesId:[]}),V.value=a.payInfoType)}),I.tenantOrderAttachmentList.forEach(a=>{a.objectType===_.INIT_SIGN?(a.category===D.OBVERSE_BANK_CARD&&(t.value.bankData.images[0]=a.uri,t.value.bankData.imagesId[0]=a.id),a.category===D.REVERSE_BANK_CARD&&(t.value.bankData.images[1]=a.uri,t.value.bankData.imagesId[1]=a.id)):a.objectType===_.RENEWAL_SIGN?(a.category===D.OBVERSE_BANK_CARD&&(u.value.bankData.images[0]=a.uri,u.value.bankData.imagesId[0]=a.id),a.category===D.REVERSE_BANK_CARD&&(u.value.bankData.images[1]=a.uri,u.value.bankData.imagesId[1]=a.id)):a.objectType===_.ANNUAL_SIGN&&(a.category===D.OBVERSE_BANK_CARD&&(v.value.bankData.images[0]=a.uri,v.value.bankData.imagesId[0]=a.id),a.category===D.REVERSE_BANK_CARD&&(v.value.bankData.images[1]=a.uri,v.value.bankData.imagesId[1]=a.id))}))})}),(c,l)=>{const I=L("van-switch"),a=L("van-checkbox"),g=L("ProSvg"),B=L("van-button"),P=L("ProPageWrap");return s(),b(P,null,{default:E(()=>[T("div",Je,[p($,{title:"\u9996\u671F\u652F\u4ED8"},{default:E(()=>[p(K,{ref_key:"form1",ref:X},{default:E(()=>[W("paymentMethod","INIT")?(s(),b(x,{key:0,modelValue:t.value.payMethod,"onUpdate:modelValue":l[0]||(l[0]=o=>t.value.payMethod=o),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":f(Q)},null,8,["modelValue","data-source"])):k("",!0),p(U,{modelValue:t.value.bankData,"onUpdate:modelValue":l[1]||(l[1]=o=>t.value.bankData=o),"holder-name":n.value,factor:R.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),p($,{title:"\u7EED\u671F\u652F\u4ED8"},{default:E(()=>[p(K,{ref_key:"form2",ref:Y},{default:E(()=>[W("sameAsInit","RENEWAL")?(s(),b(O,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:E(()=>[p(I,{modelValue:u.value.payInfoType,"onUpdate:modelValue":l[2]||(l[2]=o=>u.value.payInfoType=o),size:"22","active-value":f(F).FIRST_SAME,"inactive-value":f(F).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):k("",!0),W("paymentMethod","RENEWAL")?(s(),b(x,{key:1,modelValue:u.value.payMethod,"onUpdate:modelValue":l[3]||(l[3]=o=>u.value.payMethod=o),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":f(Q),required:""},null,8,["modelValue","data-source"])):k("",!0),W("overduePayment","RENEWAL")?(s(),b(x,{key:2,modelValue:u.value.expiryMethod,"onUpdate:modelValue":l[4]||(l[4]=o=>u.value.expiryMethod=o),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":f(me),required:"","label-width":"200"},null,8,["modelValue","data-source"])):k("",!0),u.value.payInfoType!==f(F).FIRST_SAME?(s(),b(U,{key:3,modelValue:u.value.bankData,"onUpdate:modelValue":l[5]||(l[5]=o=>u.value.bankData=o),"holder-name":n.value,factor:R.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):k("",!0)]),_:1},512)]),_:1}),p($,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:E(()=>[T("div",Qe,[(s(!0),z(Fe,null,_e(f(He),(o,q)=>(s(),z("div",{key:q,class:Ae(["reprise-card-item",{selected:V.value===o.value}]),onClick:na=>ve(o.value)},Be(o.label),11,Ze))),128))]),p(K,{ref_key:"form3",ref:ee},{default:E(()=>[V.value===f(F).OTHER?(s(),b(U,{key:0,modelValue:v.value.bankData,"onUpdate:modelValue":l[6]||(l[6]=o=>v.value.bankData=o),"holder-name":n.value,factor:R.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):k("",!0)]),_:1},512)]),_:1}),T("div",Xe,[p(a,{modelValue:M.value,"onUpdate:modelValue":l[7]||(l[7]=o=>M.value=o),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),Ye,p(qe,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",url:f(Ue)},null,8,["url"])]),T("div",ea,[T("div",aa,[T("div",null,[p(g,{name:"refresh"})]),ua]),p(je,{title:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",desc:"\u9080\u8BF7\u60A8\u586B\u5199\u94F6\u884C\u5361\u4FE1\u606F",link:f(Ee)},{default:E(()=>[p(B,{plain:"",type:"primary"},{default:E(()=>[la]),_:1})]),_:1},8,["link"]),p(B,{type:"primary",class:"submit-btn",onClick:ye},{default:E(()=>[ta]),_:1})])])]),_:1})}}});var ya=de(oa,[["__scopeId","data-v-6a6a2c8d"]]);export{ya as default};
