var Z=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var q=(f,u,i)=>u in f?Z(f,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):f[u]=i,P=(f,u)=>{for(var i in u||(u={}))ne.call(u,i)&&q(f,i,u[i]);if(V)for(var i of V(u))re.call(u,i)&&q(f,i,u[i]);return f},M=(f,u)=>ee(f,te(u));import{g as oe,aj as ae,Q as se,a5 as de,C as A,L as ue,o as ie,X as Y,r as m,h as I,j as E,k as c,z as s,n as l,s as R,m as x,F as le,E as ce,y as _,I as b,B as N}from"./vendor-413031aa.js";import{G as h,F as H,P as fe}from"./index-e9a6d610.js";import{c as pe,n as me,a as Ie}from"./index-fb51a0c5.js";import{_ as $,R as _e,B as ye,A as Oe,a as Ee}from"./index-f01ae434.js";import"./useDicData-f5d62ab0.js";const ve={key:0,class:"beneficiary-part"},Be={class:"part-title"},Ae={class:"title"},Le=N("\u5220\u9664"),ge=N("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),Te=N("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ce={class:"radio-item-wrapper"},De={class:"name"},Fe={class:"hone"},Re={class:"address"},be={class:"footer-button"},he=N("\u4E0B\u4E00\u6B65"),Ue=oe({setup(f){const u=ae(),i=se(),{templateId:k=1,orderNo:w="2022072710380711215",tenantId:G="9991000007"}=i.query,[j,W]=de(),S=i.path==="/infoPreview"?"infoPreview":"infoCollection",L=A({}),e=A({extInfo:{pageCode:S},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),U=A(null),y=A([]),O=A([]),d=ue({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),z=()=>{const t=P({},e.value);t.tenantOrderAttachmentList=[{category:h.OBVERSE_CERT,objectType:H.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:y.value[0]},{category:h.REVERSE_CERT,objectType:H.HOLDER,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:y.value[1]},{category:h.OBVERSE_CERT,objectType:H.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:O.value[0]},{category:h.REVERSE_CERT,objectType:H.INSURED,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:O.value[1]}],U.value.validate().then(n=>{console.log("validate",n),me(t).then(({code:o,data:r})=>{o==="10000"&&r.pageAction.pageAction==="jumpToPage"&&u.push({path:fe[r.pageAction.data.nextPageCode],query:i.query})})})},J=t=>{console.log("value",t)},Q=()=>{d.beneficiaryId+=1,e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:d.beneficiaryId,extInfo:{}})},X=t=>{e.value.tenantOrderInsuredList[0].beneficiaryReqList=e.value.tenantOrderInsuredList[0].beneficiaryReqList.filter(n=>n.beneficiaryId!==t.beneficiaryId)},K=()=>{Ie({orderNo:w,tenantId:G}).then(({code:t,data:n})=>{if(t==="10000"){const o=n;o.extInfo=M(P({},o.extInfo),{pageCode:S,templateId:k}),o.tenantOrderHolder=o.tenantOrderHolder||{},o.tenantOrderHolder.extInfo=o.tenantOrderHolder.extInfo||{},o.tenantOrderInsuredList[0].extInfo=o.tenantOrderInsuredList[0].extInfo||{},o.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=o.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(r=>{const p=r;return p.extInfo={},p}),o.tenantOrderAttachmentList.forEach(r=>{r.category,r.objectType,r.category===22?r.objectType===2?y[0]=r.uri:r.objectType===3&&(O[0]=r.uri):r.category===23&&(r.objectType===2?y[1]=r.uri:r.objectType===3&&(O[1]=r.uri))}),Object.assign(e.value,o)}}).finally(()=>{d.isLoading=!1})};return ie(()=>{K(),pe({pageCode:"infoCollection",templateId:k}).then(({code:t,data:n})=>{if(t==="10000"){const o={BENEFICIARY:[],INSURER:[],HOLDER:[]};n.productInsureFactorList.forEach(r=>{(o[r.moduleType]=o[r.moduleType]||[]).push(r)}),L.value=o}})}),Y(()=>e.value,t=>{var n,o,r,p,g,v,T,C,D,F;if(t){const a=[{contactAddress:((o=(n=t.tenantOrderHolder)==null?void 0:n.extInfo)==null?void 0:o.familyAddress)||1231123,contactName:t.tenantOrderHolder.name||123131,contactPhoneNo:t.tenantOrderHolder.mobile||123132},{contactAddress:(p=(r=t.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:p.workAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(v=(g=t.tenantOrderInsuredList[0])==null?void 0:g.extInfo)==null?void 0:v.familyAddress,contactName:(T=t.tenantOrderInsuredList[0])==null?void 0:T.name,contactPhoneNo:(C=t.tenantOrderInsuredList[0])==null?void 0:C.mobile},{contactAddress:(F=(D=t.tenantOrderInsuredList[0])==null?void 0:D.extInfo)==null?void 0:F.workAddress,contactName:t.tenantOrderInsuredList[0].name,contactPhoneNo:t.tenantOrderInsuredList[0].mobile}];d.addressList=a.filter(B=>B.contactAddress&&B.contactName&&B.contactPhoneNo)}},{deep:!0,immediate:!0}),Y(()=>e.value.tenantOrderInsuredList[0].relationToHolder,t=>{+t==1&&Object.assign(e.value.tenantOrderInsuredList[0],e.value.tenantOrderHolder,{id:e.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(t,n)=>{const o=m("ProCard"),r=m("ProRadioButton"),p=m("ProField"),g=m("ProSvg"),v=m("VanButton"),T=m("ProCheckButton"),C=m("van-cell"),D=m("ProForm"),F=m("ProPageWrap");return I(),E(F,{class:"page-info-wrapper"},{default:c(()=>[s(d).isLoading?R("",!0):(I(),E(D,{key:0,ref_key:"formRef",ref:U},{default:c(()=>[l(o,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[l($,{images:y.value,"onUpdate:images":n[0]||(n[0]=a=>y.value=a),"form-info":e.value.tenantOrderHolder,"factor-list":L.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),l(o,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[l(p,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":n[2]||(n[2]=a=>e.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(r,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":n[1]||(n[1]=a=>e.value.tenantOrderInsuredList[0].relationToHolder=a),options:s(_e)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+e.value.tenantOrderInsuredList[0].relationToHolder!=1?(I(),E($,{key:0,images:O.value,"onUpdate:images":n[3]||(n[3]=a=>O.value=a),"form-info":e.value.tenantOrderInsuredList[0],"factor-list":L.value.INSURER||[]},null,8,["images","form-info","factor-list"])):R("",!0),l(p,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),l(o,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[l(p,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":n[5]||(n[5]=a=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(r,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":n[4]||(n[4]=a=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:s(ye)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),e.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(I(),x("div",ve,[(I(!0),x(le,null,ce(e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(a,B)=>(I(),x("div",{key:a.beneficiaryId,class:"beneficiary-item"},[_("div",Be,[_("span",Ae,b(`\u53D7\u76CA\u4EBA${B+1}`),1),l(g,{name:"delete",onClick:He=>X(a)},{default:c(()=>[Le]),_:2},1032,["onClick"])]),l(Ee,{"form-info":a,"factor-list":L.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),l(v,{onClick:Q},{default:c(()=>[ge]),_:1})])):R("",!0)]),_:1}),l(o,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>[s(d).currentAddress?(I(),E(C,{key:1,title:"\u5355\u5143\u683C","is-link":""},{title:c(()=>[_("div",Ce,[_("p",null,[_("span",De,b(s(d).addressList[s(d).currentAddress-1].contactName),1),_("span",Fe,b(s(d).addressList[s(d).currentAddress-1].contactPhoneNo),1)]),_("p",Re,b(s(d).addressList[s(d).currentAddress-1].contactAddress),1)])]),_:1})):(I(),E(T,{key:0,activated:"",onClick:n[6]||(n[6]=a=>s(W)(!0))},{default:c(()=>[Te]),_:1}))]),_:1})]),_:1},512)),_("div",be,[l(v,{block:"",type:"primary",onClick:z},{default:c(()=>[he]),_:1})]),s(j)?(I(),E(Oe,{key:1,modelValue:s(d).currentAddress,"onUpdate:modelValue":n[7]||(n[7]=a=>s(d).currentAddress=a),show:s(j),"data-source":s(d).addressList,onSubmit:J},null,8,["modelValue","show","data-source"])):R("",!0)]),_:1})}}});export{Ue as default};
