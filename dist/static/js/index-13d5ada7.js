var Qe=Object.defineProperty,Xe=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var we=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var Ue=(r,o,k)=>o in r?Qe(r,o,{enumerable:!0,configurable:!0,writable:!0,value:k}):r[o]=k,N=(r,o)=>{for(var k in o||(o={}))ze.call(o,k)&&Ue(r,k,o[k]);if(we)for(var k of we(o))Ke.call(o,k)&&Ue(r,k,o[k]);return r},z=(r,o)=>Xe(r,Ze(o));import{g as M,L as S,o as te,a1 as w,r as F,k as V,m as B,n as b,j as D,y as P,z as e,a2 as We,a3 as Je,a4 as le,C as q,x as Y,d as oe,h,s as E,I as K,a5 as et,a6 as tt,F as ie,E as ae,a7 as it,a8 as at,B as j,D as ot,Q as nt,a9 as lt}from"./vendor-0d5b9892.js";import{P as U,a as ut}from"./index-f4c967c3.js";import{b as ue,S as re,_ as ee,P as ne}from"./index-b652dace.js";const rt=[{label:"\u7537",value:"1"},{label:"\u5973",value:"2"}],st=[{label:"\u6709",value:"1"},{label:"\u65E0",value:"2"}],dt=[{value:1,label:"\u7B2C5\u4E2A\u4FDD\u5355\u5468\u5E74\u65E5"},{value:2,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8455\u5468\u5C81"},{value:3,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8460\u5468\u5C81"},{value:4,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8465\u5468\u5C81"},{value:5,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8470\u5468\u5C81"},{value:6,label:"\u8D77\u59CB\u9886\u53D6\u5E74\u9F8475\u5468\u5C81"}],mt=[{value:1,label:"\u5E74\u9886"},{value:2,label:"\u6708\u9886"}],Ye=[{label:"\u8DB8\u4EA4",value:"1"},{label:"\u5E74\u4EA4",value:"2"},{label:"\u534A\u5E74\u4EA4",value:"3"},{label:"\u5B63\u4EA4",value:"4"},{label:"\u6708\u4EA4",value:"5"}],$e=[{label:"\u8DB8\u4EA4",value:"single"},{label:"1\u5E74\u4EA4",value:"year_1"},{label:"5\u5E74\u4EA4",value:"year_5"},{label:"10\u5E74\u4EA4",value:"year_10"},{label:"15\u5E74\u4EA4",value:"year_15"},{label:"20\u5E74\u4EA4",value:"year_20"},{label:"25\u5E74\u4EA4",value:"year_25"},{label:"30\u5E74\u4EA4",value:"year_30"},{label:"35\u5E74\u4EA4",value:"year_35"}],Ne=[{label:"7\u5929",value:"day_7"},{label:"14\u5929",value:"day_14"},{label:"30\u5929",value:"day_30"},{label:"1\u5E74",value:"year_1"},{label:"3\u5E74",value:"year_3"},{label:"5\u5E74",value:"year_5"},{label:"10\u5E74",value:"year_10"},{label:"15\u5E74",value:"year_15"},{label:"20\u5E74",value:"year_20"},{label:"25\u5E74",value:"year_25"},{label:"30\u5E74",value:"year_30"},{label:"35\u5E74",value:"year_35"},{label:"\u7EC8\u8EAB",value:"to_life"}],ct=[{label:"\u540C\u4E3B\u9669\u671F\u95F4\u51CF1",value:"3"},{label:"\u65E0\u9650\u5236",value:"2"}],Me=[{label:"\u8FD4\u4FDD\u989D",value:"1"},{label:"\u8FD4\u4FDD\u8D39",value:"2"}],ft=[{label:"\u6295\u4FDD",value:"0"},{label:"\u4E0D\u6295\u4FDD",value:"-1"}],pt=(r={})=>ue.post("/api/gateway/system/dict/v2/queryDictInfo",r);new re({source:"sessionStorage"});const Se=new re({source:"localStorage"});new re({source:"cookie"});const yt=r=>(We("data-v-1e1e74de"),r=r(),Je(),r),Vt={class:"com-occupational-wrapper"},kt=yt(()=>P("div",{class:"popup-title"},"\u9009\u62E9\u804C\u4E1A",-1)),gt={class:"popup-content"},bt=M({props:{modelValue:{type:Array,required:!0,default:()=>[]},insuredCode:{type:String,required:!0,default:""},show:{type:Boolean,required:!0,default:!1}},emits:["finish","close","update:modelValue"],setup(r,{emit:o}){const k=r,n=S({show:k.show,options:[],currentValue:""}),d=()=>{o("close")},v=({value:g,selectedOptions:l})=>{console.log(g,l);const f=(l||[]).map(y=>y.value).join("/");o("update:modelValue",g),o("finish",f),d()},I=g=>{const l=g,f=y=>{y.forEach(a=>{const i=a;i.children.length?f(i.children):i.children=null})};return f(l),l},A=()=>{var f,y;const g=`${(y=(f=k.insurerCode)==null?void 0:f.toLocaleUpperCase)==null?void 0:y.call(f)}_OCCUPATION`,l=Se.get("occupational")||{};if(l[g]){n.options=l[g];return}pt({dictCodeList:[g]}).then(({code:a,data:i})=>{var t;if(a==="10000"){const s=I(((t=i==null?void 0:i[0])==null?void 0:t.dictItemList)||[]);n.options=s,l[g]=s,Se.set("occupational",l)}})};return te(()=>{A()}),w(()=>k.modelValue,g=>{},{deep:!0,immediate:!0}),(g,l)=>{const f=F("van-cascader"),y=F("VanPopup");return V(),B("div",Vt,[b(y,{show:e(n).show,"onUpdate:show":l[1]||(l[1]=a=>e(n).show=a),"show-footer":"",position:"bottom",closeable:"",onClose:d},{default:D(()=>[kt,P("div",gt,[b(f,{modelValue:e(n).currentValue,"onUpdate:modelValue":l[0]||(l[0]=a=>e(n).currentValue=a),title:"\u8BF7\u9009\u62E9\u804C\u4E1A","show-header":!1,placeholder:"\u8BF7\u9009\u62E9",options:e(n).options,"active-color":"#0d6efe","field-names":{text:"value",value:"code",children:"children"},onFinish:v},null,8,["modelValue","options"])])]),_:1},8,["show"])])}}});var Dt=ee(bt,[["__scopeId","data-v-1e1e74de"]]);const vt={class:"com-personal-info-wrapper"},je=M({props:{formInfo:{type:Object,required:!0,default:()=>{}},insuredCode:{type:String,required:!0,default:""},factorList:{type:Array,required:!0,default:()=>[]},ageRange:{type:Array,required:!0,default:()=>[]}},setup(r,{expose:o}){const k=r,[n,d]=le(),[v,I]=le(),A=q(),g=S({formInfo:k==null?void 0:k.formInfo,occupationalText:""}),l=i=>{g.occupationalText=i},f=()=>{I(!1)},y=()=>new Promise((i,t)=>{A==null||A.value.validate().then(()=>{i("")},()=>{t()})}),a=Y(()=>{const i=(C="")=>{const c=+C.split("_")[1],L=C.split("_")[0];return[c,L]},t=i((k==null?void 0:k.ageRange)[1]),s=i((k==null?void 0:k.ageRange)[0]),u=oe().subtract(t[0],t[1]==="age"?"year":"day").format("YYYY-MM-DD"),m=oe().subtract(s[0],s[1]==="age"?"year":"day").format("YYYY-MM-DD");return{minAge:new Date(u),maxAge:new Date(m)}});return o({validateForm:y}),(i,t)=>{const s=F("VanField"),u=F("VanForm"),m=F("van-datetime-picker"),C=F("van-popup");return V(),B("div",vt,[b(u,{ref_key:"formRef",ref:A,"input-align":"right","error-message-align":"right"},{default:D(()=>[r.factorList.includes("APPLICANT.AGE")||r.factorList.includes("AGE")?(V(),h(s,{key:0,modelValue:e(g).formInfo.birthday,"onUpdate:modelValue":t[0]||(t[0]=c=>e(g).formInfo.birthday=c),rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],name:"birth",label:"\u51FA\u751F\u65E5\u671F","is-link":"",placeholder:"\u8BF7\u9009\u62E9",onClick:t[1]||(t[1]=c=>e(d)(!0))},null,8,["modelValue"])):E("",!0),r.factorList.includes("APPLICANT.GENDER")||r.factorList.includes("GENDER")?(V(),h(s,{key:1,modelValue:e(g).formInfo.gender,"onUpdate:modelValue":t[3]||(t[3]=c=>e(g).formInfo.gender=c),name:"gender",label:"\u6027\u522B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>[b(U,{modelValue:e(g).formInfo.gender,"onUpdate:modelValue":t[2]||(t[2]=c=>e(g).formInfo.gender=c),options:e(rt)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),r.factorList.includes("SOCIAL_INS")?(V(),h(s,{key:2,modelValue:e(g).formInfo.socialSecurity,"onUpdate:modelValue":t[5]||(t[5]=c=>e(g).formInfo.socialSecurity=c),name:"socialSecurity",label:"\u793E\u4FDD",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>[b(U,{modelValue:e(g).formInfo.socialSecurity,"onUpdate:modelValue":t[4]||(t[4]=c=>e(g).formInfo.socialSecurity=c),options:e(st)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),r.factorList.includes("OCCUPATION_CATEGORY")?(V(),h(s,{key:3,modelValue:e(g).formInfo.occupationalClass,"onUpdate:modelValue":t[6]||(t[6]=c=>e(g).formInfo.occupationalClass=c),rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}],name:"occupationalClass",label:"\u804C\u4E1A\u7C7B\u578B","is-link":"",placeholder:"\u8BF7\u9009\u62E9",onClick:t[7]||(t[7]=c=>e(I)(!0))},{input:D(()=>[P("div",null,K(e(g).occupationalText),1)]),_:1},8,["modelValue"])):E("",!0)]),_:1},512),b(C,{show:e(n),"onUpdate:show":t[10]||(t[10]=c=>et(n)?n.value=c:null),position:"bottom"},{default:D(()=>[b(m,{type:"date","min-date":e(a).minAge,"max-date":e(a).maxAge,onConfirm:t[8]||(t[8]=c=>{e(g).formInfo.birthday=e(oe)(c).format("YYYY-MM-DD"),e(d)(!1)}),onCancel:t[9]||(t[9]=c=>e(d)(!1))},null,8,["min-date","max-date"])]),_:1},8,["show"]),e(v)?(V(),h(Dt,{key:0,modelValue:e(g).formInfo.occupationalClass,"onUpdate:modelValue":t[11]||(t[11]=c=>e(g).formInfo.occupationalClass=c),show:e(v),"insured-code":"insuredCode",onFinish:l,onClose:f},null,8,["modelValue","show"])):E("",!0)])}}});const It={class:"com-risk-card-wrapper part-card"},Lt={key:0},Ct={key:9,class:"liab-desc"},_t=M({props:{originData:{type:Object,required:!0,default:()=>{}},formInfo:{type:Object,required:!0,default:()=>{}},mainRiskData:{type:Object,default:()=>{}},mainRiskInfo:{type:Object,required:!1,default:()=>{}},index:{type:[Number,String],default:0,required:!0},removeRisk:{type:Function,default:()=>{}},removeRiskList:{type:Array,default:()=>[]}},setup(r){const o=r,k=tt("premium")||{},n=S({formInfo:o.formInfo}),d=a=>typeof a!="boolean"&&!a||Array.isArray(a)&&!a.length?!0:{}.toString.call(a)==="object Object"?Object.keys(a).length:!1,v=(a,i)=>{let t=i;return Array.isArray(i)||(t=[`${t}`]),(a||[]).filter(s=>t.includes(`${s.value}`)||t.includes(s.value))},I=Y(()=>{var a,i,t,s,u,m;return((a=o.originData)==null?void 0:a.riskType)===1?v(Ne,(t=(i=o==null?void 0:o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:t.insurancePeriodValueList):((s=o.originData)==null?void 0:s.periodType)===2?v([{value:"year_1",label:"1\u5E74"}],["year_1"]):v(Ne,(m=(u=o==null?void 0:o.mainRiskData)==null?void 0:u.riskInsureLimitVO)==null?void 0:m.insurancePeriodValueList)}),A=Y(()=>{var a,i,t,s,u,m,C,c,L;return((a=o.originData)==null?void 0:a.riskType)===1?v($e,(t=(i=o==null?void 0:o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:t.paymentPeriodValueList):((s=o.originData)==null?void 0:s.exemptFlag)===1?v(ct,(m=(u=o==null?void 0:o.originData)==null?void 0:u.riskInsureLimitVO)==null?void 0:m.paymentPeriodRule):((C=o.originData)==null?void 0:C.periodType)===2?v([{value:"year_1",label:"1\u5E74\u4EA4"}],["year_1"]):v($e,(L=(c=o==null?void 0:o.mainRiskData)==null?void 0:c.riskInsureLimitVO)==null?void 0:L.paymentPeriodValueList)}),g=Y(()=>{var a,i,t,s,u;return((a=o.originData)==null?void 0:a.riskType)===1?v(Ye,(t=(i=o==null?void 0:o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:t.paymentFrequencyList):v(Ye,(u=(s=o==null?void 0:o.mainRiskData)==null?void 0:s.riskInsureLimitVO)==null?void 0:u.paymentFrequencyList)}),l=Y(()=>{var t,s;let a=0,i=0;return(((s=(t=o.originData)==null?void 0:t.riskCalcMethodInfoVO)==null?void 0:s.paymentMethodLimitList)||[]).forEach((u,m)=>{m===0&&(a=u.minAmount,i=u.maxAmount),a>u.minAmount&&(a=u.minAmount),i<u.maxAmount&&(i=u.maxAmount)}),n.formInfo.sumInsured=a,{min:a,max:i}}),f=Y(()=>{var t,s;let a=0,i=0;return(((s=(t=o.originData)==null?void 0:t.riskCalcMethodInfoVO)==null?void 0:s.paymentMethodLimitList)||[]).forEach((u,m)=>{m===0&&(a=u.minPremium,i=u.maxPremium),a>u.minPremium&&(a=u.minPremium),i<u.maxPremium&&(i=u.maxPremium)}),n.formInfo.premium=a,{min:a,max:i}}),y=Y(()=>{var t,s,u,m;const a=((s=(t=o.originData)==null?void 0:t.riskCalcMethodInfoVO)==null?void 0:s.minCopy)||1,i=(m=(u=o.originData)==null?void 0:u.riskCalcMethodInfoVO)==null?void 0:m.maxCopy;return n.formInfo.copy=a,{min:a,max:i}});return te(()=>{var i,t;const a={riskType:o.originData.riskType,riskId:o.originData.id,riskCode:o.originData.riskCode,mainRiskCode:(i=o==null?void 0:o.mainRiskData)==null?void 0:i.riskCode,mainRiskId:(t=o==null?void 0:o.mainRiskData)==null?void 0:t.id,riskCategory:o.originData.riskCategory,liabilityVOList:(o.originData.riskLiabilityInfoVOList||[]).map(s=>({liabilityAttributeCode:s.liabilityAttributeType,liabilityCode:s.liabilityCode,liabilityId:s.id,liabilityRateType:s.liabilityRateType}))};Object.assign(n==null?void 0:n.formInfo,a)}),w(()=>{var a;return(a=n.formInfo)==null?void 0:a.paymentFrequency},a=>{var i,t,s,u;[3,4].includes((t=(i=o.originData)==null?void 0:i.riskCalcMethodInfoVO)==null?void 0:t.saleMethod)&&(((u=(s=o.originData)==null?void 0:s.riskCalcMethodInfoVO)==null?void 0:u.paymentMethodLimitList)||[]).forEach(m=>{+m.paymentFrequency==+a&&Object.assign(n.formInfo,{sumInsured:m.perCopyAmount,premium:m.perCopyPremium})})}),w(()=>o.removeRiskList,()=>{console.log("ops.removeRisk",o.removeRiskList)},{deep:!0,immediate:!0}),w(()=>o==null?void 0:o.mainRiskInfo,a=>{var i,t,s,u,m,C;a&&o.originData.riskType===2&&(((t=(i=o.originData)==null?void 0:i.riskInsureLimitVO)==null?void 0:t.insurancePeriodRule)===1&&(n.formInfo.coverageYear=a.coverageYear),((u=(s=o.originData)==null?void 0:s.riskInsureLimitVO)==null?void 0:u.paymentPeriodRule)===1&&(n.formInfo.paymentYear=a.paymentYear),((C=(m=o.originData)==null?void 0:m.riskInsureLimitVO)==null?void 0:C.paymentTypeRule)===1&&(n.formInfo.paymentFrequency=a.paymentFrequency))},{immediate:!0,deep:!0}),(a,i)=>{var c,L,T,O,$,G,H,W,J,x,se,de,me,ce,fe,pe,ye,Ve,ke,ge,be,De,ve,Ie,Le,Ce,_e,he,Ee,Fe,Oe,Re,Ae,Be,Te,Pe,xe,qe;const t=F("ProSvg"),s=F("ProTitle"),u=F("VanStepper"),m=F("VanField"),C=F("ProExpand");return V(),B("div",It,[b(s,{"risk-type":(c=r.originData)==null?void 0:c.riskType,title:(L=r.originData)==null?void 0:L.riskName},{default:D(()=>[r.removeRiskList.includes(r.originData.id)?(V(),B("div",{key:0,class:"delete-risk",onClick:i[0]||(i[0]=p=>r.removeRisk(r.originData.id))},[b(t,{name:"delete",color:"#0d6efe"})])):E("",!0)]),_:1},8,["risk-type","title"]),((O=(T=r.originData)==null?void 0:T.riskCalcMethodInfoVO)==null?void 0:O.saleMethod)===1&&(($=r.originData)==null?void 0:$.exemptFlag)===2?(V(),h(m,{key:0,modelValue:e(n).formInfo.sumInsured,"onUpdate:modelValue":i[2]||(i[2]=p=>e(n).formInfo.sumInsured=p),label:"\u4FDD\u989D",name:"sumInsured",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:D(()=>{var p,_;return[b(u,{modelValue:e(n).formInfo.sumInsured,"onUpdate:modelValue":i[1]||(i[1]=R=>e(n).formInfo.sumInsured=R),min:e(l).min,step:((_=(p=r.originData)==null?void 0:p.riskCalcMethodInfoVO)==null?void 0:_.increaseDecreaseNum)||1,max:e(l).max},null,8,["modelValue","min","step","max"])]}),_:1},8,["modelValue"])):E("",!0),((H=(G=r.originData)==null?void 0:G.riskCalcMethodInfoVO)==null?void 0:H.saleMethod)===2?(V(),h(m,{key:1,modelValue:e(n).formInfo.premium,"onUpdate:modelValue":i[4]||(i[4]=p=>e(n).formInfo.premium=p),label:"\u4FDD\u8D39",name:"premium",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:D(()=>{var p,_;return[b(u,{modelValue:e(n).formInfo.premium,"onUpdate:modelValue":i[3]||(i[3]=R=>e(n).formInfo.premium=R),step:((_=(p=r.originData)==null?void 0:p.riskCalcMethodInfoVO)==null?void 0:_.increaseDecreaseNum)||1,min:e(f).min,max:e(f).max},null,8,["modelValue","step","min","max"])]}),_:1},8,["modelValue"])):E("",!0),((J=(W=r.originData)==null?void 0:W.riskCalcMethodInfoVO)==null?void 0:J.saleMethod)===3||((se=(x=r.originData)==null?void 0:x.riskCalcMethodInfoVO)==null?void 0:se.saleMethod)===4&&(((me=(de=r.originData)==null?void 0:de.riskCalcMethodInfoVO)==null?void 0:me.minCopy)||((fe=(ce=r.originData)==null?void 0:ce.riskCalcMethodInfoVO)==null?void 0:fe.maxCopy))?(V(),h(m,{key:2,modelValue:e(n).formInfo.copy,"onUpdate:modelValue":i[6]||(i[6]=p=>e(n).formInfo.copy=p),label:"\u6295\u4FDD\u4EFD\u6570",name:"copy",rules:[{required:!0,message:"\u8BF7\u586B\u5199"}]},{input:D(()=>[b(u,{modelValue:e(n).formInfo.copy,"onUpdate:modelValue":i[5]||(i[5]=p=>e(n).formInfo.copy=p),step:1,min:e(y).min,max:e(y).max},null,8,["modelValue","min","max"])]),_:1},8,["modelValue"])):E("",!0),(![1,4].includes((ye=(pe=r.originData)==null?void 0:pe.riskCalcMethodInfoVO)==null?void 0:ye.saleMethod)||((Ve=r.originData)==null?void 0:Ve.exemptFlag)===1)&&((ge=e(k))==null?void 0:ge[(ke=r.originData)==null?void 0:ke.riskCode])?(V(),h(m,{key:3,label:"\u4FDD\u989D"},{input:D(()=>{var p,_,R;return[P("div",null,K((R=(_=e(k))==null?void 0:_[(p=r.originData)==null?void 0:p.riskCode])==null?void 0:R.amount),1)]}),_:1})):E("",!0),!d((De=(be=r.originData)==null?void 0:be.riskInsureLimitVO)==null?void 0:De.insurancePeriodValueList)||!d((Ie=(ve=r.originData)==null?void 0:ve.riskInsureLimitVO)==null?void 0:Ie.insurancePeriodRule)?(V(),h(m,{key:4,modelValue:e(n).formInfo.coverageYear,"onUpdate:modelValue":i[8]||(i[8]=p=>e(n).formInfo.coverageYear=p),label:"\u4FDD\u969C\u671F\u95F4",name:"coverageYear",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>[b(U,{modelValue:e(n).formInfo.coverageYear,"onUpdate:modelValue":i[7]||(i[7]=p=>e(n).formInfo.coverageYear=p),options:e(I)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),!d((Ce=(Le=r.originData)==null?void 0:Le.riskInsureLimitVO)==null?void 0:Ce.paymentPeriodValueList)||!d((he=(_e=r.originData)==null?void 0:_e.riskInsureLimitVO)==null?void 0:he.paymentPeriodRule)?(V(),h(m,{key:5,modelValue:e(n).formInfo.paymentYear,"onUpdate:modelValue":i[10]||(i[10]=p=>e(n).formInfo.paymentYear=p),label:"\u4EA4\u8D39\u671F\u95F4",name:"paymentYear",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>[b(U,{modelValue:e(n).formInfo.paymentYear,"onUpdate:modelValue":i[9]||(i[9]=p=>e(n).formInfo.paymentYear=p),options:e(A)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),!d((Fe=(Ee=r.originData)==null?void 0:Ee.riskInsureLimitVO)==null?void 0:Fe.paymentFrequencyList)||!d((Re=(Oe=r.originData)==null?void 0:Oe.riskInsureLimitVO)==null?void 0:Re.paymentTypeRule)?(V(),h(m,{key:6,modelValue:e(n).formInfo.paymentFrequency,"onUpdate:modelValue":i[12]||(i[12]=p=>e(n).formInfo.paymentFrequency=p),label:"\u4EA4\u8D39\u65B9\u5F0F",name:"paymentFrequency",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>[b(U,{modelValue:e(n).formInfo.paymentFrequency,"onUpdate:modelValue":i[11]||(i[11]=p=>e(n).formInfo.paymentFrequency=p),options:e(g)},null,8,["modelValue","options"])]),_:1},8,["modelValue"])):E("",!0),d((Be=(Ae=r.originData)==null?void 0:Ae.riskInsureLimitVO)==null?void 0:Be.annuityDrawTypeList)?E("",!0):(V(),h(m,{key:7,modelValue:e(n).formInfo.annuityDrawDate,"onUpdate:modelValue":i[14]||(i[14]=p=>e(n).formInfo.annuityDrawDate=p),label:"\u9886\u53D6\u65F6\u95F4",name:"annuityDrawDate",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>{var p,_;return[b(U,{modelValue:e(n).formInfo.annuityDrawDate,"onUpdate:modelValue":i[13]||(i[13]=R=>e(n).formInfo.annuityDrawDate=R),options:v(e(dt),(_=(p=r.originData)==null?void 0:p.riskInsureLimitVO)==null?void 0:_.annuityDrawTypeList)},null,8,["modelValue","options"])]}),_:1},8,["modelValue"])),d((Pe=(Te=r.originData)==null?void 0:Te.riskInsureLimitVO)==null?void 0:Pe.annuityDrawFrequencyList)?E("",!0):(V(),h(m,{key:8,modelValue:e(n).formInfo.annuityDrawType,"onUpdate:modelValue":i[16]||(i[16]=p=>e(n).formInfo.annuityDrawType=p),label:"\u9886\u53D6\u65B9\u5F0F",name:"annuityDrawType",rules:[{required:!0,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>{var p,_;return[b(U,{modelValue:e(n).formInfo.annuityDrawType,"onUpdate:modelValue":i[15]||(i[15]=R=>e(n).formInfo.annuityDrawType=R),options:v(e(mt),(_=(p=r.originData)==null?void 0:p.riskInsureLimitVO)==null?void 0:_.annuityDrawFrequencyList)},null,8,["modelValue","options"])]}),_:1},8,["modelValue"])),(V(!0),B(ie,null,ae(((xe=r.originData)==null?void 0:xe.riskLiabilityInfoVOList)||[],(p,_)=>(V(),B("div",{key:_},[p.optionalFlag===1?(V(),h(m,{key:0,modelValue:e(n).formInfo.liabilityVOList[_].liabilityAttributeValue,"onUpdate:modelValue":R=>e(n).formInfo.liabilityVOList[_].liabilityAttributeValue=R,label:p.liabilityName,name:"liabilityAttributeValue",rules:[{required:p.liabilityAttributeValue,message:"\u8BF7\u9009\u62E9"}]},{input:D(()=>{var R,Q,X;return[P("div",null,[d(p.liabilityAttributeValueList)?(V(),B("span",Lt,"50\u4E07")):(V(),h(U,{key:1,modelValue:e(n).formInfo.liabilityVOList[_].liabilityAttributeValue,"onUpdate:modelValue":Z=>e(n).formInfo.liabilityVOList[_].liabilityAttributeValue=Z,options:v(e(Me),(X=(Q=(R=r.originData)==null?void 0:R.riskLiabilityInfoVOList)==null?void 0:Q[_])==null?void 0:X.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]}),_:2},1032,["modelValue","onUpdate:modelValue","label","rules"])):(V(),h(m,{key:1,modelValue:e(n).formInfo.liabilityVOList[_].liabilityAttributeValue,"onUpdate:modelValue":R=>e(n).formInfo.liabilityVOList[_].liabilityAttributeValue=R,label:p.liabilityName,name:"liabilityAttributeValue"},{input:D(()=>{var R,Q,X;return[P("div",null,[d(p.liabilityAttributeValueList)?(V(),h(U,{key:0,modelValue:e(n).formInfo.liabilityVOList[_].liabilityAttributeValue,"onUpdate:modelValue":Z=>e(n).formInfo.liabilityVOList[_].liabilityAttributeValue=Z,options:e(ft)},null,8,["modelValue","onUpdate:modelValue","options"])):(V(),h(U,{key:1,modelValue:e(n).formInfo.liabilityVOList[_].liabilityAttributeValue,"onUpdate:modelValue":Z=>e(n).formInfo.liabilityVOList[_].liabilityAttributeValue=Z,options:v(e(Me),(X=(Q=(R=r.originData)==null?void 0:R.riskLiabilityInfoVOList)==null?void 0:Q[_])==null?void 0:X.liabilityAttributeValueList)},null,8,["modelValue","onUpdate:modelValue","options"]))])]}),_:2},1032,["modelValue","onUpdate:modelValue","label"]))]))),128)),((qe=r.originData)==null?void 0:qe.relationDesc)?(V(),B("div",Ct,[b(C,{title:"\u8D23\u4EFB\u6295\u4FDD\u8BF4\u660E"},{default:D(()=>{var p;return[P("div",null,K((p=r.originData)==null?void 0:p.relationDesc),1)]}),_:1})])):E("",!0)])}}});var Ge=ee(_t,[["__scopeId","data-v-bfb1ed90"]]);const ht=r=>(We("data-v-bcd4f90c"),r=r(),Je(),r),Et={class:"com-risk-list-wrapper"},Ft=ht(()=>P("div",{class:"popup-title"},"\u9009\u62E9\u9644\u52A0\u9669",-1)),Ot={class:"risk-list"},Rt={class:"footer-bar"},At=j("\u786E\u8BA4"),Bt=M({props:{riskList:{type:Array,required:!0,default:()=>[]},show:{type:Boolean,required:!0,default:!1},collocationList:{type:Array,default:()=>[]},disabled:{type:Array,required:!0,default:()=>[]},modelValue:{type:Array,required:!0,default:()=>[]}},emits:["finished","close","update:modelValue"],setup(r,{emit:o}){const k=r,n=q([]),d=q([]),v=q(k.disabled),I=S({show:k.show,currentChecked:[]}),A=(y,a)=>{if(!k.collocationList.length){if(a){I.currentChecked=[];return}I.currentChecked.push(y);return}k.collocationList.forEach(i=>{y===i.riskId&&(a?(i.collocationType===2?I.currentChecked=I.currentChecked.filter(t=>!(t===i.collocationRiskId||t===y)):i.collocationType===3&&(I.currentChecked=I.currentChecked.filter(t=>t!==y),v.value.filter(t=>t!==i.collocationRiskId)),I.currentChecked=I.currentChecked.filter(t=>t!==y)):(i.collocationType===2?I.currentChecked.push(i.collocationRiskId,y):i.collocationType===3&&(I.currentChecked.push(y),v.value.push(i.collocationRiskId)),I.currentChecked.push(y)))})},g=y=>{var i,t,s;const a=I.currentChecked.includes(y);A(y,a),(s=(t=(i=n==null?void 0:n.value)==null?void 0:i[y])==null?void 0:t.toggle)==null||s.call(t)},l=()=>{o("close")},f=()=>{const y=k.riskList.filter(a=>I.currentChecked.includes(a.id));o("update:modelValue",d),o("finished",y),o("close")};return it(()=>{n.value=[]}),w(()=>k.modelValue,y=>{d.value=y,v.value=y},{deep:!0,immediate:!0}),(y,a)=>{const i=F("van-checkbox"),t=F("VanCell"),s=F("van-cell-group"),u=F("van-checkbox-group"),m=F("VanButton"),C=F("VanPopup");return V(),B("div",Et,[b(C,{show:e(I).show,"onUpdate:show":a[1]||(a[1]=c=>e(I).show=c),title:"\u9009\u62E9\u9644\u52A0\u9669","show-footer":"",position:"bottom",closeable:"",onClose:l},{default:D(()=>[Ft,P("div",Ot,[b(u,{modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=c=>d.value=c)},{default:D(()=>[b(s,{inset:""},{default:D(()=>[(V(!0),B(ie,null,ae(r.riskList,c=>(V(),h(t,{key:c.id,title:c.riskName,onClick:L=>g(c.id)},{"right-icon":D(()=>[b(i,{ref_for:!0,ref:L=>n.value[c.id]=L,disabled:v.value.includes(c.id),shape:"square",name:c.id,onClick:at(L=>g(c.id),["stop"])},null,8,["disabled","name","onClick"])]),_:2},1032,["title","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])]),P("div",Rt,[b(m,{type:"primary",disabled:!e(I).currentChecked.length,block:"",onClick:f},{default:D(()=>[At]),_:1},8,["disabled"])])]),_:1},8,["show"])])}}});var Tt=ee(Bt,[["__scopeId","data-v-bcd4f90c"]]);const Pt={class:"risk-list-wrapper"},xt={key:0,class:"add-rider-risk"},qt={class:"left-part"},wt=j("+ \u9644\u52A0\u9669"),Ut=M({props:{riskInfo:{type:Object,required:!0,default:()=>{}},originData:{type:Object,required:!0,default:()=>{}},pickFactor:{type:Function,required:!0,default:()=>{}}},setup(r){var g;const o=r,[k,n]=le(!1);q(null),q(null);const d=S({mainRiskInfo:o.riskInfo,riderRiskInfo:(g=o.riskInfo)==null?void 0:g.riderRiskVOList,requiredRiderRiskData:[],mainRiskData:{},riderRiskList:[],checkedList:[],relationListNum:0,disabledList:[]}),v=(l,f)=>{d.requiredRiderRiskData=d.requiredRiderRiskData.concat(l)},I=l=>{var y;const f=[l];(((y=d.mainRiskData)==null?void 0:y.collocationVOList)||[]).forEach(a=>{l===a.riskId&&a.collocationType===2&&f.push(a.collocationRiskId)}),d.checkedList=d.checkedList.filter(a=>!f.includes(a)),ot.confirm({message:"\u786E\u5B9A\u8981\u5220\u9664\u9644\u52A0\u9669\u4E48\uFF1F"}).then(()=>{d.requiredRiderRiskData=d.requiredRiderRiskData.filter(a=>!f.includes(a.id)),Object.assign(d.riderRiskInfo,{[l]:void 0})}).catch(()=>{})},A=(l,f)=>{const y=l.split("_"),a=f.split("_");return y[0]===a[0]?+y[1]>+a[1]?[f,l]:[l,f]:y[0]==="age"?[l,f]:[f,l]};return te(()=>{d.requiredRiderRiskData}),w(()=>d.mainRiskInfo,l=>{},{deep:!0,immediate:!0}),w(()=>d.riderRiskInfo,()=>{},{deep:!0,immediate:!0}),w(()=>d.requiredRiderRiskData,l=>{const f=[d.mainRiskData,...l];let y=[],a=[],i=[];f.forEach((t,s)=>{var m,C,c,L,T;const u=((m=t==null?void 0:t.riskCalcMethodInfoVO)==null?void 0:m.riskFactorRelationList)||[];if(y=y.concat(u.filter(O=>O.factorObject==="insured").map(O=>O.factorCode)),a=a.concat(u.filter(O=>O.factorObject==="holder").map(O=>O.factorCode)),s===0)i[0]=((C=t==null?void 0:t.riskInsureLimitVO)==null?void 0:C.minHolderAge)||"",i[1]=(c=t==null?void 0:t.riskInsureLimitVO)==null?void 0:c.maxHolderAge;else{const O=A(i[0],(L=t==null?void 0:t.riskInsureLimitVO)==null?void 0:L.minHolderAge)[0],$=A(i[1],(T=t==null?void 0:t.riskInsureLimitVO)==null?void 0:T.maxHolderAge)[1];i=[O,$]}}),(l||[]).forEach(t=>{var u;const s={riskType:t.riskType,riskId:t.id,riskCode:t.riskCode,mainRiskCode:d.mainRiskData.riskCode,mainRiskId:(u=d.mainRiskData)==null?void 0:u.id,riskCategory:t.riskCategory,liabilityVOList:(t.riskLiabilityInfoVOList||[]).map(m=>({liabilityAttributeCode:m.liabilityAttributeType,liabilityCode:m.liabilityCode,liabilityId:m.id,liabilityRateType:m.liabilityRateType}))};Object.assign(d.riderRiskInfo,{[t.id]:s})}),o.pickFactor({insuredFactorList:[...new Set(y)],holderFactorList:[...new Set(a)],ageRange:i})},{deep:!0,immediate:!0}),w(()=>o.originData,l=>{(l||[]).forEach(f=>{f.riskType===1?(d.mainRiskData=f,d.requiredRiderRiskData=(f==null?void 0:f.requiredRiderRiskVOList)||[],d.riderRiskList=f==null?void 0:f.optionalRiderRiskVOList):d.riderRiskList.push(f)})},{deep:!0,immediate:!0}),w(()=>o.riskInfo,()=>{},{immediate:!0,deep:!0}),(l,f)=>{var y,a,i,t,s;return V(),B("div",Pt,[b(Ge,{"form-info":e(d).mainRiskInfo,"origin-data":e(d).mainRiskData},null,8,["form-info","origin-data"]),(V(!0),B(ie,null,ae(e(d).requiredRiderRiskData,(u,m)=>(V(),h(Ge,{key:u.id,"form-info":e(d).riderRiskInfo[u.id],index:m,"main-risk-data":e(d).mainRiskData,"main-risk-info":e(d).mainRiskInfo,"origin-data":u,"remove-risk":I,"remove-risk-list":e(d).checkedList},null,8,["form-info","index","main-risk-data","main-risk-info","origin-data","remove-risk-list"]))),128)),((a=(y=e(d))==null?void 0:y.riderRiskList)==null?void 0:a.length)-((t=(i=e(d))==null?void 0:i.checkedList)==null?void 0:t.length)?(V(),B("div",xt,[P("span",qt,K(`\u5171\u6709${e(d).riderRiskList.length-e(d).checkedList.length}\u6B3E\u9644\u52A0\u9669\u53EF\u4EE5\u6DFB\u52A0`),1),b(ut,{activied:"",onClick:f[0]||(f[0]=u=>e(n)(!0))},{default:D(()=>[wt]),_:1})])):E("",!0),e(k)?(V(),h(Tt,{key:1,modelValue:e(d).checkedList,"onUpdate:modelValue":f[1]||(f[1]=u=>e(d).checkedList=u),show:e(k),disabled:e(d).disabledList,"risk-list":e(d).riderRiskList,"collocation-list":((s=e(d).mainRiskData)==null?void 0:s.collocationVOList)||[],onFinished:v,onClose:f[2]||(f[2]=u=>e(n)(!1))},null,8,["modelValue","show","disabled","risk-list","collocation-list"])):E("",!0)])}}});var He=ee(Ut,[["__scopeId","data-v-df9ce4d6"]]);const Yt=(r={})=>ue.get(`/api/product/insureProductDetail/${r==null?void 0:r.productId}`,r),$t=(r={})=>ue.post("/api/insurance/premiumCalc",r);const Nt={key:0,class:"part-card"},Mt={key:1,class:"part-card"},St={class:"risk-content"},jt={key:0,class:"risk"},Gt={key:1,class:"plan-risk"},Ht={class:"footer-bar"},Wt={class:"trial-result"},Jt={class:"result-num"},Qt=j(" \u5143\u8D77 "),Xt={class:"trial-operate"},Zt={key:0,class:"retrial-tip"},zt=j(" \u6761\u4EF6\u66F4\u6539\u540E\uFF0C\u9700\u8981\u91CD\u65B0\u8BD5\u7B97 "),Kt=j("\u53BB\u8BD5\u7B97"),ei=j("\u7ACB\u5373\u6295\u4FDD"),ti=M({setup(r){const{id:o=115}=nt().query,k=q({personVO:{}}),n=q({insuredCode:"",personVO:{}}),d=q({}),v=q({}),I=q({}),A=q({}),g=q({});lt("premium",g.value);const l=S({currentPlan:"",riskBaseInfo:{},holderFactor:[],insuredFactor:[],riskData:[],riskPlanData:[],trialResult:{},canTrial:!0,retrialTip:!1,ageRange:[],collapseName:["1"]}),f=()=>{l.retrialTip=!1},y=()=>{var C;const s=JSON.parse(JSON.stringify(d.value[l.currentPlan])),u=Object.values(s.riderRiskVOList).map(c=>{const L=c;if(L.paymentYear==="3"){const T=(d.value[l.currentPlan].paymentYear||"").split("_");T[1]&&(T[1]-=1),L.paymentYear=T.join("_")}return L.liabilityVOList=(L.liabilityVOList||[]).filter(T=>!["-1"].includes(T.liabilityAttributeValue)).map(T=>{const O=T;return O.liabilityAttributeValue==="0"&&(O.liabilityAttributeValue=""),O}),L});s.liabilityVOList=s.liabilityVOList.filter(c=>!["-1"].includes(c.liabilityAttributeValue)).map(c=>{const L=c;return L.liabilityAttributeValue==="0"&&(L.liabilityAttributeValue=""),L});const m={holder:{personVO:z(N({},k.value.personVO),{birthday:k.value.personVO.birthday&&`${k.value.personVO.birthday} 00:00:00`})},productCode:(C=l==null?void 0:l.riskBaseInfo)==null?void 0:C.productCode,insuredVOList:[z(N({},n.value),{personVO:z(N({},n.value.personVO),{birthday:n.value.personVO.birthday&&`${n.value.personVO.birthday} 00:00:00`}),productPlanVOList:[{planCode:l.currentPlan||"",riskVOList:[z(N({},s),{riderRiskVOList:u})]}]})]};$t(N({},m)).then(({code:c,data:L})=>{if(c==="10000"){l.trialResult=L,l.canTrial=!1;const T={};(L.riskPremiumDetailVOList||[]).forEach(O=>{T[O.riskCode]=O}),Object.assign(g.value,T)}})},a=()=>{var s,u,m,C,c;Promise.all([(u=(s=v==null?void 0:v.value)==null?void 0:s.validateForm)==null?void 0:u.call(s),(C=(m=I==null?void 0:I.value)==null?void 0:m.validateForm)==null?void 0:C.call(m),(c=A==null?void 0:A.value)==null?void 0:c.validate()]).then(()=>{y()})},i=()=>{Yt({productId:o}).then(({code:s,data:u})=>{s==="10000"&&(l.riskBaseInfo=u==null?void 0:u.productBasicInfoVO,((u==null?void 0:u.productRelationPlanVOList)||(u==null?void 0:u.riskDetailVOList)||[]).forEach((m,C)=>{C===0&&(l.currentPlan=m.planCode||0),Object.assign(d.value,{[m.planCode||C]:{liabilityVOList:[],riderRiskVOList:{}}})}),l.riskData=(u==null?void 0:u.riskDetailVOList)||[],l.riskPlanData=(u==null?void 0:u.productRelationPlanVOList)||[])}).finally(()=>{})},t=s=>{l.holderFactor=s.holderFactorList,l.insuredFactor=s.insuredFactorList,console.log("factorObj.ageRange",s.ageRange),l.ageRange=s.ageRange};return w([()=>d.value,()=>k.value,()=>n.value],s=>{s&&!l.canTrial&&(l.canTrial=!0,l.retrialTip=!0)},{deep:!0}),te(()=>{i()}),(s,u)=>{const m=F("VanForm"),C=F("VanTab"),c=F("VanTabs"),L=F("van-collapse-item"),T=F("van-collapse"),O=F("VanButton"),$=F("ZaPageWrap");return V(),h($,{class:"page-trial-wrapper"},{default:D(()=>{var G,H,W,J;return[e(l).holderFactor.length?(V(),B("div",Nt,[b(ne,{title:"\u6295\u4FDD\u4EBA"}),b(je,{ref_key:"holderRef",ref:v,"insured-code":(G=e(l).riskBaseInfo)==null?void 0:G.insuredCode,"form-info":k.value.personVO,"factor-list":e(l).holderFactor,"age-range":e(l).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):E("",!0),e(l).insuredFactor.length?(V(),B("div",Mt,[b(ne,{title:"\u88AB\u4FDD\u4EBA"}),b(je,{ref_key:"insuredRef",ref:I,"insured-code":(H=e(l).riskBaseInfo)==null?void 0:H.insuredCode,"form-info":n.value.personVO,"factor-list":e(l).insuredFactor,"age-range":e(l).ageRange},null,8,["insured-code","form-info","factor-list","age-range"])])):E("",!0),P("div",St,[b(T,{modelValue:e(l).collapseName,"onUpdate:modelValue":u[1]||(u[1]=x=>e(l).collapseName=x)},{default:D(()=>[b(L,{name:"1"},{title:D(()=>[b(ne,{title:"\u6295\u4FDD\u65B9\u6848"})]),default:D(()=>[e(l).riskData.length?(V(),B("div",jt,[b(m,{ref_key:"riskFormRef",ref:A,"input-align":"right","error-message-align":"right"},{default:D(()=>[b(He,{"risk-info":d.value[0],"origin-data":e(l).riskData,"pick-factor":t},null,8,["risk-info","origin-data"])]),_:1},512)])):E("",!0),e(l).riskPlanData.length?(V(),B("div",Gt,[b(m,{ref_key:"riskFormRef",ref:A,"input-align":"right","error-message-align":"right"},{default:D(()=>[b(c,{active:e(l).currentPlan,"onUpdate:active":u[0]||(u[0]=x=>e(l).currentPlan=x)},{default:D(()=>[(V(!0),B(ie,null,ae(e(l).riskPlanData,x=>(V(),h(C,{key:x.planCode,name:x.planCode,title:x.planName},{default:D(()=>[x.planCode===e(l).currentPlan?(V(),h(He,{key:0,"risk-info":d.value[x.planCode],"origin-data":x.riskDetailVOList,"pick-factor":t},null,8,["risk-info","origin-data"])):E("",!0)]),_:2},1032,["name","title"]))),128))]),_:1},8,["active"])]),_:1},512)])):E("",!0)]),_:1})]),_:1},8,["modelValue"])]),P("div",Ht,[P("span",Wt,[P("span",Jt,K((((J=(W=e(l))==null?void 0:W.trialResult)==null?void 0:J.premium)||0).toLocaleString()),1),Qt]),P("div",Xt,[e(l).retrialTip?(V(),B("div",Zt,[zt,P("span",{class:"close-icon",onClick:f},"X")])):E("",!0),e(l).canTrial?(V(),h(O,{key:1,type:"primary",onClick:a},{default:D(()=>[Kt]),_:1})):(V(),h(O,{key:2,type:"primary",onClick:a},{default:D(()=>[ei]),_:1}))])])]}),_:1})}}});var li=ee(ti,[["__scopeId","data-v-1ba677bd"]]);export{li as default};
