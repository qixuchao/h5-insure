import{_ as e,d as a,i as l,h as t,j as o,O as s,l as r,o as d,m as i,w as c,a as n,e as m,u,b_ as f,b as p,V as b,W as v,cj as y,ck as g,a8 as h,bm as N,cl as j,cm as C,ag as _,aC as T,aD as I}from"./index-7c0189e6.js";import{g as V}from"./trial-ed17fa24.js";import{c as q}from"./format-666c4946.js";import{u as U}from"./useOrder-625e0cd3.js";import{a as k,f as x}from"./verify-f0ddf94f.js";import{P as w}from"./constants-4b08cf92.js";const P=e=>(T("data-v-543f0ab6"),e=e(),I(),e),z={class:"page-phone-verify"},$={class:"title"},E=P((()=>n("div",{class:"title face-title"},"人脸识别",-1))),L={class:"face-verify-img"},O=["src"],S=P((()=>n("div",{class:"face-verify-tip"},[n("div",{class:"title"},"操作时请您配合"),n("ol",null,[n("li",null,"请调亮手机屏幕亮度，确保光线充足"),n("li",null,"请保持正脸对准屏幕，确保人脸完整清晰"),n("li",null,"请确保真实本人操作")])],-1))),W={class:"tips"},A=["src"];var D=e(a({__name:"phoneVerify",setup(e){const a=U(),T=l(),I=t(),{agentCode:P,tenantId:D,nextPageCode:M,biz_id:R,orderNo:B,objectType:F,orderCode:G}=T.query,H=o({mobile:"",verifyCode:""}),J=o(),K=o(),Q=()=>{V({orderNo:G||B,tenantId:D}).then((({code:e,data:l})=>{if("10000"===e){Object.assign(a.value,l);const{holder:e,insuredList:t}=l;if("holder"===F){const{name:a,certNo:l,certType:t,id:o,mobile:s}=e;H.value.mobile=s,K.value={userName:a,certiNo:l,certType:t,objectId:o}}else{const{name:e,certNo:a,certType:l,id:o,mobile:s}=(null==t?void 0:t[0])||{};H.value.mobile=s,K.value={userName:e,certiNo:a,certType:l,objectId:o}}R&&(()=>{const{objectId:e,certType:a}=K.value,l={bizId:R,certType:a,objectId:e,objectType:`${F}`.toLocaleUpperCase(),orderNo:B,tenantId:D};k(l).then((({code:e,data:a})=>{"10000"===e&&"SUCCESS"===a.status&&(delete T.query.biz_id,delete T.query.nextPageCode,I.push({path:w[`${M}`],query:T.query}))}))})()}}))},X=()=>{var e,a;null==(a=null==(e=J.value)?void 0:e.validate)||a.call(e).then((()=>{(()=>{const{userName:e,certiNo:a,certType:l}=K.value,t={tenantId:D,faceAuthMode:"TENCENT",callbackUrl:window.location.href,bizNo:B,userName:e,certiNo:a,certType:l};x(t).then((({code:e,data:a})=>{"10000"===e&&(window.location.href=a.originalUrl)}))})()}))};return s((()=>{Q()})),(e,a)=>{const l=N,t=j,o=C,s=_,T=r("ProPageWrap");return d(),i(T,null,{default:c((()=>[n("div",z,[n("div",$,m(`${u(f)[u(F).toLocaleUpperCase()]}手机号验证 ${u(q)(u(H).mobile||"")}`),1),p(o,{ref_key:"formRef",ref:J,"validate-method":"toast",model:u(H)},{default:c((()=>[b(p(l,{modelValue:u(H).mobile,"onUpdate:modelValue":a[0]||(a[0]=e=>u(H).mobile=e),label:"被保人手机号",name:"mobile",maxlength:"11",required:""},null,8,["modelValue"]),[[v,!1]]),p(t,{modelValue:u(H).verifyCode,"onUpdate:modelValue":a[1]||(a[1]=e=>u(H).verifyCode=e),"related-name":"mobile",label:" ",maxlength:"6","input-align":"left",placeholder:"请输入验证码",name:"verifyCode",rules:[{required:!0,message:"请输入验证码"}],"send-s-m-s-code":u(y),"check-s-m-s-code":u(g)},null,8,["modelValue","send-s-m-s-code","check-s-m-s-code"])])),_:1},8,["model"]),E,n("div",L,[n("img",{src:u("/static/png/face_img-4ac5b4e1.png"),alt:""},null,8,O)]),S,p(s,{type:"primary",class:"submit-btn",onClick:X},{default:c((()=>[h("开始验证")])),_:1}),n("div",W,[n("img",{src:u("/static/png/face_tip-d70e081d.png"),alt:""},null,8,A)])])])),_:1})}}}),[["__scopeId","data-v-543f0ab6"]]);export{D as default};
