import{d as e,t as a,r as s,o,c as t,a as l,b as r,u as d,e as i,n as c,f as n,g as u,_ as p,I as m,h as v,i as f,j as g,k as h,l as C,m as y,p as L,w as I,q as k,F as _,s as b,P,v as w,x,T,y as V,z as N,A as j}from"./index-37300aa0.js";import{P as U}from"./index-848af3ad.js";import{L as z}from"./index-db39641a.js";import{T as M,a as q}from"./index-c39e1095.js";import{q as F}from"./product-08527cd4.js";import{P as O}from"./trial-2e8cac5d.js";import{g as R}from"./third-158a6bfa.js";import{s as S}from"./util-14a5fd2c.js";const B={class:"com-product-item"},D={class:"content-wrap"},W={class:"product-image"},A={class:"company-name"},E={class:"product-info"},G={class:"title"},J={class:"description"},$={class:"price-item"},H={class:"price"};var K=p(e({__name:"productItem",props:{productInfo:{default:()=>({})},errorMsg:{default:""}},setup(e){const p=e,{productInfo:v}=a(p),f=s({checked:!1});return a(f),(e,a)=>{var s;const p=m;return o(),t("div",B,[l("div",D,[l("div",W,[r(p,{src:d(v).image},null,8,["src"]),l("div",A,i(null==(s=d(v).insurerName)?void 0:s.slice(0,6)),1),d(v).label?(o(),t("div",{key:0,class:c({tag:!0,news:"新品"===d(v).label,push:"推荐"===d(v).label})},i(d(v).label),3)):n("",!0)]),l("div",E,[l("p",G,i(d(v).productFullName),1),l("p",J,i(d(v).desc),1),l("p",$,[l("span",H,i(d(v).price),1),l("span",null,i(d(v).amountUnit),1)])]),u(e.$slots,"checkedProduct",{},void 0,!0)])])}}}),[["__scopeId","data-v-2ef5a5b8"]]);const Q={class:"search-wrap"},X={class:"article-tag"},Y=["onClick"],Z={class:"page-proposal-list"},ee=e({name:"productList"});var ae=p(e({...ee,setup(e){const u=v(),p=f(),{customer:m}=p.query,B=s({searchValue:"",tagLists:[],loading:!1,finished:!1,refreshing:!1,productList:[],selectProduct:[],insurerCodeList:[],productCategory:"",productTotal:0,checked:"",productCode:void 0,proposalList:[],showFooter:!0,productName:"",insuredList:[],productCodeList:[],errorMsgMap:{},excludeProductCodeList:[],isCreateProposal:!1,selectedProductList:[],firstLoading:!0}),D=g();let W=null;try{const e=JSON.parse(decodeURIComponent(m)),{idNo:a,idType:s,sex:o,name:t,...l}=e;W={...l,certNo:a,certType:s,customerName:t,customerType:1,gender:o,source:2}}catch(ue){console.log(ue)}const{searchValue:A,tagLists:E,loading:G,finished:J,refreshing:$,productList:H,selectProduct:ee,insurerCodeList:ae,productCategory:se,productTotal:oe,showFooter:te}=a(B),le=g(1),re=()=>{var e;m&&!(null==(e=B.insuredList)?void 0:e.length)||(B.firstLoading&&T.loading("加载中..."),F({keyword:A.value,insurerCodeList:ae.value,productCategory:se.value,productClass:le.value,insuredList:B.insuredList,pageNum:1,pageSize:999},{loading:!0}).then((e=>{const{code:a,data:s,total:o}=e;"10000"===a&&(H.value=s,oe.value=o)})).finally((()=>{T.clear(),B.firstLoading=!1})))},de=g(0),ie=()=>{var e;$.value&&(H.value=[],$.value=!1),re(),G.value=!1,oe.value===(null==(e=H.value)?void 0:e.length)&&(J.value=!0)},ce=h((()=>{var e;return(null==(e=H.value)?void 0:e.length)>0})),ne=()=>{J.value=!0,G.value=!0,ie()};return C((()=>{W&&(()=>{const e=e=>(null==e?void 0:e.length)?e[0]:{};R(W).then((a=>{const{code:s,data:o}=a;if("10000"===s&&o){const{bankCardInfo:a=[],addressInfo:s=[],contactInfo:t=[],certInfo:l=[],...r}=o||{},d=o;d.addressInfo=e(s),d.bankCardInfo=e(a),d.contactInfo=e(t),d.certInfo=e(l),B.insuredList=[d],S(d),re()}}))})(),setTimeout((async()=>{D.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const s=M,p=q,m=N,v=j,f=z,g=U,h=y("ProPageWrap");return o(),L(h,{class:"page-proposal"},{default:I((()=>[l("div",Q,[r(m,{modelValue:d(A),"onUpdate:modelValue":a[1]||(a[1]=e=>k(A)?A.value=e:null),placeholder:"请输入产品名称进行搜索",onCancel:re,onSearch:re},{default:I((()=>[l("div",X,[(o(!0),t(_,null,b(d(P),((e,a)=>(o(),t("div",{key:a,class:c(["tag-item",{checked:d(de)===a}]),onClick:s=>((e,a)=>{de.value=a,se.value=e,re()})(e.value,a)},[l("div",{class:c(["tag-out",{checked:d(de)==a}])},[l("div",{class:c(["tag-item-text",{checked:d(de)==a}])},i(e.label),3)],2)],10,Y)))),128))]),r(p,{modelValue:d(le),"onUpdate:modelValue":a[0]||(a[0]=e=>k(le)?le.value=e:null),disabled:"","active-color":"var(--van-primary-color)","inactive-color":"black",fixed:!1,onChange:re},{default:I((()=>[r(s,{name:1},{default:I((()=>[w("非组合产品")])),_:1}),r(s,{name:4},{default:I((()=>[w("组合产品")])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])]),r(g,{modelValue:d($),"onUpdate:modelValue":a[3]||(a[3]=e=>k($)?$.value=e:null),onRefresh:ne},{default:I((()=>[d(ce)||d(B).firstLoading?n("",!0):(o(),L(v,{key:0,"empty-img":d(x),title:"暂无产品","empty-class":"empty-select"},null,8,["empty-img"])),l("div",Z,[r(f,{loading:d(G),"onUpdate:loading":a[2]||(a[2]=e=>k(G)?G.value=e:null),finished:d(J),"finished-text":d(ce)?"- 已经到底了哦 -":"",onLoad:ie},{default:I((()=>[(o(!0),t(_,null,b(d(H),(e=>(o(),L(K,{key:e.id,"product-info":e,"error-msg":d(B).errorMsgMap[e.productCode],onClick:a=>(async e=>{let a=V.premiumTrial;const{insurerCode:s="",productCode:o="",templateId:t,productClass:l}=e;[O.SINGLE_PRODUCT,O.TWO_PRODUCT].includes(l)&&(a=V.productInfo),u.push({path:a,query:{insurerCode:s,productCode:o,tenantId:9991000011,templateId:t,iseeBizNo:D.value}})})(e)},null,8,["product-info","error-msg","onClick"])))),128))])),_:1},8,["loading","finished","finished-text"])])])),_:1},8,["modelValue"])])),_:1})}}}),[["__scopeId","data-v-1afd8fc6"]]);export{ae as default};
