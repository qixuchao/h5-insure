import{d as e}from"./vendor-8ce3e007.js";import{g as r,R as t,I as i}from"./infoCollection-fc353b8b.js";import{b as n,a as o,R as a,i as d}from"./trial-07effa8f.js";import{K as s,C as l,J as u,a3 as c,a6 as m}from"./index-5502edb8.js";const p=e=>{const{tenantId:r,riskList:t,riskPremium:i,productId:a}=e;return t.map((e=>{var t;return{tenantId:r,amountUnit:1,annuityDrawFrequency:e.annuityDrawDate,annuityDrawType:e.annuityDrawType,paymentFrequency:e.paymentFrequency,paymentPeriod:e.chargePeriod.split("_")[1],paymentPeriodType:n[e.chargePeriod.split("_")[0]],insurancePeriodType:o["to_life"===e.coveragePeriod?"to_life":e.coveragePeriod.split("_")[0]],insurancePeriodValue:Number.isNaN(+e.coveragePeriod.split("_")[1])?0:e.coveragePeriod.split("_")[1],riskCode:e.riskCode,riskType:e.riskType,riskName:e.riskName,extInfo:{riskId:e.riskId,copy:e.copy},initialPremium:null==(t=i[e.riskCode])?void 0:t.premium,liabilityDetails:e.liabilityVOList.map((e=>({liabilityCode:e.liabilityCode,liabilityName:e.liabilityName,refundMethod:e.liabilityAttributeValue}))),productId:a,currentAmount:e.amount,initialAmount:e.amount}}))},y=(e,t,i=[],n=r.YEAR,o=!1)=>{const s=e.filter((e=>{try{if(e.extraInfo){return!JSON.parse(e.extraInfo).packageCode||!!i.includes(e.id)}return!1}catch(r){return!1}})),l=s.find((e=>e.riskType===a.MAIN_RISK));return s.map((e=>{const{riskInsureLimitVO:r,riskCategory:i,id:s,riskType:u,riskName:c,riskCode:m,extraInfo:p,riskLiabilityInfoVOList:y,riskCalcMethodInfoVO:I}=e,{insurancePeriodType:f,insurancePeriodValueList:N,paymentFrequencyList:L,paymentPeriodValueList:k,paymentPeriodType:O,annuityDrawFrequencyList:g,annuityDrawValueList:h,insurancePeriodRule:b,paymentPeriodRule:C}=r,{fixedAmount:D,minCopy:v}=I,T={amount:D,riskCode:m,riskId:s,riskName:c,paymentFrequency:n,extraInfo:p,chargePeriod:null==k?void 0:k[0],annuityDrawDate:null==h?void 0:h[0],riskType:u,annuityDrawFrequency:null==g?void 0:g[0],copy:v,coveragePeriod:null==N?void 0:N[0],insuredCode:null==t?void 0:t.insurerCode,liabilityVOList:o?y.filter((e=>1===e.optionalFlag&&"FXG086"!==e.liabilityCode)):y,riskCategory:i};return u===a.MAIN_RISK?T:(b===d.ONE_YEAR&&(T.coveragePeriod="year_1"),C===d.ONE_YEAR&&(T.chargePeriod="year_1"),{...T,mainRiskId:null==l?void 0:l.id,mainRiskCode:null==l?void 0:l.riskCode})}))},I=e=>{var r,i,n,o,a,d;return{id:(null==(r=e.originOrderIds)?void 0:r.id)||null,orderNo:e.orderNo||null,orderAmount:e.premium,tenantId:e.tenantId,venderCode:null==(i=e.detail)?void 0:i.insurerCode,applicationNo:e.applicationNo,policyNo:e.policyNo,orderDataSource:"1",saleUserId:e.saleUserId,saleChannelId:e.saleChannelId,orderCategory:e.orderCategory,orderStatus:e.orderStatus,orderTopStatus:e.orderTopStatus,tenantOrderHolder:{id:(null==(n=e.originOrderIds)?void 0:n.holderId)||null,tenantId:e.tenantId,name:e.holder.name,certNo:e.holder.certNo,certType:l.CERT,mobile:e.holder.mobile,birthday:s(e.holder.certNo),gender:u(e.holder.certNo),extInfo:{hasSocialInsurance:e.holder.socialFlag}},extInfo:{extraInfo:{renewalDK:e.renewalDK,paymentMethod:e.paymentMethod,paymentFrequency:e.paymentFrequency,successJumpUrl:e.successJumpUrl},iseeBizNo:e.iseeBizNo},tenantOrderInsuredList:[{id:(null==(o=e.originOrderIds)?void 0:o.insuredId)||null,tenantId:e.tenantId,relationToHolder:e.insured.relationToHolder,certNo:e.insured.certNo,certType:l.CERT,name:e.insured.name,mobile:e.insured.relationToHolder===t.SELF?e.holder.mobile:"",birthday:s(e.insured.certNo),gender:u(e.insured.certNo),extInfo:{hasSocialInsurance:e.insured.socialFlag},tenantOrderProductList:[{tenantId:e.tenantId,productCode:null==(a=e.detail)?void 0:a.productCode,productName:null==(d=e.detail)?void 0:d.productName,premium:e.premium,tenantOrderRiskList:e.tenantOrderRiskList}]}],operateOption:{withHolderInfo:!0,withInsuredInfo:!0,withProductInfo:!0}}},f=(r,t)=>{if(!r)return"";const[i,n]=r.split("_"),o=parseInt(n,10);return"day"===i?e(t).add(o,"day").format("YYYY-MM-DD"):e(t).add(o+1,"year").format("YYYY-MM-DD")},N=(r,t=e().format("YYYY-MM-DD"))=>e(r).diff(t,"day"),L=(r,t="year")=>e().diff(s(r),t,!0),k=(r,t,i="year")=>{let n="";return n="year"===i?e(s(r)).add(t,i).add(1,"day").format("YYYY-MM-DD"):e(s(r)).add(t,i).subtract(1,"day").format("YYYY-MM-DD"),n>e().format("YYYY-MM-DD")},O=(e,r,t)=>{const i=f(e,t),n=f(r,t);return N(i)<=1&&N(n)>=1},g=e=>{const{riskCode:r,liabilityCode:t,birth:i,sex:n}=e,o=f("age_18",i);return"7Y7"!==r||"FXG086"!==t||n===c.FEMALE&&N(o)<=1},h=e=>{const{riskCode:r,liabilityCode:t,birth:i,sex:n}=e,o=f("age_18",i);return"7Y7"!==r||"FXG086"!==t||n===c.FEMALE&&N(o)<=1},b=(e,r,t=(e=>!0))=>{const i=s(r),n=u(r),o=[];return e.forEach((e=>{const{riskDetailVOList:r}=e,a=r.map((e=>{const{maxHolderAge:r,minHolderAge:o}=e.riskInsureLimitVO;return O(o,r,i)?(e.riskLiabilityInfoVOList=e.riskLiabilityInfoVOList.filter((r=>t({riskCode:e.riskCode,liabilityCode:r.liabilityCode,birth:i,sex:n}))),e):null}));o.push({riskDetailVOList:a.filter((e=>!!(e&&e.riskLiabilityInfoVOList.length>0)))})})),o},C=(e,r=!1,t=(e=>!0))=>{var i,n,o;let a=[];if(r)a=y(null==(n=null==(i=b(m(e.insureDetail.productRiskVoList),e.insured.certNo,t))?void 0:i[0])?void 0:n.riskDetailVOList,e.productDetail,[],e.paymentFrequency,r);else{a=b(m(e.insureDetail.productRiskVoList),e.insured.certNo,t).map((t=>y(t.riskDetailVOList,e.productDetail,e.packageRiskIdList,e.paymentFrequency,r)))}return{calcData:{holder:{personVO:{birthday:s(e.holder.certNo),certType:l.CERT,certNo:e.holder.certNo,gender:Number(u(e.holder.certNo)),mobile:e.holder.mobile,name:e.holder.name,socialFlag:e.holder.socialFlag}},insuredVOList:[{insuredCode:null==(o=e.productDetail)?void 0:o.insurerCode,relationToHolder:e.insured.relationToHolder,personVO:{birthday:s(e.insured.certNo),certType:l.CERT,certNo:e.insured.certNo,gender:Number(u(e.insured.certNo)),name:e.insured.name,socialFlag:e.insured.socialFlag},productPlanVOList:[{riskVOList:a.flat()}]}],productCode:e.productDetail.productCode,tenantId:e.tenantId},riskVOList:a.flat()}},D=(e,r=(e=>!0))=>{var t,i,n,o,a,d;const{orderDetail:s}=e;return{agencyId:s.agencyId,venderCode:s.venderCode,applicationNo:s.applicationNo,orderDataSource:s.orderDataSource,policyNo:s.policyNo,commencementTime:s.commencementTime,orderNo:s.orderNo,tenantId:e.tenantId,orderAmount:e.premium,extInfo:{extraInfo:{...s.extInfo.extraInfo,successJumpUrl:e.successJumpUrl},iseeBizNo:e.iseeBizNo},tenantOrderHolder:{tenantId:s.tenantOrderHolder.tenantId,name:s.tenantOrderHolder.name,certType:s.tenantOrderHolder.certType,certNo:s.tenantOrderHolder.certNo,mobile:s.tenantOrderHolder.mobile,birthday:s.tenantOrderHolder.birthday,gender:s.tenantOrderHolder.gender},tenantOrderInsuredList:[{premium:e.premium,tenantId:s.tenantOrderInsuredList[0].tenantId,relationToHolder:s.tenantOrderInsuredList[0].relationToHolder,insuredBeneficiaryType:s.tenantOrderInsuredList[0].insuredBeneficiaryType,name:s.tenantOrderInsuredList[0].name,hasSocialInsurance:s.tenantOrderInsuredList[0].hasSocialInsurance,certType:s.tenantOrderInsuredList[0].certType,certNo:s.tenantOrderInsuredList[0].certNo,mobile:s.tenantOrderInsuredList[0].mobile,birthday:s.tenantOrderInsuredList[0].birthday,gender:s.tenantOrderInsuredList[0].gender,tenantOrderProductList:[{tenantId:s.tenantOrderInsuredList[0].tenantOrderProductList[0].tenantId,productCode:e.productDetail.productCode,productName:e.productDetail.productName,tenantOrderRiskList:p({tenantId:e.tenantId,riskList:y(null==(a=null==(o=b(e.insureDetail.productRiskVoList,null==(n=null==(i=null==(t=e.orderDetail)?void 0:t.tenantOrderInsuredList)?void 0:i[0])?void 0:n.certNo,r))?void 0:o[0])?void 0:a.riskDetailVOList,e.productDetail),riskPremium:{},productId:null==(d=e.productDetail)?void 0:d.id})}]}]}},v=e=>{if(e&&e.length){return e.filter((e=>e.value===i.INSURE)).map((e=>e.productRiskVoList.map((e=>e.id)))).flat()}return[]},T=(e,r)=>!e.productRiskVoList.some((e=>{const t=e.riskInsureLimitVO.minHolderAge,i=e.riskInsureLimitVO.maxHolderAge,n=s(r);return!O(t,i,n)})),V=e=>{let r=(Math.round(100*parseFloat(e.toString()))/100).toString();const t=r.toString().split(".");return 1===t.length?(r=`${r.toString()}.00`,r):t.length>1?(t[1].length<2&&(r=`${r.toString()}0`),r):e},Y=e=>{if("string"==typeof e){const r=null==e?void 0:e.substring(1);return null==e?void 0:e.replace(r,"**")}return e},P=e=>null==e?void 0:e.replace(/(\d{3})\d*(\d{4})/,"$1****$2"),F=e=>null==e?void 0:e.replace(/^(.{6})(?:\d+)(.{2})$/,"$1**********$2"),R=e=>/^\d{6}$/.test(e),S=e=>{var r,t;const i=`.custom-class-${e[0].name}`,n=document.querySelector(i);n&&n.parentNode&&(null==(r=n.parentNode)?void 0:r.scrollIntoView)&&(null==(t=n.parentNode)||t.scrollIntoView({behavior:"smooth"}))};export{C as a,L as b,T as c,R as d,V as e,D as f,I as g,g as h,F as i,h as j,y as k,P as m,Y as n,v as o,S as s,p as t,k as v};
