var K=Object.defineProperty,Q=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var j=(f,i,l)=>i in f?K(f,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):f[i]=l,P=(f,i)=>{for(var l in i||(i={}))Z.call(i,l)&&j(f,l,i[l]);if(k)for(var l of k(i))ee.call(i,l)&&j(f,l,i[l]);return f},S=(f,i)=>Q(f,X(i));import{g as te,K as ne,v as re,R as oe,r as v,L as ae,N as se,z as ue,A as m,o as I,E as L,B as c,k as u,t as d,O as x,i as H,G as de,F as ie,j as y,J as h,H as T}from"./vendor-8d9a202a.js";import{P as le}from"./index-e25d276f.js";import{c as ce,n as fe,a as pe}from"./index-06a2eef5.js";import{_ as U,R as me,B as Ie,A as ye,a as _e}from"./index-73e36729.js";import"./useDicData-e76014e0.js";import"./utils-1fad1b5c.js";import"./index-899be8ad.js";const Ae={key:0,class:"beneficiary-part"},Be={class:"part-title"},Oe={class:"title"},ve=T("\u5220\u9664"),Le=T("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),ge=T("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ee={class:"radio-item-wrapper"},be={class:"name"},Ce={class:"hone"},Fe={class:"address"},De={class:"footer-button"},he=T("\u4E0B\u4E00\u6B65"),Ue=te({setup(f){const i=ne(),l=re(),{templateId:N=1,orderNo:V="2022072710380711215",tenantId:q="9991000007"}=l.query,[$,w]=oe(),R=l.path==="/infoPreview"?"infoPreview":"infoCollection",g=v({}),o=v({extInfo:{pageCode:R},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),Y=v(null),_=v([]),A=v([]),s=ae({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),G=()=>{const n=P({},o.value);n.tenantOrderAttachmentList=[{category:22,objectType:2,objectId:o.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:_.value[0]},{category:23,objectType:2,objectId:o.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:_.value[1]},{category:22,objectType:3,objectId:o.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:A.value[0]},{category:23,objectType:3,objectId:o.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:A.value[1]}],fe(n).then(({code:e,data:t})=>{e==="10000"&&t.pageAction.pageAction==="jumpToPage"&&i.push({path:le[t.pageAction.data.nextPageCode],query:l.query})})},M=n=>{console.log("value",n)},W=()=>{s.beneficiaryId+=1,o.value.tenantOrderInsuredList[0].beneficiaryReqList.push({id:s.beneficiaryId,extInfo:{}})},z=n=>{o.value.tenantOrderInsuredList[0].beneficiaryReqList=o.value.tenantOrderInsuredList[0].beneficiaryReqList.filter(e=>e.beneficiaryId!==n.beneficiaryId)},J=()=>{pe({orderNo:V,tenantId:q}).then(({code:n,data:e})=>{if(n==="10000"){const t=e;t.extInfo=S(P({},t.extInfo),{pageCode:R,templateId:N}),t.tenantOrderHolder=t.tenantOrderHolder||{},t.tenantOrderHolder.extInfo=t.tenantOrderHolder.extInfo||{},t.tenantOrderInsuredList[0].extInfo=t.tenantOrderInsuredList[0].extInfo||{},t.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=t.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(r=>{const p=r;return p.extInfo={},p}),t.tenantOrderAttachmentList.forEach(r=>{r.category,r.objectType,r.category===22?r.objectType===2?_[0]=r.uri:r.objectType===3&&(A[0]=r.uri):r.category===23&&(r.objectType===2?_[1]=r.uri:r.objectType===3&&(A[1]=r.uri))}),Object.assign(o.value,t)}}).finally(()=>{s.isLoading=!1})};return se(()=>{J(),ce({pageCode:"infoCollection",templateId:N}).then(({code:n,data:e})=>{if(n==="10000"){const t={BENEFICIARY:[],INSURER:[],HOLDER:[]};e.productInsureFactorList.forEach(r=>{(t[r.moduleType]=t[r.moduleType]||[]).push(r)}),g.value=t}})}),ue(()=>o.value,n=>{var e,t,r,p,E,B,b,C,F,D;if(n){const a=[{contactAddress:((t=(e=n.tenantOrderHolder)==null?void 0:e.extInfo)==null?void 0:t.familyAddress)||1231123,contactName:n.tenantOrderHolder.name||123131,contactPhoneNo:n.tenantOrderHolder.mobile||123132},{contactAddress:(p=(r=n.tenantOrderHolder)==null?void 0:r.extInfo)==null?void 0:p.workAddress,contactName:n.tenantOrderHolder.name,contactPhoneNo:n.tenantOrderHolder.mobile},{contactAddress:(B=(E=n.tenantOrderInsuredList[0])==null?void 0:E.extInfo)==null?void 0:B.familyAddress,contactName:(b=n.tenantOrderInsuredList[0])==null?void 0:b.name,contactPhoneNo:(C=n.tenantOrderInsuredList[0])==null?void 0:C.mobile},{contactAddress:(D=(F=n.tenantOrderInsuredList[0])==null?void 0:F.extInfo)==null?void 0:D.workAddress,contactName:n.tenantOrderInsuredList[0].name,contactPhoneNo:n.tenantOrderInsuredList[0].mobile}];s.addressList=a.filter(O=>O.contactAddress&&O.contactName&&O.contactPhoneNo)}},{deep:!0,immediate:!0}),(n,e)=>{const t=m("ProCard"),r=m("ProRadioButton"),p=m("ProField"),E=m("ProSvg"),B=m("VanButton"),b=m("ProCheckButton"),C=m("van-cell"),F=m("ProForm"),D=m("ProPageWrap");return I(),L(D,{class:"page-info-wrapper"},{default:c(()=>[u(s).isLoading?x("",!0):(I(),L(F,{key:0,ref_key:"formRef",ref:Y},{default:c(()=>[d(t,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[d(U,{images:_.value,"onUpdate:images":e[0]||(e[0]=a=>_.value=a),"form-info":o.value.tenantOrderHolder,"factor-list":g.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),d(t,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[d(p,{modelValue:o.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[d(r,{modelValue:o.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.tenantOrderInsuredList[0].relationToHolder=a),options:u(me)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),o.value.tenantOrderInsuredList[0].relationToHolder!=="0"?(I(),L(U,{key:0,images:A.value,"onUpdate:images":e[3]||(e[3]=a=>A.value=a),"form-info":o.value.tenantOrderInsuredList[0],"factor-list":g.value.INSURER||[]},null,8,["images","form-info","factor-list"])):x("",!0),d(p,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),d(t,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[d(p,{modelValue:o.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[d(r,{modelValue:o.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:u(Ie)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),o.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(I(),H("div",Ae,[(I(!0),H(de,null,ie(o.value.tenantOrderInsuredList[0].beneficiaryReqList,(a,O)=>(I(),H("div",{key:a.beneficiaryId,class:"beneficiary-item"},[y("div",Be,[y("span",Oe,h(`\u53D7\u76CA\u4EBA${O+1}`),1),d(E,{name:"delete",onClick:Te=>z(a)},{default:c(()=>[ve]),_:2},1032,["onClick"])]),d(_e,{"form-info":a,"factor-list":g.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),d(B,{onClick:W},{default:c(()=>[Le]),_:1})])):x("",!0)]),_:1}),d(t,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>[u(s).currentAddress?(I(),L(C,{key:1,title:"\u5355\u5143\u683C","is-link":""},{title:c(()=>[y("div",Ee,[y("p",null,[y("span",be,h(u(s).addressList[u(s).currentAddress-1].contactName),1),y("span",Ce,h(u(s).addressList[u(s).currentAddress-1].contactPhoneNo),1)]),y("p",Fe,h(u(s).addressList[u(s).currentAddress-1].contactAddress),1)])]),_:1})):(I(),L(b,{key:0,activated:"",onClick:e[6]||(e[6]=a=>u(w)(!0))},{default:c(()=>[ge]),_:1}))]),_:1})]),_:1},512)),y("div",De,[d(B,{block:"",type:"primary",onClick:G},{default:c(()=>[he]),_:1})]),d(ye,{modelValue:u(s).currentAddress,"onUpdate:modelValue":e[7]||(e[7]=a=>u(s).currentAddress=a),show:u($),"data-source":u(s).addressList,onSubmit:M},null,8,["modelValue","show","data-source"])]),_:1})}}});export{Ue as default};
