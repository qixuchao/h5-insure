import{_ as e,d as a,aV as t,aW as o,i as l,h as s,j as i,k as r,c9 as n,l as d,m as c,o as m,p as u,w as p,a as f,e as v,u as b,cG as h,b as y,bg as g,bh as w,cA as j,cB as T,q as N,f as x,v as C,aY as I,bi as _,c4 as k,bL as B,cC as V,cD as S,b3 as P,bo as U,bp as q,cN as E,y as z,cO as D}from"./index-e6143c1d.js";import{g as L}from"./trial-781aadbd.js";import{c as A}from"./format-31cde443.js";import{u as O}from"./useOrder-0232d2e5.js";import{f as $}from"./face_img-b678980a.js";import F from"./index-aed8e98e.js";import{p as W}from"./policy-e45b602a.js";import{i as Y}from"./core-8db61146.js";import"./utils-d06fedb3.js";import"./createProposal-8e30ae00.js";import"./trial-21f46215.js";import"./PolicyInfo-fcb5ad2f.js";import"./cloneDeep-595f514e.js";const M=e=>(U("data-v-d25e7416"),e=e(),q(),e),R={class:"page-phone-verify"},G={class:"title"},H=M((()=>f("div",{class:"title face-title"},"人脸识别",-1))),J={class:"face-verify-img"},K=["src"],Q=M((()=>f("div",{class:"face-verify-tip"},[f("div",{class:"title"},"操作时请您配合"),f("ol",null,[f("li",null,"请调亮手机屏幕亮度，确保光线充足"),f("li",null,"请保持正脸对准屏幕，确保人脸完整清晰"),f("li",null,"请确保真实本人操作")])],-1))),X={class:"attachment"},Z={class:"footer-button"};var ee=e(a({__name:"phoneVerify",setup(e){const a=t((()=>o((()=>import("./index-d10b76c3.js")),["static/js/index-d10b76c3.js","static/css/index-fa4edf2a.css","static/js/index-e6143c1d.js","static/css/index-3b6067d0.css","static/js/theme-94cf7d00.js","static/js/index-128c8b0b.js","static/css/index-bbfdd7ec.css","static/js/utils-539f5f32.js","static/js/infoCollection-df935142.js","static/js/trial-21f46215.js"]))),U=O(),q=l(),M=s(),{agentCode:ee,tenantId:ae,nextPageCode:te,biz_id:oe,orderNo:le,objectType:se,orderCode:ie}=q.query,re=i({mobile:"",verifyCode:""}),ne=i(),de=i(),ce=i(),me=i([{attachmentName:"隐私政策",attachmentList:[{materialName:"隐私政策",materialContent:W,materialSource:"pdf"}]}]),ue=i(!1),pe=r((()=>Array.isArray(se)?`${null==se?void 0:se[0]}`.toLocaleUpperCase():`${se}`.toLocaleUpperCase())),fe={updateBankInfo:"支付信息修改",orderDetail:"撤销投保",holderSign:"投保人签名",insuredSign:"被保险人签名"};console.log("pageTitle",te,fe[te]),n(fe[te]);const ve=()=>{L({orderNo:ie||le,tenantId:ae}).then((({code:e,data:a})=>{if("10000"===e){Object.assign(U.value,a);const{holder:e,insuredList:t}=a;if("holder"===se){const{name:a,certNo:t,certType:o,id:l,mobile:s,shareFlag:i}=e;re.value.mobile=s,de.value={userName:a,certiNo:t,certType:o,objectId:l},i!==I.YES||oe||["updateBankInfo","orderDetail"].includes(te)||_.confirm({message:"本次签名已完成，您是否需要重新签名?",confirmButtonText:"是",cancelButtonText:"否"}).catch((()=>{Y?k.closeWindow():window.close()}))}else{const{name:e,certNo:a,certType:o,id:l,mobile:s,shareFlag:i}=(null==t?void 0:t[0])||{};re.value.mobile=s,de.value={userName:e,certiNo:a,certType:o,objectId:l},i!==I.YES||oe||["updateBankInfo","orderDetail"].includes(te)||_.confirm({message:"本次签名已完成，您是否需要重新签名?",confirmButtonText:"是",cancelButtonText:"否"}).catch((()=>{Y?k.closeWindow():window.close()}))}oe&&(()=>{const{objectId:e,certType:a}=de.value,t={bizId:oe,certType:a,objectId:e,objectType:pe.value,orderNo:le,tenantId:ae};E(t).then((({code:e,data:a})=>{"10000"===e&&"SUCCESS"===a.status&&(delete q.query.biz_id,delete q.query.nextPageCode,M.push({path:z[`${te}`],query:{...q.query,isShare:1}}))}))})()}}))},be=()=>{var e,a;null==(a=null==(e=ne.value)?void 0:e.validate)||a.call(e).then((()=>{ce.value?(()=>{const{userName:e,certiNo:a,certType:t}=de.value,o={tenantId:ae,faceAuthMode:"TENCENT",callbackUrl:window.location.href,bizNo:le,userName:e,certiNo:a,certType:t};D(o).then((({code:e,data:a})=>{"10000"===e&&(window.location.href=a.originalUrl)}))})():_.alert({message:"请先同意隐私政策",confirmButtonText:"我知道了"})}))};d((()=>{ve()}));const he=i();return d((()=>{setTimeout((async()=>{he.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,t)=>{const o=B,l=V,s=S,i=P,r=c("ProPageWrap");return m(),u(r,null,{default:p((()=>{var e;return[f("div",R,[f("div",G,v(`${b(h)[b(pe)]}手机号验证 ${b(A)(b(re).mobile||"")}`),1),y(s,{ref_key:"formRef",ref:ne,"validate-method":"toast",model:b(re)},{default:p((()=>[g(y(o,{modelValue:b(re).mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>b(re).mobile=e),label:"被保险人手机号",name:"mobile",maxlength:"11",required:""},null,8,["modelValue"]),[[w,!1]]),y(l,{modelValue:b(re).verifyCode,"onUpdate:modelValue":t[1]||(t[1]=e=>b(re).verifyCode=e),"related-name":"mobile",label:" ",maxlength:"6","input-align":"left",placeholder:"请输入验证码",name:"verifyCode",rules:[{required:!0,message:"请输入验证码"}],"send-s-m-s-code":b(j),"check-s-m-s-code":b(T)},null,8,["modelValue","send-s-m-s-code","check-s-m-s-code"])])),_:1},8,["model"]),H,f("div",J,[f("img",{src:b($),alt:""},null,8,K)]),Q,f("div",X,[(null==(e=b(me))?void 0:e.length)?(m(),u(F,{key:0,modelValue:b(ce),"onUpdate:modelValue":t[2]||(t[2]=e=>N(ce)?ce.value=e:null),"attachment-list":b(me),"has-bg-color":!1,"is-show-radio":"","pre-text":"本人同意利安人寿采集本人人脸信息，用于向国家法规许可的验证机构进行本人身份验证。本人已仔细阅读并知晓","suffix-text":"，并同意授权。",onPreviewFile:t[3]||(t[3]=()=>ue.value=!0)},null,8,["modelValue","attachment-list"])):x("",!0)]),f("div",Z,[y(i,{type:"primary",class:"submit-btn",onClick:be},{default:p((()=>[C("同意拍摄")])),_:1})]),b(ue)?(m(),u(b(a),{key:0,show:b(ue),"onUpdate:show":t[4]||(t[4]=e=>N(ue)?ue.value=e:null),"content-list":b(me),"is-only-view":"","active-index":0,text:"我已阅读","force-read-cound":0,onSubmit:t[5]||(t[5]=()=>ue.value=!1),onOnCloseFilePreviewByMask:t[6]||(t[6]=()=>ue.value=!1)},null,8,["show","content-list"])):x("",!0)])]})),_:1})}}}),[["__scopeId","data-v-d25e7416"]]);export{ee as default};
