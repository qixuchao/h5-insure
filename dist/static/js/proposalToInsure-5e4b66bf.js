import{d as e,ay as a,az as s,i as t,h as o,j as r,l as i,o as d,c as n,b as l,w as u,u as c,y as p,aA as f}from"./index-c77f497b.js";import{q as m,s as I}from"./trial-8366872d.js";import{u as b}from"./useOrder-abef6b73.js";import{q as v}from"./createProposal-dc06ef6b.js";import"./utils-e1c9ceb5.js";import"./trial-b466dbb7.js";import"./PolicyInfo-00dddf8e.js";const j=e({name:"proposalToInsure"}),y=e({...j,setup(e){const j=a((()=>s((()=>import("./index-cbfd9fb2.js")),["static/js/index-cbfd9fb2.js","static/css/index-3515e551.css","static/js/index-c77f497b.js","static/css/index-c63d0a44.css","static/js/product-bc426308.js","static/js/useThread-637a02aa.js"]))),y=t(),w=o(),L=b(),h=r(),{proposalId:q,productCode:_,tenantId:g,proposalInsuredId:x}=y.query,C=r(),z=async()=>{q&&v({id:q,tenantId:g}).then((({code:e,data:a})=>{if("10000"===e){const{holder:e,insuredList:s}=a,t=(_||"").split(",");Object.assign(L.value,{renewFlag:"",holder:e,tenantId:g,proposalId:q,insuredList:(s||[]).filter((e=>e.id===+x)).map((e=>({...e,relationToHolder:null,productList:e.productList.filter((e=>t.includes(e.productCode)))})))}),(async()=>{L.value.extInfo&&(L.value.extInfo.iseeBizNo=C.value);const{code:e,data:a}=await I(L.value);"10000"===e&&(h.value=a)})()}}))},O=()=>{h.value&&w.push({path:p.questionNotice,query:{...y.query,orderNo:h.value}})};return i((()=>{q||(async()=>{var e;const{code:a,data:s}=await m({calcProductFactorList:[{productCode:_}]});"10000"===a&&Object.assign(L.value,s,{insuredList:[{...null==(e=s.insuredList)?void 0:e[0]}]})})(),z(),setTimeout((async()=>{C.value=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const s=f;return d(),n("div",null,[l(s,null,{default:u((()=>[l(c(j),{"product-detail":{insurerCode:"lianlife"},onClose:O})])),_:1})])}}});export{y as default};
