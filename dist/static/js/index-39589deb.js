import{_ as e,d as a,c as t,h as o,j as l,t as n,g as s,k as d,K as r,L as i,u as c,a as u,r as v,y as p,b as m,e as f,w as I,f as h,X as w,T as y,aM as g}from"./index-4c2d8b53.js";import{i as C}from"./infoCollection-3279d2ee.js";import{c as b,_ as N}from"./close-02418833.js";import{a as _}from"./order-2c02b5f1.js";import{d as O,i as U,g as x,s as $,e as k,E as S}from"./trial-8c471e2f.js";import{t as L}from"./theme-ea709837.js";import{n as j,i as D,m as P,e as R,g as V,t as B,k as z,l as F,f as H,h as J}from"./utils-440295d8.js";import{p as K}from"./product-b2dcacaf.js";import"./pdfh5-008ca364.js";import"./trial-215b0045.js";const M={class:"com-field-info"},T={class:"title"},q={class:"desc"};var E=e(a({__name:"index",props:{title:{type:String,default:""},desc:{type:String,default:""}},setup:e=>(a,s)=>(t(),o("div",M,[l("div",T,n(e.title),1),l("div",q,n(e.desc),1)]))}),[["__scopeId","data-v-2ff3e068"]]);const G=e=>(r("data-v-ed9081ee"),e=e(),i(),e),W={key:0,class:"pro-modal"},X=G((()=>l("div",{class:"pro-overlay"},null,-1))),Y={class:"pro-modal-wrapper"},A=G((()=>l("div",{class:"pro-modal-content"},[l("p",null,"恭喜您"),l("p",null,"保障升级成功")],-1))),Q=["src"];var Z=e(a({__name:"index",props:{bg:{type:String,default:""},btn:{type:String,default:""},isShow:{type:Boolean,default:()=>{}}},emits:["on-confirm","on-close"],setup(e,{emit:a}){const n=e,r=()=>{a("on-close")},i=()=>{a("on-confirm")};return(e,a)=>n.isShow?(t(),o("div",W,[X,l("div",Y,[l("div",{class:"pro-modal-body"},[A,l("div",{class:"pro-modal-btn",onClick:i},"我知道了")]),l("div",{class:"pro-modal-close",onClick:r},[l("img",{src:s(b)},null,8,Q)])])])):d("",!0)}}),[["__scopeId","data-v-ed9081ee"]]);const ee={class:"page-activity-upgrade"},ae=["src"],te={class:"container"},oe={class:"main-form"};var le=e(a({__name:"index",setup(e){const a=c(),o=u(),{productCode:n="BWYL2022",tenantId:d,orderNo:r,agentCode:i="",from:b}=o.query,M=v(),T=v(),q=v(),G=v(),W=v(),X=v(),Y=v(!1),A="check"===b,Q=v(!1),le=v(0),ne=v("");let se="";const de=()=>{Y.value=!1},re=e=>`${g}/pay?orderNo=${e}&saleUserId=${i}&tenantId=${d}`,ie=()=>{a.replace(`/pay?orderNo=${ne.value}&saleUserId=${i}&tenantId=${d}`)},ce=async e=>{try{y.loading({forbidClick:!0,message:"升级中",duration:15e3});const e=await(async()=>{var e,a,t,o,l;const n=V({tenantId:d,applicationNo:q.value.applicationNo,policyNo:q.value.policyNo,saleUserId:i,saleChannelId:q.value.saleChannelId,orderStatus:_.UP_PROCESSING,orderTopStatus:"-1",orderCategory:2,detail:M.value,insureDetail:T.value,paymentMethod:null==(a=null==(e=q.value.extInfo)?void 0:e.extraInfo)?void 0:a.paymentMethod,renewalDK:null==(o=null==(t=q.value.extInfo)?void 0:t.extraInfo)?void 0:o.renewalDK,iseeBizNo:se,successJumpUrl:"",premium:G.value,holder:{...q.value.tenantOrderHolder,socialFlag:q.value.tenantOrderHolder.extInfo.hasSocialInsurance},insured:{...q.value.tenantOrderInsuredList[0],socialFlag:q.value.tenantOrderInsuredList[0].extInfo.hasSocialInsurance},tenantOrderRiskList:B({tenantId:d,riskList:z(F(T.value.productRiskVoList[0].riskDetailVOList),M.value),riskPremium:{},productId:null==(l=M.value)?void 0:l.id})}),s=await $(n),{code:r,data:c}=s;return"10000"===r?c.data:""})();await O({tenantId:d,applicationNo:q.value.applicationNo});if(ne.value=e,X.value){if(A){const a=encodeURIComponent(encodeURIComponent(re(e))),t=`${X.value}&successUrl=${a}`;window.location.href=t}else{const e=encodeURIComponent(encodeURIComponent(window.location.href)),a=`${X.value}&failUrl=${e}`;window.location.href=a}y.clear()}else(async e=>{const t=H({tenantId:d,premium:G.value,orderDetail:q.value,productDetail:M.value,insureDetail:T.value,successJumpUrl:re(e),iseeBizNo:se}),o=await S({orderNo:e,...t}),{code:l,data:s}=o;"10000"===l&&(A?a.replace(`/internet/orderDetail?orderNo=${e}&productCode=${n}&tenantId=${d}`):(y.clear(),ie()))})(e)}catch(t){y.clear()}},ue=async e=>{A?Q.value=!0:ce()},ve=()=>{y.loading({forbidClick:!0,duration:2e4,message:"试算中"});const e=K({productCode:n,withInsureInfo:!0,tenantId:d}),a=U({productCode:n}),t=x({orderNo:r,tenantId:d});Promise.all([e,a,t]).then((([e,a,t])=>{var o;"10000"===e.code&&(M.value=e.data,document.title=(null==(o=e.data)?void 0:o.productFullName)||""),"10000"===a.code&&(T.value=a.data),"10000"===t.code&&(q.value=t.data,W.value=t.data.tenantOrderInsuredList[0].extInfo.hasSocialInsurance),(async()=>{try{const e=H({tenantId:d,premium:G.value,orderDetail:q.value,productDetail:M.value,insureDetail:T.value,successJumpUrl:""},J),a=await k(e),{code:t,data:o}=a;"10000"===t&&(G.value=o.installmentPremium,X.value=o.signUrl)}catch(e){}finally{y.clear()}})()}))};return p((()=>{ve(),setTimeout((async()=>{se=window.getIseeBiz&&await window.getIseeBiz()}),1500)})),(e,a)=>{const o=m("ProRadioButton"),n=m("ProField"),d=m("van-config-provider");return t(),f(d,{"theme-vars":s(L)},{default:I((()=>{var e,t,d,r,i,c,u,v,p,m;return[l("div",ee,[l("img",{src:null==(t=null==(e=s(M))?void 0:e.tenantProductInsureVO)?void 0:t.banner[0],class:"banner"},null,8,ae),l("div",te,[l("div",oe,[h(E,{title:"姓名",desc:s(j)(null==(r=null==(d=s(q))?void 0:d.tenantOrderInsuredList)?void 0:r[0].name)},null,8,["desc"]),h(E,{title:"证件号码",desc:s(D)(null==(c=null==(i=s(q))?void 0:i.tenantOrderInsuredList)?void 0:c[0].certNo)},null,8,["desc"]),h(E,{title:"手机号码",desc:s(P)(null==(v=null==(u=s(q))?void 0:u.tenantOrderHolder)?void 0:v.mobile)},null,8,["desc"]),h(E,{title:"每月保费",desc:`${s(R)(s(G)||0)}元 / 每月`},null,8,["desc"]),h(n,{label:"有无社保",name:"name",required:"",placeholder:"请选择"},{input:I((()=>[h(o,{modelValue:s(W),"onUpdate:modelValue":a[0]||(a[0]=e=>w(W)?W.value=e:null),disabled:!0,options:s(C)},null,8,["modelValue","options"])])),_:1}),l("div",{class:"submit",onClick:ue})])]),h(Z,{"is-show":s(Y),onOnConfirm:ie,onOnClose:de},null,8,["is-show"])]),h(N,{show:s(Q),"onUpdate:show":a[1]||(a[1]=e=>w(Q)?Q.value=e:null),"content-list":null==(m=null==(p=s(M))?void 0:p.tenantProductInsureVO)?void 0:m.attachmentVOList,"active-index":s(le),text:"我已逐页阅读并确认告知内容",onSubmit:ce},null,8,["show","content-list","active-index"])]})),_:1},8,["theme-vars"])}}}),[["__scopeId","data-v-048a833a"]]);export{le as default};
