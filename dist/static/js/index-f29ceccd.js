import{l as e,a as i,P as a}from"./index-d96e93d9.js";import{d as l,z as s,o as t,a1 as r,R as o,c as n,A as d,V as u,U as c,g as p,i as v,w as m,h as k,k as f,G as y,aN as I,r as b,aZ as h,aT as g,L,a_ as V,a$ as R,f as C,F as x,E as O,b0 as S,aR as P,e as T,am as D,an as w,ah as F,j as _,aB as E,b1 as Y,a3 as N,ab as $,B,b2 as j,b3 as A,u as X,a as U,$ as K,av as M,T as q}from"./index-e38eab4b.js";import{_ as Q}from"./index-c1581331.js";/* empty css              */import{S as H}from"./index-cb673062.js";import{P as W}from"./index-f8e77c0c.js";import{S as z,_ as G}from"./box-title-739a978a.js";import{_ as Z}from"./index-3a5e988d.js";import{_ as J}from"./empty-ae586b6c.js";import{R as ee}from"./trial-9995eb1b.js";import{u as ie,b as ae,p as le,q as se,c as te}from"./trial-3f74bdbb.js";import{u as re}from"./useOrder-3845f246.js";import"./infoCollection-64f5b6d7.js";import"./core-e52d2ba5.js";const oe={key:0},ne={key:0,class:"risk2-field"},de=l({name:"ProductRiskList"});var ue=y(l({...de,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(e,{emit:i}){const a=e,l=s({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),y=e=>{const i=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&i.push({...e}),[]))),i},b=(e,s,t)=>{var r;l.riskIsInsure[s].data=e;const o=[...l.disabledRiskInfo];null==(r=a.dataSource.insureProductRiskVOList)||r.forEach((e=>{if(1!==e.mainRiskFlag){const i=l.riskIsInsure[e.riskId];i.data&&Object.keys(i.data).length>0&&"1"===i.selected&&o.push(i.data)}})),i("trialChange",o,t)},h=(e,i)=>{var s;null==(s=a.dataSource.productRiskRelationVOList)||s.forEach((a=>{1!==a.collocationType&&(i.riskId===a.riskId?(l.riskIsInsure[i.riskId]&&l.riskIsInsure[i.riskId].selected,2===a.collocationType&&l.riskIsInsure[a.collocationRiskId]&&(l.riskIsInsure[a.collocationRiskId].selected=e),3===a.collocationType&&l.riskIsInsure[a.collocationRiskId]&&"1"===e&&(l.riskIsInsure[a.collocationRiskId].selected="1"===e?"2":"1")):i.riskId===a.collocationRiskId&&(3===a.collocationType&&"1"===e&&l.riskIsInsure[a.riskId]&&(l.riskIsInsure[a.riskId].selected="1"===e?"2":"1"),2===a.collocationType&&l.riskIsInsure[a.riskId]&&(l.riskIsInsure[a.riskId].selected=e)))})),"2"===e?b({},i.riskId):(e=>{var i,a,l,s,t,r,o,n,d,u,c,p;if(1!==(null==e?void 0:e.factorDisPlayFlag)){const v=null==(i=null==e?void 0:e.productRiskInsureLimitVO)?void 0:i.amountPremiumConfigVO,m={riskCategory:e.riskCategory,riskCode:e.riskCode,riskName:e.riskName,riskId:e.riskId,riskType:e.riskType,mainRiskId:e.mainRiskId,mainRiskCode:e.mainRiskCode,liabilityList:y(e)};m.chargePeriod=(null==(l=null==(a=null==e?void 0:e.productRiskInsureLimitVO)?void 0:a.paymentPeriodValueList)?void 0:l.length)>0&&(null==(s=null==e?void 0:e.productRiskInsureLimitVO)?void 0:s.paymentPeriodValueList[0].code)||null,m.coveragePeriod=(null==(r=null==(t=null==e?void 0:e.productRiskInsureLimitVO)?void 0:t.insurancePeriodValueList)?void 0:r.length)>0&&(null==(o=null==e?void 0:e.productRiskInsureLimitVO)?void 0:o.insurancePeriodValueList[0].code)||null,m.paymentFrequency=(null==(d=null==(n=null==e?void 0:e.productRiskInsureLimitVO)?void 0:n.paymentFrequencyList)?void 0:d.length)>0&&(null==(u=null==e?void 0:e.productRiskInsureLimitVO)?void 0:u.paymentFrequencyList[0].code)||null;let k=0;1===v.displayType?k=(null==v?void 0:v.minStepValue)>0?null==v?void 0:v.minStepValue:0:3===v.displayType&&2===v.requireCopies?k=(null==(c=null==v?void 0:v.displayValues)?void 0:c.length)>0?null==v?void 0:v.displayValues[0].value:0:3===v.displayType&&1===v.requireCopies?(k=(null==(p=null==v?void 0:v.displayValues)?void 0:p.length)>0?null==v?void 0:v.displayValues[0].value:0,m.copy=v.minCopiesValue):2===v.displayType?m.copy=v.minCopiesValue:k=0,1===v.saleMethod?m.initialAmount=k:m.initialPremium=k,b(m,e.riskId)}})(i)};return t((()=>{(()=>{var e,i;l.disabledRiskInfo=[];let s=null;if(null==(e=a.dataSource.insureProductRiskVOList)||e.forEach((e=>{var i;const t=1!==e.mainRiskFlag?null==(i=a.dataSource.productRiskRelationVOList)?void 0:i.find((i=>i.collocationRiskId===e.riskId)):{};1===e.mainRiskFlag&&(s=e),l.riskIsInsure[e.riskId]?(l.riskIsInsure[e.riskId].data=null,l.riskIsInsure[e.riskId].relation=t,l.riskIsInsure[e.riskId].isMust=!1):l.riskIsInsure[e.riskId]={selected:"2",data:null,relation:t,isMust:!1}})),s){const e=null==(i=a.dataSource.productRiskRelationVOList)?void 0:i.filter((e=>e.riskId===s.riskId));if(!e)return;null==e||e.forEach((e=>{var i,s,t,r,o,n,d,u,c,p,v,m,k,f,I;if(2===e.collocationType){l.riskIsInsure[e.collocationRiskId].selected="1",l.riskIsInsure[e.collocationRiskId].isMust=!0;const h=null==(i=a.dataSource.insureProductRiskVOList)?void 0:i.find((i=>e.collocationRiskId===i.riskId));if(h&&1!==h.factorDisPlayFlag&&(null==(s=null==h?void 0:h.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO)){const i=null==(t=h.riskLiabilityInfoVOList)?void 0:t.every((e=>1!==e.showFlag)),a=null==(r=null==h?void 0:h.productRiskInsureLimitVO)?void 0:r.amountPremiumConfigVO;if(i){l.riskIsInsure[e.collocationRiskId].isDisabled=!0;const i={riskCategory:h.riskCategory,riskCode:h.riskCode,riskName:h.riskName,riskId:h.riskId,riskType:h.riskType,mainRiskId:h.mainRiskId,mainRiskCode:h.mainRiskCode,liabilityList:y(h)};i.chargePeriod=(null==(n=null==(o=null==h?void 0:h.productRiskInsureLimitVO)?void 0:o.paymentPeriodValueList)?void 0:n.length)>0&&(null==(d=null==h?void 0:h.productRiskInsureLimitVO)?void 0:d.paymentPeriodValueList[0].code)||null,i.coveragePeriod=(null==(c=null==(u=null==h?void 0:h.productRiskInsureLimitVO)?void 0:u.insurancePeriodValueList)?void 0:c.length)>0&&(null==(p=null==h?void 0:h.productRiskInsureLimitVO)?void 0:p.insurancePeriodValueList[0].code)||null,i.paymentFrequency=(null==(m=null==(v=null==h?void 0:h.productRiskInsureLimitVO)?void 0:v.paymentFrequencyList)?void 0:m.length)>0&&(null==(k=null==h?void 0:h.productRiskInsureLimitVO)?void 0:k.paymentFrequencyList[0].code)||null;let s=0;1===a.displayType?s=(null==a?void 0:a.minStepValue)>0?null==a?void 0:a.minStepValue:0:3===a.displayType&&2===a.requireCopies?s=(null==(f=null==a?void 0:a.displayValues)?void 0:f.length)>0?null==a?void 0:a.displayValues[0].value:0:3===a.displayType&&1===a.requireCopies?(s=(null==(I=null==a?void 0:a.displayValues)?void 0:I.length)>0?null==a?void 0:a.displayValues[0].value:0,i.copy=a.minCopiesValue):2===a.displayType&&(i.copy=a.minCopiesValue),1===a.saleMethod?i.initialAmount=s:i.initialPremium=s,l.disabledRiskInfo.push(i),b(i,h.riskId)}}}3===e.collocationType&&(l.riskIsInsure[e.collocationRiskId].selected="2",l.riskIsInsure[e.collocationRiskId].isMust=!0)}))}})()})),r((()=>{l.loading=!0})),o((()=>l.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>a.defaultValue),(e=>{(null==e?void 0:e.length)>0&&e.forEach((e=>{l.risksDefaultValue[e.riskCode]=e,l.riskIsInsure[e.riskId]?(l.riskIsInsure[e.riskId].selected="1",b(e,e.riskId)):l.riskIsInsure[e.riskId]={selected:"1",isMust:!1}}))}),{deep:!0,immediate:!0}),(i,a)=>{const s=H,t=I;return n(!0),d(c,null,u(e.dataSource.insureProductRiskVOList,(a=>{var r,o;return n(),d(c,{key:a.riskCode},[(!e.showMainRisk&&1!==a.mainRiskFlag||e.showMainRisk)&&(null==(o=null==(r=p(l).riskIsInsure)?void 0:r[a.riskId])?void 0:o.relation)?(n(),d("div",oe,[v(t,{modelValue:p(l).riskIsInsure[a.riskId].selected,"onUpdate:modelValue":e=>p(l).riskIsInsure[a.riskId].selected=e,label:a.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:m((()=>[v(s,{modelValue:p(l).riskIsInsure[a.riskId].selected,"onUpdate:modelValue":e=>p(l).riskIsInsure[a.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"0.74rem",disabled:p(l).riskIsInsure[a.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>h(e,a)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===p(l).riskIsInsure[a.riskId].selected?(n(),d("div",ne,[v(Q,{modelValue:p(l).riskIsInsure[a.riskId].data,"onUpdate:modelValue":e=>p(l).riskIsInsure[a.riskId].data=e,"origin-data":a,"product-factor":e.dataSource.productFactor,"default-value":p(l).risksDefaultValue[a.riskCode],onTrialChange:(e,i)=>b(e,a.riskId,i)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):k("",!0),1===a.exemptFlag&&"1"===p(l).riskIsInsure[a.riskId].selected?f(i.$slots,"holderForm",{key:1},void 0,!0):k("",!0)])):k("",!0)],64)})),128)}}}),[["__scopeId","data-v-04703dac"]]);var ce=y(l({__name:"ScrollWrap",props:{moduleValue:{type:Number,default:0},scrollX:{type:Boolean,default:!1},scrollY:{type:Boolean,default:!1}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:i}){const a=e,l=s({offsetX:0,offsetY:0,startX:0,startY:0}),t=b(null),u=b(null),{width:c,height:v}=h(t),{width:m,height:k}=h(u),y=g("PRO_TABLE_KEY"),I=L((()=>{const e=c.value>m.value+4;return i("update:needFixed",e),e})),C=L((()=>v.value>k.value+4)),{direction:x}=V(t,{passive:!1,onSwipeStart(e){const{clientX:i,clientY:a}=e.touches[0];l.startX=i,l.startY=a},onSwipe(e){const{clientX:i,clientY:a}=e.touches[0];if(["LEFT","RIGHT"].includes(x.value)){const e=l.offsetX-(l.startX-i);e>-c.value+m.value&&e<0&&(l.offsetX=e,y.state.offsetX=l.offsetX),l.startX=i}if(["UP","DOWN"].includes(x.value)){const e=l.offsetY-(l.startY-a);e>-v.value+k.value&&e<0&&(l.offsetY=e,y.state.offsetY=l.offsetY),l.startY=a}},onSwipeEnd(e){}}),O=L((()=>a.scrollX||a.scrollY?`transform: translate(${a.scrollX?`${l.offsetX}px`:0},${a.scrollY?`${l.offsetY}px`:0} );`:""));return o((()=>null==y?void 0:y.state),(()=>{const{offsetX:e,offsetY:i}=(null==y?void 0:y.state)||{};I.value&&(l.offsetX=e),C.value&&(l.offsetY=i)}),{deep:!0,immediate:!0}),r((()=>{var e;u.value=null==(e=t.value)?void 0:e.parentElement})),(e,i)=>(n(),d("div",{ref_key:"swiperEl",ref:t,class:"scroll-wrap",style:R(p(O))},[f(e.$slots,"default",{},void 0,!0)],4))}}),[["__scopeId","data-v-0ba94815"]]);const pe={class:"pro-com-table-wrap"},ve={ref:"tableHeadRef",class:"com-table"},me={class:"com-table-head"},ke={class:"com-table-row"},fe={ref:"tableBodyRef",class:"com-table"},ye={class:"com-table-head"},Ie={class:"com-table-row"},be={class:"com-table-body"};var he=y(l({__name:"Table",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]},translateY:{type:Number,default:0}},emits:["update:modelValue","update:needFixed"],setup(e,{emit:i}){const a=e=>{i("update:needFixed",e)};return(i,l)=>(n(),d("div",pe,[v(ce,{ref:"tableScroll",class:"pro-table-head","scroll-x":"","onUpdate:needFixed":a},{default:m((()=>[C("table",ve,[C("thead",me,[C("tr",ke,[(n(!0),d(c,null,u(e.columns,((e,i)=>(n(),d("th",{key:i,class:x(["table-cell",`table-cell-${i}`]),style:R({minWidth:`${e.width||80}px`})},O(e.title),7)))),128))])])],512)])),_:1},512),v(ce,{ref:"tableScroll",class:"pro-table-body","scroll-y":"","scroll-x":""},{default:m((()=>[C("table",fe,[C("thead",ye,[C("tr",Ie,[(n(!0),d(c,null,u(e.columns,((e,i)=>(n(),d("th",{key:i,class:x(["table-cell",`table-cell-${i}`]),style:R({minWidth:`${e.width||80}px`})},O(e.title),7)))),128))])]),C("tbody",be,[(n(!0),d(c,null,u(e.data,((i,a)=>(n(),d("tr",{key:a,class:"com-table-row"},[(n(!0),d(c,null,u(e.columns,((e,l)=>(n(),d("td",{key:l,class:x(["table-cell"])},[C("span",null,O(e.render?e.render(i,a):i[e.key]),1)])))),128))])))),128))])],512)])),_:1},512)]))}}),[["__scopeId","data-v-f37eb4be"]]);const ge=e=>(D("data-v-0cf962f9"),e=e(),w(),e),Le={key:0,class:"pro-table-wrap"},Ve={key:1,class:"no-data-wrap"},Re=[ge((()=>C("img",{src:J,alt:"暂无数据"},null,-1))),ge((()=>C("span",null,"暂无数据～",-1)))];var Ce=y(l({__name:"ProTable",props:{data:{type:Array,default:()=>[]},columns:{type:Array,default:()=>[]}},setup(e){const i=e;b(null),b(null);const a=s({translateY:0,translateX:0,offsetX:0,offsetY:0,needFixed:!1});S("PRO_TABLE_KEY",{state:a});const l=L((()=>P(i.columns)?i.columns.filter((e=>e.fixed)):[])),t=e=>{a.needFixed=e};return(i,s)=>e.data&&e.data.length?(n(),d("div",Le,[v(he,{"translate-y":p(a).translateY,"onUpdate:translateY":s[0]||(s[0]=e=>p(a).translateY=e),columns:e.columns,data:e.data,"onUpdate:needFixed":t},null,8,["translate-y","columns","data"]),p(a).needFixed?(n(),T(he,{key:0,"translate-y":p(a).translateY,"onUpdate:translateY":s[1]||(s[1]=e=>p(a).translateY=e),class:"pro-table-fixed",style:{width:"160px"},columns:p(l),data:e.data},null,8,["translate-y","columns","data"])):k("",!0)])):(n(),d("div",Ve,Re))}}),[["__scopeId","data-v-0cf962f9"]]);const xe={class:"benefit-table"},Oe=l({__name:"BenefitTable",props:{dataSource:null},setup(e){const i=e,a=L((()=>P(i.dataSource.headers)?i.dataSource.headers.map(((e,i)=>({title:e,key:`header_${i}`,fixed:i<2}))):[])),l=L((()=>P(i.dataSource.dataList)?i.dataSource.dataList.map((e=>{const i={};return e.forEach(((e,a)=>{i[`header_${a}`]=e})),i})):[]));return(e,i)=>(n(),d("div",xe,[v(Ce,{columns:p(a),data:p(l),"is-clone":!0},null,8,["columns","data"])]))}});const Se=e=>(D("data-v-5e4dfbe9"),e=e(),w(),e),Pe={key:0,class:"benefit-container"},Te={key:0,class:"benefit"},De=Se((()=>C("div",{class:"line"},null,-1))),we={class:"box-title box-title-chart"},Fe=Se((()=>C("img",{class:"tl",src:G,alt:""},null,-1))),_e=Se((()=>C("img",{class:"transform-z180 tr",src:G,alt:""},null,-1))),Ee={key:0},Ye={class:"box"},Ne={class:"box-title"},$e=Se((()=>C("img",{class:"tl",src:G,alt:""},null,-1))),Be=Se((()=>C("img",{class:"transform-z180 tr",src:G,alt:""},null,-1))),je={class:"box-price"},Ae={class:"text1"},Xe={class:"text2"},Ue={key:1},Ke={key:2,style:{width:"100%, minWidth: 338px"}},Me={class:"slider"},qe={style:{flex:"1",margin:"0px 5px"}},Qe={class:"custom-button"},He=Se((()=>C("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),We={class:"btn-two"},ze={key:1,class:"benefit-container"},Ge={key:0},Ze={class:"benefit"},Je=Se((()=>C("div",{class:"line"},null,-1))),ei=Se((()=>C("div",null,[C("div",{class:"box"},[C("p",{class:"box-title"},[C("img",{class:"tl",src:G,alt:""}),_(" 保单年度"),C("span",null,"-"),_("年度，被保人"),C("span",null,"-"),_("岁时 "),C("img",{class:"transform-z180 tr",src:G,alt:""})]),C("div",{class:"box-price"})])],-1))),ii={class:"slider"},ai={class:"opt lf"},li={style:{flex:"1",margin:"0px 5px"}},si=Se((()=>C("div",{class:"custom-button"},"0 岁",-1))),ti={class:"opt rg"},ri=Se((()=>C("p",{class:"slider-dec"},"拖动按钮查看不同年龄保障",-1))),oi={class:"btn-two"},ni={key:1,class:"empty-box"},di=l({name:"Benefit"});var ui=y(l({...di,props:{dataSource:{default:()=>({showTypeList:["1"]})},productInfo:{default:()=>null}},setup(e){var i;const a=e,l="1",s="2",t="3",r=b(0),f=b(0),y=b(0),I=b(),h=b(0),g=b(null==(i=a.dataSource.showTypeList)?void 0:i[0]),L=b(),V=e=>{if(!(null==e?void 0:e.benefitRiskResultVOList))return;const i=null==e?void 0:e.benefitRiskResultVOList[r.value];f.value=i.ageBegin+1,h.value=i.ageBegin+1,y.value=i.ageEnd},R=()=>{var e,i,l,s,t,o;const n=null==(i=null==(e=a.dataSource)?void 0:e.benefitRiskResultVOList)?void 0:i[r.value];L.value=null==(t=null==(s=null==(l=a.dataSource)?void 0:l.benefitRiskResultVOList)?void 0:s[r.value].benefitRiskTableResultVOList)?void 0:t[0];const{a:d,year:u}=((e,i)=>{const a=[],l=[];for(let s=e,t=0;s<=i;s++,t++)a.push(s.toString()),l.push(t+1);return{a:a,year:l}})(f.value,y.value),c={index:d.indexOf(h.value.toString()),age:d,year:u,result:null==(o=null==n?void 0:n.benefitRiskItemResultVOList)?void 0:o[0]};I.value=c},x=()=>{h.value>y.value-1||(h.value+=1,R())},S=()=>{h.value>f.value&&(h.value-=1,R())},P=e=>{r.value=e.name,V(a.dataSource),R()};return o((()=>a.dataSource),(e=>{var i;e&&(V(e),R(),g.value=null==(i=e.showTypeList)?void 0:i[0])}),{deep:!0,immediate:!0}),o(h,(()=>{R()})),(i,o)=>{var b;const V=$,R=z,D=B,w=j,X=A,U=W;return(null==(b=e.dataSource)?void 0:b.benefitRiskResultVOList)?(n(),d("div",Pe,[v(X,{active:p(r),onClickTab:P},{default:m((()=>{var e;return[(n(!0),d(c,null,u(null==(e=a.dataSource)?void 0:e.benefitRiskResultVOList,((e,i)=>(n(),T(w,{key:i,name:i,title:e.riskName},{default:m((()=>{var e,b,P,w,$,B,j,A,X,U,K,M,q,Q,H,W;return[i==p(r)?(n(),d("div",Te,[De,F(C("p",we,[Fe,_(" 保单年度"),C("span",null,O(null==(P=null==(e=p(I))?void 0:e.year)?void 0:P[null==(b=p(I))?void 0:b.index]),1),_("年度，被保人"),C("span",null,O(null==(B=null==(w=p(I))?void 0:w.age)?void 0:B[null==($=p(I))?void 0:$.index]),1),_("岁时 "),_e],512),[[E,p(g)===s]]),p(g)===l?(n(),d("div",Ee,[C("div",Ye,[C("p",Ne,[$e,_(" 保单年度"),C("span",null,O(null==(X=null==(j=p(I))?void 0:j.year)?void 0:X[null==(A=p(I))?void 0:A.index]),1),_("年度，被保人"),C("span",null,O(null==(M=null==(U=p(I))?void 0:U.age)?void 0:M[null==(K=p(I))?void 0:K.index]),1),_("岁时 "),Be]),C("div",je,[(n(!0),d(c,null,u(null==(Q=null==(q=p(I))?void 0:q.result)?void 0:Q.headers,((e,i)=>{var a,l,s,t,r,o,u,c,v,m;return n(),d("div",{key:i,style:{width:"33%"}},[C("p",Ae,O(("0"==(null==(r=null==(t=null==(l=null==(a=p(I))?void 0:a.result)?void 0:l.dataList)?void 0:t[null==(s=p(I))?void 0:s.index])?void 0:r[i])?"0":p(Y)(Number(null==(m=null==(v=null==(u=null==(o=p(I))?void 0:o.result)?void 0:u.dataList)?void 0:v[null==(c=p(I))?void 0:c.index])?void 0:m[i])))||"0"),1),C("p",Xe,O(e)+"(元）",1)])})),128))])])])):k("",!0),p(g)===t?(n(),d("div",Ue,[v(Oe,{"data-source":p(L)},null,8,["data-source"])])):k("",!0),p(g)==s?(n(),d("div",Ke,[v(Z,{min:p(f),max:p(y),current:p(h),data:null==(W=null==(H=p(I))?void 0:H.result)?void 0:W.benefitRiskItemList},null,8,["min","max","current","data"])])):k("",!0),p(g)!=t?(n(),d(c,{key:3},[C("div",Me,[C("div",{class:"opt lf",onClick:S},[v(V,{name:"minus"})]),C("div",qe,[p(f)?(n(),T(R,{key:0,modelValue:p(h),"onUpdate:modelValue":o[0]||(o[0]=e=>N(h)?h.value=e:null),min:p(f),max:p(y),"bar-height":"8px"},{button:m((()=>[C("div",Qe,O(p(h))+" 岁",1)])),_:1},8,["modelValue","min","max"])):k("",!0)]),C("div",{class:"opt rg",onClick:x},[v(V,{name:"plus"})])]),He],64)):k("",!0),C("div",We,[a.dataSource.showTypeList.includes(l)?(n(),T(D,{key:0,round:"",plain:p(g)!==l,type:"primary",class:"btn",onClick:o[1]||(o[1]=e=>g.value=l)},{default:m((()=>[_("图表展示")])),_:1},8,["plain"])):k("",!0),a.dataSource.showTypeList.includes(s)?(n(),T(D,{key:1,round:"",plain:p(g)!==s,type:"primary",class:"btn",onClick:o[2]||(o[2]=e=>g.value=s)},{default:m((()=>[_("趋势展示")])),_:1},8,["plain"])):k("",!0),a.dataSource.showTypeList.includes(t)?(n(),T(D,{key:2,round:"",plain:p(g)!==t,type:"primary",class:"btn",onClick:o[3]||(o[3]=e=>g.value=t)},{default:m((()=>[_("表格展示")])),_:1},8,["plain"])):k("",!0)])])):k("",!0)]})),_:2},1032,["name","title"])))),128))]})),_:1},8,["active"])])):(n(),d("div",ze,[a.productInfo?(n(),d("div",Ge,[v(X,{active:p(r),onClickTab:P},{default:m((()=>[(n(),T(w,{key:1,name:1,title:e.productInfo.insureProductRiskVOList[0].riskName},{default:m((()=>[C("div",Ze,[Je,ei,C("div",ii,[C("div",ai,[v(V,{name:"minus"})]),C("div",li,[v(R,{modelValue:p(h),"onUpdate:modelValue":o[4]||(o[4]=e=>N(h)?h.value=e:null),min:0,max:80,"bar-height":"8px",disabled:""},{button:m((()=>[si])),_:1},8,["modelValue"])]),C("div",ti,[v(V,{name:"plus"})])]),ri,C("div",oi,[v(D,{round:"",plain:!0,type:"primary",class:"btn",disabled:""},{default:m((()=>[_("图表展示")])),_:1}),v(D,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:m((()=>[_("趋势展示")])),_:1}),v(D,{round:"",plain:!1,type:"primary",class:"btn",disabled:""},{default:m((()=>[_("表格展示")])),_:1})])])])),_:1},8,["title"]))])),_:1},8,["active"])])):(n(),d("div",ni,[v(U,{title:"试算结果正在计算中...","empty-class":"empty-select"})]))]))}}}),[["__scopeId","data-v-5e4dfbe9"]]);const ci={key:0,class:"head-warning-wrap"},pi=C("div",{class:"warning-icon"},[C("span",null,"!")],-1),vi={class:"warning-text"},mi=l({name:"HeadWaring"}),ki=l({...mi,props:{labels:{default:()=>[]}},setup:e=>(i,a)=>e.labels.length>0?(n(),d("div",ci,[pi,C("div",vi,[(n(!0),d(c,null,u(e.labels,(e=>(n(),d("span",{key:e},O(e),1)))),128))])])):k("",!0)}),fi=(i,a,l)=>{const s=i,{holder:t}=l,r=l.insuredList[0],o=(a||"").split("_");if(o.length<2)return a;if(e.exports.isNaN(Number(o[1])))return a;if(o[1]-=1,1===s.exemptFlag){if("to"===o[0]){let e=0;1===s.exemptType?(null==t?void 0:t.birthday)&&(e=parseInt(""+((new Date).getTime()-new Date(t.birthday).getTime())/31536e6,10)):2===s.exemptType&&(null==r?void 0:r.birthday)&&(e=parseInt(""+(+(new Date).getTime()-new Date(r.birthday).getTime())/31536e6,10)),o[1]=+o[1]-e}o[0]="year"}return o.join("_")},yi=(e,i)=>{const a=[],l={};return null==e||e.forEach((e=>{l[e.riskId]=e})),null==i||i.forEach((e=>{var i,s,t,r;const{collocationType:o,collocationRiskId:n,riskId:d}=e;switch(o){case 2:{const e=null==(i=l[d])?void 0:i.riskName,t=null==(s=l[n])?void 0:s.riskName;a.push(`${e} 和 ${t} 必须同时投保`);break}case 3:{const e=null==(t=l[d])?void 0:t.riskName,i=null==(r=l[n])?void 0:r.riskName;a.push(`${e} 和 ${i} 不能同时投保`);break}}})),a};const Ii={class:"com-body"},bi={class:"trial-body"},hi={class:"container"},gi=(e=>(D("data-v-5294fa0d"),e=e(),w(),e))((()=>C("div",{class:"empty"},null,-1))),Li=l({name:"TrialBody"});var Vi=y(l({...Li,props:{dataSource:{default:()=>[]},productInfo:{default:()=>({productCode:"",productName:"",insurerCode:"",tenantId:""})},tenantProductDetail:{default:()=>({})},hideBenefit:{type:Boolean,default:!1},hidePopupButton:{type:Boolean,default:!1},title:{default:"算一算保费"},defaultData:{default:null},isTrial:{type:Boolean,default:!1}},emits:["trialStart","trialEnd"],setup(l,{expose:u,emit:c}){const y=l,I=b(null),h=X();U(),h.query;const g=b(),L=s({loading:!1,show:!1,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},riskList:[{}],mainRiskVO:{},ifPersonalInfoSuccess:!1,trialMsg:"",trialResultPremium:0,trialResult:{initialPremium:0,initialAmount:0},isAniShow:!1,defaultValue:null,isAutoChange:!1,planIndex:0,isSkipFirstTrial:!1,hadSkipFirstTrial:!1,isQuerying:!1});re(),b(),b();const V=e=>{const{holder:i,insuredList:a}=e||{};i&&(L.submitData.holder=i),a&&a.length>0&&a.forEach(((e,i)=>{var a;L.submitData.insuredList&&L.submitData.insuredList.length>i?L.submitData.insuredList[i]=e:((null==(a=L.submitData)?void 0:a.insuredList)||(L.submitData.insuredList=[]),L.submitData.insuredList.push(e))}))},R=b(),x=b({}),O=["annuityDrawDate","coveragePeriod","chargePeriod","paymentFrequency"],S=e=>{var i,l,s,t,r,o;if(null==(l=null==(i=null==e?void 0:e.data)?void 0:i[0])?void 0:l.productRiskDyInsureFactorVOList){const i=[];if(null==(s=y.dataSource)||s.insureProductRiskVOList.forEach((l=>{var s,t;const r=null==(t=null==(s=null==e?void 0:e.data)?void 0:s[0])?void 0:t.productRiskDyInsureFactorVOList.find((e=>e.riskCode===l.riskCode));if(r){l.productRiskInsureLimitVO={...l.productRiskInsureLimitVO,...r};const e=L.riskList.find((e=>e.riskCode===l.riskCode));let s=!1;a.forEach((i=>{if(O.indexOf(i.valueKey)>=0){const a=l.productRiskInsureLimitVO[i.configKey];if(a&&e){const l=a.find((a=>a.code===e[i.valueKey]));if(l&&2===l.useFlag){const l=a.find((e=>1===e.defaultFlag));e[i.valueKey]=l.code,s=!0}}}})),s&&i.push({...e,...r,riskCode:l.riskCode})}})),i.length>0&&(null==(o=null==(r=null==(t=L.defaultValue)?void 0:t.insuredList)?void 0:r[0])?void 0:o.productList))return i.forEach((e=>{var i,a,l;L.defaultValue.insuredList[0].productList=null==(l=null==(a=null==(i=L.defaultValue)?void 0:i.insuredList)?void 0:a[0])?void 0:l.productList.map((i=>(i.riskList=null==i?void 0:i.riskList.map((i=>(i.riskCode===e.riskCode&&(i=e),i))),i)))})),!1}return!0},P=async(e,i=!0)=>{L.trialMsg="试算中...",L.trialResultPremium=0,L.loading=!0,c("trialStart");let a=!1;if(i){const{code:i}=await ie(e);a="10000"===i}!a&&i||(L.isQuerying=!0,y.hideBenefit||ae(e).then((e=>{e.data&&e.code===M&&(x.value=e.data)})).finally((()=>{L.loading=!1})),le(e).then((e=>{var i,a;if(e.data&&e.code===M){(null==(i=null==e?void 0:e.data)?void 0:i.errorInfo)&&q(`${null==(a=null==e?void 0:e.data)?void 0:a.errorInfo}`),L.trialMsg="",L.trialResultPremium=e.data.initialPremium,L.trialResult=e.data;const l={};e.data.riskPremiumDetailVOList&&e.data.riskPremiumDetailVOList.length&&e.data.riskPremiumDetailVOList.forEach((e=>{l[e.riskCode]={initialAmount:e.initialAmount,initialPremium:e.initialPremium}})),R.value=l,c("trialEnd",e.data,L.submitData)}})).finally((()=>{L.loading=!1,L.isQuerying=!1})))},D=e.exports.debounce((async()=>{console.log(">>>>>调用试算<<<<<",L.ifPersonalInfoSuccess,g.value.canTrail());const{productCode:i,productName:l}=y.productInfo||{};if(L.ifPersonalInfoSuccess||g.value.canTrail()){L.submitData.productCode=i,L.submitData.productName=l,L.submitData.tenantId=y.productInfo.tenantId,L.riskList=L.riskList.map((e=>(e=>{var i,l,s,t;const r=null==(i=y.dataSource.insureProductRiskVOList)?void 0:i.find((i=>e.riskId===i.riskId));if(r&&1!==r.mainRiskFlag){const i=null==(s=null==(l=y.dataSource)?void 0:l.productRiskRelationVOList)?void 0:s.filter((e=>{var i;if(e.collocationRiskId===r.riskId&&3!==e.collocationType){const a=null==(i=y.dataSource.insureProductRiskVOList)?void 0:i.find((i=>e.riskId===i.riskId));if(a&&a.riskType===ee.MAIN_RISK)return!0}return!1})),o=i.length>0?i[0]:null;if(o){const i=null==(t=L.riskList)?void 0:t.find((e=>e.riskId===o.riskId));a.forEach((a=>{a.ruleKey&&r.productRiskInsureLimitVO&&i&&(1===r.productRiskInsureLimitVO[a.ruleKey]&&(e[a.valueKey]=i[a.valueKey]),3===r.productRiskInsureLimitVO[a.ruleKey]&&(1!==r.exemptFlag?e[a.valueKey]=fi(r,i[a.valueKey],L.submitData):e[a.valueKey]=fi(r,i[a.ruleValueKey],L.submitData)))}))}}return e})(e))),L.submitData.insuredList&&L.submitData.insuredList.forEach((e=>{e.productList=[{productCode:i,productName:l,riskList:L.riskList}]})),console.log(">>>数据构建<<<",e.exports.cloneDeep(L.submitData));const s=e.exports.cloneDeep(L.submitData);await P(s)}}),300),w=async e=>{var i;const{insuredList:a,isFirstInsuredChange:l}=e;if(V(e),L.ifPersonalInfoSuccess=!0,l){console.log("处理第一被保人修改的dy变化"),L.isQuerying=!0;const e=await se({calcProductFactorList:[{planCode:y.dataSource.planCode,productCode:y.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:null==(i=y.dataSource.insureProductRiskVOList)?void 0:i[0]}]}],...a[0]});if(L.isQuerying=!1,!S(e))return}console.log("投被保人的信息回传 ",e),D()},F=async(i,a)=>{var l,s,t,r;if(a){const o=e.exports.cloneDeep(i);delete o.insurancePeriodValueList,delete o.paymentFrequencyList,delete o.paymentPeriodValueList;if(O.indexOf(a.key)>=0&&`${a.oldValue}`!=`${a.newValue}`){const e={};switch(a.key){case"annuityDrawDate":e.changeType=3;break;case"coveragePeriod":e.changeType=2;break;case"chargePeriod":e.changeType=1}const n=null==(s=null==(l=L.submitData)?void 0:l.insuredList)?void 0:s[0],d=null==(r=null==(t=y.dataSource)?void 0:t.insureProductRiskVOList)?void 0:r.find((e=>e.riskCode===i.riskCode));if(!L.isAutoChange){L.isQuerying=!0;const a=await se({calcProductFactorList:[{planCode:y.dataSource.planCode,productCode:y.productInfo.productCode,riskEditVOList:[{insureProductRiskVO:d,insureRiskEditReqVO:{riskId:i.riskId,riskCode:i.riskCode,...o,...e}}]}],...n});L.isQuerying=!1;const l=S(a);return l||(L.isAutoChange=!0),l}L.isAutoChange=!1}}return!0},_=async(e,i)=>{L.mainRiskVO=e;await F(e,i)&&(L.riskList.length>0&&(L.riskList[0]=e),console.log("标准险种的信息回传",e),D())},E=async(e,i)=>{if(L.riskList=[L.mainRiskVO,...e],console.log("附加险列表数据回传",e),i){const a=e.find((e=>e.riskCode===i.riskCode));if(!(await F(a,i)))return}D()},Y=e=>{var i,a,l,s;L.userData=e,L.defaultValue=e;const t=(null==(i=e.insuredList)?void 0:i[0].productList.findIndex((e=>e.planCode===y.dataSource.planCode)))||0;L.planIndex=-1===t?0:t,L.riskList=(null==(s=null==(l=null==(a=null==e?void 0:e.insuredList)?void 0:a[0].productList)?void 0:l[L.planIndex])?void 0:s.riskList)||[],P(e,!0)};t((()=>{var e,i;L.select={},L.list=[],L.userData={},L.riskIsInsure={},L.submitData={},L.riskList=[{}],L.mainRiskVO={},L.ifPersonalInfoSuccess=!1,L.trialMsg="",L.trialResultPremium=0,L.riskIsInsure={},null==(i=null==(e=null==y?void 0:y.dataSource)?void 0:e.insureProductRiskVOList)||i.forEach((e=>{var i;const a=null==(i=y.dataSource.productRiskRelationVOList)?void 0:i.find((i=>i.collocationRiskId===e.riskId));a&&(L.riskIsInsure[e.riskCode]={selected:"2",data:null,relation:a})}))})),r((()=>{L.loading=!0,L.show=!0,L.isAniShow=!0,L.isSkipFirstTrial=!0,L.hadSkipFirstTrial=!1,K((()=>{(async e=>{var i,a;if(console.log("props.defaultData",!y.defaultData),y.defaultData){const e=y.defaultData.find((e=>e.productCode===y.productInfo.productCode))||y.defaultData[0];Y(e),V(null==(a=y.defaultData)?void 0:a[0])}else{const e=await te({calcProductFactorList:[{planCode:y.dataSource.planCode,productCode:y.productInfo.productCode}]});if(e.data){const a=e.data.find((e=>e.productCode===y.productInfo.productCode))||e.data[0];Y(a),V(null==(i=e.data)?void 0:i[0])}}})()}))}));return u({getTrialSuccessFlag:()=>L.trialResultPremium>0,validate:()=>g.value.validate(!1),validateTrialFields:()=>g.value.validateTrialFields(),validateHolder:e=>{var i;return null==(i=g.value)?void 0:i.validateHolder(e)},getUserData:()=>({...L.userData})}),o((()=>L.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),o((()=>L.userData),(e=>{if(e){const{holder:i,insuredList:a}=e||{};Object.assign(L.submitData,{holder:i,insuredList:a})}}),{deep:!0}),(e,a)=>{var s,t,r,o,u,c,y,b;return n(),d("div",Ii,[f(e.$slots,"trialHead",{},void 0,!0),C("div",bi,[v(ki,{labels:p(yi)((null==(s=l.dataSource)?void 0:s.insureProductRiskVOList)||[],l.dataSource.productRiskRelationVOList)},null,8,["labels"]),C("div",hi,[!l.hideBenefit&&(null==(t=x.value)?void 0:t.benefitRiskResultVOList)?(n(),T(ui,{key:0,class:"benefit-wrap","data-source":x.value,"product-info":l.dataSource,"show-type-list":x.value.showTypList},null,8,["data-source","product-info","show-type-list"])):k("",!0),l.dataSource.productFactor?(n(),T(p(i),{key:1,ref_key:"personalInfoRef",ref:g,modelValue:p(L).userData,"onUpdate:modelValue":a[0]||(a[0]=e=>p(L).userData=e),"is-trial":l.isTrial,"product-factor":l.dataSource.productFactor,"multi-insured-config":null==(r=l.dataSource)?void 0:r.multiInsuredConfigVO,onTrailChange:w},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):k("",!0),v(Q,{ref_key:"insureInfosRef",ref:I,"origin-data":null==(o=l.dataSource.insureProductRiskVOList)?void 0:o[0],"product-factor":l.dataSource.productFactor,"default-value":p(L).defaultValue?null==(c=null==(u=p(L).defaultValue)?void 0:u.insuredList[0].productList[p(L).planIndex])?void 0:c.riskList[0]:null,"trial-result":p(L).trialResult,onTrialChange:_},null,8,["origin-data","product-factor","default-value","trial-result"]),l.dataSource.insureProductRiskVOList?(n(),T(ue,{key:2,"data-source":l.dataSource,"show-main-risk":!1,"default-value":p(L).defaultValue?null==(b=null==(y=p(L).defaultValue)?void 0:y.insuredList[0].productList[p(L).planIndex])?void 0:b.riskList:[],onTrialChange:E},{holderForm:m((()=>{var e;return[l.isTrial&&l.dataSource.productFactor?(n(),T(p(i),{key:0,ref_key:"personalInfoRef",ref:g,modelValue:p(L).userData,"onUpdate:modelValue":a[1]||(a[1]=e=>p(L).userData=e),"is-trial":l.isTrial,"is-only-holder":!0,"product-factor":l.dataSource.productFactor,"multi-insured-config":null==(e=l.dataSource)?void 0:e.multiInsuredConfigVO,onTrailChange:w},null,8,["modelValue","is-trial","product-factor","multi-insured-config"])):k("",!0)]})),_:1},8,["data-source","default-value"])):k("",!0),gi])]),f(e.$slots,"trialBtn",{trialData:p(L).submitData,riskPremium:p(L).trialResult,loading:p(L).isQuerying,personalInfoRef:g.value},void 0,!0)])}}}),[["__scopeId","data-v-5294fa0d"]]);export{Vi as T};
