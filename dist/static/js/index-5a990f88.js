import{g as at,Q as ot,a0 as it,C as l,M as nt,h as f,j as d,r as F,k as a,y as t,n as r,m as v,I as _,F as x,E,G as g,H as m,z as i,A as b,B as Z,s as y,D as j,T as D}from"./vendor-e9263418.js";import{q as G,u as ct,c as lt}from"./visit-bddb9367.js";import{_ as H}from"./index-654379f5.js";import{_ as Q}from"./index-e4c11be9.js";import{u as rt}from"./index-b8742a0a.js";const dt={class:"list-head"},vt={key:0,class:"list"},_t={class:"total-people"},gt={class:"cell-item"},mt={class:"cell-item-left"},ht=["src"],Ft={class:"left-text"},ft={class:"text-top"},pt={class:"name-div"},Bt={class:"text-bottom"},Ct={class:"weixinImg-out"},xt=["src"],Et=t("div",{class:"weixin-text"},"\u5FAE\u4FE1\u7528\u6237",-1),bt=["onClick"],yt=["src"],Dt={key:0,class:"list"},At={class:"total-people"},kt={class:"cell-item"},Tt={class:"cell-item-left"},$t=["src"],wt={class:"left-text"},It={class:"text-top"},Lt={class:"name-div"},Rt={class:"text-bottom"},Nt={class:"weixinImg-out"},St=["src"],Vt=t("div",{class:"weixin-text"},"\u5FAE\u4FE1\u7528\u6237",-1),qt=["onClick"],Yt=["src"],jt=at({setup(Mt){const{getIconUrl:o}=rt(),L=ot(),R=it(),h=l(!1),N=l(0);l(!0);const A=l(!1),S=l(""),V=l(!1),p=l(0),k=l({}),B=l(0),T=l({}),n=l("02"),C=(e,u)=>e==="\u63A5\u89E6\u9762\u8C08"?u==="background"?"#FFEEE7":"#FF6600":e==="\u9700\u6C42\u5206\u6790"||e==="\u5448\u73B0\u4FC3\u6210"?u==="background"?"rgba(0, 175, 255, 0.08)":"#00AFFF":e==="\u5BA2\u6237\u83B7\u53D6"?u==="background"?"rgba(115, 76, 255, 0.1)":"#947FE1":e==="\u7535\u8BDD\u9080\u7EA6"?u==="background"?"rgba(255, 141, 30, 0.1)":"#FF8D1E":e==="\u4FDD\u5355\u670D\u52A1"?u==="background"?"rgba(27, 205, 145, 0.1)":"#1BCD91":e==="\u8F6C\u4ECB\u7ECD"?u==="background"?"rgba(255, 43, 31, 0.06)":"$primary-color":null,q=()=>{h.value=!0,G({pageNum:"1",pageSize:"999",queryBean:{orderBy:"firstLetter",customerListType:n.value}}).then(e=>{h.value=!1,console.log(e.data.data,"lissssssss"),n.value==="02"&&(p.value=e.data.data.count||0,k.value=e.data.data.customerMaps||{}),n.value==="03"&&(B.value=e.data.data.count||0,T.value=e.data.data.customerMaps||{})}).catch(e=>{h.value=!1,console.log(e)})},Y=e=>{e.isRelative==="Y"?j.confirm({message:"\u8BE5\u5BA2\u6237\u5DF2\u5173\u8054\u8FC7\u5176\u4ED6\u5FAE\u4FE1\u5BA2\u6237\uFF0C\u53D8\u66F4\u5173\u8054\u540E\u539F\u5FAE\u4FE1\u8BBF\u5BA2\u5173\u8054\u5173\u7CFB\u5C06\u88AB\u89E3\u9664\uFF0C\u60A8\u786E\u8BA4\u8981\u53D8\u66F4\u5173\u8054\u4FE1\u606F\u5417\uFF1F",confirmButtonText:"\u53D8\u66F4",theme:"round-button"}).then(()=>{ct({agentCustomerId:e.agentCustomerId,relId:e.id,tenantId:e.tenantId,userId:e.userId,visitorId:L.query.visitId,customerId:e.customerId,customerType:n.value}).then(u=>{u.data.data==="\u5173\u8054\u6210\u529F"&&(D.success("\u53D8\u66F4\u6210\u529F"),R.go(-1))})}).catch(()=>{}):j.confirm({theme:"round-button",message:`\u786E\u5B9A\u8981\u5173\u8054\u5BA2\u6237\u201C${e.customerName}\u201D\u5417\uFF1F`,confirmButtonText:"\u5173\u8054"}).then(()=>{lt({visitorId:L.query.visitId,agentCustomerId:e.agentCustomerId,customerType:n.value}).then(u=>{console.log(u.data.data,"\u65B0\u589E\u8BBF\u5BA2\u63A5\u53E3"),u.data.data==="\u5173\u8054\u6210\u529F"&&(D.success("\u5173\u8054\u6210\u529F"),R.go(-1))}).catch(u=>{console.log(u),D.fail("\u5173\u8054\u5931\u8D25")})}).catch(()=>{})},J=e=>{e.title==="\u51C6\u5BA2\u6237"?n.value="02":e.title==="\u627F\u4FDD\u5BA2\u6237"&&(n.value="03"),q()},K=()=>{A.value=!0},M=e=>{G(e).then(u=>{n.value==="02"&&(p.value=u.data.data.count||0,k.value=u.data.data.customerMaps||{}),n.value==="03"&&(B.value=u.data.data.count||0,T.value=u.data.data.customerMaps||{})}).catch(u=>{console.log(u),D.fail("\u67E5\u8BE2\u5217\u8868\u5931\u8D25")})},O=e=>{V.value=!0;const u={pageNum:"1",pageSize:"999",queryBean:{orderBy:"firstLetter",customerListType:n.value,keyword:e}};M(u)},X=()=>{A.value=!1,V.value=!1,M({pageNum:"1",pageSize:"999",queryBean:{orderBy:"firstLetter",customerListType:n.value}})};return nt(()=>{q()}),(e,u)=>{const tt=F("van-search"),z=F("van-index-anchor"),U=F("van-cell"),P=F("van-index-bar"),W=F("van-tab"),et=F("van-tabs"),ut=F("ZaPageWrap");return a(),f(ut,{"main-class":"page-relatedCustomers"},{default:d(()=>[t("div",null,[t("div",dt,[r(tt,{modelValue:S.value,"onUpdate:modelValue":u[0]||(u[0]=c=>S.value=c),class:"search-area",shape:"round",placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D\u3001\u624B\u673A\u53F7\u67E5\u8BE2","show-action":A.value,onSearch:O,onCancel:X,onFocus:K},null,8,["modelValue","show-action"])]),r(et,{active:N.value,"onUpdate:active":u[1]||(u[1]=c=>N.value=c),class:"visitor-tabs",onClickTab:J},{default:d(()=>[r(W,{title:"\u51C6\u5BA2\u6237"},{default:d(()=>[t("div",null,[h.value?y("",!0):(a(),v("div",vt,[t("div",_t,_(`\u5171${p.value}\u4EBA`),1),r(P,null,{default:d(()=>[(a(!0),v(x,null,E(k.value,(c,$,w)=>g((a(),v("div",{key:`${c}-${w}`},[r(z,{index:$,class:"index-bar-title"},null,8,["index"]),(a(!0),v(x,null,E(c,(s,I)=>(a(),f(U,{key:`${s}-${I}`,class:"cell-visit-customer"},{default:d(()=>[t("div",gt,[t("div",mt,[t("img",{src:s.gender==="\u7537"?i(o)("visitor.manImg"):i(o)("visitor.womenImg"),alt:"",class:"sexImg"},null,8,ht),t("div",Ft,[t("div",ft,[t("div",pt,_(s.customerName),1),g(t("div",{class:"tag-out",style:b(`background:${C(s.visitTag,"background")}`)},[t("div",{class:"tag-text",style:b(`color:${C(s.visitTag,"text")}`)},_(s.visitTag),5)],4),[[m,s.visitTag]])]),g(t("div",Bt,[t("div",Ct,[t("img",{src:i(o)("visitor.weixinImg"),alt:"",class:"weixinImg"},null,8,xt)]),Et],512),[[m,s.isRelative==="Y"]])])]),t("div",{class:"cell-item-right",onClick:st=>Y(s)},[t("img",{src:s.isRelative==="Y"?i(o)("visitor.changeImg"):i(o)("visitor.connectImg"),alt:""},null,8,yt),Z(" "+_(s.isRelative==="Y"?"\u53D8\u66F4":"\u5173\u8054"),1)],8,bt)])]),_:2},1024))),128))])),[[m,c.length]])),128))]),_:1}),g(r(Q,{class:"relatedCustomers-empty",title:"\u6682\u65E0\u51C6\u5BA2\u6237","empyt-img":i(o)("customer.empty2")},null,8,["empyt-img"]),[[m,p.value===0]])])),h.value?(a(),f(H,{key:1,vertical:!0})):y("",!0)])]),_:1}),r(W,{title:"\u627F\u4FDD\u5BA2\u6237"},{default:d(()=>[t("div",null,[h.value?y("",!0):(a(),v("div",Dt,[t("div",At,_(`\u5171${B.value}\u4EBA`),1),r(P,null,{default:d(()=>[(a(!0),v(x,null,E(T.value,(c,$,w)=>g((a(),v("div",{key:`${c}-${w}`},[r(z,{index:$,class:"index-bar-title"},null,8,["index"]),(a(!0),v(x,null,E(c,(s,I)=>(a(),f(U,{key:`${s}-${I}`,class:"cell-visit-customer"},{default:d(()=>[t("div",kt,[t("div",Tt,[t("img",{src:s.gender==="\u7537"?i(o)("visitor.manImg"):i(o)("visitor.womenImg"),alt:"",class:"sexImg"},null,8,$t),t("div",wt,[t("div",It,[t("div",Lt,_(s.customerName),1),g(t("div",{class:"tag-out",style:b(`background:${C(s.visitTag,"background")}`)},[t("div",{class:"tag-text",style:b(`color:${C(s.visitTag,"text")}`)},_(s.visitTag),5)],4),[[m,s.visitTag]])]),g(t("div",Rt,[t("div",Nt,[t("img",{src:i(o)("visitor.weixinImg"),alt:"",class:"weixinImg"},null,8,St)]),Vt],512),[[m,s.isRelative==="Y"]])])]),t("div",{class:"cell-item-right",onClick:st=>Y(s)},[t("img",{src:s.isRelative==="Y"?i(o)("visitor.changeImg"):i(o)("visitor.connectImg"),alt:""},null,8,Yt),Z(" "+_(s.isRelative==="Y"?"\u53D8\u66F4":"\u5173\u8054"),1)],8,qt)])]),_:2},1024))),128))])),[[m,c.length]])),128))]),_:1}),g(r(Q,{class:"relatedCustomers-empty",title:"\u6682\u65E0\u627F\u4FDD\u5BA2\u6237","empyt-img":i(o)("customer.empty2")},null,8,["empyt-img"]),[[m,B.value===0]])])),h.value?(a(),f(H,{key:1,vertical:!0})):y("",!0)])]),_:1})]),_:1},8,["active"])])]),_:1})}}});export{jt as default};
