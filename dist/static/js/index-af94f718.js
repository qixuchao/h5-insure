import{d as a,cE as e,r as l,G as t,N as n,Y as s,aI as i,bT as o,ct as u,b as r,c,i as d,f as v,U as p,a4 as m,a0 as f,$ as g,h,g as y,j as C,e as b,a1 as k,bi as w,w as L,V as S,b5 as U,ah as E,cF as N,cG as $,O as j,bU as A,cH as B,aK as V,aV as x,aW as P}from"./index-57af35f9.js";import{o as T}from"./utils-6a79a2ae.js";import"./infoCollection-36281fb3.js";import"./trial-5610cdf9.js";const _={class:"guarantee-list"},F=(a=>(x("data-v-72bcb63c"),a=a(),P(),a))((()=>d("span",null,"保障计划",-1))),G={key:0,class:"plan-list"},I=["onClick"],q={key:2,class:"feerate-view"},z={key:0},D={class:"extinfo-info-list"},O={class:"guarantee-detail"},Y={class:"content"},H=a({name:"guarantee"});var K=E(a({...H,props:{dataSource:{default:()=>({})},showServiceConfig:{type:Boolean,default:!1},isShowClose:{type:Boolean,default:!1},count:{default:5},planList:{default:()=>[]}},emits:["updateActivePlan"],setup(a,{emit:E}){var x,P;const H=a;e((a=>({"47c8f96c":v(K)})));const K=l(""),M=l((null==(P=null==(x=H.planList)?void 0:x[0])?void 0:P.planCode)||void 0),R=l(),W=l([]),J=l([]),Q=l(),X=t((()=>!!H.planList.length));n([()=>H.dataSource,()=>M.value],(()=>{var a,e;W.value=((null==(e=((null==(a=H.dataSource)?void 0:a.GUARANTEE)||[]).find((a=>a.planCode===M.value)))?void 0:e.data)||[]).filter((a=>a.isShowOn===`${s.YES}`))}),{immediate:!0,deep:!0});const Z=t((()=>{var a;return(null==(a=H.dataSource)?void 0:a.rateUri)||""})),aa=t((()=>!!(Q.value&&Q.value.paymentFrequencyValue&&Q.value.premiumUnit&&Z))),[ea,la]=i(!1),ta=t((()=>{var a;return!(!W.value||!(null==(a=W.value)?void 0:a.length))&&(W.value.length>H.count&&(!!H.isShowClose||!ea.value))})),na=()=>{la()},sa=t((()=>{var a;return W.value&&(null==(a=W.value)?void 0:a.length)?W.value.length<=H.count||ea.value?W.value:W.value.slice(0,H.count):[]})),ia=l(!1),oa=a=>{const e=a||window.event;e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,"A"===e.target.tagName&&e.target.href&&(N()?$("",e.target.href):window.open(e.target.href))},ua=()=>{ia.value=!0,j((()=>{var a,e;null==(e=null==(a=document.getElementsByClassName("guarantee-detail"))?void 0:a[0])||e.addEventListener("click",oa,!1)}))};o((()=>{var a,e;null==(e=null==(a=document.getElementsByClassName("guarantee-detail"))?void 0:a[0])||e.removeEventListener("click",oa,!1)}));const ra=()=>{T({fileType:"pdf",fileUri:Z.value})},ca=a=>{M.value=H.planList[a.name].planCode};return(a,e)=>{var l,t;const n=A,s=B,i=V,o=u("dompurify-html");return r(),c(p,null,[d("div",_,[d("div",{class:"header"},[F,d("span",{onClick:ua},"查看详情")]),v(X)?(r(),c("div",G,[(r(!0),c(p,null,m(a.planList,((a,e)=>(r(),c("div",{key:`${a.planCode}_${e}`,class:f("plan-list-item "+(a.planCode===v(M)?"plan-list-item-active":"")),onClick:e=>{return l=a.planCode,M.value=l,R.value=H.planList.findIndex((a=>a.planCode===l)),void E("updateActivePlan",l);var l}},[d("span",null,g(a.planName),1)],10,I)))),128))])):h("",!0),(r(!0),c(p,null,m(v(sa),((a,e)=>(r(),y(n,{key:e,class:"guarantee-item",title:a.title,content:a.desc,border:!1},null,8,["title","content"])))),128)),v(ta)?(r(),c("div",{key:1,class:"show-more",onClick:na},[C(g(v(ea)?"收起":"查看更多")+" ",1),b(k,{name:"arrow-down-dobule",class:f(["icon",{showMore:v(ea)}])},null,8,["class"])])):h("",!0),v(aa)?(r(),c("div",q,[d("span",null,g(`${(null==(l=v(Q))?void 0:l.paymentFrequencyValue)||""}${(null==(t=v(Q))?void 0:t.premiumUnit)||""}`),1),v(Z)?(r(),c("span",{key:0,onClick:ra},"查看保费")):h("",!0)])):h("",!0)]),b(w),b(i,{show:v(ia),"onUpdate:show":e[1]||(e[1]=a=>S(ia)?ia.value=a:null),title:"保障详情",class:"guarantee-popup"},{default:L((()=>[v(J)&&v(J).length>0?(r(),c("div",z,[d("div",D,[(r(!0),c(p,null,m(v(J),((a,e)=>(r(),y(n,{key:e,title:a.name,content:a.description,border:!1,size:"small"},null,8,["title","content"])))),128))]),b(w)])):h("",!0),v(X)?(r(),y(s,{key:1,active:v(R),"onUpdate:active":e[0]||(e[0]=a=>S(R)?R.value=a:null),list:a.planList.map(((a,e)=>({title:a.planName}))),class:"custom-plan-tab",onClickTab:ca},null,8,["active","list"])):h("",!0),d("div",O,[(r(!0),c(p,null,m(v(W),((a,e)=>(r(),c("div",{key:e,class:"guarantee-item"},[b(n,{title:a.title,content:a.desc,border:!1,size:"small"},null,8,["title","content"]),U(d("div",Y,null,512),[[o,a.tips]])])))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-72bcb63c"]]);export{K as default};
