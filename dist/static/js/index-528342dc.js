var be=Object.defineProperty,Ie=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable;var ne=(e,n,o)=>n in e?be(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,v=(e,n)=>{for(var o in n||(n={}))Re.call(n,o)&&ne(e,o,n[o]);if(oe)for(var o of oe(n))Te.call(n,o)&&ne(e,o,n[o]);return e},b=(e,n)=>Ie(e,De(n));import{g as de,E as y,X as re,y as Ce,j as r,n as Q,k as E,A as k,t as R,m as C,p as D,a1 as ke,a2 as ge,z as N,C as Y,Q as Fe,aj as Ae,h as _e,r as M,G as Be,F as Se,T as Ve,L as he,J as Ne}from"./vendor-c15a8cf7.js";import{_ as se,Y as ie,h as O,G as L,U as Le,m as Oe,H as A,I,J as z,l as U,K as xe,P as we}from"./index-65b1952c.js";import{c as x}from"./utils-b6782348.js";import{u as Ge}from"./useDicData-d3ac3d99.js";import{c as We,a as je,d as He,n as Me}from"./index-a8c79304.js";var Z=(e=>(e[e.REAL_TIME=1]="REAL_TIME",e[e.BATCH=2]="BATCH",e))(Z||{});const X=[{value:1,label:"\u5B9E\u65F6\u8F6C\u8D26"},{value:2,label:"\u6279\u91CF\u6263\u6B3E"}];x(X);var ee=(e=>(e[e.DEBIT=1]="DEBIT",e[e.CREDIT=2]="CREDIT",e[e.PRE_PAY=3]="PRE_PAY",e[e.PRE_CREDIT=4]="PRE_CREDIT",e[e.OTHER=5]="OTHER",e))(ee||{});const pe=[{value:1,label:"\u501F\u8BB0\u5361"},{value:2,label:"\u8D37\u8BB0\u5361"},{value:3,label:"\u9884\u4ED8\u8D39\u5361"},{value:4,label:"\u51C6\u8D37\u8BB0\u5361"},{value:5,label:"\u5176\u4ED6"}];x(pe);var V=(e=>(e[e.FIRST_TERM=1]="FIRST_TERM",e[e.RENEW_TERM=2]="RENEW_TERM",e[e.REPRISE=3]="REPRISE",e[e.OTHER=4]="OTHER",e))(V||{});const ce=[{value:1,label:"\u9996\u671F\u652F\u4ED8"},{value:2,label:"\u7EED\u671F\u652F\u4ED8"},{value:3,label:"\u5E74\u91D1\u9886\u53D6"},{value:4,label:"\u5176\u4ED6"}];x(ce);var _=(e=>(e[e.FIRST_SAME=1]="FIRST_SAME",e[e.RENEW_SAME=2]="RENEW_SAME",e[e.OTHER=3]="OTHER",e))(_||{});const qe=[{value:1,label:"\u540C\u9996\u671F"},{value:2,label:"\u540C\u7EED\u671F"},{value:3,label:"\u5176\u4ED6"}];x(ce);var me=(e=>(e[e.AUTOMATIC_PADDING=1]="AUTOMATIC_PADDING",e[e.CANCEL=2]="CANCEL",e))(me||{});const ve=[{value:1,label:"\u81EA\u52A8\u57AB\u4ED8"},{value:2,label:"\u4E2D\u6B62\u5408\u540C"}];x(ve);const Ke=e=>(ke("data-v-5f24f9c5"),e=e(),ge(),e),Pe={class:"com-bank-card-info"},$e=Ke(()=>N("span",{class:"field-title"},[Y("\u94F6\u884C\u5361\u7167\u7247 "),N("span",{class:"sub-title"},"(\u9700\u4E0A\u4F20\u6B63\u53CD\u4E24\u9762)")],-1)),ze=de({props:{modelValue:{type:Object,default:()=>{}},holderName:{type:String,default:""},factor:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:n}){const o=e,q=Ge("BANK"),d=y({bankCardType:ee.DEBIT,bankCardNo:"",accountName:"",payBank:"",mobile:"",images:[]}),B=s=>o.factor&&o.factor[s]&&o.factor[s].isDisplay===ie.YES,w=s=>s&&s.length===2?!0:"\u8BF7\u4E0A\u4F20\u94F6\u884C\u5361\u6B63\u53CD\u9762\u7167\u7247";re(()=>o.modelValue,s=>{d.value=s},{immediate:!0}),re(d,s=>{n("update:modelValue",s)});const G=Ce(()=>q.value.map(s=>({label:s.name,value:s.code})));return(s,i)=>(r(),Q("div",Pe,[B("cardType")?(r(),E(O,{key:0,modelValue:d.value.bankCardType,"onUpdate:modelValue":i[0]||(i[0]=c=>d.value.bankCardType=c),label:"\u5361\u7247\u7C7B\u578B",name:"bankCardType","data-source":k(pe),"is-view":""},null,8,["modelValue","data-source"])):R("",!0),B("bankCardNumber")?(r(),E(L,{key:1,modelValue:d.value.bankCardNo,"onUpdate:modelValue":i[1]||(i[1]=c=>d.value.bankCardNo=c),label:"\u94F6\u884C\u5361\u53F7",name:"bankCardNo",type:"number",required:""},null,8,["modelValue"])):R("",!0),B("cardHolder")?(r(),E(L,{key:2,"model-value":e.holderName,label:"\u6301\u5361\u4EBA",name:"accountName","is-view":""},null,8,["model-value"])):R("",!0),B("bank")?(r(),E(O,{key:3,modelValue:d.value.payBank,"onUpdate:modelValue":i[2]||(i[2]=c=>d.value.payBank=c),name:"payBank",label:"\u5F00\u6237\u94F6\u884C","data-source":k(G),required:""},null,8,["modelValue","data-source"])):R("",!0),B("bankCardAttachment")?(r(),E(L,{key:4,label:"\u94F6\u884C\u5361\u7167\u7247",block:"","label-width":"100%",name:"images",rules:[{validator:w}]},{label:C(()=>[$e]),input:C(()=>[D(Oe,{modelValue:d.value.images,"onUpdate:modelValue":i[3]||(i[3]=c=>d.value.images=c),"max-count":2,"upload-type":k(Le).BANK_CARD},null,8,["modelValue","upload-type"])]),_:1},8,["rules"])):R("",!0),B("bankPreMobile")?(r(),E(L,{key:5,modelValue:d.value.mobile,"onUpdate:modelValue":i[4]||(i[4]=c=>d.value.mobile=c),label:"\u9884\u7559\u624B\u673A\u53F7",type:"number",required:"",name:"mobile","validate-type":["phone"]},null,8,["modelValue"])):R("",!0)]))}});var J=se(ze,[["__scopeId","data-v-5f24f9c5"]]);const Ue={class:"page-bank-card"},Je={class:"reprise-card-list"},Qe=["onClick"],Ze={class:"agree"},Xe=Y(" \u6295\u4FDD\u4EBA\u9605\u8BFB\u5E76\u63A5\u53D7 "),Ye={class:"footer-button footer"},ea=Y("\u4E0B\u4E00\u6B65"),aa=de({setup(e){const n={1:"pdf",4:"picture",2:"richText",3:"link"},o=Fe(),q=Ae(),{orderNo:d="2022072710380711215",agentCode:B="D1234567-1",tenantId:w="9991000007",templateId:G=1,insureCode:s="kunlunhealth"}=o.query,i={bankCardType:ee.DEBIT};let c={};const W=y(""),m=y({payMethod:Z.REAL_TIME,bankData:b(v({},i),{imagesId:[],images:[]})}),t=y({payMethod:Z.REAL_TIME,expiryMethod:me.AUTOMATIC_PADDING,bankData:b(v({},i),{imagesId:[],images:[]}),payInfoType:_.FIRST_SAME}),T=y({bankData:b(v({},i),{imagesId:[],images:[]})}),h=y(_.FIRST_SAME),g=y({}),K=y(!1),ae=y(),ue=y(),le=y(),te=y({}),j=y(1),ye=p=>{h.value=p},H=(p,u)=>(console.log("factor",g.value),g.value&&g.value[u]&&g.value[u][p]&&g.value[u][p].isDisplay===ie.YES),Ee=()=>{He({insureCode:s,objectType:4,tenantId:w,orderNo:d}).then(({code:p,data:u})=>{p==="10000"&&(te.value=u,u.materialSource===1?u.materialContent.indexOf(".pdf")!==-1?j.value=1:j.value=4:j.value=u.materialSource)})},fe=()=>{var p,u,f;if(!K.value){Ve.fail("\u8BF7\u52FE\u9009\u540C\u610F\u94F6\u884C\u8F6C\u8D26\u6388\u6743");return}Promise.all([(p=ae.value)==null?void 0:p.validate(),(u=ue.value)==null?void 0:u.validate(),(f=le.value)==null?void 0:f.validate()]).then(a=>{const F=[b(v({},a[0]),{id:m.value.id,paymentType:V.FIRST_TERM}),b(v({},a[1]),{id:t.value.id,paymentType:V.RENEW_TERM}),b(v({},a[2]),{id:T.value.id,paymentType:V.REPRISE,payInfoType:h.value})],S=[{category:I.OBVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.INIT_SIGN,type:"png",uri:a[0].images[0],id:m.value.bankData.imagesId[0]},{category:I.REVERSE_BANK_CARD,name:"\u9996\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:A.INIT_SIGN,type:"png",uri:a[0].images[1],id:m.value.bankData.imagesId[1]}];t.value.payInfoType===_.OTHER&&(S.push({category:I.OBVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.RENEWAL_SIGN,type:"png",uri:a[1].images[0],id:t.value.bankData.imagesId[0]}),S.push({category:I.REVERSE_BANK_CARD,name:"\u7EED\u671F\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.RENEWAL_SIGN,type:"png",uri:a[1].images[1],id:t.value.bankData.imagesId[1]})),h.value===_.OTHER&&(S.push({category:I.OBVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u6B63\u9762",objectType:A.ANNUAL_SIGN,type:"png",uri:a[2].images[0],id:T.value.bankData.imagesId[0]}),S.push({category:I.REVERSE_BANK_CARD,name:"\u5E74\u91D1\u7B7E\u7EA6\u94F6\u884C\u5361\u80CC\u9762",objectType:A.ANNUAL_SIGN,type:"png",uri:a[2].images[1],id:T.value.bankData.imagesId[1]})),Me(b(v({},c),{pageCode:"payInfo",tenantOrderPayInfoList:F,extInfo:b(v({},c.extInfo),{templateId:G,pageCode:"payInfo"}),operateOption:{withPayInfo:!0,withAttachmentInfo:!0},tenantOrderAttachmentList:S})).then(l=>{const{code:P,data:$}=l;P==="10000"&&$.success&&q.push({path:we[$.pageAction.data.nextPageCode],query:o.query})})})};return _e(()=>{Ee(),We({pageCode:"payInfo",templateId:G}).then(p=>{const{code:u,data:f}=p;if(u==="10000"){const a={};f.productInsureFactorList.forEach(F=>{a[F.moduleType]||(a[F.moduleType]={}),a[F.moduleType][F.code]=F}),g.value=a}}),je({orderNo:d,saleUserId:B,tenantId:w}).then(p=>{const{code:u,data:f}=p;u==="10000"&&f&&(c=f,W.value=f.tenantOrderHolder.name,f.tenantOrderPayInfoList.forEach(a=>{a.paymentType===V.FIRST_TERM?(m.value=a,m.value.bankData=b(v(v({},i),a),{images:[],imagesId:[]})):a.paymentType===V.RENEW_TERM?(t.value=a,t.value.bankData=b(v({},a),{images:[],imagesId:[]})):a.paymentType===V.REPRISE&&(T.value=a,T.value.bankData=b(v({},a),{images:[],imagesId:[]}),h.value=a.payInfoType)}),f.tenantOrderAttachmentList.forEach(a=>{a.objectType===A.INIT_SIGN?(a.category===I.OBVERSE_BANK_CARD&&(m.value.bankData.images[0]=a.uri,m.value.bankData.imagesId[0]=a.id),a.category===I.REVERSE_BANK_CARD&&(m.value.bankData.images[1]=a.uri,m.value.bankData.imagesId[1]=a.id)):a.objectType===A.RENEWAL_SIGN?(a.category===I.OBVERSE_BANK_CARD&&(t.value.bankData.images[0]=a.uri,t.value.bankData.imagesId[0]=a.id),a.category===I.REVERSE_BANK_CARD&&(t.value.bankData.images[1]=a.uri,t.value.bankData.imagesId[1]=a.id)):a.objectType===A.ANNUAL_SIGN&&(a.category===I.OBVERSE_BANK_CARD&&(T.value.bankData.images[0]=a.uri,T.value.bankData.imagesId[0]=a.id),a.category===I.REVERSE_BANK_CARD&&(T.value.bankData.images[1]=a.uri,T.value.bankData.imagesId[1]=a.id))}))})}),(p,u)=>{const f=M("van-switch"),a=M("van-checkbox"),F=M("van-button"),S=M("ProPageWrap");return r(),E(S,null,{default:C(()=>[N("div",Ue,[D(U,{title:"\u9996\u671F\u652F\u4ED8"},{default:C(()=>[D(z,{ref_key:"form1",ref:ae},{default:C(()=>[H("paymentMethod","INIT")?(r(),E(O,{key:0,modelValue:m.value.payMethod,"onUpdate:modelValue":u[0]||(u[0]=l=>m.value.payMethod=l),name:"payMethod",required:"",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":k(X)},null,8,["modelValue","data-source"])):R("",!0),D(J,{modelValue:m.value.bankData,"onUpdate:modelValue":u[1]||(u[1]=l=>m.value.bankData=l),"holder-name":W.value,factor:g.value.INIT},null,8,["modelValue","holder-name","factor"])]),_:1},512)]),_:1}),D(U,{title:"\u7EED\u671F\u652F\u4ED8"},{default:C(()=>[D(z,{ref_key:"form2",ref:ue},{default:C(()=>[H("sameAsInit","RENEWAL")?(r(),E(L,{key:0,label:"\u540C\u9996\u671F",name:"payInfoType"},{input:C(()=>[D(f,{modelValue:t.value.payInfoType,"onUpdate:modelValue":u[2]||(u[2]=l=>t.value.payInfoType=l),size:"22","active-value":k(_).FIRST_SAME,"inactive-value":k(_).OTHER},null,8,["modelValue","active-value","inactive-value"])]),_:1})):R("",!0),H("paymentMethod","RENEWAL")?(r(),E(O,{key:1,modelValue:t.value.payMethod,"onUpdate:modelValue":u[3]||(u[3]=l=>t.value.payMethod=l),name:"payMethod",label:"\u652F\u4ED8\u65B9\u5F0F","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":k(X),required:""},null,8,["modelValue","data-source"])):R("",!0),H("overduePayment","RENEWAL")?(r(),E(O,{key:2,modelValue:t.value.expiryMethod,"onUpdate:modelValue":u[4]||(u[4]=l=>t.value.expiryMethod=l),name:"expiryMethod",label:"\u4FDD\u8D39\u903E\u671F\u672A\u652F\u4ED8","is-link":"",placeholder:"\u8BF7\u9009\u62E9","data-source":k(ve),required:"","label-width":"200"},null,8,["modelValue","data-source"])):R("",!0),t.value.payInfoType!==k(_).FIRST_SAME?(r(),E(J,{key:3,modelValue:t.value.bankData,"onUpdate:modelValue":u[5]||(u[5]=l=>t.value.bankData=l),"holder-name":W.value,factor:g.value.RENEWAL},null,8,["modelValue","holder-name","factor"])):R("",!0)]),_:1},512)]),_:1}),D(U,{title:"\u5E74\u91D1\u9886\u53D6\u94F6\u884C\u5361",class:"reprise-card","show-divider":!1},{default:C(()=>[N("div",Je,[(r(!0),Q(Se,null,Be(k(qe),(l,P)=>(r(),Q("div",{key:P,class:he(["reprise-card-item",{selected:h.value===l.value}]),onClick:$=>ye(l.value)},Ne(l.label),11,Qe))),128))]),D(z,{ref_key:"form3",ref:le},{default:C(()=>[h.value===k(_).OTHER?(r(),E(J,{key:0,modelValue:T.value.bankData,"onUpdate:modelValue":u[6]||(u[6]=l=>T.value.bankData=l),"holder-name":W.value,factor:g.value.ANNUITY},null,8,["modelValue","holder-name","factor"])):R("",!0)]),_:1},512)]),_:1}),N("div",Ze,[D(a,{modelValue:K.value,"onUpdate:modelValue":u[7]||(u[7]=l=>K.value=l),class:"checkbox",shape:"square","icon-size":16},null,8,["modelValue"]),Xe,D(xe,{class:"file",title:"\u300A\u94F6\u884C\u8F6C\u8D26\u6388\u6743\u300B",content:te.value.materialContent,type:n[j.value]},null,8,["content","type"])]),N("div",Ye,[D(F,{type:"primary",onClick:fe},{default:C(()=>[ea]),_:1})])])]),_:1})}}});var da=se(aa,[["__scopeId","data-v-9a3500fa"]]);export{da as default};
