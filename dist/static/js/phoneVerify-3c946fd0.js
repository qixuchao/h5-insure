import{E as a,d as e,r as s,u as t,a0 as r,b as l,c as o,e as d,w as n,f as u,z as c,g as i,af as p,a1 as v,bC as I,A as f,i as m,j as C,m as b,T as N,bD as h,B as T,ak as _,al as j}from"./index-f6fa5ecc.js";import{s as y,c as O}from"./phoneVerify-687c21c7.js";import{c as E}from"./format-12461bbc.js";import{p as g}from"./pageJump-1ad97747.js";import{u as A}from"./useOrder-d313bd64.js";import"./pdfh5-008ca364.js";const P={class:"page-phone-verify"},D=(a=>(_("data-v-a498a32c"),a=a(),j(),a))((()=>u("div",{class:"title"},"通过投保人手机号验证后，可进行投保信息填写",-1))),S={class:"phone"},k={class:"input-wrapper"};var q=a(e({__name:"phoneVerify",setup(a){const e=A(),_=s(""),j=s(""),q=s(0);let w;const F=t(),{agentCode:V,tenantId:x,templateId:U,productCode:W,insurerCode:z,orderNo:B}=F.query,G=()=>{y(_.value).then((({code:a})=>{"10000"===a&&(q.value=60,w=setInterval((()=>{q.value-=1,q.value<=0&&clearInterval(w)}),1e3))}))},H=()=>{O(_.value,j.value).then((({code:a,data:s})=>{"10000"===a&&s?(N.success("验证成功"),e.value.orderStatus===h.PROCESSING?g("infoCollection",F.query):[h.WAIT_IDENTIFICATION,h.IDENTIFICATION_COMPLETE,h.IN_IDENTIFICATION].includes(e.value.orderStatus)&&g("infoPreview",F.query)):N.fail("验证失败")}))};return r((()=>{b({orderNo:B,saleUserId:V,tenantId:x}).then((({code:a,data:s})=>{var t;"10000"===a&&(Object.assign(e.value,s),_.value=null==(t=null==s?void 0:s.tenantOrderHolder)?void 0:t.mobile)}))})),(a,e)=>{const s=T,t=l("ProPageWrap");return o(),d(t,null,{default:n((()=>[u("div",P,[D,u("div",S,c(i(E)(i(_)||"")),1),u("div",k,[p(u("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>v(j)?j.value=a:null),placeholder:"请输入验证码",class:"input"},null,512),[[I,i(j)]]),u("div",{class:f(["btn",{second:i(q)}]),onClick:G},c(i(q)?`${i(q)}s`:"发送验证码"),3)]),m(s,{type:"primary",class:"submit-btn",onClick:H},{default:n((()=>[C("下一步")])),_:1})])])),_:1})}}}),[["__scopeId","data-v-a498a32c"]]);export{q as default};
