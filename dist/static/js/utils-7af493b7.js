import{d as e,x as i,o as s,a0 as l,Q as a,c as o,y as n,U as d,R as r,g as t,i as u,w as c,h as k,E as I,aP as p}from"./index-000b7445.js";/* empty css              */import{I as m}from"./index-db455601.js";import{S as y}from"./index-1178332c.js";const v={key:0},V={key:0,class:"risk2-field"},g=e({name:"TrialPop"});var f=I(e({...g,props:{dataSource:{type:Array,default:()=>[]},productInfo:{type:Object,default:()=>({productCode:"",productName:""})},showMainRisk:{type:Boolean,default:()=>!0},defaultValue:{type:Object,default:()=>{}}},emits:["trialChange"],setup(e,{emit:I}){const g=e,f=i({loading:!1,show:!0,select:{},list:[],userData:{},riskIsInsure:{},submitData:{},disabledRiskInfo:[],risksDefaultValue:{}}),R=e=>{const i=[];return e.riskLiabilityInfoVOList.map((e=>(1!=+e.showFlag&&i.push({...e}),[]))),i},h=(e,i,s)=>{var l;f.riskIsInsure[i].data=e;const a=[...f.disabledRiskInfo];null==(l=g.dataSource.insureProductRiskVOList)||l.forEach((e=>{if(1!==e.mainRiskFlag){const i=f.riskIsInsure[e.riskId];i.data&&Object.keys(i.data).length>0&&!i.isDisabled&&a.push(i.data)}})),I("trialChange",a,s)},C=(e,i)=>{var s;null==(s=g.dataSource.productRiskRelationVOList)||s.forEach((s=>{1!==s.collocationType&&(i.riskId===s.riskId?(f.riskIsInsure[i.riskId]&&f.riskIsInsure[i.riskId].selected,2===s.collocationType&&f.riskIsInsure[s.collocationRiskId]&&(f.riskIsInsure[s.collocationRiskId].selected=e),3===s.collocationType&&f.riskIsInsure[s.collocationRiskId]&&(f.riskIsInsure[s.collocationRiskId].selected="1"===e?"2":"1")):i.riskId===s.collocationRiskId&&(3===s.collocationType&&f.riskIsInsure[s.riskId]&&(f.riskIsInsure[s.riskId].selected="1"===e?"2":"1"),2===s.collocationType&&f.riskIsInsure[s.riskId]&&(f.riskIsInsure[s.riskId].selected=e)))})),"2"===e?h({},i.riskId):(e=>{var i,s,l,a,o,n;if(1!==(null==e?void 0:e.factorDisPlayFlag)){const d=null==(i=null==e?void 0:e.productRiskInsureLimitVO)?void 0:i.amountPremiumConfigVO,r={riskCategory:e.riskCategory,riskCode:e.riskCode,riskName:e.riskName,riskId:e.riskId,riskType:e.riskType,mainRiskId:e.mainRiskId,mainRiskCode:e.mainRiskCode,liabilityVOList:R(e)};r.chargePeriod=(null==(s=null==e?void 0:e.paymentPeriodValueList)?void 0:s.length)>0&&(null==e?void 0:e.paymentPeriodValueList[0].code)||null,r.coveragePeriod=(null==(l=null==e?void 0:e.insurancePeriodValueList)?void 0:l.length)>0&&(null==e?void 0:e.insurancePeriodValueList[0].code)||null,r.paymentFrequency=(null==(a=null==e?void 0:e.paymentFrequencyList)?void 0:a.length)>0&&(null==e?void 0:e.paymentFrequencyList[0].code)||null;let t=0;1===d.displayType?t=(null==d?void 0:d.minStepValue)>0?null==d?void 0:d.minStepValue:0:3===d.displayType&&2===d.requireCopies?t=(null==(o=null==d?void 0:d.displayValues)?void 0:o.length)>0?null==d?void 0:d.displayValues[0].value:0:3===d.displayType&&1===d.requireCopies?(t=(null==(n=null==d?void 0:d.displayValues)?void 0:n.length)>0?null==d?void 0:d.displayValues[0].value:0,r.copy=d.minCopiesValue):2===d.displayType?r.copy=d.minCopiesValue:t=0,1===d.saleMethod?r.amount=t:r.premium=t,h(r,e.riskId)}})(i)};return s((()=>{(()=>{var e,i;f.riskIsInsure={},f.disabledRiskInfo=[];let s=null;if(null==(e=g.dataSource.insureProductRiskVOList)||e.forEach((e=>{var i;const l=1!==e.mainRiskFlag?null==(i=g.dataSource.productRiskRelationVOList)?void 0:i.find((i=>i.collocationRiskId===e.riskId)):{};1===e.mainRiskFlag&&(s=e),f.riskIsInsure[e.riskId]={selected:"2",data:null,relation:l,isMust:!1}})),s){const e=null==(i=g.dataSource.productRiskRelationVOList)?void 0:i.filter((e=>e.riskId===s.riskId));if(!e)return;null==e||e.forEach((e=>{var i,s,l,a,o,n,d,r,t;if(2===e.collocationType){f.riskIsInsure[e.collocationRiskId].selected="1",f.riskIsInsure[e.collocationRiskId].isMust=!0;const u=null==(i=g.dataSource.insureProductRiskVOList)?void 0:i.find((i=>e.collocationRiskId===i.riskId));if(u&&1!==u.factorDisPlayFlag&&(null==(s=null==u?void 0:u.productRiskInsureLimitVO)?void 0:s.amountPremiumConfigVO)){const i=null==(l=u.riskLiabilityInfoVOList)?void 0:l.every((e=>1!==e.showFlag)),s=null==(a=null==u?void 0:u.productRiskInsureLimitVO)?void 0:a.amountPremiumConfigVO;if(i){f.riskIsInsure[e.collocationRiskId].isDisabled=!0;const i={riskCategory:u.riskCategory,riskCode:u.riskCode,riskName:u.riskName,riskId:u.riskId,riskType:u.riskType,mainRiskId:u.mainRiskId,mainRiskCode:u.mainRiskCode,liabilityVOList:R(u)};i.chargePeriod=(null==(o=null==u?void 0:u.paymentPeriodValueList)?void 0:o.length)>0&&(null==u?void 0:u.paymentPeriodValueList[0].code)||null,i.coveragePeriod=(null==(n=null==u?void 0:u.insurancePeriodValueList)?void 0:n.length)>0&&(null==u?void 0:u.insurancePeriodValueList[0].code)||null,i.paymentFrequency=(null==(d=null==u?void 0:u.paymentFrequencyList)?void 0:d.length)>0&&(null==u?void 0:u.paymentFrequencyList[0].code)||null;let l=0;1===s.displayType?l=(null==s?void 0:s.minStepValue)>0?null==s?void 0:s.minStepValue:0:3===s.displayType&&2===s.requireCopies?l=(null==(r=null==s?void 0:s.displayValues)?void 0:r.length)>0?null==s?void 0:s.displayValues[0].value:0:3===s.displayType&&1===s.requireCopies?(l=(null==(t=null==s?void 0:s.displayValues)?void 0:t.length)>0?null==s?void 0:s.displayValues[0].value:0,i.copy=s.minCopiesValue):2===s.displayType&&(i.copy=s.minCopiesValue),1===s.saleMethod?i.amount=l:i.premium=l,f.disabledRiskInfo.push(i),h(i,u.riskId)}}}3===e.collocationType&&(f.riskIsInsure[e.collocationRiskId].selected="2",f.riskIsInsure[e.collocationRiskId].isMust=!0)}))}})()})),l((()=>{f.loading=!0})),a((()=>f.riskIsInsure),(e=>{}),{deep:!0,immediate:!0}),a((()=>g.defaultValue),(e=>{(null==e?void 0:e.length)>0&&e.forEach((e=>{f.risksDefaultValue[e.riskCode]=e}))}),{deep:!0,immediate:!0}),(i,s)=>{const l=y,a=p;return o(!0),n(r,null,d(e.dataSource.insureProductRiskVOList,(i=>{var s,d;return o(),n(r,{key:i.riskCode},[(!e.showMainRisk&&1!==i.mainRiskFlag||e.showMainRisk)&&(null==(d=null==(s=t(f).riskIsInsure)?void 0:s[i.riskId])?void 0:d.relation)?(o(),n("div",v,[u(a,{modelValue:t(f).riskIsInsure[i.riskId].selected,"onUpdate:modelValue":e=>t(f).riskIsInsure[i.riskId].selected=e,label:i.riskName,name:"selected","label-width":"50%",border:!1,class:"risk-select-field risk-name"},{input:c((()=>[u(l,{modelValue:t(f).riskIsInsure[i.riskId].selected,"onUpdate:modelValue":e=>t(f).riskIsInsure[i.riskId].selected=e,"active-value":"1","inactive-value":"2",size:"26px",disabled:t(f).riskIsInsure[i.riskId].isMust,style:{"margin-right":"8px"},onChange:e=>C(e,i)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"])])),_:2},1032,["modelValue","onUpdate:modelValue","label"]),"1"===t(f).riskIsInsure[i.riskId].selected?(o(),n("div",V,[u(m,{modelValue:t(f).riskIsInsure[i.riskId].data,"onUpdate:modelValue":e=>t(f).riskIsInsure[i.riskId].data=e,"origin-data":i,"product-factor":e.dataSource.productFactor,"default-value":t(f).risksDefaultValue[i.riskCode],onTrialChange:(e,s)=>h(e,i.riskId,s)},null,8,["modelValue","onUpdate:modelValue","origin-data","product-factor","default-value","onTrialChange"])])):k("",!0)])):k("",!0)],64)})),128)}}}),[["__scopeId","data-v-2cf8541d"]]);const R=(e,i,s)=>{var l,a,o,n;const d=e,{holder:r}=s,t=s.insuredVOList[0],u=(i||"").split("_");if(u[1]-=1,1===d.exemptFlag){if("to"===u[0]){let e=0;1===d.exemptType?(null==(l=null==r?void 0:r.personVO)?void 0:l.birthday)&&(e=parseInt(""+((new Date).getTime()-new Date(null==(a=r.personVO)?void 0:a.birthday).getTime())/31536e6,10)):2===d.exemptType&&(null==(o=null==t?void 0:t.personVO)?void 0:o.birthday)&&(e=parseInt(""+(+(new Date).getTime()-new Date(null==(n=t.personVO)?void 0:n.birthday).getTime())/31536e6,10)),u[1]=+u[1]-e}u[0]="year"}return u.join("_")};export{f as P,R as d};
