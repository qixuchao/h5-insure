var J=Object.defineProperty,K=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var S=(f,u,i)=>u in f?J(f,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):f[u]=i,H=(f,u)=>{for(var i in u||(u={}))ee.call(u,i)&&S(f,i,u[i]);if(j)for(var i of j(u))te.call(u,i)&&S(f,i,u[i]);return f},U=(f,u)=>K(f,Z(u));import{g as ne,af as re,Q as oe,a5 as ae,C as A,L as se,o as de,X as V,r as m,h as I,j as v,k as c,z as s,n as l,s as D,m as x,F as ue,E as ie,y,I as T,B as P}from"./vendor-d47732e4.js";import{P as le}from"./index-dcbfa701.js";import{c as ce,n as fe,a as pe}from"./index-1e238587.js";import{_ as q,R as me,B as Ie,A as ye,a as _e}from"./index-ba22c160.js";import"./useDicData-cf40d739.js";const Oe={key:0,class:"beneficiary-part"},ve={class:"part-title"},Be={class:"title"},Le=P("\u5220\u9664"),Ae=P("+\u6DFB\u52A0\u53D7\u76CA\u4EBA"),ge=P("\u9009\u62E9\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"),Ee={class:"radio-item-wrapper"},Ce={class:"name"},Fe={class:"hone"},be={class:"address"},he={class:"footer-button"},De=P("\u4E0B\u4E00\u6B65"),je=ne({setup(f){const u=re(),i=oe(),{templateId:N=1,orderNo:$="2022072710380711215",tenantId:w="9991000007"}=i.query,[k,Y]=ae(),R=i.path==="/infoPreview"?"infoPreview":"infoCollection",g=A({}),e=A({extInfo:{pageCode:R},tenantOrderHolder:{extInfo:{}},tenantOrderInsuredList:[{relationToHolder:"0",extInfo:{},insuredBeneficiaryType:"1",tenantOrderBeneficiaryList:[{beneficiaryId:0,extInfo:{}}]}],operateOption:{withBeneficiaryInfo:!0,withHolderInfo:!0,withInsuredInfo:!0,withAttachmentInfo:!0}}),M=A(null),_=A([]),O=A([]),d=se({beneficiaryId:0,addressList:[],nextPage:"",currentAddress:null,isLoading:!0}),W=()=>{const t=H({},e.value);t.tenantOrderAttachmentList=[{category:22,objectType:2,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:_.value[0]},{category:23,objectType:2,objectId:e.value.tenantOrderHolder.id,name:"\u6295\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:_.value[1]},{category:22,objectType:3,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u6B63\u9762",uri:O.value[0]},{category:23,objectType:3,objectId:e.value.tenantOrderInsuredList[0].id,name:"\u88AB\u4FDD\u4EBA\u8BC1\u4EF6\u80CC\u9762",uri:O.value[1]}],fe(t).then(({code:n,data:r})=>{n==="10000"&&r.pageAction.pageAction==="jumpToPage"&&u.push({path:le[r.pageAction.data.nextPageCode],query:i.query})})},z=t=>{console.log("value",t)},G=()=>{d.beneficiaryId+=1,e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.push({id:d.beneficiaryId,extInfo:{}})},Q=t=>{e.value.tenantOrderInsuredList[0].beneficiaryReqList=e.value.tenantOrderInsuredList[0].beneficiaryReqList.filter(n=>n.beneficiaryId!==t.beneficiaryId)},X=()=>{pe({orderNo:$,tenantId:w}).then(({code:t,data:n})=>{if(t==="10000"){const r=n;r.extInfo=U(H({},r.extInfo),{pageCode:R,templateId:N}),r.tenantOrderHolder=r.tenantOrderHolder||{},r.tenantOrderHolder.extInfo=r.tenantOrderHolder.extInfo||{},r.tenantOrderInsuredList[0].extInfo=r.tenantOrderInsuredList[0].extInfo||{},r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList=r.tenantOrderInsuredList[0].tenantOrderBeneficiaryList.map(o=>{const p=o;return p.extInfo={},p}),r.tenantOrderAttachmentList.forEach(o=>{o.category,o.objectType,o.category===22?o.objectType===2?_[0]=o.uri:o.objectType===3&&(O[0]=o.uri):o.category===23&&(o.objectType===2?_[1]=o.uri:o.objectType===3&&(O[1]=o.uri))}),Object.assign(e.value,r)}}).finally(()=>{d.isLoading=!1})};return de(()=>{X(),ce({pageCode:"infoCollection",templateId:N}).then(({code:t,data:n})=>{if(t==="10000"){const r={BENEFICIARY:[],INSURER:[],HOLDER:[]};n.productInsureFactorList.forEach(o=>{(r[o.moduleType]=r[o.moduleType]||[]).push(o)}),g.value=r}})}),V(()=>e.value,t=>{var n,r,o,p,E,B,C,F,b,h;if(t){const a=[{contactAddress:((r=(n=t.tenantOrderHolder)==null?void 0:n.extInfo)==null?void 0:r.familyAddress)||1231123,contactName:t.tenantOrderHolder.name||123131,contactPhoneNo:t.tenantOrderHolder.mobile||123132},{contactAddress:(p=(o=t.tenantOrderHolder)==null?void 0:o.extInfo)==null?void 0:p.workAddress,contactName:t.tenantOrderHolder.name,contactPhoneNo:t.tenantOrderHolder.mobile},{contactAddress:(B=(E=t.tenantOrderInsuredList[0])==null?void 0:E.extInfo)==null?void 0:B.familyAddress,contactName:(C=t.tenantOrderInsuredList[0])==null?void 0:C.name,contactPhoneNo:(F=t.tenantOrderInsuredList[0])==null?void 0:F.mobile},{contactAddress:(h=(b=t.tenantOrderInsuredList[0])==null?void 0:b.extInfo)==null?void 0:h.workAddress,contactName:t.tenantOrderInsuredList[0].name,contactPhoneNo:t.tenantOrderInsuredList[0].mobile}];d.addressList=a.filter(L=>L.contactAddress&&L.contactName&&L.contactPhoneNo)}},{deep:!0,immediate:!0}),V(()=>e.value.tenantOrderInsuredList[0].relationToHolder,t=>{+t==1&&Object.assign(e.value.tenantOrderInsuredList[0],e.value.tenantOrderHolder,{id:e.value.tenantOrderInsuredList[0].id})},{deep:!0,immediate:!0}),(t,n)=>{const r=m("ProCard"),o=m("ProRadioButton"),p=m("ProField"),E=m("ProSvg"),B=m("VanButton"),C=m("ProCheckButton"),F=m("van-cell"),b=m("ProForm"),h=m("ProPageWrap");return I(),v(h,{class:"page-info-wrapper"},{default:c(()=>[s(d).isLoading?D("",!0):(I(),v(b,{key:0,ref_key:"formRef",ref:M},{default:c(()=>[l(r,{title:"\u6295\u4FDD\u4EBA"},{default:c(()=>[l(q,{images:_.value,"onUpdate:images":n[0]||(n[0]=a=>_.value=a),"form-info":e.value.tenantOrderHolder,"factor-list":g.value.HOLDER},null,8,["images","form-info","factor-list"])]),_:1}),l(r,{title:"\u88AB\u4FDD\u4EBA"},{default:c(()=>[l(p,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":n[2]||(n[2]=a=>e.value.tenantOrderInsuredList[0].relationToHolder=a),label:"\u4E3A\u8C01\u4FDD\u5355",name:"relationToHolder",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(o,{modelValue:e.value.tenantOrderInsuredList[0].relationToHolder,"onUpdate:modelValue":n[1]||(n[1]=a=>e.value.tenantOrderInsuredList[0].relationToHolder=a),options:s(me)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),+e.value.tenantOrderInsuredList[0].relationToHolder!=1?(I(),v(q,{key:0,images:O.value,"onUpdate:images":n[3]||(n[3]=a=>O.value=a),"form-info":e.value.tenantOrderInsuredList[0],"factor-list":g.value.INSURER||[]},null,8,["images","form-info","factor-list"])):D("",!0),l(p,{label:"\u6295\u4FDD\u5730\u533A",name:"type",placeholder:"\u8BF7\u9009\u62E9","is-link":""})]),_:1}),l(r,{title:"\u53D7\u76CA\u4EBA"},{default:c(()=>[l(p,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":n[5]||(n[5]=a=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),label:"\u53D7\u76CA\u4EBA\u7C7B\u578B",name:"insuredBeneficiaryType",placeholder:"\u8BF7\u9009\u62E9"},{input:c(()=>[l(o,{modelValue:e.value.tenantOrderInsuredList[0].insuredBeneficiaryType,"onUpdate:modelValue":n[4]||(n[4]=a=>e.value.tenantOrderInsuredList[0].insuredBeneficiaryType=a),options:s(Ie)},null,8,["modelValue","options"])]),_:1},8,["modelValue"]),e.value.tenantOrderInsuredList[0].insuredBeneficiaryType==2?(I(),x("div",Oe,[(I(!0),x(ue,null,ie(e.value.tenantOrderInsuredList[0].tenantOrderBeneficiaryList,(a,L)=>(I(),x("div",{key:a.beneficiaryId,class:"beneficiary-item"},[y("div",ve,[y("span",Be,T(`\u53D7\u76CA\u4EBA${L+1}`),1),l(E,{name:"delete",onClick:Te=>Q(a)},{default:c(()=>[Le]),_:2},1032,["onClick"])]),l(_e,{"form-info":a,"factor-list":g.value.BENEFICIARY},null,8,["form-info","factor-list"])]))),128)),l(B,{onClick:G},{default:c(()=>[Ae]),_:1})])):D("",!0)]),_:1}),l(r,{title:"\u4FDD\u5355\u901A\u8BAF\u4FE1\u606F"},{default:c(()=>[s(d).currentAddress?(I(),v(F,{key:1,title:"\u5355\u5143\u683C","is-link":""},{title:c(()=>[y("div",Ee,[y("p",null,[y("span",Ce,T(s(d).addressList[s(d).currentAddress-1].contactName),1),y("span",Fe,T(s(d).addressList[s(d).currentAddress-1].contactPhoneNo),1)]),y("p",be,T(s(d).addressList[s(d).currentAddress-1].contactAddress),1)])]),_:1})):(I(),v(C,{key:0,activated:"",onClick:n[6]||(n[6]=a=>s(Y)(!0))},{default:c(()=>[ge]),_:1}))]),_:1})]),_:1},512)),y("div",he,[l(B,{block:"",type:"primary",onClick:W},{default:c(()=>[De]),_:1})]),s(k)?(I(),v(ye,{key:1,modelValue:s(d).currentAddress,"onUpdate:modelValue":n[7]||(n[7]=a=>s(d).currentAddress=a),show:s(k),"data-source":s(d).addressList,onSubmit:z},null,8,["modelValue","show","data-source"])):D("",!0)]),_:1})}}});export{je as default};
