import{a2 as e,d as a,dw as t,j as r,k as l,bt as s,dX as o,o as n,c as i,a as c,e as m,u as d,a8 as u,b as w,w as p,F as y,q as k,_ as v,ar as h,f as _,af as g,cg as f,ch as b,by as C,m as S,p as x,n as N,au as T,av as D,aw as I,aA as $,i as V,r as j,O,ag as A,eh as M,dB as P,L,bU as z}from"./index-0aeac8ce.js";import{_ as E}from"./index-7ed12dc5.js";import{S as U}from"./index-e1338f7e.js";import{d as q,e as F}from"./trial-9470be30.js";import{C as R}from"./index-e8cf839e.js";import{g as B}from"./utils-fd9b71b5.js";import"./empty-ae586b6c.js";import"./infoCollection-7e0fb9db.js";const H={class:"com-type-filter"},J={class:"wrapper"},W=["onClick"],X=a({name:"TypeFilter"});var Y=v(a({...X,props:{type:{type:Number,default:1},modelValue:{type:Number,default:0},items:{type:Array,default:()=>[]}},emits:["change","update:modelValue"],setup(e,{emit:a}){const v=e,h=[{label:"全部",value:""},{label:"长期",value:1},{label:"短期",value:3}],_=t(v,"modelValue",a),g=r(!1),f=l((()=>{switch(+v.type){case 1:return[{label:"全部",value:""},...F];case 2:return[{label:"全部",value:""},...q];default:return h}})),b=l((()=>{const e=f.value.find((e=>+e.value==+_.value));return console.log("types",f.value,"当前type：",e),e?e.label:"全部"}));return(e,t)=>{const r=s,l=o;return n(),i(y,null,[c("div",H,[c("div",{onClick:t[0]||(t[0]=e=>g.value=!0)},[c("span",null,m(d(b)),1),u(),w(r,{name:"arrow-down"})])]),w(l,{show:g.value,style:{"background-color":"transparent"},onClick:t[1]||(t[1]=e=>g.value=!1)},{default:p((()=>[c("div",J,[(n(!0),i(y,null,k(d(f).filter((e=>+e.value!=+d(_))),(e=>(n(),i("div",{key:e.label,class:"block",onClick:t=>{return r=e,_.value=r.value,void a("change",r);var r}},m(e.label),9,W)))),128))])])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-129d7a22"]]);const G={class:"com-card-data"},K={class:"title"},Q={class:"item-list"},Z={class:"label"},ee={class:"files"},ae=["onClick"],te=a({name:"Row"}),re=a({...te,props:{list:{type:Array,default:()=>[]}},emits:["preview"],setup(e,{emit:a}){const t=h(F),r=h(q),l=["产品说明书","产品条款","费率表","风险告知书","其他","投保规则","责任条款"],o=[{key:"riskCategory",label:"险种类别",value:"寿险",format:e=>r[e]},{key:"riskType",label:"主附险",value:"主险",format:e=>t[e]},{key:"insurancePeriodValues",label:"保障期间",value:"180天"},{key:"paymentPeriodValues",label:"交费期间",value:"终生"}],d=e=>o.filter((a=>e[a.key])).map((a=>{const t=e[a.key];return{...a,value:a.format?a.format(t):t}}));return(a,t)=>{const r=s,o=g;return n(),i("div",G,[(n(!0),i(y,null,k(e.list,(e=>(n(),i("div",{key:e.riskId,class:"card"},[c("div",K,[u(m(e.riskName),1),w(r,{name:"arrow",color:"#c2c2c2"})]),c("div",Q,[(n(!0),i(y,null,k(d(e),(({label:e,value:a})=>(n(),i(y,null,[a?(n(),i("div",{key:e,class:"item"},[c("span",Z,m(e)+":",1),u(),c("span",null,m(a),1)])):_("",!0)],64)))),256))]),c("div",ee,[(n(!0),i(y,null,k(null==e?void 0:e.attachmentDetailVOS,(e=>(n(),i("div",{key:e.riskId,class:"file",onClick:t=>a.$emit("preview",e)},[w(o,{name:l.includes(e.categoryName)?e.categoryName:"自定义"},null,8,["name"]),c("div",null,m(e.categoryName),1)],8,ae)))),128))])])))),128))])}}});const le={class:"com-row-tabs"},se={class:"row-data"},oe={class:"file-name"},ne=(e=>(D("data-v-a74781f4"),e=e(),I(),e))((()=>c("span",{class:"dot"},null,-1))),ie=["onClick"],ce=a({name:"Tabs"});var me=v(a({...ce,props:{tabs:{type:Array,default:()=>[]},list:{type:Array,default:()=>[]},active:{type:String,default:""}},emits:["@update:active","preview"],setup(e,{emit:a}){const l=t(e,"active",a),s=r(!1);return(t,r)=>{const o=f,u=b,v=g,h=C,D=R,I=T;return n(),i(y,null,[c("div",le,[e.tabs.length?(n(),S(u,{key:0,active:d(l),"onUpdate:active":r[0]||(r[0]=e=>x(l)?l.value=e:null),class:N(["tabs",e.tabs.length>3?"w80":""])},{default:p((()=>[(n(!0),i(y,null,k(e.tabs,(e=>(n(),S(o,{key:e,name:e,title:e},null,8,["name","title"])))),128))])),_:1},8,["active","class"])):_("",!0),e.tabs.length>3?(n(),i("div",{key:1,class:"more-arrow",onClick:r[1]||(r[1]=e=>s.value=!0)},[w(v,{name:"down-fill",color:"red"})])):_("",!0)]),c("div",se,[w(D,null,{default:p((()=>[(n(!0),i(y,null,k(e.list,(e=>(n(),S(h,{key:e.id,"is-link":"",onClick:a=>t.$emit("preview",e)},{title:p((()=>[c("div",oe,[ne,c("span",null,m(e.displayName),1)])])),_:2},1032,["onClick"])))),128))])),_:1})]),w(I,{show:s.value,title:"已选类别",onClose:r[2]||(r[2]=e=>s.value=!1)},{default:p((()=>[(n(!0),i(y,null,k(e.tabs,((e,t)=>(n(),i("div",{key:t,class:N(["tab-item",e==d(l)?"active":""]),onClick:t=>(e=>{l.value=e,s.value=!1,a("@update:active",e)})(e)},[c("div",null,m(e),1)],10,ie)))),128))])),_:1},8,["show"])],64)}}}),[["__scopeId","data-v-a74781f4"]]);function de(e){function a(){const a={watermark_txt:"text",watermark_x:20,watermark_y:20,watermark_rows:20,watermark_cols:20,watermark_x_space:100,watermark_y_space:50,watermark_color:"#f5ecec",watermark_alpha:.4,watermark_fontsize:"13px",watermark_font:"微软雅黑",watermark_width:210,watermark_height:80,watermark_angle:15};Object.assign(a,e);const t=document.createDocumentFragment(),r=Math.max(document.body.scrollWidth,document.body.clientWidth),l=r-.015*r,s=Math.max(document.body.scrollHeight,document.body.clientHeight)-30;let o,n;(0===a.watermark_cols||parseInt(a.watermark_x+a.watermark_width*a.watermark_cols+a.watermark_x_space*(a.watermark_cols-1))>l)&&(a.watermark_cols=parseInt((l-a.watermark_x+a.watermark_x_space)/(a.watermark_width+a.watermark_x_space)),a.watermark_x_space=parseInt((l-a.watermark_x-a.watermark_width*a.watermark_cols)/(a.watermark_cols-1))),(0===a.watermark_rows||parseInt(a.watermark_y+a.watermark_height*a.watermark_rows+a.watermark_y_space*(a.watermark_rows-1))>s)&&(a.watermark_rows=parseInt((a.watermark_y_space+s-a.watermark_y)/(a.watermark_height+a.watermark_y_space)),a.watermark_y_space=parseInt((s-a.watermark_y-a.watermark_height*a.watermark_rows)/(a.watermark_rows-1)));for(let e=0;e<a.watermark_rows;e+=1){n=a.watermark_y+(a.watermark_y_space+a.watermark_height)*e;for(let r=0;r<a.watermark_cols;r+=1){o=a.watermark_x+(a.watermark_width+a.watermark_x_space)*r;const l=document.createElement("div");l.id=`maskDiv${e}${r}`,l.className="maskDiv",l.appendChild(document.createTextNode(a.watermark_txt)),l.style.webkitTransform=`rotate(-${a.watermark_angle}deg)`,l.style.MozTransform=`rotate(-${a.watermark_angle}deg)`,l.style.msTransform=`rotate(-${a.watermark_angle}deg)`,l.style.OTransform=`rotate(-${a.watermark_angle}deg)`,l.style.transform=`rotate(-${a.watermark_angle}deg)`,l.style.visibility="",l.style.position="absolute",l.style.left=`${o}px`,l.style.top=`${n}px`,l.style.overflow="hidden",l.style.zIndex="9999",l.style.pointerEvents="none",l.style.opacity=a.watermark_alpha,l.style.fontSize=a.watermark_fontsize,l.style.fontFamily=a.watermark_font,l.style.color=a.watermark_color,l.style.textAlign="center",l.style.width=`${a.watermark_width}px`,l.style.height=`${a.watermark_height}px`,l.style.display="block",t.appendChild(l)}}document.body.appendChild(t)}const t=$((function(){document.querySelectorAll(".maskDiv").forEach((e=>{e.parentNode.removeChild(e)})),a()}),500);window.addEventListener("resize",t),a()}const ue={class:"page page-product-lib"},we={key:1,class:"tac",style:{"margin-top":"50px"}},pe={class:"review-pdf"},ye=a({name:"ProductLib"});var ke=v(a({...ye,setup(a){const t=V(),{preview:s=!1,insurerCode:o="lianlife"}=t.query,m=j({rowDataMap:{},cardDatas:[],tabs:[],currentTab:""}),u=l((()=>(console.log("rowDatas",m.rowDataMap,m.tabs,m.currentTab),m.rowDataMap[m.currentTab]))),y=/Mobi|Android|iPhone/i.test(navigator.userAgent),k=r({id:"",insurerCode:"lianlife",showStyle:1,materialCategoryShowStyle:1,riskName:"",showStyleDetails:[],isShowStopSellingLabel:"Y",showCategoryIds:[],showCategoryName:[],showStyleDetailName:[]}),v=r(!0),h=(a=(()=>{}))=>{((a={})=>e({url:"/api/app/insure/product/category/queryProductBoxConfig",method:"POST",data:a}))({insurerCode:o}).then((e=>{var t;console.log("获取配置成功",e),k.value=e.data,k.value.riskName="",m.currentTab=null==(t=m.tabs)?void 0:t[0],a&&(null==a||a())}))},g=()=>{v.value=!0,((a={})=>e({url:"/api/app/insure/product/category/riskAttachmentList",method:"POST",data:a}))({insurerCode:o,materialCategoryShowStyle:k.value.materialCategoryShowStyle,showStyle:k.value.showStyle,riskName:k.value.riskName,riskType:k.value.riskType,categoryId:k.value.showCategoryIds,showStyleDetails:k.value.showStyleDetails}).then((e=>{var a;const{attachmentListResMap:t,attachmentDetailVOS:r}=e.data||{attachmentListResMap:{},attachmentDetailVOS:[]};m.rowDataMap={...t};const l=Object.keys(t);m.tabs=null==(a=k.value.showCategoryName)?void 0:a.filter((e=>l.includes(e))),m.cardDatas=r,console.log("state.rowDatas",u)})).finally((()=>{v.value=!1}))},f=()=>{k.value.id?g():h((()=>{g()}))},b=r({attachmentName:"",attachmentContent:"",attachmentSource:1,show:!1}),x=j({name:"测试水印",agentCode:"1234"}),N=e=>{console.log("文件预览",x),b.value={...e,show:!0},de({watermark_txt:`${x.name}\r\n${x.agentCode}`,watermark_color:"#333",watermark_angle:30,watermark_width:100,watermark_height:60})},D=e=>{console.log("关闭文件预览"),document.querySelectorAll(".maskDiv").forEach((e=>{e.parentNode.removeChild(e)})),b.value={attachmentName:"",attachmentContent:"",attachmentSource:1,show:!1}};return O((()=>{s?window.addEventListener("message",(e=>{var a;console.log("子应用收到的数据",e.data);"object"==typeof JSON.parse(e.data)&&(k.value={...k.value,...JSON.parse(e.data)},m.currentTab=null==(a=m.tabs)?void 0:a[0],g()),console.log("合并后的config:",k.value)}),!1):h();const e=A.get(M);e&&(x.name=e.name,x.agentCode=e.agentCode),setTimeout((()=>{f()}),1e3)})),(e,a)=>{const t=U,r=C,l=P,s=L,o=E,h=z,g=T;return n(),i("div",ue,[w(l,null,{default:p((()=>[w(r,{class:"top-bar"},{default:p((()=>[c("div",null,[w(Y,{modelValue:d(k).riskType,"onUpdate:modelValue":[a[0]||(a[0]=e=>d(k).riskType=e),a[1]||(a[1]=e=>d(k).riskType=e)],type:d(k).materialCategoryShowStyle,onChange:f},null,8,["modelValue","type"])]),w(t,{modelValue:d(k).riskName,"onUpdate:modelValue":a[2]||(a[2]=e=>d(k).riskName=e),"left-icon":"none",placeholder:"请搜索险种名称",shape:"round","clear-trigger":"always","show-action":"",clearable:d(y),onSearch:f},{action:p((()=>[c("div",{onClick:f},"搜索")])),_:1},8,["modelValue","clearable"])])),_:1})])),_:1}),c("div",null,[d(v)||1!=+d(k).showStyle?_("",!0):(n(),S(me,{key:0,active:d(m).currentTab,tabs:d(m).tabs,list:d(u),"onUpdate:active":a[3]||(a[3]=e=>d(m).currentTab=e),onPreview:N},null,8,["active","tabs","list"])),d(v)?(n(),i("div",we,[w(s,{type:"spinner"})])):_("",!0),d(v)||2!=+d(k).showStyle?_("",!0):(n(),S(re,{key:2,list:d(m).cardDatas,onPreview:N},null,8,["list"])),d(v)||d(m).cardDatas.length?_("",!0):(n(),S(o,{key:3,title:"没有找到产品资料",style:{"margin-top":"40px"}}))]),w(g,{show:d(b).show,"onUpdate:show":a[4]||(a[4]=e=>d(b).show=e),class:"pre-file-wrap",title:d(b).attachmentName,position:"bottom","close-on-click-overlay":!1,style:{overflow:"hidden"},"header-style":{paddingRight:"40px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",paddingTop:"4px"},onClose:D},{default:p((()=>[c("div",pe,[w(h,{"is-iframe":!1,content:d(b).attachmentContent,type:d(B)(d(b).attachmentSource,d(b).attachmentContent)},null,8,["content","type"])])])),_:1},8,["show","title"])])}}}),[["__scopeId","data-v-c43b2a96"]]);export{ke as default};
